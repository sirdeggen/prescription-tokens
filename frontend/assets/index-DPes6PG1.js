var FE=Object.defineProperty;var LE=(s,t,i)=>t in s?FE(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var rt=(s,t,i)=>LE(s,typeof t!="symbol"?t+"":t,i);function UE(s,t){for(var i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&!Array.isArray(r)){for(const e in r)if(e!=="default"&&!(e in s)){const o=Object.getOwnPropertyDescriptor(r,e);o&&Object.defineProperty(s,e,o.get?o:{enumerable:!0,get:()=>r[e]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();function p8(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function y8(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var t=s.default;if(typeof t=="function"){var i=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var e=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(i,r,e.get?e:{enumerable:!0,get:function(){return s[r]}})}),i}var Hg={exports:{}},pl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2;function qE(){if(s2)return pl;s2=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(r,e,o){var a=null;if(o!==void 0&&(a=""+o),e.key!==void 0&&(a=""+e.key),"key"in e){o={};for(var l in e)l!=="key"&&(o[l]=e[l])}else o=e;return e=o.ref,{$$typeof:s,type:r,key:a,ref:e!==void 0?e:null,props:o}}return pl.Fragment=t,pl.jsx=i,pl.jsxs=i,pl}var o2;function jE(){return o2||(o2=1,Hg.exports=qE()),Hg.exports}var it=jE(),Kg={exports:{}},fe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c2;function HE(){if(c2)return fe;c2=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),e=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),n=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),d=Symbol.iterator;function y(q){return q===null||typeof q!="object"?null:(q=d&&q[d]||q["@@iterator"],typeof q=="function"?q:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,b={};function w(q,$,Y){this.props=q,this.context=$,this.refs=b,this.updater=Y||p}w.prototype.isReactComponent={},w.prototype.setState=function(q,$){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,$,"setState")},w.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function v(){}v.prototype=w.prototype;function _(q,$,Y){this.props=q,this.context=$,this.refs=b,this.updater=Y||p}var S=_.prototype=new v;S.constructor=_,g(S,w.prototype),S.isPureReactComponent=!0;var T=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},k=Object.prototype.hasOwnProperty;function O(q,$,Y,Q,J,vt){return Y=vt.ref,{$$typeof:s,type:q,key:$,ref:Y!==void 0?Y:null,props:vt}}function A(q,$){return O(q.type,$,void 0,void 0,void 0,q.props)}function R(q){return typeof q=="object"&&q!==null&&q.$$typeof===s}function P(q){var $={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(Y){return $[Y]})}var C=/\/+/g;function N(q,$){return typeof q=="object"&&q!==null&&q.key!=null?P(""+q.key):$.toString(36)}function D(){}function U(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(D,D):(q.status="pending",q.then(function($){q.status==="pending"&&(q.status="fulfilled",q.value=$)},function($){q.status==="pending"&&(q.status="rejected",q.reason=$)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function F(q,$,Y,Q,J){var vt=typeof q;(vt==="undefined"||vt==="boolean")&&(q=null);var wt=!1;if(q===null)wt=!0;else switch(vt){case"bigint":case"string":case"number":wt=!0;break;case"object":switch(q.$$typeof){case s:case t:wt=!0;break;case c:return wt=q._init,F(wt(q._payload),$,Y,Q,J)}}if(wt)return J=J(q),wt=Q===""?"."+N(q,0):Q,T(J)?(Y="",wt!=null&&(Y=wt.replace(C,"$&/")+"/"),F(J,$,Y,"",function(_t){return _t})):J!=null&&(R(J)&&(J=A(J,Y+(J.key==null||q&&q.key===J.key?"":(""+J.key).replace(C,"$&/")+"/")+wt)),$.push(J)),1;wt=0;var dt=Q===""?".":Q+":";if(T(q))for(var yt=0;yt<q.length;yt++)Q=q[yt],vt=dt+N(Q,yt),wt+=F(Q,$,Y,vt,J);else if(yt=y(q),typeof yt=="function")for(q=yt.call(q),yt=0;!(Q=q.next()).done;)Q=Q.value,vt=dt+N(Q,yt++),wt+=F(Q,$,Y,vt,J);else if(vt==="object"){if(typeof q.then=="function")return F(U(q),$,Y,Q,J);throw $=String(q),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return wt}function L(q,$,Y){if(q==null)return q;var Q=[],J=0;return F(q,Q,"","",function(vt){return $.call(Y,vt,J++)}),Q}function j(q){if(q._status===-1){var $=q._result;$=$(),$.then(function(Y){(q._status===0||q._status===-1)&&(q._status=1,q._result=Y)},function(Y){(q._status===0||q._status===-1)&&(q._status=2,q._result=Y)}),q._status===-1&&(q._status=0,q._result=$)}if(q._status===1)return q._result.default;throw q._result}var V=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function W(){}return fe.Children={map:L,forEach:function(q,$,Y){L(q,function(){$.apply(this,arguments)},Y)},count:function(q){var $=0;return L(q,function(){$++}),$},toArray:function(q){return L(q,function($){return $})||[]},only:function(q){if(!R(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},fe.Component=w,fe.Fragment=i,fe.Profiler=e,fe.PureComponent=_,fe.StrictMode=r,fe.Suspense=f,fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,fe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return I.H.useMemoCache(q)}},fe.cache=function(q){return function(){return q.apply(null,arguments)}},fe.cloneElement=function(q,$,Y){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var Q=g({},q.props),J=q.key,vt=void 0;if($!=null)for(wt in $.ref!==void 0&&(vt=void 0),$.key!==void 0&&(J=""+$.key),$)!k.call($,wt)||wt==="key"||wt==="__self"||wt==="__source"||wt==="ref"&&$.ref===void 0||(Q[wt]=$[wt]);var wt=arguments.length-2;if(wt===1)Q.children=Y;else if(1<wt){for(var dt=Array(wt),yt=0;yt<wt;yt++)dt[yt]=arguments[yt+2];Q.children=dt}return O(q.type,J,void 0,void 0,vt,Q)},fe.createContext=function(q){return q={$$typeof:a,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:o,_context:q},q},fe.createElement=function(q,$,Y){var Q,J={},vt=null;if($!=null)for(Q in $.key!==void 0&&(vt=""+$.key),$)k.call($,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(J[Q]=$[Q]);var wt=arguments.length-2;if(wt===1)J.children=Y;else if(1<wt){for(var dt=Array(wt),yt=0;yt<wt;yt++)dt[yt]=arguments[yt+2];J.children=dt}if(q&&q.defaultProps)for(Q in wt=q.defaultProps,wt)J[Q]===void 0&&(J[Q]=wt[Q]);return O(q,vt,void 0,void 0,null,J)},fe.createRef=function(){return{current:null}},fe.forwardRef=function(q){return{$$typeof:l,render:q}},fe.isValidElement=R,fe.lazy=function(q){return{$$typeof:c,_payload:{_status:-1,_result:q},_init:j}},fe.memo=function(q,$){return{$$typeof:n,type:q,compare:$===void 0?null:$}},fe.startTransition=function(q){var $=I.T,Y={};I.T=Y;try{var Q=q(),J=I.S;J!==null&&J(Y,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(W,V)}catch(vt){V(vt)}finally{I.T=$}},fe.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},fe.use=function(q){return I.H.use(q)},fe.useActionState=function(q,$,Y){return I.H.useActionState(q,$,Y)},fe.useCallback=function(q,$){return I.H.useCallback(q,$)},fe.useContext=function(q){return I.H.useContext(q)},fe.useDebugValue=function(){},fe.useDeferredValue=function(q,$){return I.H.useDeferredValue(q,$)},fe.useEffect=function(q,$,Y){var Q=I.H;if(typeof Y=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Q.useEffect(q,$)},fe.useId=function(){return I.H.useId()},fe.useImperativeHandle=function(q,$,Y){return I.H.useImperativeHandle(q,$,Y)},fe.useInsertionEffect=function(q,$){return I.H.useInsertionEffect(q,$)},fe.useLayoutEffect=function(q,$){return I.H.useLayoutEffect(q,$)},fe.useMemo=function(q,$){return I.H.useMemo(q,$)},fe.useOptimistic=function(q,$){return I.H.useOptimistic(q,$)},fe.useReducer=function(q,$,Y){return I.H.useReducer(q,$,Y)},fe.useRef=function(q){return I.H.useRef(q)},fe.useState=function(q){return I.H.useState(q)},fe.useSyncExternalStore=function(q,$,Y){return I.H.useSyncExternalStore(q,$,Y)},fe.useTransition=function(){return I.H.useTransition()},fe.version="19.1.0",fe}var u2;function Ab(){return u2||(u2=1,Kg.exports=HE()),Kg.exports}var et=Ab();const Sr=p8(et),Vm=UE({__proto__:null,default:Sr},[et]);var Vg={exports:{}},yl={},Wg={exports:{}},$g={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l2;function KE(){return l2||(l2=1,function(s){function t(L,j){var V=L.length;L.push(j);t:for(;0<V;){var W=V-1>>>1,q=L[W];if(0<e(q,j))L[W]=j,L[V]=q,V=W;else break t}}function i(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var j=L[0],V=L.pop();if(V!==j){L[0]=V;t:for(var W=0,q=L.length,$=q>>>1;W<$;){var Y=2*(W+1)-1,Q=L[Y],J=Y+1,vt=L[J];if(0>e(Q,V))J<q&&0>e(vt,Q)?(L[W]=vt,L[J]=V,W=J):(L[W]=Q,L[Y]=V,W=Y);else if(J<q&&0>e(vt,V))L[W]=vt,L[J]=V,W=J;else break t}}return j}function e(L,j){var V=L.sortIndex-j.sortIndex;return V!==0?V:L.id-j.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();s.unstable_now=function(){return a.now()-l}}var f=[],n=[],c=1,d=null,y=3,p=!1,g=!1,b=!1,w=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function T(L){for(var j=i(n);j!==null;){if(j.callback===null)r(n);else if(j.startTime<=L)r(n),j.sortIndex=j.expirationTime,t(f,j);else break;j=i(n)}}function I(L){if(b=!1,T(L),!g)if(i(f)!==null)g=!0,k||(k=!0,N());else{var j=i(n);j!==null&&F(I,j.startTime-L)}}var k=!1,O=-1,A=5,R=-1;function P(){return w?!0:!(s.unstable_now()-R<A)}function C(){if(w=!1,k){var L=s.unstable_now();R=L;var j=!0;try{t:{g=!1,b&&(b=!1,_(O),O=-1),p=!0;var V=y;try{e:{for(T(L),d=i(f);d!==null&&!(d.expirationTime>L&&P());){var W=d.callback;if(typeof W=="function"){d.callback=null,y=d.priorityLevel;var q=W(d.expirationTime<=L);if(L=s.unstable_now(),typeof q=="function"){d.callback=q,T(L),j=!0;break e}d===i(f)&&r(f),T(L)}else r(f);d=i(f)}if(d!==null)j=!0;else{var $=i(n);$!==null&&F(I,$.startTime-L),j=!1}}break t}finally{d=null,y=V,p=!1}j=void 0}}finally{j?N():k=!1}}}var N;if(typeof S=="function")N=function(){S(C)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,U=D.port2;D.port1.onmessage=C,N=function(){U.postMessage(null)}}else N=function(){v(C,0)};function F(L,j){O=v(function(){L(s.unstable_now())},j)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(L){L.callback=null},s.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_next=function(L){switch(y){case 1:case 2:case 3:var j=3;break;default:j=y}var V=y;y=j;try{return L()}finally{y=V}},s.unstable_requestPaint=function(){w=!0},s.unstable_runWithPriority=function(L,j){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var V=y;y=L;try{return j()}finally{y=V}},s.unstable_scheduleCallback=function(L,j,V){var W=s.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?W+V:W):V=W,L){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=V+q,L={id:c++,callback:j,priorityLevel:L,startTime:V,expirationTime:q,sortIndex:-1},V>W?(L.sortIndex=V,t(n,L),i(f)===null&&L===i(n)&&(b?(_(O),O=-1):b=!0,F(I,V-W))):(L.sortIndex=q,t(f,L),g||p||(g=!0,k||(k=!0,N()))),L},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(L){var j=y;return function(){var V=y;y=j;try{return L.apply(this,arguments)}finally{y=V}}}}($g)),$g}var d2;function VE(){return d2||(d2=1,Wg.exports=KE()),Wg.exports}var zg={exports:{}},Fi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f2;function WE(){if(f2)return Fi;f2=1;var s=Ab();function t(f){var n="https://react.dev/errors/"+f;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)n+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+f+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var r={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},e=Symbol.for("react.portal");function o(f,n,c){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:e,key:d==null?null:""+d,children:f,containerInfo:n,implementation:c}}var a=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(f,n){if(f==="font")return"";if(typeof n=="string")return n==="use-credentials"?n:""}return Fi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Fi.createPortal=function(f,n){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)throw Error(t(299));return o(f,n,null,c)},Fi.flushSync=function(f){var n=a.T,c=r.p;try{if(a.T=null,r.p=2,f)return f()}finally{a.T=n,r.p=c,r.d.f()}},Fi.preconnect=function(f,n){typeof f=="string"&&(n?(n=n.crossOrigin,n=typeof n=="string"?n==="use-credentials"?n:"":void 0):n=null,r.d.C(f,n))},Fi.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Fi.preinit=function(f,n){if(typeof f=="string"&&n&&typeof n.as=="string"){var c=n.as,d=l(c,n.crossOrigin),y=typeof n.integrity=="string"?n.integrity:void 0,p=typeof n.fetchPriority=="string"?n.fetchPriority:void 0;c==="style"?r.d.S(f,typeof n.precedence=="string"?n.precedence:void 0,{crossOrigin:d,integrity:y,fetchPriority:p}):c==="script"&&r.d.X(f,{crossOrigin:d,integrity:y,fetchPriority:p,nonce:typeof n.nonce=="string"?n.nonce:void 0})}},Fi.preinitModule=function(f,n){if(typeof f=="string")if(typeof n=="object"&&n!==null){if(n.as==null||n.as==="script"){var c=l(n.as,n.crossOrigin);r.d.M(f,{crossOrigin:c,integrity:typeof n.integrity=="string"?n.integrity:void 0,nonce:typeof n.nonce=="string"?n.nonce:void 0})}}else n==null&&r.d.M(f)},Fi.preload=function(f,n){if(typeof f=="string"&&typeof n=="object"&&n!==null&&typeof n.as=="string"){var c=n.as,d=l(c,n.crossOrigin);r.d.L(f,c,{crossOrigin:d,integrity:typeof n.integrity=="string"?n.integrity:void 0,nonce:typeof n.nonce=="string"?n.nonce:void 0,type:typeof n.type=="string"?n.type:void 0,fetchPriority:typeof n.fetchPriority=="string"?n.fetchPriority:void 0,referrerPolicy:typeof n.referrerPolicy=="string"?n.referrerPolicy:void 0,imageSrcSet:typeof n.imageSrcSet=="string"?n.imageSrcSet:void 0,imageSizes:typeof n.imageSizes=="string"?n.imageSizes:void 0,media:typeof n.media=="string"?n.media:void 0})}},Fi.preloadModule=function(f,n){if(typeof f=="string")if(n){var c=l(n.as,n.crossOrigin);r.d.m(f,{as:typeof n.as=="string"&&n.as!=="script"?n.as:void 0,crossOrigin:c,integrity:typeof n.integrity=="string"?n.integrity:void 0})}else r.d.m(f)},Fi.requestFormReset=function(f){r.d.r(f)},Fi.unstable_batchedUpdates=function(f,n){return f(n)},Fi.useFormState=function(f,n,c){return a.H.useFormState(f,n,c)},Fi.useFormStatus=function(){return a.H.useHostTransitionStatus()},Fi.version="19.1.0",Fi}var h2;function g8(){if(h2)return zg.exports;h2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),zg.exports=WE(),zg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p2;function $E(){if(p2)return yl;p2=1;var s=VE(),t=Ab(),i=g8();function r(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function o(u){var h=u,m=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(m=h.return),u=h.return;while(u)}return h.tag===3?m:null}function a(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function l(u){if(o(u)!==u)throw Error(r(188))}function f(u){var h=u.alternate;if(!h){if(h=o(u),h===null)throw Error(r(188));return h!==u?null:u}for(var m=u,x=h;;){var E=m.return;if(E===null)break;var M=E.alternate;if(M===null){if(x=E.return,x!==null){m=x;continue}break}if(E.child===M.child){for(M=E.child;M;){if(M===m)return l(E),u;if(M===x)return l(E),h;M=M.sibling}throw Error(r(188))}if(m.return!==x.return)m=E,x=M;else{for(var B=!1,H=E.child;H;){if(H===m){B=!0,m=E,x=M;break}if(H===x){B=!0,x=E,m=M;break}H=H.sibling}if(!B){for(H=M.child;H;){if(H===m){B=!0,m=M,x=E;break}if(H===x){B=!0,x=M,m=E;break}H=H.sibling}if(!B)throw Error(r(189))}}if(m.alternate!==x)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?u:h}function n(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=n(u),h!==null)return h;u=u.sibling}return null}var c=Object.assign,d=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function N(u){return u===null||typeof u!="object"?null:(u=C&&u[C]||u["@@iterator"],typeof u=="function"?u:null)}var D=Symbol.for("react.client.reference");function U(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===D?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case g:return"Fragment";case w:return"Profiler";case b:return"StrictMode";case I:return"Suspense";case k:return"SuspenseList";case R:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case p:return"Portal";case S:return(u.displayName||"Context")+".Provider";case _:return(u._context.displayName||"Context")+".Consumer";case T:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case O:return h=u.displayName||null,h!==null?h:U(u.type)||"Memo";case A:h=u._payload,u=u._init;try{return U(u(h))}catch{}}return null}var F=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},W=[],q=-1;function $(u){return{current:u}}function Y(u){0>q||(u.current=W[q],W[q]=null,q--)}function Q(u,h){q++,W[q]=u.current,u.current=h}var J=$(null),vt=$(null),wt=$(null),dt=$(null);function yt(u,h){switch(Q(wt,h),Q(vt,u),Q(J,null),h.nodeType){case 9:case 11:u=(u=h.documentElement)&&(u=u.namespaceURI)?Cx(u):0;break;default:if(u=h.tagName,h=h.namespaceURI)h=Cx(h),u=Dx(h,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}Y(J),Q(J,u)}function _t(){Y(J),Y(vt),Y(wt)}function tt(u){u.memoizedState!==null&&Q(dt,u);var h=J.current,m=Dx(h,u.type);h!==m&&(Q(vt,u),Q(J,m))}function xt(u){vt.current===u&&(Y(J),Y(vt)),dt.current===u&&(Y(dt),ul._currentValue=V)}var It=Object.prototype.hasOwnProperty,Nt=s.unstable_scheduleCallback,Lt=s.unstable_cancelCallback,ne=s.unstable_shouldYield,Ut=s.unstable_requestPaint,Vt=s.unstable_now,Jt=s.unstable_getCurrentPriorityLevel,Ct=s.unstable_ImmediatePriority,K=s.unstable_UserBlockingPriority,ut=s.unstable_NormalPriority,st=s.unstable_LowPriority,Mt=s.unstable_IdlePriority,Ht=s.log,Kt=s.unstable_setDisableYieldValue,Xt=null,Qt=null;function Ft(u){if(typeof Ht=="function"&&Kt(u),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(Xt,u)}catch{}}var Rt=Math.clz32?Math.clz32:Wt,St=Math.log,Ot=Math.LN2;function Wt(u){return u>>>=0,u===0?32:31-(St(u)/Ot|0)|0}var Gt=256,z=4194304;function G(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function at(u,h,m){var x=u.pendingLanes;if(x===0)return 0;var E=0,M=u.suspendedLanes,B=u.pingedLanes;u=u.warmLanes;var H=x&134217727;return H!==0?(x=H&~M,x!==0?E=G(x):(B&=H,B!==0?E=G(B):m||(m=H&~u,m!==0&&(E=G(m))))):(H=x&~M,H!==0?E=G(H):B!==0?E=G(B):m||(m=x&~u,m!==0&&(E=G(m)))),E===0?0:h!==0&&h!==E&&(h&M)===0&&(M=E&-E,m=h&-h,M>=m||M===32&&(m&4194048)!==0)?h:E}function ht(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function lt(u,h){switch(u){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bt(){var u=Gt;return Gt<<=1,(Gt&4194048)===0&&(Gt=256),u}function Dt(){var u=z;return z<<=1,(z&62914560)===0&&(z=4194304),u}function jt(u){for(var h=[],m=0;31>m;m++)h.push(u);return h}function Yt(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function te(u,h,m,x,E,M){var B=u.pendingLanes;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=m,u.entangledLanes&=m,u.errorRecoveryDisabledLanes&=m,u.shellSuspendCounter=0;var H=u.entanglements,Z=u.expirationTimes,pt=u.hiddenUpdates;for(m=B&~m;0<m;){var kt=31-Rt(m),At=1<<kt;H[kt]=0,Z[kt]=-1;var gt=pt[kt];if(gt!==null)for(pt[kt]=null,kt=0;kt<gt.length;kt++){var mt=gt[kt];mt!==null&&(mt.lane&=-536870913)}m&=~At}x!==0&&oe(u,x,0),M!==0&&E===0&&u.tag!==0&&(u.suspendedLanes|=M&~(B&~h))}function oe(u,h,m){u.pendingLanes|=h,u.suspendedLanes&=~h;var x=31-Rt(h);u.entangledLanes|=h,u.entanglements[x]=u.entanglements[x]|1073741824|m&4194090}function ee(u,h){var m=u.entangledLanes|=h;for(u=u.entanglements;m;){var x=31-Rt(m),E=1<<x;E&h|u[x]&h&&(u[x]|=h),m&=~E}}function pe(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function Bt(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function ce(){var u=j.p;return u!==0?u:(u=window.event,u===void 0?32:t2(u.type))}function Si(u,h){var m=j.p;try{return j.p=u,h()}finally{j.p=m}}var Qe=Math.random().toString(36).slice(2),Re="__reactFiber$"+Qe,We="__reactProps$"+Qe,Ti="__reactContainer$"+Qe,Hi="__reactEvents$"+Qe,ps="__reactListeners$"+Qe,ys="__reactHandles$"+Qe,Ea="__reactResources$"+Qe,$n="__reactMarker$"+Qe;function ko(u){delete u[Re],delete u[We],delete u[Hi],delete u[ps],delete u[ys]}function Br(u){var h=u[Re];if(h)return h;for(var m=u.parentNode;m;){if(h=m[Ti]||m[Re]){if(m=h.alternate,h.child!==null||m!==null&&m.child!==null)for(u=Ux(u);u!==null;){if(m=u[Re])return m;u=Ux(u)}return h}u=m,m=u.parentNode}return null}function Fr(u){if(u=u[Re]||u[Ti]){var h=u.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return u}return null}function Oa(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u.stateNode;throw Error(r(33))}function Lr(u){var h=u[Ea];return h||(h=u[Ea]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function ri(u){u[$n]=!0}var gs=new Set,ms={};function dr(u,h){Ur(u,h),Ur(u+"Capture",h)}function Ur(u,h){for(ms[u]=h,u=0;u<h.length;u++)gs.add(h[u])}var Ak=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),I1={},k1={};function Pk(u){return It.call(k1,u)?!0:It.call(I1,u)?!1:Ak.test(u)?k1[u]=!0:(I1[u]=!0,!1)}function _f(u,h,m){if(Pk(h))if(m===null)u.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":u.removeAttribute(h);return;case"boolean":var x=h.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){u.removeAttribute(h);return}}u.setAttribute(h,""+m)}}function Sf(u,h,m){if(m===null)u.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(h);return}u.setAttribute(h,""+m)}}function qr(u,h,m,x){if(x===null)u.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(m);return}u.setAttributeNS(h,m,""+x)}}var B0,E1;function Eo(u){if(B0===void 0)try{throw Error()}catch(m){var h=m.stack.trim().match(/\n( *(at )?)/);B0=h&&h[1]||"",E1=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+B0+u+E1}var F0=!1;function L0(u,h){if(!u||F0)return"";F0=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(h){var At=function(){throw Error()};if(Object.defineProperty(At.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(At,[])}catch(mt){var gt=mt}Reflect.construct(u,[],At)}else{try{At.call()}catch(mt){gt=mt}u.call(At.prototype)}}else{try{throw Error()}catch(mt){gt=mt}(At=u())&&typeof At.catch=="function"&&At.catch(function(){})}}catch(mt){if(mt&&gt&&typeof mt.stack=="string")return[mt.stack,gt.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=x.DetermineComponentFrameRoot(),B=M[0],H=M[1];if(B&&H){var Z=B.split(`
`),pt=H.split(`
`);for(E=x=0;x<Z.length&&!Z[x].includes("DetermineComponentFrameRoot");)x++;for(;E<pt.length&&!pt[E].includes("DetermineComponentFrameRoot");)E++;if(x===Z.length||E===pt.length)for(x=Z.length-1,E=pt.length-1;1<=x&&0<=E&&Z[x]!==pt[E];)E--;for(;1<=x&&0<=E;x--,E--)if(Z[x]!==pt[E]){if(x!==1||E!==1)do if(x--,E--,0>E||Z[x]!==pt[E]){var kt=`
`+Z[x].replace(" at new "," at ");return u.displayName&&kt.includes("<anonymous>")&&(kt=kt.replace("<anonymous>",u.displayName)),kt}while(1<=x&&0<=E);break}}}finally{F0=!1,Error.prepareStackTrace=m}return(m=u?u.displayName||u.name:"")?Eo(m):""}function Rk(u){switch(u.tag){case 26:case 27:case 5:return Eo(u.type);case 16:return Eo("Lazy");case 13:return Eo("Suspense");case 19:return Eo("SuspenseList");case 0:case 15:return L0(u.type,!1);case 11:return L0(u.type.render,!1);case 1:return L0(u.type,!0);case 31:return Eo("Activity");default:return""}}function O1(u){try{var h="";do h+=Rk(u),u=u.return;while(u);return h}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function gn(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function A1(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Mk(u){var h=A1(u)?"checked":"value",m=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),x=""+u[h];if(!u.hasOwnProperty(h)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var E=m.get,M=m.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return E.call(this)},set:function(B){x=""+B,M.call(this,B)}}),Object.defineProperty(u,h,{enumerable:m.enumerable}),{getValue:function(){return x},setValue:function(B){x=""+B},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function Tf(u){u._valueTracker||(u._valueTracker=Mk(u))}function P1(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var m=h.getValue(),x="";return u&&(x=A1(u)?u.checked?"true":"false":u.value),u=x,u!==m?(h.setValue(u),!0):!1}function If(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var Nk=/[\n"\\]/g;function mn(u){return u.replace(Nk,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function U0(u,h,m,x,E,M,B,H){u.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?u.type=B:u.removeAttribute("type"),h!=null?B==="number"?(h===0&&u.value===""||u.value!=h)&&(u.value=""+gn(h)):u.value!==""+gn(h)&&(u.value=""+gn(h)):B!=="submit"&&B!=="reset"||u.removeAttribute("value"),h!=null?q0(u,B,gn(h)):m!=null?q0(u,B,gn(m)):x!=null&&u.removeAttribute("value"),E==null&&M!=null&&(u.defaultChecked=!!M),E!=null&&(u.checked=E&&typeof E!="function"&&typeof E!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?u.name=""+gn(H):u.removeAttribute("name")}function R1(u,h,m,x,E,M,B,H){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(u.type=M),h!=null||m!=null){if(!(M!=="submit"&&M!=="reset"||h!=null))return;m=m!=null?""+gn(m):"",h=h!=null?""+gn(h):m,H||h===u.value||(u.value=h),u.defaultValue=h}x=x??E,x=typeof x!="function"&&typeof x!="symbol"&&!!x,u.checked=H?u.checked:!!x,u.defaultChecked=!!x,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(u.name=B)}function q0(u,h,m){h==="number"&&If(u.ownerDocument)===u||u.defaultValue===""+m||(u.defaultValue=""+m)}function Oo(u,h,m,x){if(u=u.options,h){h={};for(var E=0;E<m.length;E++)h["$"+m[E]]=!0;for(m=0;m<u.length;m++)E=h.hasOwnProperty("$"+u[m].value),u[m].selected!==E&&(u[m].selected=E),E&&x&&(u[m].defaultSelected=!0)}else{for(m=""+gn(m),h=null,E=0;E<u.length;E++){if(u[E].value===m){u[E].selected=!0,x&&(u[E].defaultSelected=!0);return}h!==null||u[E].disabled||(h=u[E])}h!==null&&(h.selected=!0)}}function M1(u,h,m){if(h!=null&&(h=""+gn(h),h!==u.value&&(u.value=h),m==null)){u.defaultValue!==h&&(u.defaultValue=h);return}u.defaultValue=m!=null?""+gn(m):""}function N1(u,h,m,x){if(h==null){if(x!=null){if(m!=null)throw Error(r(92));if(F(x)){if(1<x.length)throw Error(r(93));x=x[0]}m=x}m==null&&(m=""),h=m}m=gn(h),u.defaultValue=m,x=u.textContent,x===m&&x!==""&&x!==null&&(u.value=x)}function Ao(u,h){if(h){var m=u.firstChild;if(m&&m===u.lastChild&&m.nodeType===3){m.nodeValue=h;return}}u.textContent=h}var Ck=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function C1(u,h,m){var x=h.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?u.setProperty(h,""):h==="float"?u.cssFloat="":u[h]="":x?u.setProperty(h,m):typeof m!="number"||m===0||Ck.has(h)?h==="float"?u.cssFloat=m:u[h]=(""+m).trim():u[h]=m+"px"}function D1(u,h,m){if(h!=null&&typeof h!="object")throw Error(r(62));if(u=u.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||h!=null&&h.hasOwnProperty(x)||(x.indexOf("--")===0?u.setProperty(x,""):x==="float"?u.cssFloat="":u[x]="");for(var E in h)x=h[E],h.hasOwnProperty(E)&&m[E]!==x&&C1(u,E,x)}else for(var M in h)h.hasOwnProperty(M)&&C1(u,M,h[M])}function j0(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kf(u){return Bk.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var H0=null;function K0(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Po=null,Ro=null;function B1(u){var h=Fr(u);if(h&&(u=h.stateNode)){var m=u[We]||null;t:switch(u=h.stateNode,h.type){case"input":if(U0(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),h=m.name,m.type==="radio"&&h!=null){for(m=u;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+mn(""+h)+'"][type="radio"]'),h=0;h<m.length;h++){var x=m[h];if(x!==u&&x.form===u.form){var E=x[We]||null;if(!E)throw Error(r(90));U0(x,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(h=0;h<m.length;h++)x=m[h],x.form===u.form&&P1(x)}break t;case"textarea":M1(u,m.value,m.defaultValue);break t;case"select":h=m.value,h!=null&&Oo(u,!!m.multiple,h,!1)}}}var V0=!1;function F1(u,h,m){if(V0)return u(h,m);V0=!0;try{var x=u(h);return x}finally{if(V0=!1,(Po!==null||Ro!==null)&&(dh(),Po&&(h=Po,u=Ro,Ro=Po=null,B1(h),u)))for(h=0;h<u.length;h++)B1(u[h])}}function _u(u,h){var m=u.stateNode;if(m===null)return null;var x=m[We]||null;if(x===null)return null;m=x[h];t:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(u=u.type,x=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!x;break t;default:u=!1}if(u)return null;if(m&&typeof m!="function")throw Error(r(231,h,typeof m));return m}var jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),W0=!1;if(jr)try{var Su={};Object.defineProperty(Su,"passive",{get:function(){W0=!0}}),window.addEventListener("test",Su,Su),window.removeEventListener("test",Su,Su)}catch{W0=!1}var Aa=null,$0=null,Ef=null;function L1(){if(Ef)return Ef;var u,h=$0,m=h.length,x,E="value"in Aa?Aa.value:Aa.textContent,M=E.length;for(u=0;u<m&&h[u]===E[u];u++);var B=m-u;for(x=1;x<=B&&h[m-x]===E[M-x];x++);return Ef=E.slice(u,1<x?1-x:void 0)}function Of(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function Af(){return!0}function U1(){return!1}function Ki(u){function h(m,x,E,M,B){this._reactName=m,this._targetInst=E,this.type=x,this.nativeEvent=M,this.target=B,this.currentTarget=null;for(var H in u)u.hasOwnProperty(H)&&(m=u[H],this[H]=m?m(M):M[H]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Af:U1,this.isPropagationStopped=U1,this}return c(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Af)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Af)},persist:function(){},isPersistent:Af}),h}var bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=Ki(bs),Tu=c({},bs,{view:0,detail:0}),Fk=Ki(Tu),z0,X0,Iu,Rf=c({},Tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y0,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Iu&&(Iu&&u.type==="mousemove"?(z0=u.screenX-Iu.screenX,X0=u.screenY-Iu.screenY):X0=z0=0,Iu=u),z0)},movementY:function(u){return"movementY"in u?u.movementY:X0}}),q1=Ki(Rf),Lk=c({},Rf,{dataTransfer:0}),Uk=Ki(Lk),qk=c({},Tu,{relatedTarget:0}),G0=Ki(qk),jk=c({},bs,{animationName:0,elapsedTime:0,pseudoElement:0}),Hk=Ki(jk),Kk=c({},bs,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Vk=Ki(Kk),Wk=c({},bs,{data:0}),j1=Ki(Wk),$k={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gk(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=Xk[u])?!!h[u]:!1}function Y0(){return Gk}var Yk=c({},Tu,{key:function(u){if(u.key){var h=$k[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Of(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?zk[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y0,charCode:function(u){return u.type==="keypress"?Of(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Of(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Qk=Ki(Yk),Zk=c({},Rf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H1=Ki(Zk),Jk=c({},Tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y0}),t5=Ki(Jk),e5=c({},bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),i5=Ki(e5),n5=c({},Rf,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),r5=Ki(n5),a5=c({},bs,{newState:0,oldState:0}),s5=Ki(a5),o5=[9,13,27,32],Q0=jr&&"CompositionEvent"in window,ku=null;jr&&"documentMode"in document&&(ku=document.documentMode);var c5=jr&&"TextEvent"in window&&!ku,K1=jr&&(!Q0||ku&&8<ku&&11>=ku),V1=" ",W1=!1;function $1(u,h){switch(u){case"keyup":return o5.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z1(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Mo=!1;function u5(u,h){switch(u){case"compositionend":return z1(h);case"keypress":return h.which!==32?null:(W1=!0,V1);case"textInput":return u=h.data,u===V1&&W1?null:u;default:return null}}function l5(u,h){if(Mo)return u==="compositionend"||!Q0&&$1(u,h)?(u=L1(),Ef=$0=Aa=null,Mo=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return K1&&h.locale!=="ko"?null:h.data;default:return null}}var d5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X1(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!d5[u.type]:h==="textarea"}function G1(u,h,m,x){Po?Ro?Ro.push(x):Ro=[x]:Po=x,h=mh(h,"onChange"),0<h.length&&(m=new Pf("onChange","change",null,m,x),u.push({event:m,listeners:h}))}var Eu=null,Ou=null;function f5(u){Ax(u,0)}function Mf(u){var h=Oa(u);if(P1(h))return u}function Y1(u,h){if(u==="change")return h}var Q1=!1;if(jr){var Z0;if(jr){var J0="oninput"in document;if(!J0){var Z1=document.createElement("div");Z1.setAttribute("oninput","return;"),J0=typeof Z1.oninput=="function"}Z0=J0}else Z0=!1;Q1=Z0&&(!document.documentMode||9<document.documentMode)}function J1(){Eu&&(Eu.detachEvent("onpropertychange",tw),Ou=Eu=null)}function tw(u){if(u.propertyName==="value"&&Mf(Ou)){var h=[];G1(h,Ou,u,K0(u)),F1(f5,h)}}function h5(u,h,m){u==="focusin"?(J1(),Eu=h,Ou=m,Eu.attachEvent("onpropertychange",tw)):u==="focusout"&&J1()}function p5(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Mf(Ou)}function y5(u,h){if(u==="click")return Mf(h)}function g5(u,h){if(u==="input"||u==="change")return Mf(h)}function m5(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var Ji=typeof Object.is=="function"?Object.is:m5;function Au(u,h){if(Ji(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var m=Object.keys(u),x=Object.keys(h);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var E=m[x];if(!It.call(h,E)||!Ji(u[E],h[E]))return!1}return!0}function ew(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function iw(u,h){var m=ew(u);u=0;for(var x;m;){if(m.nodeType===3){if(x=u+m.textContent.length,u<=h&&x>=h)return{node:m,offset:h-u};u=x}t:{for(;m;){if(m.nextSibling){m=m.nextSibling;break t}m=m.parentNode}m=void 0}m=ew(m)}}function nw(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?nw(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function rw(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var h=If(u.document);h instanceof u.HTMLIFrameElement;){try{var m=typeof h.contentWindow.location.href=="string"}catch{m=!1}if(m)u=h.contentWindow;else break;h=If(u.document)}return h}function ty(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}var b5=jr&&"documentMode"in document&&11>=document.documentMode,No=null,ey=null,Pu=null,iy=!1;function aw(u,h,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;iy||No==null||No!==If(x)||(x=No,"selectionStart"in x&&ty(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Pu&&Au(Pu,x)||(Pu=x,x=mh(ey,"onSelect"),0<x.length&&(h=new Pf("onSelect","select",null,h,m),u.push({event:h,listeners:x}),h.target=No)))}function ws(u,h){var m={};return m[u.toLowerCase()]=h.toLowerCase(),m["Webkit"+u]="webkit"+h,m["Moz"+u]="moz"+h,m}var Co={animationend:ws("Animation","AnimationEnd"),animationiteration:ws("Animation","AnimationIteration"),animationstart:ws("Animation","AnimationStart"),transitionrun:ws("Transition","TransitionRun"),transitionstart:ws("Transition","TransitionStart"),transitioncancel:ws("Transition","TransitionCancel"),transitionend:ws("Transition","TransitionEnd")},ny={},sw={};jr&&(sw=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);function vs(u){if(ny[u])return ny[u];if(!Co[u])return u;var h=Co[u],m;for(m in h)if(h.hasOwnProperty(m)&&m in sw)return ny[u]=h[m];return u}var ow=vs("animationend"),cw=vs("animationiteration"),uw=vs("animationstart"),w5=vs("transitionrun"),v5=vs("transitionstart"),x5=vs("transitioncancel"),lw=vs("transitionend"),dw=new Map,ry="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ry.push("scrollEnd");function zn(u,h){dw.set(u,h),dr(h,[u])}var fw=new WeakMap;function bn(u,h){if(typeof u=="object"&&u!==null){var m=fw.get(u);return m!==void 0?m:(h={value:u,source:h,stack:O1(h)},fw.set(u,h),h)}return{value:u,source:h,stack:O1(h)}}var wn=[],Do=0,ay=0;function Nf(){for(var u=Do,h=ay=Do=0;h<u;){var m=wn[h];wn[h++]=null;var x=wn[h];wn[h++]=null;var E=wn[h];wn[h++]=null;var M=wn[h];if(wn[h++]=null,x!==null&&E!==null){var B=x.pending;B===null?E.next=E:(E.next=B.next,B.next=E),x.pending=E}M!==0&&hw(m,E,M)}}function Cf(u,h,m,x){wn[Do++]=u,wn[Do++]=h,wn[Do++]=m,wn[Do++]=x,ay|=x,u.lanes|=x,u=u.alternate,u!==null&&(u.lanes|=x)}function sy(u,h,m,x){return Cf(u,h,m,x),Df(u)}function Bo(u,h){return Cf(u,null,null,h),Df(u)}function hw(u,h,m){u.lanes|=m;var x=u.alternate;x!==null&&(x.lanes|=m);for(var E=!1,M=u.return;M!==null;)M.childLanes|=m,x=M.alternate,x!==null&&(x.childLanes|=m),M.tag===22&&(u=M.stateNode,u===null||u._visibility&1||(E=!0)),u=M,M=M.return;return u.tag===3?(M=u.stateNode,E&&h!==null&&(E=31-Rt(m),u=M.hiddenUpdates,x=u[E],x===null?u[E]=[h]:x.push(h),h.lane=m|536870912),M):null}function Df(u){if(50<el)throw el=0,fg=null,Error(r(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}var Fo={};function _5(u,h,m,x){this.tag=u,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(u,h,m,x){return new _5(u,h,m,x)}function oy(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Hr(u,h){var m=u.alternate;return m===null?(m=tn(u.tag,h,u.key,u.mode),m.elementType=u.elementType,m.type=u.type,m.stateNode=u.stateNode,m.alternate=u,u.alternate=m):(m.pendingProps=h,m.type=u.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=u.flags&65011712,m.childLanes=u.childLanes,m.lanes=u.lanes,m.child=u.child,m.memoizedProps=u.memoizedProps,m.memoizedState=u.memoizedState,m.updateQueue=u.updateQueue,h=u.dependencies,m.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},m.sibling=u.sibling,m.index=u.index,m.ref=u.ref,m.refCleanup=u.refCleanup,m}function pw(u,h){u.flags&=65011714;var m=u.alternate;return m===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=m.childLanes,u.lanes=m.lanes,u.child=m.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=m.memoizedProps,u.memoizedState=m.memoizedState,u.updateQueue=m.updateQueue,u.type=m.type,h=m.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function Bf(u,h,m,x,E,M){var B=0;if(x=u,typeof u=="function")oy(u)&&(B=1);else if(typeof u=="string")B=TE(u,m,J.current)?26:u==="html"||u==="head"||u==="body"?27:5;else t:switch(u){case R:return u=tn(31,m,h,E),u.elementType=R,u.lanes=M,u;case g:return xs(m.children,E,M,h);case b:B=8,E|=24;break;case w:return u=tn(12,m,h,E|2),u.elementType=w,u.lanes=M,u;case I:return u=tn(13,m,h,E),u.elementType=I,u.lanes=M,u;case k:return u=tn(19,m,h,E),u.elementType=k,u.lanes=M,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case v:case S:B=10;break t;case _:B=9;break t;case T:B=11;break t;case O:B=14;break t;case A:B=16,x=null;break t}B=29,m=Error(r(130,u===null?"null":typeof u,"")),x=null}return h=tn(B,m,h,E),h.elementType=u,h.type=x,h.lanes=M,h}function xs(u,h,m,x){return u=tn(7,u,x,h),u.lanes=m,u}function cy(u,h,m){return u=tn(6,u,null,h),u.lanes=m,u}function uy(u,h,m){return h=tn(4,u.children!==null?u.children:[],u.key,h),h.lanes=m,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}var Lo=[],Uo=0,Ff=null,Lf=0,vn=[],xn=0,_s=null,Kr=1,Vr="";function Ss(u,h){Lo[Uo++]=Lf,Lo[Uo++]=Ff,Ff=u,Lf=h}function yw(u,h,m){vn[xn++]=Kr,vn[xn++]=Vr,vn[xn++]=_s,_s=u;var x=Kr;u=Vr;var E=32-Rt(x)-1;x&=~(1<<E),m+=1;var M=32-Rt(h)+E;if(30<M){var B=E-E%5;M=(x&(1<<B)-1).toString(32),x>>=B,E-=B,Kr=1<<32-Rt(h)+E|m<<E|x,Vr=M+u}else Kr=1<<M|m<<E|x,Vr=u}function ly(u){u.return!==null&&(Ss(u,1),yw(u,1,0))}function dy(u){for(;u===Ff;)Ff=Lo[--Uo],Lo[Uo]=null,Lf=Lo[--Uo],Lo[Uo]=null;for(;u===_s;)_s=vn[--xn],vn[xn]=null,Vr=vn[--xn],vn[xn]=null,Kr=vn[--xn],vn[xn]=null}var Ui=null,Ze=null,Ee=!1,Ts=null,fr=!1,fy=Error(r(519));function Is(u){var h=Error(r(418,""));throw Nu(bn(h,u)),fy}function gw(u){var h=u.stateNode,m=u.type,x=u.memoizedProps;switch(h[Re]=u,h[We]=x,m){case"dialog":we("cancel",h),we("close",h);break;case"iframe":case"object":case"embed":we("load",h);break;case"video":case"audio":for(m=0;m<nl.length;m++)we(nl[m],h);break;case"source":we("error",h);break;case"img":case"image":case"link":we("error",h),we("load",h);break;case"details":we("toggle",h);break;case"input":we("invalid",h),R1(h,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Tf(h);break;case"select":we("invalid",h);break;case"textarea":we("invalid",h),N1(h,x.value,x.defaultValue,x.children),Tf(h)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||h.textContent===""+m||x.suppressHydrationWarning===!0||Nx(h.textContent,m)?(x.popover!=null&&(we("beforetoggle",h),we("toggle",h)),x.onScroll!=null&&we("scroll",h),x.onScrollEnd!=null&&we("scrollend",h),x.onClick!=null&&(h.onclick=bh),h=!0):h=!1,h||Is(u)}function mw(u){for(Ui=u.return;Ui;)switch(Ui.tag){case 5:case 13:fr=!1;return;case 27:case 3:fr=!0;return;default:Ui=Ui.return}}function Ru(u){if(u!==Ui)return!1;if(!Ee)return mw(u),Ee=!0,!1;var h=u.tag,m;if((m=h!==3&&h!==27)&&((m=h===5)&&(m=u.type,m=!(m!=="form"&&m!=="button")||Og(u.type,u.memoizedProps)),m=!m),m&&Ze&&Is(u),mw(u),h===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));t:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8)if(m=u.data,m==="/$"){if(h===0){Ze=Gn(u.nextSibling);break t}h--}else m!=="$"&&m!=="$!"&&m!=="$?"||h++;u=u.nextSibling}Ze=null}}else h===27?(h=Ze,Wa(u.type)?(u=Mg,Mg=null,Ze=u):Ze=h):Ze=Ui?Gn(u.stateNode.nextSibling):null;return!0}function Mu(){Ze=Ui=null,Ee=!1}function bw(){var u=Ts;return u!==null&&($i===null?$i=u:$i.push.apply($i,u),Ts=null),u}function Nu(u){Ts===null?Ts=[u]:Ts.push(u)}var hy=$(null),ks=null,Wr=null;function Pa(u,h,m){Q(hy,h._currentValue),h._currentValue=m}function $r(u){u._currentValue=hy.current,Y(hy)}function py(u,h,m){for(;u!==null;){var x=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,x!==null&&(x.childLanes|=h)):x!==null&&(x.childLanes&h)!==h&&(x.childLanes|=h),u===m)break;u=u.return}}function yy(u,h,m,x){var E=u.child;for(E!==null&&(E.return=u);E!==null;){var M=E.dependencies;if(M!==null){var B=E.child;M=M.firstContext;t:for(;M!==null;){var H=M;M=E;for(var Z=0;Z<h.length;Z++)if(H.context===h[Z]){M.lanes|=m,H=M.alternate,H!==null&&(H.lanes|=m),py(M.return,m,u),x||(B=null);break t}M=H.next}}else if(E.tag===18){if(B=E.return,B===null)throw Error(r(341));B.lanes|=m,M=B.alternate,M!==null&&(M.lanes|=m),py(B,m,u),B=null}else B=E.child;if(B!==null)B.return=E;else for(B=E;B!==null;){if(B===u){B=null;break}if(E=B.sibling,E!==null){E.return=B.return,B=E;break}B=B.return}E=B}}function Cu(u,h,m,x){u=null;for(var E=h,M=!1;E!==null;){if(!M){if((E.flags&524288)!==0)M=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var B=E.alternate;if(B===null)throw Error(r(387));if(B=B.memoizedProps,B!==null){var H=E.type;Ji(E.pendingProps.value,B.value)||(u!==null?u.push(H):u=[H])}}else if(E===dt.current){if(B=E.alternate,B===null)throw Error(r(387));B.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(u!==null?u.push(ul):u=[ul])}E=E.return}u!==null&&yy(h,u,m,x),h.flags|=262144}function Uf(u){for(u=u.firstContext;u!==null;){if(!Ji(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Es(u){ks=u,Wr=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Bi(u){return ww(ks,u)}function qf(u,h){return ks===null&&Es(u),ww(u,h)}function ww(u,h){var m=h._currentValue;if(h={context:h,memoizedValue:m,next:null},Wr===null){if(u===null)throw Error(r(308));Wr=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else Wr=Wr.next=h;return m}var S5=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(m,x){u.push(x)}};this.abort=function(){h.aborted=!0,u.forEach(function(m){return m()})}},T5=s.unstable_scheduleCallback,I5=s.unstable_NormalPriority,mi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function gy(){return{controller:new S5,data:new Map,refCount:0}}function Du(u){u.refCount--,u.refCount===0&&T5(I5,function(){u.controller.abort()})}var Bu=null,my=0,qo=0,jo=null;function k5(u,h){if(Bu===null){var m=Bu=[];my=0,qo=wg(),jo={status:"pending",value:void 0,then:function(x){m.push(x)}}}return my++,h.then(vw,vw),h}function vw(){if(--my===0&&Bu!==null){jo!==null&&(jo.status="fulfilled");var u=Bu;Bu=null,qo=0,jo=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function E5(u,h){var m=[],x={status:"pending",value:null,reason:null,then:function(E){m.push(E)}};return u.then(function(){x.status="fulfilled",x.value=h;for(var E=0;E<m.length;E++)(0,m[E])(h)},function(E){for(x.status="rejected",x.reason=E,E=0;E<m.length;E++)(0,m[E])(void 0)}),x}var xw=L.S;L.S=function(u,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&k5(u,h),xw!==null&&xw(u,h)};var Os=$(null);function by(){var u=Os.current;return u!==null?u:$e.pooledCache}function jf(u,h){h===null?Q(Os,Os.current):Q(Os,h.pool)}function _w(){var u=by();return u===null?null:{parent:mi._currentValue,pool:u}}var Fu=Error(r(460)),Sw=Error(r(474)),Hf=Error(r(542)),wy={then:function(){}};function Tw(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Kf(){}function Iw(u,h,m){switch(m=u[m],m===void 0?u.push(h):m!==h&&(h.then(Kf,Kf),h=m),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,Ew(u),u;default:if(typeof h.status=="string")h.then(Kf,Kf);else{if(u=$e,u!==null&&100<u.shellSuspendCounter)throw Error(r(482));u=h,u.status="pending",u.then(function(x){if(h.status==="pending"){var E=h;E.status="fulfilled",E.value=x}},function(x){if(h.status==="pending"){var E=h;E.status="rejected",E.reason=x}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,Ew(u),u}throw Lu=h,Fu}}var Lu=null;function kw(){if(Lu===null)throw Error(r(459));var u=Lu;return Lu=null,u}function Ew(u){if(u===Fu||u===Hf)throw Error(r(483))}var Ra=!1;function vy(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xy(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Ma(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Na(u,h,m){var x=u.updateQueue;if(x===null)return null;if(x=x.shared,(Me&2)!==0){var E=x.pending;return E===null?h.next=h:(h.next=E.next,E.next=h),x.pending=h,h=Df(u),hw(u,null,m),h}return Cf(u,x,h,m),Df(u)}function Uu(u,h,m){if(h=h.updateQueue,h!==null&&(h=h.shared,(m&4194048)!==0)){var x=h.lanes;x&=u.pendingLanes,m|=x,h.lanes=m,ee(u,m)}}function _y(u,h){var m=u.updateQueue,x=u.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var E=null,M=null;if(m=m.firstBaseUpdate,m!==null){do{var B={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};M===null?E=M=B:M=M.next=B,m=m.next}while(m!==null);M===null?E=M=h:M=M.next=h}else E=M=h;m={baseState:x.baseState,firstBaseUpdate:E,lastBaseUpdate:M,shared:x.shared,callbacks:x.callbacks},u.updateQueue=m;return}u=m.lastBaseUpdate,u===null?m.firstBaseUpdate=h:u.next=h,m.lastBaseUpdate=h}var Sy=!1;function qu(){if(Sy){var u=jo;if(u!==null)throw u}}function ju(u,h,m,x){Sy=!1;var E=u.updateQueue;Ra=!1;var M=E.firstBaseUpdate,B=E.lastBaseUpdate,H=E.shared.pending;if(H!==null){E.shared.pending=null;var Z=H,pt=Z.next;Z.next=null,B===null?M=pt:B.next=pt,B=Z;var kt=u.alternate;kt!==null&&(kt=kt.updateQueue,H=kt.lastBaseUpdate,H!==B&&(H===null?kt.firstBaseUpdate=pt:H.next=pt,kt.lastBaseUpdate=Z))}if(M!==null){var At=E.baseState;B=0,kt=pt=Z=null,H=M;do{var gt=H.lane&-536870913,mt=gt!==H.lane;if(mt?(Se&gt)===gt:(x&gt)===gt){gt!==0&&gt===qo&&(Sy=!0),kt!==null&&(kt=kt.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});t:{var ae=u,ie=H;gt=h;var Ue=m;switch(ie.tag){case 1:if(ae=ie.payload,typeof ae=="function"){At=ae.call(Ue,At,gt);break t}At=ae;break t;case 3:ae.flags=ae.flags&-65537|128;case 0:if(ae=ie.payload,gt=typeof ae=="function"?ae.call(Ue,At,gt):ae,gt==null)break t;At=c({},At,gt);break t;case 2:Ra=!0}}gt=H.callback,gt!==null&&(u.flags|=64,mt&&(u.flags|=8192),mt=E.callbacks,mt===null?E.callbacks=[gt]:mt.push(gt))}else mt={lane:gt,tag:H.tag,payload:H.payload,callback:H.callback,next:null},kt===null?(pt=kt=mt,Z=At):kt=kt.next=mt,B|=gt;if(H=H.next,H===null){if(H=E.shared.pending,H===null)break;mt=H,H=mt.next,mt.next=null,E.lastBaseUpdate=mt,E.shared.pending=null}}while(!0);kt===null&&(Z=At),E.baseState=Z,E.firstBaseUpdate=pt,E.lastBaseUpdate=kt,M===null&&(E.shared.lanes=0),ja|=B,u.lanes=B,u.memoizedState=At}}function Ow(u,h){if(typeof u!="function")throw Error(r(191,u));u.call(h)}function Aw(u,h){var m=u.callbacks;if(m!==null)for(u.callbacks=null,u=0;u<m.length;u++)Ow(m[u],h)}var Ho=$(null),Vf=$(0);function Pw(u,h){u=Jr,Q(Vf,u),Q(Ho,h),Jr=u|h.baseLanes}function Ty(){Q(Vf,Jr),Q(Ho,Ho.current)}function Iy(){Jr=Vf.current,Y(Ho),Y(Vf)}var Ca=0,he=null,Fe=null,di=null,Wf=!1,Ko=!1,As=!1,$f=0,Hu=0,Vo=null,O5=0;function ai(){throw Error(r(321))}function ky(u,h){if(h===null)return!1;for(var m=0;m<h.length&&m<u.length;m++)if(!Ji(u[m],h[m]))return!1;return!0}function Ey(u,h,m,x,E,M){return Ca=M,he=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,L.H=u===null||u.memoizedState===null?hv:pv,As=!1,M=m(x,E),As=!1,Ko&&(M=Mw(h,m,x,E)),Rw(u),M}function Rw(u){L.H=Zf;var h=Fe!==null&&Fe.next!==null;if(Ca=0,di=Fe=he=null,Wf=!1,Hu=0,Vo=null,h)throw Error(r(300));u===null||Ii||(u=u.dependencies,u!==null&&Uf(u)&&(Ii=!0))}function Mw(u,h,m,x){he=u;var E=0;do{if(Ko&&(Vo=null),Hu=0,Ko=!1,25<=E)throw Error(r(301));if(E+=1,di=Fe=null,u.updateQueue!=null){var M=u.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}L.H=D5,M=h(m,x)}while(Ko);return M}function A5(){var u=L.H,h=u.useState()[0];return h=typeof h.then=="function"?Ku(h):h,u=u.useState()[0],(Fe!==null?Fe.memoizedState:null)!==u&&(he.flags|=1024),h}function Oy(){var u=$f!==0;return $f=0,u}function Ay(u,h,m){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~m}function Py(u){if(Wf){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}Wf=!1}Ca=0,di=Fe=he=null,Ko=!1,Hu=$f=0,Vo=null}function Vi(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?he.memoizedState=di=u:di=di.next=u,di}function fi(){if(Fe===null){var u=he.alternate;u=u!==null?u.memoizedState:null}else u=Fe.next;var h=di===null?he.memoizedState:di.next;if(h!==null)di=h,Fe=u;else{if(u===null)throw he.alternate===null?Error(r(467)):Error(r(310));Fe=u,u={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},di===null?he.memoizedState=di=u:di=di.next=u}return di}function Ry(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ku(u){var h=Hu;return Hu+=1,Vo===null&&(Vo=[]),u=Iw(Vo,u,h),h=he,(di===null?h.memoizedState:di.next)===null&&(h=h.alternate,L.H=h===null||h.memoizedState===null?hv:pv),u}function zf(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Ku(u);if(u.$$typeof===S)return Bi(u)}throw Error(r(438,String(u)))}function My(u){var h=null,m=he.updateQueue;if(m!==null&&(h=m.memoCache),h==null){var x=he.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(h={data:x.data.map(function(E){return E.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),m===null&&(m=Ry(),he.updateQueue=m),m.memoCache=h,m=h.data[h.index],m===void 0)for(m=h.data[h.index]=Array(u),x=0;x<u;x++)m[x]=P;return h.index++,m}function zr(u,h){return typeof h=="function"?h(u):h}function Xf(u){var h=fi();return Ny(h,Fe,u)}function Ny(u,h,m){var x=u.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=m;var E=u.baseQueue,M=x.pending;if(M!==null){if(E!==null){var B=E.next;E.next=M.next,M.next=B}h.baseQueue=E=M,x.pending=null}if(M=u.baseState,E===null)u.memoizedState=M;else{h=E.next;var H=B=null,Z=null,pt=h,kt=!1;do{var At=pt.lane&-536870913;if(At!==pt.lane?(Se&At)===At:(Ca&At)===At){var gt=pt.revertLane;if(gt===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),At===qo&&(kt=!0);else if((Ca&gt)===gt){pt=pt.next,gt===qo&&(kt=!0);continue}else At={lane:0,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},Z===null?(H=Z=At,B=M):Z=Z.next=At,he.lanes|=gt,ja|=gt;At=pt.action,As&&m(M,At),M=pt.hasEagerState?pt.eagerState:m(M,At)}else gt={lane:At,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},Z===null?(H=Z=gt,B=M):Z=Z.next=gt,he.lanes|=At,ja|=At;pt=pt.next}while(pt!==null&&pt!==h);if(Z===null?B=M:Z.next=H,!Ji(M,u.memoizedState)&&(Ii=!0,kt&&(m=jo,m!==null)))throw m;u.memoizedState=M,u.baseState=B,u.baseQueue=Z,x.lastRenderedState=M}return E===null&&(x.lanes=0),[u.memoizedState,x.dispatch]}function Cy(u){var h=fi(),m=h.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=u;var x=m.dispatch,E=m.pending,M=h.memoizedState;if(E!==null){m.pending=null;var B=E=E.next;do M=u(M,B.action),B=B.next;while(B!==E);Ji(M,h.memoizedState)||(Ii=!0),h.memoizedState=M,h.baseQueue===null&&(h.baseState=M),m.lastRenderedState=M}return[M,x]}function Nw(u,h,m){var x=he,E=fi(),M=Ee;if(M){if(m===void 0)throw Error(r(407));m=m()}else m=h();var B=!Ji((Fe||E).memoizedState,m);B&&(E.memoizedState=m,Ii=!0),E=E.queue;var H=Bw.bind(null,x,E,u);if(Vu(2048,8,H,[u]),E.getSnapshot!==h||B||di!==null&&di.memoizedState.tag&1){if(x.flags|=2048,Wo(9,Gf(),Dw.bind(null,x,E,m,h),null),$e===null)throw Error(r(349));M||(Ca&124)!==0||Cw(x,h,m)}return m}function Cw(u,h,m){u.flags|=16384,u={getSnapshot:h,value:m},h=he.updateQueue,h===null?(h=Ry(),he.updateQueue=h,h.stores=[u]):(m=h.stores,m===null?h.stores=[u]:m.push(u))}function Dw(u,h,m,x){h.value=m,h.getSnapshot=x,Fw(h)&&Lw(u)}function Bw(u,h,m){return m(function(){Fw(h)&&Lw(u)})}function Fw(u){var h=u.getSnapshot;u=u.value;try{var m=h();return!Ji(u,m)}catch{return!0}}function Lw(u){var h=Bo(u,2);h!==null&&sn(h,u,2)}function Dy(u){var h=Vi();if(typeof u=="function"){var m=u;if(u=m(),As){Ft(!0);try{m()}finally{Ft(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:u},h}function Uw(u,h,m,x){return u.baseState=m,Ny(u,Fe,typeof x=="function"?x:zr)}function P5(u,h,m,x,E){if(Qf(u))throw Error(r(485));if(u=h.action,u!==null){var M={payload:E,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){M.listeners.push(B)}};L.T!==null?m(!0):M.isTransition=!1,x(M),m=h.pending,m===null?(M.next=h.pending=M,qw(h,M)):(M.next=m.next,h.pending=m.next=M)}}function qw(u,h){var m=h.action,x=h.payload,E=u.state;if(h.isTransition){var M=L.T,B={};L.T=B;try{var H=m(E,x),Z=L.S;Z!==null&&Z(B,H),jw(u,h,H)}catch(pt){By(u,h,pt)}finally{L.T=M}}else try{M=m(E,x),jw(u,h,M)}catch(pt){By(u,h,pt)}}function jw(u,h,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){Hw(u,h,x)},function(x){return By(u,h,x)}):Hw(u,h,m)}function Hw(u,h,m){h.status="fulfilled",h.value=m,Kw(h),u.state=m,h=u.pending,h!==null&&(m=h.next,m===h?u.pending=null:(m=m.next,h.next=m,qw(u,m)))}function By(u,h,m){var x=u.pending;if(u.pending=null,x!==null){x=x.next;do h.status="rejected",h.reason=m,Kw(h),h=h.next;while(h!==x)}u.action=null}function Kw(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function Vw(u,h){return h}function Ww(u,h){if(Ee){var m=$e.formState;if(m!==null){t:{var x=he;if(Ee){if(Ze){e:{for(var E=Ze,M=fr;E.nodeType!==8;){if(!M){E=null;break e}if(E=Gn(E.nextSibling),E===null){E=null;break e}}M=E.data,E=M==="F!"||M==="F"?E:null}if(E){Ze=Gn(E.nextSibling),x=E.data==="F!";break t}}Is(x)}x=!1}x&&(h=m[0])}}return m=Vi(),m.memoizedState=m.baseState=h,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vw,lastRenderedState:h},m.queue=x,m=lv.bind(null,he,x),x.dispatch=m,x=Dy(!1),M=jy.bind(null,he,!1,x.queue),x=Vi(),E={state:h,dispatch:null,action:u,pending:null},x.queue=E,m=P5.bind(null,he,E,M,m),E.dispatch=m,x.memoizedState=u,[h,m,!1]}function $w(u){var h=fi();return zw(h,Fe,u)}function zw(u,h,m){if(h=Ny(u,h,Vw)[0],u=Xf(zr)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var x=Ku(h)}catch(B){throw B===Fu?Hf:B}else x=h;h=fi();var E=h.queue,M=E.dispatch;return m!==h.memoizedState&&(he.flags|=2048,Wo(9,Gf(),R5.bind(null,E,m),null)),[x,M,u]}function R5(u,h){u.action=h}function Xw(u){var h=fi(),m=Fe;if(m!==null)return zw(h,m,u);fi(),h=h.memoizedState,m=fi();var x=m.queue.dispatch;return m.memoizedState=u,[h,x,!1]}function Wo(u,h,m,x){return u={tag:u,create:m,deps:x,inst:h,next:null},h=he.updateQueue,h===null&&(h=Ry(),he.updateQueue=h),m=h.lastEffect,m===null?h.lastEffect=u.next=u:(x=m.next,m.next=u,u.next=x,h.lastEffect=u),u}function Gf(){return{destroy:void 0,resource:void 0}}function Gw(){return fi().memoizedState}function Yf(u,h,m,x){var E=Vi();x=x===void 0?null:x,he.flags|=u,E.memoizedState=Wo(1|h,Gf(),m,x)}function Vu(u,h,m,x){var E=fi();x=x===void 0?null:x;var M=E.memoizedState.inst;Fe!==null&&x!==null&&ky(x,Fe.memoizedState.deps)?E.memoizedState=Wo(h,M,m,x):(he.flags|=u,E.memoizedState=Wo(1|h,M,m,x))}function Yw(u,h){Yf(8390656,8,u,h)}function Qw(u,h){Vu(2048,8,u,h)}function Zw(u,h){return Vu(4,2,u,h)}function Jw(u,h){return Vu(4,4,u,h)}function tv(u,h){if(typeof h=="function"){u=u();var m=h(u);return function(){typeof m=="function"?m():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function ev(u,h,m){m=m!=null?m.concat([u]):null,Vu(4,4,tv.bind(null,h,u),m)}function Fy(){}function iv(u,h){var m=fi();h=h===void 0?null:h;var x=m.memoizedState;return h!==null&&ky(h,x[1])?x[0]:(m.memoizedState=[u,h],u)}function nv(u,h){var m=fi();h=h===void 0?null:h;var x=m.memoizedState;if(h!==null&&ky(h,x[1]))return x[0];if(x=u(),As){Ft(!0);try{u()}finally{Ft(!1)}}return m.memoizedState=[x,h],x}function Ly(u,h,m){return m===void 0||(Ca&1073741824)!==0?u.memoizedState=h:(u.memoizedState=m,u=sx(),he.lanes|=u,ja|=u,m)}function rv(u,h,m,x){return Ji(m,h)?m:Ho.current!==null?(u=Ly(u,m,x),Ji(u,h)||(Ii=!0),u):(Ca&42)===0?(Ii=!0,u.memoizedState=m):(u=sx(),he.lanes|=u,ja|=u,h)}function av(u,h,m,x,E){var M=j.p;j.p=M!==0&&8>M?M:8;var B=L.T,H={};L.T=H,jy(u,!1,h,m);try{var Z=E(),pt=L.S;if(pt!==null&&pt(H,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var kt=E5(Z,x);Wu(u,h,kt,an(u))}else Wu(u,h,x,an(u))}catch(At){Wu(u,h,{then:function(){},status:"rejected",reason:At},an())}finally{j.p=M,L.T=B}}function M5(){}function Uy(u,h,m,x){if(u.tag!==5)throw Error(r(476));var E=sv(u).queue;av(u,E,h,V,m===null?M5:function(){return ov(u),m(x)})}function sv(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:V},next:null};var m={};return h.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:m},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function ov(u){var h=sv(u).next.queue;Wu(u,h,{},an())}function qy(){return Bi(ul)}function cv(){return fi().memoizedState}function uv(){return fi().memoizedState}function N5(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var m=an();u=Ma(m);var x=Na(h,u,m);x!==null&&(sn(x,h,m),Uu(x,h,m)),h={cache:gy()},u.payload=h;return}h=h.return}}function C5(u,h,m){var x=an();m={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},Qf(u)?dv(h,m):(m=sy(u,h,m,x),m!==null&&(sn(m,u,x),fv(m,h,x)))}function lv(u,h,m){var x=an();Wu(u,h,m,x)}function Wu(u,h,m,x){var E={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(Qf(u))dv(h,E);else{var M=u.alternate;if(u.lanes===0&&(M===null||M.lanes===0)&&(M=h.lastRenderedReducer,M!==null))try{var B=h.lastRenderedState,H=M(B,m);if(E.hasEagerState=!0,E.eagerState=H,Ji(H,B))return Cf(u,h,E,0),$e===null&&Nf(),!1}catch{}finally{}if(m=sy(u,h,E,x),m!==null)return sn(m,u,x),fv(m,h,x),!0}return!1}function jy(u,h,m,x){if(x={lane:2,revertLane:wg(),action:x,hasEagerState:!1,eagerState:null,next:null},Qf(u)){if(h)throw Error(r(479))}else h=sy(u,m,x,2),h!==null&&sn(h,u,2)}function Qf(u){var h=u.alternate;return u===he||h!==null&&h===he}function dv(u,h){Ko=Wf=!0;var m=u.pending;m===null?h.next=h:(h.next=m.next,m.next=h),u.pending=h}function fv(u,h,m){if((m&4194048)!==0){var x=h.lanes;x&=u.pendingLanes,m|=x,h.lanes=m,ee(u,m)}}var Zf={readContext:Bi,use:zf,useCallback:ai,useContext:ai,useEffect:ai,useImperativeHandle:ai,useLayoutEffect:ai,useInsertionEffect:ai,useMemo:ai,useReducer:ai,useRef:ai,useState:ai,useDebugValue:ai,useDeferredValue:ai,useTransition:ai,useSyncExternalStore:ai,useId:ai,useHostTransitionStatus:ai,useFormState:ai,useActionState:ai,useOptimistic:ai,useMemoCache:ai,useCacheRefresh:ai},hv={readContext:Bi,use:zf,useCallback:function(u,h){return Vi().memoizedState=[u,h===void 0?null:h],u},useContext:Bi,useEffect:Yw,useImperativeHandle:function(u,h,m){m=m!=null?m.concat([u]):null,Yf(4194308,4,tv.bind(null,h,u),m)},useLayoutEffect:function(u,h){return Yf(4194308,4,u,h)},useInsertionEffect:function(u,h){Yf(4,2,u,h)},useMemo:function(u,h){var m=Vi();h=h===void 0?null:h;var x=u();if(As){Ft(!0);try{u()}finally{Ft(!1)}}return m.memoizedState=[x,h],x},useReducer:function(u,h,m){var x=Vi();if(m!==void 0){var E=m(h);if(As){Ft(!0);try{m(h)}finally{Ft(!1)}}}else E=h;return x.memoizedState=x.baseState=E,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:E},x.queue=u,u=u.dispatch=C5.bind(null,he,u),[x.memoizedState,u]},useRef:function(u){var h=Vi();return u={current:u},h.memoizedState=u},useState:function(u){u=Dy(u);var h=u.queue,m=lv.bind(null,he,h);return h.dispatch=m,[u.memoizedState,m]},useDebugValue:Fy,useDeferredValue:function(u,h){var m=Vi();return Ly(m,u,h)},useTransition:function(){var u=Dy(!1);return u=av.bind(null,he,u.queue,!0,!1),Vi().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,m){var x=he,E=Vi();if(Ee){if(m===void 0)throw Error(r(407));m=m()}else{if(m=h(),$e===null)throw Error(r(349));(Se&124)!==0||Cw(x,h,m)}E.memoizedState=m;var M={value:m,getSnapshot:h};return E.queue=M,Yw(Bw.bind(null,x,M,u),[u]),x.flags|=2048,Wo(9,Gf(),Dw.bind(null,x,M,m,h),null),m},useId:function(){var u=Vi(),h=$e.identifierPrefix;if(Ee){var m=Vr,x=Kr;m=(x&~(1<<32-Rt(x)-1)).toString(32)+m,h="«"+h+"R"+m,m=$f++,0<m&&(h+="H"+m.toString(32)),h+="»"}else m=O5++,h="«"+h+"r"+m.toString(32)+"»";return u.memoizedState=h},useHostTransitionStatus:qy,useFormState:Ww,useActionState:Ww,useOptimistic:function(u){var h=Vi();h.memoizedState=h.baseState=u;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=m,h=jy.bind(null,he,!0,m),m.dispatch=h,[u,h]},useMemoCache:My,useCacheRefresh:function(){return Vi().memoizedState=N5.bind(null,he)}},pv={readContext:Bi,use:zf,useCallback:iv,useContext:Bi,useEffect:Qw,useImperativeHandle:ev,useInsertionEffect:Zw,useLayoutEffect:Jw,useMemo:nv,useReducer:Xf,useRef:Gw,useState:function(){return Xf(zr)},useDebugValue:Fy,useDeferredValue:function(u,h){var m=fi();return rv(m,Fe.memoizedState,u,h)},useTransition:function(){var u=Xf(zr)[0],h=fi().memoizedState;return[typeof u=="boolean"?u:Ku(u),h]},useSyncExternalStore:Nw,useId:cv,useHostTransitionStatus:qy,useFormState:$w,useActionState:$w,useOptimistic:function(u,h){var m=fi();return Uw(m,Fe,u,h)},useMemoCache:My,useCacheRefresh:uv},D5={readContext:Bi,use:zf,useCallback:iv,useContext:Bi,useEffect:Qw,useImperativeHandle:ev,useInsertionEffect:Zw,useLayoutEffect:Jw,useMemo:nv,useReducer:Cy,useRef:Gw,useState:function(){return Cy(zr)},useDebugValue:Fy,useDeferredValue:function(u,h){var m=fi();return Fe===null?Ly(m,u,h):rv(m,Fe.memoizedState,u,h)},useTransition:function(){var u=Cy(zr)[0],h=fi().memoizedState;return[typeof u=="boolean"?u:Ku(u),h]},useSyncExternalStore:Nw,useId:cv,useHostTransitionStatus:qy,useFormState:Xw,useActionState:Xw,useOptimistic:function(u,h){var m=fi();return Fe!==null?Uw(m,Fe,u,h):(m.baseState=u,[u,m.queue.dispatch])},useMemoCache:My,useCacheRefresh:uv},$o=null,$u=0;function Jf(u){var h=$u;return $u+=1,$o===null&&($o=[]),Iw($o,u,h)}function zu(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function th(u,h){throw h.$$typeof===d?Error(r(525)):(u=Object.prototype.toString.call(h),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function yv(u){var h=u._init;return h(u._payload)}function gv(u){function h(ct,nt){if(u){var ft=ct.deletions;ft===null?(ct.deletions=[nt],ct.flags|=16):ft.push(nt)}}function m(ct,nt){if(!u)return null;for(;nt!==null;)h(ct,nt),nt=nt.sibling;return null}function x(ct){for(var nt=new Map;ct!==null;)ct.key!==null?nt.set(ct.key,ct):nt.set(ct.index,ct),ct=ct.sibling;return nt}function E(ct,nt){return ct=Hr(ct,nt),ct.index=0,ct.sibling=null,ct}function M(ct,nt,ft){return ct.index=ft,u?(ft=ct.alternate,ft!==null?(ft=ft.index,ft<nt?(ct.flags|=67108866,nt):ft):(ct.flags|=67108866,nt)):(ct.flags|=1048576,nt)}function B(ct){return u&&ct.alternate===null&&(ct.flags|=67108866),ct}function H(ct,nt,ft,Et){return nt===null||nt.tag!==6?(nt=cy(ft,ct.mode,Et),nt.return=ct,nt):(nt=E(nt,ft),nt.return=ct,nt)}function Z(ct,nt,ft,Et){var qt=ft.type;return qt===g?kt(ct,nt,ft.props.children,Et,ft.key):nt!==null&&(nt.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===A&&yv(qt)===nt.type)?(nt=E(nt,ft.props),zu(nt,ft),nt.return=ct,nt):(nt=Bf(ft.type,ft.key,ft.props,null,ct.mode,Et),zu(nt,ft),nt.return=ct,nt)}function pt(ct,nt,ft,Et){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==ft.containerInfo||nt.stateNode.implementation!==ft.implementation?(nt=uy(ft,ct.mode,Et),nt.return=ct,nt):(nt=E(nt,ft.children||[]),nt.return=ct,nt)}function kt(ct,nt,ft,Et,qt){return nt===null||nt.tag!==7?(nt=xs(ft,ct.mode,Et,qt),nt.return=ct,nt):(nt=E(nt,ft),nt.return=ct,nt)}function At(ct,nt,ft){if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return nt=cy(""+nt,ct.mode,ft),nt.return=ct,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case y:return ft=Bf(nt.type,nt.key,nt.props,null,ct.mode,ft),zu(ft,nt),ft.return=ct,ft;case p:return nt=uy(nt,ct.mode,ft),nt.return=ct,nt;case A:var Et=nt._init;return nt=Et(nt._payload),At(ct,nt,ft)}if(F(nt)||N(nt))return nt=xs(nt,ct.mode,ft,null),nt.return=ct,nt;if(typeof nt.then=="function")return At(ct,Jf(nt),ft);if(nt.$$typeof===S)return At(ct,qf(ct,nt),ft);th(ct,nt)}return null}function gt(ct,nt,ft,Et){var qt=nt!==null?nt.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return qt!==null?null:H(ct,nt,""+ft,Et);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case y:return ft.key===qt?Z(ct,nt,ft,Et):null;case p:return ft.key===qt?pt(ct,nt,ft,Et):null;case A:return qt=ft._init,ft=qt(ft._payload),gt(ct,nt,ft,Et)}if(F(ft)||N(ft))return qt!==null?null:kt(ct,nt,ft,Et,null);if(typeof ft.then=="function")return gt(ct,nt,Jf(ft),Et);if(ft.$$typeof===S)return gt(ct,nt,qf(ct,ft),Et);th(ct,ft)}return null}function mt(ct,nt,ft,Et,qt){if(typeof Et=="string"&&Et!==""||typeof Et=="number"||typeof Et=="bigint")return ct=ct.get(ft)||null,H(nt,ct,""+Et,qt);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case y:return ct=ct.get(Et.key===null?ft:Et.key)||null,Z(nt,ct,Et,qt);case p:return ct=ct.get(Et.key===null?ft:Et.key)||null,pt(nt,ct,Et,qt);case A:var ye=Et._init;return Et=ye(Et._payload),mt(ct,nt,ft,Et,qt)}if(F(Et)||N(Et))return ct=ct.get(ft)||null,kt(nt,ct,Et,qt,null);if(typeof Et.then=="function")return mt(ct,nt,ft,Jf(Et),qt);if(Et.$$typeof===S)return mt(ct,nt,ft,qf(nt,Et),qt);th(nt,Et)}return null}function ae(ct,nt,ft,Et){for(var qt=null,ye=null,$t=nt,re=nt=0,Ei=null;$t!==null&&re<ft.length;re++){$t.index>re?(Ei=$t,$t=null):Ei=$t.sibling;var Te=gt(ct,$t,ft[re],Et);if(Te===null){$t===null&&($t=Ei);break}u&&$t&&Te.alternate===null&&h(ct,$t),nt=M(Te,nt,re),ye===null?qt=Te:ye.sibling=Te,ye=Te,$t=Ei}if(re===ft.length)return m(ct,$t),Ee&&Ss(ct,re),qt;if($t===null){for(;re<ft.length;re++)$t=At(ct,ft[re],Et),$t!==null&&(nt=M($t,nt,re),ye===null?qt=$t:ye.sibling=$t,ye=$t);return Ee&&Ss(ct,re),qt}for($t=x($t);re<ft.length;re++)Ei=mt($t,ct,re,ft[re],Et),Ei!==null&&(u&&Ei.alternate!==null&&$t.delete(Ei.key===null?re:Ei.key),nt=M(Ei,nt,re),ye===null?qt=Ei:ye.sibling=Ei,ye=Ei);return u&&$t.forEach(function(Ya){return h(ct,Ya)}),Ee&&Ss(ct,re),qt}function ie(ct,nt,ft,Et){if(ft==null)throw Error(r(151));for(var qt=null,ye=null,$t=nt,re=nt=0,Ei=null,Te=ft.next();$t!==null&&!Te.done;re++,Te=ft.next()){$t.index>re?(Ei=$t,$t=null):Ei=$t.sibling;var Ya=gt(ct,$t,Te.value,Et);if(Ya===null){$t===null&&($t=Ei);break}u&&$t&&Ya.alternate===null&&h(ct,$t),nt=M(Ya,nt,re),ye===null?qt=Ya:ye.sibling=Ya,ye=Ya,$t=Ei}if(Te.done)return m(ct,$t),Ee&&Ss(ct,re),qt;if($t===null){for(;!Te.done;re++,Te=ft.next())Te=At(ct,Te.value,Et),Te!==null&&(nt=M(Te,nt,re),ye===null?qt=Te:ye.sibling=Te,ye=Te);return Ee&&Ss(ct,re),qt}for($t=x($t);!Te.done;re++,Te=ft.next())Te=mt($t,ct,re,Te.value,Et),Te!==null&&(u&&Te.alternate!==null&&$t.delete(Te.key===null?re:Te.key),nt=M(Te,nt,re),ye===null?qt=Te:ye.sibling=Te,ye=Te);return u&&$t.forEach(function(BE){return h(ct,BE)}),Ee&&Ss(ct,re),qt}function Ue(ct,nt,ft,Et){if(typeof ft=="object"&&ft!==null&&ft.type===g&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case y:t:{for(var qt=ft.key;nt!==null;){if(nt.key===qt){if(qt=ft.type,qt===g){if(nt.tag===7){m(ct,nt.sibling),Et=E(nt,ft.props.children),Et.return=ct,ct=Et;break t}}else if(nt.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===A&&yv(qt)===nt.type){m(ct,nt.sibling),Et=E(nt,ft.props),zu(Et,ft),Et.return=ct,ct=Et;break t}m(ct,nt);break}else h(ct,nt);nt=nt.sibling}ft.type===g?(Et=xs(ft.props.children,ct.mode,Et,ft.key),Et.return=ct,ct=Et):(Et=Bf(ft.type,ft.key,ft.props,null,ct.mode,Et),zu(Et,ft),Et.return=ct,ct=Et)}return B(ct);case p:t:{for(qt=ft.key;nt!==null;){if(nt.key===qt)if(nt.tag===4&&nt.stateNode.containerInfo===ft.containerInfo&&nt.stateNode.implementation===ft.implementation){m(ct,nt.sibling),Et=E(nt,ft.children||[]),Et.return=ct,ct=Et;break t}else{m(ct,nt);break}else h(ct,nt);nt=nt.sibling}Et=uy(ft,ct.mode,Et),Et.return=ct,ct=Et}return B(ct);case A:return qt=ft._init,ft=qt(ft._payload),Ue(ct,nt,ft,Et)}if(F(ft))return ae(ct,nt,ft,Et);if(N(ft)){if(qt=N(ft),typeof qt!="function")throw Error(r(150));return ft=qt.call(ft),ie(ct,nt,ft,Et)}if(typeof ft.then=="function")return Ue(ct,nt,Jf(ft),Et);if(ft.$$typeof===S)return Ue(ct,nt,qf(ct,ft),Et);th(ct,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint"?(ft=""+ft,nt!==null&&nt.tag===6?(m(ct,nt.sibling),Et=E(nt,ft),Et.return=ct,ct=Et):(m(ct,nt),Et=cy(ft,ct.mode,Et),Et.return=ct,ct=Et),B(ct)):m(ct,nt)}return function(ct,nt,ft,Et){try{$u=0;var qt=Ue(ct,nt,ft,Et);return $o=null,qt}catch($t){if($t===Fu||$t===Hf)throw $t;var ye=tn(29,$t,null,ct.mode);return ye.lanes=Et,ye.return=ct,ye}finally{}}}var zo=gv(!0),mv=gv(!1),_n=$(null),hr=null;function Da(u){var h=u.alternate;Q(bi,bi.current&1),Q(_n,u),hr===null&&(h===null||Ho.current!==null||h.memoizedState!==null)&&(hr=u)}function bv(u){if(u.tag===22){if(Q(bi,bi.current),Q(_n,u),hr===null){var h=u.alternate;h!==null&&h.memoizedState!==null&&(hr=u)}}else Ba()}function Ba(){Q(bi,bi.current),Q(_n,_n.current)}function Xr(u){Y(_n),hr===u&&(hr=null),Y(bi)}var bi=$(0);function eh(u){for(var h=u;h!==null;){if(h.tag===13){var m=h.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||Rg(m)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Hy(u,h,m,x){h=u.memoizedState,m=m(x,h),m=m==null?h:c({},h,m),u.memoizedState=m,u.lanes===0&&(u.updateQueue.baseState=m)}var Ky={enqueueSetState:function(u,h,m){u=u._reactInternals;var x=an(),E=Ma(x);E.payload=h,m!=null&&(E.callback=m),h=Na(u,E,x),h!==null&&(sn(h,u,x),Uu(h,u,x))},enqueueReplaceState:function(u,h,m){u=u._reactInternals;var x=an(),E=Ma(x);E.tag=1,E.payload=h,m!=null&&(E.callback=m),h=Na(u,E,x),h!==null&&(sn(h,u,x),Uu(h,u,x))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var m=an(),x=Ma(m);x.tag=2,h!=null&&(x.callback=h),h=Na(u,x,m),h!==null&&(sn(h,u,m),Uu(h,u,m))}};function wv(u,h,m,x,E,M,B){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(x,M,B):h.prototype&&h.prototype.isPureReactComponent?!Au(m,x)||!Au(E,M):!0}function vv(u,h,m,x){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(m,x),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(m,x),h.state!==u&&Ky.enqueueReplaceState(h,h.state,null)}function Ps(u,h){var m=h;if("ref"in h){m={};for(var x in h)x!=="ref"&&(m[x]=h[x])}if(u=u.defaultProps){m===h&&(m=c({},m));for(var E in u)m[E]===void 0&&(m[E]=u[E])}return m}var ih=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function xv(u){ih(u)}function _v(u){console.error(u)}function Sv(u){ih(u)}function nh(u,h){try{var m=u.onUncaughtError;m(h.value,{componentStack:h.stack})}catch(x){setTimeout(function(){throw x})}}function Tv(u,h,m){try{var x=u.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Vy(u,h,m){return m=Ma(m),m.tag=3,m.payload={element:null},m.callback=function(){nh(u,h)},m}function Iv(u){return u=Ma(u),u.tag=3,u}function kv(u,h,m,x){var E=m.type.getDerivedStateFromError;if(typeof E=="function"){var M=x.value;u.payload=function(){return E(M)},u.callback=function(){Tv(h,m,x)}}var B=m.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(u.callback=function(){Tv(h,m,x),typeof E!="function"&&(Ha===null?Ha=new Set([this]):Ha.add(this));var H=x.stack;this.componentDidCatch(x.value,{componentStack:H!==null?H:""})})}function B5(u,h,m,x,E){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(h=m.alternate,h!==null&&Cu(h,m,E,!0),m=_n.current,m!==null){switch(m.tag){case 13:return hr===null?pg():m.alternate===null&&Je===0&&(Je=3),m.flags&=-257,m.flags|=65536,m.lanes=E,x===wy?m.flags|=16384:(h=m.updateQueue,h===null?m.updateQueue=new Set([x]):h.add(x),gg(u,x,E)),!1;case 22:return m.flags|=65536,x===wy?m.flags|=16384:(h=m.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=h):(m=h.retryQueue,m===null?h.retryQueue=new Set([x]):m.add(x)),gg(u,x,E)),!1}throw Error(r(435,m.tag))}return gg(u,x,E),pg(),!1}if(Ee)return h=_n.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=E,x!==fy&&(u=Error(r(422),{cause:x}),Nu(bn(u,m)))):(x!==fy&&(h=Error(r(423),{cause:x}),Nu(bn(h,m))),u=u.current.alternate,u.flags|=65536,E&=-E,u.lanes|=E,x=bn(x,m),E=Vy(u.stateNode,x,E),_y(u,E),Je!==4&&(Je=2)),!1;var M=Error(r(520),{cause:x});if(M=bn(M,m),tl===null?tl=[M]:tl.push(M),Je!==4&&(Je=2),h===null)return!0;x=bn(x,m),m=h;do{switch(m.tag){case 3:return m.flags|=65536,u=E&-E,m.lanes|=u,u=Vy(m.stateNode,x,u),_y(m,u),!1;case 1:if(h=m.type,M=m.stateNode,(m.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Ha===null||!Ha.has(M))))return m.flags|=65536,E&=-E,m.lanes|=E,E=Iv(E),kv(E,u,m,x),_y(m,E),!1}m=m.return}while(m!==null);return!1}var Ev=Error(r(461)),Ii=!1;function Mi(u,h,m,x){h.child=u===null?mv(h,null,m,x):zo(h,u.child,m,x)}function Ov(u,h,m,x,E){m=m.render;var M=h.ref;if("ref"in x){var B={};for(var H in x)H!=="ref"&&(B[H]=x[H])}else B=x;return Es(h),x=Ey(u,h,m,B,M,E),H=Oy(),u!==null&&!Ii?(Ay(u,h,E),Gr(u,h,E)):(Ee&&H&&ly(h),h.flags|=1,Mi(u,h,x,E),h.child)}function Av(u,h,m,x,E){if(u===null){var M=m.type;return typeof M=="function"&&!oy(M)&&M.defaultProps===void 0&&m.compare===null?(h.tag=15,h.type=M,Pv(u,h,M,x,E)):(u=Bf(m.type,null,x,h,h.mode,E),u.ref=h.ref,u.return=h,h.child=u)}if(M=u.child,!Zy(u,E)){var B=M.memoizedProps;if(m=m.compare,m=m!==null?m:Au,m(B,x)&&u.ref===h.ref)return Gr(u,h,E)}return h.flags|=1,u=Hr(M,x),u.ref=h.ref,u.return=h,h.child=u}function Pv(u,h,m,x,E){if(u!==null){var M=u.memoizedProps;if(Au(M,x)&&u.ref===h.ref)if(Ii=!1,h.pendingProps=x=M,Zy(u,E))(u.flags&131072)!==0&&(Ii=!0);else return h.lanes=u.lanes,Gr(u,h,E)}return Wy(u,h,m,x,E)}function Rv(u,h,m){var x=h.pendingProps,E=x.children,M=u!==null?u.memoizedState:null;if(x.mode==="hidden"){if((h.flags&128)!==0){if(x=M!==null?M.baseLanes|m:m,u!==null){for(E=h.child=u.child,M=0;E!==null;)M=M|E.lanes|E.childLanes,E=E.sibling;h.childLanes=M&~x}else h.childLanes=0,h.child=null;return Mv(u,h,x,m)}if((m&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&jf(h,M!==null?M.cachePool:null),M!==null?Pw(h,M):Ty(),bv(h);else return h.lanes=h.childLanes=536870912,Mv(u,h,M!==null?M.baseLanes|m:m,m)}else M!==null?(jf(h,M.cachePool),Pw(h,M),Ba(),h.memoizedState=null):(u!==null&&jf(h,null),Ty(),Ba());return Mi(u,h,E,m),h.child}function Mv(u,h,m,x){var E=by();return E=E===null?null:{parent:mi._currentValue,pool:E},h.memoizedState={baseLanes:m,cachePool:E},u!==null&&jf(h,null),Ty(),bv(h),u!==null&&Cu(u,h,x,!0),null}function rh(u,h){var m=h.ref;if(m===null)u!==null&&u.ref!==null&&(h.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(r(284));(u===null||u.ref!==m)&&(h.flags|=4194816)}}function Wy(u,h,m,x,E){return Es(h),m=Ey(u,h,m,x,void 0,E),x=Oy(),u!==null&&!Ii?(Ay(u,h,E),Gr(u,h,E)):(Ee&&x&&ly(h),h.flags|=1,Mi(u,h,m,E),h.child)}function Nv(u,h,m,x,E,M){return Es(h),h.updateQueue=null,m=Mw(h,x,m,E),Rw(u),x=Oy(),u!==null&&!Ii?(Ay(u,h,M),Gr(u,h,M)):(Ee&&x&&ly(h),h.flags|=1,Mi(u,h,m,M),h.child)}function Cv(u,h,m,x,E){if(Es(h),h.stateNode===null){var M=Fo,B=m.contextType;typeof B=="object"&&B!==null&&(M=Bi(B)),M=new m(x,M),h.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Ky,h.stateNode=M,M._reactInternals=h,M=h.stateNode,M.props=x,M.state=h.memoizedState,M.refs={},vy(h),B=m.contextType,M.context=typeof B=="object"&&B!==null?Bi(B):Fo,M.state=h.memoizedState,B=m.getDerivedStateFromProps,typeof B=="function"&&(Hy(h,m,B,x),M.state=h.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(B=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),B!==M.state&&Ky.enqueueReplaceState(M,M.state,null),ju(h,x,M,E),qu(),M.state=h.memoizedState),typeof M.componentDidMount=="function"&&(h.flags|=4194308),x=!0}else if(u===null){M=h.stateNode;var H=h.memoizedProps,Z=Ps(m,H);M.props=Z;var pt=M.context,kt=m.contextType;B=Fo,typeof kt=="object"&&kt!==null&&(B=Bi(kt));var At=m.getDerivedStateFromProps;kt=typeof At=="function"||typeof M.getSnapshotBeforeUpdate=="function",H=h.pendingProps!==H,kt||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(H||pt!==B)&&vv(h,M,x,B),Ra=!1;var gt=h.memoizedState;M.state=gt,ju(h,x,M,E),qu(),pt=h.memoizedState,H||gt!==pt||Ra?(typeof At=="function"&&(Hy(h,m,At,x),pt=h.memoizedState),(Z=Ra||wv(h,m,Z,x,gt,pt,B))?(kt||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(h.flags|=4194308)):(typeof M.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=x,h.memoizedState=pt),M.props=x,M.state=pt,M.context=B,x=Z):(typeof M.componentDidMount=="function"&&(h.flags|=4194308),x=!1)}else{M=h.stateNode,xy(u,h),B=h.memoizedProps,kt=Ps(m,B),M.props=kt,At=h.pendingProps,gt=M.context,pt=m.contextType,Z=Fo,typeof pt=="object"&&pt!==null&&(Z=Bi(pt)),H=m.getDerivedStateFromProps,(pt=typeof H=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(B!==At||gt!==Z)&&vv(h,M,x,Z),Ra=!1,gt=h.memoizedState,M.state=gt,ju(h,x,M,E),qu();var mt=h.memoizedState;B!==At||gt!==mt||Ra||u!==null&&u.dependencies!==null&&Uf(u.dependencies)?(typeof H=="function"&&(Hy(h,m,H,x),mt=h.memoizedState),(kt=Ra||wv(h,m,kt,x,gt,mt,Z)||u!==null&&u.dependencies!==null&&Uf(u.dependencies))?(pt||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(x,mt,Z),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(x,mt,Z)),typeof M.componentDidUpdate=="function"&&(h.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof M.componentDidUpdate!="function"||B===u.memoizedProps&&gt===u.memoizedState||(h.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||B===u.memoizedProps&&gt===u.memoizedState||(h.flags|=1024),h.memoizedProps=x,h.memoizedState=mt),M.props=x,M.state=mt,M.context=Z,x=kt):(typeof M.componentDidUpdate!="function"||B===u.memoizedProps&&gt===u.memoizedState||(h.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||B===u.memoizedProps&&gt===u.memoizedState||(h.flags|=1024),x=!1)}return M=x,rh(u,h),x=(h.flags&128)!==0,M||x?(M=h.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:M.render(),h.flags|=1,u!==null&&x?(h.child=zo(h,u.child,null,E),h.child=zo(h,null,m,E)):Mi(u,h,m,E),h.memoizedState=M.state,u=h.child):u=Gr(u,h,E),u}function Dv(u,h,m,x){return Mu(),h.flags|=256,Mi(u,h,m,x),h.child}var $y={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zy(u){return{baseLanes:u,cachePool:_w()}}function Xy(u,h,m){return u=u!==null?u.childLanes&~m:0,h&&(u|=Sn),u}function Bv(u,h,m){var x=h.pendingProps,E=!1,M=(h.flags&128)!==0,B;if((B=M)||(B=u!==null&&u.memoizedState===null?!1:(bi.current&2)!==0),B&&(E=!0,h.flags&=-129),B=(h.flags&32)!==0,h.flags&=-33,u===null){if(Ee){if(E?Da(h):Ba(),Ee){var H=Ze,Z;if(Z=H){t:{for(Z=H,H=fr;Z.nodeType!==8;){if(!H){H=null;break t}if(Z=Gn(Z.nextSibling),Z===null){H=null;break t}}H=Z}H!==null?(h.memoizedState={dehydrated:H,treeContext:_s!==null?{id:Kr,overflow:Vr}:null,retryLane:536870912,hydrationErrors:null},Z=tn(18,null,null,0),Z.stateNode=H,Z.return=h,h.child=Z,Ui=h,Ze=null,Z=!0):Z=!1}Z||Is(h)}if(H=h.memoizedState,H!==null&&(H=H.dehydrated,H!==null))return Rg(H)?h.lanes=32:h.lanes=536870912,null;Xr(h)}return H=x.children,x=x.fallback,E?(Ba(),E=h.mode,H=ah({mode:"hidden",children:H},E),x=xs(x,E,m,null),H.return=h,x.return=h,H.sibling=x,h.child=H,E=h.child,E.memoizedState=zy(m),E.childLanes=Xy(u,B,m),h.memoizedState=$y,x):(Da(h),Gy(h,H))}if(Z=u.memoizedState,Z!==null&&(H=Z.dehydrated,H!==null)){if(M)h.flags&256?(Da(h),h.flags&=-257,h=Yy(u,h,m)):h.memoizedState!==null?(Ba(),h.child=u.child,h.flags|=128,h=null):(Ba(),E=x.fallback,H=h.mode,x=ah({mode:"visible",children:x.children},H),E=xs(E,H,m,null),E.flags|=2,x.return=h,E.return=h,x.sibling=E,h.child=x,zo(h,u.child,null,m),x=h.child,x.memoizedState=zy(m),x.childLanes=Xy(u,B,m),h.memoizedState=$y,h=E);else if(Da(h),Rg(H)){if(B=H.nextSibling&&H.nextSibling.dataset,B)var pt=B.dgst;B=pt,x=Error(r(419)),x.stack="",x.digest=B,Nu({value:x,source:null,stack:null}),h=Yy(u,h,m)}else if(Ii||Cu(u,h,m,!1),B=(m&u.childLanes)!==0,Ii||B){if(B=$e,B!==null&&(x=m&-m,x=(x&42)!==0?1:pe(x),x=(x&(B.suspendedLanes|m))!==0?0:x,x!==0&&x!==Z.retryLane))throw Z.retryLane=x,Bo(u,x),sn(B,u,x),Ev;H.data==="$?"||pg(),h=Yy(u,h,m)}else H.data==="$?"?(h.flags|=192,h.child=u.child,h=null):(u=Z.treeContext,Ze=Gn(H.nextSibling),Ui=h,Ee=!0,Ts=null,fr=!1,u!==null&&(vn[xn++]=Kr,vn[xn++]=Vr,vn[xn++]=_s,Kr=u.id,Vr=u.overflow,_s=h),h=Gy(h,x.children),h.flags|=4096);return h}return E?(Ba(),E=x.fallback,H=h.mode,Z=u.child,pt=Z.sibling,x=Hr(Z,{mode:"hidden",children:x.children}),x.subtreeFlags=Z.subtreeFlags&65011712,pt!==null?E=Hr(pt,E):(E=xs(E,H,m,null),E.flags|=2),E.return=h,x.return=h,x.sibling=E,h.child=x,x=E,E=h.child,H=u.child.memoizedState,H===null?H=zy(m):(Z=H.cachePool,Z!==null?(pt=mi._currentValue,Z=Z.parent!==pt?{parent:pt,pool:pt}:Z):Z=_w(),H={baseLanes:H.baseLanes|m,cachePool:Z}),E.memoizedState=H,E.childLanes=Xy(u,B,m),h.memoizedState=$y,x):(Da(h),m=u.child,u=m.sibling,m=Hr(m,{mode:"visible",children:x.children}),m.return=h,m.sibling=null,u!==null&&(B=h.deletions,B===null?(h.deletions=[u],h.flags|=16):B.push(u)),h.child=m,h.memoizedState=null,m)}function Gy(u,h){return h=ah({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function ah(u,h){return u=tn(22,u,null,h),u.lanes=0,u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},u}function Yy(u,h,m){return zo(h,u.child,null,m),u=Gy(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function Fv(u,h,m){u.lanes|=h;var x=u.alternate;x!==null&&(x.lanes|=h),py(u.return,h,m)}function Qy(u,h,m,x,E){var M=u.memoizedState;M===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:E}:(M.isBackwards=h,M.rendering=null,M.renderingStartTime=0,M.last=x,M.tail=m,M.tailMode=E)}function Lv(u,h,m){var x=h.pendingProps,E=x.revealOrder,M=x.tail;if(Mi(u,h,x.children,m),x=bi.current,(x&2)!==0)x=x&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)t:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Fv(u,m,h);else if(u.tag===19)Fv(u,m,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break t;for(;u.sibling===null;){if(u.return===null||u.return===h)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}x&=1}switch(Q(bi,x),E){case"forwards":for(m=h.child,E=null;m!==null;)u=m.alternate,u!==null&&eh(u)===null&&(E=m),m=m.sibling;m=E,m===null?(E=h.child,h.child=null):(E=m.sibling,m.sibling=null),Qy(h,!1,E,m,M);break;case"backwards":for(m=null,E=h.child,h.child=null;E!==null;){if(u=E.alternate,u!==null&&eh(u)===null){h.child=E;break}u=E.sibling,E.sibling=m,m=E,E=u}Qy(h,!0,m,null,M);break;case"together":Qy(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Gr(u,h,m){if(u!==null&&(h.dependencies=u.dependencies),ja|=h.lanes,(m&h.childLanes)===0)if(u!==null){if(Cu(u,h,m,!1),(m&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(r(153));if(h.child!==null){for(u=h.child,m=Hr(u,u.pendingProps),h.child=m,m.return=h;u.sibling!==null;)u=u.sibling,m=m.sibling=Hr(u,u.pendingProps),m.return=h;m.sibling=null}return h.child}function Zy(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&Uf(u)))}function F5(u,h,m){switch(h.tag){case 3:yt(h,h.stateNode.containerInfo),Pa(h,mi,u.memoizedState.cache),Mu();break;case 27:case 5:tt(h);break;case 4:yt(h,h.stateNode.containerInfo);break;case 10:Pa(h,h.type,h.memoizedProps.value);break;case 13:var x=h.memoizedState;if(x!==null)return x.dehydrated!==null?(Da(h),h.flags|=128,null):(m&h.child.childLanes)!==0?Bv(u,h,m):(Da(h),u=Gr(u,h,m),u!==null?u.sibling:null);Da(h);break;case 19:var E=(u.flags&128)!==0;if(x=(m&h.childLanes)!==0,x||(Cu(u,h,m,!1),x=(m&h.childLanes)!==0),E){if(x)return Lv(u,h,m);h.flags|=128}if(E=h.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Q(bi,bi.current),x)break;return null;case 22:case 23:return h.lanes=0,Rv(u,h,m);case 24:Pa(h,mi,u.memoizedState.cache)}return Gr(u,h,m)}function Uv(u,h,m){if(u!==null)if(u.memoizedProps!==h.pendingProps)Ii=!0;else{if(!Zy(u,m)&&(h.flags&128)===0)return Ii=!1,F5(u,h,m);Ii=(u.flags&131072)!==0}else Ii=!1,Ee&&(h.flags&1048576)!==0&&yw(h,Lf,h.index);switch(h.lanes=0,h.tag){case 16:t:{u=h.pendingProps;var x=h.elementType,E=x._init;if(x=E(x._payload),h.type=x,typeof x=="function")oy(x)?(u=Ps(x,u),h.tag=1,h=Cv(null,h,x,u,m)):(h.tag=0,h=Wy(null,h,x,u,m));else{if(x!=null){if(E=x.$$typeof,E===T){h.tag=11,h=Ov(null,h,x,u,m);break t}else if(E===O){h.tag=14,h=Av(null,h,x,u,m);break t}}throw h=U(x)||x,Error(r(306,h,""))}}return h;case 0:return Wy(u,h,h.type,h.pendingProps,m);case 1:return x=h.type,E=Ps(x,h.pendingProps),Cv(u,h,x,E,m);case 3:t:{if(yt(h,h.stateNode.containerInfo),u===null)throw Error(r(387));x=h.pendingProps;var M=h.memoizedState;E=M.element,xy(u,h),ju(h,x,null,m);var B=h.memoizedState;if(x=B.cache,Pa(h,mi,x),x!==M.cache&&yy(h,[mi],m,!0),qu(),x=B.element,M.isDehydrated)if(M={element:x,isDehydrated:!1,cache:B.cache},h.updateQueue.baseState=M,h.memoizedState=M,h.flags&256){h=Dv(u,h,x,m);break t}else if(x!==E){E=bn(Error(r(424)),h),Nu(E),h=Dv(u,h,x,m);break t}else{switch(u=h.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(Ze=Gn(u.firstChild),Ui=h,Ee=!0,Ts=null,fr=!0,m=mv(h,null,x,m),h.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(Mu(),x===E){h=Gr(u,h,m);break t}Mi(u,h,x,m)}h=h.child}return h;case 26:return rh(u,h),u===null?(m=Kx(h.type,null,h.pendingProps,null))?h.memoizedState=m:Ee||(m=h.type,u=h.pendingProps,x=wh(wt.current).createElement(m),x[Re]=h,x[We]=u,Ci(x,m,u),ri(x),h.stateNode=x):h.memoizedState=Kx(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:return tt(h),u===null&&Ee&&(x=h.stateNode=qx(h.type,h.pendingProps,wt.current),Ui=h,fr=!0,E=Ze,Wa(h.type)?(Mg=E,Ze=Gn(x.firstChild)):Ze=E),Mi(u,h,h.pendingProps.children,m),rh(u,h),u===null&&(h.flags|=4194304),h.child;case 5:return u===null&&Ee&&((E=x=Ze)&&(x=dE(x,h.type,h.pendingProps,fr),x!==null?(h.stateNode=x,Ui=h,Ze=Gn(x.firstChild),fr=!1,E=!0):E=!1),E||Is(h)),tt(h),E=h.type,M=h.pendingProps,B=u!==null?u.memoizedProps:null,x=M.children,Og(E,M)?x=null:B!==null&&Og(E,B)&&(h.flags|=32),h.memoizedState!==null&&(E=Ey(u,h,A5,null,null,m),ul._currentValue=E),rh(u,h),Mi(u,h,x,m),h.child;case 6:return u===null&&Ee&&((u=m=Ze)&&(m=fE(m,h.pendingProps,fr),m!==null?(h.stateNode=m,Ui=h,Ze=null,u=!0):u=!1),u||Is(h)),null;case 13:return Bv(u,h,m);case 4:return yt(h,h.stateNode.containerInfo),x=h.pendingProps,u===null?h.child=zo(h,null,x,m):Mi(u,h,x,m),h.child;case 11:return Ov(u,h,h.type,h.pendingProps,m);case 7:return Mi(u,h,h.pendingProps,m),h.child;case 8:return Mi(u,h,h.pendingProps.children,m),h.child;case 12:return Mi(u,h,h.pendingProps.children,m),h.child;case 10:return x=h.pendingProps,Pa(h,h.type,x.value),Mi(u,h,x.children,m),h.child;case 9:return E=h.type._context,x=h.pendingProps.children,Es(h),E=Bi(E),x=x(E),h.flags|=1,Mi(u,h,x,m),h.child;case 14:return Av(u,h,h.type,h.pendingProps,m);case 15:return Pv(u,h,h.type,h.pendingProps,m);case 19:return Lv(u,h,m);case 31:return x=h.pendingProps,m=h.mode,x={mode:x.mode,children:x.children},u===null?(m=ah(x,m),m.ref=h.ref,h.child=m,m.return=h,h=m):(m=Hr(u.child,x),m.ref=h.ref,h.child=m,m.return=h,h=m),h;case 22:return Rv(u,h,m);case 24:return Es(h),x=Bi(mi),u===null?(E=by(),E===null&&(E=$e,M=gy(),E.pooledCache=M,M.refCount++,M!==null&&(E.pooledCacheLanes|=m),E=M),h.memoizedState={parent:x,cache:E},vy(h),Pa(h,mi,E)):((u.lanes&m)!==0&&(xy(u,h),ju(h,null,null,m),qu()),E=u.memoizedState,M=h.memoizedState,E.parent!==x?(E={parent:x,cache:x},h.memoizedState=E,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=E),Pa(h,mi,x)):(x=M.cache,Pa(h,mi,x),x!==E.cache&&yy(h,[mi],m,!0))),Mi(u,h,h.pendingProps.children,m),h.child;case 29:throw h.pendingProps}throw Error(r(156,h.tag))}function Yr(u){u.flags|=4}function qv(u,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!Xx(h)){if(h=_n.current,h!==null&&((Se&4194048)===Se?hr!==null:(Se&62914560)!==Se&&(Se&536870912)===0||h!==hr))throw Lu=wy,Sw;u.flags|=8192}}function sh(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?Dt():536870912,u.lanes|=h,Qo|=h)}function Xu(u,h){if(!Ee)switch(u.tailMode){case"hidden":h=u.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?u.tail=null:m.sibling=null;break;case"collapsed":m=u.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:x.sibling=null}}function Ye(u){var h=u.alternate!==null&&u.alternate.child===u.child,m=0,x=0;if(h)for(var E=u.child;E!==null;)m|=E.lanes|E.childLanes,x|=E.subtreeFlags&65011712,x|=E.flags&65011712,E.return=u,E=E.sibling;else for(E=u.child;E!==null;)m|=E.lanes|E.childLanes,x|=E.subtreeFlags,x|=E.flags,E.return=u,E=E.sibling;return u.subtreeFlags|=x,u.childLanes=m,h}function L5(u,h,m){var x=h.pendingProps;switch(dy(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ye(h),null;case 1:return Ye(h),null;case 3:return m=h.stateNode,x=null,u!==null&&(x=u.memoizedState.cache),h.memoizedState.cache!==x&&(h.flags|=2048),$r(mi),_t(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(u===null||u.child===null)&&(Ru(h)?Yr(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,bw())),Ye(h),null;case 26:return m=h.memoizedState,u===null?(Yr(h),m!==null?(Ye(h),qv(h,m)):(Ye(h),h.flags&=-16777217)):m?m!==u.memoizedState?(Yr(h),Ye(h),qv(h,m)):(Ye(h),h.flags&=-16777217):(u.memoizedProps!==x&&Yr(h),Ye(h),h.flags&=-16777217),null;case 27:xt(h),m=wt.current;var E=h.type;if(u!==null&&h.stateNode!=null)u.memoizedProps!==x&&Yr(h);else{if(!x){if(h.stateNode===null)throw Error(r(166));return Ye(h),null}u=J.current,Ru(h)?gw(h):(u=qx(E,x,m),h.stateNode=u,Yr(h))}return Ye(h),null;case 5:if(xt(h),m=h.type,u!==null&&h.stateNode!=null)u.memoizedProps!==x&&Yr(h);else{if(!x){if(h.stateNode===null)throw Error(r(166));return Ye(h),null}if(u=J.current,Ru(h))gw(h);else{switch(E=wh(wt.current),u){case 1:u=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:u=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":u=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":u=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":u=E.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof x.is=="string"?E.createElement("select",{is:x.is}):E.createElement("select"),x.multiple?u.multiple=!0:x.size&&(u.size=x.size);break;default:u=typeof x.is=="string"?E.createElement(m,{is:x.is}):E.createElement(m)}}u[Re]=h,u[We]=x;t:for(E=h.child;E!==null;){if(E.tag===5||E.tag===6)u.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===h)break t;for(;E.sibling===null;){if(E.return===null||E.return===h)break t;E=E.return}E.sibling.return=E.return,E=E.sibling}h.stateNode=u;t:switch(Ci(u,m,x),m){case"button":case"input":case"select":case"textarea":u=!!x.autoFocus;break t;case"img":u=!0;break t;default:u=!1}u&&Yr(h)}}return Ye(h),h.flags&=-16777217,null;case 6:if(u&&h.stateNode!=null)u.memoizedProps!==x&&Yr(h);else{if(typeof x!="string"&&h.stateNode===null)throw Error(r(166));if(u=wt.current,Ru(h)){if(u=h.stateNode,m=h.memoizedProps,x=null,E=Ui,E!==null)switch(E.tag){case 27:case 5:x=E.memoizedProps}u[Re]=h,u=!!(u.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||Nx(u.nodeValue,m)),u||Is(h)}else u=wh(u).createTextNode(x),u[Re]=h,h.stateNode=u}return Ye(h),null;case 13:if(x=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(E=Ru(h),x!==null&&x.dehydrated!==null){if(u===null){if(!E)throw Error(r(318));if(E=h.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(r(317));E[Re]=h}else Mu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ye(h),E=!1}else E=bw(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=E),E=!0;if(!E)return h.flags&256?(Xr(h),h):(Xr(h),null)}if(Xr(h),(h.flags&128)!==0)return h.lanes=m,h;if(m=x!==null,u=u!==null&&u.memoizedState!==null,m){x=h.child,E=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(E=x.alternate.memoizedState.cachePool.pool);var M=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(M=x.memoizedState.cachePool.pool),M!==E&&(x.flags|=2048)}return m!==u&&m&&(h.child.flags|=8192),sh(h,h.updateQueue),Ye(h),null;case 4:return _t(),u===null&&Sg(h.stateNode.containerInfo),Ye(h),null;case 10:return $r(h.type),Ye(h),null;case 19:if(Y(bi),E=h.memoizedState,E===null)return Ye(h),null;if(x=(h.flags&128)!==0,M=E.rendering,M===null)if(x)Xu(E,!1);else{if(Je!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(M=eh(u),M!==null){for(h.flags|=128,Xu(E,!1),u=M.updateQueue,h.updateQueue=u,sh(h,u),h.subtreeFlags=0,u=m,m=h.child;m!==null;)pw(m,u),m=m.sibling;return Q(bi,bi.current&1|2),h.child}u=u.sibling}E.tail!==null&&Vt()>uh&&(h.flags|=128,x=!0,Xu(E,!1),h.lanes=4194304)}else{if(!x)if(u=eh(M),u!==null){if(h.flags|=128,x=!0,u=u.updateQueue,h.updateQueue=u,sh(h,u),Xu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!M.alternate&&!Ee)return Ye(h),null}else 2*Vt()-E.renderingStartTime>uh&&m!==536870912&&(h.flags|=128,x=!0,Xu(E,!1),h.lanes=4194304);E.isBackwards?(M.sibling=h.child,h.child=M):(u=E.last,u!==null?u.sibling=M:h.child=M,E.last=M)}return E.tail!==null?(h=E.tail,E.rendering=h,E.tail=h.sibling,E.renderingStartTime=Vt(),h.sibling=null,u=bi.current,Q(bi,x?u&1|2:u&1),h):(Ye(h),null);case 22:case 23:return Xr(h),Iy(),x=h.memoizedState!==null,u!==null?u.memoizedState!==null!==x&&(h.flags|=8192):x&&(h.flags|=8192),x?(m&536870912)!==0&&(h.flags&128)===0&&(Ye(h),h.subtreeFlags&6&&(h.flags|=8192)):Ye(h),m=h.updateQueue,m!==null&&sh(h,m.retryQueue),m=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==m&&(h.flags|=2048),u!==null&&Y(Os),null;case 24:return m=null,u!==null&&(m=u.memoizedState.cache),h.memoizedState.cache!==m&&(h.flags|=2048),$r(mi),Ye(h),null;case 25:return null;case 30:return null}throw Error(r(156,h.tag))}function U5(u,h){switch(dy(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return $r(mi),_t(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return xt(h),null;case 13:if(Xr(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(r(340));Mu()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return Y(bi),null;case 4:return _t(),null;case 10:return $r(h.type),null;case 22:case 23:return Xr(h),Iy(),u!==null&&Y(Os),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return $r(mi),null;case 25:return null;default:return null}}function jv(u,h){switch(dy(h),h.tag){case 3:$r(mi),_t();break;case 26:case 27:case 5:xt(h);break;case 4:_t();break;case 13:Xr(h);break;case 19:Y(bi);break;case 10:$r(h.type);break;case 22:case 23:Xr(h),Iy(),u!==null&&Y(Os);break;case 24:$r(mi)}}function Gu(u,h){try{var m=h.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var E=x.next;m=E;do{if((m.tag&u)===u){x=void 0;var M=m.create,B=m.inst;x=M(),B.destroy=x}m=m.next}while(m!==E)}}catch(H){je(h,h.return,H)}}function Fa(u,h,m){try{var x=h.updateQueue,E=x!==null?x.lastEffect:null;if(E!==null){var M=E.next;x=M;do{if((x.tag&u)===u){var B=x.inst,H=B.destroy;if(H!==void 0){B.destroy=void 0,E=h;var Z=m,pt=H;try{pt()}catch(kt){je(E,Z,kt)}}}x=x.next}while(x!==M)}}catch(kt){je(h,h.return,kt)}}function Hv(u){var h=u.updateQueue;if(h!==null){var m=u.stateNode;try{Aw(h,m)}catch(x){je(u,u.return,x)}}}function Kv(u,h,m){m.props=Ps(u.type,u.memoizedProps),m.state=u.memoizedState;try{m.componentWillUnmount()}catch(x){je(u,h,x)}}function Yu(u,h){try{var m=u.ref;if(m!==null){switch(u.tag){case 26:case 27:case 5:var x=u.stateNode;break;case 30:x=u.stateNode;break;default:x=u.stateNode}typeof m=="function"?u.refCleanup=m(x):m.current=x}}catch(E){je(u,h,E)}}function pr(u,h){var m=u.ref,x=u.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(E){je(u,h,E)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(E){je(u,h,E)}else m.current=null}function Vv(u){var h=u.type,m=u.memoizedProps,x=u.stateNode;try{t:switch(h){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break t;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(E){je(u,u.return,E)}}function Jy(u,h,m){try{var x=u.stateNode;sE(x,u.type,m,h),x[We]=h}catch(E){je(u,u.return,E)}}function Wv(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Wa(u.type)||u.tag===4}function tg(u){t:for(;;){for(;u.sibling===null;){if(u.return===null||Wv(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Wa(u.type)||u.flags&2||u.child===null||u.tag===4)continue t;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function eg(u,h,m){var x=u.tag;if(x===5||x===6)u=u.stateNode,h?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(u,h):(h=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,h.appendChild(u),m=m._reactRootContainer,m!=null||h.onclick!==null||(h.onclick=bh));else if(x!==4&&(x===27&&Wa(u.type)&&(m=u.stateNode,h=null),u=u.child,u!==null))for(eg(u,h,m),u=u.sibling;u!==null;)eg(u,h,m),u=u.sibling}function oh(u,h,m){var x=u.tag;if(x===5||x===6)u=u.stateNode,h?m.insertBefore(u,h):m.appendChild(u);else if(x!==4&&(x===27&&Wa(u.type)&&(m=u.stateNode),u=u.child,u!==null))for(oh(u,h,m),u=u.sibling;u!==null;)oh(u,h,m),u=u.sibling}function $v(u){var h=u.stateNode,m=u.memoizedProps;try{for(var x=u.type,E=h.attributes;E.length;)h.removeAttributeNode(E[0]);Ci(h,x,m),h[Re]=u,h[We]=m}catch(M){je(u,u.return,M)}}var Qr=!1,si=!1,ig=!1,zv=typeof WeakSet=="function"?WeakSet:Set,ki=null;function q5(u,h){if(u=u.containerInfo,kg=Ih,u=rw(u),ty(u)){if("selectionStart"in u)var m={start:u.selectionStart,end:u.selectionEnd};else t:{m=(m=u.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var E=x.anchorOffset,M=x.focusNode;x=x.focusOffset;try{m.nodeType,M.nodeType}catch{m=null;break t}var B=0,H=-1,Z=-1,pt=0,kt=0,At=u,gt=null;e:for(;;){for(var mt;At!==m||E!==0&&At.nodeType!==3||(H=B+E),At!==M||x!==0&&At.nodeType!==3||(Z=B+x),At.nodeType===3&&(B+=At.nodeValue.length),(mt=At.firstChild)!==null;)gt=At,At=mt;for(;;){if(At===u)break e;if(gt===m&&++pt===E&&(H=B),gt===M&&++kt===x&&(Z=B),(mt=At.nextSibling)!==null)break;At=gt,gt=At.parentNode}At=mt}m=H===-1||Z===-1?null:{start:H,end:Z}}else m=null}m=m||{start:0,end:0}}else m=null;for(Eg={focusedElem:u,selectionRange:m},Ih=!1,ki=h;ki!==null;)if(h=ki,u=h.child,(h.subtreeFlags&1024)!==0&&u!==null)u.return=h,ki=u;else for(;ki!==null;){switch(h=ki,M=h.alternate,u=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&M!==null){u=void 0,m=h,E=M.memoizedProps,M=M.memoizedState,x=m.stateNode;try{var ae=Ps(m.type,E,m.elementType===m.type);u=x.getSnapshotBeforeUpdate(ae,M),x.__reactInternalSnapshotBeforeUpdate=u}catch(ie){je(m,m.return,ie)}}break;case 3:if((u&1024)!==0){if(u=h.stateNode.containerInfo,m=u.nodeType,m===9)Pg(u);else if(m===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":Pg(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=h.sibling,u!==null){u.return=h.return,ki=u;break}ki=h.return}}function Xv(u,h,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:La(u,m),x&4&&Gu(5,m);break;case 1:if(La(u,m),x&4)if(u=m.stateNode,h===null)try{u.componentDidMount()}catch(B){je(m,m.return,B)}else{var E=Ps(m.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(E,h,u.__reactInternalSnapshotBeforeUpdate)}catch(B){je(m,m.return,B)}}x&64&&Hv(m),x&512&&Yu(m,m.return);break;case 3:if(La(u,m),x&64&&(u=m.updateQueue,u!==null)){if(h=null,m.child!==null)switch(m.child.tag){case 27:case 5:h=m.child.stateNode;break;case 1:h=m.child.stateNode}try{Aw(u,h)}catch(B){je(m,m.return,B)}}break;case 27:h===null&&x&4&&$v(m);case 26:case 5:La(u,m),h===null&&x&4&&Vv(m),x&512&&Yu(m,m.return);break;case 12:La(u,m);break;case 13:La(u,m),x&4&&Qv(u,m),x&64&&(u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(m=G5.bind(null,m),hE(u,m))));break;case 22:if(x=m.memoizedState!==null||Qr,!x){h=h!==null&&h.memoizedState!==null||si,E=Qr;var M=si;Qr=x,(si=h)&&!M?Ua(u,m,(m.subtreeFlags&8772)!==0):La(u,m),Qr=E,si=M}break;case 30:break;default:La(u,m)}}function Gv(u){var h=u.alternate;h!==null&&(u.alternate=null,Gv(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&ko(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Xe=null,Wi=!1;function Zr(u,h,m){for(m=m.child;m!==null;)Yv(u,h,m),m=m.sibling}function Yv(u,h,m){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Xt,m)}catch{}switch(m.tag){case 26:si||pr(m,h),Zr(u,h,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:si||pr(m,h);var x=Xe,E=Wi;Wa(m.type)&&(Xe=m.stateNode,Wi=!1),Zr(u,h,m),al(m.stateNode),Xe=x,Wi=E;break;case 5:si||pr(m,h);case 6:if(x=Xe,E=Wi,Xe=null,Zr(u,h,m),Xe=x,Wi=E,Xe!==null)if(Wi)try{(Xe.nodeType===9?Xe.body:Xe.nodeName==="HTML"?Xe.ownerDocument.body:Xe).removeChild(m.stateNode)}catch(M){je(m,h,M)}else try{Xe.removeChild(m.stateNode)}catch(M){je(m,h,M)}break;case 18:Xe!==null&&(Wi?(u=Xe,Lx(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,m.stateNode),hl(u)):Lx(Xe,m.stateNode));break;case 4:x=Xe,E=Wi,Xe=m.stateNode.containerInfo,Wi=!0,Zr(u,h,m),Xe=x,Wi=E;break;case 0:case 11:case 14:case 15:si||Fa(2,m,h),si||Fa(4,m,h),Zr(u,h,m);break;case 1:si||(pr(m,h),x=m.stateNode,typeof x.componentWillUnmount=="function"&&Kv(m,h,x)),Zr(u,h,m);break;case 21:Zr(u,h,m);break;case 22:si=(x=si)||m.memoizedState!==null,Zr(u,h,m),si=x;break;default:Zr(u,h,m)}}function Qv(u,h){if(h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{hl(u)}catch(m){je(h,h.return,m)}}function j5(u){switch(u.tag){case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new zv),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new zv),h;default:throw Error(r(435,u.tag))}}function ng(u,h){var m=j5(u);h.forEach(function(x){var E=Y5.bind(null,u,x);m.has(x)||(m.add(x),x.then(E,E))})}function en(u,h){var m=h.deletions;if(m!==null)for(var x=0;x<m.length;x++){var E=m[x],M=u,B=h,H=B;t:for(;H!==null;){switch(H.tag){case 27:if(Wa(H.type)){Xe=H.stateNode,Wi=!1;break t}break;case 5:Xe=H.stateNode,Wi=!1;break t;case 3:case 4:Xe=H.stateNode.containerInfo,Wi=!0;break t}H=H.return}if(Xe===null)throw Error(r(160));Yv(M,B,E),Xe=null,Wi=!1,M=E.alternate,M!==null&&(M.return=null),E.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)Zv(h,u),h=h.sibling}var Xn=null;function Zv(u,h){var m=u.alternate,x=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:en(h,u),nn(u),x&4&&(Fa(3,u,u.return),Gu(3,u),Fa(5,u,u.return));break;case 1:en(h,u),nn(u),x&512&&(si||m===null||pr(m,m.return)),x&64&&Qr&&(u=u.updateQueue,u!==null&&(x=u.callbacks,x!==null&&(m=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var E=Xn;if(en(h,u),nn(u),x&512&&(si||m===null||pr(m,m.return)),x&4){var M=m!==null?m.memoizedState:null;if(x=u.memoizedState,m===null)if(x===null)if(u.stateNode===null){t:{x=u.type,m=u.memoizedProps,E=E.ownerDocument||E;e:switch(x){case"title":M=E.getElementsByTagName("title")[0],(!M||M[$n]||M[Re]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=E.createElement(x),E.head.insertBefore(M,E.querySelector("head > title"))),Ci(M,x,m),M[Re]=u,ri(M),x=M;break t;case"link":var B=$x("link","href",E).get(x+(m.href||""));if(B){for(var H=0;H<B.length;H++)if(M=B[H],M.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&M.getAttribute("rel")===(m.rel==null?null:m.rel)&&M.getAttribute("title")===(m.title==null?null:m.title)&&M.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){B.splice(H,1);break e}}M=E.createElement(x),Ci(M,x,m),E.head.appendChild(M);break;case"meta":if(B=$x("meta","content",E).get(x+(m.content||""))){for(H=0;H<B.length;H++)if(M=B[H],M.getAttribute("content")===(m.content==null?null:""+m.content)&&M.getAttribute("name")===(m.name==null?null:m.name)&&M.getAttribute("property")===(m.property==null?null:m.property)&&M.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&M.getAttribute("charset")===(m.charSet==null?null:m.charSet)){B.splice(H,1);break e}}M=E.createElement(x),Ci(M,x,m),E.head.appendChild(M);break;default:throw Error(r(468,x))}M[Re]=u,ri(M),x=M}u.stateNode=x}else zx(E,u.type,u.stateNode);else u.stateNode=Wx(E,x,u.memoizedProps);else M!==x?(M===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):M.count--,x===null?zx(E,u.type,u.stateNode):Wx(E,x,u.memoizedProps)):x===null&&u.stateNode!==null&&Jy(u,u.memoizedProps,m.memoizedProps)}break;case 27:en(h,u),nn(u),x&512&&(si||m===null||pr(m,m.return)),m!==null&&x&4&&Jy(u,u.memoizedProps,m.memoizedProps);break;case 5:if(en(h,u),nn(u),x&512&&(si||m===null||pr(m,m.return)),u.flags&32){E=u.stateNode;try{Ao(E,"")}catch(mt){je(u,u.return,mt)}}x&4&&u.stateNode!=null&&(E=u.memoizedProps,Jy(u,E,m!==null?m.memoizedProps:E)),x&1024&&(ig=!0);break;case 6:if(en(h,u),nn(u),x&4){if(u.stateNode===null)throw Error(r(162));x=u.memoizedProps,m=u.stateNode;try{m.nodeValue=x}catch(mt){je(u,u.return,mt)}}break;case 3:if(_h=null,E=Xn,Xn=vh(h.containerInfo),en(h,u),Xn=E,nn(u),x&4&&m!==null&&m.memoizedState.isDehydrated)try{hl(h.containerInfo)}catch(mt){je(u,u.return,mt)}ig&&(ig=!1,Jv(u));break;case 4:x=Xn,Xn=vh(u.stateNode.containerInfo),en(h,u),nn(u),Xn=x;break;case 12:en(h,u),nn(u);break;case 13:en(h,u),nn(u),u.child.flags&8192&&u.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(ug=Vt()),x&4&&(x=u.updateQueue,x!==null&&(u.updateQueue=null,ng(u,x)));break;case 22:E=u.memoizedState!==null;var Z=m!==null&&m.memoizedState!==null,pt=Qr,kt=si;if(Qr=pt||E,si=kt||Z,en(h,u),si=kt,Qr=pt,nn(u),x&8192)t:for(h=u.stateNode,h._visibility=E?h._visibility&-2:h._visibility|1,E&&(m===null||Z||Qr||si||Rs(u)),m=null,h=u;;){if(h.tag===5||h.tag===26){if(m===null){Z=m=h;try{if(M=Z.stateNode,E)B=M.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{H=Z.stateNode;var At=Z.memoizedProps.style,gt=At!=null&&At.hasOwnProperty("display")?At.display:null;H.style.display=gt==null||typeof gt=="boolean"?"":(""+gt).trim()}}catch(mt){je(Z,Z.return,mt)}}}else if(h.tag===6){if(m===null){Z=h;try{Z.stateNode.nodeValue=E?"":Z.memoizedProps}catch(mt){je(Z,Z.return,mt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break t;for(;h.sibling===null;){if(h.return===null||h.return===u)break t;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}x&4&&(x=u.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,ng(u,m))));break;case 19:en(h,u),nn(u),x&4&&(x=u.updateQueue,x!==null&&(u.updateQueue=null,ng(u,x)));break;case 30:break;case 21:break;default:en(h,u),nn(u)}}function nn(u){var h=u.flags;if(h&2){try{for(var m,x=u.return;x!==null;){if(Wv(x)){m=x;break}x=x.return}if(m==null)throw Error(r(160));switch(m.tag){case 27:var E=m.stateNode,M=tg(u);oh(u,M,E);break;case 5:var B=m.stateNode;m.flags&32&&(Ao(B,""),m.flags&=-33);var H=tg(u);oh(u,H,B);break;case 3:case 4:var Z=m.stateNode.containerInfo,pt=tg(u);eg(u,pt,Z);break;default:throw Error(r(161))}}catch(kt){je(u,u.return,kt)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function Jv(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;Jv(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),u=u.sibling}}function La(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Xv(u,h.alternate,h),h=h.sibling}function Rs(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:Fa(4,h,h.return),Rs(h);break;case 1:pr(h,h.return);var m=h.stateNode;typeof m.componentWillUnmount=="function"&&Kv(h,h.return,m),Rs(h);break;case 27:al(h.stateNode);case 26:case 5:pr(h,h.return),Rs(h);break;case 22:h.memoizedState===null&&Rs(h);break;case 30:Rs(h);break;default:Rs(h)}u=u.sibling}}function Ua(u,h,m){for(m=m&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var x=h.alternate,E=u,M=h,B=M.flags;switch(M.tag){case 0:case 11:case 15:Ua(E,M,m),Gu(4,M);break;case 1:if(Ua(E,M,m),x=M,E=x.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(pt){je(x,x.return,pt)}if(x=M,E=x.updateQueue,E!==null){var H=x.stateNode;try{var Z=E.shared.hiddenCallbacks;if(Z!==null)for(E.shared.hiddenCallbacks=null,E=0;E<Z.length;E++)Ow(Z[E],H)}catch(pt){je(x,x.return,pt)}}m&&B&64&&Hv(M),Yu(M,M.return);break;case 27:$v(M);case 26:case 5:Ua(E,M,m),m&&x===null&&B&4&&Vv(M),Yu(M,M.return);break;case 12:Ua(E,M,m);break;case 13:Ua(E,M,m),m&&B&4&&Qv(E,M);break;case 22:M.memoizedState===null&&Ua(E,M,m),Yu(M,M.return);break;case 30:break;default:Ua(E,M,m)}h=h.sibling}}function rg(u,h){var m=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==m&&(u!=null&&u.refCount++,m!=null&&Du(m))}function ag(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Du(u))}function yr(u,h,m,x){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)tx(u,h,m,x),h=h.sibling}function tx(u,h,m,x){var E=h.flags;switch(h.tag){case 0:case 11:case 15:yr(u,h,m,x),E&2048&&Gu(9,h);break;case 1:yr(u,h,m,x);break;case 3:yr(u,h,m,x),E&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&Du(u)));break;case 12:if(E&2048){yr(u,h,m,x),u=h.stateNode;try{var M=h.memoizedProps,B=M.id,H=M.onPostCommit;typeof H=="function"&&H(B,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Z){je(h,h.return,Z)}}else yr(u,h,m,x);break;case 13:yr(u,h,m,x);break;case 23:break;case 22:M=h.stateNode,B=h.alternate,h.memoizedState!==null?M._visibility&2?yr(u,h,m,x):Qu(u,h):M._visibility&2?yr(u,h,m,x):(M._visibility|=2,Xo(u,h,m,x,(h.subtreeFlags&10256)!==0)),E&2048&&rg(B,h);break;case 24:yr(u,h,m,x),E&2048&&ag(h.alternate,h);break;default:yr(u,h,m,x)}}function Xo(u,h,m,x,E){for(E=E&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var M=u,B=h,H=m,Z=x,pt=B.flags;switch(B.tag){case 0:case 11:case 15:Xo(M,B,H,Z,E),Gu(8,B);break;case 23:break;case 22:var kt=B.stateNode;B.memoizedState!==null?kt._visibility&2?Xo(M,B,H,Z,E):Qu(M,B):(kt._visibility|=2,Xo(M,B,H,Z,E)),E&&pt&2048&&rg(B.alternate,B);break;case 24:Xo(M,B,H,Z,E),E&&pt&2048&&ag(B.alternate,B);break;default:Xo(M,B,H,Z,E)}h=h.sibling}}function Qu(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var m=u,x=h,E=x.flags;switch(x.tag){case 22:Qu(m,x),E&2048&&rg(x.alternate,x);break;case 24:Qu(m,x),E&2048&&ag(x.alternate,x);break;default:Qu(m,x)}h=h.sibling}}var Zu=8192;function Go(u){if(u.subtreeFlags&Zu)for(u=u.child;u!==null;)ex(u),u=u.sibling}function ex(u){switch(u.tag){case 26:Go(u),u.flags&Zu&&u.memoizedState!==null&&kE(Xn,u.memoizedState,u.memoizedProps);break;case 5:Go(u);break;case 3:case 4:var h=Xn;Xn=vh(u.stateNode.containerInfo),Go(u),Xn=h;break;case 22:u.memoizedState===null&&(h=u.alternate,h!==null&&h.memoizedState!==null?(h=Zu,Zu=16777216,Go(u),Zu=h):Go(u));break;default:Go(u)}}function ix(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function Ju(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var m=0;m<h.length;m++){var x=h[m];ki=x,rx(x,u)}ix(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)nx(u),u=u.sibling}function nx(u){switch(u.tag){case 0:case 11:case 15:Ju(u),u.flags&2048&&Fa(9,u,u.return);break;case 3:Ju(u);break;case 12:Ju(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&2&&(u.return===null||u.return.tag!==13)?(h._visibility&=-3,ch(u)):Ju(u);break;default:Ju(u)}}function ch(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var m=0;m<h.length;m++){var x=h[m];ki=x,rx(x,u)}ix(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:Fa(8,h,h.return),ch(h);break;case 22:m=h.stateNode,m._visibility&2&&(m._visibility&=-3,ch(h));break;default:ch(h)}u=u.sibling}}function rx(u,h){for(;ki!==null;){var m=ki;switch(m.tag){case 0:case 11:case 15:Fa(8,m,h);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Du(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,ki=x;else t:for(m=u;ki!==null;){x=ki;var E=x.sibling,M=x.return;if(Gv(x),x===m){ki=null;break t}if(E!==null){E.return=M,ki=E;break t}ki=M}}}var H5={getCacheForType:function(u){var h=Bi(mi),m=h.data.get(u);return m===void 0&&(m=u(),h.data.set(u,m)),m}},K5=typeof WeakMap=="function"?WeakMap:Map,Me=0,$e=null,be=null,Se=0,Ne=0,rn=null,qa=!1,Yo=!1,sg=!1,Jr=0,Je=0,ja=0,Ms=0,og=0,Sn=0,Qo=0,tl=null,$i=null,cg=!1,ug=0,uh=1/0,lh=null,Ha=null,Ni=0,Ka=null,Zo=null,Jo=0,lg=0,dg=null,ax=null,el=0,fg=null;function an(){if((Me&2)!==0&&Se!==0)return Se&-Se;if(L.T!==null){var u=qo;return u!==0?u:wg()}return ce()}function sx(){Sn===0&&(Sn=(Se&536870912)===0||Ee?bt():536870912);var u=_n.current;return u!==null&&(u.flags|=32),Sn}function sn(u,h,m){(u===$e&&(Ne===2||Ne===9)||u.cancelPendingCommit!==null)&&(tc(u,0),Va(u,Se,Sn,!1)),Yt(u,m),((Me&2)===0||u!==$e)&&(u===$e&&((Me&2)===0&&(Ms|=m),Je===4&&Va(u,Se,Sn,!1)),gr(u))}function ox(u,h,m){if((Me&6)!==0)throw Error(r(327));var x=!m&&(h&124)===0&&(h&u.expiredLanes)===0||ht(u,h),E=x?$5(u,h):yg(u,h,!0),M=x;do{if(E===0){Yo&&!x&&Va(u,h,0,!1);break}else{if(m=u.current.alternate,M&&!V5(m)){E=yg(u,h,!1),M=!1;continue}if(E===2){if(M=h,u.errorRecoveryDisabledLanes&M)var B=0;else B=u.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){h=B;t:{var H=u;E=tl;var Z=H.current.memoizedState.isDehydrated;if(Z&&(tc(H,B).flags|=256),B=yg(H,B,!1),B!==2){if(sg&&!Z){H.errorRecoveryDisabledLanes|=M,Ms|=M,E=4;break t}M=$i,$i=E,M!==null&&($i===null?$i=M:$i.push.apply($i,M))}E=B}if(M=!1,E!==2)continue}}if(E===1){tc(u,0),Va(u,h,0,!0);break}t:{switch(x=u,M=E,M){case 0:case 1:throw Error(r(345));case 4:if((h&4194048)!==h)break;case 6:Va(x,h,Sn,!qa);break t;case 2:$i=null;break;case 3:case 5:break;default:throw Error(r(329))}if((h&62914560)===h&&(E=ug+300-Vt(),10<E)){if(Va(x,h,Sn,!qa),at(x,0,!0)!==0)break t;x.timeoutHandle=Bx(cx.bind(null,x,m,$i,lh,cg,h,Sn,Ms,Qo,qa,M,2,-0,0),E);break t}cx(x,m,$i,lh,cg,h,Sn,Ms,Qo,qa,M,0,-0,0)}}break}while(!0);gr(u)}function cx(u,h,m,x,E,M,B,H,Z,pt,kt,At,gt,mt){if(u.timeoutHandle=-1,At=h.subtreeFlags,(At&8192||(At&16785408)===16785408)&&(cl={stylesheets:null,count:0,unsuspend:IE},ex(h),At=EE(),At!==null)){u.cancelPendingCommit=At(yx.bind(null,u,h,M,m,x,E,B,H,Z,kt,1,gt,mt)),Va(u,M,B,!pt);return}yx(u,h,M,m,x,E,B,H,Z)}function V5(u){for(var h=u;;){var m=h.tag;if((m===0||m===11||m===15)&&h.flags&16384&&(m=h.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var E=m[x],M=E.getSnapshot;E=E.value;try{if(!Ji(M(),E))return!1}catch{return!1}}if(m=h.child,h.subtreeFlags&16384&&m!==null)m.return=h,h=m;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Va(u,h,m,x){h&=~og,h&=~Ms,u.suspendedLanes|=h,u.pingedLanes&=~h,x&&(u.warmLanes|=h),x=u.expirationTimes;for(var E=h;0<E;){var M=31-Rt(E),B=1<<M;x[M]=-1,E&=~B}m!==0&&oe(u,m,h)}function dh(){return(Me&6)===0?(il(0),!1):!0}function hg(){if(be!==null){if(Ne===0)var u=be.return;else u=be,Wr=ks=null,Py(u),$o=null,$u=0,u=be;for(;u!==null;)jv(u.alternate,u),u=u.return;be=null}}function tc(u,h){var m=u.timeoutHandle;m!==-1&&(u.timeoutHandle=-1,cE(m)),m=u.cancelPendingCommit,m!==null&&(u.cancelPendingCommit=null,m()),hg(),$e=u,be=m=Hr(u.current,null),Se=h,Ne=0,rn=null,qa=!1,Yo=ht(u,h),sg=!1,Qo=Sn=og=Ms=ja=Je=0,$i=tl=null,cg=!1,(h&8)!==0&&(h|=h&32);var x=u.entangledLanes;if(x!==0)for(u=u.entanglements,x&=h;0<x;){var E=31-Rt(x),M=1<<E;h|=u[E],x&=~M}return Jr=h,Nf(),m}function ux(u,h){he=null,L.H=Zf,h===Fu||h===Hf?(h=kw(),Ne=3):h===Sw?(h=kw(),Ne=4):Ne=h===Ev?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,rn=h,be===null&&(Je=1,nh(u,bn(h,u.current)))}function lx(){var u=L.H;return L.H=Zf,u===null?Zf:u}function dx(){var u=L.A;return L.A=H5,u}function pg(){Je=4,qa||(Se&4194048)!==Se&&_n.current!==null||(Yo=!0),(ja&134217727)===0&&(Ms&134217727)===0||$e===null||Va($e,Se,Sn,!1)}function yg(u,h,m){var x=Me;Me|=2;var E=lx(),M=dx();($e!==u||Se!==h)&&(lh=null,tc(u,h)),h=!1;var B=Je;t:do try{if(Ne!==0&&be!==null){var H=be,Z=rn;switch(Ne){case 8:hg(),B=6;break t;case 3:case 2:case 9:case 6:_n.current===null&&(h=!0);var pt=Ne;if(Ne=0,rn=null,ec(u,H,Z,pt),m&&Yo){B=0;break t}break;default:pt=Ne,Ne=0,rn=null,ec(u,H,Z,pt)}}W5(),B=Je;break}catch(kt){ux(u,kt)}while(!0);return h&&u.shellSuspendCounter++,Wr=ks=null,Me=x,L.H=E,L.A=M,be===null&&($e=null,Se=0,Nf()),B}function W5(){for(;be!==null;)fx(be)}function $5(u,h){var m=Me;Me|=2;var x=lx(),E=dx();$e!==u||Se!==h?(lh=null,uh=Vt()+500,tc(u,h)):Yo=ht(u,h);t:do try{if(Ne!==0&&be!==null){h=be;var M=rn;e:switch(Ne){case 1:Ne=0,rn=null,ec(u,h,M,1);break;case 2:case 9:if(Tw(M)){Ne=0,rn=null,hx(h);break}h=function(){Ne!==2&&Ne!==9||$e!==u||(Ne=7),gr(u)},M.then(h,h);break t;case 3:Ne=7;break t;case 4:Ne=5;break t;case 7:Tw(M)?(Ne=0,rn=null,hx(h)):(Ne=0,rn=null,ec(u,h,M,7));break;case 5:var B=null;switch(be.tag){case 26:B=be.memoizedState;case 5:case 27:var H=be;if(!B||Xx(B)){Ne=0,rn=null;var Z=H.sibling;if(Z!==null)be=Z;else{var pt=H.return;pt!==null?(be=pt,fh(pt)):be=null}break e}}Ne=0,rn=null,ec(u,h,M,5);break;case 6:Ne=0,rn=null,ec(u,h,M,6);break;case 8:hg(),Je=6;break t;default:throw Error(r(462))}}z5();break}catch(kt){ux(u,kt)}while(!0);return Wr=ks=null,L.H=x,L.A=E,Me=m,be!==null?0:($e=null,Se=0,Nf(),Je)}function z5(){for(;be!==null&&!ne();)fx(be)}function fx(u){var h=Uv(u.alternate,u,Jr);u.memoizedProps=u.pendingProps,h===null?fh(u):be=h}function hx(u){var h=u,m=h.alternate;switch(h.tag){case 15:case 0:h=Nv(m,h,h.pendingProps,h.type,void 0,Se);break;case 11:h=Nv(m,h,h.pendingProps,h.type.render,h.ref,Se);break;case 5:Py(h);default:jv(m,h),h=be=pw(h,Jr),h=Uv(m,h,Jr)}u.memoizedProps=u.pendingProps,h===null?fh(u):be=h}function ec(u,h,m,x){Wr=ks=null,Py(h),$o=null,$u=0;var E=h.return;try{if(B5(u,E,h,m,Se)){Je=1,nh(u,bn(m,u.current)),be=null;return}}catch(M){if(E!==null)throw be=E,M;Je=1,nh(u,bn(m,u.current)),be=null;return}h.flags&32768?(Ee||x===1?u=!0:Yo||(Se&536870912)!==0?u=!1:(qa=u=!0,(x===2||x===9||x===3||x===6)&&(x=_n.current,x!==null&&x.tag===13&&(x.flags|=16384))),px(h,u)):fh(h)}function fh(u){var h=u;do{if((h.flags&32768)!==0){px(h,qa);return}u=h.return;var m=L5(h.alternate,h,Jr);if(m!==null){be=m;return}if(h=h.sibling,h!==null){be=h;return}be=h=u}while(h!==null);Je===0&&(Je=5)}function px(u,h){do{var m=U5(u.alternate,u);if(m!==null){m.flags&=32767,be=m;return}if(m=u.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!h&&(u=u.sibling,u!==null)){be=u;return}be=u=m}while(u!==null);Je=6,be=null}function yx(u,h,m,x,E,M,B,H,Z){u.cancelPendingCommit=null;do hh();while(Ni!==0);if((Me&6)!==0)throw Error(r(327));if(h!==null){if(h===u.current)throw Error(r(177));if(M=h.lanes|h.childLanes,M|=ay,te(u,m,M,B,H,Z),u===$e&&(be=$e=null,Se=0),Zo=h,Ka=u,Jo=m,lg=M,dg=E,ax=x,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,Q5(ut,function(){return vx(),null})):(u.callbackNode=null,u.callbackPriority=0),x=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||x){x=L.T,L.T=null,E=j.p,j.p=2,B=Me,Me|=4;try{q5(u,h,m)}finally{Me=B,j.p=E,L.T=x}}Ni=1,gx(),mx(),bx()}}function gx(){if(Ni===1){Ni=0;var u=Ka,h=Zo,m=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||m){m=L.T,L.T=null;var x=j.p;j.p=2;var E=Me;Me|=4;try{Zv(h,u);var M=Eg,B=rw(u.containerInfo),H=M.focusedElem,Z=M.selectionRange;if(B!==H&&H&&H.ownerDocument&&nw(H.ownerDocument.documentElement,H)){if(Z!==null&&ty(H)){var pt=Z.start,kt=Z.end;if(kt===void 0&&(kt=pt),"selectionStart"in H)H.selectionStart=pt,H.selectionEnd=Math.min(kt,H.value.length);else{var At=H.ownerDocument||document,gt=At&&At.defaultView||window;if(gt.getSelection){var mt=gt.getSelection(),ae=H.textContent.length,ie=Math.min(Z.start,ae),Ue=Z.end===void 0?ie:Math.min(Z.end,ae);!mt.extend&&ie>Ue&&(B=Ue,Ue=ie,ie=B);var ct=iw(H,ie),nt=iw(H,Ue);if(ct&&nt&&(mt.rangeCount!==1||mt.anchorNode!==ct.node||mt.anchorOffset!==ct.offset||mt.focusNode!==nt.node||mt.focusOffset!==nt.offset)){var ft=At.createRange();ft.setStart(ct.node,ct.offset),mt.removeAllRanges(),ie>Ue?(mt.addRange(ft),mt.extend(nt.node,nt.offset)):(ft.setEnd(nt.node,nt.offset),mt.addRange(ft))}}}}for(At=[],mt=H;mt=mt.parentNode;)mt.nodeType===1&&At.push({element:mt,left:mt.scrollLeft,top:mt.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<At.length;H++){var Et=At[H];Et.element.scrollLeft=Et.left,Et.element.scrollTop=Et.top}}Ih=!!kg,Eg=kg=null}finally{Me=E,j.p=x,L.T=m}}u.current=h,Ni=2}}function mx(){if(Ni===2){Ni=0;var u=Ka,h=Zo,m=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||m){m=L.T,L.T=null;var x=j.p;j.p=2;var E=Me;Me|=4;try{Xv(u,h.alternate,h)}finally{Me=E,j.p=x,L.T=m}}Ni=3}}function bx(){if(Ni===4||Ni===3){Ni=0,Ut();var u=Ka,h=Zo,m=Jo,x=ax;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Ni=5:(Ni=0,Zo=Ka=null,wx(u,u.pendingLanes));var E=u.pendingLanes;if(E===0&&(Ha=null),Bt(m),h=h.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Xt,h,void 0,(h.current.flags&128)===128)}catch{}if(x!==null){h=L.T,E=j.p,j.p=2,L.T=null;try{for(var M=u.onRecoverableError,B=0;B<x.length;B++){var H=x[B];M(H.value,{componentStack:H.stack})}}finally{L.T=h,j.p=E}}(Jo&3)!==0&&hh(),gr(u),E=u.pendingLanes,(m&4194090)!==0&&(E&42)!==0?u===fg?el++:(el=0,fg=u):el=0,il(0)}}function wx(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,Du(h)))}function hh(u){return gx(),mx(),bx(),vx()}function vx(){if(Ni!==5)return!1;var u=Ka,h=lg;lg=0;var m=Bt(Jo),x=L.T,E=j.p;try{j.p=32>m?32:m,L.T=null,m=dg,dg=null;var M=Ka,B=Jo;if(Ni=0,Zo=Ka=null,Jo=0,(Me&6)!==0)throw Error(r(331));var H=Me;if(Me|=4,nx(M.current),tx(M,M.current,B,m),Me=H,il(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Xt,M)}catch{}return!0}finally{j.p=E,L.T=x,wx(u,h)}}function xx(u,h,m){h=bn(m,h),h=Vy(u.stateNode,h,2),u=Na(u,h,2),u!==null&&(Yt(u,2),gr(u))}function je(u,h,m){if(u.tag===3)xx(u,u,m);else for(;h!==null;){if(h.tag===3){xx(h,u,m);break}else if(h.tag===1){var x=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ha===null||!Ha.has(x))){u=bn(m,u),m=Iv(2),x=Na(h,m,2),x!==null&&(kv(m,x,h,u),Yt(x,2),gr(x));break}}h=h.return}}function gg(u,h,m){var x=u.pingCache;if(x===null){x=u.pingCache=new K5;var E=new Set;x.set(h,E)}else E=x.get(h),E===void 0&&(E=new Set,x.set(h,E));E.has(m)||(sg=!0,E.add(m),u=X5.bind(null,u,h,m),h.then(u,u))}function X5(u,h,m){var x=u.pingCache;x!==null&&x.delete(h),u.pingedLanes|=u.suspendedLanes&m,u.warmLanes&=~m,$e===u&&(Se&m)===m&&(Je===4||Je===3&&(Se&62914560)===Se&&300>Vt()-ug?(Me&2)===0&&tc(u,0):og|=m,Qo===Se&&(Qo=0)),gr(u)}function _x(u,h){h===0&&(h=Dt()),u=Bo(u,h),u!==null&&(Yt(u,h),gr(u))}function G5(u){var h=u.memoizedState,m=0;h!==null&&(m=h.retryLane),_x(u,m)}function Y5(u,h){var m=0;switch(u.tag){case 13:var x=u.stateNode,E=u.memoizedState;E!==null&&(m=E.retryLane);break;case 19:x=u.stateNode;break;case 22:x=u.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(h),_x(u,m)}function Q5(u,h){return Nt(u,h)}var ph=null,ic=null,mg=!1,yh=!1,bg=!1,Ns=0;function gr(u){u!==ic&&u.next===null&&(ic===null?ph=ic=u:ic=ic.next=u),yh=!0,mg||(mg=!0,J5())}function il(u,h){if(!bg&&yh){bg=!0;do for(var m=!1,x=ph;x!==null;){if(u!==0){var E=x.pendingLanes;if(E===0)var M=0;else{var B=x.suspendedLanes,H=x.pingedLanes;M=(1<<31-Rt(42|u)+1)-1,M&=E&~(B&~H),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(m=!0,kx(x,M))}else M=Se,M=at(x,x===$e?M:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(M&3)===0||ht(x,M)||(m=!0,kx(x,M));x=x.next}while(m);bg=!1}}function Z5(){Sx()}function Sx(){yh=mg=!1;var u=0;Ns!==0&&(oE()&&(u=Ns),Ns=0);for(var h=Vt(),m=null,x=ph;x!==null;){var E=x.next,M=Tx(x,h);M===0?(x.next=null,m===null?ph=E:m.next=E,E===null&&(ic=m)):(m=x,(u!==0||(M&3)!==0)&&(yh=!0)),x=E}il(u)}function Tx(u,h){for(var m=u.suspendedLanes,x=u.pingedLanes,E=u.expirationTimes,M=u.pendingLanes&-62914561;0<M;){var B=31-Rt(M),H=1<<B,Z=E[B];Z===-1?((H&m)===0||(H&x)!==0)&&(E[B]=lt(H,h)):Z<=h&&(u.expiredLanes|=H),M&=~H}if(h=$e,m=Se,m=at(u,u===h?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),x=u.callbackNode,m===0||u===h&&(Ne===2||Ne===9)||u.cancelPendingCommit!==null)return x!==null&&x!==null&&Lt(x),u.callbackNode=null,u.callbackPriority=0;if((m&3)===0||ht(u,m)){if(h=m&-m,h===u.callbackPriority)return h;switch(x!==null&&Lt(x),Bt(m)){case 2:case 8:m=K;break;case 32:m=ut;break;case 268435456:m=Mt;break;default:m=ut}return x=Ix.bind(null,u),m=Nt(m,x),u.callbackPriority=h,u.callbackNode=m,h}return x!==null&&x!==null&&Lt(x),u.callbackPriority=2,u.callbackNode=null,2}function Ix(u,h){if(Ni!==0&&Ni!==5)return u.callbackNode=null,u.callbackPriority=0,null;var m=u.callbackNode;if(hh()&&u.callbackNode!==m)return null;var x=Se;return x=at(u,u===$e?x:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),x===0?null:(ox(u,x,h),Tx(u,Vt()),u.callbackNode!=null&&u.callbackNode===m?Ix.bind(null,u):null)}function kx(u,h){if(hh())return null;ox(u,h,!0)}function J5(){uE(function(){(Me&6)!==0?Nt(Ct,Z5):Sx()})}function wg(){return Ns===0&&(Ns=bt()),Ns}function Ex(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:kf(""+u)}function Ox(u,h){var m=h.ownerDocument.createElement("input");return m.name=h.name,m.value=h.value,u.id&&m.setAttribute("form",u.id),h.parentNode.insertBefore(m,h),u=new FormData(u),m.parentNode.removeChild(m),u}function tE(u,h,m,x,E){if(h==="submit"&&m&&m.stateNode===E){var M=Ex((E[We]||null).action),B=x.submitter;B&&(h=(h=B[We]||null)?Ex(h.formAction):B.getAttribute("formAction"),h!==null&&(M=h,B=null));var H=new Pf("action","action",null,x,E);u.push({event:H,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Ns!==0){var Z=B?Ox(E,B):new FormData(E);Uy(m,{pending:!0,data:Z,method:E.method,action:M},null,Z)}}else typeof M=="function"&&(H.preventDefault(),Z=B?Ox(E,B):new FormData(E),Uy(m,{pending:!0,data:Z,method:E.method,action:M},M,Z))},currentTarget:E}]})}}for(var vg=0;vg<ry.length;vg++){var xg=ry[vg],eE=xg.toLowerCase(),iE=xg[0].toUpperCase()+xg.slice(1);zn(eE,"on"+iE)}zn(ow,"onAnimationEnd"),zn(cw,"onAnimationIteration"),zn(uw,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(w5,"onTransitionRun"),zn(v5,"onTransitionStart"),zn(x5,"onTransitionCancel"),zn(lw,"onTransitionEnd"),Ur("onMouseEnter",["mouseout","mouseover"]),Ur("onMouseLeave",["mouseout","mouseover"]),Ur("onPointerEnter",["pointerout","pointerover"]),Ur("onPointerLeave",["pointerout","pointerover"]),dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),dr("onBeforeInput",["compositionend","keypress","textInput","paste"]),dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nl));function Ax(u,h){h=(h&4)!==0;for(var m=0;m<u.length;m++){var x=u[m],E=x.event;x=x.listeners;t:{var M=void 0;if(h)for(var B=x.length-1;0<=B;B--){var H=x[B],Z=H.instance,pt=H.currentTarget;if(H=H.listener,Z!==M&&E.isPropagationStopped())break t;M=H,E.currentTarget=pt;try{M(E)}catch(kt){ih(kt)}E.currentTarget=null,M=Z}else for(B=0;B<x.length;B++){if(H=x[B],Z=H.instance,pt=H.currentTarget,H=H.listener,Z!==M&&E.isPropagationStopped())break t;M=H,E.currentTarget=pt;try{M(E)}catch(kt){ih(kt)}E.currentTarget=null,M=Z}}}}function we(u,h){var m=h[Hi];m===void 0&&(m=h[Hi]=new Set);var x=u+"__bubble";m.has(x)||(Px(h,u,2,!1),m.add(x))}function _g(u,h,m){var x=0;h&&(x|=4),Px(m,u,x,h)}var gh="_reactListening"+Math.random().toString(36).slice(2);function Sg(u){if(!u[gh]){u[gh]=!0,gs.forEach(function(m){m!=="selectionchange"&&(nE.has(m)||_g(m,!1,u),_g(m,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[gh]||(h[gh]=!0,_g("selectionchange",!1,h))}}function Px(u,h,m,x){switch(t2(h)){case 2:var E=PE;break;case 8:E=RE;break;default:E=Fg}m=E.bind(null,h,m,u),E=void 0,!W0||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(E=!0),x?E!==void 0?u.addEventListener(h,m,{capture:!0,passive:E}):u.addEventListener(h,m,!0):E!==void 0?u.addEventListener(h,m,{passive:E}):u.addEventListener(h,m,!1)}function Tg(u,h,m,x,E){var M=x;if((h&1)===0&&(h&2)===0&&x!==null)t:for(;;){if(x===null)return;var B=x.tag;if(B===3||B===4){var H=x.stateNode.containerInfo;if(H===E)break;if(B===4)for(B=x.return;B!==null;){var Z=B.tag;if((Z===3||Z===4)&&B.stateNode.containerInfo===E)return;B=B.return}for(;H!==null;){if(B=Br(H),B===null)return;if(Z=B.tag,Z===5||Z===6||Z===26||Z===27){x=M=B;continue t}H=H.parentNode}}x=x.return}F1(function(){var pt=M,kt=K0(m),At=[];t:{var gt=dw.get(u);if(gt!==void 0){var mt=Pf,ae=u;switch(u){case"keypress":if(Of(m)===0)break t;case"keydown":case"keyup":mt=Qk;break;case"focusin":ae="focus",mt=G0;break;case"focusout":ae="blur",mt=G0;break;case"beforeblur":case"afterblur":mt=G0;break;case"click":if(m.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=q1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=Uk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=t5;break;case ow:case cw:case uw:mt=Hk;break;case lw:mt=i5;break;case"scroll":case"scrollend":mt=Fk;break;case"wheel":mt=r5;break;case"copy":case"cut":case"paste":mt=Vk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=H1;break;case"toggle":case"beforetoggle":mt=s5}var ie=(h&4)!==0,Ue=!ie&&(u==="scroll"||u==="scrollend"),ct=ie?gt!==null?gt+"Capture":null:gt;ie=[];for(var nt=pt,ft;nt!==null;){var Et=nt;if(ft=Et.stateNode,Et=Et.tag,Et!==5&&Et!==26&&Et!==27||ft===null||ct===null||(Et=_u(nt,ct),Et!=null&&ie.push(rl(nt,Et,ft))),Ue)break;nt=nt.return}0<ie.length&&(gt=new mt(gt,ae,null,m,kt),At.push({event:gt,listeners:ie}))}}if((h&7)===0){t:{if(gt=u==="mouseover"||u==="pointerover",mt=u==="mouseout"||u==="pointerout",gt&&m!==H0&&(ae=m.relatedTarget||m.fromElement)&&(Br(ae)||ae[Ti]))break t;if((mt||gt)&&(gt=kt.window===kt?kt:(gt=kt.ownerDocument)?gt.defaultView||gt.parentWindow:window,mt?(ae=m.relatedTarget||m.toElement,mt=pt,ae=ae?Br(ae):null,ae!==null&&(Ue=o(ae),ie=ae.tag,ae!==Ue||ie!==5&&ie!==27&&ie!==6)&&(ae=null)):(mt=null,ae=pt),mt!==ae)){if(ie=q1,Et="onMouseLeave",ct="onMouseEnter",nt="mouse",(u==="pointerout"||u==="pointerover")&&(ie=H1,Et="onPointerLeave",ct="onPointerEnter",nt="pointer"),Ue=mt==null?gt:Oa(mt),ft=ae==null?gt:Oa(ae),gt=new ie(Et,nt+"leave",mt,m,kt),gt.target=Ue,gt.relatedTarget=ft,Et=null,Br(kt)===pt&&(ie=new ie(ct,nt+"enter",ae,m,kt),ie.target=ft,ie.relatedTarget=Ue,Et=ie),Ue=Et,mt&&ae)e:{for(ie=mt,ct=ae,nt=0,ft=ie;ft;ft=nc(ft))nt++;for(ft=0,Et=ct;Et;Et=nc(Et))ft++;for(;0<nt-ft;)ie=nc(ie),nt--;for(;0<ft-nt;)ct=nc(ct),ft--;for(;nt--;){if(ie===ct||ct!==null&&ie===ct.alternate)break e;ie=nc(ie),ct=nc(ct)}ie=null}else ie=null;mt!==null&&Rx(At,gt,mt,ie,!1),ae!==null&&Ue!==null&&Rx(At,Ue,ae,ie,!0)}}t:{if(gt=pt?Oa(pt):window,mt=gt.nodeName&&gt.nodeName.toLowerCase(),mt==="select"||mt==="input"&&gt.type==="file")var qt=Y1;else if(X1(gt))if(Q1)qt=g5;else{qt=p5;var ye=h5}else mt=gt.nodeName,!mt||mt.toLowerCase()!=="input"||gt.type!=="checkbox"&&gt.type!=="radio"?pt&&j0(pt.elementType)&&(qt=Y1):qt=y5;if(qt&&(qt=qt(u,pt))){G1(At,qt,m,kt);break t}ye&&ye(u,gt,pt),u==="focusout"&&pt&&gt.type==="number"&&pt.memoizedProps.value!=null&&q0(gt,"number",gt.value)}switch(ye=pt?Oa(pt):window,u){case"focusin":(X1(ye)||ye.contentEditable==="true")&&(No=ye,ey=pt,Pu=null);break;case"focusout":Pu=ey=No=null;break;case"mousedown":iy=!0;break;case"contextmenu":case"mouseup":case"dragend":iy=!1,aw(At,m,kt);break;case"selectionchange":if(b5)break;case"keydown":case"keyup":aw(At,m,kt)}var $t;if(Q0)t:{switch(u){case"compositionstart":var re="onCompositionStart";break t;case"compositionend":re="onCompositionEnd";break t;case"compositionupdate":re="onCompositionUpdate";break t}re=void 0}else Mo?$1(u,m)&&(re="onCompositionEnd"):u==="keydown"&&m.keyCode===229&&(re="onCompositionStart");re&&(K1&&m.locale!=="ko"&&(Mo||re!=="onCompositionStart"?re==="onCompositionEnd"&&Mo&&($t=L1()):(Aa=kt,$0="value"in Aa?Aa.value:Aa.textContent,Mo=!0)),ye=mh(pt,re),0<ye.length&&(re=new j1(re,u,null,m,kt),At.push({event:re,listeners:ye}),$t?re.data=$t:($t=z1(m),$t!==null&&(re.data=$t)))),($t=c5?u5(u,m):l5(u,m))&&(re=mh(pt,"onBeforeInput"),0<re.length&&(ye=new j1("onBeforeInput","beforeinput",null,m,kt),At.push({event:ye,listeners:re}),ye.data=$t)),tE(At,u,pt,m,kt)}Ax(At,h)})}function rl(u,h,m){return{instance:u,listener:h,currentTarget:m}}function mh(u,h){for(var m=h+"Capture",x=[];u!==null;){var E=u,M=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||M===null||(E=_u(u,m),E!=null&&x.unshift(rl(u,E,M)),E=_u(u,h),E!=null&&x.push(rl(u,E,M))),u.tag===3)return x;u=u.return}return[]}function nc(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function Rx(u,h,m,x,E){for(var M=h._reactName,B=[];m!==null&&m!==x;){var H=m,Z=H.alternate,pt=H.stateNode;if(H=H.tag,Z!==null&&Z===x)break;H!==5&&H!==26&&H!==27||pt===null||(Z=pt,E?(pt=_u(m,M),pt!=null&&B.unshift(rl(m,pt,Z))):E||(pt=_u(m,M),pt!=null&&B.push(rl(m,pt,Z)))),m=m.return}B.length!==0&&u.push({event:h,listeners:B})}var rE=/\r\n?/g,aE=/\u0000|\uFFFD/g;function Mx(u){return(typeof u=="string"?u:""+u).replace(rE,`
`).replace(aE,"")}function Nx(u,h){return h=Mx(h),Mx(u)===h}function bh(){}function Le(u,h,m,x,E,M){switch(m){case"children":typeof x=="string"?h==="body"||h==="textarea"&&x===""||Ao(u,x):(typeof x=="number"||typeof x=="bigint")&&h!=="body"&&Ao(u,""+x);break;case"className":Sf(u,"class",x);break;case"tabIndex":Sf(u,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Sf(u,m,x);break;case"style":D1(u,x,M);break;case"data":if(h!=="object"){Sf(u,"data",x);break}case"src":case"href":if(x===""&&(h!=="a"||m!=="href")){u.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){u.removeAttribute(m);break}x=kf(""+x),u.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){u.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(m==="formAction"?(h!=="input"&&Le(u,h,"name",E.name,E,null),Le(u,h,"formEncType",E.formEncType,E,null),Le(u,h,"formMethod",E.formMethod,E,null),Le(u,h,"formTarget",E.formTarget,E,null)):(Le(u,h,"encType",E.encType,E,null),Le(u,h,"method",E.method,E,null),Le(u,h,"target",E.target,E,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){u.removeAttribute(m);break}x=kf(""+x),u.setAttribute(m,x);break;case"onClick":x!=null&&(u.onclick=bh);break;case"onScroll":x!=null&&we("scroll",u);break;case"onScrollEnd":x!=null&&we("scrollend",u);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(m=x.__html,m!=null){if(E.children!=null)throw Error(r(60));u.innerHTML=m}}break;case"multiple":u.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":u.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){u.removeAttribute("xlink:href");break}m=kf(""+x),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(m,""+x):u.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(m,""):u.removeAttribute(m);break;case"capture":case"download":x===!0?u.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(m,x):u.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?u.setAttribute(m,x):u.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?u.removeAttribute(m):u.setAttribute(m,x);break;case"popover":we("beforetoggle",u),we("toggle",u),_f(u,"popover",x);break;case"xlinkActuate":qr(u,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":qr(u,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":qr(u,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":qr(u,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":qr(u,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":qr(u,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":qr(u,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":qr(u,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":qr(u,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":_f(u,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=Dk.get(m)||m,_f(u,m,x))}}function Ig(u,h,m,x,E,M){switch(m){case"style":D1(u,x,M);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(m=x.__html,m!=null){if(E.children!=null)throw Error(r(60));u.innerHTML=m}}break;case"children":typeof x=="string"?Ao(u,x):(typeof x=="number"||typeof x=="bigint")&&Ao(u,""+x);break;case"onScroll":x!=null&&we("scroll",u);break;case"onScrollEnd":x!=null&&we("scrollend",u);break;case"onClick":x!=null&&(u.onclick=bh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ms.hasOwnProperty(m))t:{if(m[0]==="o"&&m[1]==="n"&&(E=m.endsWith("Capture"),h=m.slice(2,E?m.length-7:void 0),M=u[We]||null,M=M!=null?M[m]:null,typeof M=="function"&&u.removeEventListener(h,M,E),typeof x=="function")){typeof M!="function"&&M!==null&&(m in u?u[m]=null:u.hasAttribute(m)&&u.removeAttribute(m)),u.addEventListener(h,x,E);break t}m in u?u[m]=x:x===!0?u.setAttribute(m,""):_f(u,m,x)}}}function Ci(u,h,m){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":we("error",u),we("load",u);var x=!1,E=!1,M;for(M in m)if(m.hasOwnProperty(M)){var B=m[M];if(B!=null)switch(M){case"src":x=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,h));default:Le(u,h,M,B,m,null)}}E&&Le(u,h,"srcSet",m.srcSet,m,null),x&&Le(u,h,"src",m.src,m,null);return;case"input":we("invalid",u);var H=M=B=E=null,Z=null,pt=null;for(x in m)if(m.hasOwnProperty(x)){var kt=m[x];if(kt!=null)switch(x){case"name":E=kt;break;case"type":B=kt;break;case"checked":Z=kt;break;case"defaultChecked":pt=kt;break;case"value":M=kt;break;case"defaultValue":H=kt;break;case"children":case"dangerouslySetInnerHTML":if(kt!=null)throw Error(r(137,h));break;default:Le(u,h,x,kt,m,null)}}R1(u,M,H,Z,pt,B,E,!1),Tf(u);return;case"select":we("invalid",u),x=B=M=null;for(E in m)if(m.hasOwnProperty(E)&&(H=m[E],H!=null))switch(E){case"value":M=H;break;case"defaultValue":B=H;break;case"multiple":x=H;default:Le(u,h,E,H,m,null)}h=M,m=B,u.multiple=!!x,h!=null?Oo(u,!!x,h,!1):m!=null&&Oo(u,!!x,m,!0);return;case"textarea":we("invalid",u),M=E=x=null;for(B in m)if(m.hasOwnProperty(B)&&(H=m[B],H!=null))switch(B){case"value":x=H;break;case"defaultValue":E=H;break;case"children":M=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(r(91));break;default:Le(u,h,B,H,m,null)}N1(u,x,E,M),Tf(u);return;case"option":for(Z in m)if(m.hasOwnProperty(Z)&&(x=m[Z],x!=null))switch(Z){case"selected":u.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Le(u,h,Z,x,m,null)}return;case"dialog":we("beforetoggle",u),we("toggle",u),we("cancel",u),we("close",u);break;case"iframe":case"object":we("load",u);break;case"video":case"audio":for(x=0;x<nl.length;x++)we(nl[x],u);break;case"image":we("error",u),we("load",u);break;case"details":we("toggle",u);break;case"embed":case"source":case"link":we("error",u),we("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pt in m)if(m.hasOwnProperty(pt)&&(x=m[pt],x!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,h));default:Le(u,h,pt,x,m,null)}return;default:if(j0(h)){for(kt in m)m.hasOwnProperty(kt)&&(x=m[kt],x!==void 0&&Ig(u,h,kt,x,m,void 0));return}}for(H in m)m.hasOwnProperty(H)&&(x=m[H],x!=null&&Le(u,h,H,x,m,null))}function sE(u,h,m,x){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,M=null,B=null,H=null,Z=null,pt=null,kt=null;for(mt in m){var At=m[mt];if(m.hasOwnProperty(mt)&&At!=null)switch(mt){case"checked":break;case"value":break;case"defaultValue":Z=At;default:x.hasOwnProperty(mt)||Le(u,h,mt,null,x,At)}}for(var gt in x){var mt=x[gt];if(At=m[gt],x.hasOwnProperty(gt)&&(mt!=null||At!=null))switch(gt){case"type":M=mt;break;case"name":E=mt;break;case"checked":pt=mt;break;case"defaultChecked":kt=mt;break;case"value":B=mt;break;case"defaultValue":H=mt;break;case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(r(137,h));break;default:mt!==At&&Le(u,h,gt,mt,x,At)}}U0(u,B,H,Z,pt,kt,M,E);return;case"select":mt=B=H=gt=null;for(M in m)if(Z=m[M],m.hasOwnProperty(M)&&Z!=null)switch(M){case"value":break;case"multiple":mt=Z;default:x.hasOwnProperty(M)||Le(u,h,M,null,x,Z)}for(E in x)if(M=x[E],Z=m[E],x.hasOwnProperty(E)&&(M!=null||Z!=null))switch(E){case"value":gt=M;break;case"defaultValue":H=M;break;case"multiple":B=M;default:M!==Z&&Le(u,h,E,M,x,Z)}h=H,m=B,x=mt,gt!=null?Oo(u,!!m,gt,!1):!!x!=!!m&&(h!=null?Oo(u,!!m,h,!0):Oo(u,!!m,m?[]:"",!1));return;case"textarea":mt=gt=null;for(H in m)if(E=m[H],m.hasOwnProperty(H)&&E!=null&&!x.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:Le(u,h,H,null,x,E)}for(B in x)if(E=x[B],M=m[B],x.hasOwnProperty(B)&&(E!=null||M!=null))switch(B){case"value":gt=E;break;case"defaultValue":mt=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(r(91));break;default:E!==M&&Le(u,h,B,E,x,M)}M1(u,gt,mt);return;case"option":for(var ae in m)if(gt=m[ae],m.hasOwnProperty(ae)&&gt!=null&&!x.hasOwnProperty(ae))switch(ae){case"selected":u.selected=!1;break;default:Le(u,h,ae,null,x,gt)}for(Z in x)if(gt=x[Z],mt=m[Z],x.hasOwnProperty(Z)&&gt!==mt&&(gt!=null||mt!=null))switch(Z){case"selected":u.selected=gt&&typeof gt!="function"&&typeof gt!="symbol";break;default:Le(u,h,Z,gt,x,mt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ie in m)gt=m[ie],m.hasOwnProperty(ie)&&gt!=null&&!x.hasOwnProperty(ie)&&Le(u,h,ie,null,x,gt);for(pt in x)if(gt=x[pt],mt=m[pt],x.hasOwnProperty(pt)&&gt!==mt&&(gt!=null||mt!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(r(137,h));break;default:Le(u,h,pt,gt,x,mt)}return;default:if(j0(h)){for(var Ue in m)gt=m[Ue],m.hasOwnProperty(Ue)&&gt!==void 0&&!x.hasOwnProperty(Ue)&&Ig(u,h,Ue,void 0,x,gt);for(kt in x)gt=x[kt],mt=m[kt],!x.hasOwnProperty(kt)||gt===mt||gt===void 0&&mt===void 0||Ig(u,h,kt,gt,x,mt);return}}for(var ct in m)gt=m[ct],m.hasOwnProperty(ct)&&gt!=null&&!x.hasOwnProperty(ct)&&Le(u,h,ct,null,x,gt);for(At in x)gt=x[At],mt=m[At],!x.hasOwnProperty(At)||gt===mt||gt==null&&mt==null||Le(u,h,At,gt,x,mt)}var kg=null,Eg=null;function wh(u){return u.nodeType===9?u:u.ownerDocument}function Cx(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dx(u,h){if(u===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&h==="foreignObject"?0:u}function Og(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Ag=null;function oE(){var u=window.event;return u&&u.type==="popstate"?u===Ag?!1:(Ag=u,!0):(Ag=null,!1)}var Bx=typeof setTimeout=="function"?setTimeout:void 0,cE=typeof clearTimeout=="function"?clearTimeout:void 0,Fx=typeof Promise=="function"?Promise:void 0,uE=typeof queueMicrotask=="function"?queueMicrotask:typeof Fx<"u"?function(u){return Fx.resolve(null).then(u).catch(lE)}:Bx;function lE(u){setTimeout(function(){throw u})}function Wa(u){return u==="head"}function Lx(u,h){var m=h,x=0,E=0;do{var M=m.nextSibling;if(u.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"){if(0<x&&8>x){m=x;var B=u.ownerDocument;if(m&1&&al(B.documentElement),m&2&&al(B.body),m&4)for(m=B.head,al(m),B=m.firstChild;B;){var H=B.nextSibling,Z=B.nodeName;B[$n]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&B.rel.toLowerCase()==="stylesheet"||m.removeChild(B),B=H}}if(E===0){u.removeChild(M),hl(h);return}E--}else m==="$"||m==="$?"||m==="$!"?E++:x=m.charCodeAt(0)-48;else x=0;m=M}while(m);hl(h)}function Pg(u){var h=u.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var m=h;switch(h=h.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Pg(m),ko(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}u.removeChild(m)}}function dE(u,h,m,x){for(;u.nodeType===1;){var E=m;if(u.nodeName.toLowerCase()!==h.toLowerCase()){if(!x&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(x){if(!u[$n])switch(h){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(M=u.getAttribute("rel"),M==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(M!==E.rel||u.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||u.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||u.getAttribute("title")!==(E.title==null?null:E.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(M=u.getAttribute("src"),(M!==(E.src==null?null:E.src)||u.getAttribute("type")!==(E.type==null?null:E.type)||u.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&M&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(h==="input"&&u.type==="hidden"){var M=E.name==null?null:""+E.name;if(E.type==="hidden"&&u.getAttribute("name")===M)return u}else return u;if(u=Gn(u.nextSibling),u===null)break}return null}function fE(u,h,m){if(h==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!m||(u=Gn(u.nextSibling),u===null))return null;return u}function Rg(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState==="complete"}function hE(u,h){var m=u.ownerDocument;if(u.data!=="$?"||m.readyState==="complete")h();else{var x=function(){h(),m.removeEventListener("DOMContentLoaded",x)};m.addEventListener("DOMContentLoaded",x),u._reactRetry=x}}function Gn(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return u}var Mg=null;function Ux(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var m=u.data;if(m==="$"||m==="$!"||m==="$?"){if(h===0)return u;h--}else m==="/$"&&h++}u=u.previousSibling}return null}function qx(u,h,m){switch(h=wh(m),u){case"html":if(u=h.documentElement,!u)throw Error(r(452));return u;case"head":if(u=h.head,!u)throw Error(r(453));return u;case"body":if(u=h.body,!u)throw Error(r(454));return u;default:throw Error(r(451))}}function al(u){for(var h=u.attributes;h.length;)u.removeAttributeNode(h[0]);ko(u)}var Tn=new Map,jx=new Set;function vh(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var ta=j.d;j.d={f:pE,r:yE,D:gE,C:mE,L:bE,m:wE,X:xE,S:vE,M:_E};function pE(){var u=ta.f(),h=dh();return u||h}function yE(u){var h=Fr(u);h!==null&&h.tag===5&&h.type==="form"?ov(h):ta.r(u)}var rc=typeof document>"u"?null:document;function Hx(u,h,m){var x=rc;if(x&&typeof h=="string"&&h){var E=mn(h);E='link[rel="'+u+'"][href="'+E+'"]',typeof m=="string"&&(E+='[crossorigin="'+m+'"]'),jx.has(E)||(jx.add(E),u={rel:u,crossOrigin:m,href:h},x.querySelector(E)===null&&(h=x.createElement("link"),Ci(h,"link",u),ri(h),x.head.appendChild(h)))}}function gE(u){ta.D(u),Hx("dns-prefetch",u,null)}function mE(u,h){ta.C(u,h),Hx("preconnect",u,h)}function bE(u,h,m){ta.L(u,h,m);var x=rc;if(x&&u&&h){var E='link[rel="preload"][as="'+mn(h)+'"]';h==="image"&&m&&m.imageSrcSet?(E+='[imagesrcset="'+mn(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(E+='[imagesizes="'+mn(m.imageSizes)+'"]')):E+='[href="'+mn(u)+'"]';var M=E;switch(h){case"style":M=ac(u);break;case"script":M=sc(u)}Tn.has(M)||(u=c({rel:"preload",href:h==="image"&&m&&m.imageSrcSet?void 0:u,as:h},m),Tn.set(M,u),x.querySelector(E)!==null||h==="style"&&x.querySelector(sl(M))||h==="script"&&x.querySelector(ol(M))||(h=x.createElement("link"),Ci(h,"link",u),ri(h),x.head.appendChild(h)))}}function wE(u,h){ta.m(u,h);var m=rc;if(m&&u){var x=h&&typeof h.as=="string"?h.as:"script",E='link[rel="modulepreload"][as="'+mn(x)+'"][href="'+mn(u)+'"]',M=E;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=sc(u)}if(!Tn.has(M)&&(u=c({rel:"modulepreload",href:u},h),Tn.set(M,u),m.querySelector(E)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(ol(M)))return}x=m.createElement("link"),Ci(x,"link",u),ri(x),m.head.appendChild(x)}}}function vE(u,h,m){ta.S(u,h,m);var x=rc;if(x&&u){var E=Lr(x).hoistableStyles,M=ac(u);h=h||"default";var B=E.get(M);if(!B){var H={loading:0,preload:null};if(B=x.querySelector(sl(M)))H.loading=5;else{u=c({rel:"stylesheet",href:u,"data-precedence":h},m),(m=Tn.get(M))&&Ng(u,m);var Z=B=x.createElement("link");ri(Z),Ci(Z,"link",u),Z._p=new Promise(function(pt,kt){Z.onload=pt,Z.onerror=kt}),Z.addEventListener("load",function(){H.loading|=1}),Z.addEventListener("error",function(){H.loading|=2}),H.loading|=4,xh(B,h,x)}B={type:"stylesheet",instance:B,count:1,state:H},E.set(M,B)}}}function xE(u,h){ta.X(u,h);var m=rc;if(m&&u){var x=Lr(m).hoistableScripts,E=sc(u),M=x.get(E);M||(M=m.querySelector(ol(E)),M||(u=c({src:u,async:!0},h),(h=Tn.get(E))&&Cg(u,h),M=m.createElement("script"),ri(M),Ci(M,"link",u),m.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},x.set(E,M))}}function _E(u,h){ta.M(u,h);var m=rc;if(m&&u){var x=Lr(m).hoistableScripts,E=sc(u),M=x.get(E);M||(M=m.querySelector(ol(E)),M||(u=c({src:u,async:!0,type:"module"},h),(h=Tn.get(E))&&Cg(u,h),M=m.createElement("script"),ri(M),Ci(M,"link",u),m.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},x.set(E,M))}}function Kx(u,h,m,x){var E=(E=wt.current)?vh(E):null;if(!E)throw Error(r(446));switch(u){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(h=ac(m.href),m=Lr(E).hoistableStyles,x=m.get(h),x||(x={type:"style",instance:null,count:0,state:null},m.set(h,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){u=ac(m.href);var M=Lr(E).hoistableStyles,B=M.get(u);if(B||(E=E.ownerDocument||E,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(u,B),(M=E.querySelector(sl(u)))&&!M._p&&(B.instance=M,B.state.loading=5),Tn.has(u)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Tn.set(u,m),M||SE(E,u,m,B.state))),h&&x===null)throw Error(r(528,""));return B}if(h&&x!==null)throw Error(r(529,""));return null;case"script":return h=m.async,m=m.src,typeof m=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=sc(m),m=Lr(E).hoistableScripts,x=m.get(h),x||(x={type:"script",instance:null,count:0,state:null},m.set(h,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,u))}}function ac(u){return'href="'+mn(u)+'"'}function sl(u){return'link[rel="stylesheet"]['+u+"]"}function Vx(u){return c({},u,{"data-precedence":u.precedence,precedence:null})}function SE(u,h,m,x){u.querySelector('link[rel="preload"][as="style"]['+h+"]")?x.loading=1:(h=u.createElement("link"),x.preload=h,h.addEventListener("load",function(){return x.loading|=1}),h.addEventListener("error",function(){return x.loading|=2}),Ci(h,"link",m),ri(h),u.head.appendChild(h))}function sc(u){return'[src="'+mn(u)+'"]'}function ol(u){return"script[async]"+u}function Wx(u,h,m){if(h.count++,h.instance===null)switch(h.type){case"style":var x=u.querySelector('style[data-href~="'+mn(m.href)+'"]');if(x)return h.instance=x,ri(x),x;var E=c({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(u.ownerDocument||u).createElement("style"),ri(x),Ci(x,"style",E),xh(x,m.precedence,u),h.instance=x;case"stylesheet":E=ac(m.href);var M=u.querySelector(sl(E));if(M)return h.state.loading|=4,h.instance=M,ri(M),M;x=Vx(m),(E=Tn.get(E))&&Ng(x,E),M=(u.ownerDocument||u).createElement("link"),ri(M);var B=M;return B._p=new Promise(function(H,Z){B.onload=H,B.onerror=Z}),Ci(M,"link",x),h.state.loading|=4,xh(M,m.precedence,u),h.instance=M;case"script":return M=sc(m.src),(E=u.querySelector(ol(M)))?(h.instance=E,ri(E),E):(x=m,(E=Tn.get(M))&&(x=c({},m),Cg(x,E)),u=u.ownerDocument||u,E=u.createElement("script"),ri(E),Ci(E,"link",x),u.head.appendChild(E),h.instance=E);case"void":return null;default:throw Error(r(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(x=h.instance,h.state.loading|=4,xh(x,m.precedence,u));return h.instance}function xh(u,h,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=x.length?x[x.length-1]:null,M=E,B=0;B<x.length;B++){var H=x[B];if(H.dataset.precedence===h)M=H;else if(M!==E)break}M?M.parentNode.insertBefore(u,M.nextSibling):(h=m.nodeType===9?m.head:m,h.insertBefore(u,h.firstChild))}function Ng(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.title==null&&(u.title=h.title)}function Cg(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.integrity==null&&(u.integrity=h.integrity)}var _h=null;function $x(u,h,m){if(_h===null){var x=new Map,E=_h=new Map;E.set(m,x)}else E=_h,x=E.get(m),x||(x=new Map,E.set(m,x));if(x.has(u))return x;for(x.set(u,null),m=m.getElementsByTagName(u),E=0;E<m.length;E++){var M=m[E];if(!(M[$n]||M[Re]||u==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var B=M.getAttribute(h)||"";B=u+B;var H=x.get(B);H?H.push(M):x.set(B,[M])}}return x}function zx(u,h,m){u=u.ownerDocument||u,u.head.insertBefore(m,h==="title"?u.querySelector("head > title"):null)}function TE(u,h,m){if(m===1||h.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return u=h.disabled,typeof h.precedence=="string"&&u==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function Xx(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var cl=null;function IE(){}function kE(u,h,m){if(cl===null)throw Error(r(475));var x=cl;if(h.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var E=ac(m.href),M=u.querySelector(sl(E));if(M){u=M._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(x.count++,x=Sh.bind(x),u.then(x,x)),h.state.loading|=4,h.instance=M,ri(M);return}M=u.ownerDocument||u,m=Vx(m),(E=Tn.get(E))&&Ng(m,E),M=M.createElement("link"),ri(M);var B=M;B._p=new Promise(function(H,Z){B.onload=H,B.onerror=Z}),Ci(M,"link",m),h.instance=M}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(x.count++,h=Sh.bind(x),u.addEventListener("load",h),u.addEventListener("error",h))}}function EE(){if(cl===null)throw Error(r(475));var u=cl;return u.stylesheets&&u.count===0&&Dg(u,u.stylesheets),0<u.count?function(h){var m=setTimeout(function(){if(u.stylesheets&&Dg(u,u.stylesheets),u.unsuspend){var x=u.unsuspend;u.unsuspend=null,x()}},6e4);return u.unsuspend=h,function(){u.unsuspend=null,clearTimeout(m)}}:null}function Sh(){if(this.count--,this.count===0){if(this.stylesheets)Dg(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var Th=null;function Dg(u,h){u.stylesheets=null,u.unsuspend!==null&&(u.count++,Th=new Map,h.forEach(OE,u),Th=null,Sh.call(u))}function OE(u,h){if(!(h.state.loading&4)){var m=Th.get(u);if(m)var x=m.get(null);else{m=new Map,Th.set(u,m);for(var E=u.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<E.length;M++){var B=E[M];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(m.set(B.dataset.precedence,B),x=B)}x&&m.set(null,x)}E=h.instance,B=E.getAttribute("data-precedence"),M=m.get(B)||x,M===x&&m.set(null,E),m.set(B,E),this.count++,x=Sh.bind(this),E.addEventListener("load",x),E.addEventListener("error",x),M?M.parentNode.insertBefore(E,M.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(E,u.firstChild)),h.state.loading|=4}}var ul={$$typeof:S,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function AE(u,h,m,x,E,M,B,H){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.hiddenUpdates=jt(null),this.identifierPrefix=x,this.onUncaughtError=E,this.onCaughtError=M,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Gx(u,h,m,x,E,M,B,H,Z,pt,kt,At){return u=new AE(u,h,m,B,H,Z,pt,At),h=1,M===!0&&(h|=24),M=tn(3,null,null,h),u.current=M,M.stateNode=u,h=gy(),h.refCount++,u.pooledCache=h,h.refCount++,M.memoizedState={element:x,isDehydrated:m,cache:h},vy(M),u}function Yx(u){return u?(u=Fo,u):Fo}function Qx(u,h,m,x,E,M){E=Yx(E),x.context===null?x.context=E:x.pendingContext=E,x=Ma(h),x.payload={element:m},M=M===void 0?null:M,M!==null&&(x.callback=M),m=Na(u,x,h),m!==null&&(sn(m,u,h),Uu(m,u,h))}function Zx(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var m=u.retryLane;u.retryLane=m!==0&&m<h?m:h}}function Bg(u,h){Zx(u,h),(u=u.alternate)&&Zx(u,h)}function Jx(u){if(u.tag===13){var h=Bo(u,67108864);h!==null&&sn(h,u,67108864),Bg(u,67108864)}}var Ih=!0;function PE(u,h,m,x){var E=L.T;L.T=null;var M=j.p;try{j.p=2,Fg(u,h,m,x)}finally{j.p=M,L.T=E}}function RE(u,h,m,x){var E=L.T;L.T=null;var M=j.p;try{j.p=8,Fg(u,h,m,x)}finally{j.p=M,L.T=E}}function Fg(u,h,m,x){if(Ih){var E=Lg(x);if(E===null)Tg(u,h,x,kh,m),e2(u,x);else if(NE(E,u,h,m,x))x.stopPropagation();else if(e2(u,x),h&4&&-1<ME.indexOf(u)){for(;E!==null;){var M=Fr(E);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var B=G(M.pendingLanes);if(B!==0){var H=M;for(H.pendingLanes|=2,H.entangledLanes|=2;B;){var Z=1<<31-Rt(B);H.entanglements[1]|=Z,B&=~Z}gr(M),(Me&6)===0&&(uh=Vt()+500,il(0))}}break;case 13:H=Bo(M,2),H!==null&&sn(H,M,2),dh(),Bg(M,2)}if(M=Lg(x),M===null&&Tg(u,h,x,kh,m),M===E)break;E=M}E!==null&&x.stopPropagation()}else Tg(u,h,x,null,m)}}function Lg(u){return u=K0(u),Ug(u)}var kh=null;function Ug(u){if(kh=null,u=Br(u),u!==null){var h=o(u);if(h===null)u=null;else{var m=h.tag;if(m===13){if(u=a(h),u!==null)return u;u=null}else if(m===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null)}}return kh=u,null}function t2(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jt()){case Ct:return 2;case K:return 8;case ut:case st:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var qg=!1,$a=null,za=null,Xa=null,ll=new Map,dl=new Map,Ga=[],ME="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function e2(u,h){switch(u){case"focusin":case"focusout":$a=null;break;case"dragenter":case"dragleave":za=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":ll.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":dl.delete(h.pointerId)}}function fl(u,h,m,x,E,M){return u===null||u.nativeEvent!==M?(u={blockedOn:h,domEventName:m,eventSystemFlags:x,nativeEvent:M,targetContainers:[E]},h!==null&&(h=Fr(h),h!==null&&Jx(h)),u):(u.eventSystemFlags|=x,h=u.targetContainers,E!==null&&h.indexOf(E)===-1&&h.push(E),u)}function NE(u,h,m,x,E){switch(h){case"focusin":return $a=fl($a,u,h,m,x,E),!0;case"dragenter":return za=fl(za,u,h,m,x,E),!0;case"mouseover":return Xa=fl(Xa,u,h,m,x,E),!0;case"pointerover":var M=E.pointerId;return ll.set(M,fl(ll.get(M)||null,u,h,m,x,E)),!0;case"gotpointercapture":return M=E.pointerId,dl.set(M,fl(dl.get(M)||null,u,h,m,x,E)),!0}return!1}function i2(u){var h=Br(u.target);if(h!==null){var m=o(h);if(m!==null){if(h=m.tag,h===13){if(h=a(m),h!==null){u.blockedOn=h,Si(u.priority,function(){if(m.tag===13){var x=an();x=pe(x);var E=Bo(m,x);E!==null&&sn(E,m,x),Bg(m,x)}});return}}else if(h===3&&m.stateNode.current.memoizedState.isDehydrated){u.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Eh(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var m=Lg(u.nativeEvent);if(m===null){m=u.nativeEvent;var x=new m.constructor(m.type,m);H0=x,m.target.dispatchEvent(x),H0=null}else return h=Fr(m),h!==null&&Jx(h),u.blockedOn=m,!1;h.shift()}return!0}function n2(u,h,m){Eh(u)&&m.delete(h)}function CE(){qg=!1,$a!==null&&Eh($a)&&($a=null),za!==null&&Eh(za)&&(za=null),Xa!==null&&Eh(Xa)&&(Xa=null),ll.forEach(n2),dl.forEach(n2)}function Oh(u,h){u.blockedOn===h&&(u.blockedOn=null,qg||(qg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,CE)))}var Ah=null;function r2(u){Ah!==u&&(Ah=u,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ah===u&&(Ah=null);for(var h=0;h<u.length;h+=3){var m=u[h],x=u[h+1],E=u[h+2];if(typeof x!="function"){if(Ug(x||m)===null)continue;break}var M=Fr(m);M!==null&&(u.splice(h,3),h-=3,Uy(M,{pending:!0,data:E,method:m.method,action:x},x,E))}}))}function hl(u){function h(Z){return Oh(Z,u)}$a!==null&&Oh($a,u),za!==null&&Oh(za,u),Xa!==null&&Oh(Xa,u),ll.forEach(h),dl.forEach(h);for(var m=0;m<Ga.length;m++){var x=Ga[m];x.blockedOn===u&&(x.blockedOn=null)}for(;0<Ga.length&&(m=Ga[0],m.blockedOn===null);)i2(m),m.blockedOn===null&&Ga.shift();if(m=(u.ownerDocument||u).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var E=m[x],M=m[x+1],B=E[We]||null;if(typeof M=="function")B||r2(m);else if(B){var H=null;if(M&&M.hasAttribute("formAction")){if(E=M,B=M[We]||null)H=B.formAction;else if(Ug(E)!==null)continue}else H=B.action;typeof H=="function"?m[x+1]=H:(m.splice(x,3),x-=3),r2(m)}}}function jg(u){this._internalRoot=u}Ph.prototype.render=jg.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(r(409));var m=h.current,x=an();Qx(m,x,u,h,null,null)},Ph.prototype.unmount=jg.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;Qx(u.current,2,null,u,null,null),dh(),h[Ti]=null}};function Ph(u){this._internalRoot=u}Ph.prototype.unstable_scheduleHydration=function(u){if(u){var h=ce();u={blockedOn:null,target:u,priority:h};for(var m=0;m<Ga.length&&h!==0&&h<Ga[m].priority;m++);Ga.splice(m,0,u),m===0&&i2(u)}};var a2=t.version;if(a2!=="19.1.0")throw Error(r(527,a2,"19.1.0"));j.findDOMNode=function(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=f(h),u=u!==null?n(u):null,u=u===null?null:u.stateNode,u};var DE={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{Xt=Rh.inject(DE),Qt=Rh}catch{}}return yl.createRoot=function(u,h){if(!e(u))throw Error(r(299));var m=!1,x="",E=xv,M=_v,B=Sv,H=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(M=h.onCaughtError),h.onRecoverableError!==void 0&&(B=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(H=h.unstable_transitionCallbacks)),h=Gx(u,1,!1,null,null,m,x,E,M,B,H,null),u[Ti]=h.current,Sg(u),new jg(h)},yl.hydrateRoot=function(u,h,m){if(!e(u))throw Error(r(299));var x=!1,E="",M=xv,B=_v,H=Sv,Z=null,pt=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(E=m.identifierPrefix),m.onUncaughtError!==void 0&&(M=m.onUncaughtError),m.onCaughtError!==void 0&&(B=m.onCaughtError),m.onRecoverableError!==void 0&&(H=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(Z=m.unstable_transitionCallbacks),m.formState!==void 0&&(pt=m.formState)),h=Gx(u,1,!0,h,m??null,x,E,M,B,H,Z,pt),h.context=Yx(null),m=h.current,x=an(),x=pe(x),E=Ma(x),E.callback=null,Na(m,E,x),m=x,h.current.lanes=m,Yt(h,m),gr(h),u[Ti]=h.current,Sg(u),new Ph(h)},yl.version="19.1.0",yl}var y2;function zE(){if(y2)return Vg.exports;y2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Vg.exports=$E(),Vg.exports}var XE=zE();const Yd={black:"#000",white:"#fff"},oc={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},cc={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},uc={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},lc={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},dc={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},gl={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},GE={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function ss(s,...t){const i=new URL(`https://mui.com/production-error/?code=${s}`);return t.forEach(r=>i.searchParams.append("args[]",r)),`Minified MUI error #${s}; visit ${i} for the full message.`}const Tr="$$material";function Mp(){return Mp=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(s[r]=i[r])}return s},Mp.apply(null,arguments)}function YE(s){if(s.sheet)return s.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===s)return document.styleSheets[t]}function QE(s){var t=document.createElement("style");return t.setAttribute("data-emotion",s.key),s.nonce!==void 0&&t.setAttribute("nonce",s.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var ZE=function(){function s(i){var r=this;this._insertTag=function(e){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(e,o),r.tags.push(e)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var t=s.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(QE(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var o=YE(e);try{o.insertRule(r,o.cssRules.length)}catch{}}else e.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var e;return(e=r.parentNode)==null?void 0:e.removeChild(r)}),this.tags=[],this.ctr=0},s}(),Li="-ms-",Np="-moz-",Oe="-webkit-",m8="comm",Pb="rule",Rb="decl",JE="@import",b8="@keyframes",tO="@layer",eO=Math.abs,Qp=String.fromCharCode,iO=Object.assign;function nO(s,t){return Di(s,0)^45?(((t<<2^Di(s,0))<<2^Di(s,1))<<2^Di(s,2))<<2^Di(s,3):0}function w8(s){return s.trim()}function rO(s,t){return(s=t.exec(s))?s[0]:s}function Ae(s,t,i){return s.replace(t,i)}function Wm(s,t){return s.indexOf(t)}function Di(s,t){return s.charCodeAt(t)|0}function Qd(s,t,i){return s.slice(t,i)}function vr(s){return s.length}function Mb(s){return s.length}function Mh(s,t){return t.push(s),s}function aO(s,t){return s.map(t).join("")}var Zp=1,ru=1,v8=0,Qi=0,pi=0,hu="";function Jp(s,t,i,r,e,o,a){return{value:s,root:t,parent:i,type:r,props:e,children:o,line:Zp,column:ru,length:a,return:""}}function ml(s,t){return iO(Jp("",null,null,"",null,null,0),s,{length:-s.length},t)}function sO(){return pi}function oO(){return pi=Qi>0?Di(hu,--Qi):0,ru--,pi===10&&(ru=1,Zp--),pi}function pn(){return pi=Qi<v8?Di(hu,Qi++):0,ru++,pi===10&&(ru=1,Zp++),pi}function Ir(){return Di(hu,Qi)}function Sp(){return Qi}function af(s,t){return Qd(hu,s,t)}function Zd(s){switch(s){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function x8(s){return Zp=ru=1,v8=vr(hu=s),Qi=0,[]}function _8(s){return hu="",s}function Tp(s){return w8(af(Qi-1,$m(s===91?s+2:s===40?s+1:s)))}function cO(s){for(;(pi=Ir())&&pi<33;)pn();return Zd(s)>2||Zd(pi)>3?"":" "}function uO(s,t){for(;--t&&pn()&&!(pi<48||pi>102||pi>57&&pi<65||pi>70&&pi<97););return af(s,Sp()+(t<6&&Ir()==32&&pn()==32))}function $m(s){for(;pn();)switch(pi){case s:return Qi;case 34:case 39:s!==34&&s!==39&&$m(pi);break;case 40:s===41&&$m(s);break;case 92:pn();break}return Qi}function lO(s,t){for(;pn()&&s+pi!==57;)if(s+pi===84&&Ir()===47)break;return"/*"+af(t,Qi-1)+"*"+Qp(s===47?s:pn())}function dO(s){for(;!Zd(Ir());)pn();return af(s,Qi)}function fO(s){return _8(Ip("",null,null,null,[""],s=x8(s),0,[0],s))}function Ip(s,t,i,r,e,o,a,l,f){for(var n=0,c=0,d=a,y=0,p=0,g=0,b=1,w=1,v=1,_=0,S="",T=e,I=o,k=r,O=S;w;)switch(g=_,_=pn()){case 40:if(g!=108&&Di(O,d-1)==58){Wm(O+=Ae(Tp(_),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:O+=Tp(_);break;case 9:case 10:case 13:case 32:O+=cO(g);break;case 92:O+=uO(Sp()-1,7);continue;case 47:switch(Ir()){case 42:case 47:Mh(hO(lO(pn(),Sp()),t,i),f);break;default:O+="/"}break;case 123*b:l[n++]=vr(O)*v;case 125*b:case 59:case 0:switch(_){case 0:case 125:w=0;case 59+c:v==-1&&(O=Ae(O,/\f/g,"")),p>0&&vr(O)-d&&Mh(p>32?m2(O+";",r,i,d-1):m2(Ae(O," ","")+";",r,i,d-2),f);break;case 59:O+=";";default:if(Mh(k=g2(O,t,i,n,c,e,l,S,T=[],I=[],d),o),_===123)if(c===0)Ip(O,t,k,k,T,o,d,l,I);else switch(y===99&&Di(O,3)===110?100:y){case 100:case 108:case 109:case 115:Ip(s,k,k,r&&Mh(g2(s,k,k,0,0,e,l,S,e,T=[],d),I),e,I,d,l,r?T:I);break;default:Ip(O,k,k,k,[""],I,0,l,I)}}n=c=p=0,b=v=1,S=O="",d=a;break;case 58:d=1+vr(O),p=g;default:if(b<1){if(_==123)--b;else if(_==125&&b++==0&&oO()==125)continue}switch(O+=Qp(_),_*b){case 38:v=c>0?1:(O+="\f",-1);break;case 44:l[n++]=(vr(O)-1)*v,v=1;break;case 64:Ir()===45&&(O+=Tp(pn())),y=Ir(),c=d=vr(S=O+=dO(Sp())),_++;break;case 45:g===45&&vr(O)==2&&(b=0)}}return o}function g2(s,t,i,r,e,o,a,l,f,n,c){for(var d=e-1,y=e===0?o:[""],p=Mb(y),g=0,b=0,w=0;g<r;++g)for(var v=0,_=Qd(s,d+1,d=eO(b=a[g])),S=s;v<p;++v)(S=w8(b>0?y[v]+" "+_:Ae(_,/&\f/g,y[v])))&&(f[w++]=S);return Jp(s,t,i,e===0?Pb:l,f,n,c)}function hO(s,t,i){return Jp(s,t,i,m8,Qp(sO()),Qd(s,2,-2),0)}function m2(s,t,i,r){return Jp(s,t,i,Rb,Qd(s,0,r),Qd(s,r+1,-1),r)}function Jc(s,t){for(var i="",r=Mb(s),e=0;e<r;e++)i+=t(s[e],e,s,t)||"";return i}function pO(s,t,i,r){switch(s.type){case tO:if(s.children.length)break;case JE:case Rb:return s.return=s.return||s.value;case m8:return"";case b8:return s.return=s.value+"{"+Jc(s.children,r)+"}";case Pb:s.value=s.props.join(",")}return vr(i=Jc(s.children,r))?s.return=s.value+"{"+i+"}":""}function yO(s){var t=Mb(s);return function(i,r,e,o){for(var a="",l=0;l<t;l++)a+=s[l](i,r,e,o)||"";return a}}function gO(s){return function(t){t.root||(t=t.return)&&s(t)}}function S8(s){var t=Object.create(null);return function(i){return t[i]===void 0&&(t[i]=s(i)),t[i]}}var mO=function(t,i,r){for(var e=0,o=0;e=o,o=Ir(),e===38&&o===12&&(i[r]=1),!Zd(o);)pn();return af(t,Qi)},bO=function(t,i){var r=-1,e=44;do switch(Zd(e)){case 0:e===38&&Ir()===12&&(i[r]=1),t[r]+=mO(Qi-1,i,r);break;case 2:t[r]+=Tp(e);break;case 4:if(e===44){t[++r]=Ir()===58?"&\f":"",i[r]=t[r].length;break}default:t[r]+=Qp(e)}while(e=pn());return t},wO=function(t,i){return _8(bO(x8(t),i))},b2=new WeakMap,vO=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var i=t.value,r=t.parent,e=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&i.charCodeAt(0)!==58&&!b2.get(r))&&!e){b2.set(t,!0);for(var o=[],a=wO(i,o),l=r.props,f=0,n=0;f<a.length;f++)for(var c=0;c<l.length;c++,n++)t.props[n]=o[f]?a[f].replace(/&\f/g,l[c]):l[c]+" "+a[f]}}},xO=function(t){if(t.type==="decl"){var i=t.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(t.return="",t.value="")}};function T8(s,t){switch(nO(s,t)){case 5103:return Oe+"print-"+s+s;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Oe+s+s;case 5349:case 4246:case 4810:case 6968:case 2756:return Oe+s+Np+s+Li+s+s;case 6828:case 4268:return Oe+s+Li+s+s;case 6165:return Oe+s+Li+"flex-"+s+s;case 5187:return Oe+s+Ae(s,/(\w+).+(:[^]+)/,Oe+"box-$1$2"+Li+"flex-$1$2")+s;case 5443:return Oe+s+Li+"flex-item-"+Ae(s,/flex-|-self/,"")+s;case 4675:return Oe+s+Li+"flex-line-pack"+Ae(s,/align-content|flex-|-self/,"")+s;case 5548:return Oe+s+Li+Ae(s,"shrink","negative")+s;case 5292:return Oe+s+Li+Ae(s,"basis","preferred-size")+s;case 6060:return Oe+"box-"+Ae(s,"-grow","")+Oe+s+Li+Ae(s,"grow","positive")+s;case 4554:return Oe+Ae(s,/([^-])(transform)/g,"$1"+Oe+"$2")+s;case 6187:return Ae(Ae(Ae(s,/(zoom-|grab)/,Oe+"$1"),/(image-set)/,Oe+"$1"),s,"")+s;case 5495:case 3959:return Ae(s,/(image-set\([^]*)/,Oe+"$1$`$1");case 4968:return Ae(Ae(s,/(.+:)(flex-)?(.*)/,Oe+"box-pack:$3"+Li+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Oe+s+s;case 4095:case 3583:case 4068:case 2532:return Ae(s,/(.+)-inline(.+)/,Oe+"$1$2")+s;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(vr(s)-1-t>6)switch(Di(s,t+1)){case 109:if(Di(s,t+4)!==45)break;case 102:return Ae(s,/(.+:)(.+)-([^]+)/,"$1"+Oe+"$2-$3$1"+Np+(Di(s,t+3)==108?"$3":"$2-$3"))+s;case 115:return~Wm(s,"stretch")?T8(Ae(s,"stretch","fill-available"),t)+s:s}break;case 4949:if(Di(s,t+1)!==115)break;case 6444:switch(Di(s,vr(s)-3-(~Wm(s,"!important")&&10))){case 107:return Ae(s,":",":"+Oe)+s;case 101:return Ae(s,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Oe+(Di(s,14)===45?"inline-":"")+"box$3$1"+Oe+"$2$3$1"+Li+"$2box$3")+s}break;case 5936:switch(Di(s,t+11)){case 114:return Oe+s+Li+Ae(s,/[svh]\w+-[tblr]{2}/,"tb")+s;case 108:return Oe+s+Li+Ae(s,/[svh]\w+-[tblr]{2}/,"tb-rl")+s;case 45:return Oe+s+Li+Ae(s,/[svh]\w+-[tblr]{2}/,"lr")+s}return Oe+s+Li+s+s}return s}var _O=function(t,i,r,e){if(t.length>-1&&!t.return)switch(t.type){case Rb:t.return=T8(t.value,t.length);break;case b8:return Jc([ml(t,{value:Ae(t.value,"@","@"+Oe)})],e);case Pb:if(t.length)return aO(t.props,function(o){switch(rO(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Jc([ml(t,{props:[Ae(o,/:(read-\w+)/,":"+Np+"$1")]})],e);case"::placeholder":return Jc([ml(t,{props:[Ae(o,/:(plac\w+)/,":"+Oe+"input-$1")]}),ml(t,{props:[Ae(o,/:(plac\w+)/,":"+Np+"$1")]}),ml(t,{props:[Ae(o,/:(plac\w+)/,Li+"input-$1")]})],e)}return""})}},SO=[_O],TO=function(t){var i=t.key;if(i==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(b){var w=b.getAttribute("data-emotion");w.indexOf(" ")!==-1&&(document.head.appendChild(b),b.setAttribute("data-s",""))})}var e=t.stylisPlugins||SO,o={},a,l=[];a=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(b){for(var w=b.getAttribute("data-emotion").split(" "),v=1;v<w.length;v++)o[w[v]]=!0;l.push(b)});var f,n=[vO,xO];{var c,d=[pO,gO(function(b){c.insert(b)})],y=yO(n.concat(e,d)),p=function(w){return Jc(fO(w),y)};f=function(w,v,_,S){c=_,p(w?w+"{"+v.styles+"}":v.styles),S&&(g.inserted[v.name]=!0)}}var g={key:i,sheet:new ZE({key:i,container:a,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:f};return g.sheet.hydrate(l),g},Xg={exports:{}},Pe={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w2;function IO(){if(w2)return Pe;w2=1;var s=typeof Symbol=="function"&&Symbol.for,t=s?Symbol.for("react.element"):60103,i=s?Symbol.for("react.portal"):60106,r=s?Symbol.for("react.fragment"):60107,e=s?Symbol.for("react.strict_mode"):60108,o=s?Symbol.for("react.profiler"):60114,a=s?Symbol.for("react.provider"):60109,l=s?Symbol.for("react.context"):60110,f=s?Symbol.for("react.async_mode"):60111,n=s?Symbol.for("react.concurrent_mode"):60111,c=s?Symbol.for("react.forward_ref"):60112,d=s?Symbol.for("react.suspense"):60113,y=s?Symbol.for("react.suspense_list"):60120,p=s?Symbol.for("react.memo"):60115,g=s?Symbol.for("react.lazy"):60116,b=s?Symbol.for("react.block"):60121,w=s?Symbol.for("react.fundamental"):60117,v=s?Symbol.for("react.responder"):60118,_=s?Symbol.for("react.scope"):60119;function S(I){if(typeof I=="object"&&I!==null){var k=I.$$typeof;switch(k){case t:switch(I=I.type,I){case f:case n:case r:case o:case e:case d:return I;default:switch(I=I&&I.$$typeof,I){case l:case c:case g:case p:case a:return I;default:return k}}case i:return k}}}function T(I){return S(I)===n}return Pe.AsyncMode=f,Pe.ConcurrentMode=n,Pe.ContextConsumer=l,Pe.ContextProvider=a,Pe.Element=t,Pe.ForwardRef=c,Pe.Fragment=r,Pe.Lazy=g,Pe.Memo=p,Pe.Portal=i,Pe.Profiler=o,Pe.StrictMode=e,Pe.Suspense=d,Pe.isAsyncMode=function(I){return T(I)||S(I)===f},Pe.isConcurrentMode=T,Pe.isContextConsumer=function(I){return S(I)===l},Pe.isContextProvider=function(I){return S(I)===a},Pe.isElement=function(I){return typeof I=="object"&&I!==null&&I.$$typeof===t},Pe.isForwardRef=function(I){return S(I)===c},Pe.isFragment=function(I){return S(I)===r},Pe.isLazy=function(I){return S(I)===g},Pe.isMemo=function(I){return S(I)===p},Pe.isPortal=function(I){return S(I)===i},Pe.isProfiler=function(I){return S(I)===o},Pe.isStrictMode=function(I){return S(I)===e},Pe.isSuspense=function(I){return S(I)===d},Pe.isValidElementType=function(I){return typeof I=="string"||typeof I=="function"||I===r||I===n||I===o||I===e||I===d||I===y||typeof I=="object"&&I!==null&&(I.$$typeof===g||I.$$typeof===p||I.$$typeof===a||I.$$typeof===l||I.$$typeof===c||I.$$typeof===w||I.$$typeof===v||I.$$typeof===_||I.$$typeof===b)},Pe.typeOf=S,Pe}var v2;function kO(){return v2||(v2=1,Xg.exports=IO()),Xg.exports}var Gg,x2;function EO(){if(x2)return Gg;x2=1;var s=kO(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},e={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[s.ForwardRef]=r,o[s.Memo]=e;function a(g){return s.isMemo(g)?e:o[g.$$typeof]||t}var l=Object.defineProperty,f=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,y=Object.prototype;function p(g,b,w){if(typeof b!="string"){if(y){var v=d(b);v&&v!==y&&p(g,v,w)}var _=f(b);n&&(_=_.concat(n(b)));for(var S=a(g),T=a(b),I=0;I<_.length;++I){var k=_[I];if(!i[k]&&!(w&&w[k])&&!(T&&T[k])&&!(S&&S[k])){var O=c(b,k);try{l(g,k,O)}catch{}}}}return g}return Gg=p,Gg}EO();var OO=!0;function I8(s,t,i){var r="";return i.split(" ").forEach(function(e){s[e]!==void 0?t.push(s[e]+";"):e&&(r+=e+" ")}),r}var Nb=function(t,i,r){var e=t.key+"-"+i.name;(r===!1||OO===!1)&&t.registered[e]===void 0&&(t.registered[e]=i.styles)},Cb=function(t,i,r){Nb(t,i,r);var e=t.key+"-"+i.name;if(t.inserted[i.name]===void 0){var o=i;do t.insert(i===o?"."+e:"",o,t.sheet,!0),o=o.next;while(o!==void 0)}};function AO(s){for(var t=0,i,r=0,e=s.length;e>=4;++r,e-=4)i=s.charCodeAt(r)&255|(s.charCodeAt(++r)&255)<<8|(s.charCodeAt(++r)&255)<<16|(s.charCodeAt(++r)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(e){case 3:t^=(s.charCodeAt(r+2)&255)<<16;case 2:t^=(s.charCodeAt(r+1)&255)<<8;case 1:t^=s.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var PO={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},RO=/[A-Z]|^ms/g,MO=/_EMO_([^_]+?)_([^]*?)_EMO_/g,k8=function(t){return t.charCodeAt(1)===45},_2=function(t){return t!=null&&typeof t!="boolean"},Yg=S8(function(s){return k8(s)?s:s.replace(RO,"-$&").toLowerCase()}),S2=function(t,i){switch(t){case"animation":case"animationName":if(typeof i=="string")return i.replace(MO,function(r,e,o){return xr={name:e,styles:o,next:xr},e})}return PO[t]!==1&&!k8(t)&&typeof i=="number"&&i!==0?i+"px":i};function Jd(s,t,i){if(i==null)return"";var r=i;if(r.__emotion_styles!==void 0)return r;switch(typeof i){case"boolean":return"";case"object":{var e=i;if(e.anim===1)return xr={name:e.name,styles:e.styles,next:xr},e.name;var o=i;if(o.styles!==void 0){var a=o.next;if(a!==void 0)for(;a!==void 0;)xr={name:a.name,styles:a.styles,next:xr},a=a.next;var l=o.styles+";";return l}return NO(s,t,i)}case"function":{if(s!==void 0){var f=xr,n=i(s);return xr=f,Jd(s,t,n)}break}}var c=i;if(t==null)return c;var d=t[c];return d!==void 0?d:c}function NO(s,t,i){var r="";if(Array.isArray(i))for(var e=0;e<i.length;e++)r+=Jd(s,t,i[e])+";";else for(var o in i){var a=i[o];if(typeof a!="object"){var l=a;t!=null&&t[l]!==void 0?r+=o+"{"+t[l]+"}":_2(l)&&(r+=Yg(o)+":"+S2(o,l)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(t==null||t[a[0]]===void 0))for(var f=0;f<a.length;f++)_2(a[f])&&(r+=Yg(o)+":"+S2(o,a[f])+";");else{var n=Jd(s,t,a);switch(o){case"animation":case"animationName":{r+=Yg(o)+":"+n+";";break}default:r+=o+"{"+n+"}"}}}return r}var T2=/label:\s*([^\s;{]+)\s*(;|$)/g,xr;function sf(s,t,i){if(s.length===1&&typeof s[0]=="object"&&s[0]!==null&&s[0].styles!==void 0)return s[0];var r=!0,e="";xr=void 0;var o=s[0];if(o==null||o.raw===void 0)r=!1,e+=Jd(i,t,o);else{var a=o;e+=a[0]}for(var l=1;l<s.length;l++)if(e+=Jd(i,t,s[l]),r){var f=o;e+=f[l]}T2.lastIndex=0;for(var n="",c;(c=T2.exec(e))!==null;)n+="-"+c[1];var d=AO(e)+n;return{name:d,styles:e,next:xr}}var CO=function(t){return t()},E8=Vm.useInsertionEffect?Vm.useInsertionEffect:!1,O8=E8||CO,I2=E8||et.useLayoutEffect,A8=et.createContext(typeof HTMLElement<"u"?TO({key:"css"}):null);A8.Provider;var Db=function(t){return et.forwardRef(function(i,r){var e=et.useContext(A8);return t(i,e,r)})},of=et.createContext({}),Bb={}.hasOwnProperty,zm="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",DO=function(t,i){var r={};for(var e in i)Bb.call(i,e)&&(r[e]=i[e]);return r[zm]=t,r},BO=function(t){var i=t.cache,r=t.serialized,e=t.isStringTag;return Nb(i,r,e),O8(function(){return Cb(i,r,e)}),null},FO=Db(function(s,t,i){var r=s.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var e=s[zm],o=[r],a="";typeof s.className=="string"?a=I8(t.registered,o,s.className):s.className!=null&&(a=s.className+" ");var l=sf(o,void 0,et.useContext(of));a+=t.key+"-"+l.name;var f={};for(var n in s)Bb.call(s,n)&&n!=="css"&&n!==zm&&(f[n]=s[n]);return f.className=a,i&&(f.ref=i),et.createElement(et.Fragment,null,et.createElement(BO,{cache:t,serialized:l,isStringTag:typeof e=="string"}),et.createElement(e,f))}),LO=FO,k2=function(t,i){var r=arguments;if(i==null||!Bb.call(i,"css"))return et.createElement.apply(void 0,r);var e=r.length,o=new Array(e);o[0]=LO,o[1]=DO(t,i);for(var a=2;a<e;a++)o[a]=r[a];return et.createElement.apply(null,o)};(function(s){var t;t||(t=s.JSX||(s.JSX={}))})(k2||(k2={}));var UO=Db(function(s,t){var i=s.styles,r=sf([i],void 0,et.useContext(of)),e=et.useRef();return I2(function(){var o=t.key+"-global",a=new t.sheet.constructor({key:o,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),l=!1,f=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return t.sheet.tags.length&&(a.before=t.sheet.tags[0]),f!==null&&(l=!0,f.setAttribute("data-emotion",o),a.hydrate([f])),e.current=[a,l],function(){a.flush()}},[t]),I2(function(){var o=e.current,a=o[0],l=o[1];if(l){o[1]=!1;return}if(r.next!==void 0&&Cb(t,r.next,!0),a.tags.length){var f=a.tags[a.tags.length-1].nextElementSibling;a.before=f,a.flush()}t.insert("",r,a,!1)},[t,r.name]),null});function Fb(){for(var s=arguments.length,t=new Array(s),i=0;i<s;i++)t[i]=arguments[i];return sf(t)}function cf(){var s=Fb.apply(void 0,arguments),t="animation-"+s.name;return{name:t,styles:"@keyframes "+t+"{"+s.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var qO=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,jO=S8(function(s){return qO.test(s)||s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)<91}),HO=jO,KO=function(t){return t!=="theme"},E2=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?HO:KO},O2=function(t,i,r){var e;if(i){var o=i.shouldForwardProp;e=t.__emotion_forwardProp&&o?function(a){return t.__emotion_forwardProp(a)&&o(a)}:o}return typeof e!="function"&&r&&(e=t.__emotion_forwardProp),e},VO=function(t){var i=t.cache,r=t.serialized,e=t.isStringTag;return Nb(i,r,e),O8(function(){return Cb(i,r,e)}),null},WO=function s(t,i){var r=t.__emotion_real===t,e=r&&t.__emotion_base||t,o,a;i!==void 0&&(o=i.label,a=i.target);var l=O2(t,i,r),f=l||E2(e),n=!f("as");return function(){var c=arguments,d=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(o!==void 0&&d.push("label:"+o+";"),c[0]==null||c[0].raw===void 0)d.push.apply(d,c);else{var y=c[0];d.push(y[0]);for(var p=c.length,g=1;g<p;g++)d.push(c[g],y[g])}var b=Db(function(w,v,_){var S=n&&w.as||e,T="",I=[],k=w;if(w.theme==null){k={};for(var O in w)k[O]=w[O];k.theme=et.useContext(of)}typeof w.className=="string"?T=I8(v.registered,I,w.className):w.className!=null&&(T=w.className+" ");var A=sf(d.concat(I),v.registered,k);T+=v.key+"-"+A.name,a!==void 0&&(T+=" "+a);var R=n&&l===void 0?E2(S):f,P={};for(var C in w)n&&C==="as"||R(C)&&(P[C]=w[C]);return P.className=T,_&&(P.ref=_),et.createElement(et.Fragment,null,et.createElement(VO,{cache:v,serialized:A,isStringTag:typeof S=="string"}),et.createElement(S,P))});return b.displayName=o!==void 0?o:"Styled("+(typeof e=="string"?e:e.displayName||e.name||"Component")+")",b.defaultProps=t.defaultProps,b.__emotion_real=b,b.__emotion_base=e,b.__emotion_styles=d,b.__emotion_forwardProp=l,Object.defineProperty(b,"toString",{value:function(){return"."+a}}),b.withComponent=function(w,v){var _=s(w,Mp({},i,v,{shouldForwardProp:O2(b,v,!0)}));return _.apply(void 0,d)},b}},$O=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Xm=WO.bind(null);$O.forEach(function(s){Xm[s]=Xm(s)});function zO(s){return s==null||Object.keys(s).length===0}function P8(s){const{styles:t,defaultTheme:i={}}=s,r=typeof t=="function"?e=>t(zO(e)?i:e):t;return it.jsx(UO,{styles:r})}function R8(s,t){return Xm(s,t)}function XO(s,t){Array.isArray(s.__emotion_styles)&&(s.__emotion_styles=t(s.__emotion_styles))}const A2=[];function P2(s){return A2[0]=s,sf(A2)}var Qg={exports:{}},qe={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2;function GO(){if(R2)return qe;R2=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),e=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),n=Symbol.for("react.suspense_list"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),y=Symbol.for("react.view_transition"),p=Symbol.for("react.client.reference");function g(b){if(typeof b=="object"&&b!==null){var w=b.$$typeof;switch(w){case s:switch(b=b.type,b){case i:case e:case r:case f:case n:case y:return b;default:switch(b=b&&b.$$typeof,b){case a:case l:case d:case c:return b;case o:return b;default:return w}}case t:return w}}}return qe.ContextConsumer=o,qe.ContextProvider=a,qe.Element=s,qe.ForwardRef=l,qe.Fragment=i,qe.Lazy=d,qe.Memo=c,qe.Portal=t,qe.Profiler=e,qe.StrictMode=r,qe.Suspense=f,qe.SuspenseList=n,qe.isContextConsumer=function(b){return g(b)===o},qe.isContextProvider=function(b){return g(b)===a},qe.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===s},qe.isForwardRef=function(b){return g(b)===l},qe.isFragment=function(b){return g(b)===i},qe.isLazy=function(b){return g(b)===d},qe.isMemo=function(b){return g(b)===c},qe.isPortal=function(b){return g(b)===t},qe.isProfiler=function(b){return g(b)===e},qe.isStrictMode=function(b){return g(b)===r},qe.isSuspense=function(b){return g(b)===f},qe.isSuspenseList=function(b){return g(b)===n},qe.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===i||b===e||b===r||b===f||b===n||typeof b=="object"&&b!==null&&(b.$$typeof===d||b.$$typeof===c||b.$$typeof===a||b.$$typeof===o||b.$$typeof===l||b.$$typeof===p||b.getModuleId!==void 0)},qe.typeOf=g,qe}var M2;function YO(){return M2||(M2=1,Qg.exports=GO()),Qg.exports}var M8=YO();function _r(s){if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)}function N8(s){if(et.isValidElement(s)||M8.isValidElementType(s)||!_r(s))return s;const t={};return Object.keys(s).forEach(i=>{t[i]=N8(s[i])}),t}function qi(s,t,i={clone:!0}){const r=i.clone?{...s}:s;return _r(s)&&_r(t)&&Object.keys(t).forEach(e=>{et.isValidElement(t[e])||M8.isValidElementType(t[e])?r[e]=t[e]:_r(t[e])&&Object.prototype.hasOwnProperty.call(s,e)&&_r(s[e])?r[e]=qi(s[e],t[e],i):i.clone?r[e]=_r(t[e])?N8(t[e]):t[e]:r[e]=t[e]}),r}const QO=s=>{const t=Object.keys(s).map(i=>({key:i,val:s[i]}))||[];return t.sort((i,r)=>i.val-r.val),t.reduce((i,r)=>({...i,[r.key]:r.val}),{})};function ZO(s){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:r=5,...e}=s,o=QO(t),a=Object.keys(o);function l(y){return`@media (min-width:${typeof t[y]=="number"?t[y]:y}${i})`}function f(y){return`@media (max-width:${(typeof t[y]=="number"?t[y]:y)-r/100}${i})`}function n(y,p){const g=a.indexOf(p);return`@media (min-width:${typeof t[y]=="number"?t[y]:y}${i}) and (max-width:${(g!==-1&&typeof t[a[g]]=="number"?t[a[g]]:p)-r/100}${i})`}function c(y){return a.indexOf(y)+1<a.length?n(y,a[a.indexOf(y)+1]):l(y)}function d(y){const p=a.indexOf(y);return p===0?l(a[1]):p===a.length-1?f(a[p]):n(y,a[a.indexOf(y)+1]).replace("@media","@media not all and")}return{keys:a,values:o,up:l,down:f,between:n,only:c,not:d,unit:i,...e}}function JO(s,t){if(!s.containerQueries)return t;const i=Object.keys(t).filter(r=>r.startsWith("@container")).sort((r,e)=>{var a,l;const o=/min-width:\s*([0-9.]+)/;return+(((a=r.match(o))==null?void 0:a[1])||0)-+(((l=e.match(o))==null?void 0:l[1])||0)});return i.length?i.reduce((r,e)=>{const o=t[e];return delete r[e],r[e]=o,r},{...t}):t}function tA(s,t){return t==="@"||t.startsWith("@")&&(s.some(i=>t.startsWith(`@${i}`))||!!t.match(/^@\d/))}function eA(s,t){const i=t.match(/^@([^/]+)?\/?(.+)?$/);if(!i)return null;const[,r,e]=i,o=Number.isNaN(+r)?r||0:+r;return s.containerQueries(e).up(o)}function iA(s){const t=(o,a)=>o.replace("@media",a?`@container ${a}`:"@container");function i(o,a){o.up=(...l)=>t(s.breakpoints.up(...l),a),o.down=(...l)=>t(s.breakpoints.down(...l),a),o.between=(...l)=>t(s.breakpoints.between(...l),a),o.only=(...l)=>t(s.breakpoints.only(...l),a),o.not=(...l)=>{const f=t(s.breakpoints.not(...l),a);return f.includes("not all and")?f.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):f}}const r={},e=o=>(i(r,o),r);return i(e),{...s,containerQueries:e}}const nA={borderRadius:4};function $d(s,t){return t?qi(s,t,{clone:!1}):s}const t0={xs:0,sm:600,md:900,lg:1200,xl:1536},N2={keys:["xs","sm","md","lg","xl"],up:s=>`@media (min-width:${t0[s]}px)`},rA={containerQueries:s=>({up:t=>{let i=typeof t=="number"?t:t0[t]||t;return typeof i=="number"&&(i=`${i}px`),s?`@container ${s} (min-width:${i})`:`@container (min-width:${i})`}})};function ur(s,t,i){const r=s.theme||{};if(Array.isArray(t)){const o=r.breakpoints||N2;return t.reduce((a,l,f)=>(a[o.up(o.keys[f])]=i(t[f]),a),{})}if(typeof t=="object"){const o=r.breakpoints||N2;return Object.keys(t).reduce((a,l)=>{if(tA(o.keys,l)){const f=eA(r.containerQueries?r:rA,l);f&&(a[f]=i(t[l],l))}else if(Object.keys(o.values||t0).includes(l)){const f=o.up(l);a[f]=i(t[l],l)}else{const f=l;a[f]=t[f]}return a},{})}return i(t)}function C8(s={}){var i;return((i=s.keys)==null?void 0:i.reduce((r,e)=>{const o=s.up(e);return r[o]={},r},{}))||{}}function D8(s,t){return s.reduce((i,r)=>{const e=i[r];return(!e||Object.keys(e).length===0)&&delete i[r],i},t)}function aA(s,...t){const i=C8(s),r=[i,...t].reduce((e,o)=>qi(e,o),{});return D8(Object.keys(i),r)}function sA(s,t){if(typeof s!="object")return{};const i={},r=Object.keys(t);return Array.isArray(s)?r.forEach((e,o)=>{o<s.length&&(i[e]=!0)}):r.forEach(e=>{s[e]!=null&&(i[e]=!0)}),i}function Zg({values:s,breakpoints:t,base:i}){const r=i||sA(s,t),e=Object.keys(r);if(e.length===0)return s;let o;return e.reduce((a,l,f)=>(Array.isArray(s)?(a[l]=s[f]!=null?s[f]:s[o],o=f):typeof s=="object"?(a[l]=s[l]!=null?s[l]:s[o],o=l):a[l]=s,a),{})}function zt(s){if(typeof s!="string")throw new Error(ss(7));return s.charAt(0).toUpperCase()+s.slice(1)}function e0(s,t,i=!0){if(!t||typeof t!="string")return null;if(s&&s.vars&&i){const r=`vars.${t}`.split(".").reduce((e,o)=>e&&e[o]?e[o]:null,s);if(r!=null)return r}return t.split(".").reduce((r,e)=>r&&r[e]!=null?r[e]:null,s)}function Cp(s,t,i,r=i){let e;return typeof s=="function"?e=s(i):Array.isArray(s)?e=s[i]||r:e=e0(s,i)||r,t&&(e=t(e,r,s)),e}function oi(s){const{prop:t,cssProperty:i=s.prop,themeKey:r,transform:e}=s,o=a=>{if(a[t]==null)return null;const l=a[t],f=a.theme,n=e0(f,r)||{};return ur(a,l,d=>{let y=Cp(n,e,d);return d===y&&typeof d=="string"&&(y=Cp(n,e,`${t}${d==="default"?"":zt(d)}`,d)),i===!1?y:{[i]:y}})};return o.propTypes={},o.filterProps=[t],o}function oA(s){const t={};return i=>(t[i]===void 0&&(t[i]=s(i)),t[i])}const cA={m:"margin",p:"padding"},uA={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},C2={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},lA=oA(s=>{if(s.length>2)if(C2[s])s=C2[s];else return[s];const[t,i]=s.split(""),r=cA[t],e=uA[i]||"";return Array.isArray(e)?e.map(o=>r+o):[r+e]}),Lb=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Ub=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Lb,...Ub];function uf(s,t,i,r){const e=e0(s,t,!0)??i;return typeof e=="number"||typeof e=="string"?o=>typeof o=="string"?o:typeof e=="string"?e.startsWith("var(")&&o===0?0:e.startsWith("var(")&&o===1?e:`calc(${o} * ${e})`:e*o:Array.isArray(e)?o=>{if(typeof o=="string")return o;const a=Math.abs(o),l=e[a];return o>=0?l:typeof l=="number"?-l:typeof l=="string"&&l.startsWith("var(")?`calc(-1 * ${l})`:`-${l}`}:typeof e=="function"?e:()=>{}}function i0(s){return uf(s,"spacing",8)}function So(s,t){return typeof t=="string"||t==null?t:s(t)}function dA(s,t){return i=>s.reduce((r,e)=>(r[e]=So(t,i),r),{})}function fA(s,t,i,r){if(!t.includes(i))return null;const e=lA(i),o=dA(e,r),a=s[i];return ur(s,a,o)}function B8(s,t){const i=i0(s.theme);return Object.keys(s).map(r=>fA(s,t,r,i)).reduce($d,{})}function ti(s){return B8(s,Lb)}ti.propTypes={};ti.filterProps=Lb;function ei(s){return B8(s,Ub)}ei.propTypes={};ei.filterProps=Ub;function F8(s=8,t=i0({spacing:s})){if(s.mui)return s;const i=(...r)=>(r.length===0?[1]:r).map(o=>{const a=t(o);return typeof a=="number"?`${a}px`:a}).join(" ");return i.mui=!0,i}function n0(...s){const t=s.reduce((r,e)=>(e.filterProps.forEach(o=>{r[o]=e}),r),{}),i=r=>Object.keys(r).reduce((e,o)=>t[o]?$d(e,t[o](r)):e,{});return i.propTypes={},i.filterProps=s.reduce((r,e)=>r.concat(e.filterProps),[]),i}function Ln(s){return typeof s!="number"?s:`${s}px solid`}function Wn(s,t){return oi({prop:s,themeKey:"borders",transform:t})}const hA=Wn("border",Ln),pA=Wn("borderTop",Ln),yA=Wn("borderRight",Ln),gA=Wn("borderBottom",Ln),mA=Wn("borderLeft",Ln),bA=Wn("borderColor"),wA=Wn("borderTopColor"),vA=Wn("borderRightColor"),xA=Wn("borderBottomColor"),_A=Wn("borderLeftColor"),SA=Wn("outline",Ln),TA=Wn("outlineColor"),r0=s=>{if(s.borderRadius!==void 0&&s.borderRadius!==null){const t=uf(s.theme,"shape.borderRadius",4),i=r=>({borderRadius:So(t,r)});return ur(s,s.borderRadius,i)}return null};r0.propTypes={};r0.filterProps=["borderRadius"];n0(hA,pA,yA,gA,mA,bA,wA,vA,xA,_A,r0,SA,TA);const a0=s=>{if(s.gap!==void 0&&s.gap!==null){const t=uf(s.theme,"spacing",8),i=r=>({gap:So(t,r)});return ur(s,s.gap,i)}return null};a0.propTypes={};a0.filterProps=["gap"];const s0=s=>{if(s.columnGap!==void 0&&s.columnGap!==null){const t=uf(s.theme,"spacing",8),i=r=>({columnGap:So(t,r)});return ur(s,s.columnGap,i)}return null};s0.propTypes={};s0.filterProps=["columnGap"];const o0=s=>{if(s.rowGap!==void 0&&s.rowGap!==null){const t=uf(s.theme,"spacing",8),i=r=>({rowGap:So(t,r)});return ur(s,s.rowGap,i)}return null};o0.propTypes={};o0.filterProps=["rowGap"];const IA=oi({prop:"gridColumn"}),kA=oi({prop:"gridRow"}),EA=oi({prop:"gridAutoFlow"}),OA=oi({prop:"gridAutoColumns"}),AA=oi({prop:"gridAutoRows"}),PA=oi({prop:"gridTemplateColumns"}),RA=oi({prop:"gridTemplateRows"}),MA=oi({prop:"gridTemplateAreas"}),NA=oi({prop:"gridArea"});n0(a0,s0,o0,IA,kA,EA,OA,AA,PA,RA,MA,NA);function tu(s,t){return t==="grey"?t:s}const CA=oi({prop:"color",themeKey:"palette",transform:tu}),DA=oi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:tu}),BA=oi({prop:"backgroundColor",themeKey:"palette",transform:tu});n0(CA,DA,BA);function hn(s){return s<=1&&s!==0?`${s*100}%`:s}const FA=oi({prop:"width",transform:hn}),qb=s=>{if(s.maxWidth!==void 0&&s.maxWidth!==null){const t=i=>{var e,o,a,l,f;const r=((a=(o=(e=s.theme)==null?void 0:e.breakpoints)==null?void 0:o.values)==null?void 0:a[i])||t0[i];return r?((f=(l=s.theme)==null?void 0:l.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${r}${s.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:hn(i)}};return ur(s,s.maxWidth,t)}return null};qb.filterProps=["maxWidth"];const LA=oi({prop:"minWidth",transform:hn}),UA=oi({prop:"height",transform:hn}),qA=oi({prop:"maxHeight",transform:hn}),jA=oi({prop:"minHeight",transform:hn});oi({prop:"size",cssProperty:"width",transform:hn});oi({prop:"size",cssProperty:"height",transform:hn});const HA=oi({prop:"boxSizing"});n0(FA,qb,LA,UA,qA,jA,HA);const lf={border:{themeKey:"borders",transform:Ln},borderTop:{themeKey:"borders",transform:Ln},borderRight:{themeKey:"borders",transform:Ln},borderBottom:{themeKey:"borders",transform:Ln},borderLeft:{themeKey:"borders",transform:Ln},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ln},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:r0},color:{themeKey:"palette",transform:tu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:tu},backgroundColor:{themeKey:"palette",transform:tu},p:{style:ei},pt:{style:ei},pr:{style:ei},pb:{style:ei},pl:{style:ei},px:{style:ei},py:{style:ei},padding:{style:ei},paddingTop:{style:ei},paddingRight:{style:ei},paddingBottom:{style:ei},paddingLeft:{style:ei},paddingX:{style:ei},paddingY:{style:ei},paddingInline:{style:ei},paddingInlineStart:{style:ei},paddingInlineEnd:{style:ei},paddingBlock:{style:ei},paddingBlockStart:{style:ei},paddingBlockEnd:{style:ei},m:{style:ti},mt:{style:ti},mr:{style:ti},mb:{style:ti},ml:{style:ti},mx:{style:ti},my:{style:ti},margin:{style:ti},marginTop:{style:ti},marginRight:{style:ti},marginBottom:{style:ti},marginLeft:{style:ti},marginX:{style:ti},marginY:{style:ti},marginInline:{style:ti},marginInlineStart:{style:ti},marginInlineEnd:{style:ti},marginBlock:{style:ti},marginBlockStart:{style:ti},marginBlockEnd:{style:ti},displayPrint:{cssProperty:!1,transform:s=>({"@media print":{display:s}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:a0},rowGap:{style:o0},columnGap:{style:s0},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:hn},maxWidth:{style:qb},minWidth:{transform:hn},height:{transform:hn},maxHeight:{transform:hn},minHeight:{transform:hn},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function KA(...s){const t=s.reduce((r,e)=>r.concat(Object.keys(e)),[]),i=new Set(t);return s.every(r=>i.size===Object.keys(r).length)}function VA(s,t){return typeof s=="function"?s(t):s}function WA(){function s(i,r,e,o){const a={[i]:r,theme:e},l=o[i];if(!l)return{[i]:r};const{cssProperty:f=i,themeKey:n,transform:c,style:d}=l;if(r==null)return null;if(n==="typography"&&r==="inherit")return{[i]:r};const y=e0(e,n)||{};return d?d(a):ur(a,r,g=>{let b=Cp(y,c,g);return g===b&&typeof g=="string"&&(b=Cp(y,c,`${i}${g==="default"?"":zt(g)}`,g)),f===!1?b:{[f]:b}})}function t(i){const{sx:r,theme:e={}}=i||{};if(!r)return null;const o=e.unstable_sxConfig??lf;function a(l){let f=l;if(typeof l=="function")f=l(e);else if(typeof l!="object")return l;if(!f)return null;const n=C8(e.breakpoints),c=Object.keys(n);let d=n;return Object.keys(f).forEach(y=>{const p=VA(f[y],e);if(p!=null)if(typeof p=="object")if(o[y])d=$d(d,s(y,p,e,o));else{const g=ur({theme:e},p,b=>({[y]:b}));KA(g,p)?d[y]=t({sx:p,theme:e}):d=$d(d,g)}else d=$d(d,s(y,p,e,o))}),JO(e,D8(c,d))}return Array.isArray(r)?r.map(a):a(r)}return t}const os=WA();os.filterProps=["sx"];function $A(s,t){var r;const i=this;if(i.vars){if(!((r=i.colorSchemes)!=null&&r[s])||typeof i.getColorSchemeSelector!="function")return{};let e=i.getColorSchemeSelector(s);return e==="&"?t:((e.includes("data-")||e.includes("."))&&(e=`*:where(${e.replace(/\s*&$/,"")}) &`),{[e]:t})}return i.palette.mode===s?t:{}}function df(s={},...t){const{breakpoints:i={},palette:r={},spacing:e,shape:o={},...a}=s,l=ZO(i),f=F8(e);let n=qi({breakpoints:l,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:f,shape:{...nA,...o}},a);return n=iA(n),n.applyStyles=$A,n=t.reduce((c,d)=>qi(c,d),n),n.unstable_sxConfig={...lf,...a==null?void 0:a.unstable_sxConfig},n.unstable_sx=function(d){return os({sx:d,theme:this})},n}function zA(s){return Object.keys(s).length===0}function L8(s=null){const t=et.useContext(of);return!t||zA(t)?s:t}const XA=df();function c0(s=XA){return L8(s)}function GA({styles:s,themeId:t,defaultTheme:i={}}){const r=c0(i),e=typeof s=="function"?s(t&&r[t]||r):s;return it.jsx(P8,{styles:e})}const YA=s=>{var r;const t={systemProps:{},otherProps:{}},i=((r=s==null?void 0:s.theme)==null?void 0:r.unstable_sxConfig)??lf;return Object.keys(s).forEach(e=>{i[e]?t.systemProps[e]=s[e]:t.otherProps[e]=s[e]}),t};function jb(s){const{sx:t,...i}=s,{systemProps:r,otherProps:e}=YA(i);let o;return Array.isArray(t)?o=[r,...t]:typeof t=="function"?o=(...a)=>{const l=t(...a);return _r(l)?{...r,...l}:r}:o={...r,...t},{...e,sx:o}}const D2=s=>s,QA=()=>{let s=D2;return{configure(t){s=t},generate(t){return s(t)},reset(){s=D2}}},U8=QA();function q8(s){var t,i,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var e=s.length;for(t=0;t<e;t++)s[t]&&(i=q8(s[t]))&&(r&&(r+=" "),r+=i)}else for(i in s)s[i]&&(r&&(r+=" "),r+=i);return r}function de(){for(var s,t,i=0,r="",e=arguments.length;i<e;i++)(s=arguments[i])&&(t=q8(s))&&(r&&(r+=" "),r+=t);return r}function ZA(s={}){const{themeId:t,defaultTheme:i,defaultClassName:r="MuiBox-root",generateClassName:e}=s,o=R8("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(os);return et.forwardRef(function(f,n){const c=c0(i),{className:d,component:y="div",...p}=jb(f);return it.jsx(o,{as:y,ref:n,className:de(d,e?e(r):r),theme:t&&c[t]||c,...p})})}const JA={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function yi(s,t,i="Mui"){const r=JA[t];return r?`${i}-${r}`:`${U8.generate(s)}-${t}`}function xi(s,t,i="Mui"){const r={};return t.forEach(e=>{r[e]=yi(s,e,i)}),r}function j8(s){const{variants:t,...i}=s,r={variants:t,style:P2(i),isProcessed:!0};return r.style===i||t&&t.forEach(e=>{typeof e.style!="function"&&(e.style=P2(e.style))}),r}const tP=df();function Jg(s){return s!=="ownerState"&&s!=="theme"&&s!=="sx"&&s!=="as"}function eP(s){return s?(t,i)=>i[s]:null}function iP(s,t,i){s.theme=rP(s.theme)?i:s.theme[t]||s.theme}function kp(s,t){const i=typeof t=="function"?t(s):t;if(Array.isArray(i))return i.flatMap(r=>kp(s,r));if(Array.isArray(i==null?void 0:i.variants)){let r;if(i.isProcessed)r=i.style;else{const{variants:e,...o}=i;r=o}return H8(s,i.variants,[r])}return i!=null&&i.isProcessed?i.style:i}function H8(s,t,i=[]){var e;let r;t:for(let o=0;o<t.length;o+=1){const a=t[o];if(typeof a.props=="function"){if(r??(r={...s,...s.ownerState,ownerState:s.ownerState}),!a.props(r))continue}else for(const l in a.props)if(s[l]!==a.props[l]&&((e=s.ownerState)==null?void 0:e[l])!==a.props[l])continue t;typeof a.style=="function"?(r??(r={...s,...s.ownerState,ownerState:s.ownerState}),i.push(a.style(r))):i.push(a.style)}return i}function K8(s={}){const{themeId:t,defaultTheme:i=tP,rootShouldForwardProp:r=Jg,slotShouldForwardProp:e=Jg}=s;function o(l){iP(l,t,i)}return(l,f={})=>{XO(l,I=>I.filter(k=>k!==os));const{name:n,slot:c,skipVariantsResolver:d,skipSx:y,overridesResolver:p=eP(sP(c)),...g}=f,b=d!==void 0?d:c&&c!=="Root"&&c!=="root"||!1,w=y||!1;let v=Jg;c==="Root"||c==="root"?v=r:c?v=e:aP(l)&&(v=void 0);const _=R8(l,{shouldForwardProp:v,label:nP(),...g}),S=I=>{if(typeof I=="function"&&I.__emotion_real!==I)return function(O){return kp(O,I)};if(_r(I)){const k=j8(I);return k.variants?function(A){return kp(A,k)}:k.style}return I},T=(...I)=>{const k=[],O=I.map(S),A=[];if(k.push(o),n&&p&&A.push(function(N){var L,j;const U=(j=(L=N.theme.components)==null?void 0:L[n])==null?void 0:j.styleOverrides;if(!U)return null;const F={};for(const V in U)F[V]=kp(N,U[V]);return p(N,F)}),n&&!b&&A.push(function(N){var F,L;const D=N.theme,U=(L=(F=D==null?void 0:D.components)==null?void 0:F[n])==null?void 0:L.variants;return U?H8(N,U):null}),w||A.push(os),Array.isArray(O[0])){const C=O.shift(),N=new Array(k.length).fill(""),D=new Array(A.length).fill("");let U;U=[...N,...C,...D],U.raw=[...N,...C.raw,...D],k.unshift(U)}const R=[...k,...O,...A],P=_(...R);return l.muiName&&(P.muiName=l.muiName),P};return _.withConfig&&(T.withConfig=_.withConfig),T}}function nP(s,t){return void 0}function rP(s){for(const t in s)return!1;return!0}function aP(s){return typeof s=="string"&&s.charCodeAt(0)>96}function sP(s){return s&&s.charAt(0).toLowerCase()+s.slice(1)}const V8=K8();function Dp(s,t){const i={...t};for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)){const e=r;if(e==="components"||e==="slots")i[e]={...s[e],...i[e]};else if(e==="componentsProps"||e==="slotProps"){const o=s[e],a=t[e];if(!a)i[e]=o||{};else if(!o)i[e]=a;else{i[e]={...a};for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const f=l;i[e][f]=Dp(o[f],a[f])}}}else i[e]===void 0&&(i[e]=s[e])}return i}function oP(s){const{theme:t,name:i,props:r}=s;return!t||!t.components||!t.components[i]||!t.components[i].defaultProps?r:Dp(t.components[i].defaultProps,r)}function W8({props:s,name:t,defaultTheme:i,themeId:r}){let e=c0(i);return r&&(e=e[r]||e),oP({theme:e,name:t,props:s})}const au=typeof window<"u"?et.useLayoutEffect:et.useEffect;function cP(s,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(s,i))}function Hb(s,t=0,i=1){return cP(s,t,i)}function uP(s){s=s.slice(1);const t=new RegExp(`.{1,${s.length>=6?2:1}}`,"g");let i=s.match(t);return i&&i[0].length===1&&(i=i.map(r=>r+r)),i?`rgb${i.length===4?"a":""}(${i.map((r,e)=>e<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function cs(s){if(s.type)return s;if(s.charAt(0)==="#")return cs(uP(s));const t=s.indexOf("("),i=s.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw new Error(ss(9,s));let r=s.substring(t+1,s.length-1),e;if(i==="color"){if(r=r.split(" "),e=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(e))throw new Error(ss(10,e))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:i,values:r,colorSpace:e}}const lP=s=>{const t=cs(s);return t.values.slice(0,3).map((i,r)=>t.type.includes("hsl")&&r!==0?`${i}%`:i).join(" ")},Bd=(s,t)=>{try{return lP(s)}catch{return s}};function u0(s){const{type:t,colorSpace:i}=s;let{values:r}=s;return t.includes("rgb")?r=r.map((e,o)=>o<3?parseInt(e,10):e):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),t.includes("color")?r=`${i} ${r.join(" ")}`:r=`${r.join(", ")}`,`${t}(${r})`}function $8(s){s=cs(s);const{values:t}=s,i=t[0],r=t[1]/100,e=t[2]/100,o=r*Math.min(e,1-e),a=(n,c=(n+i/30)%12)=>e-o*Math.max(Math.min(c-3,9-c,1),-1);let l="rgb";const f=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return s.type==="hsla"&&(l+="a",f.push(t[3])),u0({type:l,values:f})}function Gm(s){s=cs(s);let t=s.type==="hsl"||s.type==="hsla"?cs($8(s)).values:s.values;return t=t.map(i=>(s.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function dP(s,t){const i=Gm(s),r=Gm(t);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)}function Pi(s,t){return s=cs(s),t=Hb(t),(s.type==="rgb"||s.type==="hsl")&&(s.type+="a"),s.type==="color"?s.values[3]=`/${t}`:s.values[3]=t,u0(s)}function Nh(s,t,i){try{return Pi(s,t)}catch{return s}}function Kb(s,t){if(s=cs(s),t=Hb(t),s.type.includes("hsl"))s.values[2]*=1-t;else if(s.type.includes("rgb")||s.type.includes("color"))for(let i=0;i<3;i+=1)s.values[i]*=1-t;return u0(s)}function He(s,t,i){try{return Kb(s,t)}catch{return s}}function Vb(s,t){if(s=cs(s),t=Hb(t),s.type.includes("hsl"))s.values[2]+=(100-s.values[2])*t;else if(s.type.includes("rgb"))for(let i=0;i<3;i+=1)s.values[i]+=(255-s.values[i])*t;else if(s.type.includes("color"))for(let i=0;i<3;i+=1)s.values[i]+=(1-s.values[i])*t;return u0(s)}function Ke(s,t,i){try{return Vb(s,t)}catch{return s}}function fP(s,t=.15){return Gm(s)>.5?Kb(s,t):Vb(s,t)}function Ch(s,t,i){try{return fP(s,t)}catch{return s}}function B2(...s){return s.reduce((t,i)=>i==null?t:function(...e){t.apply(this,e),i.apply(this,e)},()=>{})}function hP(s,t=166){let i;function r(...e){const o=()=>{s.apply(this,e)};clearTimeout(i),i=setTimeout(o,t)}return r.clear=()=>{clearTimeout(i)},r}function Sa(s){return s&&s.ownerDocument||document}function su(s){return Sa(s).defaultView||window}function F2(s,t){typeof s=="function"?s(t):s&&(s.current=t)}let L2=0;function pP(s){const[t,i]=et.useState(s),r=s||t;return et.useEffect(()=>{t==null&&(L2+=1,i(`mui-${L2}`))},[t]),r}const yP={...Vm},U2=yP.useId;function z8(s){if(U2!==void 0){const t=U2();return s??t}return pP(s)}function gP({controlled:s,default:t,name:i,state:r="value"}){const{current:e}=et.useRef(s!==void 0),[o,a]=et.useState(t),l=e?s:o,f=et.useCallback(n=>{e||a(n)},[]);return[l,f]}function as(s){const t=et.useRef(s);return au(()=>{t.current=s}),et.useRef((...i)=>(0,t.current)(...i)).current}function Zi(...s){const t=et.useRef(void 0),i=et.useCallback(r=>{const e=s.map(o=>{if(o==null)return null;if(typeof o=="function"){const a=o,l=a(r);return typeof l=="function"?l:()=>{a(null)}}return o.current=r,()=>{o.current=null}});return()=>{e.forEach(o=>o==null?void 0:o())}},s);return et.useMemo(()=>s.every(r=>r==null)?null:r=>{t.current&&(t.current(),t.current=void 0),r!=null&&(t.current=i(r))},s)}const q2={};function X8(s,t){const i=et.useRef(q2);return i.current===q2&&(i.current=s(t)),i}const mP=[];function bP(s){et.useEffect(s,mP)}class l0{constructor(){rt(this,"currentId",null);rt(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});rt(this,"disposeEffect",()=>this.clear)}static create(){return new l0}start(t,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,i()},t)}}function Qc(){const s=X8(l0.create).current;return bP(s.disposeEffect),s}function Bp(s){try{return s.matches(":focus-visible")}catch{}return!1}function wP(s=window){const t=s.document.documentElement.clientWidth;return s.innerWidth-t}function _i(s,t,i=void 0){const r={};for(const e in s){const o=s[e];let a="",l=!0;for(let f=0;f<o.length;f+=1){const n=o[f];n&&(a+=(l===!0?"":" ")+t(n),l=!1,i&&i[n]&&(a+=" "+i[n]))}r[e]=a}return r}function vP(s){return typeof s=="string"}function G8(s,t,i){return s===void 0||vP(s)?t:{...t,ownerState:{...t.ownerState,...i}}}function Y8(s,t=[]){if(s===void 0)return{};const i={};return Object.keys(s).filter(r=>r.match(/^on[A-Z]/)&&typeof s[r]=="function"&&!t.includes(r)).forEach(r=>{i[r]=s[r]}),i}function j2(s){if(s===void 0)return{};const t={};return Object.keys(s).filter(i=>!(i.match(/^on[A-Z]/)&&typeof s[i]=="function")).forEach(i=>{t[i]=s[i]}),t}function Q8(s){const{getSlotProps:t,additionalProps:i,externalSlotProps:r,externalForwardedProps:e,className:o}=s;if(!t){const p=de(i==null?void 0:i.className,o,e==null?void 0:e.className,r==null?void 0:r.className),g={...i==null?void 0:i.style,...e==null?void 0:e.style,...r==null?void 0:r.style},b={...i,...e,...r};return p.length>0&&(b.className=p),Object.keys(g).length>0&&(b.style=g),{props:b,internalRef:void 0}}const a=Y8({...e,...r}),l=j2(r),f=j2(e),n=t(a),c=de(n==null?void 0:n.className,i==null?void 0:i.className,o,e==null?void 0:e.className,r==null?void 0:r.className),d={...n==null?void 0:n.style,...i==null?void 0:i.style,...e==null?void 0:e.style,...r==null?void 0:r.style},y={...n,...i,...f,...l};return c.length>0&&(y.className=c),Object.keys(d).length>0&&(y.style=d),{props:y,internalRef:n.ref}}function Z8(s,t,i){return typeof s=="function"?s(t,i):s}function xP(s){var d;const{elementType:t,externalSlotProps:i,ownerState:r,skipResolvingSlotProps:e=!1,...o}=s,a=e?{}:Z8(i,r),{props:l,internalRef:f}=Q8({...o,externalSlotProps:a}),n=Zi(f,a==null?void 0:a.ref,(d=s.additionalProps)==null?void 0:d.ref);return G8(t,{...l,ref:n},r)}function pu(s){var t;return parseInt(et.version,10)>=19?((t=s==null?void 0:s.props)==null?void 0:t.ref)||null:(s==null?void 0:s.ref)||null}const J8=et.createContext(null);function Wb(){return et.useContext(J8)}const _P=typeof Symbol=="function"&&Symbol.for,SP=_P?Symbol.for("mui.nested"):"__THEME_NESTED__";function TP(s,t){return typeof t=="function"?t(s):{...s,...t}}function IP(s){const{children:t,theme:i}=s,r=Wb(),e=et.useMemo(()=>{const o=r===null?{...i}:TP(r,i);return o!=null&&(o[SP]=r!==null),o},[i,r]);return it.jsx(J8.Provider,{value:e,children:t})}const tT=et.createContext();function kP({value:s,...t}){return it.jsx(tT.Provider,{value:s??!0,...t})}const $b=()=>et.useContext(tT)??!1,eT=et.createContext(void 0);function EP({value:s,children:t}){return it.jsx(eT.Provider,{value:s,children:t})}function OP(s){const{theme:t,name:i,props:r}=s;if(!t||!t.components||!t.components[i])return r;const e=t.components[i];return e.defaultProps?Dp(e.defaultProps,r):!e.styleOverrides&&!e.variants?Dp(e,r):r}function AP({props:s,name:t}){const i=et.useContext(eT);return OP({props:s,name:t,theme:{components:i}})}const H2={};function K2(s,t,i,r=!1){return et.useMemo(()=>{const e=s&&t[s]||t;if(typeof i=="function"){const o=i(e),a=s?{...t,[s]:o}:o;return r?()=>a:a}return s?{...t,[s]:i}:{...t,...i}},[s,t,i,r])}function iT(s){const{children:t,theme:i,themeId:r}=s,e=L8(H2),o=Wb()||H2,a=K2(r,e,i),l=K2(r,o,i,!0),f=(r?a[r]:a).direction==="rtl";return it.jsx(IP,{theme:l,children:it.jsx(of.Provider,{value:a,children:it.jsx(kP,{value:f,children:it.jsx(EP,{value:r?a[r].components:a.components,children:t})})})})}const V2={theme:void 0};function PP(s){let t,i;return function(e){let o=t;return(o===void 0||e.theme!==i)&&(V2.theme=e.theme,o=j8(s(V2)),t=o,i=e.theme),o}}const zb="mode",Xb="color-scheme",RP="data-color-scheme";function MP(s){const{defaultMode:t="system",defaultLightColorScheme:i="light",defaultDarkColorScheme:r="dark",modeStorageKey:e=zb,colorSchemeStorageKey:o=Xb,attribute:a=RP,colorSchemeNode:l="document.documentElement",nonce:f}=s||{};let n="",c=a;if(a==="class"&&(c=".%s"),a==="data"&&(c="[data-%s]"),c.startsWith(".")){const y=c.substring(1);n+=`${l}.classList.remove('${y}'.replace('%s', light), '${y}'.replace('%s', dark));
      ${l}.classList.add('${y}'.replace('%s', colorScheme));`}const d=c.match(/\[([^\]]+)\]/);if(d){const[y,p]=d[1].split("=");p||(n+=`${l}.removeAttribute('${y}'.replace('%s', light));
      ${l}.removeAttribute('${y}'.replace('%s', dark));`),n+=`
      ${l}.setAttribute('${y}'.replace('%s', colorScheme), ${p?`${p}.replace('%s', colorScheme)`:'""'});`}else n+=`${l}.setAttribute('${c}', colorScheme);`;return it.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?f:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${e}') || '${t}';
  const dark = localStorage.getItem('${o}-dark') || '${r}';
  const light = localStorage.getItem('${o}-light') || '${i}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${n}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function NP(){}const CP=({key:s,storageWindow:t})=>(!t&&typeof window<"u"&&(t=window),{get(i){if(typeof window>"u")return;if(!t)return i;let r;try{r=t.localStorage.getItem(s)}catch{}return r||i},set:i=>{if(t)try{t.localStorage.setItem(s,i)}catch{}},subscribe:i=>{if(!t)return NP;const r=e=>{const o=e.newValue;e.key===s&&i(o)};return t.addEventListener("storage",r),()=>{t.removeEventListener("storage",r)}}});function tm(){}function W2(s){if(typeof window<"u"&&typeof window.matchMedia=="function"&&s==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function nT(s,t){if(s.mode==="light"||s.mode==="system"&&s.systemMode==="light")return t("light");if(s.mode==="dark"||s.mode==="system"&&s.systemMode==="dark")return t("dark")}function DP(s){return nT(s,t=>{if(t==="light")return s.lightColorScheme;if(t==="dark")return s.darkColorScheme})}function BP(s){const{defaultMode:t="light",defaultLightColorScheme:i,defaultDarkColorScheme:r,supportedColorSchemes:e=[],modeStorageKey:o=zb,colorSchemeStorageKey:a=Xb,storageWindow:l=typeof window>"u"?void 0:window,storageManager:f=CP,noSsr:n=!1}=s,c=e.join(","),d=e.length>1,y=et.useMemo(()=>f==null?void 0:f({key:o,storageWindow:l}),[f,o,l]),p=et.useMemo(()=>f==null?void 0:f({key:`${a}-light`,storageWindow:l}),[f,a,l]),g=et.useMemo(()=>f==null?void 0:f({key:`${a}-dark`,storageWindow:l}),[f,a,l]),[b,w]=et.useState(()=>{const A=(y==null?void 0:y.get(t))||t,R=(p==null?void 0:p.get(i))||i,P=(g==null?void 0:g.get(r))||r;return{mode:A,systemMode:W2(A),lightColorScheme:R,darkColorScheme:P}}),[v,_]=et.useState(n||!d);et.useEffect(()=>{_(!0)},[]);const S=DP(b),T=et.useCallback(A=>{w(R=>{if(A===R.mode)return R;const P=A??t;return y==null||y.set(P),{...R,mode:P,systemMode:W2(P)}})},[y,t]),I=et.useCallback(A=>{A?typeof A=="string"?A&&!c.includes(A)?console.error(`\`${A}\` does not exist in \`theme.colorSchemes\`.`):w(R=>{const P={...R};return nT(R,C=>{C==="light"&&(p==null||p.set(A),P.lightColorScheme=A),C==="dark"&&(g==null||g.set(A),P.darkColorScheme=A)}),P}):w(R=>{const P={...R},C=A.light===null?i:A.light,N=A.dark===null?r:A.dark;return C&&(c.includes(C)?(P.lightColorScheme=C,p==null||p.set(C)):console.error(`\`${C}\` does not exist in \`theme.colorSchemes\`.`)),N&&(c.includes(N)?(P.darkColorScheme=N,g==null||g.set(N)):console.error(`\`${N}\` does not exist in \`theme.colorSchemes\`.`)),P}):w(R=>(p==null||p.set(i),g==null||g.set(r),{...R,lightColorScheme:i,darkColorScheme:r}))},[c,p,g,i,r]),k=et.useCallback(A=>{b.mode==="system"&&w(R=>{const P=A!=null&&A.matches?"dark":"light";return R.systemMode===P?R:{...R,systemMode:P}})},[b.mode]),O=et.useRef(k);return O.current=k,et.useEffect(()=>{if(typeof window.matchMedia!="function"||!d)return;const A=(...P)=>O.current(...P),R=window.matchMedia("(prefers-color-scheme: dark)");return R.addListener(A),A(R),()=>{R.removeListener(A)}},[d]),et.useEffect(()=>{if(d){const A=(y==null?void 0:y.subscribe(C=>{(!C||["light","dark","system"].includes(C))&&T(C||t)}))||tm,R=(p==null?void 0:p.subscribe(C=>{(!C||c.match(C))&&I({light:C})}))||tm,P=(g==null?void 0:g.subscribe(C=>{(!C||c.match(C))&&I({dark:C})}))||tm;return()=>{A(),R(),P()}}},[I,T,c,t,l,d,y,p,g]),{...b,mode:v?b.mode:void 0,systemMode:v?b.systemMode:void 0,colorScheme:v?S:void 0,setMode:T,setColorScheme:I}}const FP="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function LP(s){const{themeId:t,theme:i={},modeStorageKey:r=zb,colorSchemeStorageKey:e=Xb,disableTransitionOnChange:o=!1,defaultColorScheme:a,resolveTheme:l}=s,f={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},n=et.createContext(void 0),c=()=>et.useContext(n)||f,d={},y={};function p(v){var Xt,Qt,Ft,Rt;const{children:_,theme:S,modeStorageKey:T=r,colorSchemeStorageKey:I=e,disableTransitionOnChange:k=o,storageManager:O,storageWindow:A=typeof window>"u"?void 0:window,documentNode:R=typeof document>"u"?void 0:document,colorSchemeNode:P=typeof document>"u"?void 0:document.documentElement,disableNestedContext:C=!1,disableStyleSheetGeneration:N=!1,defaultMode:D="system",forceThemeRerender:U=!1,noSsr:F}=v,L=et.useRef(!1),j=Wb(),V=et.useContext(n),W=!!V&&!C,q=et.useMemo(()=>S||(typeof i=="function"?i():i),[S]),$=q[t],Y=$||q,{colorSchemes:Q=d,components:J=y,cssVarPrefix:vt}=Y,wt=Object.keys(Q).filter(St=>!!Q[St]).join(","),dt=et.useMemo(()=>wt.split(","),[wt]),yt=typeof a=="string"?a:a.light,_t=typeof a=="string"?a:a.dark,tt=Q[yt]&&Q[_t]?D:((Qt=(Xt=Q[Y.defaultColorScheme])==null?void 0:Xt.palette)==null?void 0:Qt.mode)||((Ft=Y.palette)==null?void 0:Ft.mode),{mode:xt,setMode:It,systemMode:Nt,lightColorScheme:Lt,darkColorScheme:ne,colorScheme:Ut,setColorScheme:Vt}=BP({supportedColorSchemes:dt,defaultLightColorScheme:yt,defaultDarkColorScheme:_t,modeStorageKey:T,colorSchemeStorageKey:I,defaultMode:tt,storageManager:O,storageWindow:A,noSsr:F});let Jt=xt,Ct=Ut;W&&(Jt=V.mode,Ct=V.colorScheme);let K=Ct||Y.defaultColorScheme;Y.vars&&!U&&(K=Y.defaultColorScheme);const ut=et.useMemo(()=>{var Wt;const St=((Wt=Y.generateThemeVars)==null?void 0:Wt.call(Y))||Y.vars,Ot={...Y,components:J,colorSchemes:Q,cssVarPrefix:vt,vars:St};if(typeof Ot.generateSpacing=="function"&&(Ot.spacing=Ot.generateSpacing()),K){const Gt=Q[K];Gt&&typeof Gt=="object"&&Object.keys(Gt).forEach(z=>{Gt[z]&&typeof Gt[z]=="object"?Ot[z]={...Ot[z],...Gt[z]}:Ot[z]=Gt[z]})}return l?l(Ot):Ot},[Y,K,J,Q,vt]),st=Y.colorSchemeSelector;au(()=>{if(Ct&&P&&st&&st!=="media"){const St=st;let Ot=st;if(St==="class"&&(Ot=".%s"),St==="data"&&(Ot="[data-%s]"),St!=null&&St.startsWith("data-")&&!St.includes("%s")&&(Ot=`[${St}="%s"]`),Ot.startsWith("."))P.classList.remove(...dt.map(Wt=>Ot.substring(1).replace("%s",Wt))),P.classList.add(Ot.substring(1).replace("%s",Ct));else{const Wt=Ot.replace("%s",Ct).match(/\[([^\]]+)\]/);if(Wt){const[Gt,z]=Wt[1].split("=");z||dt.forEach(G=>{P.removeAttribute(Gt.replace(Ct,G))}),P.setAttribute(Gt,z?z.replace(/"|'/g,""):"")}else P.setAttribute(Ot,Ct)}}},[Ct,st,P,dt]),et.useEffect(()=>{let St;if(k&&L.current&&R){const Ot=R.createElement("style");Ot.appendChild(R.createTextNode(FP)),R.head.appendChild(Ot),window.getComputedStyle(R.body),St=setTimeout(()=>{R.head.removeChild(Ot)},1)}return()=>{clearTimeout(St)}},[Ct,k,R]),et.useEffect(()=>(L.current=!0,()=>{L.current=!1}),[]);const Mt=et.useMemo(()=>({allColorSchemes:dt,colorScheme:Ct,darkColorScheme:ne,lightColorScheme:Lt,mode:Jt,setColorScheme:Vt,setMode:It,systemMode:Nt}),[dt,Ct,ne,Lt,Jt,Vt,It,Nt,ut.colorSchemeSelector]);let Ht=!0;(N||Y.cssVariables===!1||W&&(j==null?void 0:j.cssVarPrefix)===vt)&&(Ht=!1);const Kt=it.jsxs(et.Fragment,{children:[it.jsx(iT,{themeId:$?t:void 0,theme:ut,children:_}),Ht&&it.jsx(P8,{styles:((Rt=ut.generateStyleSheets)==null?void 0:Rt.call(ut))||[]})]});return W?Kt:it.jsx(n.Provider,{value:Mt,children:Kt})}const g=typeof a=="string"?a:a.light,b=typeof a=="string"?a:a.dark;return{CssVarsProvider:p,useColorScheme:c,getInitColorSchemeScript:v=>MP({colorSchemeStorageKey:e,defaultLightColorScheme:g,defaultDarkColorScheme:b,modeStorageKey:r,...v})}}function UP(s=""){function t(...r){if(!r.length)return"";const e=r[0];return typeof e=="string"&&!e.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${s?`${s}-`:""}${e}${t(...r.slice(1))})`:`, ${e}`}return(r,...e)=>`var(--${s?`${s}-`:""}${r}${t(...e)})`}const $2=(s,t,i,r=[])=>{let e=s;t.forEach((o,a)=>{a===t.length-1?Array.isArray(e)?e[Number(o)]=i:e&&typeof e=="object"&&(e[o]=i):e&&typeof e=="object"&&(e[o]||(e[o]=r.includes(o)?[]:{}),e=e[o])})},qP=(s,t,i)=>{function r(e,o=[],a=[]){Object.entries(e).forEach(([l,f])=>{(!i||i&&!i([...o,l]))&&f!=null&&(typeof f=="object"&&Object.keys(f).length>0?r(f,[...o,l],Array.isArray(f)?[...a,l]:a):t([...o,l],f,a))})}r(s)},jP=(s,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>s.includes(r))||s[s.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function em(s,t){const{prefix:i,shouldSkipGeneratingVar:r}=t||{},e={},o={},a={};return qP(s,(l,f,n)=>{if((typeof f=="string"||typeof f=="number")&&(!r||!r(l,f))){const c=`--${i?`${i}-`:""}${l.join("-")}`,d=jP(l,f);Object.assign(e,{[c]:d}),$2(o,l,`var(${c})`,n),$2(a,l,`var(${c}, ${d})`,n)}},l=>l[0]==="vars"),{css:e,vars:o,varsWithDefaults:a}}function HP(s,t={}){const{getSelector:i=w,disableCssColorScheme:r,colorSchemeSelector:e}=t,{colorSchemes:o={},components:a,defaultColorScheme:l="light",...f}=s,{vars:n,css:c,varsWithDefaults:d}=em(f,t);let y=d;const p={},{[l]:g,...b}=o;if(Object.entries(b||{}).forEach(([S,T])=>{const{vars:I,css:k,varsWithDefaults:O}=em(T,t);y=qi(y,O),p[S]={css:k,vars:I}}),g){const{css:S,vars:T,varsWithDefaults:I}=em(g,t);y=qi(y,I),p[l]={css:S,vars:T}}function w(S,T){var k,O;let I=e;if(e==="class"&&(I=".%s"),e==="data"&&(I="[data-%s]"),e!=null&&e.startsWith("data-")&&!e.includes("%s")&&(I=`[${e}="%s"]`),S){if(I==="media")return s.defaultColorScheme===S?":root":{[`@media (prefers-color-scheme: ${((O=(k=o[S])==null?void 0:k.palette)==null?void 0:O.mode)||S})`]:{":root":T}};if(I)return s.defaultColorScheme===S?`:root, ${I.replace("%s",String(S))}`:I.replace("%s",String(S))}return":root"}return{vars:y,generateThemeVars:()=>{let S={...n};return Object.entries(p).forEach(([,{vars:T}])=>{S=qi(S,T)}),S},generateStyleSheets:()=>{var A,R;const S=[],T=s.defaultColorScheme||"light";function I(P,C){Object.keys(C).length&&S.push(typeof P=="string"?{[P]:{...C}}:P)}I(i(void 0,{...c}),c);const{[T]:k,...O}=p;if(k){const{css:P}=k,C=(R=(A=o[T])==null?void 0:A.palette)==null?void 0:R.mode,N=!r&&C?{colorScheme:C,...P}:{...P};I(i(T,{...N}),N)}return Object.entries(O).forEach(([P,{css:C}])=>{var U,F;const N=(F=(U=o[P])==null?void 0:U.palette)==null?void 0:F.mode,D=!r&&N?{colorScheme:N,...C}:{...C};I(i(P,{...D}),D)}),S}}}function KP(s){return function(i){return s==="media"?`@media (prefers-color-scheme: ${i})`:s?s.startsWith("data-")&&!s.includes("%s")?`[${s}="${i}"] &`:s==="class"?`.${i} &`:s==="data"?`[data-${i}] &`:`${s.replace("%s",i)} &`:"&"}}const VP=df(),WP=V8("div",{name:"MuiContainer",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,t[`maxWidth${zt(String(i.maxWidth))}`],i.fixed&&t.fixed,i.disableGutters&&t.disableGutters]}}),$P=s=>W8({props:s,name:"MuiContainer",defaultTheme:VP}),zP=(s,t)=>{const i=f=>yi(t,f),{classes:r,fixed:e,disableGutters:o,maxWidth:a}=s,l={root:["root",a&&`maxWidth${zt(String(a))}`,e&&"fixed",o&&"disableGutters"]};return _i(l,i,r)};function XP(s={}){const{createStyledComponent:t=WP,useThemeProps:i=$P,componentName:r="MuiContainer"}=s,e=t(({theme:a,ownerState:l})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!l.disableGutters&&{paddingLeft:a.spacing(2),paddingRight:a.spacing(2),[a.breakpoints.up("sm")]:{paddingLeft:a.spacing(3),paddingRight:a.spacing(3)}}}),({theme:a,ownerState:l})=>l.fixed&&Object.keys(a.breakpoints.values).reduce((f,n)=>{const c=n,d=a.breakpoints.values[c];return d!==0&&(f[a.breakpoints.up(c)]={maxWidth:`${d}${a.breakpoints.unit}`}),f},{}),({theme:a,ownerState:l})=>({...l.maxWidth==="xs"&&{[a.breakpoints.up("xs")]:{maxWidth:Math.max(a.breakpoints.values.xs,444)}},...l.maxWidth&&l.maxWidth!=="xs"&&{[a.breakpoints.up(l.maxWidth)]:{maxWidth:`${a.breakpoints.values[l.maxWidth]}${a.breakpoints.unit}`}}}));return et.forwardRef(function(l,f){const n=i(l),{className:c,component:d="div",disableGutters:y=!1,fixed:p=!1,maxWidth:g="lg",classes:b,...w}=n,v={...n,component:d,disableGutters:y,fixed:p,maxWidth:g},_=zP(v,r);return it.jsx(e,{as:d,ownerState:v,className:de(_.root,c),ref:f,...w})})}const GP=df(),YP=V8("div",{name:"MuiStack",slot:"Root",overridesResolver:(s,t)=>t.root});function QP(s){return W8({props:s,name:"MuiStack",defaultTheme:GP})}function ZP(s,t){const i=et.Children.toArray(s).filter(Boolean);return i.reduce((r,e,o)=>(r.push(e),o<i.length-1&&r.push(et.cloneElement(t,{key:`separator-${o}`})),r),[])}const JP=s=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[s],t7=({ownerState:s,theme:t})=>{let i={display:"flex",flexDirection:"column",...ur({theme:t},Zg({values:s.direction,breakpoints:t.breakpoints.values}),r=>({flexDirection:r}))};if(s.spacing){const r=i0(t),e=Object.keys(t.breakpoints.values).reduce((f,n)=>((typeof s.spacing=="object"&&s.spacing[n]!=null||typeof s.direction=="object"&&s.direction[n]!=null)&&(f[n]=!0),f),{}),o=Zg({values:s.direction,base:e}),a=Zg({values:s.spacing,base:e});typeof o=="object"&&Object.keys(o).forEach((f,n,c)=>{if(!o[f]){const y=n>0?o[c[n-1]]:"column";o[f]=y}}),i=qi(i,ur({theme:t},a,(f,n)=>s.useFlexGap?{gap:So(r,f)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${JP(n?o[n]:s.direction)}`]:So(r,f)}}))}return i=aA(t.breakpoints,i),i};function e7(s={}){const{createStyledComponent:t=YP,useThemeProps:i=QP,componentName:r="MuiStack"}=s,e=()=>_i({root:["root"]},f=>yi(r,f),{}),o=t(t7);return et.forwardRef(function(f,n){const c=i(f),d=jb(c),{component:y="div",direction:p="column",spacing:g=0,divider:b,children:w,className:v,useFlexGap:_=!1,...S}=d,T={direction:p,spacing:g,useFlexGap:_},I=e();return it.jsx(o,{as:y,ownerState:T,ref:n,className:de(I.root,v),...S,children:b?ZP(w,b):w})})}function rT(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Yd.white,default:Yd.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const i7=rT();function aT(){return{text:{primary:Yd.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Yd.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const z2=aT();function X2(s,t,i,r){const e=r.light||r,o=r.dark||r*1.5;s[t]||(s.hasOwnProperty(i)?s[t]=s[i]:t==="light"?s.light=Vb(s.main,e):t==="dark"&&(s.dark=Kb(s.main,o)))}function n7(s="light"){return s==="dark"?{main:uc[200],light:uc[50],dark:uc[400]}:{main:uc[700],light:uc[400],dark:uc[800]}}function r7(s="light"){return s==="dark"?{main:cc[200],light:cc[50],dark:cc[400]}:{main:cc[500],light:cc[300],dark:cc[700]}}function a7(s="light"){return s==="dark"?{main:oc[500],light:oc[300],dark:oc[700]}:{main:oc[700],light:oc[400],dark:oc[800]}}function s7(s="light"){return s==="dark"?{main:lc[400],light:lc[300],dark:lc[700]}:{main:lc[700],light:lc[500],dark:lc[900]}}function o7(s="light"){return s==="dark"?{main:dc[400],light:dc[300],dark:dc[700]}:{main:dc[800],light:dc[500],dark:dc[900]}}function c7(s="light"){return s==="dark"?{main:gl[400],light:gl[300],dark:gl[700]}:{main:"#ed6c02",light:gl[500],dark:gl[900]}}function Gb(s){const{mode:t="light",contrastThreshold:i=3,tonalOffset:r=.2,...e}=s,o=s.primary||n7(t),a=s.secondary||r7(t),l=s.error||a7(t),f=s.info||s7(t),n=s.success||o7(t),c=s.warning||c7(t);function d(b){return dP(b,z2.text.primary)>=i?z2.text.primary:i7.text.primary}const y=({color:b,name:w,mainShade:v=500,lightShade:_=300,darkShade:S=700})=>{if(b={...b},!b.main&&b[v]&&(b.main=b[v]),!b.hasOwnProperty("main"))throw new Error(ss(11,w?` (${w})`:"",v));if(typeof b.main!="string")throw new Error(ss(12,w?` (${w})`:"",JSON.stringify(b.main)));return X2(b,"light",_,r),X2(b,"dark",S,r),b.contrastText||(b.contrastText=d(b.main)),b};let p;return t==="light"?p=rT():t==="dark"&&(p=aT()),qi({common:{...Yd},mode:t,primary:y({color:o,name:"primary"}),secondary:y({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:y({color:l,name:"error"}),warning:y({color:c,name:"warning"}),info:y({color:f,name:"info"}),success:y({color:n,name:"success"}),grey:GE,contrastThreshold:i,getContrastText:d,augmentColor:y,tonalOffset:r,...p},e)}function u7(s){const t={};return Object.entries(s).forEach(r=>{const[e,o]=r;typeof o=="object"&&(t[e]=`${o.fontStyle?`${o.fontStyle} `:""}${o.fontVariant?`${o.fontVariant} `:""}${o.fontWeight?`${o.fontWeight} `:""}${o.fontStretch?`${o.fontStretch} `:""}${o.fontSize||""}${o.lineHeight?`/${o.lineHeight} `:""}${o.fontFamily||""}`)}),t}function l7(s,t){return{toolbar:{minHeight:56,[s.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[s.up("sm")]:{minHeight:64}},...t}}function d7(s){return Math.round(s*1e5)/1e5}const G2={textTransform:"uppercase"},Y2='"Roboto", "Helvetica", "Arial", sans-serif';function sT(s,t){const{fontFamily:i=Y2,fontSize:r=14,fontWeightLight:e=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:f=16,allVariants:n,pxToRem:c,...d}=typeof t=="function"?t(s):t,y=r/14,p=c||(w=>`${w/f*y}rem`),g=(w,v,_,S,T)=>({fontFamily:i,fontWeight:w,fontSize:p(v),lineHeight:_,...i===Y2?{letterSpacing:`${d7(S/v)}em`}:{},...T,...n}),b={h1:g(e,96,1.167,-1.5),h2:g(e,60,1.2,-.5),h3:g(o,48,1.167,0),h4:g(o,34,1.235,.25),h5:g(o,24,1.334,0),h6:g(a,20,1.6,.15),subtitle1:g(o,16,1.75,.15),subtitle2:g(a,14,1.57,.1),body1:g(o,16,1.5,.15),body2:g(o,14,1.43,.15),button:g(a,14,1.75,.4,G2),caption:g(o,12,1.66,.4),overline:g(o,12,2.66,1,G2),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return qi({htmlFontSize:f,pxToRem:p,fontFamily:i,fontSize:r,fontWeightLight:e,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l,...b},d,{clone:!1})}const f7=.2,h7=.14,p7=.12;function Ge(...s){return[`${s[0]}px ${s[1]}px ${s[2]}px ${s[3]}px rgba(0,0,0,${f7})`,`${s[4]}px ${s[5]}px ${s[6]}px ${s[7]}px rgba(0,0,0,${h7})`,`${s[8]}px ${s[9]}px ${s[10]}px ${s[11]}px rgba(0,0,0,${p7})`].join(",")}const y7=["none",Ge(0,2,1,-1,0,1,1,0,0,1,3,0),Ge(0,3,1,-2,0,2,2,0,0,1,5,0),Ge(0,3,3,-2,0,3,4,0,0,1,8,0),Ge(0,2,4,-1,0,4,5,0,0,1,10,0),Ge(0,3,5,-1,0,5,8,0,0,1,14,0),Ge(0,3,5,-1,0,6,10,0,0,1,18,0),Ge(0,4,5,-2,0,7,10,1,0,2,16,1),Ge(0,5,5,-3,0,8,10,1,0,3,14,2),Ge(0,5,6,-3,0,9,12,1,0,3,16,2),Ge(0,6,6,-3,0,10,14,1,0,4,18,3),Ge(0,6,7,-4,0,11,15,1,0,4,20,3),Ge(0,7,8,-4,0,12,17,2,0,5,22,4),Ge(0,7,8,-4,0,13,19,2,0,5,24,4),Ge(0,7,9,-4,0,14,21,2,0,5,26,4),Ge(0,8,9,-5,0,15,22,2,0,6,28,5),Ge(0,8,10,-5,0,16,24,2,0,6,30,5),Ge(0,8,11,-5,0,17,26,2,0,6,32,5),Ge(0,9,11,-5,0,18,28,2,0,7,34,6),Ge(0,9,12,-6,0,19,29,2,0,7,36,6),Ge(0,10,13,-6,0,20,31,3,0,8,38,7),Ge(0,10,13,-6,0,21,33,3,0,8,40,7),Ge(0,10,14,-6,0,22,35,3,0,8,42,7),Ge(0,11,14,-7,0,23,36,3,0,9,44,8),Ge(0,11,15,-7,0,24,38,3,0,9,46,8)],g7={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},m7={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Q2(s){return`${Math.round(s)}ms`}function b7(s){if(!s)return 0;const t=s/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function w7(s){const t={...g7,...s.easing},i={...m7,...s.duration};return{getAutoHeightDuration:b7,create:(e=["all"],o={})=>{const{duration:a=i.standard,easing:l=t.easeInOut,delay:f=0,...n}=o;return(Array.isArray(e)?e:[e]).map(c=>`${c} ${typeof a=="string"?a:Q2(a)} ${l} ${typeof f=="string"?f:Q2(f)}`).join(",")},...s,easing:t,duration:i}}const v7={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function x7(s){return _r(s)||typeof s>"u"||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||Array.isArray(s)}function oT(s={}){const t={...s};function i(r){const e=Object.entries(r);for(let o=0;o<e.length;o++){const[a,l]=e[o];!x7(l)||a.startsWith("unstable_")?delete r[a]:_r(l)&&(r[a]={...l},i(r[a]))}}return i(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function Ym(s={},...t){const{breakpoints:i,mixins:r={},spacing:e,palette:o={},transitions:a={},typography:l={},shape:f,...n}=s;if(s.vars&&s.generateThemeVars===void 0)throw new Error(ss(20));const c=Gb(o),d=df(s);let y=qi(d,{mixins:l7(d.breakpoints,r),palette:c,shadows:y7.slice(),typography:sT(c,l),transitions:w7(a),zIndex:{...v7}});return y=qi(y,n),y=t.reduce((p,g)=>qi(p,g),y),y.unstable_sxConfig={...lf,...n==null?void 0:n.unstable_sxConfig},y.unstable_sx=function(g){return os({sx:g,theme:this})},y.toRuntimeSource=oT,y}function Qm(s){let t;return s<1?t=5.11916*s**2:t=4.5*Math.log(s+1)+2,Math.round(t*10)/1e3}const _7=[...Array(25)].map((s,t)=>{if(t===0)return"none";const i=Qm(t);return`linear-gradient(rgba(255 255 255 / ${i}), rgba(255 255 255 / ${i}))`});function cT(s){return{inputPlaceholder:s==="dark"?.5:.42,inputUnderline:s==="dark"?.7:.42,switchTrackDisabled:s==="dark"?.2:.12,switchTrack:s==="dark"?.3:.38}}function uT(s){return s==="dark"?_7:[]}function S7(s){const{palette:t={mode:"light"},opacity:i,overlays:r,...e}=s,o=Gb(t);return{palette:o,opacity:{...cT(o.mode),...i},overlays:r||uT(o.mode),...e}}function T7(s){var t;return!!s[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!s[0].match(/sxConfig$/)||s[0]==="palette"&&!!((t=s[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const I7=s=>[...[...Array(25)].map((t,i)=>`--${s?`${s}-`:""}overlays-${i}`),`--${s?`${s}-`:""}palette-AppBar-darkBg`,`--${s?`${s}-`:""}palette-AppBar-darkColor`],k7=s=>(t,i)=>{const r=s.rootSelector||":root",e=s.colorSchemeSelector;let o=e;if(e==="class"&&(o=".%s"),e==="data"&&(o="[data-%s]"),e!=null&&e.startsWith("data-")&&!e.includes("%s")&&(o=`[${e}="%s"]`),s.defaultColorScheme===t){if(t==="dark"){const a={};return I7(s.cssVarPrefix).forEach(l=>{a[l]=i[l],delete i[l]}),o==="media"?{[r]:i,"@media (prefers-color-scheme: dark)":{[r]:a}}:o?{[o.replace("%s",t)]:a,[`${r}, ${o.replace("%s",t)}`]:i}:{[r]:{...i,...a}}}if(o&&o!=="media")return`${r}, ${o.replace("%s",String(t))}`}else if(t){if(o==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:i}};if(o)return o.replace("%s",String(t))}return r};function E7(s,t){t.forEach(i=>{s[i]||(s[i]={})})}function Tt(s,t,i){!s[t]&&i&&(s[t]=i)}function Fd(s){return typeof s!="string"||!s.startsWith("hsl")?s:$8(s)}function ea(s,t){`${t}Channel`in s||(s[`${t}Channel`]=Bd(Fd(s[t])))}function O7(s){return typeof s=="number"?`${s}px`:typeof s=="string"||typeof s=="function"||Array.isArray(s)?s:"8px"}const mr=s=>{try{return s()}catch{}},A7=(s="mui")=>UP(s);function im(s,t,i,r){if(!t)return;t=t===!0?{}:t;const e=r==="dark"?"dark":"light";if(!i){s[r]=S7({...t,palette:{mode:e,...t==null?void 0:t.palette}});return}const{palette:o,...a}=Ym({...i,palette:{mode:e,...t==null?void 0:t.palette}});return s[r]={...t,palette:o,opacity:{...cT(e),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||uT(e)},a}function P7(s={},...t){const{colorSchemes:i={light:!0},defaultColorScheme:r,disableCssColorScheme:e=!1,cssVarPrefix:o="mui",shouldSkipGeneratingVar:a=T7,colorSchemeSelector:l=i.light&&i.dark?"media":void 0,rootSelector:f=":root",...n}=s,c=Object.keys(i)[0],d=r||(i.light&&c!=="light"?"light":c),y=A7(o),{[d]:p,light:g,dark:b,...w}=i,v={...w};let _=p;if((d==="dark"&&!("dark"in i)||d==="light"&&!("light"in i))&&(_=!0),!_)throw new Error(ss(21,d));const S=im(v,_,n,d);g&&!v.light&&im(v,g,void 0,"light"),b&&!v.dark&&im(v,b,void 0,"dark");let T={defaultColorScheme:d,...S,cssVarPrefix:o,colorSchemeSelector:l,rootSelector:f,getCssVar:y,colorSchemes:v,font:{...u7(S.typography),...S.font},spacing:O7(n.spacing)};Object.keys(T.colorSchemes).forEach(R=>{const P=T.colorSchemes[R].palette,C=N=>{const D=N.split("-"),U=D[1],F=D[2];return y(N,P[U][F])};if(P.mode==="light"&&(Tt(P.common,"background","#fff"),Tt(P.common,"onBackground","#000")),P.mode==="dark"&&(Tt(P.common,"background","#000"),Tt(P.common,"onBackground","#fff")),E7(P,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),P.mode==="light"){Tt(P.Alert,"errorColor",He(P.error.light,.6)),Tt(P.Alert,"infoColor",He(P.info.light,.6)),Tt(P.Alert,"successColor",He(P.success.light,.6)),Tt(P.Alert,"warningColor",He(P.warning.light,.6)),Tt(P.Alert,"errorFilledBg",C("palette-error-main")),Tt(P.Alert,"infoFilledBg",C("palette-info-main")),Tt(P.Alert,"successFilledBg",C("palette-success-main")),Tt(P.Alert,"warningFilledBg",C("palette-warning-main")),Tt(P.Alert,"errorFilledColor",mr(()=>P.getContrastText(P.error.main))),Tt(P.Alert,"infoFilledColor",mr(()=>P.getContrastText(P.info.main))),Tt(P.Alert,"successFilledColor",mr(()=>P.getContrastText(P.success.main))),Tt(P.Alert,"warningFilledColor",mr(()=>P.getContrastText(P.warning.main))),Tt(P.Alert,"errorStandardBg",Ke(P.error.light,.9)),Tt(P.Alert,"infoStandardBg",Ke(P.info.light,.9)),Tt(P.Alert,"successStandardBg",Ke(P.success.light,.9)),Tt(P.Alert,"warningStandardBg",Ke(P.warning.light,.9)),Tt(P.Alert,"errorIconColor",C("palette-error-main")),Tt(P.Alert,"infoIconColor",C("palette-info-main")),Tt(P.Alert,"successIconColor",C("palette-success-main")),Tt(P.Alert,"warningIconColor",C("palette-warning-main")),Tt(P.AppBar,"defaultBg",C("palette-grey-100")),Tt(P.Avatar,"defaultBg",C("palette-grey-400")),Tt(P.Button,"inheritContainedBg",C("palette-grey-300")),Tt(P.Button,"inheritContainedHoverBg",C("palette-grey-A100")),Tt(P.Chip,"defaultBorder",C("palette-grey-400")),Tt(P.Chip,"defaultAvatarColor",C("palette-grey-700")),Tt(P.Chip,"defaultIconColor",C("palette-grey-700")),Tt(P.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Tt(P.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Tt(P.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Tt(P.LinearProgress,"primaryBg",Ke(P.primary.main,.62)),Tt(P.LinearProgress,"secondaryBg",Ke(P.secondary.main,.62)),Tt(P.LinearProgress,"errorBg",Ke(P.error.main,.62)),Tt(P.LinearProgress,"infoBg",Ke(P.info.main,.62)),Tt(P.LinearProgress,"successBg",Ke(P.success.main,.62)),Tt(P.LinearProgress,"warningBg",Ke(P.warning.main,.62)),Tt(P.Skeleton,"bg",`rgba(${C("palette-text-primaryChannel")} / 0.11)`),Tt(P.Slider,"primaryTrack",Ke(P.primary.main,.62)),Tt(P.Slider,"secondaryTrack",Ke(P.secondary.main,.62)),Tt(P.Slider,"errorTrack",Ke(P.error.main,.62)),Tt(P.Slider,"infoTrack",Ke(P.info.main,.62)),Tt(P.Slider,"successTrack",Ke(P.success.main,.62)),Tt(P.Slider,"warningTrack",Ke(P.warning.main,.62));const N=Ch(P.background.default,.8);Tt(P.SnackbarContent,"bg",N),Tt(P.SnackbarContent,"color",mr(()=>P.getContrastText(N))),Tt(P.SpeedDialAction,"fabHoverBg",Ch(P.background.paper,.15)),Tt(P.StepConnector,"border",C("palette-grey-400")),Tt(P.StepContent,"border",C("palette-grey-400")),Tt(P.Switch,"defaultColor",C("palette-common-white")),Tt(P.Switch,"defaultDisabledColor",C("palette-grey-100")),Tt(P.Switch,"primaryDisabledColor",Ke(P.primary.main,.62)),Tt(P.Switch,"secondaryDisabledColor",Ke(P.secondary.main,.62)),Tt(P.Switch,"errorDisabledColor",Ke(P.error.main,.62)),Tt(P.Switch,"infoDisabledColor",Ke(P.info.main,.62)),Tt(P.Switch,"successDisabledColor",Ke(P.success.main,.62)),Tt(P.Switch,"warningDisabledColor",Ke(P.warning.main,.62)),Tt(P.TableCell,"border",Ke(Nh(P.divider,1),.88)),Tt(P.Tooltip,"bg",Nh(P.grey[700],.92))}if(P.mode==="dark"){Tt(P.Alert,"errorColor",Ke(P.error.light,.6)),Tt(P.Alert,"infoColor",Ke(P.info.light,.6)),Tt(P.Alert,"successColor",Ke(P.success.light,.6)),Tt(P.Alert,"warningColor",Ke(P.warning.light,.6)),Tt(P.Alert,"errorFilledBg",C("palette-error-dark")),Tt(P.Alert,"infoFilledBg",C("palette-info-dark")),Tt(P.Alert,"successFilledBg",C("palette-success-dark")),Tt(P.Alert,"warningFilledBg",C("palette-warning-dark")),Tt(P.Alert,"errorFilledColor",mr(()=>P.getContrastText(P.error.dark))),Tt(P.Alert,"infoFilledColor",mr(()=>P.getContrastText(P.info.dark))),Tt(P.Alert,"successFilledColor",mr(()=>P.getContrastText(P.success.dark))),Tt(P.Alert,"warningFilledColor",mr(()=>P.getContrastText(P.warning.dark))),Tt(P.Alert,"errorStandardBg",He(P.error.light,.9)),Tt(P.Alert,"infoStandardBg",He(P.info.light,.9)),Tt(P.Alert,"successStandardBg",He(P.success.light,.9)),Tt(P.Alert,"warningStandardBg",He(P.warning.light,.9)),Tt(P.Alert,"errorIconColor",C("palette-error-main")),Tt(P.Alert,"infoIconColor",C("palette-info-main")),Tt(P.Alert,"successIconColor",C("palette-success-main")),Tt(P.Alert,"warningIconColor",C("palette-warning-main")),Tt(P.AppBar,"defaultBg",C("palette-grey-900")),Tt(P.AppBar,"darkBg",C("palette-background-paper")),Tt(P.AppBar,"darkColor",C("palette-text-primary")),Tt(P.Avatar,"defaultBg",C("palette-grey-600")),Tt(P.Button,"inheritContainedBg",C("palette-grey-800")),Tt(P.Button,"inheritContainedHoverBg",C("palette-grey-700")),Tt(P.Chip,"defaultBorder",C("palette-grey-700")),Tt(P.Chip,"defaultAvatarColor",C("palette-grey-300")),Tt(P.Chip,"defaultIconColor",C("palette-grey-300")),Tt(P.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Tt(P.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Tt(P.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Tt(P.LinearProgress,"primaryBg",He(P.primary.main,.5)),Tt(P.LinearProgress,"secondaryBg",He(P.secondary.main,.5)),Tt(P.LinearProgress,"errorBg",He(P.error.main,.5)),Tt(P.LinearProgress,"infoBg",He(P.info.main,.5)),Tt(P.LinearProgress,"successBg",He(P.success.main,.5)),Tt(P.LinearProgress,"warningBg",He(P.warning.main,.5)),Tt(P.Skeleton,"bg",`rgba(${C("palette-text-primaryChannel")} / 0.13)`),Tt(P.Slider,"primaryTrack",He(P.primary.main,.5)),Tt(P.Slider,"secondaryTrack",He(P.secondary.main,.5)),Tt(P.Slider,"errorTrack",He(P.error.main,.5)),Tt(P.Slider,"infoTrack",He(P.info.main,.5)),Tt(P.Slider,"successTrack",He(P.success.main,.5)),Tt(P.Slider,"warningTrack",He(P.warning.main,.5));const N=Ch(P.background.default,.98);Tt(P.SnackbarContent,"bg",N),Tt(P.SnackbarContent,"color",mr(()=>P.getContrastText(N))),Tt(P.SpeedDialAction,"fabHoverBg",Ch(P.background.paper,.15)),Tt(P.StepConnector,"border",C("palette-grey-600")),Tt(P.StepContent,"border",C("palette-grey-600")),Tt(P.Switch,"defaultColor",C("palette-grey-300")),Tt(P.Switch,"defaultDisabledColor",C("palette-grey-600")),Tt(P.Switch,"primaryDisabledColor",He(P.primary.main,.55)),Tt(P.Switch,"secondaryDisabledColor",He(P.secondary.main,.55)),Tt(P.Switch,"errorDisabledColor",He(P.error.main,.55)),Tt(P.Switch,"infoDisabledColor",He(P.info.main,.55)),Tt(P.Switch,"successDisabledColor",He(P.success.main,.55)),Tt(P.Switch,"warningDisabledColor",He(P.warning.main,.55)),Tt(P.TableCell,"border",He(Nh(P.divider,1),.68)),Tt(P.Tooltip,"bg",Nh(P.grey[700],.92))}ea(P.background,"default"),ea(P.background,"paper"),ea(P.common,"background"),ea(P.common,"onBackground"),ea(P,"divider"),Object.keys(P).forEach(N=>{const D=P[N];N!=="tonalOffset"&&D&&typeof D=="object"&&(D.main&&Tt(P[N],"mainChannel",Bd(Fd(D.main))),D.light&&Tt(P[N],"lightChannel",Bd(Fd(D.light))),D.dark&&Tt(P[N],"darkChannel",Bd(Fd(D.dark))),D.contrastText&&Tt(P[N],"contrastTextChannel",Bd(Fd(D.contrastText))),N==="text"&&(ea(P[N],"primary"),ea(P[N],"secondary")),N==="action"&&(D.active&&ea(P[N],"active"),D.selected&&ea(P[N],"selected")))})}),T=t.reduce((R,P)=>qi(R,P),T);const I={prefix:o,disableCssColorScheme:e,shouldSkipGeneratingVar:a,getSelector:k7(T)},{vars:k,generateThemeVars:O,generateStyleSheets:A}=HP(T,I);return T.vars=k,Object.entries(T.colorSchemes[T.defaultColorScheme]).forEach(([R,P])=>{T[R]=P}),T.generateThemeVars=O,T.generateStyleSheets=A,T.generateSpacing=function(){return F8(n.spacing,i0(this))},T.getColorSchemeSelector=KP(l),T.spacing=T.generateSpacing(),T.shouldSkipGeneratingVar=a,T.unstable_sxConfig={...lf,...n==null?void 0:n.unstable_sxConfig},T.unstable_sx=function(P){return os({sx:P,theme:this})},T.toRuntimeSource=oT,T}function Z2(s,t,i){s.colorSchemes&&i&&(s.colorSchemes[t]={...i!==!0&&i,palette:Gb({...i===!0?{}:i.palette,mode:t})})}function d0(s={},...t){const{palette:i,cssVariables:r=!1,colorSchemes:e=i?void 0:{light:!0},defaultColorScheme:o=i==null?void 0:i.mode,...a}=s,l=o||"light",f=e==null?void 0:e[l],n={...e,...i?{[l]:{...typeof f!="boolean"&&f,palette:i}}:void 0};if(r===!1){if(!("colorSchemes"in s))return Ym(s,...t);let c=i;"palette"in s||n[l]&&(n[l]!==!0?c=n[l].palette:l==="dark"&&(c={mode:"dark"}));const d=Ym({...s,palette:c},...t);return d.defaultColorScheme=l,d.colorSchemes=n,d.palette.mode==="light"&&(d.colorSchemes.light={...n.light!==!0&&n.light,palette:d.palette},Z2(d,"dark",n.dark)),d.palette.mode==="dark"&&(d.colorSchemes.dark={...n.dark!==!0&&n.dark,palette:d.palette},Z2(d,"light",n.light)),d}return!i&&!("light"in n)&&l==="light"&&(n.light=!0),P7({...a,colorSchemes:n,defaultColorScheme:l,...typeof r!="boolean"&&r},...t)}function J2(s){return String(parseFloat(s)).length===String(s).length}function R7(s){return String(s).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Cs(s){return parseFloat(s)}function M7(s){return(t,i)=>{const r=R7(t);if(r===i)return t;let e=Cs(t);r!=="px"&&(r==="em"||r==="rem")&&(e=Cs(t)*Cs(s));let o=e;if(i!=="px")if(i==="em")o=e/Cs(s);else if(i==="rem")o=e/Cs(s);else return t;return parseFloat(o.toFixed(5))+i}}function N7({size:s,grid:t}){const i=s-s%t,r=i+t;return s-i<r-s?i:r}function C7({lineHeight:s,pixels:t,htmlFontSize:i}){return t/(s*i)}function D7({cssProperty:s,min:t,max:i,unit:r="rem",breakpoints:e=[600,900,1200],transform:o=null}){const a={[s]:`${t}${r}`},l=(i-t)/e[e.length-1];return e.forEach(f=>{let n=t+l*f;o!==null&&(n=o(n)),a[`@media (min-width:${f}px)`]={[s]:`${Math.round(n*1e4)/1e4}${r}`}}),a}function B7(s,t={}){const{breakpoints:i=["sm","md","lg"],disableAlign:r=!1,factor:e=2,variants:o=["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]}=t,a={...s};a.typography={...a.typography};const l=a.typography,f=M7(l.htmlFontSize),n=i.map(c=>a.breakpoints.values[c]);return o.forEach(c=>{const d=l[c];if(!d)return;const y=parseFloat(f(d.fontSize,"rem"));if(y<=1)return;const p=y,g=1+(p-1)/e;let{lineHeight:b}=d;if(!J2(b)&&!r)throw new Error(ss(6));J2(b)||(b=parseFloat(f(b,"rem"))/parseFloat(y));let w=null;r||(w=v=>N7({size:v,grid:C7({pixels:4,lineHeight:b,htmlFontSize:l.htmlFontSize})})),l[c]={...d,...D7({cssProperty:"fontSize",min:g,max:p,unit:"rem",breakpoints:n,transform:w})}}),a}const Yb=d0();function fs(){const s=c0(Yb);return s[Tr]||s}function F7(s){return s!=="ownerState"&&s!=="theme"&&s!=="sx"&&s!=="as"}const lT=s=>F7(s)&&s!=="classes",ke=K8({themeId:Tr,defaultTheme:Yb,rootShouldForwardProp:lT});function nm({theme:s,...t}){const i=Tr in s?s[Tr]:void 0;return it.jsx(iT,{...t,themeId:i?Tr:void 0,theme:i||s})}const Dh={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:L7}=LP({themeId:Tr,theme:()=>d0({cssVariables:!0}),colorSchemeStorageKey:Dh.colorSchemeStorageKey,modeStorageKey:Dh.modeStorageKey,defaultColorScheme:{light:Dh.defaultLightColorScheme,dark:Dh.defaultDarkColorScheme},resolveTheme:s=>{const t={...s,typography:sT(s.palette,s.typography)};return t.unstable_sx=function(r){return os({sx:r,theme:this})},t}}),U7=L7;function q7({theme:s,...t}){if(typeof s=="function")return it.jsx(nm,{theme:s,...t});const i=Tr in s?s[Tr]:s;return"colorSchemes"in i?it.jsx(U7,{theme:s,...t}):"vars"in i?it.jsx(nm,{theme:s,...t}):it.jsx(nm,{theme:{...s,vars:null},...t})}function j7(s){return it.jsx(GA,{...s,defaultTheme:Yb,themeId:Tr})}function dT(s){return function(i){return it.jsx(j7,{styles:typeof s=="function"?r=>s({theme:r,...i}):s})}}function H7(){return jb}const Ri=PP;function ci(s){return AP(s)}function K7(s){return yi("MuiSvgIcon",s)}xi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const V7=s=>{const{color:t,fontSize:i,classes:r}=s,e={root:["root",t!=="inherit"&&`color${zt(t)}`,`fontSize${zt(i)}`]};return _i(e,K7,r)},W7=ke("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,i.color!=="inherit"&&t[`color${zt(i.color)}`],t[`fontSize${zt(i.fontSize)}`]]}})(Ri(({theme:s})=>{var t,i,r,e,o,a,l,f,n,c,d,y,p,g;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(e=(t=s.transitions)==null?void 0:t.create)==null?void 0:e.call(t,"fill",{duration:(r=(i=(s.vars??s).transitions)==null?void 0:i.duration)==null?void 0:r.shorter}),variants:[{props:b=>!b.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((a=(o=s.typography)==null?void 0:o.pxToRem)==null?void 0:a.call(o,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((f=(l=s.typography)==null?void 0:l.pxToRem)==null?void 0:f.call(l,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((c=(n=s.typography)==null?void 0:n.pxToRem)==null?void 0:c.call(n,35))||"2.1875rem"}},...Object.entries((s.vars??s).palette).filter(([,b])=>b&&b.main).map(([b])=>{var w,v;return{props:{color:b},style:{color:(v=(w=(s.vars??s).palette)==null?void 0:w[b])==null?void 0:v.main}}}),{props:{color:"action"},style:{color:(y=(d=(s.vars??s).palette)==null?void 0:d.action)==null?void 0:y.active}},{props:{color:"disabled"},style:{color:(g=(p=(s.vars??s).palette)==null?void 0:p.action)==null?void 0:g.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),Zm=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiSvgIcon"}),{children:e,className:o,color:a="inherit",component:l="svg",fontSize:f="medium",htmlColor:n,inheritViewBox:c=!1,titleAccess:d,viewBox:y="0 0 24 24",...p}=r,g=et.isValidElement(e)&&e.type==="svg",b={...r,color:a,component:l,fontSize:f,instanceFontSize:t.fontSize,inheritViewBox:c,viewBox:y,hasSvgAsChild:g},w={};c||(w.viewBox=y);const v=V7(b);return it.jsxs(W7,{as:l,className:de(v.root,o),focusable:"false",color:n,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:i,...w,...p,...g&&e.props,ownerState:b,children:[g?e.props.children:e,d?it.jsx("title",{children:d}):null]})});Zm.muiName="SvgIcon";function Ia(s,t){function i(r,e){return it.jsx(Zm,{"data-testid":void 0,ref:e,...r,children:s})}return i.muiName=Zm.muiName,et.memo(et.forwardRef(i))}function $7(s,t){const i=s.charCodeAt(2);return s[0]==="o"&&s[1]==="n"&&i>=65&&i<=90&&typeof t=="function"}function z7(s,t){if(!s)return t;function i(a,l){const f={};return Object.keys(l).forEach(n=>{$7(n,l[n])&&typeof a[n]=="function"&&(f[n]=(...c)=>{a[n](...c),l[n](...c)})}),f}if(typeof s=="function"||typeof t=="function")return a=>{const l=typeof t=="function"?t(a):t,f=typeof s=="function"?s({...a,...l}):s,n=de(a==null?void 0:a.className,l==null?void 0:l.className,f==null?void 0:f.className),c=i(f,l);return{...l,...f,...c,...!!n&&{className:n},...(l==null?void 0:l.style)&&(f==null?void 0:f.style)&&{style:{...l.style,...f.style}},...(l==null?void 0:l.sx)&&(f==null?void 0:f.sx)&&{sx:[...Array.isArray(l.sx)?l.sx:[l.sx],...Array.isArray(f.sx)?f.sx:[f.sx]]}}};const r=t,e=i(s,r),o=de(r==null?void 0:r.className,s==null?void 0:s.className);return{...t,...s,...e,...!!o&&{className:o},...(r==null?void 0:r.style)&&(s==null?void 0:s.style)&&{style:{...r.style,...s.style}},...(r==null?void 0:r.sx)&&(s==null?void 0:s.sx)&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(s.sx)?s.sx:[s.sx]]}}}function fT(s,t){if(s==null)return{};var i={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(t.indexOf(r)!==-1)continue;i[r]=s[r]}return i}function Jm(s,t){return Jm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},Jm(s,t)}function hT(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Jm(s,t)}var pT=g8();const Bh=p8(pT),t_={disabled:!1},Fp=Sr.createContext(null);var X7=function(t){return t.scrollTop},Ld="unmounted",lo="exited",fo="entering",$c="entered",tb="exiting",lr=function(s){hT(t,s);function t(r,e){var o;o=s.call(this,r,e)||this;var a=e,l=a&&!a.isMounting?r.enter:r.appear,f;return o.appearStatus=null,r.in?l?(f=lo,o.appearStatus=fo):f=$c:r.unmountOnExit||r.mountOnEnter?f=Ld:f=lo,o.state={status:f},o.nextCallback=null,o}t.getDerivedStateFromProps=function(e,o){var a=e.in;return a&&o.status===Ld?{status:lo}:null};var i=t.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var o=null;if(e!==this.props){var a=this.state.status;this.props.in?a!==fo&&a!==$c&&(o=fo):(a===fo||a===$c)&&(o=tb)}this.updateStatus(!1,o)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e=this.props.timeout,o,a,l;return o=a=l=e,e!=null&&typeof e!="number"&&(o=e.exit,a=e.enter,l=e.appear!==void 0?e.appear:a),{exit:o,enter:a,appear:l}},i.updateStatus=function(e,o){if(e===void 0&&(e=!1),o!==null)if(this.cancelNextCallback(),o===fo){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Bh.findDOMNode(this);a&&X7(a)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===lo&&this.setState({status:Ld})},i.performEnter=function(e){var o=this,a=this.props.enter,l=this.context?this.context.isMounting:e,f=this.props.nodeRef?[l]:[Bh.findDOMNode(this),l],n=f[0],c=f[1],d=this.getTimeouts(),y=l?d.appear:d.enter;if(!e&&!a||t_.disabled){this.safeSetState({status:$c},function(){o.props.onEntered(n)});return}this.props.onEnter(n,c),this.safeSetState({status:fo},function(){o.props.onEntering(n,c),o.onTransitionEnd(y,function(){o.safeSetState({status:$c},function(){o.props.onEntered(n,c)})})})},i.performExit=function(){var e=this,o=this.props.exit,a=this.getTimeouts(),l=this.props.nodeRef?void 0:Bh.findDOMNode(this);if(!o||t_.disabled){this.safeSetState({status:lo},function(){e.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:tb},function(){e.props.onExiting(l),e.onTransitionEnd(a.exit,function(){e.safeSetState({status:lo},function(){e.props.onExited(l)})})})},i.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,o){o=this.setNextCallback(o),this.setState(e,o)},i.setNextCallback=function(e){var o=this,a=!0;return this.nextCallback=function(l){a&&(a=!1,o.nextCallback=null,e(l))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},i.onTransitionEnd=function(e,o){this.setNextCallback(o);var a=this.props.nodeRef?this.props.nodeRef.current:Bh.findDOMNode(this),l=e==null&&!this.props.addEndListener;if(!a||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],n=f[0],c=f[1];this.props.addEndListener(n,c)}e!=null&&setTimeout(this.nextCallback,e)},i.render=function(){var e=this.state.status;if(e===Ld)return null;var o=this.props,a=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var l=fT(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Sr.createElement(Fp.Provider,{value:null},typeof a=="function"?a(e,l):Sr.cloneElement(Sr.Children.only(a),l))},t}(Sr.Component);lr.contextType=Fp;lr.propTypes={};function fc(){}lr.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:fc,onEntering:fc,onEntered:fc,onExit:fc,onExiting:fc,onExited:fc};lr.UNMOUNTED=Ld;lr.EXITED=lo;lr.ENTERING=fo;lr.ENTERED=$c;lr.EXITING=tb;function G7(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Qb(s,t){var i=function(o){return t&&et.isValidElement(o)?t(o):o},r=Object.create(null);return s&&et.Children.map(s,function(e){return e}).forEach(function(e){r[e.key]=i(e)}),r}function Y7(s,t){s=s||{},t=t||{};function i(c){return c in t?t[c]:s[c]}var r=Object.create(null),e=[];for(var o in s)o in t?e.length&&(r[o]=e,e=[]):e.push(o);var a,l={};for(var f in t){if(r[f])for(a=0;a<r[f].length;a++){var n=r[f][a];l[r[f][a]]=i(n)}l[f]=i(f)}for(a=0;a<e.length;a++)l[e[a]]=i(e[a]);return l}function bo(s,t,i){return i[t]!=null?i[t]:s.props[t]}function Q7(s,t){return Qb(s.children,function(i){return et.cloneElement(i,{onExited:t.bind(null,i),in:!0,appear:bo(i,"appear",s),enter:bo(i,"enter",s),exit:bo(i,"exit",s)})})}function Z7(s,t,i){var r=Qb(s.children),e=Y7(t,r);return Object.keys(e).forEach(function(o){var a=e[o];if(et.isValidElement(a)){var l=o in t,f=o in r,n=t[o],c=et.isValidElement(n)&&!n.props.in;f&&(!l||c)?e[o]=et.cloneElement(a,{onExited:i.bind(null,a),in:!0,exit:bo(a,"exit",s),enter:bo(a,"enter",s)}):!f&&l&&!c?e[o]=et.cloneElement(a,{in:!1}):f&&l&&et.isValidElement(n)&&(e[o]=et.cloneElement(a,{onExited:i.bind(null,a),in:n.props.in,exit:bo(a,"exit",s),enter:bo(a,"enter",s)}))}}),e}var J7=Object.values||function(s){return Object.keys(s).map(function(t){return s[t]})},t9={component:"div",childFactory:function(t){return t}},Zb=function(s){hT(t,s);function t(r,e){var o;o=s.call(this,r,e)||this;var a=o.handleExited.bind(G7(o));return o.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},o}var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,o){var a=o.children,l=o.handleExited,f=o.firstRender;return{children:f?Q7(e,l):Z7(e,a,l),firstRender:!1}},i.handleExited=function(e,o){var a=Qb(this.props.children);e.key in a||(e.props.onExited&&e.props.onExited(o),this.mounted&&this.setState(function(l){var f=Mp({},l.children);return delete f[e.key],{children:f}}))},i.render=function(){var e=this.props,o=e.component,a=e.childFactory,l=fT(e,["component","childFactory"]),f=this.state.contextValue,n=J7(this.state.children).map(a);return delete l.appear,delete l.enter,delete l.exit,o===null?Sr.createElement(Fp.Provider,{value:f},n):Sr.createElement(Fp.Provider,{value:f},Sr.createElement(o,l,n))},t}(Sr.Component);Zb.propTypes={};Zb.defaultProps=t9;const Jb=s=>s.scrollTop;function ou(s,t){const{timeout:i,easing:r,style:e={}}=s;return{duration:e.transitionDuration??(typeof i=="number"?i:i[t.mode]||0),easing:e.transitionTimingFunction??(typeof r=="object"?r[t.mode]:r),delay:e.transitionDelay}}function e9(s){return yi("MuiPaper",s)}xi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const i9=s=>{const{square:t,elevation:i,variant:r,classes:e}=s,o={root:["root",r,!t&&"rounded",r==="elevation"&&`elevation${i}`]};return _i(o,e9,e)},n9=ke("div",{name:"MuiPaper",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,t[i.variant],!i.square&&t.rounded,i.variant==="elevation"&&t[`elevation${i.elevation}`]]}})(Ri(({theme:s})=>({backgroundColor:(s.vars||s).palette.background.paper,color:(s.vars||s).palette.text.primary,transition:s.transitions.create("box-shadow"),variants:[{props:({ownerState:t})=>!t.square,style:{borderRadius:s.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(s.vars||s).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),ff=et.forwardRef(function(t,i){var p;const r=ci({props:t,name:"MuiPaper"}),e=fs(),{className:o,component:a="div",elevation:l=1,square:f=!1,variant:n="elevation",...c}=r,d={...r,component:a,elevation:l,square:f,variant:n},y=i9(d);return it.jsx(n9,{as:a,ownerState:d,className:de(y.root,o),ref:i,...c,style:{...n==="elevation"&&{"--Paper-shadow":(e.vars||e).shadows[l],...e.vars&&{"--Paper-overlay":(p=e.vars.overlays)==null?void 0:p[l]},...!e.vars&&e.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Pi("#fff",Qm(l))}, ${Pi("#fff",Qm(l))})`}},...c.style}})});function Un(s,t){const{className:i,elementType:r,ownerState:e,externalForwardedProps:o,internalForwardedProps:a,shouldForwardComponentProp:l=!1,...f}=t,{component:n,slots:c={[s]:void 0},slotProps:d={[s]:void 0},...y}=o,p=c[s]||r,g=Z8(d[s],e),{props:{component:b,...w},internalRef:v}=Q8({className:i,...f,externalForwardedProps:s==="root"?y:void 0,externalSlotProps:g}),_=Zi(v,g==null?void 0:g.ref,t.ref),S=s==="root"?b||n:b,T=G8(p,{...s==="root"&&!n&&!c[s]&&a,...s!=="root"&&!c[s]&&a,...w,...S&&!l&&{as:S},...S&&l&&{component:S},ref:_},e);return[p,T]}class Lp{constructor(){rt(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Lp}static use(){const t=X8(Lp.create).current,[i,r]=et.useState(!1);return t.shouldMount=i,t.setShouldMount=r,et.useEffect(t.mountEffect,[i]),t}mount(){return this.mounted||(this.mounted=a9(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.start(...t)})}stop(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.stop(...t)})}pulsate(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.pulsate(...t)})}}function r9(){return Lp.use()}function a9(){let s,t;const i=new Promise((r,e)=>{s=r,t=e});return i.resolve=s,i.reject=t,i}function s9(s){const{className:t,classes:i,pulsate:r=!1,rippleX:e,rippleY:o,rippleSize:a,in:l,onExited:f,timeout:n}=s,[c,d]=et.useState(!1),y=de(t,i.ripple,i.rippleVisible,r&&i.ripplePulsate),p={width:a,height:a,top:-(a/2)+o,left:-(a/2)+e},g=de(i.child,c&&i.childLeaving,r&&i.childPulsate);return!l&&!c&&d(!0),et.useEffect(()=>{if(!l&&f!=null){const b=setTimeout(f,n);return()=>{clearTimeout(b)}}},[f,l,n]),it.jsx("span",{className:y,style:p,children:it.jsx("span",{className:g})})}const Fn=xi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),eb=550,o9=80,c9=cf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,u9=cf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,l9=cf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,d9=ke("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),f9=ke(s9,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Fn.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${c9};
    animation-duration: ${eb}ms;
    animation-timing-function: ${({theme:s})=>s.transitions.easing.easeInOut};
  }

  &.${Fn.ripplePulsate} {
    animation-duration: ${({theme:s})=>s.transitions.duration.shorter}ms;
  }

  & .${Fn.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Fn.childLeaving} {
    opacity: 0;
    animation-name: ${u9};
    animation-duration: ${eb}ms;
    animation-timing-function: ${({theme:s})=>s.transitions.easing.easeInOut};
  }

  & .${Fn.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${l9};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:s})=>s.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,h9=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiTouchRipple"}),{center:e=!1,classes:o={},className:a,...l}=r,[f,n]=et.useState([]),c=et.useRef(0),d=et.useRef(null);et.useEffect(()=>{d.current&&(d.current(),d.current=null)},[f]);const y=et.useRef(!1),p=Qc(),g=et.useRef(null),b=et.useRef(null),w=et.useCallback(T=>{const{pulsate:I,rippleX:k,rippleY:O,rippleSize:A,cb:R}=T;n(P=>[...P,it.jsx(f9,{classes:{ripple:de(o.ripple,Fn.ripple),rippleVisible:de(o.rippleVisible,Fn.rippleVisible),ripplePulsate:de(o.ripplePulsate,Fn.ripplePulsate),child:de(o.child,Fn.child),childLeaving:de(o.childLeaving,Fn.childLeaving),childPulsate:de(o.childPulsate,Fn.childPulsate)},timeout:eb,pulsate:I,rippleX:k,rippleY:O,rippleSize:A},c.current)]),c.current+=1,d.current=R},[o]),v=et.useCallback((T={},I={},k=()=>{})=>{const{pulsate:O=!1,center:A=e||I.pulsate,fakeElement:R=!1}=I;if((T==null?void 0:T.type)==="mousedown"&&y.current){y.current=!1;return}(T==null?void 0:T.type)==="touchstart"&&(y.current=!0);const P=R?null:b.current,C=P?P.getBoundingClientRect():{width:0,height:0,left:0,top:0};let N,D,U;if(A||T===void 0||T.clientX===0&&T.clientY===0||!T.clientX&&!T.touches)N=Math.round(C.width/2),D=Math.round(C.height/2);else{const{clientX:F,clientY:L}=T.touches&&T.touches.length>0?T.touches[0]:T;N=Math.round(F-C.left),D=Math.round(L-C.top)}if(A)U=Math.sqrt((2*C.width**2+C.height**2)/3),U%2===0&&(U+=1);else{const F=Math.max(Math.abs((P?P.clientWidth:0)-N),N)*2+2,L=Math.max(Math.abs((P?P.clientHeight:0)-D),D)*2+2;U=Math.sqrt(F**2+L**2)}T!=null&&T.touches?g.current===null&&(g.current=()=>{w({pulsate:O,rippleX:N,rippleY:D,rippleSize:U,cb:k})},p.start(o9,()=>{g.current&&(g.current(),g.current=null)})):w({pulsate:O,rippleX:N,rippleY:D,rippleSize:U,cb:k})},[e,w,p]),_=et.useCallback(()=>{v({},{pulsate:!0})},[v]),S=et.useCallback((T,I)=>{if(p.clear(),(T==null?void 0:T.type)==="touchend"&&g.current){g.current(),g.current=null,p.start(0,()=>{S(T,I)});return}g.current=null,n(k=>k.length>0?k.slice(1):k),d.current=I},[p]);return et.useImperativeHandle(i,()=>({pulsate:_,start:v,stop:S}),[_,v,S]),it.jsx(d9,{className:de(Fn.root,o.root,a),ref:b,...l,children:it.jsx(Zb,{component:null,exit:!0,children:f})})});function p9(s){return yi("MuiButtonBase",s)}const y9=xi("MuiButtonBase",["root","disabled","focusVisible"]),g9=s=>{const{disabled:t,focusVisible:i,focusVisibleClassName:r,classes:e}=s,a=_i({root:["root",t&&"disabled",i&&"focusVisible"]},p9,e);return i&&r&&(a.root+=` ${r}`),a},m9=ke("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(s,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${y9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Up=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiButtonBase"}),{action:e,centerRipple:o=!1,children:a,className:l,component:f="button",disabled:n=!1,disableRipple:c=!1,disableTouchRipple:d=!1,focusRipple:y=!1,focusVisibleClassName:p,LinkComponent:g="a",onBlur:b,onClick:w,onContextMenu:v,onDragLeave:_,onFocus:S,onFocusVisible:T,onKeyDown:I,onKeyUp:k,onMouseDown:O,onMouseLeave:A,onMouseUp:R,onTouchEnd:P,onTouchMove:C,onTouchStart:N,tabIndex:D=0,TouchRippleProps:U,touchRippleRef:F,type:L,...j}=r,V=et.useRef(null),W=r9(),q=Zi(W.ref,F),[$,Y]=et.useState(!1);n&&$&&Y(!1),et.useImperativeHandle(e,()=>({focusVisible:()=>{Y(!0),V.current.focus()}}),[]);const Q=W.shouldMount&&!c&&!n;et.useEffect(()=>{$&&y&&!c&&W.pulsate()},[c,y,$,W]);const J=ia(W,"start",O,d),vt=ia(W,"stop",v,d),wt=ia(W,"stop",_,d),dt=ia(W,"stop",R,d),yt=ia(W,"stop",st=>{$&&st.preventDefault(),A&&A(st)},d),_t=ia(W,"start",N,d),tt=ia(W,"stop",P,d),xt=ia(W,"stop",C,d),It=ia(W,"stop",st=>{Bp(st.target)||Y(!1),b&&b(st)},!1),Nt=as(st=>{V.current||(V.current=st.currentTarget),Bp(st.target)&&(Y(!0),T&&T(st)),S&&S(st)}),Lt=()=>{const st=V.current;return f&&f!=="button"&&!(st.tagName==="A"&&st.href)},ne=as(st=>{y&&!st.repeat&&$&&st.key===" "&&W.stop(st,()=>{W.start(st)}),st.target===st.currentTarget&&Lt()&&st.key===" "&&st.preventDefault(),I&&I(st),st.target===st.currentTarget&&Lt()&&st.key==="Enter"&&!n&&(st.preventDefault(),w&&w(st))}),Ut=as(st=>{y&&st.key===" "&&$&&!st.defaultPrevented&&W.stop(st,()=>{W.pulsate(st)}),k&&k(st),w&&st.target===st.currentTarget&&Lt()&&st.key===" "&&!st.defaultPrevented&&w(st)});let Vt=f;Vt==="button"&&(j.href||j.to)&&(Vt=g);const Jt={};Vt==="button"?(Jt.type=L===void 0?"button":L,Jt.disabled=n):(!j.href&&!j.to&&(Jt.role="button"),n&&(Jt["aria-disabled"]=n));const Ct=Zi(i,V),K={...r,centerRipple:o,component:f,disabled:n,disableRipple:c,disableTouchRipple:d,focusRipple:y,tabIndex:D,focusVisible:$},ut=g9(K);return it.jsxs(m9,{as:Vt,className:de(ut.root,l),ownerState:K,onBlur:It,onClick:w,onContextMenu:vt,onFocus:Nt,onKeyDown:ne,onKeyUp:Ut,onMouseDown:J,onMouseLeave:yt,onMouseUp:dt,onDragLeave:wt,onTouchEnd:tt,onTouchMove:xt,onTouchStart:_t,ref:Ct,tabIndex:n?-1:D,type:L,...Jt,...j,children:[a,Q?it.jsx(h9,{ref:q,center:o,...U}):null]})});function ia(s,t,i,r=!1){return as(e=>(i&&i(e),r||s[t](e),!0))}function b9(s){return typeof s.main=="string"}function w9(s,t=[]){if(!b9(s))return!1;for(const i of t)if(!s.hasOwnProperty(i)||typeof s[i]!="string")return!1;return!0}function rs(s=[]){return([,t])=>t&&w9(t,s)}function v9(s){return yi("MuiCircularProgress",s)}xi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Qa=44,ib=cf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,nb=cf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,x9=typeof ib!="string"?Fb`
        animation: ${ib} 1.4s linear infinite;
      `:null,_9=typeof nb!="string"?Fb`
        animation: ${nb} 1.4s ease-in-out infinite;
      `:null,S9=s=>{const{classes:t,variant:i,color:r,disableShrink:e}=s,o={root:["root",i,`color${zt(r)}`],svg:["svg"],circle:["circle",`circle${zt(i)}`,e&&"circleDisableShrink"]};return _i(o,v9,t)},T9=ke("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,t[i.variant],t[`color${zt(i.color)}`]]}})(Ri(({theme:s})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:s.transitions.create("transform")}},{props:{variant:"indeterminate"},style:x9||{animation:`${ib} 1.4s linear infinite`}},...Object.entries(s.palette).filter(rs()).map(([t])=>({props:{color:t},style:{color:(s.vars||s).palette[t].main}}))]}))),I9=ke("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(s,t)=>t.svg})({display:"block"}),k9=ke("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.circle,t[`circle${zt(i.variant)}`],i.disableShrink&&t.circleDisableShrink]}})(Ri(({theme:s})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:s.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:_9||{animation:`${nb} 1.4s ease-in-out infinite`}}]}))),E9=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiCircularProgress"}),{className:e,color:o="primary",disableShrink:a=!1,size:l=40,style:f,thickness:n=3.6,value:c=0,variant:d="indeterminate",...y}=r,p={...r,color:o,disableShrink:a,size:l,thickness:n,value:c,variant:d},g=S9(p),b={},w={},v={};if(d==="determinate"){const _=2*Math.PI*((Qa-n)/2);b.strokeDasharray=_.toFixed(3),v["aria-valuenow"]=Math.round(c),b.strokeDashoffset=`${((100-c)/100*_).toFixed(3)}px`,w.transform="rotate(-90deg)"}return it.jsx(T9,{className:de(g.root,e),style:{width:l,height:l,...w,...f},ownerState:p,ref:i,role:"progressbar",...v,...y,children:it.jsx(I9,{className:g.svg,ownerState:p,viewBox:`${Qa/2} ${Qa/2} ${Qa} ${Qa}`,children:it.jsx(k9,{className:g.circle,style:b,ownerState:p,cx:Qa,cy:Qa,r:(Qa-n)/2,fill:"none",strokeWidth:n})})})});function O9(s){return yi("MuiIconButton",s)}const e_=xi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),A9=s=>{const{classes:t,disabled:i,color:r,edge:e,size:o,loading:a}=s,l={root:["root",a&&"loading",i&&"disabled",r!=="default"&&`color${zt(r)}`,e&&`edge${zt(e)}`,`size${zt(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return _i(l,O9,t)},P9=ke(Up,{name:"MuiIconButton",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,i.loading&&t.loading,i.color!=="default"&&t[`color${zt(i.color)}`],i.edge&&t[`edge${zt(i.edge)}`],t[`size${zt(i.size)}`]]}})(Ri(({theme:s})=>({textAlign:"center",flex:"0 0 auto",fontSize:s.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(s.vars||s).palette.action.active,transition:s.transitions.create("background-color",{duration:s.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":s.vars?`rgba(${s.vars.palette.action.activeChannel} / ${s.vars.palette.action.hoverOpacity})`:Pi(s.palette.action.active,s.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Ri(({theme:s})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(s.palette).filter(rs()).map(([t])=>({props:{color:t},style:{color:(s.vars||s).palette[t].main}})),...Object.entries(s.palette).filter(rs()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":s.vars?`rgba(${(s.vars||s).palette[t].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:Pi((s.vars||s).palette[t].main,s.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:s.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:s.typography.pxToRem(28)}}],[`&.${e_.disabled}`]:{backgroundColor:"transparent",color:(s.vars||s).palette.action.disabled},[`&.${e_.loading}`]:{color:"transparent"}}))),R9=ke("span",{name:"MuiIconButton",slot:"LoadingIndicator",overridesResolver:(s,t)=>t.loadingIndicator})(({theme:s})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(s.vars||s).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),eu=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiIconButton"}),{edge:e=!1,children:o,className:a,color:l="default",disabled:f=!1,disableFocusRipple:n=!1,size:c="medium",id:d,loading:y=null,loadingIndicator:p,...g}=r,b=z8(d),w=p??it.jsx(E9,{"aria-labelledby":b,color:"inherit",size:16}),v={...r,edge:e,color:l,disabled:f,disableFocusRipple:n,loading:y,loadingIndicator:w,size:c},_=A9(v);return it.jsxs(P9,{id:y?b:d,className:de(_.root,a),centerRipple:!0,focusRipple:!n,disabled:f||y,ref:i,...g,ownerState:v,children:[typeof y=="boolean"&&it.jsx("span",{className:_.loadingWrapper,style:{display:"contents"},children:it.jsx(R9,{className:_.loadingIndicator,ownerState:v,children:y&&w})}),o]})});function M9(s){return yi("MuiTypography",s)}xi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const N9={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},C9=H7(),D9=s=>{const{align:t,gutterBottom:i,noWrap:r,paragraph:e,variant:o,classes:a}=s,l={root:["root",o,s.align!=="inherit"&&`align${zt(t)}`,i&&"gutterBottom",r&&"noWrap",e&&"paragraph"]};return _i(l,M9,a)},B9=ke("span",{name:"MuiTypography",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,i.variant&&t[i.variant],i.align!=="inherit"&&t[`align${zt(i.align)}`],i.noWrap&&t.noWrap,i.gutterBottom&&t.gutterBottom,i.paragraph&&t.paragraph]}})(Ri(({theme:s})=>{var t;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(s.typography).filter(([i,r])=>i!=="inherit"&&r&&typeof r=="object").map(([i,r])=>({props:{variant:i},style:r})),...Object.entries(s.palette).filter(rs()).map(([i])=>({props:{color:i},style:{color:(s.vars||s).palette[i].main}})),...Object.entries(((t=s.palette)==null?void 0:t.text)||{}).filter(([,i])=>typeof i=="string").map(([i])=>({props:{color:`text${zt(i)}`},style:{color:(s.vars||s).palette.text[i]}})),{props:({ownerState:i})=>i.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:i})=>i.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:i})=>i.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:i})=>i.paragraph,style:{marginBottom:16}}]}})),i_={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},ni=et.forwardRef(function(t,i){const{color:r,...e}=ci({props:t,name:"MuiTypography"}),o=!N9[r],a=C9({...e,...o&&{color:r}}),{align:l="inherit",className:f,component:n,gutterBottom:c=!1,noWrap:d=!1,paragraph:y=!1,variant:p="body1",variantMapping:g=i_,...b}=a,w={...a,align:l,color:r,className:f,component:n,gutterBottom:c,noWrap:d,paragraph:y,variant:p,variantMapping:g},v=n||(y?"p":g[p]||i_[p])||"span",_=D9(w);return it.jsx(B9,{as:v,ref:i,className:de(_.root,f),...b,ownerState:w,style:{...l!=="inherit"&&{"--Typography-textAlign":l},...b.style}})});var Xi="top",Hn="bottom",Kn="right",Gi="left",t1="auto",hf=[Xi,Hn,Kn,Gi],cu="start",tf="end",F9="clippingParents",yT="viewport",bl="popper",L9="reference",n_=hf.reduce(function(s,t){return s.concat([t+"-"+cu,t+"-"+tf])},[]),gT=[].concat(hf,[t1]).reduce(function(s,t){return s.concat([t,t+"-"+cu,t+"-"+tf])},[]),U9="beforeRead",q9="read",j9="afterRead",H9="beforeMain",K9="main",V9="afterMain",W9="beforeWrite",$9="write",z9="afterWrite",X9=[U9,q9,j9,H9,K9,V9,W9,$9,z9];function Pr(s){return s?(s.nodeName||"").toLowerCase():null}function yn(s){if(s==null)return window;if(s.toString()!=="[object Window]"){var t=s.ownerDocument;return t&&t.defaultView||window}return s}function To(s){var t=yn(s).Element;return s instanceof t||s instanceof Element}function qn(s){var t=yn(s).HTMLElement;return s instanceof t||s instanceof HTMLElement}function e1(s){if(typeof ShadowRoot>"u")return!1;var t=yn(s).ShadowRoot;return s instanceof t||s instanceof ShadowRoot}function G9(s){var t=s.state;Object.keys(t.elements).forEach(function(i){var r=t.styles[i]||{},e=t.attributes[i]||{},o=t.elements[i];!qn(o)||!Pr(o)||(Object.assign(o.style,r),Object.keys(e).forEach(function(a){var l=e[a];l===!1?o.removeAttribute(a):o.setAttribute(a,l===!0?"":l)}))})}function Y9(s){var t=s.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(r){var e=t.elements[r],o=t.attributes[r]||{},a=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:i[r]),l=a.reduce(function(f,n){return f[n]="",f},{});!qn(e)||!Pr(e)||(Object.assign(e.style,l),Object.keys(o).forEach(function(f){e.removeAttribute(f)}))})}}const Q9={name:"applyStyles",enabled:!0,phase:"write",fn:G9,effect:Y9,requires:["computeStyles"]};function kr(s){return s.split("-")[0]}var xo=Math.max,qp=Math.min,uu=Math.round;function rb(){var s=navigator.userAgentData;return s!=null&&s.brands&&Array.isArray(s.brands)?s.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function mT(){return!/^((?!chrome|android).)*safari/i.test(rb())}function lu(s,t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r=s.getBoundingClientRect(),e=1,o=1;t&&qn(s)&&(e=s.offsetWidth>0&&uu(r.width)/s.offsetWidth||1,o=s.offsetHeight>0&&uu(r.height)/s.offsetHeight||1);var a=To(s)?yn(s):window,l=a.visualViewport,f=!mT()&&i,n=(r.left+(f&&l?l.offsetLeft:0))/e,c=(r.top+(f&&l?l.offsetTop:0))/o,d=r.width/e,y=r.height/o;return{width:d,height:y,top:c,right:n+d,bottom:c+y,left:n,x:n,y:c}}function i1(s){var t=lu(s),i=s.offsetWidth,r=s.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:s.offsetLeft,y:s.offsetTop,width:i,height:r}}function bT(s,t){var i=t.getRootNode&&t.getRootNode();if(s.contains(t))return!0;if(i&&e1(i)){var r=t;do{if(r&&s.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ta(s){return yn(s).getComputedStyle(s)}function Z9(s){return["table","td","th"].indexOf(Pr(s))>=0}function hs(s){return((To(s)?s.ownerDocument:s.document)||window.document).documentElement}function f0(s){return Pr(s)==="html"?s:s.assignedSlot||s.parentNode||(e1(s)?s.host:null)||hs(s)}function r_(s){return!qn(s)||Ta(s).position==="fixed"?null:s.offsetParent}function J9(s){var t=/firefox/i.test(rb()),i=/Trident/i.test(rb());if(i&&qn(s)){var r=Ta(s);if(r.position==="fixed")return null}var e=f0(s);for(e1(e)&&(e=e.host);qn(e)&&["html","body"].indexOf(Pr(e))<0;){var o=Ta(e);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return e;e=e.parentNode}return null}function pf(s){for(var t=yn(s),i=r_(s);i&&Z9(i)&&Ta(i).position==="static";)i=r_(i);return i&&(Pr(i)==="html"||Pr(i)==="body"&&Ta(i).position==="static")?t:i||J9(s)||t}function n1(s){return["top","bottom"].indexOf(s)>=0?"x":"y"}function zd(s,t,i){return xo(s,qp(t,i))}function tR(s,t,i){var r=zd(s,t,i);return r>i?i:r}function wT(){return{top:0,right:0,bottom:0,left:0}}function vT(s){return Object.assign({},wT(),s)}function xT(s,t){return t.reduce(function(i,r){return i[r]=s,i},{})}var eR=function(t,i){return t=typeof t=="function"?t(Object.assign({},i.rects,{placement:i.placement})):t,vT(typeof t!="number"?t:xT(t,hf))};function iR(s){var t,i=s.state,r=s.name,e=s.options,o=i.elements.arrow,a=i.modifiersData.popperOffsets,l=kr(i.placement),f=n1(l),n=[Gi,Kn].indexOf(l)>=0,c=n?"height":"width";if(!(!o||!a)){var d=eR(e.padding,i),y=i1(o),p=f==="y"?Xi:Gi,g=f==="y"?Hn:Kn,b=i.rects.reference[c]+i.rects.reference[f]-a[f]-i.rects.popper[c],w=a[f]-i.rects.reference[f],v=pf(o),_=v?f==="y"?v.clientHeight||0:v.clientWidth||0:0,S=b/2-w/2,T=d[p],I=_-y[c]-d[g],k=_/2-y[c]/2+S,O=zd(T,k,I),A=f;i.modifiersData[r]=(t={},t[A]=O,t.centerOffset=O-k,t)}}function nR(s){var t=s.state,i=s.options,r=i.element,e=r===void 0?"[data-popper-arrow]":r;e!=null&&(typeof e=="string"&&(e=t.elements.popper.querySelector(e),!e)||bT(t.elements.popper,e)&&(t.elements.arrow=e))}const rR={name:"arrow",enabled:!0,phase:"main",fn:iR,effect:nR,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function du(s){return s.split("-")[1]}var aR={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sR(s,t){var i=s.x,r=s.y,e=t.devicePixelRatio||1;return{x:uu(i*e)/e||0,y:uu(r*e)/e||0}}function a_(s){var t,i=s.popper,r=s.popperRect,e=s.placement,o=s.variation,a=s.offsets,l=s.position,f=s.gpuAcceleration,n=s.adaptive,c=s.roundOffsets,d=s.isFixed,y=a.x,p=y===void 0?0:y,g=a.y,b=g===void 0?0:g,w=typeof c=="function"?c({x:p,y:b}):{x:p,y:b};p=w.x,b=w.y;var v=a.hasOwnProperty("x"),_=a.hasOwnProperty("y"),S=Gi,T=Xi,I=window;if(n){var k=pf(i),O="clientHeight",A="clientWidth";if(k===yn(i)&&(k=hs(i),Ta(k).position!=="static"&&l==="absolute"&&(O="scrollHeight",A="scrollWidth")),k=k,e===Xi||(e===Gi||e===Kn)&&o===tf){T=Hn;var R=d&&k===I&&I.visualViewport?I.visualViewport.height:k[O];b-=R-r.height,b*=f?1:-1}if(e===Gi||(e===Xi||e===Hn)&&o===tf){S=Kn;var P=d&&k===I&&I.visualViewport?I.visualViewport.width:k[A];p-=P-r.width,p*=f?1:-1}}var C=Object.assign({position:l},n&&aR),N=c===!0?sR({x:p,y:b},yn(i)):{x:p,y:b};if(p=N.x,b=N.y,f){var D;return Object.assign({},C,(D={},D[T]=_?"0":"",D[S]=v?"0":"",D.transform=(I.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",D))}return Object.assign({},C,(t={},t[T]=_?b+"px":"",t[S]=v?p+"px":"",t.transform="",t))}function oR(s){var t=s.state,i=s.options,r=i.gpuAcceleration,e=r===void 0?!0:r,o=i.adaptive,a=o===void 0?!0:o,l=i.roundOffsets,f=l===void 0?!0:l,n={placement:kr(t.placement),variation:du(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:e,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,a_(Object.assign({},n,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:f})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,a_(Object.assign({},n,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const cR={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:oR,data:{}};var Fh={passive:!0};function uR(s){var t=s.state,i=s.instance,r=s.options,e=r.scroll,o=e===void 0?!0:e,a=r.resize,l=a===void 0?!0:a,f=yn(t.elements.popper),n=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&n.forEach(function(c){c.addEventListener("scroll",i.update,Fh)}),l&&f.addEventListener("resize",i.update,Fh),function(){o&&n.forEach(function(c){c.removeEventListener("scroll",i.update,Fh)}),l&&f.removeEventListener("resize",i.update,Fh)}}const lR={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:uR,data:{}};var dR={left:"right",right:"left",bottom:"top",top:"bottom"};function Ep(s){return s.replace(/left|right|bottom|top/g,function(t){return dR[t]})}var fR={start:"end",end:"start"};function s_(s){return s.replace(/start|end/g,function(t){return fR[t]})}function r1(s){var t=yn(s),i=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:i,scrollTop:r}}function a1(s){return lu(hs(s)).left+r1(s).scrollLeft}function hR(s,t){var i=yn(s),r=hs(s),e=i.visualViewport,o=r.clientWidth,a=r.clientHeight,l=0,f=0;if(e){o=e.width,a=e.height;var n=mT();(n||!n&&t==="fixed")&&(l=e.offsetLeft,f=e.offsetTop)}return{width:o,height:a,x:l+a1(s),y:f}}function pR(s){var t,i=hs(s),r=r1(s),e=(t=s.ownerDocument)==null?void 0:t.body,o=xo(i.scrollWidth,i.clientWidth,e?e.scrollWidth:0,e?e.clientWidth:0),a=xo(i.scrollHeight,i.clientHeight,e?e.scrollHeight:0,e?e.clientHeight:0),l=-r.scrollLeft+a1(s),f=-r.scrollTop;return Ta(e||i).direction==="rtl"&&(l+=xo(i.clientWidth,e?e.clientWidth:0)-o),{width:o,height:a,x:l,y:f}}function s1(s){var t=Ta(s),i=t.overflow,r=t.overflowX,e=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+e+r)}function _T(s){return["html","body","#document"].indexOf(Pr(s))>=0?s.ownerDocument.body:qn(s)&&s1(s)?s:_T(f0(s))}function Xd(s,t){var i;t===void 0&&(t=[]);var r=_T(s),e=r===((i=s.ownerDocument)==null?void 0:i.body),o=yn(r),a=e?[o].concat(o.visualViewport||[],s1(r)?r:[]):r,l=t.concat(a);return e?l:l.concat(Xd(f0(a)))}function ab(s){return Object.assign({},s,{left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})}function yR(s,t){var i=lu(s,!1,t==="fixed");return i.top=i.top+s.clientTop,i.left=i.left+s.clientLeft,i.bottom=i.top+s.clientHeight,i.right=i.left+s.clientWidth,i.width=s.clientWidth,i.height=s.clientHeight,i.x=i.left,i.y=i.top,i}function o_(s,t,i){return t===yT?ab(hR(s,i)):To(t)?yR(t,i):ab(pR(hs(s)))}function gR(s){var t=Xd(f0(s)),i=["absolute","fixed"].indexOf(Ta(s).position)>=0,r=i&&qn(s)?pf(s):s;return To(r)?t.filter(function(e){return To(e)&&bT(e,r)&&Pr(e)!=="body"}):[]}function mR(s,t,i,r){var e=t==="clippingParents"?gR(s):[].concat(t),o=[].concat(e,[i]),a=o[0],l=o.reduce(function(f,n){var c=o_(s,n,r);return f.top=xo(c.top,f.top),f.right=qp(c.right,f.right),f.bottom=qp(c.bottom,f.bottom),f.left=xo(c.left,f.left),f},o_(s,a,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function ST(s){var t=s.reference,i=s.element,r=s.placement,e=r?kr(r):null,o=r?du(r):null,a=t.x+t.width/2-i.width/2,l=t.y+t.height/2-i.height/2,f;switch(e){case Xi:f={x:a,y:t.y-i.height};break;case Hn:f={x:a,y:t.y+t.height};break;case Kn:f={x:t.x+t.width,y:l};break;case Gi:f={x:t.x-i.width,y:l};break;default:f={x:t.x,y:t.y}}var n=e?n1(e):null;if(n!=null){var c=n==="y"?"height":"width";switch(o){case cu:f[n]=f[n]-(t[c]/2-i[c]/2);break;case tf:f[n]=f[n]+(t[c]/2-i[c]/2);break}}return f}function ef(s,t){t===void 0&&(t={});var i=t,r=i.placement,e=r===void 0?s.placement:r,o=i.strategy,a=o===void 0?s.strategy:o,l=i.boundary,f=l===void 0?F9:l,n=i.rootBoundary,c=n===void 0?yT:n,d=i.elementContext,y=d===void 0?bl:d,p=i.altBoundary,g=p===void 0?!1:p,b=i.padding,w=b===void 0?0:b,v=vT(typeof w!="number"?w:xT(w,hf)),_=y===bl?L9:bl,S=s.rects.popper,T=s.elements[g?_:y],I=mR(To(T)?T:T.contextElement||hs(s.elements.popper),f,c,a),k=lu(s.elements.reference),O=ST({reference:k,element:S,placement:e}),A=ab(Object.assign({},S,O)),R=y===bl?A:k,P={top:I.top-R.top+v.top,bottom:R.bottom-I.bottom+v.bottom,left:I.left-R.left+v.left,right:R.right-I.right+v.right},C=s.modifiersData.offset;if(y===bl&&C){var N=C[e];Object.keys(P).forEach(function(D){var U=[Kn,Hn].indexOf(D)>=0?1:-1,F=[Xi,Hn].indexOf(D)>=0?"y":"x";P[D]+=N[F]*U})}return P}function bR(s,t){t===void 0&&(t={});var i=t,r=i.placement,e=i.boundary,o=i.rootBoundary,a=i.padding,l=i.flipVariations,f=i.allowedAutoPlacements,n=f===void 0?gT:f,c=du(r),d=c?l?n_:n_.filter(function(g){return du(g)===c}):hf,y=d.filter(function(g){return n.indexOf(g)>=0});y.length===0&&(y=d);var p=y.reduce(function(g,b){return g[b]=ef(s,{placement:b,boundary:e,rootBoundary:o,padding:a})[kr(b)],g},{});return Object.keys(p).sort(function(g,b){return p[g]-p[b]})}function wR(s){if(kr(s)===t1)return[];var t=Ep(s);return[s_(s),t,s_(t)]}function vR(s){var t=s.state,i=s.options,r=s.name;if(!t.modifiersData[r]._skip){for(var e=i.mainAxis,o=e===void 0?!0:e,a=i.altAxis,l=a===void 0?!0:a,f=i.fallbackPlacements,n=i.padding,c=i.boundary,d=i.rootBoundary,y=i.altBoundary,p=i.flipVariations,g=p===void 0?!0:p,b=i.allowedAutoPlacements,w=t.options.placement,v=kr(w),_=v===w,S=f||(_||!g?[Ep(w)]:wR(w)),T=[w].concat(S).reduce(function(J,vt){return J.concat(kr(vt)===t1?bR(t,{placement:vt,boundary:c,rootBoundary:d,padding:n,flipVariations:g,allowedAutoPlacements:b}):vt)},[]),I=t.rects.reference,k=t.rects.popper,O=new Map,A=!0,R=T[0],P=0;P<T.length;P++){var C=T[P],N=kr(C),D=du(C)===cu,U=[Xi,Hn].indexOf(N)>=0,F=U?"width":"height",L=ef(t,{placement:C,boundary:c,rootBoundary:d,altBoundary:y,padding:n}),j=U?D?Kn:Gi:D?Hn:Xi;I[F]>k[F]&&(j=Ep(j));var V=Ep(j),W=[];if(o&&W.push(L[N]<=0),l&&W.push(L[j]<=0,L[V]<=0),W.every(function(J){return J})){R=C,A=!1;break}O.set(C,W)}if(A)for(var q=g?3:1,$=function(vt){var wt=T.find(function(dt){var yt=O.get(dt);if(yt)return yt.slice(0,vt).every(function(_t){return _t})});if(wt)return R=wt,"break"},Y=q;Y>0;Y--){var Q=$(Y);if(Q==="break")break}t.placement!==R&&(t.modifiersData[r]._skip=!0,t.placement=R,t.reset=!0)}}const xR={name:"flip",enabled:!0,phase:"main",fn:vR,requiresIfExists:["offset"],data:{_skip:!1}};function c_(s,t,i){return i===void 0&&(i={x:0,y:0}),{top:s.top-t.height-i.y,right:s.right-t.width+i.x,bottom:s.bottom-t.height+i.y,left:s.left-t.width-i.x}}function u_(s){return[Xi,Kn,Hn,Gi].some(function(t){return s[t]>=0})}function _R(s){var t=s.state,i=s.name,r=t.rects.reference,e=t.rects.popper,o=t.modifiersData.preventOverflow,a=ef(t,{elementContext:"reference"}),l=ef(t,{altBoundary:!0}),f=c_(a,r),n=c_(l,e,o),c=u_(f),d=u_(n);t.modifiersData[i]={referenceClippingOffsets:f,popperEscapeOffsets:n,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}const SR={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:_R};function TR(s,t,i){var r=kr(s),e=[Gi,Xi].indexOf(r)>=0?-1:1,o=typeof i=="function"?i(Object.assign({},t,{placement:s})):i,a=o[0],l=o[1];return a=a||0,l=(l||0)*e,[Gi,Kn].indexOf(r)>=0?{x:l,y:a}:{x:a,y:l}}function IR(s){var t=s.state,i=s.options,r=s.name,e=i.offset,o=e===void 0?[0,0]:e,a=gT.reduce(function(c,d){return c[d]=TR(d,t.rects,o),c},{}),l=a[t.placement],f=l.x,n=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=f,t.modifiersData.popperOffsets.y+=n),t.modifiersData[r]=a}const kR={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:IR};function ER(s){var t=s.state,i=s.name;t.modifiersData[i]=ST({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const OR={name:"popperOffsets",enabled:!0,phase:"read",fn:ER,data:{}};function AR(s){return s==="x"?"y":"x"}function PR(s){var t=s.state,i=s.options,r=s.name,e=i.mainAxis,o=e===void 0?!0:e,a=i.altAxis,l=a===void 0?!1:a,f=i.boundary,n=i.rootBoundary,c=i.altBoundary,d=i.padding,y=i.tether,p=y===void 0?!0:y,g=i.tetherOffset,b=g===void 0?0:g,w=ef(t,{boundary:f,rootBoundary:n,padding:d,altBoundary:c}),v=kr(t.placement),_=du(t.placement),S=!_,T=n1(v),I=AR(T),k=t.modifiersData.popperOffsets,O=t.rects.reference,A=t.rects.popper,R=typeof b=="function"?b(Object.assign({},t.rects,{placement:t.placement})):b,P=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),C=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,N={x:0,y:0};if(k){if(o){var D,U=T==="y"?Xi:Gi,F=T==="y"?Hn:Kn,L=T==="y"?"height":"width",j=k[T],V=j+w[U],W=j-w[F],q=p?-A[L]/2:0,$=_===cu?O[L]:A[L],Y=_===cu?-A[L]:-O[L],Q=t.elements.arrow,J=p&&Q?i1(Q):{width:0,height:0},vt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:wT(),wt=vt[U],dt=vt[F],yt=zd(0,O[L],J[L]),_t=S?O[L]/2-q-yt-wt-P.mainAxis:$-yt-wt-P.mainAxis,tt=S?-O[L]/2+q+yt+dt+P.mainAxis:Y+yt+dt+P.mainAxis,xt=t.elements.arrow&&pf(t.elements.arrow),It=xt?T==="y"?xt.clientTop||0:xt.clientLeft||0:0,Nt=(D=C==null?void 0:C[T])!=null?D:0,Lt=j+_t-Nt-It,ne=j+tt-Nt,Ut=zd(p?qp(V,Lt):V,j,p?xo(W,ne):W);k[T]=Ut,N[T]=Ut-j}if(l){var Vt,Jt=T==="x"?Xi:Gi,Ct=T==="x"?Hn:Kn,K=k[I],ut=I==="y"?"height":"width",st=K+w[Jt],Mt=K-w[Ct],Ht=[Xi,Gi].indexOf(v)!==-1,Kt=(Vt=C==null?void 0:C[I])!=null?Vt:0,Xt=Ht?st:K-O[ut]-A[ut]-Kt+P.altAxis,Qt=Ht?K+O[ut]+A[ut]-Kt-P.altAxis:Mt,Ft=p&&Ht?tR(Xt,K,Qt):zd(p?Xt:st,K,p?Qt:Mt);k[I]=Ft,N[I]=Ft-K}t.modifiersData[r]=N}}const RR={name:"preventOverflow",enabled:!0,phase:"main",fn:PR,requiresIfExists:["offset"]};function MR(s){return{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}}function NR(s){return s===yn(s)||!qn(s)?r1(s):MR(s)}function CR(s){var t=s.getBoundingClientRect(),i=uu(t.width)/s.offsetWidth||1,r=uu(t.height)/s.offsetHeight||1;return i!==1||r!==1}function DR(s,t,i){i===void 0&&(i=!1);var r=qn(t),e=qn(t)&&CR(t),o=hs(t),a=lu(s,e,i),l={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(r||!r&&!i)&&((Pr(t)!=="body"||s1(o))&&(l=NR(t)),qn(t)?(f=lu(t,!0),f.x+=t.clientLeft,f.y+=t.clientTop):o&&(f.x=a1(o))),{x:a.left+l.scrollLeft-f.x,y:a.top+l.scrollTop-f.y,width:a.width,height:a.height}}function BR(s){var t=new Map,i=new Set,r=[];s.forEach(function(o){t.set(o.name,o)});function e(o){i.add(o.name);var a=[].concat(o.requires||[],o.requiresIfExists||[]);a.forEach(function(l){if(!i.has(l)){var f=t.get(l);f&&e(f)}}),r.push(o)}return s.forEach(function(o){i.has(o.name)||e(o)}),r}function FR(s){var t=BR(s);return X9.reduce(function(i,r){return i.concat(t.filter(function(e){return e.phase===r}))},[])}function LR(s){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(s())})})),t}}function UR(s){var t=s.reduce(function(i,r){var e=i[r.name];return i[r.name]=e?Object.assign({},e,r,{options:Object.assign({},e.options,r.options),data:Object.assign({},e.data,r.data)}):r,i},{});return Object.keys(t).map(function(i){return t[i]})}var l_={placement:"bottom",modifiers:[],strategy:"absolute"};function d_(){for(var s=arguments.length,t=new Array(s),i=0;i<s;i++)t[i]=arguments[i];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function qR(s){s===void 0&&(s={});var t=s,i=t.defaultModifiers,r=i===void 0?[]:i,e=t.defaultOptions,o=e===void 0?l_:e;return function(l,f,n){n===void 0&&(n=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},l_,o),modifiersData:{},elements:{reference:l,popper:f},attributes:{},styles:{}},d=[],y=!1,p={state:c,setOptions:function(v){var _=typeof v=="function"?v(c.options):v;b(),c.options=Object.assign({},o,c.options,_),c.scrollParents={reference:To(l)?Xd(l):l.contextElement?Xd(l.contextElement):[],popper:Xd(f)};var S=FR(UR([].concat(r,c.options.modifiers)));return c.orderedModifiers=S.filter(function(T){return T.enabled}),g(),p.update()},forceUpdate:function(){if(!y){var v=c.elements,_=v.reference,S=v.popper;if(d_(_,S)){c.rects={reference:DR(_,pf(S),c.options.strategy==="fixed"),popper:i1(S)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(P){return c.modifiersData[P.name]=Object.assign({},P.data)});for(var T=0;T<c.orderedModifiers.length;T++){if(c.reset===!0){c.reset=!1,T=-1;continue}var I=c.orderedModifiers[T],k=I.fn,O=I.options,A=O===void 0?{}:O,R=I.name;typeof k=="function"&&(c=k({state:c,options:A,name:R,instance:p})||c)}}}},update:LR(function(){return new Promise(function(w){p.forceUpdate(),w(c)})}),destroy:function(){b(),y=!0}};if(!d_(l,f))return p;p.setOptions(n).then(function(w){!y&&n.onFirstUpdate&&n.onFirstUpdate(w)});function g(){c.orderedModifiers.forEach(function(w){var v=w.name,_=w.options,S=_===void 0?{}:_,T=w.effect;if(typeof T=="function"){var I=T({state:c,name:v,instance:p,options:S}),k=function(){};d.push(I||k)}})}function b(){d.forEach(function(w){return w()}),d=[]}return p}}var jR=[lR,OR,cR,Q9,kR,xR,RR,rR,SR],HR=qR({defaultModifiers:jR});function KR(s){return typeof s=="function"?s():s}const TT=et.forwardRef(function(t,i){const{children:r,container:e,disablePortal:o=!1}=t,[a,l]=et.useState(null),f=Zi(et.isValidElement(r)?pu(r):null,i);if(au(()=>{o||l(KR(e)||document.body)},[e,o]),au(()=>{if(a&&!o)return F2(i,a),()=>{F2(i,null)}},[i,a,o]),o){if(et.isValidElement(r)){const n={ref:f};return et.cloneElement(r,n)}return r}return a&&pT.createPortal(r,a)});function VR(s){return yi("MuiPopper",s)}xi("MuiPopper",["root"]);function WR(s,t){if(t==="ltr")return s;switch(s){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return s}}function sb(s){return typeof s=="function"?s():s}function $R(s){return s.nodeType!==void 0}const zR=s=>{const{classes:t}=s;return _i({root:["root"]},VR,t)},XR={},GR=et.forwardRef(function(t,i){const{anchorEl:r,children:e,direction:o,disablePortal:a,modifiers:l,open:f,placement:n,popperOptions:c,popperRef:d,slotProps:y={},slots:p={},TransitionProps:g,ownerState:b,...w}=t,v=et.useRef(null),_=Zi(v,i),S=et.useRef(null),T=Zi(S,d),I=et.useRef(T);au(()=>{I.current=T},[T]),et.useImperativeHandle(d,()=>S.current,[]);const k=WR(n,o),[O,A]=et.useState(k),[R,P]=et.useState(sb(r));et.useEffect(()=>{S.current&&S.current.forceUpdate()}),et.useEffect(()=>{r&&P(sb(r))},[r]),au(()=>{if(!R||!f)return;const F=V=>{A(V.placement)};let L=[{name:"preventOverflow",options:{altBoundary:a}},{name:"flip",options:{altBoundary:a}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:V})=>{F(V)}}];l!=null&&(L=L.concat(l)),c&&c.modifiers!=null&&(L=L.concat(c.modifiers));const j=HR(R,v.current,{placement:k,...c,modifiers:L});return I.current(j),()=>{j.destroy(),I.current(null)}},[R,a,l,f,c,k]);const C={placement:O};g!==null&&(C.TransitionProps=g);const N=zR(t),D=p.root??"div",U=xP({elementType:D,externalSlotProps:y.root,externalForwardedProps:w,additionalProps:{role:"tooltip",ref:_},ownerState:t,className:N.root});return it.jsx(D,{...U,children:typeof e=="function"?e(C):e})}),YR=et.forwardRef(function(t,i){const{anchorEl:r,children:e,container:o,direction:a="ltr",disablePortal:l=!1,keepMounted:f=!1,modifiers:n,open:c,placement:d="bottom",popperOptions:y=XR,popperRef:p,style:g,transition:b=!1,slotProps:w={},slots:v={},..._}=t,[S,T]=et.useState(!0),I=()=>{T(!1)},k=()=>{T(!0)};if(!f&&!c&&(!b||S))return null;let O;if(o)O=o;else if(r){const P=sb(r);O=P&&$R(P)?Sa(P).body:Sa(null).body}const A=!c&&f&&(!b||S)?"none":void 0,R=b?{in:c,onEnter:I,onExited:k}:void 0;return it.jsx(TT,{disablePortal:l,container:O,children:it.jsx(GR,{anchorEl:r,direction:a,disablePortal:l,modifiers:n,ref:i,open:b?!S:c,placement:d,popperOptions:y,popperRef:p,slotProps:w,slots:v,..._,style:{position:"fixed",top:0,left:0,display:A,...g},TransitionProps:R,children:e})})}),QR=ke(YR,{name:"MuiPopper",slot:"Root",overridesResolver:(s,t)=>t.root})({}),IT=et.forwardRef(function(t,i){const r=$b(),e=ci({props:t,name:"MuiPopper"}),{anchorEl:o,component:a,components:l,componentsProps:f,container:n,disablePortal:c,keepMounted:d,modifiers:y,open:p,placement:g,popperOptions:b,popperRef:w,transition:v,slots:_,slotProps:S,...T}=e,I=(_==null?void 0:_.root)??(l==null?void 0:l.Root),k={anchorEl:o,container:n,disablePortal:c,keepMounted:d,modifiers:y,open:p,placement:g,popperOptions:b,popperRef:w,transition:v,...T};return it.jsx(QR,{as:a,direction:r?"rtl":"ltr",slots:{root:I},slotProps:S??f,...k,ref:i})}),ZR=Ia(it.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function JR(s){return yi("MuiChip",s)}const ve=xi("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),tM=s=>{const{classes:t,disabled:i,size:r,color:e,iconColor:o,onDelete:a,clickable:l,variant:f}=s,n={root:["root",f,i&&"disabled",`size${zt(r)}`,`color${zt(e)}`,l&&"clickable",l&&`clickableColor${zt(e)}`,a&&"deletable",a&&`deletableColor${zt(e)}`,`${f}${zt(e)}`],label:["label",`label${zt(r)}`],avatar:["avatar",`avatar${zt(r)}`,`avatarColor${zt(e)}`],icon:["icon",`icon${zt(r)}`,`iconColor${zt(o)}`],deleteIcon:["deleteIcon",`deleteIcon${zt(r)}`,`deleteIconColor${zt(e)}`,`deleteIcon${zt(f)}Color${zt(e)}`]};return _i(n,JR,t)},eM=ke("div",{name:"MuiChip",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s,{color:r,iconColor:e,clickable:o,onDelete:a,size:l,variant:f}=i;return[{[`& .${ve.avatar}`]:t.avatar},{[`& .${ve.avatar}`]:t[`avatar${zt(l)}`]},{[`& .${ve.avatar}`]:t[`avatarColor${zt(r)}`]},{[`& .${ve.icon}`]:t.icon},{[`& .${ve.icon}`]:t[`icon${zt(l)}`]},{[`& .${ve.icon}`]:t[`iconColor${zt(e)}`]},{[`& .${ve.deleteIcon}`]:t.deleteIcon},{[`& .${ve.deleteIcon}`]:t[`deleteIcon${zt(l)}`]},{[`& .${ve.deleteIcon}`]:t[`deleteIconColor${zt(r)}`]},{[`& .${ve.deleteIcon}`]:t[`deleteIcon${zt(f)}Color${zt(r)}`]},t.root,t[`size${zt(l)}`],t[`color${zt(r)}`],o&&t.clickable,o&&r!=="default"&&t[`clickableColor${zt(r)})`],a&&t.deletable,a&&r!=="default"&&t[`deletableColor${zt(r)}`],t[f],t[`${f}${zt(r)}`]]}})(Ri(({theme:s})=>{const t=s.palette.mode==="light"?s.palette.grey[700]:s.palette.grey[300];return{maxWidth:"100%",fontFamily:s.typography.fontFamily,fontSize:s.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(s.vars||s).palette.text.primary,backgroundColor:(s.vars||s).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:s.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ve.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ve.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:s.vars?s.vars.palette.Chip.defaultAvatarColor:t,fontSize:s.typography.pxToRem(12)},[`& .${ve.avatarColorPrimary}`]:{color:(s.vars||s).palette.primary.contrastText,backgroundColor:(s.vars||s).palette.primary.dark},[`& .${ve.avatarColorSecondary}`]:{color:(s.vars||s).palette.secondary.contrastText,backgroundColor:(s.vars||s).palette.secondary.dark},[`& .${ve.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:s.typography.pxToRem(10)},[`& .${ve.icon}`]:{marginLeft:5,marginRight:-6},[`& .${ve.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:s.vars?`rgba(${s.vars.palette.text.primaryChannel} / 0.26)`:Pi(s.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:s.vars?`rgba(${s.vars.palette.text.primaryChannel} / 0.4)`:Pi(s.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${ve.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${ve.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(s.palette).filter(rs(["contrastText"])).map(([i])=>({props:{color:i},style:{backgroundColor:(s.vars||s).palette[i].main,color:(s.vars||s).palette[i].contrastText,[`& .${ve.deleteIcon}`]:{color:s.vars?`rgba(${s.vars.palette[i].contrastTextChannel} / 0.7)`:Pi(s.palette[i].contrastText,.7),"&:hover, &:active":{color:(s.vars||s).palette[i].contrastText}}}})),{props:i=>i.iconColor===i.color,style:{[`& .${ve.icon}`]:{color:s.vars?s.vars.palette.Chip.defaultIconColor:t}}},{props:i=>i.iconColor===i.color&&i.color!=="default",style:{[`& .${ve.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${ve.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:Pi(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)}}},...Object.entries(s.palette).filter(rs(["dark"])).map(([i])=>({props:{color:i,onDelete:!0},style:{[`&.${ve.focusVisible}`]:{background:(s.vars||s).palette[i].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:Pi(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity)},[`&.${ve.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:Pi(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)},"&:active":{boxShadow:(s.vars||s).shadows[1]}}},...Object.entries(s.palette).filter(rs(["dark"])).map(([i])=>({props:{color:i,clickable:!0},style:{[`&:hover, &.${ve.focusVisible}`]:{backgroundColor:(s.vars||s).palette[i].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:s.vars?`1px solid ${s.vars.palette.Chip.defaultBorder}`:`1px solid ${s.palette.mode==="light"?s.palette.grey[400]:s.palette.grey[700]}`,[`&.${ve.clickable}:hover`]:{backgroundColor:(s.vars||s).palette.action.hover},[`&.${ve.focusVisible}`]:{backgroundColor:(s.vars||s).palette.action.focus},[`& .${ve.avatar}`]:{marginLeft:4},[`& .${ve.avatarSmall}`]:{marginLeft:2},[`& .${ve.icon}`]:{marginLeft:4},[`& .${ve.iconSmall}`]:{marginLeft:2},[`& .${ve.deleteIcon}`]:{marginRight:5},[`& .${ve.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(s.palette).filter(rs()).map(([i])=>({props:{variant:"outlined",color:i},style:{color:(s.vars||s).palette[i].main,border:`1px solid ${s.vars?`rgba(${s.vars.palette[i].mainChannel} / 0.7)`:Pi(s.palette[i].main,.7)}`,[`&.${ve.clickable}:hover`]:{backgroundColor:s.vars?`rgba(${s.vars.palette[i].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:Pi(s.palette[i].main,s.palette.action.hoverOpacity)},[`&.${ve.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette[i].mainChannel} / ${s.vars.palette.action.focusOpacity})`:Pi(s.palette[i].main,s.palette.action.focusOpacity)},[`& .${ve.deleteIcon}`]:{color:s.vars?`rgba(${s.vars.palette[i].mainChannel} / 0.7)`:Pi(s.palette[i].main,.7),"&:hover, &:active":{color:(s.vars||s).palette[i].main}}}}))]}})),iM=ke("span",{name:"MuiChip",slot:"Label",overridesResolver:(s,t)=>{const{ownerState:i}=s,{size:r}=i;return[t.label,t[`label${zt(r)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function f_(s){return s.key==="Backspace"||s.key==="Delete"}const ob=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiChip"}),{avatar:e,className:o,clickable:a,color:l="default",component:f,deleteIcon:n,disabled:c=!1,icon:d,label:y,onClick:p,onDelete:g,onKeyDown:b,onKeyUp:w,size:v="medium",variant:_="filled",tabIndex:S,skipFocusWhenDisabled:T=!1,...I}=r,k=et.useRef(null),O=Zi(k,i),A=W=>{W.stopPropagation(),g&&g(W)},R=W=>{W.currentTarget===W.target&&f_(W)&&W.preventDefault(),b&&b(W)},P=W=>{W.currentTarget===W.target&&g&&f_(W)&&g(W),w&&w(W)},C=a!==!1&&p?!0:a,N=C||g?Up:f||"div",D={...r,component:N,disabled:c,size:v,color:l,iconColor:et.isValidElement(d)&&d.props.color||l,onDelete:!!g,clickable:C,variant:_},U=tM(D),F=N===Up?{component:f||"div",focusVisibleClassName:U.focusVisible,...g&&{disableRipple:!0}}:{};let L=null;g&&(L=n&&et.isValidElement(n)?et.cloneElement(n,{className:de(n.props.className,U.deleteIcon),onClick:A}):it.jsx(ZR,{className:de(U.deleteIcon),onClick:A}));let j=null;e&&et.isValidElement(e)&&(j=et.cloneElement(e,{className:de(U.avatar,e.props.className)}));let V=null;return d&&et.isValidElement(d)&&(V=et.cloneElement(d,{className:de(U.icon,d.props.className)})),it.jsxs(eM,{as:N,className:de(U.root,o),disabled:C&&c?!0:void 0,onClick:p,onKeyDown:R,onKeyUp:P,ref:O,tabIndex:T&&c?-1:S,ownerState:D,...F,...I,children:[j||V,it.jsx(iM,{className:de(U.label),ownerState:D,children:y}),L]})}),nM={entering:{opacity:1},entered:{opacity:1}},rM=et.forwardRef(function(t,i){const r=fs(),e={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:a=!0,children:l,easing:f,in:n,onEnter:c,onEntered:d,onEntering:y,onExit:p,onExited:g,onExiting:b,style:w,timeout:v=e,TransitionComponent:_=lr,...S}=t,T=et.useRef(null),I=Zi(T,pu(l),i),k=U=>F=>{if(U){const L=T.current;F===void 0?U(L):U(L,F)}},O=k(y),A=k((U,F)=>{Jb(U);const L=ou({style:w,timeout:v,easing:f},{mode:"enter"});U.style.webkitTransition=r.transitions.create("opacity",L),U.style.transition=r.transitions.create("opacity",L),c&&c(U,F)}),R=k(d),P=k(b),C=k(U=>{const F=ou({style:w,timeout:v,easing:f},{mode:"exit"});U.style.webkitTransition=r.transitions.create("opacity",F),U.style.transition=r.transitions.create("opacity",F),p&&p(U)}),N=k(g),D=U=>{o&&o(T.current,U)};return it.jsx(_,{appear:a,in:n,nodeRef:T,onEnter:A,onEntered:R,onEntering:O,onExit:C,onExited:N,onExiting:P,addEndListener:D,timeout:v,...S,children:(U,{ownerState:F,...L})=>et.cloneElement(l,{style:{opacity:0,visibility:U==="exited"&&!n?"hidden":void 0,...nM[U],...w,...l.props.style},ref:I,...L})})});function aM(s){return yi("MuiBackdrop",s)}xi("MuiBackdrop",["root","invisible"]);const sM=s=>{const{classes:t,invisible:i}=s;return _i({root:["root",i&&"invisible"]},aM,t)},oM=ke("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,i.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),cM=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiBackdrop"}),{children:e,className:o,component:a="div",invisible:l=!1,open:f,components:n={},componentsProps:c={},slotProps:d={},slots:y={},TransitionComponent:p,transitionDuration:g,...b}=r,w={...r,component:a,invisible:l},v=sM(w),_={transition:p,root:n.Root,...y},S={...c,...d},T={slots:_,slotProps:S},[I,k]=Un("root",{elementType:oM,externalForwardedProps:T,className:de(v.root,o),ownerState:w}),[O,A]=Un("transition",{elementType:rM,externalForwardedProps:T,ownerState:w});return it.jsx(O,{in:f,timeout:g,...b,...A,children:it.jsx(I,{"aria-hidden":!0,...k,classes:v,ref:i,children:e})})}),uM=xi("MuiBox",["root"]),lM=d0(),Ie=ZA({themeId:Tr,defaultTheme:lM,defaultClassName:uM.root,generateClassName:U8.generate});function dM(s){return yi("MuiCard",s)}xi("MuiCard",["root"]);const fM=s=>{const{classes:t}=s;return _i({root:["root"]},dM,t)},hM=ke(ff,{name:"MuiCard",slot:"Root",overridesResolver:(s,t)=>t.root})({overflow:"hidden"}),h0=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiCard"}),{className:e,raised:o=!1,...a}=r,l={...r,raised:o},f=fM(l);return it.jsx(hM,{className:de(f.root,e),elevation:o?8:void 0,ref:i,ownerState:l,...a})});function pM(s){return yi("MuiCardActionArea",s)}const rm=xi("MuiCardActionArea",["root","focusVisible","focusHighlight"]),yM=s=>{const{classes:t}=s;return _i({root:["root"],focusHighlight:["focusHighlight"]},pM,t)},gM=ke(Up,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(s,t)=>t.root})(Ri(({theme:s})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${rm.focusHighlight}`]:{opacity:(s.vars||s).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${rm.focusVisible} .${rm.focusHighlight}`]:{opacity:(s.vars||s).palette.action.focusOpacity}}))),mM=ke("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(s,t)=>t.focusHighlight})(Ri(({theme:s})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:s.transitions.create("opacity",{duration:s.transitions.duration.short})}))),p0=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiCardActionArea"}),{children:e,className:o,focusVisibleClassName:a,...l}=r,f=r,n=yM(f);return it.jsxs(gM,{className:de(n.root,o),focusVisibleClassName:de(a,n.focusVisible),ref:i,ownerState:f,...l,children:[e,it.jsx(mM,{className:n.focusHighlight,ownerState:f})]})});function bM(s){return yi("MuiCardContent",s)}xi("MuiCardContent",["root"]);const wM=s=>{const{classes:t}=s;return _i({root:["root"]},bM,t)},vM=ke("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(s,t)=>t.root})({padding:16,"&:last-child":{paddingBottom:24}}),y0=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiCardContent"}),{className:e,component:o="div",...a}=r,l={...r,component:o},f=wM(l);return it.jsx(vM,{as:o,className:de(f.root,e),ownerState:l,ref:i,...a})});function xM(s){return yi("MuiCardMedia",s)}xi("MuiCardMedia",["root","media","img"]);const _M=s=>{const{classes:t,isMediaComponent:i,isImageComponent:r}=s;return _i({root:["root",i&&"media",r&&"img"]},xM,t)},SM=ke("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s,{isMediaComponent:r,isImageComponent:e}=i;return[t.root,r&&t.media,e&&t.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),TM=["video","audio","picture","iframe","img"],IM=["picture","img"],g0=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiCardMedia"}),{children:e,className:o,component:a="div",image:l,src:f,style:n,...c}=r,d=TM.includes(a),y=!d&&l?{backgroundImage:`url("${l}")`,...n}:n,p={...r,component:a,isMediaComponent:d,isImageComponent:IM.includes(a)},g=_M(p);return it.jsx(SM,{className:de(g.root,o),as:a,role:!d&&l?"img":void 0,ref:i,style:y,ownerState:p,src:d?l||f:void 0,...c,children:e})}),kM=XP({createStyledComponent:ke("div",{name:"MuiContainer",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,t[`maxWidth${zt(String(i.maxWidth))}`],i.fixed&&t.fixed,i.disableGutters&&t.disableGutters]}}),useThemeProps:s=>ci({props:s,name:"MuiContainer"})}),cb=typeof dT({})=="function",EM=(s,t)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...t&&!s.vars&&{colorScheme:s.palette.mode}}),OM=s=>({color:(s.vars||s).palette.text.primary,...s.typography.body1,backgroundColor:(s.vars||s).palette.background.default,"@media print":{backgroundColor:(s.vars||s).palette.common.white}}),kT=(s,t=!1)=>{var o,a;const i={};t&&s.colorSchemes&&typeof s.getColorSchemeSelector=="function"&&Object.entries(s.colorSchemes).forEach(([l,f])=>{var c,d;const n=s.getColorSchemeSelector(l);n.startsWith("@")?i[n]={":root":{colorScheme:(c=f.palette)==null?void 0:c.mode}}:i[n.replace(/\s*&/,"")]={colorScheme:(d=f.palette)==null?void 0:d.mode}});let r={html:EM(s,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:s.typography.fontWeightBold},body:{margin:0,...OM(s),"&::backdrop":{backgroundColor:(s.vars||s).palette.background.default}},...i};const e=(a=(o=s.components)==null?void 0:o.MuiCssBaseline)==null?void 0:a.styleOverrides;return e&&(r=[r,e]),r},Op="mui-ecs",AM=s=>{const t=kT(s,!1),i=Array.isArray(t)?t[0]:t;return!s.vars&&i&&(i.html[`:root:has(${Op})`]={colorScheme:s.palette.mode}),s.colorSchemes&&Object.entries(s.colorSchemes).forEach(([r,e])=>{var a,l;const o=s.getColorSchemeSelector(r);o.startsWith("@")?i[o]={[`:root:not(:has(.${Op}))`]:{colorScheme:(a=e.palette)==null?void 0:a.mode}}:i[o.replace(/\s*&/,"")]={[`&:not(:has(.${Op}))`]:{colorScheme:(l=e.palette)==null?void 0:l.mode}}}),t},PM=dT(cb?({theme:s,enableColorScheme:t})=>kT(s,t):({theme:s})=>AM(s));function RM(s){const t=ci({props:s,name:"MuiCssBaseline"}),{children:i,enableColorScheme:r=!1}=t;return it.jsxs(et.Fragment,{children:[cb&&it.jsx(PM,{enableColorScheme:r}),!cb&&!r&&it.jsx("span",{className:Op,style:{display:"none"}}),i]})}function MM(s){const t=Sa(s);return t.body===s?su(s).innerWidth>t.documentElement.clientWidth:s.scrollHeight>s.clientHeight}function Gd(s,t){t?s.setAttribute("aria-hidden","true"):s.removeAttribute("aria-hidden")}function h_(s){return parseInt(su(s).getComputedStyle(s).paddingRight,10)||0}function NM(s){const i=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(s.tagName),r=s.tagName==="INPUT"&&s.getAttribute("type")==="hidden";return i||r}function p_(s,t,i,r,e){const o=[t,i,...r];[].forEach.call(s.children,a=>{const l=!o.includes(a),f=!NM(a);l&&f&&Gd(a,e)})}function am(s,t){let i=-1;return s.some((r,e)=>t(r)?(i=e,!0):!1),i}function CM(s,t){const i=[],r=s.container;if(!t.disableScrollLock){if(MM(r)){const a=wP(su(r));i.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${h_(r)+a}px`;const l=Sa(r).querySelectorAll(".mui-fixed");[].forEach.call(l,f=>{i.push({value:f.style.paddingRight,property:"padding-right",el:f}),f.style.paddingRight=`${h_(f)+a}px`})}let o;if(r.parentNode instanceof DocumentFragment)o=Sa(r).body;else{const a=r.parentElement,l=su(r);o=(a==null?void 0:a.nodeName)==="HTML"&&l.getComputedStyle(a).overflowY==="scroll"?a:r}i.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{i.forEach(({value:o,el:a,property:l})=>{o?a.style.setProperty(l,o):a.style.removeProperty(l)})}}function DM(s){const t=[];return[].forEach.call(s.children,i=>{i.getAttribute("aria-hidden")==="true"&&t.push(i)}),t}class BM{constructor(){this.modals=[],this.containers=[]}add(t,i){let r=this.modals.indexOf(t);if(r!==-1)return r;r=this.modals.length,this.modals.push(t),t.modalRef&&Gd(t.modalRef,!1);const e=DM(i);p_(i,t.mount,t.modalRef,e,!0);const o=am(this.containers,a=>a.container===i);return o!==-1?(this.containers[o].modals.push(t),r):(this.containers.push({modals:[t],container:i,restore:null,hiddenSiblings:e}),r)}mount(t,i){const r=am(this.containers,o=>o.modals.includes(t)),e=this.containers[r];e.restore||(e.restore=CM(e,i))}remove(t,i=!0){const r=this.modals.indexOf(t);if(r===-1)return r;const e=am(this.containers,a=>a.modals.includes(t)),o=this.containers[e];if(o.modals.splice(o.modals.indexOf(t),1),this.modals.splice(r,1),o.modals.length===0)o.restore&&o.restore(),t.modalRef&&Gd(t.modalRef,i),p_(o.container,t.mount,t.modalRef,o.hiddenSiblings,!1),this.containers.splice(e,1);else{const a=o.modals[o.modals.length-1];a.modalRef&&Gd(a.modalRef,!1)}return r}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}const FM=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function LM(s){const t=parseInt(s.getAttribute("tabindex")||"",10);return Number.isNaN(t)?s.contentEditable==="true"||(s.nodeName==="AUDIO"||s.nodeName==="VIDEO"||s.nodeName==="DETAILS")&&s.getAttribute("tabindex")===null?0:s.tabIndex:t}function UM(s){if(s.tagName!=="INPUT"||s.type!=="radio"||!s.name)return!1;const t=r=>s.ownerDocument.querySelector(`input[type="radio"]${r}`);let i=t(`[name="${s.name}"]:checked`);return i||(i=t(`[name="${s.name}"]`)),i!==s}function qM(s){return!(s.disabled||s.tagName==="INPUT"&&s.type==="hidden"||UM(s))}function jM(s){const t=[],i=[];return Array.from(s.querySelectorAll(FM)).forEach((r,e)=>{const o=LM(r);o===-1||!qM(r)||(o===0?t.push(r):i.push({documentOrder:e,tabIndex:o,node:r}))}),i.sort((r,e)=>r.tabIndex===e.tabIndex?r.documentOrder-e.documentOrder:r.tabIndex-e.tabIndex).map(r=>r.node).concat(t)}function HM(){return!0}function KM(s){const{children:t,disableAutoFocus:i=!1,disableEnforceFocus:r=!1,disableRestoreFocus:e=!1,getTabbable:o=jM,isEnabled:a=HM,open:l}=s,f=et.useRef(!1),n=et.useRef(null),c=et.useRef(null),d=et.useRef(null),y=et.useRef(null),p=et.useRef(!1),g=et.useRef(null),b=Zi(pu(t),g),w=et.useRef(null);et.useEffect(()=>{!l||!g.current||(p.current=!i)},[i,l]),et.useEffect(()=>{if(!l||!g.current)return;const S=Sa(g.current);return g.current.contains(S.activeElement)||(g.current.hasAttribute("tabIndex")||g.current.setAttribute("tabIndex","-1"),p.current&&g.current.focus()),()=>{e||(d.current&&d.current.focus&&(f.current=!0,d.current.focus()),d.current=null)}},[l]),et.useEffect(()=>{if(!l||!g.current)return;const S=Sa(g.current),T=O=>{w.current=O,!(r||!a()||O.key!=="Tab")&&S.activeElement===g.current&&O.shiftKey&&(f.current=!0,c.current&&c.current.focus())},I=()=>{var R,P;const O=g.current;if(O===null)return;if(!S.hasFocus()||!a()||f.current){f.current=!1;return}if(O.contains(S.activeElement)||r&&S.activeElement!==n.current&&S.activeElement!==c.current)return;if(S.activeElement!==y.current)y.current=null;else if(y.current!==null)return;if(!p.current)return;let A=[];if((S.activeElement===n.current||S.activeElement===c.current)&&(A=o(g.current)),A.length>0){const C=!!((R=w.current)!=null&&R.shiftKey&&((P=w.current)==null?void 0:P.key)==="Tab"),N=A[0],D=A[A.length-1];typeof N!="string"&&typeof D!="string"&&(C?D.focus():N.focus())}else O.focus()};S.addEventListener("focusin",I),S.addEventListener("keydown",T,!0);const k=setInterval(()=>{S.activeElement&&S.activeElement.tagName==="BODY"&&I()},50);return()=>{clearInterval(k),S.removeEventListener("focusin",I),S.removeEventListener("keydown",T,!0)}},[i,r,e,a,l,o]);const v=S=>{d.current===null&&(d.current=S.relatedTarget),p.current=!0,y.current=S.target;const T=t.props.onFocus;T&&T(S)},_=S=>{d.current===null&&(d.current=S.relatedTarget),p.current=!0};return it.jsxs(et.Fragment,{children:[it.jsx("div",{tabIndex:l?0:-1,onFocus:_,ref:n,"data-testid":"sentinelStart"}),et.cloneElement(t,{ref:b,onFocus:v}),it.jsx("div",{tabIndex:l?0:-1,onFocus:_,ref:c,"data-testid":"sentinelEnd"})]})}function VM(s){return typeof s=="function"?s():s}function WM(s){return s?s.props.hasOwnProperty("in"):!1}const y_=()=>{},Lh=new BM;function $M(s){const{container:t,disableEscapeKeyDown:i=!1,disableScrollLock:r=!1,closeAfterTransition:e=!1,onTransitionEnter:o,onTransitionExited:a,children:l,onClose:f,open:n,rootRef:c}=s,d=et.useRef({}),y=et.useRef(null),p=et.useRef(null),g=Zi(p,c),[b,w]=et.useState(!n),v=WM(l);let _=!0;(s["aria-hidden"]==="false"||s["aria-hidden"]===!1)&&(_=!1);const S=()=>Sa(y.current),T=()=>(d.current.modalRef=p.current,d.current.mount=y.current,d.current),I=()=>{Lh.mount(T(),{disableScrollLock:r}),p.current&&(p.current.scrollTop=0)},k=as(()=>{const F=VM(t)||S().body;Lh.add(T(),F),p.current&&I()}),O=()=>Lh.isTopModal(T()),A=as(F=>{y.current=F,F&&(n&&O()?I():p.current&&Gd(p.current,_))}),R=et.useCallback(()=>{Lh.remove(T(),_)},[_]);et.useEffect(()=>()=>{R()},[R]),et.useEffect(()=>{n?k():(!v||!e)&&R()},[n,R,v,e,k]);const P=F=>L=>{var j;(j=F.onKeyDown)==null||j.call(F,L),!(L.key!=="Escape"||L.which===229||!O())&&(i||(L.stopPropagation(),f&&f(L,"escapeKeyDown")))},C=F=>L=>{var j;(j=F.onClick)==null||j.call(F,L),L.target===L.currentTarget&&f&&f(L,"backdropClick")};return{getRootProps:(F={})=>{const L=Y8(s);delete L.onTransitionEnter,delete L.onTransitionExited;const j={...L,...F};return{role:"presentation",...j,onKeyDown:P(j),ref:g}},getBackdropProps:(F={})=>{const L=F;return{"aria-hidden":!0,...L,onClick:C(L),open:n}},getTransitionProps:()=>{const F=()=>{w(!1),o&&o()},L=()=>{w(!0),a&&a(),e&&R()};return{onEnter:B2(F,(l==null?void 0:l.props.onEnter)??y_),onExited:B2(L,(l==null?void 0:l.props.onExited)??y_)}},rootRef:g,portalRef:A,isTopModal:O,exited:b,hasTransition:v}}function zM(s){return yi("MuiModal",s)}xi("MuiModal",["root","hidden","backdrop"]);const XM=s=>{const{open:t,exited:i,classes:r}=s;return _i({root:["root",!t&&i&&"hidden"],backdrop:["backdrop"]},zM,r)},GM=ke("div",{name:"MuiModal",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,!i.open&&i.exited&&t.hidden]}})(Ri(({theme:s})=>({position:"fixed",zIndex:(s.vars||s).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:t})=>!t.open&&t.exited,style:{visibility:"hidden"}}]}))),YM=ke(cM,{name:"MuiModal",slot:"Backdrop",overridesResolver:(s,t)=>t.backdrop})({zIndex:-1}),QM=et.forwardRef(function(t,i){const r=ci({name:"MuiModal",props:t}),{BackdropComponent:e=YM,BackdropProps:o,classes:a,className:l,closeAfterTransition:f=!1,children:n,container:c,component:d,components:y={},componentsProps:p={},disableAutoFocus:g=!1,disableEnforceFocus:b=!1,disableEscapeKeyDown:w=!1,disablePortal:v=!1,disableRestoreFocus:_=!1,disableScrollLock:S=!1,hideBackdrop:T=!1,keepMounted:I=!1,onClose:k,onTransitionEnter:O,onTransitionExited:A,open:R,slotProps:P={},slots:C={},theme:N,...D}=r,U={...r,closeAfterTransition:f,disableAutoFocus:g,disableEnforceFocus:b,disableEscapeKeyDown:w,disablePortal:v,disableRestoreFocus:_,disableScrollLock:S,hideBackdrop:T,keepMounted:I},{getRootProps:F,getBackdropProps:L,getTransitionProps:j,portalRef:V,isTopModal:W,exited:q,hasTransition:$}=$M({...U,rootRef:i}),Y={...U,exited:q},Q=XM(Y),J={};if(n.props.tabIndex===void 0&&(J.tabIndex="-1"),$){const{onEnter:tt,onExited:xt}=j();J.onEnter=tt,J.onExited=xt}const vt={slots:{root:y.Root,backdrop:y.Backdrop,...C},slotProps:{...p,...P}},[wt,dt]=Un("root",{ref:i,elementType:GM,externalForwardedProps:{...vt,...D,component:d},getSlotProps:F,ownerState:Y,className:de(l,Q==null?void 0:Q.root,!Y.open&&Y.exited&&(Q==null?void 0:Q.hidden))}),[yt,_t]=Un("backdrop",{ref:o==null?void 0:o.ref,elementType:e,externalForwardedProps:vt,shouldForwardComponentProp:!0,additionalProps:o,getSlotProps:tt=>L({...tt,onClick:xt=>{tt!=null&&tt.onClick&&tt.onClick(xt)}}),className:de(o==null?void 0:o.className,Q==null?void 0:Q.backdrop),ownerState:Y});return!I&&!R&&(!$||q)?null:it.jsx(TT,{ref:V,container:c,disablePortal:v,children:it.jsxs(wt,{...dt,children:[!T&&e?it.jsx(yt,{..._t}):null,it.jsx(KM,{disableEnforceFocus:b,disableAutoFocus:g,disableRestoreFocus:_,isEnabled:W,open:R,children:et.cloneElement(n,J)})]})})});function ZM(s){return yi("MuiDivider",s)}xi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const JM=s=>{const{absolute:t,children:i,classes:r,flexItem:e,light:o,orientation:a,textAlign:l,variant:f}=s;return _i({root:["root",t&&"absolute",f,o&&"light",a==="vertical"&&"vertical",e&&"flexItem",i&&"withChildren",i&&a==="vertical"&&"withChildrenVertical",l==="right"&&a!=="vertical"&&"textAlignRight",l==="left"&&a!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",a==="vertical"&&"wrapperVertical"]},ZM,r)},tN=ke("div",{name:"MuiDivider",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.root,i.absolute&&t.absolute,t[i.variant],i.light&&t.light,i.orientation==="vertical"&&t.vertical,i.flexItem&&t.flexItem,i.children&&t.withChildren,i.children&&i.orientation==="vertical"&&t.withChildrenVertical,i.textAlign==="right"&&i.orientation!=="vertical"&&t.textAlignRight,i.textAlign==="left"&&i.orientation!=="vertical"&&t.textAlignLeft]}})(Ri(({theme:s})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(s.vars||s).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:s.vars?`rgba(${s.vars.palette.dividerChannel} / 0.08)`:Pi(s.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:s.spacing(2),marginRight:s.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:s.spacing(1),marginBottom:s.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:t})=>!!t.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:t})=>t.children&&t.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(s.vars||s).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:t})=>t.orientation==="vertical"&&t.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(s.vars||s).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:t})=>t.textAlign==="right"&&t.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:t})=>t.textAlign==="left"&&t.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),eN=ke("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.wrapper,i.orientation==="vertical"&&t.wrapperVertical]}})(Ri(({theme:s})=>({display:"inline-block",paddingLeft:`calc(${s.spacing(1)} * 1.2)`,paddingRight:`calc(${s.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${s.spacing(1)} * 1.2)`,paddingBottom:`calc(${s.spacing(1)} * 1.2)`}}]}))),jp=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiDivider"}),{absolute:e=!1,children:o,className:a,orientation:l="horizontal",component:f=o||l==="vertical"?"div":"hr",flexItem:n=!1,light:c=!1,role:d=f!=="hr"?"separator":void 0,textAlign:y="center",variant:p="fullWidth",...g}=r,b={...r,absolute:e,component:f,flexItem:n,light:c,orientation:l,role:d,textAlign:y,variant:p},w=JM(b);return it.jsx(tN,{as:f,className:de(w.root,a),role:d,ref:i,ownerState:b,"aria-orientation":d==="separator"&&(f!=="hr"||l==="vertical")?l:void 0,...g,children:o?it.jsx(eN,{className:w.wrapper,ownerState:b,children:o}):null})});jp&&(jp.muiSkipListHighlight=!0);function iN(s,t,i){const r=t.getBoundingClientRect(),e=i&&i.getBoundingClientRect(),o=su(t);let a;if(t.fakeTransform)a=t.fakeTransform;else{const n=o.getComputedStyle(t);a=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("transform")}let l=0,f=0;if(a&&a!=="none"&&typeof a=="string"){const n=a.split("(")[1].split(")")[0].split(",");l=parseInt(n[4],10),f=parseInt(n[5],10)}return s==="left"?e?`translateX(${e.right+l-r.left}px)`:`translateX(${o.innerWidth+l-r.left}px)`:s==="right"?e?`translateX(-${r.right-e.left-l}px)`:`translateX(-${r.left+r.width-l}px)`:s==="up"?e?`translateY(${e.bottom+f-r.top}px)`:`translateY(${o.innerHeight+f-r.top}px)`:e?`translateY(-${r.top-e.top+r.height-f}px)`:`translateY(-${r.top+r.height-f}px)`}function nN(s){return typeof s=="function"?s():s}function Uh(s,t,i){const r=nN(i),e=iN(s,t,r);e&&(t.style.webkitTransform=e,t.style.transform=e)}const rN=et.forwardRef(function(t,i){const r=fs(),e={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:l=!0,children:f,container:n,direction:c="down",easing:d=e,in:y,onEnter:p,onEntered:g,onEntering:b,onExit:w,onExited:v,onExiting:_,style:S,timeout:T=o,TransitionComponent:I=lr,...k}=t,O=et.useRef(null),A=Zi(pu(f),O,i),R=V=>W=>{V&&(W===void 0?V(O.current):V(O.current,W))},P=R((V,W)=>{Uh(c,V,n),Jb(V),p&&p(V,W)}),C=R((V,W)=>{const q=ou({timeout:T,style:S,easing:d},{mode:"enter"});V.style.webkitTransition=r.transitions.create("-webkit-transform",{...q}),V.style.transition=r.transitions.create("transform",{...q}),V.style.webkitTransform="none",V.style.transform="none",b&&b(V,W)}),N=R(g),D=R(_),U=R(V=>{const W=ou({timeout:T,style:S,easing:d},{mode:"exit"});V.style.webkitTransition=r.transitions.create("-webkit-transform",W),V.style.transition=r.transitions.create("transform",W),Uh(c,V,n),w&&w(V)}),F=R(V=>{V.style.webkitTransition="",V.style.transition="",v&&v(V)}),L=V=>{a&&a(O.current,V)},j=et.useCallback(()=>{O.current&&Uh(c,O.current,n)},[c,n]);return et.useEffect(()=>{if(y||c==="down"||c==="right")return;const V=hP(()=>{O.current&&Uh(c,O.current,n)}),W=su(O.current);return W.addEventListener("resize",V),()=>{V.clear(),W.removeEventListener("resize",V)}},[c,y,n]),et.useEffect(()=>{y||j()},[y,j]),it.jsx(I,{nodeRef:O,onEnter:P,onEntered:N,onEntering:C,onExit:U,onExited:F,onExiting:D,addEndListener:L,appear:l,in:y,timeout:T,...k,children:(V,{ownerState:W,...q})=>et.cloneElement(f,{ref:A,style:{visibility:V==="exited"&&!y?"hidden":void 0,...S,...f.props.style},...q})})});function aN(s){return yi("MuiDrawer",s)}xi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const ET=(s,t)=>{const{ownerState:i}=s;return[t.root,(i.variant==="permanent"||i.variant==="persistent")&&t.docked,t.modal]},sN=s=>{const{classes:t,anchor:i,variant:r}=s,e={root:["root",`anchor${zt(i)}`],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${zt(i)}`,r!=="temporary"&&`paperAnchorDocked${zt(i)}`]};return _i(e,aN,t)},oN=ke(QM,{name:"MuiDrawer",slot:"Root",overridesResolver:ET})(Ri(({theme:s})=>({zIndex:(s.vars||s).zIndex.drawer}))),cN=ke("div",{shouldForwardProp:lT,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:ET})({flex:"0 0 auto"}),uN=ke(ff,{name:"MuiDrawer",slot:"Paper",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.paper,t[`paperAnchor${zt(i.anchor)}`],i.variant!=="temporary"&&t[`paperAnchorDocked${zt(i.anchor)}`]]}})(Ri(({theme:s})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(s.vars||s).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:t})=>t.anchor==="left"&&t.variant!=="temporary",style:{borderRight:`1px solid ${(s.vars||s).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="top"&&t.variant!=="temporary",style:{borderBottom:`1px solid ${(s.vars||s).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="right"&&t.variant!=="temporary",style:{borderLeft:`1px solid ${(s.vars||s).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="bottom"&&t.variant!=="temporary",style:{borderTop:`1px solid ${(s.vars||s).palette.divider}`}}]}))),OT={left:"right",right:"left",top:"down",bottom:"up"};function lN(s){return["left","right"].includes(s)}function dN({direction:s},t){return s==="rtl"&&lN(t)?OT[t]:t}const fN=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiDrawer"}),e=fs(),o=$b(),a={enter:e.transitions.duration.enteringScreen,exit:e.transitions.duration.leavingScreen},{anchor:l="left",BackdropProps:f,children:n,className:c,elevation:d=16,hideBackdrop:y=!1,ModalProps:{BackdropProps:p,...g}={},onClose:b,open:w=!1,PaperProps:v={},SlideProps:_,TransitionComponent:S,transitionDuration:T=a,variant:I="temporary",slots:k={},slotProps:O={},...A}=r,R=et.useRef(!1);et.useEffect(()=>{R.current=!0},[]);const P=dN({direction:o?"rtl":"ltr"},l),N={...r,anchor:l,elevation:d,open:w,variant:I,...A},D=sN(N),U={slots:{transition:S,...k},slotProps:{paper:v,transition:_,...O,backdrop:z7(O.backdrop||{...f,...p},{transitionDuration:T})}},[F,L]=Un("root",{ref:i,elementType:oN,className:de(D.root,D.modal,c),shouldForwardComponentProp:!0,ownerState:N,externalForwardedProps:{...U,...A,...g},additionalProps:{open:w,onClose:b,hideBackdrop:y,slots:{backdrop:U.slots.backdrop},slotProps:{backdrop:U.slotProps.backdrop}}}),[j,V]=Un("paper",{elementType:uN,shouldForwardComponentProp:!0,className:de(D.paper,v.className),ownerState:N,externalForwardedProps:U,additionalProps:{elevation:I==="temporary"?d:0,square:!0}}),[W,q]=Un("docked",{elementType:cN,ref:i,className:de(D.root,D.docked,c),ownerState:N,externalForwardedProps:U,additionalProps:A}),[$,Y]=Un("transition",{elementType:rN,ownerState:N,externalForwardedProps:U,additionalProps:{in:w,direction:OT[P],timeout:T,appear:R.current}}),Q=it.jsx(j,{...V,children:n});if(I==="permanent")return it.jsx(W,{...q,children:Q});const J=it.jsx($,{...Y,children:Q});return I==="persistent"?it.jsx(W,{...q,children:J}):it.jsx(F,{...L,children:J})});function ub(s){return`scale(${s}, ${s**2})`}const hN={entering:{opacity:1,transform:ub(1)},entered:{opacity:1,transform:"none"}},sm=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),lb=et.forwardRef(function(t,i){const{addEndListener:r,appear:e=!0,children:o,easing:a,in:l,onEnter:f,onEntered:n,onEntering:c,onExit:d,onExited:y,onExiting:p,style:g,timeout:b="auto",TransitionComponent:w=lr,...v}=t,_=Qc(),S=et.useRef(),T=fs(),I=et.useRef(null),k=Zi(I,pu(o),i),O=F=>L=>{if(F){const j=I.current;L===void 0?F(j):F(j,L)}},A=O(c),R=O((F,L)=>{Jb(F);const{duration:j,delay:V,easing:W}=ou({style:g,timeout:b,easing:a},{mode:"enter"});let q;b==="auto"?(q=T.transitions.getAutoHeightDuration(F.clientHeight),S.current=q):q=j,F.style.transition=[T.transitions.create("opacity",{duration:q,delay:V}),T.transitions.create("transform",{duration:sm?q:q*.666,delay:V,easing:W})].join(","),f&&f(F,L)}),P=O(n),C=O(p),N=O(F=>{const{duration:L,delay:j,easing:V}=ou({style:g,timeout:b,easing:a},{mode:"exit"});let W;b==="auto"?(W=T.transitions.getAutoHeightDuration(F.clientHeight),S.current=W):W=L,F.style.transition=[T.transitions.create("opacity",{duration:W,delay:j}),T.transitions.create("transform",{duration:sm?W:W*.666,delay:sm?j:j||W*.333,easing:V})].join(","),F.style.opacity=0,F.style.transform=ub(.75),d&&d(F)}),D=O(y),U=F=>{b==="auto"&&_.start(S.current||0,F),r&&r(I.current,F)};return it.jsx(w,{appear:e,in:l,nodeRef:I,onEnter:R,onEntered:P,onEntering:A,onExit:N,onExited:D,onExiting:C,addEndListener:U,timeout:b==="auto"?null:b,...v,children:(F,{ownerState:L,...j})=>et.cloneElement(o,{style:{opacity:0,transform:ub(.75),visibility:F==="exited"&&!l?"hidden":void 0,...hN[F],...g,...o.props.style},ref:k,...j})})});lb&&(lb.muiSupportAuto=!0);function pN(s){return yi("MuiTooltip",s)}const ii=xi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function yN(s){return Math.round(s*1e5)/1e5}const gN=s=>{const{classes:t,disableInteractive:i,arrow:r,touch:e,placement:o}=s,a={popper:["popper",!i&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",e&&"touch",`tooltipPlacement${zt(o.split("-")[0])}`],arrow:["arrow"]};return _i(a,pN,t)},mN=ke(IT,{name:"MuiTooltip",slot:"Popper",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.popper,!i.disableInteractive&&t.popperInteractive,i.arrow&&t.popperArrow,!i.open&&t.popperClose]}})(Ri(({theme:s})=>({zIndex:(s.vars||s).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:t})=>!t.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:t})=>!t,style:{pointerEvents:"none"}},{props:({ownerState:t})=>t.arrow,style:{[`&[data-popper-placement*="bottom"] .${ii.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${ii.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${ii.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${ii.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="right"] .${ii.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="right"] .${ii.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="left"] .${ii.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="left"] .${ii.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),bN=ke("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(s,t)=>{const{ownerState:i}=s;return[t.tooltip,i.touch&&t.touch,i.arrow&&t.tooltipArrow,t[`tooltipPlacement${zt(i.placement.split("-")[0])}`]]}})(Ri(({theme:s})=>({backgroundColor:s.vars?s.vars.palette.Tooltip.bg:Pi(s.palette.grey[700],.92),borderRadius:(s.vars||s).shape.borderRadius,color:(s.vars||s).palette.common.white,fontFamily:s.typography.fontFamily,padding:"4px 8px",fontSize:s.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:s.typography.fontWeightMedium,[`.${ii.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${ii.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${ii.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${ii.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:t})=>t.arrow,style:{position:"relative",margin:0}},{props:({ownerState:t})=>t.touch,style:{padding:"8px 16px",fontSize:s.typography.pxToRem(14),lineHeight:`${yN(16/14)}em`,fontWeight:s.typography.fontWeightRegular}},{props:({ownerState:t})=>!t.isRtl,style:{[`.${ii.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${ii.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:t})=>!t.isRtl&&t.touch,style:{[`.${ii.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${ii.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:t})=>!!t.isRtl,style:{[`.${ii.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${ii.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:t})=>!!t.isRtl&&t.touch,style:{[`.${ii.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${ii.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${ii.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${ii.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),wN=ke("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(s,t)=>t.arrow})(Ri(({theme:s})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:s.vars?s.vars.palette.Tooltip.bg:Pi(s.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let qh=!1;const g_=new l0;let wl={x:0,y:0};function jh(s,t){return(i,...r)=>{t&&t(i,...r),s(i,...r)}}const wo=et.forwardRef(function(t,i){const r=ci({props:t,name:"MuiTooltip"}),{arrow:e=!1,children:o,classes:a,components:l={},componentsProps:f={},describeChild:n=!1,disableFocusListener:c=!1,disableHoverListener:d=!1,disableInteractive:y=!1,disableTouchListener:p=!1,enterDelay:g=100,enterNextDelay:b=0,enterTouchDelay:w=700,followCursor:v=!1,id:_,leaveDelay:S=0,leaveTouchDelay:T=1500,onClose:I,onOpen:k,open:O,placement:A="bottom",PopperComponent:R,PopperProps:P={},slotProps:C={},slots:N={},title:D,TransitionComponent:U,TransitionProps:F,...L}=r,j=et.isValidElement(o)?o:it.jsx("span",{children:o}),V=fs(),W=$b(),[q,$]=et.useState(),[Y,Q]=et.useState(null),J=et.useRef(!1),vt=y||v,wt=Qc(),dt=Qc(),yt=Qc(),_t=Qc(),[tt,xt]=gP({controlled:O,default:!1,name:"Tooltip",state:"open"});let It=tt;const Nt=z8(_),Lt=et.useRef(),ne=as(()=>{Lt.current!==void 0&&(document.body.style.WebkitUserSelect=Lt.current,Lt.current=void 0),_t.clear()});et.useEffect(()=>ne,[ne]);const Ut=Bt=>{g_.clear(),qh=!0,xt(!0),k&&!It&&k(Bt)},Vt=as(Bt=>{g_.start(800+S,()=>{qh=!1}),xt(!1),I&&It&&I(Bt),wt.start(V.transitions.duration.shortest,()=>{J.current=!1})}),Jt=Bt=>{J.current&&Bt.type!=="touchstart"||(q&&q.removeAttribute("title"),dt.clear(),yt.clear(),g||qh&&b?dt.start(qh?b:g,()=>{Ut(Bt)}):Ut(Bt))},Ct=Bt=>{dt.clear(),yt.start(S,()=>{Vt(Bt)})},[,K]=et.useState(!1),ut=Bt=>{Bp(Bt.target)||(K(!1),Ct(Bt))},st=Bt=>{q||$(Bt.currentTarget),Bp(Bt.target)&&(K(!0),Jt(Bt))},Mt=Bt=>{J.current=!0;const ce=j.props;ce.onTouchStart&&ce.onTouchStart(Bt)},Ht=Bt=>{Mt(Bt),yt.clear(),wt.clear(),ne(),Lt.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",_t.start(w,()=>{document.body.style.WebkitUserSelect=Lt.current,Jt(Bt)})},Kt=Bt=>{j.props.onTouchEnd&&j.props.onTouchEnd(Bt),ne(),yt.start(T,()=>{Vt(Bt)})};et.useEffect(()=>{if(!It)return;function Bt(ce){ce.key==="Escape"&&Vt(ce)}return document.addEventListener("keydown",Bt),()=>{document.removeEventListener("keydown",Bt)}},[Vt,It]);const Xt=Zi(pu(j),$,i);!D&&D!==0&&(It=!1);const Qt=et.useRef(),Ft=Bt=>{const ce=j.props;ce.onMouseMove&&ce.onMouseMove(Bt),wl={x:Bt.clientX,y:Bt.clientY},Qt.current&&Qt.current.update()},Rt={},St=typeof D=="string";n?(Rt.title=!It&&St&&!d?D:null,Rt["aria-describedby"]=It?Nt:null):(Rt["aria-label"]=St?D:null,Rt["aria-labelledby"]=It&&!St?Nt:null);const Ot={...Rt,...L,...j.props,className:de(L.className,j.props.className),onTouchStart:Mt,ref:Xt,...v?{onMouseMove:Ft}:{}},Wt={};p||(Ot.onTouchStart=Ht,Ot.onTouchEnd=Kt),d||(Ot.onMouseOver=jh(Jt,Ot.onMouseOver),Ot.onMouseLeave=jh(Ct,Ot.onMouseLeave),vt||(Wt.onMouseOver=Jt,Wt.onMouseLeave=Ct)),c||(Ot.onFocus=jh(st,Ot.onFocus),Ot.onBlur=jh(ut,Ot.onBlur),vt||(Wt.onFocus=st,Wt.onBlur=ut));const Gt={...r,isRtl:W,arrow:e,disableInteractive:vt,placement:A,PopperComponentProp:R,touch:J.current},z=typeof C.popper=="function"?C.popper(Gt):C.popper,G=et.useMemo(()=>{var ce,Si;let Bt=[{name:"arrow",enabled:!!Y,options:{element:Y,padding:4}}];return(ce=P.popperOptions)!=null&&ce.modifiers&&(Bt=Bt.concat(P.popperOptions.modifiers)),(Si=z==null?void 0:z.popperOptions)!=null&&Si.modifiers&&(Bt=Bt.concat(z.popperOptions.modifiers)),{...P.popperOptions,...z==null?void 0:z.popperOptions,modifiers:Bt}},[Y,P.popperOptions,z==null?void 0:z.popperOptions]),at=gN(Gt),ht=typeof C.transition=="function"?C.transition(Gt):C.transition,lt={slots:{popper:l.Popper,transition:l.Transition??U,tooltip:l.Tooltip,arrow:l.Arrow,...N},slotProps:{arrow:C.arrow??f.arrow,popper:{...P,...z??f.popper},tooltip:C.tooltip??f.tooltip,transition:{...F,...ht??f.transition}}},[bt,Dt]=Un("popper",{elementType:mN,externalForwardedProps:lt,ownerState:Gt,className:de(at.popper,P==null?void 0:P.className)}),[jt,Yt]=Un("transition",{elementType:lb,externalForwardedProps:lt,ownerState:Gt}),[te,oe]=Un("tooltip",{elementType:bN,className:at.tooltip,externalForwardedProps:lt,ownerState:Gt}),[ee,pe]=Un("arrow",{elementType:wN,className:at.arrow,externalForwardedProps:lt,ownerState:Gt,ref:Q});return it.jsxs(et.Fragment,{children:[et.cloneElement(j,Ot),it.jsx(bt,{as:R??IT,placement:A,anchorEl:v?{getBoundingClientRect:()=>({top:wl.y,left:wl.x,right:wl.x,bottom:wl.y,width:0,height:0})}:q,popperRef:Qt,open:q?It:!1,id:Nt,transition:!0,...Wt,...Dt,popperOptions:G,children:({TransitionProps:Bt})=>it.jsx(jt,{timeout:V.transitions.duration.shorter,...Bt,...Yt,children:it.jsxs(te,{...oe,children:[D,e?it.jsx(ee,{...pe}):null]})})})]})}),vN=e7({createStyledComponent:ke("div",{name:"MuiStack",slot:"Root",overridesResolver:(s,t)=>t.root}),useThemeProps:s=>ci({props:s,name:"MuiStack"})}),m0={aspectRatio:"1.67",width:"100%",height:"auto",objectFit:"cover"},b0={width:"100%",height:"auto",borderRadius:2,boxShadow:"0 8px 24px rgba(44, 110, 142, 0.2)",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(44, 110, 142, 0.2)"}},w0={width:"100%",height:"auto",borderRadius:2,boxShadow:"none",opacity:.3,cursor:"not-allowed","&:hover":{transform:"none",boxShadow:"none",cursor:"not-allowed"}},v0={fontSize:20,fontWeight:600,color:"#2c6e8e"},x0={fontSize:15,color:"#607d8b"};var ue;let ot=(ue=class{constructor(t=0,i=10,r="be"){rt(this,"negative");rt(this,"words");rt(this,"length");rt(this,"red");if(this.negative=0,this.words=[],this.length=0,this.red=null,t!==null){if((i==="le"||i==="be")&&(r=i,i=10),typeof t=="number"){this.initNumber(t,i,r);return}if(typeof t=="object"){this.initArray(t,r);return}i==="hex"&&(i=16),this.assert(i===(i|0)&&i>=2&&i<=36),t=t.toString().replace(/\s+/g,"");let e=0;t.startsWith("-")&&(e++,this.negative=1),e<t.length&&(i===16?this.parseHex(t,e,r):(this.parseBase(t,i,e),r==="le"&&this.initArray(this.toArray(),r)))}}static isBN(t){return t instanceof ue?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===ue.wordSize&&Array.isArray(t.words)}static max(t,i){return t.cmp(i)>0?t:i}static min(t,i){return t.cmp(i)<0?t:i}assert(t,i="Assertion failed"){if(!t)throw new Error(i)}initNumber(t,i,r){return t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(this.assert(t<=9007199254740991,"The number is larger than 2 ^ 53 (unsafe)"),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),r!=="le"?this:(this.initArray(this.toArray(),r),this)}initArray(t,i){if(this.assert(typeof t.length=="number","The number must have a length"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);let r=0;for(;r<this.length;r++)this.words[r]=0;let e,o,a=0;if(i==="be")for(r=t.length-1,e=0;r>=0;r-=3)o=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[e]|=o<<a&67108863,this.words[e+1]=o>>>26-a&67108863,a+=24,a>=26&&(a-=26,e++);else if(i==="le")for(r=0,e=0;r<t.length;r+=3)o=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[e]|=o<<a&67108863,this.words[e+1]=o>>>26-a&67108863,a+=24,a>=26&&(a-=26,e++);return this.strip()}parseHex4Bits(t,i){const r=t.charCodeAt(i);if(r>=48&&r<=57)return r-48;if(r>=65&&r<=70)return r-55;if(r>=97&&r<=102)return r-87;throw new Error("Invalid character in "+t)}parseHexByte(t,i,r){let e=this.parseHex4Bits(t,r);return r-1>=i&&(e|=this.parseHex4Bits(t,r-1)<<4),e}parseHex(t,i,r){this.length=Math.ceil((t.length-i)/6),this.words=new Array(this.length).fill(0);let e=0,o=0;const a=l=>{const f=this.parseHexByte(t,i,l)<<e;this.words[o]|=f&67108863,e>=18?(e-=18,o+=1,this.words[o]|=f>>>26):e+=8};if(r==="be")for(let l=t.length-1;l>=i;l-=2)a(l);else{const l=t.length-i;for(let f=l%2===0?i+1:i;f<t.length;f+=2)a(f)}return this.strip()}parseBaseWord(t,i,r,e){let o=0,a=0;const l=Math.min(t.length,r);for(let f=i;f<l;f++){const n=t.charCodeAt(f)-48;o*=e,n>=49?a=n-49+10:n>=17?a=n-17+10:a=n,this.assert(n>=0&&a<e,"Invalid character"),o+=a}return o}parseBase(t,i,r){this.words=[0],this.length=1;let e=0,o=1;for(;o<=67108863;o*=i)e++;e--,o=o/i|0;const a=t.length-r,l=a%e,f=Math.min(a,a-l)+r;let n=0,c=r;for(;c<f;c+=e)n=this.parseBaseWord(t,c,c+e,i),this.imuln(o),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n);if(l!==0){let d=1;for(n=this.parseBaseWord(t,c,t.length,i),c=0;c<l;c++)d*=i;this.imuln(d),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n)}return this.strip()}copy(t){t.words=new Array(this.length);for(let i=0;i<this.length;i++)t.words[i]=this.words[i];t.length=this.length,t.negative=this.negative,t.red=this.red}static move(t,i){t.words=i.words,t.length=i.length,t.negative=i.negative,t.red=i.red}clone(){const t=new ue;return this.copy(t),t}expand(t){for(;this.length<t;)this.words[this.length++]=0;return this}strip(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this.normSign()}normSign(){return this.length===1&&this.words[0]===0&&(this.negative=0),this}inspect(){return(this.red!==null?"<BN-R: ":"<BN: ")+this.toString(16)+">"}toString(t=10,i=1){if(t===16||t==="hex")return this.toHexString(i);if(t===(t|0)&&t>=2&&t<=36)return this.toBaseString(t,i);throw new Error("Base should be between 2 and 36")}toHexString(t){let i="",r=0,e=0;for(let o=0;o<this.length;o++){const a=this.words[o],l=((a<<r|e)&16777215).toString(16);e=a>>>24-r&16777215,r+=2,r>=26&&(r-=26,o--),e!==0||o!==this.length-1?i=ue.zeros[6-l.length]+l+i:i=l+i}if(e!==0&&(i=e.toString(16)+i),t===0&&i==="0")return"";for(;i.length%t!==0&&t!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}toBaseString(t,i){const r=ue.groupSizes[t],e=ue.groupBases[t];let o="",a=this.clone();for(a.negative=0;!a.isZero();){const l=a.modrn(e).toString(t);a=a.idivn(e),a.isZero()?o=l+o:o=ue.zeros[r-l.length]+l+o}for(this.isZero()&&(o="0"+o);o.length%i!==0;)o="0"+o;return this.negative!==0&&(o="-"+o),o}toNumber(){let t=this.words[0];if(this.length===2)t+=this.words[1]*67108864;else if(this.length===3&&this.words[2]===1)t+=4503599627370496+this.words[1]*67108864;else if(this.length>2)throw new Error("Number can only safely store up to 53 bits");return this.negative!==0?-t:t}toJSON(){return this.toString(16)}toArrayLikeLE(t,i){let r=0,e=0;for(let o=0,a=0;o<this.length;o++){const l=this.words[o]<<a|e;t[r++]=l&255,r<t.length&&(t[r++]=l>>8&255),r<t.length&&(t[r++]=l>>16&255),a===6?(r<t.length&&(t[r++]=l>>24&255),e=0,a=0):(e=l>>>24,a+=2)}if(r<t.length)for(t[r++]=e;r<t.length;)t[r++]=0}toArrayLikeBE(t,i){let r=t.length-1,e=0;for(let o=0,a=0;o<this.length;o++){const l=this.words[o]<<a|e;t[r--]=l&255,r>=0&&(t[r--]=l>>8&255),r>=0&&(t[r--]=l>>16&255),a===6?(r>=0&&(t[r--]=l>>24&255),e=0,a=0):(e=l>>>24,a+=2)}if(r>=0)for(t[r--]=e;r>=0;)t[r--]=0}toArray(t="be",i){this.strip();const r=this.byteLength(),e=i??Math.max(1,r);this.assert(r<=e,"byte array longer than desired length"),this.assert(e>0,"Requested array length <= 0");const o=new Array(e);return t==="le"?this.toArrayLikeLE(o,r):this.toArrayLikeBE(o,r),o}countWordBits(t){if(typeof Math.clz32=="function")return 32-Math.clz32(t);let i=t,r=0;return i>=4096&&(r+=13,i>>>=13),i>=64&&(r+=7,i>>>=7),i>=8&&(r+=4,i>>>=4),i>=2&&(r+=2,i>>>=2),r+i}zeroWordBits(t){if(t===0)return 26;let i=t,r=0;return(i&8191)===0&&(r+=13,i>>>=13),(i&127)===0&&(r+=7,i>>>=7),(i&15)===0&&(r+=4,i>>>=4),(i&3)===0&&(r+=2,i>>>=2),(i&1)===0&&r++,r}bitLength(){const t=this.words[this.length-1],i=this.countWordBits(t);return(this.length-1)*26+i}static toBitArray(t){const i=new Array(t.bitLength());for(let r=0;r<i.length;r++){const e=r/26|0,o=r%26;i[r]=t.words[e]>>>o&1}return i}toBitArray(){return ue.toBitArray(this)}zeroBits(){if(this.isZero())return 0;let t=0;for(let i=0;i<this.length;i++){const r=this.zeroWordBits(this.words[i]);if(t+=r,r!==26)break}return t}byteLength(){return Math.ceil(this.bitLength()/8)}toTwos(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()}fromTwos(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()}isNeg(){return this.negative!==0}neg(){return this.clone().ineg()}ineg(){return this.isZero()||(this.negative^=1),this}iuor(t){for(;this.length<t.length;)this.words[this.length++]=0;for(let i=0;i<t.length;i++)this.words[i]=this.words[i]|t.words[i];return this.strip()}ior(t){return this.assert((this.negative|t.negative)===0),this.iuor(t)}or(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)}uor(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)}iuand(t){const i=Math.min(this.length,t.length);for(let r=0;r<i;r++)this.words[r]=this.words[r]&t.words[r];return this.length=i,this.strip()}iand(t){return this.assert((this.negative|t.negative)===0),this.iuand(t)}and(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)}uand(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)}iuxor(t){if(this.length>t.length)for(let i=0;i<t.length;i++)this.words[i]=this.words[i]^t.words[i];else{for(let i=0;i<this.length;i++)this.words[i]=this.words[i]^t.words[i];for(let i=this.length;i<t.length;i++)this.words[i]=t.words[i];this.length=t.length}return this.strip()}ixor(t){return this.assert((this.negative|t.negative)===0,"Neither number can be negative"),this.iuxor(t)}xor(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)}uxor(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)}inotn(t){this.assert(typeof t=="number"&&t>=0,"The width needs to be a number greater than zero");let i=Math.ceil(t/26)|0;const r=t%26;this.expand(i),r>0&&i--;let e=0;for(;e<i;e++)this.words[e]=~this.words[e]&67108863;return r>0&&(this.words[e]=~this.words[e]&67108863>>26-r),this.strip()}notn(t){return this.clone().inotn(t)}setn(t,i){this.assert(typeof t=="number"&&t>=0);const r=t/26|0,e=t%26;return this.expand(r+1),i===1||i===!0?this.words[r]=this.words[r]|1<<e:this.words[r]=this.words[r]&~(1<<e),this.strip()}iadd(t){let i;if(this.negative!==0&&t.negative===0)return this.negative=0,i=this.isub(t),this.negative^=1,this.normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,i=this.isub(t),t.negative=1,i.normSign();let r,e;this.length>t.length?(r=this,e=t):(r=t,e=this);let o=0,a=0;for(;a<e.length;a++)i=(r.words[a]|0)+(e.words[a]|0)+o,this.words[a]=i&67108863,o=i>>>26;for(;o!==0&&a<r.length;a++)i=(r.words[a]|0)+o,this.words[a]=i&67108863,o=i>>>26;if(this.length=r.length,o!==0)this.words[this.length]=o,this.length++;else if(r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this}add(t){let i;return t.negative!==0&&this.negative===0?(t.negative=0,i=this.sub(t),t.negative^=1,i):t.negative===0&&this.negative!==0?(this.negative=0,i=t.sub(this),this.negative=1,i):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)}isub(t){let i;if(t.negative!==0)return t.negative=0,i=this.iadd(t),t.negative=1,i.normSign();if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this.normSign();const r=this.cmp(t);if(r===0)return this.negative=0,this.length=1,this.words[0]=0,this;let e,o;r>0?(e=this,o=t):(e=t,o=this);let a=0,l=0;for(;l<o.length;l++)i=(e.words[l]|0)-(o.words[l]|0)+a,a=i>>26,this.words[l]=i&67108863;for(;a!==0&&l<e.length;l++)i=(e.words[l]|0)+a,a=i>>26,this.words[l]=i&67108863;if(a===0&&l<e.length&&e!==this)for(;l<e.length;l++)this.words[l]=e.words[l];return this.length=Math.max(this.length,l),e!==this&&(this.negative=1),this.strip()}sub(t){return this.clone().isub(t)}smallMulTo(t,i,r){r.negative=i.negative^t.negative;let e=t.length+i.length|0;r.length=e,e=e-1|0;let o=t.words[0]|0,a=i.words[0]|0,l=o*a;const f=l&67108863;let n=l/67108864|0;r.words[0]=f;let c=1;for(;c<e;c++){let d=n>>>26,y=n&67108863;const p=Math.min(c,i.length-1);for(let g=Math.max(0,c-t.length+1);g<=p;g++){const b=c-g|0;o=t.words[b]|0,a=i.words[g]|0,l=o*a+y,d+=l/67108864|0,y=l&67108863}r.words[c]=y|0,n=d|0}return n!==0?r.words[c]=n|0:r.length--,r.strip()}comb10MulTo(t,i,r){const e=t.words,o=i.words,a=r.words;let l=0,f,n,c;const d=e[0]|0,y=d&8191,p=d>>>13,g=e[1]|0,b=g&8191,w=g>>>13,v=e[2]|0,_=v&8191,S=v>>>13,T=e[3]|0,I=T&8191,k=T>>>13,O=e[4]|0,A=O&8191,R=O>>>13,P=e[5]|0,C=P&8191,N=P>>>13,D=e[6]|0,U=D&8191,F=D>>>13,L=e[7]|0,j=L&8191,V=L>>>13,W=e[8]|0,q=W&8191,$=W>>>13,Y=e[9]|0,Q=Y&8191,J=Y>>>13,vt=o[0]|0,wt=vt&8191,dt=vt>>>13,yt=o[1]|0,_t=yt&8191,tt=yt>>>13,xt=o[2]|0,It=xt&8191,Nt=xt>>>13,Lt=o[3]|0,ne=Lt&8191,Ut=Lt>>>13,Vt=o[4]|0,Jt=Vt&8191,Ct=Vt>>>13,K=o[5]|0,ut=K&8191,st=K>>>13,Mt=o[6]|0,Ht=Mt&8191,Kt=Mt>>>13,Xt=o[7]|0,Qt=Xt&8191,Ft=Xt>>>13,Rt=o[8]|0,St=Rt&8191,Ot=Rt>>>13,Wt=o[9]|0,Gt=Wt&8191,z=Wt>>>13;r.negative=t.negative^i.negative,r.length=19,f=Math.imul(y,wt),n=Math.imul(y,dt),n=n+Math.imul(p,wt)|0,c=Math.imul(p,dt);let G=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(G>>>26)|0,G&=67108863,f=Math.imul(b,wt),n=Math.imul(b,dt),n=n+Math.imul(w,wt)|0,c=Math.imul(w,dt),f=f+Math.imul(y,_t)|0,n=n+Math.imul(y,tt)|0,n=n+Math.imul(p,_t)|0,c=c+Math.imul(p,tt)|0;let at=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(at>>>26)|0,at&=67108863,f=Math.imul(_,wt),n=Math.imul(_,dt),n=n+Math.imul(S,wt)|0,c=Math.imul(S,dt),f=f+Math.imul(b,_t)|0,n=n+Math.imul(b,tt)|0,n=n+Math.imul(w,_t)|0,c=c+Math.imul(w,tt)|0,f=f+Math.imul(y,It)|0,n=n+Math.imul(y,Nt)|0,n=n+Math.imul(p,It)|0,c=c+Math.imul(p,Nt)|0;let ht=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(ht>>>26)|0,ht&=67108863,f=Math.imul(I,wt),n=Math.imul(I,dt),n=n+Math.imul(k,wt)|0,c=Math.imul(k,dt),f=f+Math.imul(_,_t)|0,n=n+Math.imul(_,tt)|0,n=n+Math.imul(S,_t)|0,c=c+Math.imul(S,tt)|0,f=f+Math.imul(b,It)|0,n=n+Math.imul(b,Nt)|0,n=n+Math.imul(w,It)|0,c=c+Math.imul(w,Nt)|0,f=f+Math.imul(y,ne)|0,n=n+Math.imul(y,Ut)|0,n=n+Math.imul(p,ne)|0,c=c+Math.imul(p,Ut)|0;let lt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(lt>>>26)|0,lt&=67108863,f=Math.imul(A,wt),n=Math.imul(A,dt),n=n+Math.imul(R,wt)|0,c=Math.imul(R,dt),f=f+Math.imul(I,_t)|0,n=n+Math.imul(I,tt)|0,n=n+Math.imul(k,_t)|0,c=c+Math.imul(k,tt)|0,f=f+Math.imul(_,It)|0,n=n+Math.imul(_,Nt)|0,n=n+Math.imul(S,It)|0,c=c+Math.imul(S,Nt)|0,f=f+Math.imul(b,ne)|0,n=n+Math.imul(b,Ut)|0,n=n+Math.imul(w,ne)|0,c=c+Math.imul(w,Ut)|0,f=f+Math.imul(y,Jt)|0,n=n+Math.imul(y,Ct)|0,n=n+Math.imul(p,Jt)|0,c=c+Math.imul(p,Ct)|0;let bt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,f=Math.imul(C,wt),n=Math.imul(C,dt),n=n+Math.imul(N,wt)|0,c=Math.imul(N,dt),f=f+Math.imul(A,_t)|0,n=n+Math.imul(A,tt)|0,n=n+Math.imul(R,_t)|0,c=c+Math.imul(R,tt)|0,f=f+Math.imul(I,It)|0,n=n+Math.imul(I,Nt)|0,n=n+Math.imul(k,It)|0,c=c+Math.imul(k,Nt)|0,f=f+Math.imul(_,ne)|0,n=n+Math.imul(_,Ut)|0,n=n+Math.imul(S,ne)|0,c=c+Math.imul(S,Ut)|0,f=f+Math.imul(b,Jt)|0,n=n+Math.imul(b,Ct)|0,n=n+Math.imul(w,Jt)|0,c=c+Math.imul(w,Ct)|0,f=f+Math.imul(y,ut)|0,n=n+Math.imul(y,st)|0,n=n+Math.imul(p,ut)|0,c=c+Math.imul(p,st)|0;let Dt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,f=Math.imul(U,wt),n=Math.imul(U,dt),n=n+Math.imul(F,wt)|0,c=Math.imul(F,dt),f=f+Math.imul(C,_t)|0,n=n+Math.imul(C,tt)|0,n=n+Math.imul(N,_t)|0,c=c+Math.imul(N,tt)|0,f=f+Math.imul(A,It)|0,n=n+Math.imul(A,Nt)|0,n=n+Math.imul(R,It)|0,c=c+Math.imul(R,Nt)|0,f=f+Math.imul(I,ne)|0,n=n+Math.imul(I,Ut)|0,n=n+Math.imul(k,ne)|0,c=c+Math.imul(k,Ut)|0,f=f+Math.imul(_,Jt)|0,n=n+Math.imul(_,Ct)|0,n=n+Math.imul(S,Jt)|0,c=c+Math.imul(S,Ct)|0,f=f+Math.imul(b,ut)|0,n=n+Math.imul(b,st)|0,n=n+Math.imul(w,ut)|0,c=c+Math.imul(w,st)|0,f=f+Math.imul(y,Ht)|0,n=n+Math.imul(y,Kt)|0,n=n+Math.imul(p,Ht)|0,c=c+Math.imul(p,Kt)|0;let jt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(jt>>>26)|0,jt&=67108863,f=Math.imul(j,wt),n=Math.imul(j,dt),n=n+Math.imul(V,wt)|0,c=Math.imul(V,dt),f=f+Math.imul(U,_t)|0,n=n+Math.imul(U,tt)|0,n=n+Math.imul(F,_t)|0,c=c+Math.imul(F,tt)|0,f=f+Math.imul(C,It)|0,n=n+Math.imul(C,Nt)|0,n=n+Math.imul(N,It)|0,c=c+Math.imul(N,Nt)|0,f=f+Math.imul(A,ne)|0,n=n+Math.imul(A,Ut)|0,n=n+Math.imul(R,ne)|0,c=c+Math.imul(R,Ut)|0,f=f+Math.imul(I,Jt)|0,n=n+Math.imul(I,Ct)|0,n=n+Math.imul(k,Jt)|0,c=c+Math.imul(k,Ct)|0,f=f+Math.imul(_,ut)|0,n=n+Math.imul(_,st)|0,n=n+Math.imul(S,ut)|0,c=c+Math.imul(S,st)|0,f=f+Math.imul(b,Ht)|0,n=n+Math.imul(b,Kt)|0,n=n+Math.imul(w,Ht)|0,c=c+Math.imul(w,Kt)|0,f=f+Math.imul(y,Qt)|0,n=n+Math.imul(y,Ft)|0,n=n+Math.imul(p,Qt)|0,c=c+Math.imul(p,Ft)|0;let Yt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,f=Math.imul(q,wt),n=Math.imul(q,dt),n=n+Math.imul($,wt)|0,c=Math.imul($,dt),f=f+Math.imul(j,_t)|0,n=n+Math.imul(j,tt)|0,n=n+Math.imul(V,_t)|0,c=c+Math.imul(V,tt)|0,f=f+Math.imul(U,It)|0,n=n+Math.imul(U,Nt)|0,n=n+Math.imul(F,It)|0,c=c+Math.imul(F,Nt)|0,f=f+Math.imul(C,ne)|0,n=n+Math.imul(C,Ut)|0,n=n+Math.imul(N,ne)|0,c=c+Math.imul(N,Ut)|0,f=f+Math.imul(A,Jt)|0,n=n+Math.imul(A,Ct)|0,n=n+Math.imul(R,Jt)|0,c=c+Math.imul(R,Ct)|0,f=f+Math.imul(I,ut)|0,n=n+Math.imul(I,st)|0,n=n+Math.imul(k,ut)|0,c=c+Math.imul(k,st)|0,f=f+Math.imul(_,Ht)|0,n=n+Math.imul(_,Kt)|0,n=n+Math.imul(S,Ht)|0,c=c+Math.imul(S,Kt)|0,f=f+Math.imul(b,Qt)|0,n=n+Math.imul(b,Ft)|0,n=n+Math.imul(w,Qt)|0,c=c+Math.imul(w,Ft)|0,f=f+Math.imul(y,St)|0,n=n+Math.imul(y,Ot)|0,n=n+Math.imul(p,St)|0,c=c+Math.imul(p,Ot)|0;let te=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(te>>>26)|0,te&=67108863,f=Math.imul(Q,wt),n=Math.imul(Q,dt),n=n+Math.imul(J,wt)|0,c=Math.imul(J,dt),f=f+Math.imul(q,_t)|0,n=n+Math.imul(q,tt)|0,n=n+Math.imul($,_t)|0,c=c+Math.imul($,tt)|0,f=f+Math.imul(j,It)|0,n=n+Math.imul(j,Nt)|0,n=n+Math.imul(V,It)|0,c=c+Math.imul(V,Nt)|0,f=f+Math.imul(U,ne)|0,n=n+Math.imul(U,Ut)|0,n=n+Math.imul(F,ne)|0,c=c+Math.imul(F,Ut)|0,f=f+Math.imul(C,Jt)|0,n=n+Math.imul(C,Ct)|0,n=n+Math.imul(N,Jt)|0,c=c+Math.imul(N,Ct)|0,f=f+Math.imul(A,ut)|0,n=n+Math.imul(A,st)|0,n=n+Math.imul(R,ut)|0,c=c+Math.imul(R,st)|0,f=f+Math.imul(I,Ht)|0,n=n+Math.imul(I,Kt)|0,n=n+Math.imul(k,Ht)|0,c=c+Math.imul(k,Kt)|0,f=f+Math.imul(_,Qt)|0,n=n+Math.imul(_,Ft)|0,n=n+Math.imul(S,Qt)|0,c=c+Math.imul(S,Ft)|0,f=f+Math.imul(b,St)|0,n=n+Math.imul(b,Ot)|0,n=n+Math.imul(w,St)|0,c=c+Math.imul(w,Ot)|0,f=f+Math.imul(y,Gt)|0,n=n+Math.imul(y,z)|0,n=n+Math.imul(p,Gt)|0,c=c+Math.imul(p,z)|0;let oe=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(oe>>>26)|0,oe&=67108863,f=Math.imul(Q,_t),n=Math.imul(Q,tt),n=n+Math.imul(J,_t)|0,c=Math.imul(J,tt),f=f+Math.imul(q,It)|0,n=n+Math.imul(q,Nt)|0,n=n+Math.imul($,It)|0,c=c+Math.imul($,Nt)|0,f=f+Math.imul(j,ne)|0,n=n+Math.imul(j,Ut)|0,n=n+Math.imul(V,ne)|0,c=c+Math.imul(V,Ut)|0,f=f+Math.imul(U,Jt)|0,n=n+Math.imul(U,Ct)|0,n=n+Math.imul(F,Jt)|0,c=c+Math.imul(F,Ct)|0,f=f+Math.imul(C,ut)|0,n=n+Math.imul(C,st)|0,n=n+Math.imul(N,ut)|0,c=c+Math.imul(N,st)|0,f=f+Math.imul(A,Ht)|0,n=n+Math.imul(A,Kt)|0,n=n+Math.imul(R,Ht)|0,c=c+Math.imul(R,Kt)|0,f=f+Math.imul(I,Qt)|0,n=n+Math.imul(I,Ft)|0,n=n+Math.imul(k,Qt)|0,c=c+Math.imul(k,Ft)|0,f=f+Math.imul(_,St)|0,n=n+Math.imul(_,Ot)|0,n=n+Math.imul(S,St)|0,c=c+Math.imul(S,Ot)|0,f=f+Math.imul(b,Gt)|0,n=n+Math.imul(b,z)|0,n=n+Math.imul(w,Gt)|0,c=c+Math.imul(w,z)|0;let ee=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(ee>>>26)|0,ee&=67108863,f=Math.imul(Q,It),n=Math.imul(Q,Nt),n=n+Math.imul(J,It)|0,c=Math.imul(J,Nt),f=f+Math.imul(q,ne)|0,n=n+Math.imul(q,Ut)|0,n=n+Math.imul($,ne)|0,c=c+Math.imul($,Ut)|0,f=f+Math.imul(j,Jt)|0,n=n+Math.imul(j,Ct)|0,n=n+Math.imul(V,Jt)|0,c=c+Math.imul(V,Ct)|0,f=f+Math.imul(U,ut)|0,n=n+Math.imul(U,st)|0,n=n+Math.imul(F,ut)|0,c=c+Math.imul(F,st)|0,f=f+Math.imul(C,Ht)|0,n=n+Math.imul(C,Kt)|0,n=n+Math.imul(N,Ht)|0,c=c+Math.imul(N,Kt)|0,f=f+Math.imul(A,Qt)|0,n=n+Math.imul(A,Ft)|0,n=n+Math.imul(R,Qt)|0,c=c+Math.imul(R,Ft)|0,f=f+Math.imul(I,St)|0,n=n+Math.imul(I,Ot)|0,n=n+Math.imul(k,St)|0,c=c+Math.imul(k,Ot)|0,f=f+Math.imul(_,Gt)|0,n=n+Math.imul(_,z)|0,n=n+Math.imul(S,Gt)|0,c=c+Math.imul(S,z)|0;let pe=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(pe>>>26)|0,pe&=67108863,f=Math.imul(Q,ne),n=Math.imul(Q,Ut),n=n+Math.imul(J,ne)|0,c=Math.imul(J,Ut),f=f+Math.imul(q,Jt)|0,n=n+Math.imul(q,Ct)|0,n=n+Math.imul($,Jt)|0,c=c+Math.imul($,Ct)|0,f=f+Math.imul(j,ut)|0,n=n+Math.imul(j,st)|0,n=n+Math.imul(V,ut)|0,c=c+Math.imul(V,st)|0,f=f+Math.imul(U,Ht)|0,n=n+Math.imul(U,Kt)|0,n=n+Math.imul(F,Ht)|0,c=c+Math.imul(F,Kt)|0,f=f+Math.imul(C,Qt)|0,n=n+Math.imul(C,Ft)|0,n=n+Math.imul(N,Qt)|0,c=c+Math.imul(N,Ft)|0,f=f+Math.imul(A,St)|0,n=n+Math.imul(A,Ot)|0,n=n+Math.imul(R,St)|0,c=c+Math.imul(R,Ot)|0,f=f+Math.imul(I,Gt)|0,n=n+Math.imul(I,z)|0,n=n+Math.imul(k,Gt)|0,c=c+Math.imul(k,z)|0;let Bt=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,f=Math.imul(Q,Jt),n=Math.imul(Q,Ct),n=n+Math.imul(J,Jt)|0,c=Math.imul(J,Ct),f=f+Math.imul(q,ut)|0,n=n+Math.imul(q,st)|0,n=n+Math.imul($,ut)|0,c=c+Math.imul($,st)|0,f=f+Math.imul(j,Ht)|0,n=n+Math.imul(j,Kt)|0,n=n+Math.imul(V,Ht)|0,c=c+Math.imul(V,Kt)|0,f=f+Math.imul(U,Qt)|0,n=n+Math.imul(U,Ft)|0,n=n+Math.imul(F,Qt)|0,c=c+Math.imul(F,Ft)|0,f=f+Math.imul(C,St)|0,n=n+Math.imul(C,Ot)|0,n=n+Math.imul(N,St)|0,c=c+Math.imul(N,Ot)|0,f=f+Math.imul(A,Gt)|0,n=n+Math.imul(A,z)|0,n=n+Math.imul(R,Gt)|0,c=c+Math.imul(R,z)|0;let ce=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(ce>>>26)|0,ce&=67108863,f=Math.imul(Q,ut),n=Math.imul(Q,st),n=n+Math.imul(J,ut)|0,c=Math.imul(J,st),f=f+Math.imul(q,Ht)|0,n=n+Math.imul(q,Kt)|0,n=n+Math.imul($,Ht)|0,c=c+Math.imul($,Kt)|0,f=f+Math.imul(j,Qt)|0,n=n+Math.imul(j,Ft)|0,n=n+Math.imul(V,Qt)|0,c=c+Math.imul(V,Ft)|0,f=f+Math.imul(U,St)|0,n=n+Math.imul(U,Ot)|0,n=n+Math.imul(F,St)|0,c=c+Math.imul(F,Ot)|0,f=f+Math.imul(C,Gt)|0,n=n+Math.imul(C,z)|0,n=n+Math.imul(N,Gt)|0,c=c+Math.imul(N,z)|0;let Si=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Si>>>26)|0,Si&=67108863,f=Math.imul(Q,Ht),n=Math.imul(Q,Kt),n=n+Math.imul(J,Ht)|0,c=Math.imul(J,Kt),f=f+Math.imul(q,Qt)|0,n=n+Math.imul(q,Ft)|0,n=n+Math.imul($,Qt)|0,c=c+Math.imul($,Ft)|0,f=f+Math.imul(j,St)|0,n=n+Math.imul(j,Ot)|0,n=n+Math.imul(V,St)|0,c=c+Math.imul(V,Ot)|0,f=f+Math.imul(U,Gt)|0,n=n+Math.imul(U,z)|0,n=n+Math.imul(F,Gt)|0,c=c+Math.imul(F,z)|0;let Qe=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,f=Math.imul(Q,Qt),n=Math.imul(Q,Ft),n=n+Math.imul(J,Qt)|0,c=Math.imul(J,Ft),f=f+Math.imul(q,St)|0,n=n+Math.imul(q,Ot)|0,n=n+Math.imul($,St)|0,c=c+Math.imul($,Ot)|0,f=f+Math.imul(j,Gt)|0,n=n+Math.imul(j,z)|0,n=n+Math.imul(V,Gt)|0,c=c+Math.imul(V,z)|0;let Re=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,f=Math.imul(Q,St),n=Math.imul(Q,Ot),n=n+Math.imul(J,St)|0,c=Math.imul(J,Ot),f=f+Math.imul(q,Gt)|0,n=n+Math.imul(q,z)|0,n=n+Math.imul($,Gt)|0,c=c+Math.imul($,z)|0;let We=(l+f|0)+((n&8191)<<13)|0;l=(c+(n>>>13)|0)+(We>>>26)|0,We&=67108863,f=Math.imul(Q,Gt),n=Math.imul(Q,z),n=n+Math.imul(J,Gt)|0,c=Math.imul(J,z);let Ti=(l+f|0)+((n&8191)<<13)|0;return l=(c+(n>>>13)|0)+(Ti>>>26)|0,Ti&=67108863,a[0]=G,a[1]=at,a[2]=ht,a[3]=lt,a[4]=bt,a[5]=Dt,a[6]=jt,a[7]=Yt,a[8]=te,a[9]=oe,a[10]=ee,a[11]=pe,a[12]=Bt,a[13]=ce,a[14]=Si,a[15]=Qe,a[16]=Re,a[17]=We,a[18]=Ti,l!==0&&(a[19]=l,r.length++),r}bigMulTo(t,i,r){r.negative=i.negative^t.negative,r.length=t.length+i.length;let e=0,o=0,a=0;for(;a<r.length-1;a++){let l=o;o=0;let f=e&67108863;const n=Math.min(a,i.length-1);for(let c=Math.max(0,a-t.length+1);c<=n;c++){const d=a-c,y=t.words[d]|0,p=i.words[c]|0,g=y*p;let b=g&67108863;l=l+(g/67108864|0)|0,b=b+f|0,f=b&67108863,l=l+(b>>>26)|0,o+=l>>>26,l&=67108863}r.words[a]=f,e=l,l=o}return e!==0?r.words[a]=e:r.length--,r.strip()}mulTo(t,i){let r;const e=this.length+t.length;return this.length===10&&t.length===10?r=this.comb10MulTo(this,t,i):e<63?r=this.smallMulTo(this,t,i):r=this.bigMulTo(this,t,i),r}mul(t){const i=new ue;return i.words=new Array(this.length+t.length),this.mulTo(t,i)}imul(t){return this.clone().mulTo(t,this)}imuln(t){const i=t<0;i&&(t=-t),this.assert(typeof t=="number"),this.assert(t<67108864);let r=0,e=0;for(;e<this.length;e++){const o=(this.words[e]|0)*t,a=(o&67108863)+(r&67108863);r>>=26,r+=o/67108864|0,r+=a>>>26,this.words[e]=a&67108863}return r!==0&&(this.words[e]=r,this.length++),i?this.ineg():this}muln(t){return this.clone().imuln(t)}sqr(){return this.mul(this)}isqr(){return this.imul(this.clone())}pow(t){const i=ue.toBitArray(t);if(i.length===0)return new ue(1);let r=this,e=0;for(;e<i.length&&i[e]===0;e++,r=r.sqr());if(++e<i.length)for(let o=r.sqr();e<i.length;e++,o=o.sqr())i[e]!==0&&(r=r.mul(o));return r}iushln(t){this.assert(typeof t=="number"&&t>=0);const i=t%26,r=(t-i)/26,e=67108863>>>26-i<<26-i;let o;if(i!==0){let a=0;for(o=0;o<this.length;o++){const l=this.words[o]&e,f=(this.words[o]|0)-l<<i;this.words[o]=f|a,a=l>>>26-i}a!==0&&(this.words[o]=a,this.length++)}if(r!==0){for(o=this.length-1;o>=0;o--)this.words[o+r]=this.words[o];for(o=0;o<r;o++)this.words[o]=0;this.length+=r}return this.strip()}ishln(t){return this.assert(this.negative===0),this.iushln(t)}iushrn(t,i,r){this.assert(typeof t=="number"&&t>=0);let e;typeof i=="number"&&i!==0?e=(i-i%26)/26:e=0;const o=t%26,a=Math.min((t-o)/26,this.length),l=67108863^67108863>>>o<<o,f=r;e-=a,e=Math.max(0,e);let n=0;if(typeof f<"u"){for(;n<a;n++)f.words[n]=this.words[n];f.length=a}if(a!==0)if(this.length>a)for(this.length-=a,n=0;n<this.length;n++)this.words[n]=this.words[n+a];else this.words[0]=0,this.length=1;let c=0;for(n=this.length-1;n>=0&&(c!==0||n>=e);n--){const d=this.words[n]|0;this.words[n]=c<<26-o|d>>>o,c=d&l}return f!=null&&c!==0&&(f.words[f.length++]=c),this.length===0&&(this.words[0]=0,this.length=1),this.strip()}ishrn(t,i,r){return this.assert(this.negative===0),this.iushrn(t,i,r)}shln(t){return this.clone().ishln(t)}ushln(t){return this.clone().iushln(t)}shrn(t){return this.clone().ishrn(t)}ushrn(t){return this.clone().iushrn(t)}testn(t){this.assert(typeof t=="number"&&t>=0);const i=t%26,r=(t-i)/26,e=1<<i;return this.length<=r?!1:!!(this.words[r]&e)}imaskn(t){this.assert(typeof t=="number"&&t>=0);const i=t%26;let r=(t-i)/26;if(this.assert(this.negative===0,"imaskn works only with positive numbers"),this.length<=r)return this;if(i!==0&&r++,this.length=Math.min(r,this.length),i!==0){const e=67108863^67108863>>>i<<i;this.words[this.length-1]&=e}return this.strip()}maskn(t){return this.clone().imaskn(t)}iaddn(t){return this.assert(typeof t=="number"),this.assert(t<67108864,"num is too large"),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<=t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)}_iaddn(t){this.words[0]+=t;let i=0;for(;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this}isubn(t){if(this.assert(typeof t=="number"),this.assert(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(let i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this.strip()}addn(t){return this.clone().iaddn(t)}subn(t){return this.clone().isubn(t)}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}_ishlnsubmul(t,i,r){const e=t.length+r;let o;this.expand(e);let a,l=0;for(o=0;o<t.length;o++){a=(this.words[o+r]|0)+l;const f=(t.words[o]|0)*i;a-=f&67108863,l=(a>>26)-(f/67108864|0),this.words[o+r]=a&67108863}for(;o<this.length-r;o++)a=(this.words[o+r]|0)+l,l=a>>26,this.words[o+r]=a&67108863;if(l===0)return this.strip();for(this.assert(l===-1,"carry must be -1"),l=0,o=0;o<this.length;o++)a=-(this.words[o]|0)+l,l=a>>26,this.words[o]=a&67108863;return this.negative=1,this.strip()}wordDiv(t,i){let r=this.length-t.length,e=this.clone(),o=t,a=o.words[o.length-1]|0;r=26-this.countWordBits(a),r!==0&&(o=o.ushln(r),e.iushln(r),a=o.words[o.length-1]|0);const f=e.length-o.length;let n;if(i!=="mod"){n=new ue,n.length=f+1,n.words=new Array(n.length);for(let d=0;d<n.length;d++)n.words[d]=0}const c=e.clone()._ishlnsubmul(o,1,f);c.negative===0&&(e=c,typeof n<"u"&&(n.words[f]=1));for(let d=f-1;d>=0;d--){let y=(e.words[o.length+d]|0)*67108864+(e.words[o.length+d-1]|0);for(y=Math.min(y/a|0,67108863),e._ishlnsubmul(o,y,d);e.negative!==0;)y--,e.negative=0,e._ishlnsubmul(o,1,d),e.isZero()||(e.negative^=1);typeof n<"u"&&(n.words[d]=y)}return typeof n<"u"&&n.strip(),e.strip(),i!=="div"&&r!==0&&e.iushrn(r),{div:n??null,mod:e}}divmod(t,i,r){if(this.assert(!t.isZero()),this.isZero())return{div:new ue(0),mod:new ue(0)};let e,o,a;return this.negative!==0&&t.negative===0?(a=this.neg().divmod(t,i),i!=="mod"&&(e=a.div.neg()),i!=="div"&&(o=a.mod.neg(),r===!0&&o.negative!==0&&o.iadd(t)),{div:e,mod:o}):this.negative===0&&t.negative!==0?(a=this.divmod(t.neg(),i),i!=="mod"&&(e=a.div.neg()),{div:e,mod:a.mod}):(this.negative&t.negative)!==0?(a=this.neg().divmod(t.neg(),i),i!=="div"&&(o=a.mod.neg(),r===!0&&o.negative!==0&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new ue(0),mod:this}:t.length===1?i==="div"?{div:this.divn(t.words[0]),mod:null}:i==="mod"?{div:null,mod:new ue(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new ue(this.modrn(t.words[0]))}:this.wordDiv(t,i)}div(t){return this.divmod(t,"div",!1).div}mod(t){return this.divmod(t,"mod",!1).mod}umod(t){return this.divmod(t,"mod",!0).mod}divRound(t){const i=this.divmod(t);if(i.mod.isZero())return i.div;const r=i.div.negative!==0?i.mod.isub(t):i.mod,e=t.ushrn(1),o=t.andln(1),a=r.cmp(e);return a<0||o===1&&a===0?i.div:i.div.negative!==0?i.div.isubn(1):i.div.iaddn(1)}modrn(t){const i=t<0;i&&(t=-t),this.assert(t<=67108863);const r=(1<<26)%t;let e=0;for(let o=this.length-1;o>=0;o--)e=(r*e+(this.words[o]|0))%t;return i?-e:e}idivn(t){const i=t<0;i&&(t=-t),this.assert(t<=67108863);let r=0;for(let e=this.length-1;e>=0;e--){const o=(this.words[e]|0)+r*67108864;this.words[e]=o/t|0,r=o%t}return this.strip(),i?this.ineg():this}divn(t){return this.clone().idivn(t)}egcd(t){this.assert(t.negative===0,"p must not be negative"),this.assert(!t.isZero(),"p must not be zero");let i=this;const r=t.clone();i.negative!==0?i=i.umod(t):i=i.clone();const e=new ue(1),o=new ue(0),a=new ue(0),l=new ue(1);let f=0;for(;i.isEven()&&r.isEven();)i.iushrn(1),r.iushrn(1),++f;const n=r.clone(),c=i.clone();for(;!i.isZero();){let d=0,y=1;for(;(i.words[0]&y)===0&&d<26;++d,y<<=1);if(d>0)for(i.iushrn(d);d-- >0;)(e.isOdd()||o.isOdd())&&(e.iadd(n),o.isub(c)),e.iushrn(1),o.iushrn(1);let p=0,g=1;for(;(r.words[0]&g)===0&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||l.isOdd())&&(a.iadd(n),l.isub(c)),a.iushrn(1),l.iushrn(1);i.cmp(r)>=0?(i.isub(r),e.isub(a),o.isub(l)):(r.isub(i),a.isub(e),l.isub(o))}return{a,b:l,gcd:r.iushln(f)}}_invmp(t){this.assert(t.negative===0,"p must not be negative"),this.assert(!t.isZero(),"p must not be zero");let i=this;const r=t.clone();i.negative!==0?i=i.umod(t):i=i.clone();const e=new ue(1),o=new ue(0),a=r.clone();for(;i.cmpn(1)>0&&r.cmpn(1)>0;){let f=0,n=1;for(;(i.words[0]&n)===0&&f<26;++f,n<<=1);if(f>0)for(i.iushrn(f);f-- >0;)e.isOdd()&&e.iadd(a),e.iushrn(1);let c=0,d=1;for(;(r.words[0]&d)===0&&c<26;++c,d<<=1);if(c>0)for(r.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);i.cmp(r)>=0?(i.isub(r),e.isub(o)):(r.isub(i),o.isub(e))}let l;return i.cmpn(1)===0?l=e:l=o,l.cmpn(0)<0&&l.iadd(t),l}gcd(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();let i=this.clone(),r=t.clone();i.negative=0,r.negative=0;let e=0;for(;i.isEven()&&r.isEven();e++)i.iushrn(1),r.iushrn(1);do{for(;i.isEven();)i.iushrn(1);for(;r.isEven();)r.iushrn(1);const o=i.cmp(r);if(o<0){const a=i;i=r,r=a}else if(o===0||r.cmpn(1)===0)break;i.isub(r)}while(!0);return r.iushln(e)}invm(t){return this.egcd(t).a.umod(t)}isEven(){return(this.words[0]&1)===0}isOdd(){return(this.words[0]&1)===1}andln(t){return this.words[0]&t}bincn(t){this.assert(typeof t=="number");const i=t%26,r=(t-i)/26,e=1<<i;if(this.length<=r)return this.expand(r+1),this.words[r]|=e,this;let o=e,a=r;for(;o!==0&&a<this.length;a++){let l=this.words[a]|0;l+=o,o=l>>>26,l&=67108863,this.words[a]=l}return o!==0&&(this.words[a]=o,this.length++),this}isZero(){return this.length===1&&this.words[0]===0}cmpn(t){const i=t<0;if(this.negative!==0&&!i)return-1;if(this.negative===0&&i)return 1;this.strip();let r;if(this.length>1)r=1;else{i&&(t=-t),this.assert(t<=67108863,"Number is too big");const e=this.words[0]|0;r=e===t?0:e<t?-1:1}return this.negative!==0?-r|0:r}cmp(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;const i=this.ucmp(t);return this.negative!==0?-i|0:i}ucmp(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;let i=0;for(let r=this.length-1;r>=0;r--){const e=this.words[r]|0,o=t.words[r]|0;if(e!==o){e<o?i=-1:e>o&&(i=1);break}}return i}gtn(t){return this.cmpn(t)===1}gt(t){return this.cmp(t)===1}gten(t){return this.cmpn(t)>=0}gte(t){return this.cmp(t)>=0}ltn(t){return this.cmpn(t)===-1}lt(t){return this.cmp(t)===-1}lten(t){return this.cmpn(t)<=0}lte(t){return this.cmp(t)<=0}eqn(t){return this.cmpn(t)===0}eq(t){return this.cmp(t)===0}toRed(t){return this.assert(this.red==null,"Already a number in reduction context"),this.assert(this.negative===0,"red works only with positives"),t.convertTo(this).forceRed(t)}fromRed(){return this.assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)}forceRed(t){return this.red=t,this}redAdd(t){return this.assert(this.red,"redAdd works only with red numbers"),this.red.add(this,t)}redIAdd(t){return this.assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)}redSub(t){return this.assert(this.red,"redSub works only with red numbers"),this.red.sub(this,t)}redISub(t){return this.assert(this.red,"redISub works only with red numbers"),this.red.isub(this,t)}redShl(t){return this.assert(this.red,"redShl works only with red numbers"),this.red.shl(this,t)}redMul(t){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,t),this.red.mul(this,t)}redIMul(t){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,t),this.red.imul(this,t)}redSqr(){return this.assert(this.red,"redSqr works only with red numbers"),this.red.verify1(this),this.red.sqr(this)}redISqr(){return this.assert(this.red,"redISqr works only with red numbers"),this.red.verify1(this),this.red.isqr(this)}redSqrt(){return this.assert(this.red,"redSqrt works only with red numbers"),this.red.verify1(this),this.red.sqrt(this)}redInvm(){return this.assert(this.red,"redInvm works only with red numbers"),this.red.verify1(this),this.red.invm(this)}redNeg(){return this.assert(this.red,"redNeg works only with red numbers"),this.red.verify1(this),this.red.neg(this)}redPow(t){return this.assert(this.red!=null&&t.red==null,"redPow(normalNum)"),this.red.verify1(this),this.red.pow(this,t)}static fromHex(t,i){return i==="big"?new ue(t,16):new ue(t,16,"le")}toHex(t=0){return this.toString("hex",t*2)}static fromJSON(t){return new ue(t)}static fromNumber(t){return new ue(t)}static fromString(t,i){return new ue(t,i)}static fromSm(t,i="big"){let r=t;return t.length===0?new ue(0):(i==="little"&&(r=[...r],r=r.reverse()),(r[0]&128)!==0?(r=[...r],r[0]=r[0]&127,new ue(r).neg()):new ue(r))}toSm(t="big"){let i;return this.cmpn(0)===-1?(i=this.neg().toArray(),(i[0]&128)!==0?i=[128,...i]:i[0]=i[0]|128):(i=this.toArray(),(i[0]&128)!==0&&(i=[0,...i])),i.length===1&&i[0]===0&&(i=[]),t==="little"&&(i=i.reverse()),i}static fromBits(t,i=!1){if(t=(t&2147483648)!==0?t-4294967296:t,i&&(t&8388608)!==0)throw new Error("negative bit set");const r=t>>24,e=t&8388607;let o=[e>>24&255,e>>16&255,e>>8&255,e&255];if(r<=3)o=o.slice(1,1+r);else for(let a=0;a<r-3;a++)o.push(0);return(t&8388608)!==0?new ue(o).neg():new ue(o)}toBits(){let t;for(this.ltn(0)?t=this.neg().toArray("be"):t=this.toArray("be");t.length<4;)t.unshift(0);if(t.every(o=>o===0))return 0;for(;t[0]===0;)t.shift();let i=t.length,r=t.slice(0,3).reduce((o,a)=>o*256+a,0);(r&8388608)!==0&&(t.unshift(0),i+=1,r>>>=8);let e=i<<24|r;return this.ltn(0)&&(e|=8388608),e>>>0}static fromScriptNum(t,i,r){if(r===void 0&&(r=Number.MAX_SAFE_INTEGER),t.length>r)throw new Error("script number overflow");if(i===!0&&t.length>0&&(t[t.length-1]&127)===0&&(t.length<=1||(t[t.length-2]&128)===0))throw new Error("non-minimally encoded script number");return ue.fromSm(t,"little")}toScriptNum(){return this.toSm("little")}},rt(ue,"zeros",["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"]),rt(ue,"groupSizes",[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]),rt(ue,"groupBases",[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176]),rt(ue,"wordSize",26),ue),xN=class{constructor(t,i){rt(this,"name");rt(this,"p");rt(this,"k");rt(this,"n");rt(this,"tmp");this.name=t,this.p=new ot(i,16),this.n=this.p.bitLength(),this.k=new ot(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}_tmp(){const t=new ot;return t.words=new Array(Math.ceil(this.n/13)),t}ireduce(t){let i=t,r;do this.split(i,this.tmp),i=this.imulK(i),i=i.iadd(this.tmp),r=i.bitLength();while(r>this.n);const e=r<this.n?-1:i.ucmp(this.p);return e===0?(i.words[0]=0,i.length=1):e>0?i.isub(this.p):(i.strip,i.strip()),i}split(t,i){t.iushrn(this.n,0,i)}imulK(t){return t.imul(this.k)}},_N=class extends xN{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}split(t,i){const e=Math.min(t.length,9);let o=0;for(;o<e;o++)i.words[o]=t.words[o];if(i.length=e,t.length<=9){t.words[0]=0,t.length=1;return}let a=t.words[9];for(i.words[i.length++]=a&4194303,o=10;o<t.length;o++){const l=t.words[o]|0;t.words[o-10]=(l&4194303)<<4|a>>>22,a=l}a>>>=22,t.words[o-10]=a,a===0&&t.length>10?t.length-=10:t.length-=9}imulK(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;let i=0;for(let r=0;r<t.length;r++){const e=t.words[r]|0;i+=e*977,t.words[r]=i&67108863,i=e*64+(i/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t}},Hp=class{constructor(t){rt(this,"prime");rt(this,"m");if(t==="k256"){const i=new _N;this.m=i.p,this.prime=i}else this.assert(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}assert(t,i="Assertion failed"){if(!t)throw new Error(i)}verify1(t){this.assert(t.negative===0,"red works only with positives"),this.assert(t.red,"red works only with red numbers")}verify2(t,i){this.assert((t.negative|i.negative)===0,"red works only with positives"),this.assert(t.red!=null&&t.red===i.red,"red works only with red numbers")}imod(t){return this.prime!=null?this.prime.ireduce(t).forceRed(this):(ot.move(t,t.umod(this.m).forceRed(this)),t)}neg(t){return t.isZero()?t.clone():this.m.sub(t).forceRed(this)}add(t,i){this.verify2(t,i);const r=t.add(i);return r.cmp(this.m)>=0&&r.isub(this.m),r.forceRed(this)}iadd(t,i){this.verify2(t,i);const r=t.iadd(i);return r.cmp(this.m)>=0&&r.isub(this.m),r}sub(t,i){this.verify2(t,i);const r=t.sub(i);return r.cmpn(0)<0&&r.iadd(this.m),r.forceRed(this)}isub(t,i){this.verify2(t,i);const r=t.isub(i);return r.cmpn(0)<0&&r.iadd(this.m),r}shl(t,i){return this.verify1(t),this.imod(t.ushln(i))}imul(t,i){return this.verify2(t,i),this.imod(t.imul(i))}mul(t,i){return this.verify2(t,i),this.imod(t.mul(i))}isqr(t){return this.imul(t,t.clone())}sqr(t){return this.mul(t,t)}sqrt(t){if(t.isZero())return t.clone();const i=this.m.andln(3);if(this.assert(i%2===1),i===3){const g=this.m.add(new ot(1)).iushrn(2);return this.pow(t,g)}const r=this.m.subn(1);let e=0;for(;!r.isZero()&&r.andln(1)===0;)e++,r.iushrn(1);this.assert(!r.isZero());const o=new ot(1).toRed(this),a=o.redNeg(),l=this.m.subn(1).iushrn(1),f=this.m.bitLength(),n=new ot(2*f*f).toRed(this);for(;this.pow(n,l).cmp(a)!==0;)n.redIAdd(a);let c=this.pow(n,r),d=this.pow(t,r.addn(1).iushrn(1)),y=this.pow(t,r),p=e;for(;y.cmp(o)!==0;){let g=y,b=0;for(;g.cmp(o)!==0;b++)g=g.redSqr();this.assert(b<p);const w=this.pow(c,new ot(1).iushln(p-b-1));d=d.redMul(w),c=w.redSqr(),y=y.redMul(c),p=b}return d}invm(t){const i=t._invmp(this.m);return i.negative!==0?(i.negative=0,this.imod(i).redNeg()):this.imod(i)}pow(t,i){if(i.isZero())return new ot(1).toRed(this);if(i.cmpn(1)===0)return t.clone();const r=4,e=new Array(1<<r);e[0]=new ot(1).toRed(this),e[1]=t;let o=2;for(;o<e.length;o++)e[o]=this.mul(e[o-1],t);let a=e[0],l=0,f=0,n=i.bitLength()%26;for(n===0&&(n=26),o=i.length-1;o>=0;o--){const c=i.words[o];for(let d=n-1;d>=0;d--){const y=c>>d&1;if(a!==e[0]&&(a=this.sqr(a)),y===0&&l===0){f=0;continue}l<<=1,l|=y,f++,!(f!==r&&(o!==0||d!==0))&&(a=this.mul(a,e[l]),f=0,l=0)}n=26}return a}convertTo(t){const i=t.umod(this.m);return i===t?i.clone():i}convertFrom(t){const i=t.clone();return i.red=null,i}},SN=class extends Hp{constructor(i){super(i);rt(this,"shift");rt(this,"r");rt(this,"r2");rt(this,"rinv");rt(this,"minv");this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new ot(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}convertTo(i){return this.imod(i.ushln(this.shift))}convertFrom(i){const r=this.imod(i.mul(this.rinv));return r.red=null,r}imul(i,r){if(i.isZero()||r.isZero())return i.words[0]=0,i.length=1,i;const e=i.imul(r),o=e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=e.isub(o).iushrn(this.shift);let l=a;return a.cmp(this.m)>=0?l=a.isub(this.m):a.cmpn(0)<0&&(l=a.iadd(this.m)),l.forceRed(this)}mul(i,r){if(i.isZero()||r.isZero())return new ot(0).forceRed(this);const e=i.mul(r),o=e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=e.isub(o).iushrn(this.shift);let l=a;return a.cmp(this.m)>=0?l=a.isub(this.m):a.cmpn(0)<0&&(l=a.iadd(this.m)),l.forceRed(this)}invm(i){return this.imod(i._invmp(this.m).mul(this.r2)).forceRed(this)}},AT=class{constructor(t){rt(this,"curve");rt(this,"type");rt(this,"precomputed");this.curve=new Yi,this.type=t,this.precomputed=null}},vl=class ho extends AT{constructor(i,r,e){super("jacobian");rt(this,"x");rt(this,"y");rt(this,"z");rt(this,"zOne");i===null&&r===null&&e===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ot(0)):(ot.isBN(i)||(i=new ot(i,16)),this.x=i,ot.isBN(r)||(r=new ot(r,16)),this.y=r,ot.isBN(e)||(e=new ot(e,16)),this.z=e),this.x.red==null&&(this.x=this.x.toRed(this.curve.red)),this.y.red==null&&(this.y=this.y.toRed(this.curve.red)),this.z.red==null&&(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}toP(){if(this.isInfinity())return new xa(null,null);const i=this.z.redInvm(),r=i.redSqr(),e=this.x.redMul(r),o=this.y.redMul(r).redMul(i);return new xa(e,o)}neg(){return new ho(this.x,this.y.redNeg(),this.z)}add(i){if(this.isInfinity())return i;if(i.isInfinity())return this;const r=i.z.redSqr(),e=this.z.redSqr(),o=this.x.redMul(r),a=i.x.redMul(e),l=this.y.redMul(r.redMul(i.z)),f=i.y.redMul(e.redMul(this.z)),n=o.redSub(a),c=l.redSub(f);if(n.cmpn(0)===0)return c.cmpn(0)!==0?new ho(null,null,null):this.dbl();const d=n.redSqr(),y=d.redMul(n),p=o.redMul(d),g=c.redSqr().redIAdd(y).redISub(p).redISub(p),b=c.redMul(p.redISub(g)).redISub(l.redMul(y)),w=this.z.redMul(i.z).redMul(n);return new ho(g,b,w)}mixedAdd(i){if(this.isInfinity())return i.toJ();if(i.isInfinity())return this;if(i.x===null||i.y===null)throw new Error("Point coordinates cannot be null");const r=this.z.redSqr(),e=this.x,o=i.x.redMul(r),a=this.y,l=i.y.redMul(r).redMul(this.z),f=e.redSub(o),n=a.redSub(l);if(f.cmpn(0)===0)return n.cmpn(0)!==0?new ho(null,null,null):this.dbl();const c=f.redSqr(),d=c.redMul(f),y=e.redMul(c),p=n.redSqr().redIAdd(d).redISub(y).redISub(y),g=n.redMul(y.redISub(p)).redISub(a.redMul(d)),b=this.z.redMul(f);return new ho(p,g,b)}dblp(i){if(i===0)return this;if(this.isInfinity())return this;if(typeof i>"u")return this.dbl();let r=this;for(let e=0;e<i;e++)r=r.dbl();return r}dbl(){if(this.isInfinity())return this;let i,r,e;if(this.zOne){const o=this.x.redSqr(),a=this.y.redSqr(),l=a.redSqr();let f=this.x.redAdd(a).redSqr().redISub(o).redISub(l);f=f.redIAdd(f);const n=o.redAdd(o).redIAdd(o),c=n.redSqr().redISub(f).redISub(f);let d=l.redIAdd(l);d=d.redIAdd(d),d=d.redIAdd(d),i=c,r=n.redMul(f.redISub(c)).redISub(d),e=this.y.redAdd(this.y)}else{const o=this.x.redSqr(),a=this.y.redSqr(),l=a.redSqr();let f=this.x.redAdd(a).redSqr().redISub(o).redISub(l);f=f.redIAdd(f);const n=o.redAdd(o).redIAdd(o),c=n.redSqr();let d=l.redIAdd(l);d=d.redIAdd(d),d=d.redIAdd(d),i=c.redISub(f).redISub(f),r=n.redMul(f.redISub(i)).redISub(d),e=this.y.redMul(this.z),e=e.redIAdd(e)}return new ho(i,r,e)}eq(i){if(i.type==="affine")return this.eq(i.toJ());if(this===i)return!0;const r=this.z.redSqr();i=i;const e=i.z.redSqr();if(this.x.redMul(e).redISub(i.x.redMul(r)).cmpn(0)!==0)return!1;const o=r.redMul(this.z),a=e.redMul(i.z);return this.y.redMul(a).redISub(i.y.redMul(o)).cmpn(0)===0}eqXToP(i){var l;const r=this.z.redSqr(),e=i.toRed((l=this.curve)==null?void 0:l.red).redMul(r);if(this.x.cmp(e)===0)return!0;const o=i.clone();if(this.curve===null||this.curve.redN==null)throw new Error("Curve or redN is not initialized.");const a=this.curve.redN.redMul(r);for(;o.cmp(this.curve.p)<0;){if(o.iadd(this.curve.n),o.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(a),this.x.cmp(e)===0)return!0}return!1}inspect(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"}isInfinity(){return this.z.cmpn(0)===0}};const nf=(s,t="Hash assertion failed")=>{if(!s)throw new Error(t)};class o1{constructor(t,i,r,e){rt(this,"pending");rt(this,"pendingTotal");rt(this,"blockSize");rt(this,"outSize");rt(this,"endian");rt(this,"_delta8");rt(this,"_delta32");rt(this,"padLength");rt(this,"hmacStrength");this.pending=null,this.pendingTotal=0,this.blockSize=t,this.outSize=i,this.hmacStrength=r,this.padLength=e/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}_update(t,i){throw new Error("Not implemented")}_digest(){throw new Error("Not implemented")}_digestHex(){throw new Error("Not implemented")}update(t,i){if(t=PT(t,i),this.pending==null?this.pending=t:this.pending=this.pending.concat(t),this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;const r=t.length%this._delta8;this.pending=t.slice(t.length-r,t.length),this.pending.length===0&&(this.pending=null),t=EN(t,0,t.length-r,this.endian);for(let e=0;e<t.length;e+=this._delta32)this._update(t,e)}return this}digest(){return this.update(this._pad()),nf(this.pending===null),this._digest()}digestHex(){return this.update(this._pad()),nf(this.pending===null),this._digestHex()}_pad(){let t=this.pendingTotal;const i=this._delta8,r=i-(t+this.padLength)%i,e=new Array(r+this.padLength);e[0]=128;let o;for(o=1;o<r;o++)e[o]=0;t<<=3;let a;if(this.endian==="big"){for(a=8;a<this.padLength;a++)e[o++]=0;e[o++]=0,e[o++]=0,e[o++]=0,e[o++]=0,e[o++]=t>>>24&255,e[o++]=t>>>16&255,e[o++]=t>>>8&255,e[o++]=t&255}else for(e[o++]=t&255,e[o++]=t>>>8&255,e[o++]=t>>>16&255,e[o++]=t>>>24&255,e[o++]=0,e[o++]=0,e[o++]=0,e[o++]=0,a=8;a<this.padLength;a++)e[o++]=0;return e}}function TN(s,t){return(s.charCodeAt(t)&64512)!==55296||t<0||t+1>=s.length?!1:(s.charCodeAt(t+1)&64512)===56320}function PT(s,t){if(Array.isArray(s))return s.slice();if(!s)return[];const i=[];if(typeof s=="string")if(t!=="hex"){let r=0;for(let e=0;e<s.length;e++){let o=s.charCodeAt(e);o<128?i[r++]=o:o<2048?(i[r++]=o>>6|192,i[r++]=o&63|128):TN(s,e)?(o=65536+((o&1023)<<10)+(s.charCodeAt(++e)&1023),i[r++]=o>>18|240,i[r++]=o>>12&63|128,i[r++]=o>>6&63|128,i[r++]=o&63|128):(i[r++]=o>>12|224,i[r++]=o>>6&63|128,i[r++]=o&63|128)}}else{s=s.replace(/[^a-z0-9]+/gi,""),s.length%2!==0&&(s="0"+s);for(let r=0;r<s.length;r+=2)i.push(parseInt(s[r]+s[r+1],16))}else{s=s;for(let r=0;r<s.length;r++)i[r]=s[r]|0}return i}function IN(s){return(s>>>24|s>>>8&65280|s<<8&16711680|(s&255)<<24)>>>0}function c1(s,t){let i="";for(let r=0;r<s.length;r++){let e=s[r];t==="little"&&(e=IN(e)),i+=kN(e.toString(16))}return i}function kN(s){return s.length===7?"0"+s:s.length===6?"00"+s:s.length===5?"000"+s:s.length===4?"0000"+s:s.length===3?"00000"+s:s.length===2?"000000"+s:s.length===1?"0000000"+s:s}function EN(s,t,i,r){const e=i-t;nf(e%4===0);const o=new Array(e/4);for(let a=0,l=t;a<o.length;a++,l+=4){let f;r==="big"?f=s[l]<<24|s[l+1]<<16|s[l+2]<<8|s[l+3]:f=s[l+3]<<24|s[l+2]<<16|s[l+1]<<8|s[l],o[a]=f>>>0}return o}function u1(s,t){const i=new Array(s.length*4);for(let r=0,e=0;r<s.length;r++,e+=4){const o=s[r];t==="big"?(i[e]=o>>>24,i[e+1]=o>>>16&255,i[e+2]=o>>>8&255,i[e+3]=o&255):(i[e+3]=o>>>24,i[e+2]=o>>>16&255,i[e+1]=o>>>8&255,i[e]=o&255)}return i}function Er(s,t){return s>>>t|s<<32-t}function vo(s,t){return s<<t|s>>>32-t}function Ai(s,t){return s+t>>>0}function xl(s,t,i){return s+t+i>>>0}function db(s,t,i,r){return s+t+i+r>>>0}function RT(s,t,i,r,e){return s+t+i+r+e>>>0}function ON(s,t,i,r){if(s===0)return MT(t,i,r);if(s===1||s===3)return AN(t,i,r);if(s===2)return NT(t,i,r)}function MT(s,t,i){return s&t^~s&i}function NT(s,t,i){return s&t^s&i^t&i}function AN(s,t,i){return s^t^i}function PN(s){return Er(s,2)^Er(s,13)^Er(s,22)}function RN(s){return Er(s,6)^Er(s,11)^Er(s,25)}function MN(s){return Er(s,7)^Er(s,18)^s>>>3}function NN(s){return Er(s,17)^Er(s,19)^s>>>10}const CN=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],DN=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],BN=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],FN=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function m_(s,t,i,r){return s<=15?t^i^r:s<=31?t&i|~t&r:s<=47?(t|~i)^r:s<=63?t&r|i&~r:t^(i|~r)}function LN(s){return s<=15?0:s<=31?1518500249:s<=47?1859775393:s<=63?2400959708:2840853838}function UN(s){return s<=15?1352829926:s<=31?1548603684:s<=47?1836072691:s<=63?2053994217:0}class CT extends o1{constructor(){super(512,160,192,64);rt(this,"h");this.endian="little",this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}_update(i,r){let e=this.h[0],o=this.h[1],a=this.h[2],l=this.h[3],f=this.h[4],n=e,c=o,d=a,y=l,p=f,g;for(let b=0;b<80;b++)g=Ai(vo(db(e,m_(b,o,a,l),i[CN[b]+r],LN(b)),BN[b]),f),e=f,f=l,l=vo(a,10),a=o,o=g,g=Ai(vo(db(n,m_(79-b,c,d,y),i[DN[b]+r],UN(b)),FN[b]),p),n=p,p=y,y=vo(d,10),d=c,c=g;g=xl(this.h[1],a,y),this.h[1]=xl(this.h[2],l,p),this.h[2]=xl(this.h[3],f,n),this.h[3]=xl(this.h[4],e,c),this.h[4]=xl(this.h[0],o,d),this.h[0]=g}_digest(){return u1(this.h,"little")}_digestHex(){return c1(this.h,"little")}}class _o extends o1{constructor(){super(512,256,192,64);rt(this,"h");rt(this,"W");rt(this,"k");this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],this.W=new Array(64)}_update(i,r){const e=this.W;r===void 0&&(r=0);let o;for(o=0;o<16;o++)e[o]=i[r+o];for(;o<e.length;o++)e[o]=db(NN(e[o-2]),e[o-7],MN(e[o-15]),e[o-16]);let a=this.h[0],l=this.h[1],f=this.h[2],n=this.h[3],c=this.h[4],d=this.h[5],y=this.h[6],p=this.h[7];for(nf(this.k.length===e.length),o=0;o<e.length;o++){const g=RT(p,RN(c),MT(c,d,y),this.k[o],e[o]),b=Ai(PN(a),NT(a,l,f));p=y,y=d,d=c,c=Ai(n,g),n=f,f=l,l=a,a=Ai(g,b)}this.h[0]=Ai(this.h[0],a),this.h[1]=Ai(this.h[1],l),this.h[2]=Ai(this.h[2],f),this.h[3]=Ai(this.h[3],n),this.h[4]=Ai(this.h[4],c),this.h[5]=Ai(this.h[5],d),this.h[6]=Ai(this.h[6],y),this.h[7]=Ai(this.h[7],p)}_digest(){return u1(this.h,"big")}_digestHex(){return c1(this.h,"big")}}class qN extends o1{constructor(){super(512,160,80,64);rt(this,"h");rt(this,"W");rt(this,"k");this.k=[1518500249,1859775393,2400959708,3395469782],this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}_update(i,r){const e=this.W;r===void 0&&(r=0);let o;for(o=0;o<16;o++)e[o]=i[r+o];for(;o<e.length;o++)e[o]=vo(e[o-3]^e[o-8]^e[o-14]^e[o-16],1);let a=this.h[0],l=this.h[1],f=this.h[2],n=this.h[3],c=this.h[4];for(o=0;o<e.length;o++){const d=~~(o/20),y=RT(vo(a,5),ON(d,l,f,n),c,e[o],this.k[d]);c=n,n=f,f=vo(l,30),l=a,a=y}this.h[0]=Ai(this.h[0],a),this.h[1]=Ai(this.h[1],l),this.h[2]=Ai(this.h[2],f),this.h[3]=Ai(this.h[3],n),this.h[4]=Ai(this.h[4],c)}_digest(){return u1(this.h,"big")}_digestHex(){return c1(this.h,"big")}}class DT{constructor(t){rt(this,"inner");rt(this,"outer");rt(this,"blockSize",64);rt(this,"outSize",32);t=PT(t,"hex"),t.length>this.blockSize&&(t=new _o().update(t).digest()),nf(t.length<=this.blockSize);let i;for(i=t.length;i<this.blockSize;i++)t.push(0);for(i=0;i<t.length;i++)t[i]^=54;for(this.inner=new _o().update(t),i=0;i<t.length;i++)t[i]^=106;this.outer=new _o().update(t)}update(t,i){return this.inner.update(t,i),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}const jN=(s,t)=>new CT().update(s,t).digest(),HN=(s,t)=>new qN().update(s,t).digest(),Vn=(s,t)=>new _o().update(s,t).digest(),jn=(s,t)=>{const i=new _o().update(s,t).digest();return new _o().update(i).digest()},BT=(s,t)=>{const i=new _o().update(s,t).digest();return new CT().update(i).digest()},rf=(s,t,i)=>new DT(s).update(t,i).digest(),KN=s=>s.length%2===1?"0"+s:s,Zt=s=>{let t="";for(const i of s)t+=KN(i.toString(16));return t},Pt=(s,t)=>{if(Array.isArray(s))return s.slice();if(s===void 0)return[];if(typeof s!="string")return Array.from(s,i=>i|0);switch(t){case"hex":return VN(s);case"base64":return WN(s);default:return $N(s)}},VN=s=>{s=s.replace(/[^a-z0-9]+/gi,""),s.length%2!==0&&(s="0"+s);const t=[];for(let i=0;i<s.length;i+=2)t.push(parseInt(s[i]+s[i+1],16));return t},WN=s=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];let r=0,e=0;for(const o of s.replace(/=+$/,""))r=r<<6|t.indexOf(o),e+=6,e>=8&&(e-=8,i.push(r>>e&255),r&=(1<<e)-1);return i};function $N(s){const t=[];for(let i=0;i<s.length;i++){const r=s.codePointAt(i);if(r===void 0)throw new Error(`Index out of range: ${i}`);let e=r;e>65535?i++:e>=55296&&e<=57343&&(e=65533),e<=127?t.push(e):e<=2047?t.push(192|e>>6,128|e&63):e<=65535?t.push(224|e>>12,128|e>>6&63,128|e&63):t.push(240|e>>18,128|e>>12&63,128|e>>6&63,128|e&63)}return t}const Ve=s=>{let t="",i=0;for(let r=0;r<s.length;r++){const e=s[r];if(i>0){i--;continue}if(e<=127)t+=String.fromCharCode(e);else if(e>=192&&e<=223){const o=s[r+1];i=1;const a=(e&31)<<6|o&63;t+=String.fromCharCode(a)}else if(e>=224&&e<=239){const o=s[r+1],a=s[r+2];i=2;const l=(e&15)<<12|(o&63)<<6|a&63;t+=String.fromCharCode(l)}else if(e>=240&&e<=247){const o=s[r+1],a=s[r+2],l=s[r+3];i=3;const f=(e&7)<<18|(o&63)<<12|(a&63)<<6|l&63,n=55296+(f-65536>>10),c=56320+(f-65536&1023);t+=String.fromCharCode(n,c)}}return t},Kp=(s,t)=>{switch(t){case"hex":return Zt(s);case"utf8":return Ve(s);default:return s}};function us(s){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let i="",r;for(r=0;r<s.length;r+=3){const e=s[r],o=r+1<s.length?s[r+1]:0,a=r+2<s.length?s[r+2]:0,l=e>>2,f=(e&3)<<4|o>>4,n=(o&15)<<2|a>>6,c=a&63;i+=t.charAt(l)+t.charAt(f),i+=r+1<s.length?t.charAt(n):"=",i+=r+2<s.length?t.charAt(c):"="}return i}const Ud="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",fb=s=>{if(s===""||typeof s!="string")throw new Error(`Expected base58 string but got “${s}”`);const t=s.match(/[IOl0]/gmu);if(t!==null)throw new Error(`Invalid base58 character “${t.join("")}”`);const i=s.match(/^1+/gmu),r=i!==null?i[0].length:0,e=(s.length-r)*(Math.log(58)/Math.log(256))+1>>>0;return[...new Uint8Array([...new Uint8Array(r),...(s.match(/./gmu)??[]).map(a=>Ud.indexOf(a)).reduce((a,l)=>(a=a.map(f=>{const n=f*58+l;return l=n>>8,n}),a),new Uint8Array(e)).reverse().filter((a=>l=>a=a||l)(!1))])]},hb=s=>{const t=Array(256).fill(-1);for(let r=0;r<Ud.length;++r)t[Ud.charCodeAt(r)]=r;const i=[];for(const r of s){let e=r;for(let o=0;o<i.length;++o){const a=(t[i[o]]<<8)+e;i[o]=Ud.charCodeAt(a%58),e=a/58|0}for(;e!==0;)i.push(Ud.charCodeAt(e%58)),e=e/58|0}for(const r of s){if(r!==0)break;i.push(49)}return i.reverse(),String.fromCharCode(...i)},FT=(s,t=[0])=>{let i=jn([...t,...s]);return i=[...t,...s,...i.slice(0,4)],hb(i)},LT=(s,t,i=1)=>{const r=fb(s);let e=r.slice(0,i),o=r.slice(i,-4),a=[...e,...o];return a=jn(a),r.slice(-4).forEach((l,f)=>{if(l!==a[f])throw new Error("Invalid checksum")}),{prefix:e,data:o}};class le{constructor(t){rt(this,"bufs");this.bufs=t!==void 0?t:[]}getLength(){let t=0;for(const i of this.bufs)t=t+i.length;return t}toArray(){const t=this.getLength(),i=new Array(t);let r=0;for(const e of this.bufs)for(const o of e)i[r++]=o;return i}write(t){return this.bufs.push(t),this}writeReverse(t){const i=new Array(t.length);for(let r=0;r<i.length;r++)i[r]=t[t.length-1-r];return this.bufs.push(i),this}writeUInt8(t){const i=new Array(1);return i[0]=t,this.write(i),this}writeInt8(t){const i=new Array(1);return i[0]=t&255,this.write(i),this}writeUInt16BE(t){return this.bufs.push([t>>8&255,t&255]),this}writeInt16BE(t){return this.writeUInt16BE(t&65535)}writeUInt16LE(t){return this.bufs.push([t&255,t>>8&255]),this}writeInt16LE(t){return this.writeUInt16LE(t&65535)}writeUInt32BE(t){return this.bufs.push([t>>24&255,t>>16&255,t>>8&255,t&255]),this}writeInt32BE(t){return this.writeUInt32BE(t>>>0)}writeUInt32LE(t){return this.bufs.push([t&255,t>>8&255,t>>16&255,t>>24&255]),this}writeInt32LE(t){return this.writeUInt32LE(t>>>0)}writeUInt64BEBn(t){const i=t.toArray("be",8);return this.write(i),this}writeUInt64LEBn(t){const i=t.toArray("be",8);return this.writeReverse(i),this}writeUInt64LE(t){const i=new ot(t).toArray("be",8);return this.writeReverse(i),this}writeVarIntNum(t){const i=le.varIntNum(t);return this.write(i),this}writeVarIntBn(t){const i=le.varIntBn(t);return this.write(i),this}static varIntNum(t){let i;if(t<253)i=[t];else if(t<65536)i=[253,t&255,t>>8&255];else if(t<4294967296)i=[254,t&255,t>>8&255,t>>16&255,t>>24&255];else{const r=t&4294967295,e=Math.floor(t/4294967296)&4294967295;i=[255,r&255,r>>8&255,r>>16&255,r>>24&255,e&255,e>>8&255,e>>16&255,e>>24&255]}return i}static varIntBn(t){let i;if(t.ltn(253))i=[t.toNumber()];else if(t.ltn(65536)){const r=t.toNumber();i=[253,r&255,r>>8&255]}else if(t.lt(new ot(4294967296))){const r=t.toNumber();i=[254,r&255,r>>8&255,r>>16&255,r>>24&255]}else{const r=new le;r.writeUInt8(255),r.writeUInt64LEBn(t),i=r.toArray()}return i}}class hi{constructor(t=[],i=0){rt(this,"bin");rt(this,"pos");this.bin=t,this.pos=i}eof(){return this.pos>=this.bin.length}read(t=this.bin.length){const i=this.pos,r=this.pos+t;return this.pos=r,this.bin.slice(i,r)}readReverse(t=this.bin.length){const i=new Array(t);for(let r=0;r<t;r++)i[r]=this.bin[this.pos+t-1-r];return this.pos+=t,i}readUInt8(){const t=this.bin[this.pos];return this.pos+=1,t}readInt8(){const t=this.bin[this.pos];return this.pos+=1,(t&128)!==0?t-256:t}readUInt16BE(){const t=this.bin[this.pos]<<8|this.bin[this.pos+1];return this.pos+=2,t}readInt16BE(){const t=this.readUInt16BE();return(t&32768)!==0?t-65536:t}readUInt16LE(){const t=this.bin[this.pos]|this.bin[this.pos+1]<<8;return this.pos+=2,t}readInt16LE(){const t=this.readUInt16LE();return(t&32768)!==0?t-65536:t}readUInt32BE(){const t=this.bin[this.pos]*16777216+(this.bin[this.pos+1]<<16|this.bin[this.pos+2]<<8|this.bin[this.pos+3]);return this.pos+=4,t}readInt32BE(){const t=this.readUInt32BE();return(t&2147483648)!==0?t-4294967296:t}readUInt32LE(){const t=(this.bin[this.pos]|this.bin[this.pos+1]<<8|this.bin[this.pos+2]<<16|this.bin[this.pos+3]<<24)>>>0;return this.pos+=4,t}readInt32LE(){const t=this.readUInt32LE();return(t&2147483648)!==0?t-4294967296:t}readUInt64BEBn(){const t=this.bin.slice(this.pos,this.pos+8),i=new ot(t);return this.pos=this.pos+8,i}readUInt64LEBn(){const t=this.readReverse(8);return new ot(t)}readVarIntNum(){const t=this.readUInt8();let i;switch(t){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:if(i=this.readUInt64LEBn(),i.lte(new ot(2).pow(new ot(53))))return i.toNumber();throw new Error("number too large to retain precision - use readVarIntBn");default:return t}}readVarInt(){switch(this.bin[this.pos]){case 253:return this.read(3);case 254:return this.read(5);case 255:return this.read(9);default:return this.read(1)}}readVarIntBn(){const t=this.readUInt8();switch(t){case 253:return new ot(this.readUInt16LE());case 254:return new ot(this.readUInt32LE());case 255:return this.readUInt64LEBn();default:return new ot(t)}}}const b_=s=>{if(s.length===0)return s;const t=s[s.length-1];if((t&127)!==0)return s;if(s.length===1)return[];if((s[s.length-2]&128)!==0)return s;for(let i=s.length-1;i>0;i--)if(s[i-1]!==0)return(s[i-1]&128)!==0?(s[i]=t,s.slice(0,i+1)):(s[i-1]|=t,s.slice(0,i));return[]};var Be;let xa=(Be=class extends AT{constructor(i,r,e=!0){super("affine");rt(this,"x");rt(this,"y");rt(this,"inf");this.precomputed=null,i===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(ot.isBN(i)||(i=new ot(i,16)),this.x=i,ot.isBN(r)||(r=new ot(r,16)),this.y=r,e&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red===null&&(this.x=this.x.toRed(this.curve.red)),this.y.red===null&&(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}static fromDER(i){if((i[0]===4||i[0]===6||i[0]===7)&&i.length-1===2*32){if(i[0]===6){if(i[i.length-1]%2!==0)throw new Error("Point string value is wrong length")}else if(i[0]===7&&i[i.length-1]%2!==1)throw new Error("Point string value is wrong length");return new Be(i.slice(1,33),i.slice(33,1+2*32))}else if((i[0]===2||i[0]===3)&&i.length-1===32)return Be.fromX(i.slice(1,33),i[0]===3);throw new Error("Unknown point format")}static fromString(i){const r=Pt(i,"hex");return Be.fromDER(r)}static redSqrtOptimized(i){const o=Be.red.m.addn(1).iushrn(2);return i.redPow(o)}static fromX(i,r){if(typeof BigInt=="function"){let l=function(_,S){return(_%S+S)%S},f=function(_,S,T){let I=BigInt(1);for(_=l(_,T);S>BigInt(0);)(S&BigInt(1))===BigInt(1)&&(I=l(I*_,T)),S>>=BigInt(1),_=l(_*_,T);return I},n=function(_,S){const T=S+BigInt(1)>>BigInt(2),I=f(_,T,S);return l(I*I,S)===l(_,S)?I:null};var e=l,o=f,a=n;const c=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),d=BigInt(7);let y;if(i instanceof ot)y=BigInt("0x"+i.toString(16));else if(typeof i=="string")y=BigInt("0x"+i);else if(Array.isArray(i))y=BigInt("0x"+Zt(i).padStart(64,"0"));else if(typeof i=="number")y=BigInt(i);else throw new Error("Invalid x-coordinate type");y=l(y,c);const p=l(f(y,BigInt(3),c)+d,c);let g=n(p,c);if(g===null)throw new Error("Invalid point");const b=g%BigInt(2)===BigInt(1);(r&&!b||!r&&b)&&(g=c-g);const w=new ot(y.toString(16),16),v=new ot(g.toString(16),16);return new Be(w,v)}else{const l=new Hp("k256"),f=new ot(0).toRed(l),n=new ot(7).toRed(l),c=new ot(0).toRed(l);ot.isBN(i)||(i=new ot(i,16)),i=i,i.red==null&&(i=i.toRed(l));const d=i.redSqr().redMul(i).redIAdd(i.redMul(f)).redIAdd(n);let y=d.redSqrt();if(y.redSqr().redSub(d).cmp(c)!==0)throw new Error("invalid point");const p=y.fromRed().isOdd();return(r&&!p||!r&&p)&&(y=y.redNeg()),new Be(i,y)}}static fromJSON(i,r){typeof i=="string"&&(i=JSON.parse(i));const e=new Be(i[0],i[1],r);if(typeof i[2]!="object")return e;const o=l=>new Be(l[0],l[1],r),a=i[2];return e.precomputed={beta:null,doubles:typeof a.doubles=="object"&&a.doubles!==null?{step:a.doubles.step,points:[e].concat(a.doubles.points.map(o))}:void 0,naf:typeof a.naf=="object"&&a.naf!==null?{wnd:a.naf.wnd,points:[e].concat(a.naf.points.map(o))}:void 0},e}validate(){return this.curve.validate(this)}encode(i=!0,r){const e=this.curve.p.byteLength(),o=this.getX().toArray("be",e);let a;return i?a=[this.getY().isEven()?2:3].concat(o):a=[4].concat(o,this.getY().toArray("be",e)),r!=="hex"?a:Zt(a)}toString(){return this.encode(!0,"hex")}toJSON(){return this.precomputed==null?[this.x,this.y]:[this.x,this.y,typeof this.precomputed=="object"&&this.precomputed!==null?{doubles:this.precomputed.doubles!=null?{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)}:void 0,naf:this.precomputed.naf!=null?{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}:void 0}:void 0]}inspect(){var i,r,e,o;return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+(((r=(i=this.x)==null?void 0:i.fromRed())==null?void 0:r.toString(16,2))??"undefined")+" y: "+(((o=(e=this.y)==null?void 0:e.fromRed())==null?void 0:o.toString(16,2))??"undefined")+">"}isInfinity(){return this.inf}add(i){var a,l,f;if(this.inf)return i;if(i.inf)return this;if(this.eq(i))return this.dbl();if(this.neg().eq(i))return new Be(new ot(0),new ot(0));if(((a=this.x)==null?void 0:a.cmp(i.x??new ot(0)))===0)return new Be(new ot(0),new ot(0));let r=((l=this.y)==null?void 0:l.redSub(i.y??new ot(0)))??new ot(0);r.cmpn(0)!==0&&(r=r.redMul(((f=this.x)==null?void 0:f.redSub(i.x??new ot(0)).redInvm())??new ot(1)));const e=r==null?void 0:r.redSqr().redISub(this.x??new ot(0)).redISub(i.x??new ot(0)),o=(r??new ot(1)).redMul((this.x??new ot(0)).redSub(e??new ot(0))).redISub(this.y??new ot(0));return new Be(e??new ot(0),o??new ot(0))}dbl(){if(this.inf)return this;const i=(this.y??new ot(0)).redAdd(this.y??new ot(0));if(i.cmpn(0)===0)return new Be(new ot(0),new ot(0));const r=this.curve.a,e=(this.x??new ot(0)).redSqr(),o=i.redInvm(),a=e.redAdd(e).redIAdd(e).redIAdd(r).redMul(o),l=a.redSqr().redISub((this.x??new ot(0)).redAdd(this.x??new ot(0))),f=a.redMul((this.x??new ot(0)).redSub(l)).redISub(this.y??new ot(0));return new Be(l,f)}getX(){return(this.x??new ot(0)).fromRed()}getY(){return(this.y??new ot(0)).fromRed()}mul(i){return ot.isBN(i)||(i=new ot(i,16)),i=i,this.isInfinity()?this:this._hasDoubles(i)?this._fixedNafMul(i):this._endoWnafMulAdd([this],[i])}mulAdd(i,r,e){const o=[this,r],a=[i,e];return this._endoWnafMulAdd(o,a)}jmulAdd(i,r,e){const o=[this,r],a=[i,e];return this._endoWnafMulAdd(o,a,!0)}eq(i){return this===i||this.inf===i.inf&&(this.inf||(this.x??new ot(0)).cmp(i.x??new ot(0))===0&&(this.y??new ot(0)).cmp(i.y??new ot(0))===0)}neg(i){if(this.inf)return this;const r=new Be(this.x,(this.y??new ot(0)).redNeg());if(i===!0&&this.precomputed!=null){const e=this.precomputed,o=a=>a.neg();r.precomputed={naf:e.naf!=null?{wnd:e.naf.wnd,points:e.naf.points.map(o)}:void 0,doubles:e.doubles!=null?{step:e.doubles.step,points:e.doubles.points.map(a=>a.neg())}:void 0,beta:void 0}}return r}dblp(i){let r=this;for(let e=0;e<i;e++)r=r.dbl();return r}toJ(){return this.inf?new vl(null,null,null):new vl(this.x,this.y,this.curve.one)}_getBeta(){if(typeof this.curve.endo!="object")return;const i=this.precomputed;if(typeof i=="object"&&i!==null&&typeof i.beta=="object"&&i.beta!==null)return i.beta;const r=new Be((this.x??new ot(0)).redMul(this.curve.endo.beta),this.y);if(i!=null){const e=this.curve,o=a=>{if(a.x===null)throw new Error("p.x is null");if(e.endo===void 0||e.endo===null)throw new Error("curve.endo is undefined");return new Be(a.x.redMul(e.endo.beta),a.y)};i.beta=r,r.precomputed={beta:null,naf:i.naf!=null?{wnd:i.naf.wnd,points:i.naf.points.map(o)}:void 0,doubles:i.doubles!=null?{step:i.doubles.step,points:i.doubles.points.map(o)}:void 0}}return r}_fixedNafMul(i){if(typeof this.precomputed!="object"||this.precomputed===null)throw new Error("_fixedNafMul requires precomputed values for the point");const r=this._getDoubles(),e=this.curve.getNAF(i,1,this.curve._bitLength);let o=(1<<r.step+1)-(r.step%2===0?2:1);o/=3;const a=[];for(let n=0;n<e.length;n+=r.step){let c=0;for(let d=n+r.step-1;d>=n;d--)c=(c<<1)+e[d];a.push(c)}let l=new vl(null,null,null),f=new vl(null,null,null);for(let n=o;n>0;n--){for(let c=0;c<a.length;c++){const d=a[c];d===n?f=f.mixedAdd(r.points[c]):d===-n&&(f=f.mixedAdd(r.points[c].neg()))}l=l.add(f)}return l.toP()}_wnafMulAdd(i,r,e,o,a){const l=this.curve._wnafT1.map(p=>p.toNumber()),f=this.curve._wnafT2.map(()=>[]),n=this.curve._wnafT3.map(()=>[]);let c=0;for(let p=0;p<o;p++){const b=r[p]._getNAFPoints(i);l[p]=b.wnd,f[p]=b.points}for(let p=o-1;p>=1;p-=2){const g=p-1,b=p;if(l[g]!==1||l[b]!==1){n[g]=this.curve.getNAF(e[g],l[g],this.curve._bitLength),n[b]=this.curve.getNAF(e[b],l[b],this.curve._bitLength),c=Math.max(n[g].length,c),c=Math.max(n[b].length,c);continue}const w=[r[g],null,null,r[b]];(r[g].y??new ot(0)).cmp(r[b].y??new ot(0))===0?(w[1]=r[g].add(r[b]),w[2]=r[g].toJ().mixedAdd(r[b].neg())):(r[g].y??new ot(0)).cmp((r[b].y??new ot(0)).redNeg())===0?(w[1]=r[g].toJ().mixedAdd(r[b]),w[2]=r[g].add(r[b].neg())):(w[1]=r[g].toJ().mixedAdd(r[b]),w[2]=r[g].toJ().mixedAdd(r[b].neg()));const v=[-3,-1,-5,-7,0,7,5,1,3],_=this.curve.getJSF(e[g],e[b]);c=Math.max(_[0].length,c),n[g]=new Array(c),n[b]=new Array(c);for(let S=0;S<c;S++){const T=_[0][S]|0,I=_[1][S]|0;n[g][S]=v[(T+1)*3+(I+1)],n[b][S]=0,f[g]=w}}let d=new vl(null,null,null);const y=this.curve._wnafT4;for(let p=c;p>=0;p--){let g=0;for(;p>=0;){let v=!0;for(let _=0;_<o;_++)y[_]=new ot(typeof n[_][p]=="number"?n[_][p]:0),y[_].isZero()||(v=!1);if(!v)break;g++,p--}if(p>=0&&g++,d=d.dblp(g),p<0)break;const b=new ot(1),w=new ot(2);for(let v=0;v<o;v++){const _=y[v];let S;_.cmpn(0)!==0&&(_.isNeg()?S=f[v][_.neg().sub(b).div(w).toNumber()].neg():S=f[v][_.sub(b).div(w).toNumber()],S.type==="affine"?d=d.mixedAdd(S):d=d.add(S))}}for(let p=0;p<o;p++)f[p]=[];return a===!0?d:d.toP()}_endoWnafMulAdd(i,r,e){const o=new Array(i.length*2),a=new Array(i.length*2);let l;for(l=0;l<i.length;l++){const n=this.curve._endoSplit(r[l]);let c=i[l],d=c._getBeta()??new Be(new ot(0),new ot(0));n.k1.negative!==0&&(n.k1.ineg(),c=c.neg(!0)),n.k2.negative!==0&&(n.k2.ineg(),d=d.neg(!0)),o[l*2]=c,o[l*2+1]=d,a[l*2]=n.k1,a[l*2+1]=n.k2}const f=this._wnafMulAdd(1,o,a,l*2,e);for(let n=0;n<l*2;n++)o[n]=null,a[n]=null;return f}_hasDoubles(i){if(this.precomputed==null)return!1;const r=this.precomputed.doubles;return typeof r!="object"?!1:r.points.length>=Math.ceil((i.bitLength()+1)/r.step)}_getDoubles(i,r){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.doubles=="object"&&this.precomputed.doubles!==null)return this.precomputed.doubles;const e=[this];let o=this;for(let a=0;a<(r??0);a+=i??1){for(let l=0;l<(i??1);l++)o=o.dbl();e.push(o)}return{step:i??1,points:e}}_getNAFPoints(i){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.naf=="object"&&this.precomputed.naf!==null)return this.precomputed.naf;const r=[this],e=(1<<i)-1,o=e===1?null:this.dbl();for(let a=1;a<e;a++)o!==null&&(r[a]=r[a-1].add(o));return{wnd:i,points:r}}},rt(Be,"red",new Hp("k256")),rt(Be,"a",new ot(0).toRed(Be.red)),rt(Be,"b",new ot(7).toRed(Be.red)),rt(Be,"zero",new ot(0).toRed(Be.red)),Be),om,Yi=class UT{constructor(){rt(this,"p");rt(this,"red");rt(this,"redN");rt(this,"zero");rt(this,"one");rt(this,"two");rt(this,"g");rt(this,"n");rt(this,"a");rt(this,"b");rt(this,"tinv");rt(this,"zeroA");rt(this,"threeA");rt(this,"endo");rt(this,"_endoWnafT1");rt(this,"_endoWnafT2");rt(this,"_wnafT1");rt(this,"_wnafT2");rt(this,"_wnafT3");rt(this,"_wnafT4");rt(this,"_bitLength");if(typeof om<"u")return om;om=this;const i={prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",{doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}]};this.p=new ot(i.p,16),this.red=new Hp(i.prime),this.zero=new ot(0).toRed(this.red),this.one=new ot(1).toRed(this.red),this.two=new ot(2).toRed(this.red),this.n=new ot(i.n,16),this.g=xa.fromJSON(i.g,i.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n.bitLength(),this.redN=this.n.toRed(this.red),this.a=new ot(i.a,16).toRed(this.red),this.b=new ot(i.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(i),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}static assert(t,i="Elliptic curve assertion failed"){if(!t)throw new Error(i)}getNAF(t,i,r){const e=new Array(Math.max(t.bitLength(),r)+1);e.fill(0);const o=1<<i+1,a=t.clone();for(let l=0;l<e.length;l++){let f;const n=a.andln(o-1);a.isOdd()?(n>(o>>1)-1?f=(o>>1)-n:f=n,a.isubn(f)):f=0,e[l]=f,a.iushrn(1)}return e}getJSF(t,i){const r=[[],[]];t=t.clone(),i=i.clone();let e=0,o=0;for(;t.cmpn(-e)>0||i.cmpn(-o)>0;){let a=t.andln(3)+e&3,l=i.andln(3)+o&3;a===3&&(a=-1),l===3&&(l=-1);let f;if((a&1)===0)f=0;else{const c=t.andln(7)+e&7;(c===3||c===5)&&l===2?f=-a:f=a}r[0].push(f);let n;if((l&1)===0)n=0;else{const c=i.andln(7)+o&7;(c===3||c===5)&&a===2?n=-l:n=l}r[1].push(n),2*e===f+1&&(e=1-e),2*o===n+1&&(o=1-o),t.iushrn(1),i.iushrn(1)}return r}static cachedProperty(t,i,r){const e="_"+i;t.prototype[i]=function(){return this[e]!==void 0?this[e]:this[e]=r.call(this)}}static parseBytes(t){return typeof t=="string"?Pt(t,"hex"):t}static intFromLE(t){return new ot(t,"hex","le")}_getEndomorphism(t){var o,a;if(!this.zeroA||this.p.modrn(3)!==1)return;let i,r;if(t.beta!==void 0)i=new ot(t.beta,16).toRed(this.red);else{const l=this._getEndoRoots(this.p);if(l===null)throw new Error("Failed to get endomorphism roots for beta.");i=l[0].cmp(l[1])<0?l[0]:l[1],i=i.toRed(this.red)}if(t.lambda!==void 0)r=new ot(t.lambda,16);else{const l=this._getEndoRoots(this.n);if(l===null)throw new Error("Failed to get endomorphism roots for lambda.");if(this.g==null)throw new Error("Curve generator point (g) is not defined.");const f=(o=this.g.mul(l[0]))==null?void 0:o.x,n=this.g.x!=null?this.g.x.redMul(i):void 0;if(f!=null&&n!=null&&f.cmp(n)===0)r=l[0];else{if(r=l[1],this.g==null)throw new Error("Curve generator point (g) is not defined.");const c=(a=this.g.mul(r))==null?void 0:a.x,d=this.g.x!=null?this.g.x.redMul(i):void 0;if(c==null||d==null)throw new Error("Lambda computation failed: g.mul(lambda).x or g.x.redMul(beta) is undefined.");UT.assert(c.cmp(d)===0,"Lambda selection does not match computed beta.")}}let e;return typeof t.basis=="object"&&t.basis!==null?e=t.basis.map(function(l){return{a:new ot(l.a,16),b:new ot(l.b,16)}}):e=this._getEndoBasis(r),{beta:i,lambda:r,basis:e}}_getEndoRoots(t){const i=t===this.p?this.red:new SN(t),r=new ot(2).toRed(i).redInvm(),e=r.redNeg(),o=new ot(3).toRed(i).redNeg().redSqrt().redMul(r),a=e.redAdd(o).fromRed(),l=e.redSub(o).fromRed();return[a,l]}_getEndoBasis(t){const i=this.n.ushrn(Math.floor(this.n.bitLength()/2));let r=t,e=this.n.clone(),o=new ot(1),a=new ot(0),l=new ot(0),f=new ot(1),n,c,d,y,p,g,b=new ot(0),w=0,v=new ot(0),_=new ot(0);for(;r.cmpn(0)!==0;){const I=e.div(r);v=e.sub(I.mul(r)),_=l.sub(I.mul(o));const k=f.sub(I.mul(a));if(d===void 0&&v.cmp(i)<0)n=b.neg(),c=o,d=v.neg(),y=_;else if(d!==void 0&&++w===2)break;b=v,e=r,r=v,l=o,o=_,f=a,a=k}if(n===void 0||c===void 0||d===void 0||y===void 0)throw new Error("Failed to compute Endo Basis values");p=v.neg(),g=_;const S=d.sqr().add(y.sqr());return p.sqr().add(g.sqr()).cmp(S)>=0&&(p=n,g=c),d.negative!==0&&(d=d.neg(),y=y.neg()),p.negative!==0&&(p=p.neg(),g=g.neg()),[{a:d,b:y},{a:p,b:g}]}_endoSplit(t){if(this.endo==null)throw new Error("Endomorphism is not defined.");const i=this.endo.basis,r=i[0],e=i[1],o=e.b.mul(t).divRound(this.n),a=r.b.neg().mul(t).divRound(this.n),l=o.mul(r.a),f=a.mul(e.a),n=o.mul(r.b),c=a.mul(e.b),d=t.sub(l).sub(f),y=n.add(c).neg();return{k1:d,k2:y}}validate(t){if(t.inf)return!0;const i=t.x,r=t.y;if(i===null||r===null)throw new Error("Point coordinates cannot be null");const e=this.a.redMul(i),o=i.redSqr().redMul(i).redIAdd(e).redIAdd(this.b);return r.redSqr().redISub(o).cmpn(0)===0}},ls=class pb{constructor(t,i){rt(this,"r");rt(this,"s");this.r=t,this.s=i}static fromDER(t,i){const r=(d,y)=>{const p=d[y.place++];if((p&128)===0)return p;throw new Error("Invalid DER entity length")};class e{constructor(){rt(this,"place");this.place=0}}t=Pt(t,i);const o=new e;if(t[o.place++]!==48)throw new Error("Signature DER must start with 0x30");if(r(t,o)+o.place!==t.length)throw new Error("Signature DER invalid");if(t[o.place++]!==2)throw new Error("Signature DER invalid");const l=r(t,o);let f=t.slice(o.place,l+o.place);if(o.place+=l,t[o.place++]!==2)throw new Error("Signature DER invalid");const n=r(t,o);if(t.length!==n+o.place)throw new Error("Invalid R-length in signature DER");let c=t.slice(o.place,n+o.place);if(f[0]===0)if((f[1]&128)!==0)f=f.slice(1);else throw new Error("Invalid R-value in signature DER");if(c[0]===0)if((c[1]&128)!==0)c=c.slice(1);else throw new Error("Invalid S-value in signature DER");return new pb(new ot(f),new ot(c))}static fromCompact(t,i){if(t=Pt(t,i),t.length!==65)throw new Error("Invalid Compact Signature");const r=t[0];if(r<27||r>=35)throw new Error("Invalid Compact Byte");return new pb(new ot(t.slice(1,33)),new ot(t.slice(33,65)))}verify(t,i,r){const e=new ot(Vn(t,r),16);return yf(e,this,i)}toString(t){return this.toDER(t)}toDER(t){const i=(n,c)=>{if(c<128)n.push(c);else throw new Error("len must be < 0x80")},r=n=>{let c=0;const d=n.length-1;for(;n[c]===0&&(n[c+1]&128)===0&&c<d;)c++;return c===0?n:n.slice(c)};let e=this.r.toArray(),o=this.s.toArray();for((e[0]&128)!==0&&(e=[0].concat(e)),(o[0]&128)!==0&&(o=[0].concat(o)),e=r(e),o=r(o);o[0]===0&&(o[1]&128)===0;)o=o.slice(1);let a=[2];i(a,e.length),a=a.concat(e),a.push(2),i(a,o.length);const l=a.concat(o);let f=[48];return i(f,l.length),f=f.concat(l),t==="hex"?Zt(f):t==="base64"?us(f):f}toCompact(t,i,r){if(t<0||t>3)throw new Error("Invalid recovery param");if(typeof i!="boolean")throw new Error("Invalid compressed param");let e=27+t;i&&(e+=4);let o=[e];return o=o.concat(this.r.toArray("be",32)),o=o.concat(this.s.toArray("be",32)),r==="hex"?Zt(o):r==="base64"?us(o):o}RecoverPublicKey(t,i){const r=this.r,e=this.s,o=(t&1)!==0,a=t>>1,l=new Yi,f=l.n,n=l.g,c=a!==0?r.add(f):r,d=xa.fromX(c,o);if(!d.mul(f).isInfinity())throw new Error("nR is not at infinity");const p=i.neg().umod(f),g=r.invm(f),b=g.mul(e).umod(f),w=g.mul(p).umod(f),v=n.mul(w).add(d.mul(b)),_=new Io(v);return _.validate(),_}CalculateRecoveryFactor(t,i){for(let r=0;r<4;r++){let e;try{e=this.RecoverPublicKey(r,i)}catch{continue}if(t.eq(e))return r}throw new Error("Unable to find valid recovery factor")}},w_=class{constructor(t,i){rt(this,"K");rt(this,"V");if(t=Pt(t,"hex"),i=Pt(i,"hex"),t.length<32)throw new Error("Not enough entropy. Minimum is 256 bits");const r=t.concat(i);this.K=new Array(32),this.V=new Array(32);for(let e=0;e<32;e++)this.K[e]=0,this.V[e]=1;this.update(r)}hmac(){return new DT(this.K)}update(t){let i=this.hmac().update(this.V).update([0]);t!==void 0&&(i=i.update(t)),this.K=i.digest(),this.V=this.hmac().update(this.V).digest(),t!==void 0&&(this.K=this.hmac().update(this.V).update([1]).update(t).digest(),this.V=this.hmac().update(this.V).digest())}generate(t){let i=[];for(;i.length<t;)this.V=this.hmac().update(this.V).digest(),i=i.concat(this.V);const r=i.slice(0,t);return this.update(),Zt(r)}};function zN(s,t,i=new Yi){const r=s.byteLength()*8-i.n.bitLength();return r>0&&s.iushrn(r),t===null&&s.cmp(i.n)>=0?s.sub(i.n):s}const qT=(s,t,i=!1,r)=>{if(typeof BigInt=="function"){let I=function(W,q){const $=W.toString(16).padStart(q*2,"0"),Y=new Uint8Array(q);for(let Q=0;Q<q;Q++)Y[Q]=parseInt($.substr(Q*2,2),16);return Y},N=function(W,q,$=!0){const Y=W.toString(2).length,Q=q.toString(2).length,J=Y-Q;return J>0&&(W=W>>BigInt(J)),!$&&W>=q?W-q:W},D=function(W){if(typeof W=="function"){const $=W(C).toString(16);return BigInt("0x"+$)}else if(W!=null&&ot.isBN(W)){const q=W.toString(16);return BigInt("0x"+q)}else{const q=R.generate(k);return BigInt("0x"+q)}},U=function(W,q){return(W%q+q)%q},F=function(W,q){let $=y,Y=d,Q=U(W,q),J=q;for(;Q>y;){const vt=J/Q,wt=Y-$*vt,dt=J-Q*vt;Y=$,$=wt,J=Q,Q=dt}return U($,q)},L=function(W,q){if(W===null)return q;if(q===null)return W;if(W.x===q.x&&W.y===U(-q.y,b))return null;let $;if(W.x===q.x&&W.y===q.y){if(W.y===d)return null;const J=U(BigInt(3)*W.x*W.x,b),vt=F(p*W.y,b);$=U(J*vt,b)}else{const J=U(q.y-W.y,b),vt=F(q.x-W.x,b);$=U(J*vt,b)}const Y=U($*$-W.x-q.x,b),Q=U($*(W.x-Y)-W.y,b);return{x:Y,y:Q}},j=function(W,q){let $=q,Y=null;for(;W>BigInt(0);)W%BigInt(2)===BigInt(1)&&(Y=Y===null?$:L(Y,$)??Y),$=L($,$)??$,W>>=BigInt(1);if(Y===null)throw new Error("Scalar multiplication resulted in an invalid point.");return Y};var e=I,o=N,a=D,l=U,f=F,n=L,c=j;const d=BigInt(0),y=BigInt(1),p=BigInt(2),g=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),b=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),w=BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),v=BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"),_={x:w,y:v},S=BigInt("0x"+s.toString(16)),T=BigInt("0x"+t.toString(16));if(T<=d||T>=g)throw new Error("Invalid private key");const k=32,O=I(T,k),A=I(S,k),R=new w_(Array.from(O),Array.from(A)),P=g-y;let C=0,V=!1;for(;!V;){C+=1,V=!0,C+=1;let W=D(r);if(W=N(W,g,!0),W<=y||W>=P){if(r instanceof ot)throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const q=j(W,_);if(q===null){if(r instanceof ot)throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const $=U(q.x,g);if($===d){if(r instanceof ot)throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}const Y=F(W,g),Q=U($*T,g);let J=U(Y*(S+Q),g);if(J===d){if(r instanceof ot)throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}i&&J>g/p&&(J=g-J);const vt=new ot($.toString(16),16),wt=new ot(J.toString(16),16);return new ls(vt,wt)}}else{const d=new Yi;s=o(s);const y=d.n.byteLength(),p=t.toArray("be",y),g=s.toArray("be",y),b=new w_(p,g),w=d.n.subn(1);for(let v=0;;v++){let _=typeof r=="function"?r(v):ot.isBN(r)?r:new ot(b.generate(y),16);if(_!=null)_=o(_,!0);else throw new Error("k is undefined");if(_.cmpn(1)<=0||_.cmp(w)>=0){if(ot.isBN(r))throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const S=d.g.mul(_);if(S.isInfinity()){if(ot.isBN(r))throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const I=S.getX().umod(d.n);if(I.cmpn(0)===0){if(ot.isBN(r))throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}let k=_.invm(d.n).mul(I.mul(t).iadd(s));if(k=k.umod(d.n),k.cmpn(0)===0){if(ot.isBN(r))throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}return i&&k.cmp(d.n.ushrn(1))>0&&(k=d.n.sub(k)),new ls(I,k)}}throw new Error("Failed to generate a valid signature")},yf=(s,t,i)=>{if(typeof BigInt=="function"){const r=BigInt(0),e=BigInt(1),o=BigInt(2),a=BigInt(3),l=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),f=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),n={x:BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),y:BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8")},c=(O,A)=>(O%A+A)%A,d=(O,A)=>{let[R,P]=[O,A],[C,N]=[BigInt(1),BigInt(0)];for(;P!==r;){const D=R/P;[R,P]=[P,R-D*P],[C,N]=[N,C-D*N]}return R>e?r:c(C,A)},y=(O,A,R)=>c(O*A,R),p=(O,A,R)=>c(O-A,R),g=BigInt(4),b=BigInt(8),w=O=>{const{X:A,Y:R,Z:P}=O;if(R===r)return{X:r,Y:e,Z:r};const C=y(R,R,l),N=y(g,y(A,C,l),l),D=y(a,y(A,A,l),l),U=p(y(D,D,l),y(o,N,l),l),F=p(y(D,p(N,U,l),l),y(b,y(C,C,l),l),l),L=y(o,y(R,P,l),l);return{X:U,Y:F,Z:L}},v=(O,A)=>{if(O.Z===r)return A;if(A.Z===r)return O;const R=y(O.Z,O.Z,l),P=y(A.Z,A.Z,l),C=y(O.X,P,l),N=y(A.X,R,l),D=y(O.Y,y(P,A.Z,l),l),U=y(A.Y,y(R,O.Z,l),l),F=p(N,C,l),L=p(U,D,l);if(F===r)return L===r?w(O):{X:r,Y:e,Z:r};const j=y(F,F,l),V=y(F,j,l),W=y(C,j,l),q=p(p(y(L,L,l),V,l),y(o,W,l),l),$=p(y(L,p(W,q,l),l),y(D,V,l),l),Y=y(F,y(O.Z,A.Z,l),l);return{X:q,Y:$,Z:Y}},_=(O,A)=>{const R={X:A.x,Y:A.y,Z:e};let P={X:r,Y:e,Z:r};const C=O.toString(2);for(let N=0;N<C.length;N++)P=w(P),C[N]==="1"&&(P=v(P,R));return P},S=(O,A,R)=>{const{r:P,s:C}=R,N=O;if(P<=r||P>=f||C<=r||C>=f)return!1;const D=d(C,f);if(D===r)return!1;const U=y(N,D,f),F=y(P,D,f),L=_(U,n),j=_(F,A),V=v(L,j);if(V.Z===r)return!1;const W=d(V.Z,l);if(W===r)return!1;const q=y(W,W,l),$=y(V.X,q,l);return c($,f)===P},T=BigInt("0x"+s.toString(16));if(i.x==null||i.y==null)throw new Error("Invalid public key: missing coordinates.");const I={x:BigInt("0x"+i.x.toString(16)),y:BigInt("0x"+i.y.toString(16))},k={r:BigInt("0x"+t.r.toString(16)),s:BigInt("0x"+t.s.toString(16))};return S(T,I,k)}else{const r=new Yi;s=zN(s);const e=t.r,o=t.s;if(e.cmpn(1)<0||e.cmp(r.n)>=0||o.cmpn(1)<0||o.cmp(r.n)>=0)return!1;const a=o.invm(r.n),l=a.mul(s).umod(r.n),f=a.mul(e).umod(r.n),n=r.g.jmulAdd(l,i,f);return n.isInfinity()?!1:n.eqXToP(e)}};let Io=class qd extends xa{static fromPrivateKey(t){const r=new Yi().g.mul(t);return new qd(r.x,r.y)}static fromString(t){const i=xa.fromString(t);return new qd(i.x,i.y)}static fromDER(t){const i=xa.fromDER(t);return new qd(i.x,i.y)}constructor(t,i=null,r=!0){if(t instanceof xa)super(t.getX(),t.getY());else{if(i===null&&r&&typeof t=="string"&&(t.length===66||t.length===130))throw new Error('You are using the "new PublicKey()" constructor with a DER hex string. You need to use "PublicKey.fromString()" instead.');super(t,i,r)}}deriveSharedSecret(t){if(!this.validate())throw new Error("Public key not valid for ECDH secret derivation");return this.mul(t)}verify(t,i,r){const e=new ot(Vn(t,r),16);return yf(e,i,this)}toDER(t){return t==="hex"?this.encode(!0,t):this.encode(!0)}toHash(t){const i=BT(this.encode(!0));return t==="hex"?Zt(i):i}toAddress(t=[0]){if(typeof t=="string")if(t==="testnet"||t==="test")t=[111];else if(t==="mainnet"||t==="main")t=[0];else throw new Error(`Invalid prefix ${t}`);return FT(this.toHash(),t)}deriveChild(t,i){const r=this.deriveSharedSecret(t),e=Pt(i,"utf8"),o=rf(r.encode(!0),e),l=new Yi().g.mul(new ot(o)),f=this.add(l);return new qd(f.x,f.y)}static fromMsgHashAndCompactSignature(t,i,r){const e=Pt(i,r);if(e.length!==65)throw new Error("Invalid Compact Signature");const o=e[0];if(o<27||o>=35)throw new Error("Invalid Compact Byte");let a=e[0]-27;return a>3&&(a-=4),new ls(new ot(e.slice(1,33)),new ot(e.slice(33,65))).RecoverPublicKey(a,t)}};class XN{constructor(){rt(this,"_rand");var i;const t=()=>{throw new Error("No secure random number generator is available in this environment.")};if(this._rand=t,typeof self=="object")(i=self.crypto)!=null&&i.getRandomValues?this._rand=r=>{const e=new Uint8Array(r);return self.crypto.getRandomValues(e),[...e]}:this._rand=t;else try{const r=require("crypto");typeof r.randomBytes=="function"&&(this._rand=e=>[...r.randomBytes(e)])}catch{this._rand=t}}generate(t){return this._rand(t)}}let cm=null;const ds=s=>(cm==null&&(cm=new XN),cm.generate(s));class fu{constructor(t,i){rt(this,"x");rt(this,"y");const r=new Yi().p;this.x=t.umod(r),this.y=i.umod(r)}toString(){return hb(this.x.toArray())+"."+hb(this.y.toArray())}static fromString(t){const[i,r]=t.split(".");return new fu(new ot(fb(i)),new ot(fb(r)))}}let v_=class jT{constructor(t,i){rt(this,"points");rt(this,"threshold");this.points=t,this.threshold=i??t.length}static fromPrivateKey(t,i){const r=new Yi().p,e=[new fu(new ot(0),new ot(t.toArray()))];for(let o=1;o<i;o++){const a=new ot(ds(32)).umod(r),l=new ot(ds(32)).umod(r);e.push(new fu(a,l))}return new jT(e)}valueAt(t){const i=new Yi().p;let r=new ot(0);for(let e=0;e<this.threshold;e++){let o=this.points[e].y;for(let a=0;a<this.threshold;a++)if(e!==a){const l=this.points[a].x,f=this.points[e].x,n=t.sub(l).umod(i),d=f.sub(l).umod(i).invm(i),y=n.mul(d).umod(i);o=o.mul(y).umod(i)}r=r.add(o).umod(i)}return r}};class Vp{constructor(t,i,r){rt(this,"points");rt(this,"threshold");rt(this,"integrity");this.points=t,this.threshold=i,this.integrity=r}static fromBackupFormat(t){let i=0,r="";const e=t.map((o,a)=>{const l=o.split(".");if(l.length!==4)throw new Error("Invalid share format in share "+a.toString()+'. Expected format: "x.y.t.i" - received '+o);const[f,n,c,d]=l;if(c===void 0)throw new Error("Threshold not found in share "+a.toString());if(d===void 0)throw new Error("Integrity not found in share "+a.toString());const y=parseInt(c);if(a!==0&&i!==y)throw new Error("Threshold mismatch in share "+a.toString());if(a!==0&&r!==d)throw new Error("Integrity mismatch in share "+a.toString());return i=y,r=d,fu.fromString([f,n].join("."))});return new Vp(e,i,r)}toBackupFormat(){return this.points.map(t=>t.toString()+"."+this.threshold.toString()+"."+this.integrity)}}let Or=class ya extends ot{static fromRandom(){return new ya(ds(32))}static fromString(t,i="hex"){return new ya(super.fromString(t,i).toArray())}static fromHex(t){return new ya(super.fromHex(t,"big"))}static fromWif(t,i=1){const r=LT(t,void 0,i);if(r.data.length!==33)throw new Error("Invalid WIF length");if(r.data[32]!==1)throw new Error("Invalid WIF padding");return new ya(r.data.slice(0,32))}constructor(t=0,i=10,r="be",e="apply"){if(t instanceof ot?(super(),t.copy(this)):super(t,i,r),e!=="nocheck"){const o=this.checkInField();if(!o.inField){if(e==="error")throw new Error("Input is out of field");ot.move(this,o.modN)}}}checkInField(){const t=new Yi,i=this.mod(t.n);return{inField:this.cmp(i)===0,modN:i}}isValid(){return this.checkInField().inField}sign(t,i,r=!0,e){const o=new ot(Vn(t,i),16);return qT(o,this,r,e)}verify(t,i,r){const e=new ot(Vn(t,r),16);return yf(e,i,this.toPublicKey())}toPublicKey(){const i=new Yi().g.mul(this);return new Io(i.x,i.y)}toWif(t=[128]){if(!this.isValid())throw new Error("Value is out of field");return FT([...this.toArray("be",32),1],t)}toAddress(t=[0]){return this.toPublicKey().toAddress(t)}toHex(){return super.toHex(32)}toString(t="hex",i=64){return super.toString(t,i)}deriveSharedSecret(t){if(!t.validate())throw new Error("Public key not valid for ECDH secret derivation");return t.mul(this)}deriveChild(t,i){const r=this.deriveSharedSecret(t),e=Pt(i,"utf8"),o=rf(r.encode(!0),e),a=new Yi;return new ya(this.add(new ot(o)).mod(a.n).toArray())}toKeyShares(t,i){if(typeof t!="number"||typeof i!="number")throw new Error("threshold and totalShares must be numbers");if(t<2)throw new Error("threshold must be at least 2");if(i<2)throw new Error("totalShares must be at least 2");if(t>i)throw new Error("threshold should be less than or equal to totalShares");const r=v_.fromPrivateKey(this,t),e=[];for(let a=0;a<i;a++){const l=new ot(ya.fromRandom().toArray()),f=r.valueAt(l);e.push(new fu(l,f))}const o=this.toPublicKey().toHash("hex").slice(0,8);return new Vp(e,t,o)}toBackupShares(t,i){return this.toKeyShares(t,i).toBackupFormat()}static fromBackupShares(t){return ya.fromKeyShares(Vp.fromBackupFormat(t))}static fromKeyShares(t){const{points:i,threshold:r,integrity:e}=t;if(r<2)throw new Error("threshold must be at least 2");if(i.length<r)throw new Error(`At least ${r} shares are required to reconstruct the private key`);for(let f=0;f<r;f++)for(let n=f+1;n<r;n++)if(i[f].x.eq(i[n].x))throw new Error("Duplicate share detected, each must be unique.");const o=new v_(i,r),a=new ya(o.valueAt(new ot(0)).toArray());if(a.toPublicKey().toHash("hex").slice(0,8)!==e)throw new Error("Integrity hash mismatch");return a}};const HT=[[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118],[202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192],[183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21],[4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117],[9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132],[83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207],[208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168],[81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210],[205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115],[96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219],[224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121],[231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8],[186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138],[112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158],[225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223],[140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]],GN=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];function x_(s,t,i){let r,e;for(r=0;r<4;r++)for(e=0;e<4;e++)s[r][e]=s[r][e]^t[i+e][r]}function YN(s){let t,i;for(t=0;t<4;t++)for(i=0;i<4;i++)s[t][i]=HT[(s[t][i]&240)>>4][s[t][i]&15]}function __(s){let t;for(t=0;t<4;t++)s[t]=HT[(s[t]&240)>>4][s[t]&15]}function QN(s){const t=s[0];s[0]=s[1],s[1]=s[2],s[2]=s[3],s[3]=t}function ZN(s){let t,i,r,e,o;for(t=1;t<4;t++)for(i=0;i<(t-1)%2+1;i++){for(o=s[t][i],r=i;e=r+t,e>=4&&(e=e-4),e!==i;)s[t][r]=s[t][e],r=e;s[t][r]=o}}function Za(s,t){let i,r=0;for(i=0;i<8;i++)(t&1)!==0&&(r=r^s),(s&128)!==0?(s=s<<1,s=s^283):s=s<<1,t=t>>1;return r}function JN(s){let t,i;const r=[[],[],[],[]];for(t=0;t<4;t++)r[0][t]=Za(2,s[0][t])^Za(3,s[1][t])^s[2][t]^s[3][t],r[1][t]=s[0][t]^Za(2,s[1][t])^Za(3,s[2][t])^s[3][t],r[2][t]=s[0][t]^s[1][t]^Za(2,s[2][t])^Za(3,s[3][t]),r[3][t]=Za(3,s[0][t])^s[1][t]^s[2][t]^Za(2,s[3][t]);for(t=0;t<4;t++)for(i=0;i<4;i++)s[t][i]=r[t][i]}function tC(s,t){let i,r;const e=parseInt(String(t.length/4)),o=[];for(i=0;i<t.length;i++)i%4===0&&o.push([]),o[parseInt(String(i/4))].push(t[i]);for(i=e;i<4*s;i++){o[i]=[];const a=o[i-1].slice();if(i%e===0)for(QN(a),__(a),r=0;r<4;r++)a[r]=a[r]^GN[parseInt(String(i/e))][r];else e>6&&i%e===4&&__(a);for(r=0;r<4;r++)o[i][r]=o[i-e][r]^a[r]}return o}function l1(s,t){let i,r,e,o;const a=[[],[],[],[]],l=[],f=Array.from(t);if(f.length<=16){for(;f.length<16;)f.unshift(0);o=11}else if(f.length<=24){for(;f.length<24;)f.unshift(0);o=13}else if(t.length<=32){for(;f.length<32;)f.unshift(0);o=15}else throw new Error("Illegal key length: "+String(t.length));const n=tC(o,f);for(i=0;i<15;i++)a[parseInt(String(i/4))].push(s[i*4%15]);for(a[3].push(s[15]),x_(a,n,0),e=1;e<o;e++)YN(a),ZN(a),e+1<o&&JN(a),x_(a,n,e*4);for(i=0;i<4;i++)for(r=0;r<4;r++)l.push(a[r][i]);return l}const S_=function(s,t,i){return(s[t]&1<<i)!==0?1:0},iu=function(s){return[(s&4278190080)>>>24,(s&16711680)>>16,(s&65280)>>8,s&255]},ze=function(s){let t;const i=[];for(t=0;t<s;t++)i.push(0);return i},eC=[225].concat(ze(15)),Wp=function(s,t){let i;const r=[];for(i=0;i<s.length;i++)r[i]=s[i]^t[i];return r},T_=function(s){let t,i=0,r=0;for(t=0;t<s.length;t++)r=i,i=s[t]&1,s[t]=s[t]>>1,r!==0&&(s[t]=s[t]|128);return s},iC=function(s,t){let i,r,e=t.slice(),o=ze(16);for(i=0;i<16;i++)for(r=7;r!==-1;r--)S_(s,i,r)!==0&&(o=Wp(o,e)),S_(e,15,0)!==0?e=Wp(T_(e),eC):e=T_(e);return o},d1=function(s){let t;const i=s.slice();for(t=15;t!==11&&(i[t]=i[t]+1,i[t]===256);t--)i[t]=0;return i};function $p(s,t){let i,r=ze(16);for(i=0;i<s.length;i+=16)r=iC(Wp(r,s.slice(i,Math.min(i+16,s.length))),t);return r}function zp(s,t,i){let r,e,o,a=t;const l=[];if(s.length===0)return s;const f=Math.ceil(s.length/16);for(r=0;r<f;r++){for(o=Wp(s.slice(r*16,Math.min((r+1)*16,s.length)),l1(a,i)),e=0;e<o.length;e++)l.push(o[e]);r+1<f&&(a=d1(a))}return l}function nC(s,t,i,r){let e,o;const a=l1(ze(16),r);e=[...i],i.length===12?e=e.concat(ze(3)).concat([1]):(i.length%16!==0&&(e=e.concat(ze(16-i.length%16))),e=e.concat(ze(8)),e=$p(e.concat(ze(4)).concat(iu(i.length*8)),a));const l=zp(s,d1(e),r);return o=t.slice(),t.length===0?o=o.concat(ze(16)):t.length%16!==0&&(o=o.concat(ze(16-t.length%16))),o=o.concat(l),l.length===0?o=o.concat(ze(16)):l.length%16!==0&&(o=o.concat(ze(16-l.length%16))),o=o.concat(ze(4)).concat(iu(t.length*8)).concat(ze(4)).concat(iu(l.length*8)),{result:l,authenticationTag:zp($p(o,a),e,r)}}function rC(s,t,i,r,e){let o,a;const l=l1(ze(16),e);o=[...i],i.length===12?o=o.concat(ze(3)).concat([1]):(i.length%16!==0&&(o=o.concat(ze(16-i.length%16))),o=o.concat(ze(8)),o=$p(o.concat(ze(4)).concat(iu(i.length*8)),l));const f=zp(s,d1(o),e);return a=t.slice(),t.length===0?a=a.concat(ze(16)):t.length%16!==0&&(a=a.concat(ze(16-t.length%16))),a=a.concat(s),s.length===0?a=a.concat(ze(16)):s.length%16!==0&&(a=a.concat(ze(16-s.length%16))),a=a.concat(ze(4)).concat(iu(t.length*8)).concat(ze(4)).concat(iu(s.length*8)),zp($p(a,l),o,e).join()!==r.join()?null:f}let aC=class KT extends ot{static fromRandom(){return new KT(ds(32))}encrypt(t,i){const r=ds(32);t=Pt(t,i);const{result:e,authenticationTag:o}=nC(t,[],r,this.toArray("be",32));return Kp([...r,...e,...o],i)}decrypt(t,i){t=Pt(t,i);const r=t.slice(0,32),e=t.slice(32),o=e.slice(-16),a=e.slice(0,-16),l=rC(a,[],r,o,this.toArray());if(l===null)throw new Error("Decryption failed!");return Kp(l,i)}};var wi;let vi=(wi=class extends ls{constructor(i,r,e){super(i,r);rt(this,"scope");this.scope=e}static format(i){const r={sourceTXID:i.sourceTXID,sourceOutputIndex:i.sourceOutputIndex,sequence:i.inputSequence},e=[...i.otherInputs];e.splice(i.inputIndex,0,r);const o=()=>{const b=new le;for(const _ of e){if(typeof _.sourceTXID>"u"){if(_.sourceTransaction==null)throw new Error("Missing sourceTransaction for input");b.write(_.sourceTransaction.hash())}else b.writeReverse(Pt(_.sourceTXID,"hex"));b.writeUInt32LE(_.sourceOutputIndex)}const w=b.toArray();return jn(w)},a=()=>{const b=new le;for(const _ of e){const S=_.sequence??4294967295;b.writeUInt32LE(S)}const w=b.toArray();return jn(w)};function l(b){var S,T;const w=new le;if(typeof b>"u")for(const I of i.outputs){const k=I.satoshis??0;w.writeUInt64LE(k);const O=((S=I.lockingScript)==null?void 0:S.toBinary())??[];w.writeVarIntNum(O.length),w.write(O)}else{const I=i.outputs[b];if(I===void 0)throw new Error(`Output at index ${b} does not exist`);const k=I.satoshis??0;w.writeUInt64LE(k);const O=((T=I.lockingScript)==null?void 0:T.toBinary())??[];w.writeVarIntNum(O.length),w.write(O)}const v=w.toArray();return jn(v)}let f=new Array(32).fill(0),n=new Array(32).fill(0),c=new Array(32).fill(0);(i.scope&wi.SIGHASH_ANYONECANPAY)===0&&(f=o()),(i.scope&wi.SIGHASH_ANYONECANPAY)===0&&(i.scope&31)!==wi.SIGHASH_SINGLE&&(i.scope&31)!==wi.SIGHASH_NONE&&(n=a()),(i.scope&31)!==wi.SIGHASH_SINGLE&&(i.scope&31)!==wi.SIGHASH_NONE?c=l():(i.scope&31)===wi.SIGHASH_SINGLE&&i.inputIndex<i.outputs.length&&(c=l(i.inputIndex));const d=new le;d.writeInt32LE(i.transactionVersion),d.write(f),d.write(n),d.writeReverse(Pt(i.sourceTXID,"hex")),d.writeUInt32LE(i.sourceOutputIndex);const y=i.subscript.toBinary();d.writeVarIntNum(y.length),d.write(y),d.writeUInt64LE(i.sourceSatoshis);const p=r.sequence;return d.writeUInt32LE(p),d.write(c),d.writeUInt32LE(i.lockTime),d.writeUInt32LE(i.scope>>>0),d.toArray()}static fromChecksigFormat(i){if(i.length===0){const a=new ot(1),l=new ot(1),f=1;return new wi(a,l,f)}const r=i[i.length-1],e=i.slice(0,i.length-1),o=ls.fromDER(e);return new wi(o.r,o.s,r)}hasLowS(){return!(this.s.ltn(1)||this.s.gt(new ot("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))}toChecksigFormat(){return[...this.toDER(),this.scope]}},rt(wi,"SIGHASH_ALL",1),rt(wi,"SIGHASH_NONE",2),rt(wi,"SIGHASH_SINGLE",3),rt(wi,"SIGHASH_FORKID",64),rt(wi,"SIGHASH_ANYONECANPAY",128),wi),sC=class{constructor(){rt(this,"curve");this.curve=new Yi}generateProof(t,i,r,e){const o=Or.fromRandom(),a=o.toPublicKey(),l=r.mul(o),f=this.computeChallenge(i,r,e,l,a),n=o.add(f.mul(t)).umod(this.curve.n);return{R:a,SPrime:l,z:n}}verifyProof(t,i,r,e){const{R:o,SPrime:a,z:l}=e,f=this.computeChallenge(t,i,r,a,o),n=this.curve.g.mul(l),c=o.add(t.mul(f));if(!n.eq(c))return!1;const d=i.mul(l),y=a.add(r.mul(f));return!!d.eq(y)}computeChallenge(t,i,r,e,o){const a=[...t.encode(!0),...i.encode(!0),...r.encode(!0),...e.encode(!0),...o.encode(!0)],l=Vn(a);return new ot(l).umod(this.curve.n)}};const X={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_SPLIT:127,OP_LEFT:128,OP_NUM2BIN:128,OP_RIGHT:129,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_NOP11:186,OP_NOP12:187,OP_NOP13:188,OP_NOP14:189,OP_NOP15:190,OP_NOP16:191,OP_NOP17:192,OP_NOP18:193,OP_NOP19:194,OP_NOP20:195,OP_NOP21:196,OP_NOP22:197,OP_NOP23:198,OP_NOP24:199,OP_NOP25:200,OP_NOP26:201,OP_NOP27:202,OP_NOP28:203,OP_NOP29:204,OP_NOP30:205,OP_NOP31:206,OP_NOP32:207,OP_NOP33:208,OP_NOP34:209,OP_NOP35:210,OP_NOP36:211,OP_NOP37:212,OP_NOP38:213,OP_NOP39:214,OP_NOP40:215,OP_NOP41:216,OP_NOP42:217,OP_NOP43:218,OP_NOP44:219,OP_NOP45:220,OP_NOP46:221,OP_NOP47:222,OP_NOP48:223,OP_NOP49:224,OP_NOP50:225,OP_NOP51:226,OP_NOP52:227,OP_NOP53:228,OP_NOP54:229,OP_NOP55:230,OP_NOP56:231,OP_NOP57:232,OP_NOP58:233,OP_NOP59:234,OP_NOP60:235,OP_NOP61:236,OP_NOP62:237,OP_NOP63:238,OP_NOP64:239,OP_NOP65:240,OP_NOP66:241,OP_NOP67:242,OP_NOP68:243,OP_NOP69:244,OP_NOP70:245,OP_NOP71:246,OP_NOP72:247,OP_NOP73:248,OP_NOP77:252,OP_SMALLDATA:249,OP_SMALLINTEGER:250,OP_PUBKEYS:251,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};for(const s in X)X[X[s]]=s;let va=class zc{constructor(t=[]){rt(this,"chunks");this.chunks=t}static fromASM(t){const i=[],r=t.split(" ");let e=0;for(;e<r.length;){const o=r[e];let a,l=0;if(o.startsWith("OP_")&&typeof X[o]<"u"&&(a=o,l=X[o]),o==="0")l=0,i.push({op:l}),e=e+1;else if(o==="-1")l=X.OP_1NEGATE,i.push({op:l}),e=e+1;else if(a===void 0){let f=r[e];f.length%2!==0&&(f="0"+f);const n=Pt(f,"hex");if(Kp(n,"hex")!==f)throw new Error("invalid hex string in script");const c=n.length;c>=0&&c<X.OP_PUSHDATA1?l=c:c<Math.pow(2,8)?l=X.OP_PUSHDATA1:c<Math.pow(2,16)?l=X.OP_PUSHDATA2:c<Math.pow(2,32)&&(l=X.OP_PUSHDATA4),i.push({data:n,op:l}),e=e+1}else l===X.OP_PUSHDATA1||l===X.OP_PUSHDATA2||l===X.OP_PUSHDATA4?(i.push({data:Pt(r[e+2],"hex"),op:l}),e=e+3):(i.push({op:l}),e=e+1)}return new zc(i)}static fromHex(t){if(t.length===0)return zc.fromBinary([]);if(t.length%2!==0)throw new Error("There is an uneven number of characters in the string which suggests it is not hex encoded.");if(!/^[0-9a-fA-F]+$/.test(t))throw new Error("Some elements in this string are not hex encoded.");return zc.fromBinary(Pt(t,"hex"))}static fromBinary(t){t=[...t];const i=[],r=new hi(t);for(;!r.eof();){const e=r.readUInt8();let o=0,a=[];if(e>0&&e<X.OP_PUSHDATA1)o=e,i.push({data:r.read(o),op:e});else if(e===X.OP_PUSHDATA1){try{o=r.readUInt8(),a=r.read(o)}catch{r.read()}i.push({data:a,op:e})}else if(e===X.OP_PUSHDATA2){try{o=r.readUInt16LE(),a=r.read(o)}catch{r.read()}i.push({data:a,op:e})}else if(e===X.OP_PUSHDATA4){try{o=r.readUInt32LE(),a=r.read(o)}catch{r.read()}i.push({data:a,op:e})}else i.push({op:e})}return new zc(i)}toASM(){let t="";for(let i=0;i<this.chunks.length;i++){const r=this.chunks[i];t+=this._chunkToString(r)}return t.slice(1)}toHex(){return Kp(this.toBinary(),"hex")}toBinary(){const t=new le;for(let i=0;i<this.chunks.length;i++){const r=this.chunks[i],e=r.op;t.writeUInt8(e),r.data!=null&&(e<X.OP_PUSHDATA1?t.write(r.data):e===X.OP_PUSHDATA1?(t.writeUInt8(r.data.length),t.write(r.data)):e===X.OP_PUSHDATA2?(t.writeUInt16LE(r.data.length),t.write(r.data)):e===X.OP_PUSHDATA4&&(t.writeUInt32LE(r.data.length),t.write(r.data)))}return t.toArray()}writeScript(t){return this.chunks=this.chunks.concat(t.chunks),this}writeOpCode(t){return this.chunks.push({op:t}),this}setChunkOpCode(t,i){return this.chunks[t]={op:i},this}writeBn(t){if(t.cmpn(0)===X.OP_0)this.chunks.push({op:X.OP_0});else if(t.cmpn(-1)===0)this.chunks.push({op:X.OP_1NEGATE});else if(t.cmpn(1)>=0&&t.cmpn(16)<=0)this.chunks.push({op:t.toNumber()+X.OP_1-1});else{const i=t.toSm("little");this.writeBin(i)}return this}writeBin(t){let i;if(t.length>0&&t.length<X.OP_PUSHDATA1)i=t.length;else if(t.length===0)i=X.OP_0;else if(t.length<Math.pow(2,8))i=X.OP_PUSHDATA1;else if(t.length<Math.pow(2,16))i=X.OP_PUSHDATA2;else if(t.length<Math.pow(2,32))i=X.OP_PUSHDATA4;else throw new Error("You can't push that much data");return this.chunks.push({data:t,op:i}),this}writeNumber(t){return this.writeBn(new ot(t)),this}removeCodeseparators(){const t=[];for(let i=0;i<this.chunks.length;i++)this.chunks[i].op!==X.OP_CODESEPARATOR&&t.push(this.chunks[i]);return this.chunks=t,this}findAndDelete(t){const i=t.toHex();for(let r=0;r<this.chunks.length;r++){const o=new zc([this.chunks[r]]).toHex();i===o&&this.chunks.splice(r,1)}return this}isPushOnly(){for(let t=0;t<this.chunks.length;t++)if(this.chunks[t].op>X.OP_16)return!1;return!0}isLockingScript(){throw new Error("Not implemented")}isUnlockingScript(){throw new Error("Not implemented")}_chunkToString(t){const i=t.op;let r="";if(typeof t.data>"u"){const e=X[i];r=`${r} ${e}`}else r=`${r} ${Zt(t.data)}`;return r}},nu=class extends va{isLockingScript(){return!0}isUnlockingScript(){return!1}},Xp=class extends va{isLockingScript(){return!1}isUnlockingScript(){return!0}};const hc=1024*1024*1024,I_=Math.pow(2,31)-1,In=!0;let oC=class{constructor(t){rt(this,"sourceTXID");rt(this,"sourceOutputIndex");rt(this,"sourceSatoshis");rt(this,"lockingScript");rt(this,"transactionVersion");rt(this,"otherInputs");rt(this,"outputs");rt(this,"inputIndex");rt(this,"unlockingScript");rt(this,"inputSequence");rt(this,"lockTime");rt(this,"context");rt(this,"programCounter");rt(this,"lastCodeSeparator");rt(this,"stack");rt(this,"altStack");rt(this,"ifStack");rt(this,"memoryLimit");rt(this,"stackMem");rt(this,"altStackMem");this.sourceTXID=t.sourceTXID,this.sourceOutputIndex=t.sourceOutputIndex,this.sourceSatoshis=t.sourceSatoshis,this.lockingScript=t.lockingScript,this.transactionVersion=t.transactionVersion,this.otherInputs=t.otherInputs,this.outputs=t.outputs,this.inputIndex=t.inputIndex,this.unlockingScript=t.unlockingScript,this.inputSequence=t.inputSequence,this.lockTime=t.lockTime,this.memoryLimit=t.memoryLimit??1e5,this.stackMem=0,this.altStackMem=0,this.reset()}reset(){this.context="UnlockingScript",this.programCounter=0,this.lastCodeSeparator=null,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0}step(){let t;if(this.stackMem>this.memoryLimit)return this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;if(this.altStackMem>this.memoryLimit)return this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;const i=()=>{t=void 0};this.context==="UnlockingScript"&&this.programCounter>=this.unlockingScript.chunks.length&&(this.context="LockingScript",this.programCounter=0);let r;this.context==="UnlockingScript"?r=this.unlockingScript.chunks[this.programCounter]:r=this.lockingScript.chunks[this.programCounter];const e=tt=>tt===X.OP_2MUL||tt===X.OP_2DIV||tt===X.OP_VERIF||tt===X.OP_VERNOTIF||tt===X.OP_VER,o=tt=>{const xt=tt.data,It=tt.op;return Array.isArray(xt)?xt.length===0?It===X.OP_0:xt.length===1&&xt[0]>=1&&xt[0]<=16?It===X.OP_1+(xt[0]-1):xt.length===1&&xt[0]===129?It===X.OP_1NEGATE:xt.length<=75?It===xt.length:xt.length<=255?It===X.OP_PUSHDATA1:xt.length<=65535?It===X.OP_PUSHDATA2:!0:!0},a=(tt,xt=Number.MAX_SAFE_INTEGER)=>!(tt.length>xt||tt.length>0&&(tt[tt.length-1]&127)===0&&(tt.length<=1||(tt[tt.length-2]&128)===0)),l=(tt,xt)=>{const It=tt;for(;It.length<xt;)It.unshift(0);return It},f=tt=>{if(tt.length<9||tt.length>73||tt[0]!==48||tt[1]!==tt.length-3)return!1;const xt=tt[3];if(5+xt>=tt.length)return!1;const It=tt[5+xt];if(xt+It+7!==tt.length)return!1;const Nt=tt.slice(4);if(tt[2]!==2||tt[3]!==xt||xt===0||(Nt[0]&128)!==0||xt>1&&Nt[0]===0&&(Nt[1]&128)===0)return!1;const Lt=tt.slice(6+xt);return!(tt[6+xt-2]!==2||tt[6+xt-1]!==It||It===0||(Lt[0]&128)!==0||It>1&&Lt[0]===0&&(Lt[1]&128)===0)},n=tt=>{if(tt.length===0)return!0;f(tt)||this.scriptEvaluationError("The signature format is invalid.");const xt=vi.fromChecksigFormat(tt);return xt.hasLowS()||this.scriptEvaluationError("The signature must have a low S value."),(xt.scope&vi.SIGHASH_FORKID)===0?(this.scriptEvaluationError("The signature must use SIGHASH_FORKID."),!1):!0},c=tt=>(tt.length<33&&this.scriptEvaluationError("The public key is too short, it must be at least 33 bytes."),tt[0]===4?tt.length!==65&&this.scriptEvaluationError("The non-compressed public key must be 65 bytes."):tt[0]===2||tt[0]===3?tt.length!==33&&this.scriptEvaluationError("The compressed public key must be 33 bytes."):this.scriptEvaluationError("The public key is in an unknown format."),!0),d=(tt,xt,It)=>{const Nt=vi.format({sourceTXID:this.sourceTXID,sourceOutputIndex:this.sourceOutputIndex,sourceSatoshis:this.sourceSatoshis,transactionVersion:this.transactionVersion,otherInputs:this.otherInputs,outputs:this.outputs,inputIndex:this.inputIndex,subscript:It,inputSequence:this.inputSequence,lockTime:this.lockTime,scope:tt.scope}),Lt=new ot(jn(Nt));return yf(Lt,tt,xt)},y=!this.ifStack.includes(!1);let p,g,b,w,v,_,S,T,I,k,O,A,R,P,C,N,D,U,F,L,j,V,W,q,$,Y,Q,J,vt,wt,dt,yt;const _t=r.op;if(typeof _t>"u"&&this.scriptEvaluationError(`An opcode is missing in this chunk of the ${this.context}!`),Array.isArray(r.data)&&r.data.length>hc&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${hc} bytes.`),y&&e(_t)&&this.scriptEvaluationError("This opcode is currently disabled."),y&&_t>=0&&_t<=X.OP_PUSHDATA4)o(r)||this.scriptEvaluationError("This data is not minimally-encoded."),Array.isArray(r.data)?(this.stack.push(r.data),this.stackMem+=r.data.length):(this.stack.push([]),this.stackMem+=0);else if(y||X.OP_IF<=_t&&_t<=X.OP_ENDIF)switch(_t){case X.OP_1NEGATE:case X.OP_1:case X.OP_2:case X.OP_3:case X.OP_4:case X.OP_5:case X.OP_6:case X.OP_7:case X.OP_8:case X.OP_9:case X.OP_10:case X.OP_11:case X.OP_12:case X.OP_13:case X.OP_14:case X.OP_15:case X.OP_16:_=_t-(X.OP_1-1),p=new ot(_).toScriptNum(),this.stack.push(p),this.stackMem+=p.length;break;case X.OP_NOP:case X.OP_NOP2:case X.OP_NOP3:case X.OP_NOP1:case X.OP_NOP4:case X.OP_NOP5:case X.OP_NOP6:case X.OP_NOP7:case X.OP_NOP8:case X.OP_NOP9:case X.OP_NOP10:case X.OP_NOP11:case X.OP_NOP12:case X.OP_NOP13:case X.OP_NOP14:case X.OP_NOP15:case X.OP_NOP16:case X.OP_NOP17:case X.OP_NOP18:case X.OP_NOP19:case X.OP_NOP20:case X.OP_NOP21:case X.OP_NOP22:case X.OP_NOP23:case X.OP_NOP24:case X.OP_NOP25:case X.OP_NOP26:case X.OP_NOP27:case X.OP_NOP28:case X.OP_NOP29:case X.OP_NOP30:case X.OP_NOP31:case X.OP_NOP32:case X.OP_NOP33:case X.OP_NOP34:case X.OP_NOP35:case X.OP_NOP36:case X.OP_NOP37:case X.OP_NOP38:case X.OP_NOP39:case X.OP_NOP40:case X.OP_NOP41:case X.OP_NOP42:case X.OP_NOP43:case X.OP_NOP44:case X.OP_NOP45:case X.OP_NOP46:case X.OP_NOP47:case X.OP_NOP48:case X.OP_NOP49:case X.OP_NOP50:case X.OP_NOP51:case X.OP_NOP52:case X.OP_NOP53:case X.OP_NOP54:case X.OP_NOP55:case X.OP_NOP56:case X.OP_NOP57:case X.OP_NOP58:case X.OP_NOP59:case X.OP_NOP60:case X.OP_NOP61:case X.OP_NOP62:case X.OP_NOP63:case X.OP_NOP64:case X.OP_NOP65:case X.OP_NOP66:case X.OP_NOP67:case X.OP_NOP68:case X.OP_NOP69:case X.OP_NOP70:case X.OP_NOP71:case X.OP_NOP72:case X.OP_NOP73:case X.OP_NOP77:break;case X.OP_IF:case X.OP_NOTIF:wt=!1,y&&(this.stack.length<1&&this.scriptEvaluationError("OP_IF and OP_NOTIF require at least one item on the stack when they are used!"),p=this.stacktop(-1),wt=this.castToBool(p),_t===X.OP_NOTIF&&(wt=!wt),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i()),this.ifStack.push(wt);break;case X.OP_ELSE:this.ifStack.length===0&&this.scriptEvaluationError("OP_ELSE requires a preceeding OP_IF."),this.ifStack[this.ifStack.length-1]=!this.ifStack[this.ifStack.length-1];break;case X.OP_ENDIF:this.ifStack.length===0&&this.scriptEvaluationError("OP_ENDIF requires a preceeding OP_IF."),this.ifStack.pop();break;case X.OP_VERIFY:this.stack.length<1&&this.scriptEvaluationError("OP_VERIFY requires at least one item to be on the stack."),p=this.stacktop(-1),wt=this.castToBool(p),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),wt||this.scriptEvaluationError("OP_VERIFY requires the top stack value to be truthy.");break;case X.OP_RETURN:this.context==="UnlockingScript"?this.programCounter=this.unlockingScript.chunks.length:this.programCounter=this.lockingScript.chunks.length,this.ifStack=[];break;case X.OP_TOALTSTACK:this.stack.length<1&&this.scriptEvaluationError("OP_TOALTSTACK requires at oeast one item to be on the stack."),t=this.stack.pop(),t!=null&&(this.altStack.push(t),this.altStackMem+=t.length,this.stackMem-=t.length),i();break;case X.OP_FROMALTSTACK:this.altStack.length<1&&this.scriptEvaluationError("OP_FROMALTSTACK requires at least one item to be on the stack."),t=this.altStack.pop(),t!=null&&(this.stack.push(t),this.stackMem+=t.length,this.altStackMem-=t.length),i();break;case X.OP_2DROP:this.stack.length<2&&this.scriptEvaluationError("OP_2DROP requires at least two items to be on the stack."),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();break;case X.OP_2DUP:this.stack.length<2&&this.scriptEvaluationError("OP_2DUP requires at least two items to be on the stack."),g=this.stacktop(-2),b=this.stacktop(-1),this.stack.push([...g]),this.stackMem+=g.length,this.stack.push([...b]),this.stackMem+=b.length;break;case X.OP_3DUP:this.stack.length<3&&this.scriptEvaluationError("OP_3DUP requires at least three items to be on the stack."),g=this.stacktop(-3),b=this.stacktop(-2),w=this.stacktop(-1),this.stack.push([...g]),this.stackMem+=g.length,this.stack.push([...b]),this.stackMem+=b.length,this.stack.push([...w]),this.stackMem+=w.length;break;case X.OP_2OVER:this.stack.length<4&&this.scriptEvaluationError("OP_2OVER requires at least four items to be on the stack."),g=this.stacktop(-4),b=this.stacktop(-3),this.stack.push([...g]),this.stackMem+=g.length,this.stack.push([...b]),this.stackMem+=b.length;break;case X.OP_2ROT:this.stack.length<6&&this.scriptEvaluationError("OP_2ROT requires at least six items to be on the stack."),v=this.stack.splice(this.stack.length-6,2),this.stack.push(v[0]),this.stackMem+=v[0].length,this.stack.push(v[1]),this.stackMem+=v[1].length;break;case X.OP_2SWAP:this.stack.length<4&&this.scriptEvaluationError("OP_2SWAP requires at least four items to be on the stack."),v=this.stack.splice(this.stack.length-4,2),this.stack.push(v[0]),this.stackMem+=v[0].length,this.stack.push(v[1]),this.stackMem+=v[1].length;break;case X.OP_IFDUP:this.stack.length<1&&this.scriptEvaluationError("OP_IFDUP requires at least one item to be on the stack."),p=this.stacktop(-1),wt=this.castToBool(p),wt&&(this.stack.push([...p]),this.stackMem+=p.length);break;case X.OP_DEPTH:p=new ot(this.stack.length).toScriptNum(),this.stack.push(p),this.stackMem+=p.length;break;case X.OP_DROP:this.stack.length<1&&this.scriptEvaluationError("OP_DROP requires at least one item to be on the stack."),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();break;case X.OP_DUP:this.stack.length<1&&this.scriptEvaluationError("OP_DUP requires at least one item to be on the stack."),this.stack.push([...this.stacktop(-1)]),this.stackMem+=this.stacktop(-1).length;break;case X.OP_NIP:this.stack.length<2&&this.scriptEvaluationError("OP_NIP requires at least two items to be on the stack."),this.stack.splice(this.stack.length-2,1),this.stackMem-=this.stacktop(-1).length;break;case X.OP_OVER:this.stack.length<2&&this.scriptEvaluationError("OP_OVER requires at least two items to be on the stack."),this.stack.push([...this.stacktop(-2)]),this.stackMem+=this.stacktop(-2).length;break;case X.OP_PICK:case X.OP_ROLL:this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least two items to be on the stack.`),p=this.stacktop(-1),P=ot.fromScriptNum(p,In),_=P.toNumber(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),(_<0||_>=this.stack.length)&&this.scriptEvaluationError(`${X[_t]} requires the top stack element to be 0 or a positive number less than the current size of the stack.`),p=this.stacktop(-_-1),_t===X.OP_ROLL&&(this.stack.splice(this.stack.length-_-1,1),this.stackMem-=p.length),this.stack.push([...p]),this.stackMem+=p.length;break;case X.OP_ROT:this.stack.length<3&&this.scriptEvaluationError("OP_ROT requires at least three items to be on the stack."),O=this.stacktop(-3),A=this.stacktop(-2),R=this.stacktop(-1),this.stack[this.stack.length-3]=A,this.stack[this.stack.length-2]=R,this.stack[this.stack.length-1]=O;break;case X.OP_SWAP:this.stack.length<2&&this.scriptEvaluationError("OP_SWAP requires at least two items to be on the stack."),O=this.stacktop(-2),A=this.stacktop(-1),this.stack[this.stack.length-2]=A,this.stack[this.stack.length-1]=O;break;case X.OP_TUCK:this.stack.length<2&&this.scriptEvaluationError("OP_TUCK requires at least two items to be on the stack."),this.stack.splice(this.stack.length-2,0,[...this.stacktop(-1)]),this.stackMem+=this.stacktop(-1).length;break;case X.OP_SIZE:this.stack.length<1&&this.scriptEvaluationError("OP_SIZE requires at least one item to be on the stack."),P=new ot(this.stacktop(-1).length),this.stack.push(P.toScriptNum()),this.stackMem+=P.toScriptNum().length;break;case X.OP_AND:case X.OP_OR:case X.OP_XOR:switch(this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least one item to be on the stack.`),g=this.stacktop(-2),b=this.stacktop(-1),g.length!==b.length&&this.scriptEvaluationError(`${X[_t]} requires the top two stack items to be the same size.`),_t){case X.OP_AND:for(let tt=0;tt<g.length;tt++)g[tt]&=b[tt];break;case X.OP_OR:for(let tt=0;tt<g.length;tt++)g[tt]|=b[tt];break;case X.OP_XOR:for(let tt=0;tt<g.length;tt++)g[tt]^=b[tt];break}t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();break;case X.OP_INVERT:this.stack.length<1&&this.scriptEvaluationError("OP_INVERT requires at least one item to be on the stack."),p=this.stacktop(-1);for(let tt=0;tt<p.length;tt++)p[tt]=~p[tt];break;case X.OP_LSHIFT:case X.OP_RSHIFT:if(this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least two items to be on the stack.`),g=this.stacktop(-2),g.length===0)t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();else{C=new ot(g),N=ot.fromScriptNum(this.stacktop(-1),In),_=N.toNumber(),_<0&&this.scriptEvaluationError(`${X[_t]} requires the top item on the stack not to be negative.`),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();let tt;_t===X.OP_LSHIFT&&(tt=C.ushln(_)),_t===X.OP_RSHIFT&&(tt=C.ushrn(_));const xt=l(tt.toArray().slice(g.length*-1),g.length);this.stack.push(xt),this.stackMem+=xt.length}break;case X.OP_EQUAL:case X.OP_EQUALVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least two items to be on the stack.`),g=this.stacktop(-2),b=this.stacktop(-1),dt=Zt(g)===Zt(b),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(dt?[1]:[]),this.stackMem+=dt?1:0,_t===X.OP_EQUALVERIFY&&(this.castToBool(this.stacktop(-1))?(t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i()):this.scriptEvaluationError("OP_EQUALVERIFY requires the top two stack items to be equal."));break;case X.OP_1ADD:case X.OP_1SUB:case X.OP_NEGATE:case X.OP_ABS:case X.OP_NOT:case X.OP_0NOTEQUAL:switch(this.stack.length<1&&this.scriptEvaluationError(`${X[_t]} requires at least one items to be on the stack.`),p=this.stacktop(-1),P=ot.fromScriptNum(p,In),_t){case X.OP_1ADD:P=P.addn(1);break;case X.OP_1SUB:P=P.subn(1);break;case X.OP_NEGATE:P=P.neg();break;case X.OP_ABS:P.cmpn(0)<0&&(P=P.neg());break;case X.OP_NOT:P=new ot(P.cmpn(0)===0?1:0);break;case X.OP_0NOTEQUAL:P=new ot(P.cmpn(0)!==0?1:0);break}t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(P.toScriptNum()),this.stackMem+=P.toScriptNum().length;break;case X.OP_ADD:case X.OP_SUB:case X.OP_MUL:case X.OP_MOD:case X.OP_DIV:case X.OP_BOOLAND:case X.OP_BOOLOR:case X.OP_NUMEQUAL:case X.OP_NUMEQUALVERIFY:case X.OP_NUMNOTEQUAL:case X.OP_LESSTHAN:case X.OP_GREATERTHAN:case X.OP_LESSTHANOREQUAL:case X.OP_GREATERTHANOREQUAL:case X.OP_MIN:case X.OP_MAX:switch(this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least two items to be on the stack.`),C=ot.fromScriptNum(this.stacktop(-2),In),N=ot.fromScriptNum(this.stacktop(-1),In),P=new ot(0),_t){case X.OP_ADD:P=C.add(N);break;case X.OP_SUB:P=C.sub(N);break;case X.OP_MUL:P=C.mul(N);break;case X.OP_DIV:N.cmpn(0)===0&&this.scriptEvaluationError("OP_DIV cannot divide by zero!"),P=C.div(N);break;case X.OP_MOD:N.cmpn(0)===0&&this.scriptEvaluationError("OP_MOD cannot divide by zero!"),P=C.mod(N);break;case X.OP_BOOLAND:P=new ot(C.cmpn(0)!==0&&N.cmpn(0)!==0?1:0);break;case X.OP_BOOLOR:P=new ot(C.cmpn(0)!==0||N.cmpn(0)!==0?1:0);break;case X.OP_NUMEQUAL:P=new ot(C.cmp(N)===0?1:0);break;case X.OP_NUMEQUALVERIFY:P=new ot(C.cmp(N)===0?1:0);break;case X.OP_NUMNOTEQUAL:P=new ot(C.cmp(N)!==0?1:0);break;case X.OP_LESSTHAN:P=new ot(C.cmp(N)<0?1:0);break;case X.OP_GREATERTHAN:P=new ot(C.cmp(N)>0?1:0);break;case X.OP_LESSTHANOREQUAL:P=new ot(C.cmp(N)<=0?1:0);break;case X.OP_GREATERTHANOREQUAL:P=new ot(C.cmp(N)>=0?1:0);break;case X.OP_MIN:P=C.cmp(N)<0?C:N;break;case X.OP_MAX:P=C.cmp(N)>0?C:N;break}t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(P.toScriptNum()),this.stackMem+=P.toScriptNum().length,_t===X.OP_NUMEQUALVERIFY&&(this.castToBool(this.stacktop(-1))?(t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i()):this.scriptEvaluationError("OP_NUMEQUALVERIFY requires the top stack item to be truthy."));break;case X.OP_WITHIN:this.stack.length<3&&this.scriptEvaluationError("OP_WITHIN requires at least three items to be on the stack."),C=ot.fromScriptNum(this.stacktop(-3),In),N=ot.fromScriptNum(this.stacktop(-2),In),D=ot.fromScriptNum(this.stacktop(-1),In),wt=N.cmp(C)<=0&&C.cmp(D)<0,t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(wt?[1]:[]),this.stackMem+=wt?1:0;break;case X.OP_RIPEMD160:case X.OP_SHA1:case X.OP_SHA256:case X.OP_HASH160:case X.OP_HASH256:{this.stack.length<1&&this.scriptEvaluationError(`${X[_t]} requires at least one item to be on the stack.`);let tt=[];p=this.stacktop(-1),_t===X.OP_RIPEMD160?tt=jN(p):_t===X.OP_SHA1?tt=HN(p):_t===X.OP_SHA256?tt=Vn(p):_t===X.OP_HASH160?tt=BT(p):_t===X.OP_HASH256&&(tt=jn(p)),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(tt),this.stackMem+=tt.length;break}case X.OP_CODESEPARATOR:this.lastCodeSeparator=this.programCounter;break;case X.OP_CHECKSIG:case X.OP_CHECKSIGVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${X[_t]} requires at least two items to be on the stack.`),U=this.stacktop(-2),F=this.stacktop(-1),(!n(U)||!c(F))&&this.scriptEvaluationError(`${X[_t]} requires correct encoding for the public key and signature.`),this.context==="UnlockingScript"?L=new va(this.unlockingScript.chunks.slice(this.lastCodeSeparator??0)):L=new va(this.lockingScript.chunks.slice(this.lastCodeSeparator??0)),L.findAndDelete(new va().writeBin(U));try{j=vi.fromChecksigFormat(U),V=Io.fromDER(F),yt=d(j,V,L)}catch{yt=!1}!yt&&U.length>0&&this.scriptEvaluationError(`${X[_t]} failed to verify the signature, and requires an empty signature when verification fails.`),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(yt?[1]:[]),this.stackMem+=yt?1:0,_t===X.OP_CHECKSIGVERIFY&&(yt?(t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i()):this.scriptEvaluationError("OP_CHECKSIGVERIFY requires that a valid signature is provided."));break;case X.OP_CHECKMULTISIG:case X.OP_CHECKMULTISIGVERIFY:W=1,this.stack.length<W&&this.scriptEvaluationError(`${X[_t]} requires at least 1 item to be on the stack.`),$=ot.fromScriptNum(this.stacktop(-W),In).toNumber(),($<0||$>I_)&&this.scriptEvaluationError(`${X[_t]} requires a key count between 0 and ${I_}.`),Y=++W,W+=$,Q=$+2,this.stack.length<W&&this.scriptEvaluationError(`${X[_t]} requires the number of stack items not to be less than the number of keys used.`),J=ot.fromScriptNum(this.stacktop(-W),In).toNumber(),(J<0||J>$)&&this.scriptEvaluationError(`${X[_t]} requires the number of signatures to be no greater than the number of keys.`),vt=++W,W+=J,this.stack.length<W&&this.scriptEvaluationError(`${X[_t]} requires the number of stack items not to be less than the number of signatures provided.`),this.context==="UnlockingScript"?L=new va(this.unlockingScript.chunks.slice(this.lastCodeSeparator??0)):L=new va(this.lockingScript.chunks.slice(this.lastCodeSeparator??0));for(let tt=0;tt<J;tt++)U=this.stacktop(-vt-tt),L.findAndDelete(new va().writeBin(U));for(yt=!0;yt&&J>0;){U=this.stacktop(-vt),F=this.stacktop(-Y),(!n(U)||!c(F))&&this.scriptEvaluationError(`${X[_t]} requires correct encoding for the public key and signature.`);try{j=vi.fromChecksigFormat(U),V=Io.fromString(Zt(F)),q=d(j,V,L)}catch{q=!1}q&&(vt++,J--),Y++,$--,J>$&&(yt=!1)}for(;W-- >1;)!yt&&Q===0&&this.stacktop(-1).length>0&&this.scriptEvaluationError(`${X[_t]} failed to verify a signature, and requires an empty signature when verification fails.`),Q>0&&Q--,t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();this.stack.length<1&&this.scriptEvaluationError(`${X[_t]} requires an extra item to be on the stack.`),this.stacktop(-1).length>0&&this.scriptEvaluationError(`${X[_t]} requires the extra stack item to be empty.`),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),this.stack.push(yt?[1]:[]),this.stackMem+=yt?1:0,_t===X.OP_CHECKMULTISIGVERIFY&&(yt?(t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i()):this.scriptEvaluationError("OP_CHECKMULTISIGVERIFY requires that a sufficient number of valid signatures are provided."));break;case X.OP_CAT:this.stack.length<2&&this.scriptEvaluationError("OP_CAT requires at least two items to be on the stack."),g=this.stacktop(-2),b=this.stacktop(-1),g.length+b.length>hc&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${hc} bytes.`),this.stack[this.stack.length-2]=[...g,...b],this.stackMem-=g.length,this.stackMem-=b.length,this.stackMem+=g.length+b.length,t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i();break;case X.OP_SPLIT:this.stack.length<2&&this.scriptEvaluationError("OP_SPLIT requires at least two items to be on the stack."),g=this.stacktop(-2),_=ot.fromScriptNum(this.stacktop(-1),In).toNumber(),(_<0||_>g.length)&&this.scriptEvaluationError("OP_SPLIT requires the first stack item to be a non-negative number less than or equal to the size of the second-from-top stack item."),b=[...g],this.stack[this.stack.length-2]=b.slice(0,_),this.stackMem-=g.length,this.stackMem+=_,this.stack[this.stack.length-1]=b.slice(_),this.stackMem+=g.length-_;break;case X.OP_NUM2BIN:if(this.stack.length<2&&this.scriptEvaluationError("OP_NUM2BIN requires at least two items to be on the stack."),S=ot.fromScriptNum(this.stacktop(-1),In).toNumber(),S>hc&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${hc} bytes.`),t=this.stack.pop(),t!=null&&(this.stackMem-=t.length),i(),T=this.stacktop(-1),T=b_(T),T.length>S&&this.scriptEvaluationError("OP_NUM2BIN requires that the size expressed in the top stack item is large enough to hold the value expressed in the second-from-top stack item."),T.length===S){this.stack[this.stack.length-1]=T;break}for(k=0,T.length>0&&(k=T[T.length-1]&128,T[T.length-1]&=127),I=new Array(S),I.fill(0),_=0;_<S;_++)I[_]=T[_];for(_=T.length-1;_++<S-2;)I[_]=0;I[_]=k,this.stack[this.stack.length-1]=I,this.stackMem-=T.length,this.stackMem+=S;break;case X.OP_BIN2NUM:this.stack.length<1&&this.scriptEvaluationError("OP_BIN2NUM requires at least one item to be on the stack."),g=this.stacktop(-1),b=b_(g),this.stack[this.stack.length-1]=b,this.stackMem-=g.length,this.stackMem+=b.length,a(b)||this.scriptEvaluationError("OP_BIN2NUM requires that the resulting number is valid.");break;default:this.scriptEvaluationError("Invalid opcode!")}return this.programCounter++,!0}validate(){for(this.unlockingScript.isPushOnly()||this.scriptEvaluationError("Unlocking scripts can only contain push operations, and no other opcodes.");this.step()&&!(this.context==="LockingScript"&&this.programCounter>=this.lockingScript.chunks.length););return this.ifStack.length>0&&this.scriptEvaluationError("Every OP_IF must be terminated prior to the end of the script."),this.stack.length!==1&&this.scriptEvaluationError("The clean stack rule requires exactly one item to be on the stack after script execution."),this.castToBool(this.stacktop(-1))||this.scriptEvaluationError("The top stack element must be truthy after script evaluation."),!0}stacktop(t){return this.stack[this.stack.length+t]}castToBool(t){for(let i=0;i<t.length;i++)if(t[i]!==0)return!(i===t.length-1&&t[i]===128);return!1}scriptEvaluationError(t){throw new Error(`Script evaluation error: ${t}

Source TXID: ${this.sourceTXID}
Source output index: ${this.sourceOutputIndex}
Context: ${this.context}
Program counter: ${this.programCounter}
Stack size: ${this.stack.length}
Alt stack size: ${this.altStack.length}`)}};function k_(s){if(s==null)throw new Error("must have value");return s}let cC=class{lock(t){let i;if(typeof t=="string"){const r=LT(t);if(r.prefix[0]!==0&&r.prefix[0]!==111)throw new Error("only P2PKH is supported");i=r.data}else i=t;if(i.length!==20)throw new Error("P2PKH hash length must be 20 bytes");return new nu([{op:X.OP_DUP},{op:X.OP_HASH160},{op:i.length,data:i},{op:X.OP_EQUALVERIFY},{op:X.OP_CHECKSIG}])}unlock(t,i="all",r=!1,e,o){return{sign:async(a,l)=>{var v,_,S;let f=vi.SIGHASH_FORKID;i==="all"&&(f|=vi.SIGHASH_ALL),i==="none"&&(f|=vi.SIGHASH_NONE),i==="single"&&(f|=vi.SIGHASH_SINGLE),r&&(f|=vi.SIGHASH_ANYONECANPAY);const n=a.inputs[l],c=a.inputs.filter((T,I)=>I!==l),d=n.sourceTXID??((v=n.sourceTransaction)==null?void 0:v.id("hex"));if(d==null||d===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(d==="")throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(e||(e=(_=n.sourceTransaction)==null?void 0:_.outputs[n.sourceOutputIndex].satoshis),e==null||e===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(o||(o=(S=n.sourceTransaction)==null?void 0:S.outputs[n.sourceOutputIndex].lockingScript),o==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const y=vi.format({sourceTXID:d,sourceOutputIndex:k_(n.sourceOutputIndex),sourceSatoshis:e,transactionVersion:a.version,otherInputs:c,inputIndex:l,outputs:a.outputs,inputSequence:k_(n.sequence),subscript:o,lockTime:a.lockTime,scope:f}),p=t.sign(Vn(y)),b=new vi(p.r,p.s,f).toChecksigFormat(),w=t.toPublicKey().encode(!0);return new Xp([{op:b.length,data:b},{op:w.length,data:w}])},estimateLength:async()=>108}}};function E_(s){if(s==null)throw new Error("must have value");return s}const uC=s=>s.length===0?{op:0}:s.length===1&&s[0]===0?{op:0}:s.length===1&&s[0]>0&&s[0]<=16?{op:80+s[0]}:s.length===1&&s[0]===129?{op:79}:s.length<=75?{op:s.length,data:s}:s.length<=255?{op:76,data:s}:s.length<=65535?{op:77,data:s}:{op:78,data:s};let _0=class{constructor(t,i){rt(this,"wallet");rt(this,"originator");this.wallet=t,this.originator=i}static decode(t){var e;const i=Io.fromString(Zt(E_(t.chunks[0].data))),r=[];for(let o=2;o<t.chunks.length;o++){const a=(e=t.chunks[o+1])==null?void 0:e.op;let l=t.chunks[o].data??[];if(l.length===0&&(t.chunks[o].op>=80&&t.chunks[o].op<=95?l=[t.chunks[o].op-80]:t.chunks[o].op===0?l=[0]:t.chunks[o].op===79&&(l=[129])),r.push(l),a===X.OP_DROP||a===X.OP_2DROP)break}return{fields:r,lockingPublicKey:i}}async lock(t,i,r,e,o=!1,a=!0,l="before"){const{publicKey:f}=await this.wallet.getPublicKey({protocolID:i,keyID:r,counterparty:e,forSelf:o},this.originator),n=[],c=[];if(n.push({op:f.length/2,data:Pt(f,"hex")}),n.push({op:X.OP_CHECKSIG}),a){const y=t.reduce((g,b)=>[...g,...b],[]),{signature:p}=await this.wallet.createSignature({data:y,protocolID:i,keyID:r,counterparty:e},this.originator);t.push(p)}for(const y of t)c.push(uC(y));let d=t.length;for(;d>1;)c.push({op:X.OP_2DROP}),d-=2;return d!==0&&c.push({op:X.OP_DROP}),l==="before"?new nu([...n,...c]):new nu([...c,...n])}unlock(t,i,r,e="all",o=!1,a,l){return{sign:async(f,n)=>{var T,I,k;let c=vi.SIGHASH_FORKID;e==="all"&&(c|=vi.SIGHASH_ALL),e==="none"&&(c|=vi.SIGHASH_NONE),e==="single"&&(c|=vi.SIGHASH_SINGLE),o&&(c|=vi.SIGHASH_ANYONECANPAY);const d=f.inputs[n],y=f.inputs.filter((O,A)=>A!==n),p=d.sourceTXID??((T=d.sourceTransaction)==null?void 0:T.id("hex"));if(p==null||p===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(a||(a=(I=d.sourceTransaction)==null?void 0:I.outputs[d.sourceOutputIndex].satoshis),a==null||a===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(l||(l=(k=d.sourceTransaction)==null?void 0:k.outputs[d.sourceOutputIndex].lockingScript),l==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const g=vi.format({sourceTXID:p,sourceOutputIndex:E_(d.sourceOutputIndex),sourceSatoshis:a,transactionVersion:f.version,otherInputs:y,inputIndex:n,outputs:f.outputs,inputSequence:d.sequence??4294967295,subscript:l,lockTime:f.lockTime,scope:c}),b=Vn(g),{signature:w}=await this.wallet.createSignature({data:b,protocolID:t,keyID:i,counterparty:r},this.originator),v=ls.fromDER([...w]),S=new vi(v.r,v.s,c).toChecksigFormat();return new Xp([{op:S.length,data:S}])},estimateLength:async()=>73}}},lC=class{constructor(t){rt(this,"value");this.value=t}async computeFee(t){const i=o=>o>4294967296?9:o>65536?5:o>253?3:1;let r=4;r+=i(t.inputs.length);for(let o=0;o<t.inputs.length;o++){const a=t.inputs[o];r+=40;let l;if(typeof a.unlockingScript=="object")l=a.unlockingScript.toBinary().length;else if(typeof a.unlockingScriptTemplate=="object")l=await a.unlockingScriptTemplate.estimateLength(t,o);else throw new Error("All inputs must have an unlocking script or an unlocking script template for sat/kb fee computation.");r+=i(l),r+=l}r+=i(t.outputs.length);for(const o of t.outputs){r+=8;const a=o.lockingScript.toBinary().length;r+=i(a),r+=a}return r+=4,Math.ceil(r/1e3*this.value)}},dC=class{constructor(t){rt(this,"https");this.https=t}async request(t,i){return await new Promise((r,e)=>{const o=this.https.request(t,i,a=>{let l="";a.on("data",f=>{l+=f}),a.on("end",()=>{const f=a.statusCode>=200&&a.statusCode<=299,n=a.headers["content-type"],c=l!==""&&typeof n=="string"&&n.startsWith("application/json")?JSON.parse(l):l;r({status:a.statusCode,statusText:a.statusMessage,ok:f,data:c})})});o.on("error",a=>{e(a)}),i.data!==null&&i.data!==void 0&&o.write(JSON.stringify(i.data)),o.end()})}},fC=class{constructor(t){rt(this,"fetch");this.fetch=t}async request(t,i){const r={method:i.method,headers:i.headers,body:JSON.stringify(i.data)},e=await this.fetch(t,r),o=e.headers.get("Content-Type"),a=(o==null?void 0:o.startsWith("application/json"))??!1?await e.json():await e.text();return{ok:e.ok,status:e.status,statusText:e.statusText,data:a}}};function yb(){const s={async request(...t){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new fC(window.fetch.bind(window));if(typeof require<"u")try{const t=require("https");return new dC(t)}catch{return s}else return s}function O_(){return`ts-sdk-${Zt(ds(16))}`}let hC=class{constructor(t,i){rt(this,"URL");rt(this,"apiKey");rt(this,"deploymentId");rt(this,"callbackUrl");rt(this,"callbackToken");rt(this,"headers");rt(this,"httpClient");if(this.URL=t,typeof i=="string")this.apiKey=i,this.httpClient=yb(),this.deploymentId=O_(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const r=i??{},{apiKey:e,deploymentId:o,httpClient:a,callbackToken:l,callbackUrl:f,headers:n}=r;this.apiKey=e,this.httpClient=a??yb(),this.deploymentId=o??O_(),this.callbackToken=l,this.callbackUrl=f,this.headers=n}}requestHeaders(){const t={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(t.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(t["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(t["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const i in this.headers)t[i]=this.headers[i];return t}async broadcast(t){let i;try{i=t.toHexEF()}catch(e){if(e.message==="All inputs must have source transactions when serializing to EF format")i=t.toHex();else throw e}const r={method:"POST",headers:this.requestHeaders(),data:{rawTx:i}};try{const e=await this.httpClient.request(`${this.URL}/v1/tx`,r);if(e.ok){const{txid:o,extraInfo:a,txStatus:l,competingTxs:f}=e.data,n={status:"success",txid:o,message:`${l} ${a}`};return f!=null&&(n.competingTxs=f),n}else{const o=typeof e.status,a={status:"error",code:o==="number"||o==="string"?e.status.toString():"ERR_UNKNOWN",description:"Unknown error"};let l=e.data;if(typeof l=="string")try{l=JSON.parse(e.data)}catch{}return typeof l=="object"&&(l!==null&&(a.more=l),l!=null&&typeof l.txid=="string"&&(a.txid=l.txid),l!=null&&"detail"in l&&typeof l.detail=="string"&&(a.description=l.detail)),a}}catch(e){return{status:"error",code:"500",description:typeof e.message=="string"?e.message:"Internal Server Error"}}}async broadcastMany(t){const i=t.map(e=>{try{return{rawTx:e.toHexEF()}}catch(o){if(o.message==="All inputs must have source transactions when serializing to EF format")return{rawTx:e.toHex()};throw o}}),r={method:"POST",headers:this.requestHeaders(),data:i};try{return(await this.httpClient.request(`${this.URL}/v1/txs`,r)).data}catch(e){const o={status:"error",code:"500",description:typeof e.message=="string"?e.message:"Internal Server Error"};return t.map(()=>o)}}};function pC(s=!1,t={}){return new hC(s?"https://arc-test.taal.com":"https://arc.taal.com",t)}let yC=class{constructor(t="main",i={}){rt(this,"network");rt(this,"apiKey");rt(this,"URL");rt(this,"httpClient");const{apiKey:r,httpClient:e}=i;this.network=t,this.URL=`https://api.whatsonchain.com/v1/bsv/${t}`,this.httpClient=e??yb(),this.apiKey=r??""}async isValidRootForHeight(t,i){const r={method:"GET",headers:this.getHttpHeaders()},e=await this.httpClient.request(`${this.URL}/block/${i}/header`,r);if(e.ok){const{merkleroot:o}=e.data;return o===t}else{if(e.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${i} because of an error: ${JSON.stringify(e.data)} `)}}async currentHeight(){try{const t={method:"GET",headers:this.getHttpHeaders()},i=await this.httpClient.request(`${this.URL}/block/headers`,t);if(i.ok)return i.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(i.data)} `)}catch(t){throw new Error(`Failed to get current height because of an error: ${t instanceof Error?t.message:String(t)}`)}}getHttpHeaders(){const t={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(t.Authorization=this.apiKey),t}};function gC(){return new yC}let mC=class jd{constructor(t,i,r=!0){rt(this,"blockHeight");rt(this,"path");this.blockHeight=t,this.path=i;const e=Array(this.path.length).fill(0).map(()=>new Set);this.path.forEach((a,l)=>{if(a.length===0&&l===0)throw new Error(`Empty level at height: ${l}`);const f=new Set;a.forEach(n=>{if(f.has(n.offset))throw new Error(`Duplicate offset: ${n.offset}, at height: ${l}`);if(f.add(n.offset),l===0){if(n.duplicate!==!0)for(let c=1;c<this.path.length;c++)e[c].add(n.offset>>c^1)}else if(r&&!e[l].has(n.offset))throw new Error(`Invalid offset: ${n.offset}, at height: ${l}, with legal offsets: ${Array.from(e[l]).join(", ")}`)})});let o;this.path[0].forEach((a,l)=>{if(l===0&&(o=this.computeRoot(a.hash)),o!==this.computeRoot(a.hash))throw new Error("Mismatched roots")})}static fromHex(t){return jd.fromBinary(Pt(t,"hex"))}static fromReader(t,i=!0){const r=t.readVarIntNum(),e=t.readUInt8(),o=Array(e).fill(null).map(()=>[]);let a,l,f;for(let n=0;n<e;n++){for(f=t.readVarIntNum();f>0;){l=t.readVarIntNum(),a=t.readUInt8();const c={offset:l};(a&1)!==0?c.duplicate=!0:((a&2)!==0&&(c.txid=!0),c.hash=Zt(t.read(32).reverse())),(!Array.isArray(o[n])||o[n].length===0)&&(o[n]=[]),o[n].push(c),f--}o[n].sort((c,d)=>c.offset-d.offset)}return new jd(r,o,i)}static fromBinary(t){const i=new hi(t);return jd.fromReader(i)}static fromCoinbaseTxidAndHeight(t,i){return new jd(i,[[{offset:0,hash:t,txid:!0}]])}toBinary(){const t=new le;t.writeVarIntNum(this.blockHeight);const i=this.path.length;t.writeUInt8(i);for(let r=0;r<i;r++){const e=Object.keys(this.path[r]).length;t.writeVarIntNum(e);for(const o of this.path[r]){t.writeVarIntNum(o.offset);let a=0;(o==null?void 0:o.duplicate)===!0&&(a|=1),(o==null?void 0:o.txid)!==void 0&&o.txid!==null&&(a|=2),t.writeUInt8(a),(a&1)===0&&t.write(Pt(o.hash,"hex").reverse())}}return t.toArray()}toHex(){return Zt(this.toBinary())}indexOf(t){const i=this.path[0].find(r=>r.hash===t);if(i==null)throw new Error(`Transaction ID ${t} not found in the Merkle Path`);return i.offset}computeRoot(t){if(typeof t!="string"){const o=this.path[0].find(a=>!!(a!=null&&a.hash));if(o==null)throw new Error("No valid leaf found in the Merkle Path");t=o.hash}if(typeof t!="string")throw new Error("Transaction ID is undefined");const i=this.indexOf(t);if(typeof i!="number")throw new Error(`This proof does not contain the txid: ${t??"undefined"}`);const r=o=>Zt(jn(Pt(o,"hex").reverse()).reverse());let e=t;if(this.path.length===1&&this.path[0].length===1)return e;for(let o=0;o<this.path.length;o++){this.path[o];const a=i>>o^1,l=this.findOrComputeLeaf(o,a);if(typeof l!="object")throw new Error(`Missing hash for index ${i} at height ${o}`);l.duplicate===!0?e=r((e??"")+(e??"")):a%2!==0?e=r((l.hash??"")+(e??"")):e=r((e??"")+(l.hash??""))}return e}findOrComputeLeaf(t,i){const r=c=>Zt(jn(Pt(c,"hex").reverse()).reverse());let e=this.path[t].find(c=>c.offset===i);if(e!=null)return e;if(t===0)return;const o=t-1,a=i<<1,l=this.findOrComputeLeaf(o,a);if(l==null||l.hash==null||l.hash==="")return;const f=this.findOrComputeLeaf(o,a+1);if(f==null)return;let n;return f.duplicate===!0?n=r(l.hash+l.hash):n=r((f.hash??"")+(l.hash??"")),e={offset:i,hash:n},e}async verify(t,i){const r=this.computeRoot(t);if(this.indexOf(t)===0){const e=await i.currentHeight();if(this.blockHeight+100<e)return!1}return await i.isValidRootForHeight(r,this.blockHeight)}combine(t){var o,a;if(this.blockHeight!==t.blockHeight)throw new Error("You cannot combine paths which do not have the same block height.");const i=this.computeRoot(),r=t.computeRoot();if(i!==r)throw new Error("You cannot combine paths which do not have the same root.");const e=[];for(let l=0;l<this.path.length;l++){e.push([]);for(let f=0;f<this.path[l].length;f++)e[l].push(this.path[l][f]);for(let f=0;f<t.path[l].length;f++)if(e[l].find(n=>n.offset===t.path[l][f].offset)===void 0)e[l].push(t.path[l][f]);else if(((o=t.path[l][f])==null?void 0:o.txid)!==void 0&&((a=t.path[l][f])==null?void 0:a.txid)!==null){const n=e[l].find(c=>c.offset===t.path[l][f].offset);n!=null&&(n.txid=!0)}}this.path=e,this.trim()}trim(){const t=(a,l)=>{(l.length===0||l.slice(-1)[0]!==a)&&l.push(a)},i=(a,l)=>{for(let f=a.length;f>=0;f--){const n=this.path[l].findIndex(c=>c.offset===a[f]);n>=0&&this.path[l].splice(n,1)}},r=a=>{const l=[];for(const f of a)t(f>>1,l);return l};let e=[],o=[];for(let a=0;a<this.path.length;a++)this.path[a].sort((l,f)=>l.offset-f.offset);for(let a=0;a<this.path[0].length;a++){const l=this.path[0][a];if(l.txid===!0)t(l.offset>>1,e);else{const f=l.offset%2===1,n=this.path[0][a+(f?-1:1)];(n.txid===void 0||n.txid===null||!n.txid)&&t(n.offset,o)}}i(o,0);for(let a=1;a<this.path.length;a++)o=e,e=r(e),i(o,a)}},Hh=class po{constructor(t,i){rt(this,"_bumpIndex");rt(this,"_tx");rt(this,"_rawTx");rt(this,"_txid");rt(this,"inputTxids",[]);rt(this,"isValid");typeof t=="string"?this._txid=t:Array.isArray(t)?this._rawTx=t:this._tx=t,this.bumpIndex=i,this.updateInputTxids()}get bumpIndex(){return this._bumpIndex}set bumpIndex(t){this._bumpIndex=t,this.updateInputTxids()}get hasProof(){return this._bumpIndex!==void 0}get isTxidOnly(){return this._txid!==void 0&&this._txid!==null&&this._rawTx==null&&this._tx==null}get txid(){if(this._txid!==void 0&&this._txid!==null&&this._txid!=="")return this._txid;if(this._tx!=null)return this._txid=this._tx.id("hex"),this._txid;if(this._rawTx!=null)return this._txid=Zt(jn(this._rawTx)),this._txid;throw new Error("Internal")}get tx(){if(this._tx!=null)return this._tx;if(this._rawTx!=null)return this._tx=Ar.fromBinary(this._rawTx),this._tx}get rawTx(){if(this._rawTx!=null)return this._rawTx;if(this._tx!=null)return this._rawTx=this._tx.toBinary(),this._rawTx}static fromTx(t,i){return new po(t,i)}static fromRawTx(t,i){return new po(t,i)}static fromTxid(t,i){return new po(t,i)}updateInputTxids(){if(this.hasProof||this.tx==null)this.inputTxids=[];else{const t={};for(const i of this.tx.inputs)i.sourceTXID!==void 0&&i.sourceTXID!==null&&i.sourceTXID!==""&&(t[i.sourceTXID]=!0);this.inputTxids=Object.keys(t)}}toWriter(t,i){const r=l=>{t.writeUInt8(l)},e=()=>{if(this._txid==null)throw new Error("Transaction ID (_txid) is undefined");t.writeReverse(Pt(this._txid,"hex"))},o=()=>{if(this._rawTx!=null)t.write(this._rawTx);else if(this._tx!=null)t.write(this._tx.toBinary());else throw new Error("a valid serialized Transaction is expected")},a=()=>{this.bumpIndex===void 0?r(wa.RAWTX):(r(wa.RAWTX_AND_BUMP_INDEX),t.writeVarIntNum(this.bumpIndex))};i===Zc?this.isTxidOnly?(r(wa.TXID_ONLY),e()):this.bumpIndex!==void 0?(r(wa.RAWTX_AND_BUMP_INDEX),t.writeVarIntNum(this.bumpIndex),o()):(r(wa.RAWTX),o()):(o(),a())}static fromReader(t,i){let r,e,o;if(i===Zc){const a=t.readUInt8();a===wa.TXID_ONLY?o=po.fromTxid(Zt(t.readReverse(32))):(a===wa.RAWTX_AND_BUMP_INDEX&&(e=t.readVarIntNum()),r=Ar.fromReader(t),o=po.fromTx(r,e))}else r=Ar.fromReader(t),e=t.readUInt8()!==0?t.readVarIntNum():void 0,o=po.fromTx(r,e);return o}};function A_(s){if(s==null)throw new Error("Expected a valid value, but got undefined.");return s}const gb=4022206465,Zc=4022206466,P_=16843009;var wa;(function(s){s[s.RAWTX=0]="RAWTX",s[s.RAWTX_AND_BUMP_INDEX=1]="RAWTX_AND_BUMP_INDEX",s[s.TXID_ONLY=2]="TXID_ONLY"})(wa||(wa={}));let bC=class Xc{constructor(t=Zc){rt(this,"bumps",[]);rt(this,"txs",[]);rt(this,"version",Zc);rt(this,"atomicTxid");this.version=t}findTxid(t){return this.txs.find(i=>i.txid===t)}makeTxidOnly(t){const i=this.txs.findIndex(e=>e.txid===t);if(i===-1)return;let r=this.txs[i];return r.isTxidOnly||(this.txs.splice(i,1),r=this.mergeTxidOnly(t)),r}findBump(t){return this.bumps.find(i=>i.path[0].some(r=>r.hash===t))}findTransactionForSigning(t){const i=this.findTxid(t);if(!(i==null||i.tx==null)){for(const r of i.tx.inputs)if(r.sourceTransaction==null){const e=this.findTxid(A_(r.sourceTXID));e!=null&&(r.sourceTransaction=e.tx)}return i.tx}}findAtomicTransaction(t){const i=this.findTxid(t);if(i==null||i.tx==null)return;const r=(e,o)=>{const a=e.findBump(o.id("hex"));if(a!=null)o.merklePath=a;else for(const l of o.inputs){if(l.sourceTransaction==null){const f=e.findTxid(A_(l.sourceTXID));f!=null&&(l.sourceTransaction=f.tx)}if(l.sourceTransaction!=null){const f=e.findBump(l.sourceTransaction.id("hex"));f!=null?l.sourceTransaction.merklePath=f:r(e,l.sourceTransaction)}}};return r(this,i.tx),i.tx}mergeBump(t){let i;for(let e=0;e<this.bumps.length;e++){const o=this.bumps[e];if(o===t)return e;if(o.blockHeight===t.blockHeight){const a=o.computeRoot(),l=t.computeRoot();if(a===l){o.combine(t),i=e;break}}}i===void 0&&(i=this.bumps.length,this.bumps.push(t));const r=this.bumps[i];for(const e of this.txs){const o=e.txid;if(e.bumpIndex==null){for(const a of r.path[0])if(a.hash===o){e.bumpIndex=i,a.txid=!0;break}}}return i}mergeRawTx(t,i){const r=new Hh(t,i);return this.removeExistingTxid(r.txid),this.txs.push(r),this.tryToValidateBumpIndex(r),r}mergeTransaction(t){const i=t.id("hex");this.removeExistingTxid(i);let r;t.merklePath!=null&&(r=this.mergeBump(t.merklePath));const e=new Hh(t,r);if(this.txs.push(e),this.tryToValidateBumpIndex(e),r=e.bumpIndex,r===void 0)for(const o of t.inputs)o.sourceTransaction!=null&&this.mergeTransaction(o.sourceTransaction);return e}removeExistingTxid(t){const i=this.txs.findIndex(r=>r.txid===t);i>=0&&this.txs.splice(i,1)}mergeTxidOnly(t){let i=this.txs.find(r=>r.txid===t);return i==null&&(i=new Hh(t),this.txs.push(i),this.tryToValidateBumpIndex(i)),i}mergeBeefTx(t){let i=this.findTxid(t.txid);if(t.isTxidOnly&&i==null?i=this.mergeTxidOnly(t.txid):t._tx!=null&&(i==null||i.isTxidOnly)?i=this.mergeTransaction(t._tx):t._rawTx!=null&&(i==null||i.isTxidOnly)&&(i=this.mergeRawTx(t._rawTx)),i==null)throw new Error(`Failed to merge BeefTx for txid: ${t.txid}`);return i}mergeBeef(t){const i=Array.isArray(t)?Xc.fromBinary(t):t;for(const r of i.bumps)this.mergeBump(r);for(const r of i.txs)this.mergeBeefTx(r)}isValid(t){return this.verifyValid(t).valid}async verify(t,i){const r=this.verifyValid(i);if(!r.valid)return!1;for(const e of Object.keys(r.roots))if(!await t.isValidRootForHeight(r.roots[e],Number(e)))return!1;return!0}verifyValid(t){const i={valid:!1,roots:{}},r=this.sortTxs();if(r.missingInputs.length>0||r.notValid.length>0||r.txidOnly.length>0&&t!==!0||r.withMissingInputs.length>0)return i;const e={};for(const a of this.txs)if(a.isTxidOnly){if(t!==!0)return i;e[a.txid]=!0}const o=(a,l)=>{const f=a.computeRoot(l);return(i.roots[a.blockHeight]===void 0||i.roots[a.blockHeight]==="")&&(i.roots[a.blockHeight]=f),i.roots[a.blockHeight]===f};for(const a of this.bumps)for(const l of a.path[0])if(l.txid===!0&&typeof l.hash=="string"&&l.hash.length>0&&(e[l.hash]=!0,!o(a,l.hash)))return i;for(const a of this.txs)if(a.bumpIndex!==void 0&&this.bumps[a.bumpIndex].path[0].find(f=>f.hash===a.txid)==null)return i;for(const a of this.txs){for(const l of a.inputTxids)if(!e[l])return i;e[a.txid]=!0}return i.valid=!0,i}toWriter(t){t.writeUInt32LE(this.version),t.writeVarIntNum(this.bumps.length);for(const i of this.bumps)t.write(i.toBinary());t.writeVarIntNum(this.txs.length);for(const i of this.txs)i.toWriter(t,this.version)}toBinary(){this.sortTxs();const t=new le;return this.toWriter(t),t.toArray()}toBinaryAtomic(t){this.sortTxs();const i=this.findTxid(t);if(i==null)throw new Error(`${t} does not exist in this Beef`);const r=this.txs[this.txs.length-1]===i?this:this.clone();if(r!==this){const o=this.txs.findIndex(a=>a.txid===t);r.txs.splice(o+1)}const e=new le;return e.writeUInt32LE(P_),e.writeReverse(Pt(t,"hex")),r.toWriter(e),e.toArray()}toHex(){return Zt(this.toBinary())}static fromReader(t){let i=t.readUInt32LE(),r;if(i===P_&&(r=Zt(t.readReverse(32)),i=t.readUInt32LE()),i!==gb&&i!==Zc)throw new Error(`Serialized BEEF must start with ${gb} or ${Zc} but starts with ${i}`);const e=new Xc(i),o=t.readVarIntNum();for(let l=0;l<o;l++){const f=mC.fromReader(t,!1);e.bumps.push(f)}const a=t.readVarIntNum();for(let l=0;l<a;l++){const f=Hh.fromReader(t,i);e.txs.push(f)}return e.atomicTxid=r,e}static fromBinary(t){const i=new hi(t);return Xc.fromReader(i)}static fromString(t,i="hex"){const r=Pt(t,i),e=new hi(r);return Xc.fromReader(e)}tryToValidateBumpIndex(t){if(t.bumpIndex!==void 0)return!0;const i=t.txid;for(let r=0;r<this.bumps.length;r++){const e=this.bumps[r].path[0].findIndex(o=>o.hash===i);if(e>=0)return t.bumpIndex=r,this.bumps[r].path[0][e].txid=!0,!0}return!1}sortTxs(){const t={},i={};let r=[];const e=[],o=[];for(const c of this.txs)i[c.txid]=c,c.isValid=c.hasProof,c.isValid?(t[c.txid]=!0,e.push(c)):c.isTxidOnly&&c.inputTxids.length===0?(t[c.txid]=!0,o.push(c)):r.push(c);const a={},l=[],f=r;r=[];for(const c of f){let d=!1;for(const y of c.inputTxids)i[y]===void 0&&(a[y]=!0,d=!0);d?l.push(c):r.push(c)}for(;r.length>0;){const c=r;r=[];for(const d of c)d.inputTxids.every(y=>t[y])?(t[d.txid]=!0,e.push(d)):r.push(d);if(c.length===r.length)break}const n=r;return this.txs=l.concat(n).concat(o).concat(e),{missingInputs:Object.keys(a),notValid:n.map(c=>c.txid),valid:Object.keys(t),withMissingInputs:l.map(c=>c.txid),txidOnly:o.map(c=>c.txid)}}clone(){const t=new Xc;return t.version=this.version,t.bumps=Array.from(this.bumps),t.txs=Array.from(this.txs),t}trimKnownTxids(t){for(let i=0;i<this.txs.length;){const r=this.txs[i];r.isTxidOnly&&t.includes(r.txid)?this.txs.splice(i,1):i++}}getValidTxids(){return this.sortTxs().valid}toLogString(){var r;let t="";t+=`BEEF with ${this.bumps.length} BUMPS and ${this.txs.length} Transactions, isValid ${this.isValid().toString()}
`;let i=-1;for(const e of this.bumps)i++,t+=`  BUMP ${i}
    block: ${e.blockHeight}
    txids: [
${e.path[0].filter(o=>o.txid===!0).map(o=>`      '${o.hash??""}'`).join(`,
`)}
    ]
`;i=-1;for(const e of this.txs)i++,t+=`  TX ${i}
    txid: ${e.txid}
`,e.bumpIndex!==void 0&&(t+=`    bumpIndex: ${e.bumpIndex}
`),e.isTxidOnly?t+=`    txidOnly
`:t+=`    rawTx length=${((r=e.rawTx)==null?void 0:r.length)??0}
`,e.inputTxids.length>0&&(t+=`    inputs: [
${e.inputTxids.map(o=>`      '${o}'`).join(`,
`)}
    ]
`);return t}addComputedLeaves(){const t=i=>Zt(jn(Pt(i,"hex").reverse()).reverse());for(const i of this.bumps)for(let r=1;r<i.path.length;r++)for(const e of i.path[r-1])if(typeof e.hash=="string"&&(e.offset&1)===0){const o=i.path[r-1].find(l=>l.offset===e.offset+1),a=e.offset>>1;o!==void 0&&typeof o.hash=="string"&&i.path[r].every(l=>l.offset!==a)&&i.path[r].push({offset:a,hash:t(o.hash+e.hash)})}}},Ar=class sr{constructor(t=1,i=[],r=[],e=0,o={},a){rt(this,"version");rt(this,"inputs");rt(this,"outputs");rt(this,"lockTime");rt(this,"metadata");rt(this,"merklePath");rt(this,"cachedHash");this.version=t,this.inputs=i,this.outputs=r,this.lockTime=e,this.metadata=o,this.merklePath=a}static addPathOrInputs(t,i,r){if(typeof t.pathIndex=="number"){const e=r[t.pathIndex];if(typeof e!="object")throw new Error("Invalid merkle path index found in BEEF!");t.tx.merklePath=e}else for(const e of t.tx.inputs){if(e.sourceTXID===void 0)throw new Error("Input sourceTXID is undefined");const o=i[e.sourceTXID];if(typeof o!="object")throw new Error(`Reference to unknown TXID in BEEF: ${e.sourceTXID??"undefined"}`);e.sourceTransaction=o.tx,this.addPathOrInputs(o,i,r)}}static fromBEEF(t,i){const{tx:r}=sr.fromAnyBeef(t,i);return r}static fromAtomicBEEF(t){const{tx:i,txid:r,beef:e}=sr.fromAnyBeef(t);if(r!==e.atomicTxid)throw e.atomicTxid?new Error(`Transaction with TXID ${e.atomicTxid} not found in BEEF data.`):new Error("beef must conform to BRC-95 and must contain the subject txid.");return i}static fromAnyBeef(t,i){const r=bC.fromBinary(t);if(r.txs.length<1)throw new Error("beef must include at least one transaction.");const e=i||r.atomicTxid||r.txs.slice(-1)[0].txid,o=r.findAtomicTransaction(e);if(o==null)throw i?new Error(`Transaction with TXID ${e} not found in BEEF data.`):new Error("beef does not contain transaction for atomic txid.");return{tx:o,beef:r,txid:e}}static fromEF(t){const i=new hi(t),r=i.readUInt32LE();if(Zt(i.read(6))!=="0000000000ef")throw new Error("Invalid EF marker");const e=i.readVarIntNum(),o=[];for(let n=0;n<e;n++){const c=Zt(i.readReverse(32)),d=i.readUInt32LE(),y=i.readVarIntNum(),p=i.read(y),g=Xp.fromBinary(p),b=i.readUInt32LE(),w=i.readUInt64LEBn().toNumber(),v=i.readVarIntNum(),_=i.read(v),S=nu.fromBinary(_),T=new sr(void 0,[],[],void 0);T.outputs=Array(d+1).fill(null),T.outputs[d]={satoshis:w,lockingScript:S},o.push({sourceTransaction:T,sourceTXID:c,sourceOutputIndex:d,unlockingScript:g,sequence:b})}const a=i.readVarIntNum(),l=[];for(let n=0;n<a;n++){const c=i.readUInt64LEBn().toNumber(),d=i.readVarIntNum(),y=i.read(d),p=nu.fromBinary(y);l.push({satoshis:c,lockingScript:p})}const f=i.readUInt32LE();return new sr(r,o,l,f)}static parseScriptOffsets(t){const i=new hi(t),r=[],e=[];i.pos+=4;const o=i.readVarIntNum();for(let l=0;l<o;l++){i.pos+=36;const f=i.readVarIntNum();r.push({vin:l,offset:i.pos,length:f}),i.pos+=f+4}const a=i.readVarIntNum();for(let l=0;l<a;l++){i.pos+=8;const f=i.readVarIntNum();e.push({vout:l,offset:i.pos,length:f}),i.pos+=f}return{inputs:r,outputs:e}}static fromReader(t){const i=t.readUInt32LE(),r=t.readVarIntNum(),e=[];for(let f=0;f<r;f++){const n=Zt(t.readReverse(32)),c=t.readUInt32LE(),d=t.readVarIntNum(),y=t.read(d),p=Xp.fromBinary(y),g=t.readUInt32LE();e.push({sourceTXID:n,sourceOutputIndex:c,unlockingScript:p,sequence:g})}const o=t.readVarIntNum(),a=[];for(let f=0;f<o;f++){const n=t.readUInt64LEBn().toNumber(),c=t.readVarIntNum(),d=t.read(c),y=nu.fromBinary(d);a.push({satoshis:n,lockingScript:y})}const l=t.readUInt32LE();return new sr(i,e,a,l)}static fromBinary(t){const i=new hi(t);return sr.fromReader(i)}static fromHex(t){return sr.fromBinary(Pt(t,"hex"))}static fromHexEF(t){return sr.fromEF(Pt(t,"hex"))}static fromHexBEEF(t,i){return sr.fromBEEF(Pt(t,"hex"),i)}addInput(t){if(typeof t.sourceTXID>"u"&&typeof t.sourceTransaction>"u")throw new Error("A reference to an an input transaction is required. If the input transaction itself cannot be referenced, its TXID must still be provided.");typeof t.sequence>"u"&&(t.sequence=4294967295),this.cachedHash=void 0,this.inputs.push(t)}addOutput(t){if(this.cachedHash=void 0,t.change!==!0){if(typeof t.satoshis>"u")throw new Error("either satoshis must be defined or change must be set to true");if(t.satoshis<0)throw new Error("satoshis must be a positive integer or zero")}if(t.lockingScript==null)throw new Error("lockingScript must be defined");this.outputs.push(t)}addP2PKHOutput(t,i){const r=new cC().lock(t);if(typeof i>"u")return this.addOutput({lockingScript:r,change:!0});this.addOutput({lockingScript:r,satoshis:i})}updateMetadata(t){this.metadata={...this.metadata,...t}}async fee(t=new lC(1),i="equal"){if(this.cachedHash=void 0,typeof t=="number"){const o=t;t={computeFee:async()=>o}}const r=await t.computeFee(this),e=this.calculateChange(r);if(e<=0){this.outputs=this.outputs.filter(o=>o.change!==!0);return}this.distributeChange(e,i)}calculateChange(t){let i=0;for(const r of this.inputs){if(typeof r.sourceTransaction!="object")throw new Error("Source transactions are required for all inputs during fee computation");i+=r.sourceTransaction.outputs[r.sourceOutputIndex].satoshis??0}i-=t;for(const r of this.outputs)r.change!==!0&&r.satoshis!==void 0&&(i-=r.satoshis);return i}distributeChange(t,i){let r=0;const e=this.outputs.filter(o=>o.change);if(i==="random"?r=this.distributeRandomChange(t,e):i==="equal"&&(r=this.distributeEqualChange(t,e)),r<t){const o=this.outputs[this.outputs.length-1];o.satoshis!==void 0?o.satoshis+=t-r:o.satoshis=t-r}}distributeRandomChange(t,i){let r=0,e=t;const o=Array(i.length).fill(1);e-=i.length,r+=i.length;for(let a=0;a<i.length-1;a++){const l=this.benfordNumber(0,e);o[a]=o[a]+l,r+=l,e-=l}for(const a of this.outputs)a.change===!0&&(a.satoshis=o.shift());return r}distributeEqualChange(t,i){let r=0;const e=Math.floor(t/i.length);for(const o of i)r+=e,o.satoshis=e;return r}benfordNumber(t,i){const r=Math.floor(Math.random()*9)+1;return Math.floor(t+(i-t)*Math.log10(1+1/r)/Math.log10(10))}getFee(){let t=0;for(const r of this.inputs){if(typeof r.sourceTransaction!="object")throw new Error("Source transactions or sourceSatoshis are required for all inputs to calculate fee");t+=r.sourceTransaction.outputs[r.sourceOutputIndex].satoshis??0}let i=0;for(const r of this.outputs)i+=r.satoshis??0;return t-i}async sign(){this.cachedHash=void 0;for(const i of this.outputs)if(typeof i.satoshis>"u")throw i.change===!0?new Error("There are still change outputs with uncomputed amounts. Use the fee() method to compute the change amounts and transaction fees prior to signing."):new Error("One or more transaction outputs is missing an amount. Ensure all output amounts are provided before signing.");const t=await Promise.all(this.inputs.map(async(i,r)=>{var e,o;return typeof this.inputs[r].unlockingScriptTemplate=="object"?await((o=(e=this.inputs[r])==null?void 0:e.unlockingScriptTemplate)==null?void 0:o.sign(this,r)):await Promise.resolve(void 0)}));for(let i=0,r=this.inputs.length;i<r;i++)typeof this.inputs[i].unlockingScriptTemplate=="object"&&(this.inputs[i].unlockingScript=t[i])}async broadcast(t=pC()){return await t.broadcast(this)}toBinary(){const t=new le;t.writeUInt32LE(this.version),t.writeVarIntNum(this.inputs.length);for(const i of this.inputs){if(typeof i.sourceTXID>"u")if(i.sourceTransaction!=null)t.write(i.sourceTransaction.hash());else throw new Error("sourceTransaction is undefined");else t.writeReverse(Pt(i.sourceTXID,"hex"));if(t.writeUInt32LE(i.sourceOutputIndex),i.unlockingScript==null)throw new Error("unlockingScript is undefined");const r=i.unlockingScript.toBinary();t.writeVarIntNum(r.length),t.write(r),t.writeUInt32LE(i.sequence??0)}t.writeVarIntNum(this.outputs.length);for(const i of this.outputs){t.writeUInt64LE(i.satoshis??0);const r=i.lockingScript.toBinary();t.writeVarIntNum(r.length),t.write(r)}return t.writeUInt32LE(this.lockTime),t.toArray()}toEF(){const t=new le;t.writeUInt32LE(this.version),t.write([0,0,0,0,0,239]),t.writeVarIntNum(this.inputs.length);for(const i of this.inputs){if(typeof i.sourceTransaction>"u")throw new Error("All inputs must have source transactions when serializing to EF format");if(typeof i.sourceTXID>"u"?t.write(i.sourceTransaction.hash()):t.write(Pt(i.sourceTXID,"hex").reverse()),t.writeUInt32LE(i.sourceOutputIndex),i.unlockingScript==null)throw new Error("unlockingScript is undefined");const r=i.unlockingScript.toBinary();t.writeVarIntNum(r.length),t.write(r),t.writeUInt32LE(i.sequence??0),t.writeUInt64LE(i.sourceTransaction.outputs[i.sourceOutputIndex].satoshis??0);const e=i.sourceTransaction.outputs[i.sourceOutputIndex].lockingScript.toBinary();t.writeVarIntNum(e.length),t.write(e)}t.writeVarIntNum(this.outputs.length);for(const i of this.outputs){t.writeUInt64LE(i.satoshis??0);const r=i.lockingScript.toBinary();t.writeVarIntNum(r.length),t.write(r)}return t.writeUInt32LE(this.lockTime),t.toArray()}toHexEF(){return Zt(this.toEF())}toHex(){return Zt(this.toBinary())}toHexBEEF(){return Zt(this.toBEEF())}toHexAtomicBEEF(){return Zt(this.toAtomicBEEF())}hash(t){let i;return this.cachedHash!=null?i=this.cachedHash:(i=jn(this.toBinary()),this.cachedHash=i),t==="hex"?Zt(i):i}id(t){const i=[...this.hash()];return i.reverse(),t==="hex"?Zt(i):i}async verify(t=gC(),i,r){const e=new Set,o=[this];for(;o.length>0;){const a=o.shift(),l=(a==null?void 0:a.id("hex"))??"";if(l!=null&&l!==""&&e.has(l))continue;if(typeof(a==null?void 0:a.merklePath)=="object"){if(t==="scripts only"){l!=null&&e.add(l);continue}else if(await a.merklePath.verify(l,t)){e.add(l);continue}}if(typeof i<"u"){if(a===void 0)throw new Error("Transaction is undefined");const c=sr.fromEF(a.toEF());if(delete c.outputs[0].satoshis,c.outputs[0].change=!0,await c.fee(i),a.getFee()<c.getFee())throw new Error(`Verification failed because the transaction ${l} has an insufficient fee and has not been mined.`)}let f=0;if(a===void 0)throw new Error("Transaction is undefined");for(let c=0;c<a.inputs.length;c++){const d=a.inputs[c];if(typeof d.sourceTransaction!="object")throw new Error(`Verification failed because the input at index ${c} of transaction ${l} is missing an associated source transaction. This source transaction is required for transaction verification because there is no merkle proof for the transaction spending a UTXO it contains.`);if(typeof d.unlockingScript!="object")throw new Error(`Verification failed because the input at index ${c} of transaction ${l} is missing an associated unlocking script. This script is required for transaction verification because there is no merkle proof for the transaction spending the UTXO.`);const y=d.sourceTransaction.outputs[d.sourceOutputIndex];f+=y.satoshis??0;const p=d.sourceTransaction.id("hex");e.has(p)||o.push(d.sourceTransaction);const g=a.inputs.filter((v,_)=>_!==c);if(typeof d.sourceTXID>"u"&&(d.sourceTXID=p),!new oC({sourceTXID:d.sourceTXID,sourceOutputIndex:d.sourceOutputIndex,lockingScript:y.lockingScript,sourceSatoshis:y.satoshis??0,transactionVersion:a.version,otherInputs:g,unlockingScript:d.unlockingScript,inputSequence:d.sequence??0,inputIndex:c,outputs:a.outputs,lockTime:a.lockTime,memoryLimit:r}).validate())return!1}let n=0;for(const c of a.outputs){if(typeof c.satoshis!="number")throw new Error("Every output must have a defined amount during transaction verification.");n+=c.satoshis}if(n>f)return!1;e.add(l)}return!0}toBEEF(t){const i=new le;i.writeUInt32LE(gb);const r=[],e=[],o=a=>{const l={tx:a},f=typeof a.merklePath=="object";if(f){let c=!1;for(let d=0;d<r.length;d++){if(r[d]===a.merklePath){l.pathIndex=d,c=!0;break}if(a.merklePath!==null&&a.merklePath!==void 0&&r[d].blockHeight===a.merklePath.blockHeight){const y=r[d].computeRoot(),p=a.merklePath.computeRoot();if(y===p){r[d].combine(a.merklePath),l.pathIndex=d,c=!0;break}}}c||(l.pathIndex=r.length,a.merklePath!==null&&a.merklePath!==void 0&&r.push(a.merklePath))}if(e.some(c=>c.tx.id("hex")===a.id("hex"))||e.unshift(l),!f)for(let c=0;c<a.inputs.length;c++){const d=a.inputs[c];if(typeof d.sourceTransaction=="object")o(d.sourceTransaction);else if(t===!1)throw new Error("A required source transaction is missing!")}};o(this),i.writeVarIntNum(r.length);for(const a of r)i.write(a.toBinary());i.writeVarIntNum(e.length);for(const a of e)i.write(a.tx.toBinary()),typeof a.pathIndex=="number"?(i.writeUInt8(1),i.writeVarIntNum(a.pathIndex)):i.writeUInt8(0);return i.toArray()}toAtomicBEEF(t){const i=new le;i.writeUInt32LE(16843009),i.write(this.hash());const r=this.toBEEF(t);return i.write(r),i.toArray()}};var mb;(function(s){s[s.Silent=0]="Silent",s[s.App=1]="App",s[s.Counterparty=2]="Counterparty"})(mb||(mb={}));let VT=class{constructor(t){rt(this,"rootKey");rt(this,"identityKey");t==="anyone"?this.rootKey=new Or(1):this.rootKey=t,this.identityKey=this.rootKey.toPublicKey().toString()}derivePublicKey(t,i,r,e=!1){return r=this.normalizeCounterparty(r),e?this.rootKey.deriveChild(r,this.computeInvoiceNumber(t,i)).toPublicKey():r.deriveChild(this.rootKey,this.computeInvoiceNumber(t,i))}derivePrivateKey(t,i,r){return r=this.normalizeCounterparty(r),this.rootKey.deriveChild(r,this.computeInvoiceNumber(t,i))}deriveSymmetricKey(t,i,r){var a,l;r==="anyone"&&(r=new Or(1).toPublicKey()),r=this.normalizeCounterparty(r);const e=this.derivePublicKey(t,i,r),o=this.derivePrivateKey(t,i,r);return new aC(((l=(a=o.deriveSharedSecret(e))==null?void 0:a.x)==null?void 0:l.toArray())??[])}revealCounterpartySecret(t){if(t==="self")throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");t=this.normalizeCounterparty(t);const i=this.rootKey.toPublicKey(),r=this.rootKey.deriveChild(i,"test").toHex(),e=this.rootKey.deriveChild(t,"test").toHex();if(r===e)throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");return this.rootKey.deriveSharedSecret(t).encode(!0)}revealSpecificSecret(t,i,r){t=this.normalizeCounterparty(t);const e=this.rootKey.deriveSharedSecret(t),o=Pt(this.computeInvoiceNumber(i,r),"utf8");return rf(e.encode(!0),o)}normalizeCounterparty(t){if(t==null)throw new Error("counterparty must be self, anyone or a public key!");return t==="self"?this.rootKey.toPublicKey():t==="anyone"?new Or(1).toPublicKey():typeof t=="string"?Io.fromString(t):t}computeInvoiceNumber(t,i){const r=t[0];if(!Number.isInteger(r)||r<0||r>2)throw new Error("Protocol security level must be 0, 1, or 2");const e=t[1].toLowerCase().trim();if(i.length>800)throw new Error("Key IDs must be 800 characters or less");if(i.length<1)throw new Error("Key IDs must be 1 character or more");if(e.length>400)if(e.startsWith("specific linkage revelation ")){if(e.length>430)throw new Error("Specific linkage revelation protocol names must be 430 characters or less")}else throw new Error("Protocol names must be 400 characters or less");if(e.length<5)throw new Error("Protocol names must be 5 characters or more");if(e.includes("  "))throw new Error('Protocol names cannot contain multiple consecutive spaces ("  ")');if(!/^[a-z0-9 ]+$/g.test(e))throw new Error("Protocol names can only contain letters, numbers and spaces");if(e.endsWith(" protocol"))throw new Error('No need to end your protocol name with " protocol"');return`${r}-${e}-${i}`}},WT=class{constructor(t){rt(this,"keyDeriver");typeof t.identityKey!="string"&&(t=new VT(t)),this.keyDeriver=t}async getPublicKey(t){if(t.identityKey){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(t.protocolID==null||t.keyID==null||t.keyID==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");return{publicKey:(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(t.protocolID,t.keyID,t.counterparty??"self",t.forSelf).toString()}}}async revealCounterpartyKeyLinkage(t){const{publicKey:i}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const r=this.keyDeriver.revealCounterpartySecret(t.counterparty),e=new sC().generateProof(this.keyDeriver.rootKey,this.keyDeriver.rootKey.toPublicKey(),Io.fromString(t.counterparty),xa.fromDER(r)),o=[...e.R.encode(!0),...e.SPrime.encode(!0),...e.z.toArray()],a=new Date().toISOString(),{ciphertext:l}=await this.encrypt({plaintext:r,protocolID:[2,"counterparty linkage revelation"],keyID:a,counterparty:t.verifier}),{ciphertext:f}=await this.encrypt({plaintext:o,protocolID:[2,"counterparty linkage revelation"],keyID:a,counterparty:t.verifier});return{prover:i,verifier:t.verifier,counterparty:t.counterparty,revelationTime:a,encryptedLinkage:l,encryptedLinkageProof:f}}async revealSpecificKeyLinkage(t){const{publicKey:i}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const r=this.keyDeriver.revealSpecificSecret(t.counterparty,t.protocolID,t.keyID),{ciphertext:e}=await this.encrypt({plaintext:r,protocolID:[2,`specific linkage revelation ${t.protocolID[0]} ${t.protocolID[1]}`],keyID:t.keyID,counterparty:t.verifier}),{ciphertext:o}=await this.encrypt({plaintext:[0],protocolID:[2,`specific linkage revelation ${t.protocolID[0]} ${t.protocolID[1]}`],keyID:t.keyID,counterparty:t.verifier});return{prover:i,verifier:t.verifier,counterparty:t.counterparty,protocolID:t.protocolID,keyID:t.keyID,encryptedLinkage:e,encryptedLinkageProof:o,proofType:0}}async encrypt(t){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{ciphertext:this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,t.counterparty??"self").encrypt(t.plaintext)}}async decrypt(t){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{plaintext:this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,t.counterparty??"self").decrypt(t.ciphertext)}}async createHmac(t){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const i=this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,t.counterparty??"self");return{hmac:rf(i.toArray(),t.data)}}async verifyHmac(t){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const i=this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,t.counterparty??"self"),r=rf(i.toArray(),t.data).toString()===t.hmac.toString();if(!r){const e=new Error("HMAC is not valid");throw e.code="ERR_INVALID_HMAC",e}return{valid:r}}async createSignature(t){if(t.hashToDirectlySign==null&&t.data==null)throw new Error("args.data or args.hashToDirectlySign must be valid");const i=t.hashToDirectlySign??Vn(t.data??[]),e=(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePrivateKey(t.protocolID,t.keyID,t.counterparty??"anyone");return{signature:qT(new ot(i),e,!0).toDER()}}async verifySignature(t){if(t.hashToDirectlyVerify==null&&t.data==null)throw new Error("args.data or args.hashToDirectlyVerify must be valid");const i=t.hashToDirectlyVerify??Vn(t.data??[]),e=(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(t.protocolID,t.keyID,t.counterparty??"self",t.forSelf),o=yf(new ot(i),ls.fromDER(t.signature),e);if(!o){const a=new Error("Signature is not valid");throw a.code="ERR_INVALID_SIGNATURE",a}return{valid:o}}};class R_{constructor(){rt(this,"CWI");if(typeof window!="object")throw new Error("The window.CWI substrate requires a global window object.");if(typeof window.CWI!="object")throw new Error("The window.CWI interface does not appear to be bound to the window object.");this.CWI=window.CWI}async createAction(t,i){return await this.CWI.createAction(t,i)}async signAction(t,i){return await this.CWI.signAction(t,i)}async abortAction(t,i){return await this.CWI.abortAction(t,i)}async listActions(t,i){return await this.CWI.listActions(t,i)}async internalizeAction(t,i){return await this.CWI.internalizeAction(t,i)}async listOutputs(t,i){return await this.CWI.listOutputs(t,i)}async relinquishOutput(t,i){return await this.CWI.relinquishOutput(t,i)}async getPublicKey(t,i){return await this.CWI.getPublicKey(t,i)}async revealCounterpartyKeyLinkage(t,i){return await this.CWI.revealCounterpartyKeyLinkage(t,i)}async revealSpecificKeyLinkage(t,i){return await this.CWI.revealSpecificKeyLinkage(t,i)}async encrypt(t,i){return await this.CWI.encrypt(t,i)}async decrypt(t,i){return await this.CWI.decrypt(t,i)}async createHmac(t,i){return await this.CWI.createHmac(t,i)}async verifyHmac(t,i){return await this.CWI.verifyHmac(t,i)}async createSignature(t,i){return await this.CWI.createSignature(t,i)}async verifySignature(t,i){return await this.CWI.verifySignature(t,i)}async acquireCertificate(t,i){return await this.CWI.acquireCertificate(t,i)}async listCertificates(t,i){return await this.CWI.listCertificates(t,i)}async proveCertificate(t,i){return await this.CWI.proveCertificate(t,i)}async relinquishCertificate(t,i){return await this.CWI.relinquishCertificate(t,i)}async discoverByIdentityKey(t,i){return await this.CWI.discoverByIdentityKey(t,i)}async discoverByAttributes(t,i){return await this.CWI.discoverByAttributes(t,i)}async isAuthenticated(t,i){return await this.CWI.isAuthenticated(t,i)}async waitForAuthentication(t,i){return await this.CWI.waitForAuthentication(t,i)}async getHeight(t,i){return await this.CWI.getHeight(t,i)}async getHeaderForHeight(t,i){return await this.CWI.getHeaderForHeight(t,i)}async getNetwork(t,i){return await this.CWI.getNetwork(t,i)}async getVersion(t,i){return await this.CWI.getVersion(t,i)}}let $T=class extends Error{constructor(i,r=1,e){super(i);rt(this,"code");rt(this,"isError",!0);this.code=r,this.name=this.constructor.name,e!=null&&e!==""?this.stack=e:Error.captureStackTrace(this,this.constructor)}};var M_;(function(s){s[s.unknownError=1]="unknownError",s[s.unsupportedAction=2]="unsupportedAction",s[s.invalidHmac=3]="invalidHmac",s[s.invalidSignature=4]="invalidSignature",s[s.reviewActions=5]="reviewActions"})(M_||(M_={}));class N_{constructor(t="*"){rt(this,"domain");if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(typeof window.postMessage!="function")throw new Error("The window object does not seem to support postMessage calls.");this.domain=t}async invoke(t,i){return await new Promise((r,e)=>{const o=us(ds(12)),a=l=>{if(!(l.data.type!=="CWI"||!l.isTrusted||l.data.id!==o||l.data.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",a),l.data.status==="error"){const f=new $T(l.data.description,l.data.code);e(f)}else r(l.data.result)};window.addEventListener("message",a),window.parent.postMessage({type:"CWI",isInvocation:!0,id:o,call:t,args:i},this.domain)})}async createAction(t){return await this.invoke("createAction",t)}async signAction(t){return await this.invoke("signAction",t)}async abortAction(t){return await this.invoke("abortAction",t)}async listActions(t){return await this.invoke("listActions",t)}async internalizeAction(t){return await this.invoke("internalizeAction",t)}async listOutputs(t){return await this.invoke("listOutputs",t)}async relinquishOutput(t){return await this.invoke("relinquishOutput",t)}async getPublicKey(t){return await this.invoke("getPublicKey",t)}async revealCounterpartyKeyLinkage(t){return await this.invoke("revealCounterpartyKeyLinkage",t)}async revealSpecificKeyLinkage(t){return await this.invoke("revealSpecificKeyLinkage",t)}async encrypt(t){return await this.invoke("encrypt",t)}async decrypt(t){return await this.invoke("decrypt",t)}async createHmac(t){return await this.invoke("createHmac",t)}async verifyHmac(t){return await this.invoke("verifyHmac",t)}async createSignature(t){return await this.invoke("createSignature",t)}async verifySignature(t){return await this.invoke("verifySignature",t)}async acquireCertificate(t){return await this.invoke("acquireCertificate",t)}async listCertificates(t){return await this.invoke("listCertificates",t)}async proveCertificate(t){return await this.invoke("proveCertificate",t)}async relinquishCertificate(t){return await this.invoke("relinquishCertificate",t)}async discoverByIdentityKey(t){return await this.invoke("discoverByIdentityKey",t)}async discoverByAttributes(t){return await this.invoke("discoverByAttributes",t)}async isAuthenticated(t){return await this.invoke("isAuthenticated",t)}async waitForAuthentication(t){return await this.invoke("waitForAuthentication",t)}async getHeight(t){return await this.invoke("getHeight",t)}async getHeaderForHeight(t){return await this.invoke("getHeaderForHeight",t)}async getNetwork(t){return await this.invoke("getNetwork",t)}async getVersion(t){return await this.invoke("getVersion",t)}}let um=class zT{constructor(t,i,r,e,o,a,l){rt(this,"type");rt(this,"serialNumber");rt(this,"subject");rt(this,"certifier");rt(this,"revocationOutpoint");rt(this,"fields");rt(this,"signature");this.type=t,this.serialNumber=i,this.subject=r,this.certifier=e,this.revocationOutpoint=o,this.fields=a,this.signature=l}toBinary(t=!0){const i=new le,r=Pt(this.type,"base64");i.write(r);const e=Pt(this.serialNumber,"base64");i.write(e);const o=Pt(this.subject,"hex");i.write(o);const a=Pt(this.certifier,"hex");i.write(a);const[l,f]=this.revocationOutpoint.split("."),n=Pt(l,"hex");i.write(n),i.writeVarIntNum(Number(f));const c=Object.keys(this.fields).sort();i.writeVarIntNum(c.length);for(const d of c){const y=this.fields[d],p=Pt(d,"utf8");i.writeVarIntNum(p.length),i.write(p);const g=Pt(y,"utf8");i.writeVarIntNum(g.length),i.write(g)}if(t&&(this.signature??"").length>0){const d=Pt(this.signature,"hex");i.write(d)}return i.toArray()}static fromBinary(t){const i=new hi(t),r=i.read(32),e=us(r),o=i.read(32),a=us(o),l=i.read(33),f=Zt(l),n=i.read(33),c=Zt(n),d=i.read(32),y=Zt(d),p=i.readVarIntNum(),g=`${y}.${p}`,b=i.readVarIntNum(),w={};for(let _=0;_<b;_++){const S=i.readVarIntNum(),T=i.read(S),I=Ve(T),k=i.readVarIntNum(),O=i.read(k),A=Ve(O);w[I]=A}let v;if(!i.eof()){const _=i.read();v=ls.fromDER(_).toString("hex")}return new zT(e,a,f,c,g,w,v)}async verify(){const t=new WT("anyone"),i=this.toBinary(!1),r=this.signature??"",{valid:e}=await t.verifySignature({signature:Pt(r,"hex"),data:i,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`,counterparty:this.certifier});return e}async sign(t){if(this.signature!=null&&this.signature.length>0)throw new Error(`Certificate has already been signed! Signature present: ${this.signature}`);this.certifier=(await t.getPublicKey({identityKey:!0})).publicKey;const i=this.toBinary(!1),{signature:r}=await t.createSignature({data:i,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`});this.signature=Zt(r)}static getCertificateFieldEncryptionDetails(t,i){return{protocolID:[2,"certificate field encryption"],keyID:i?`${i} ${t}`:t}}};var bb;(function(s){s[s.createAction=1]="createAction",s[s.signAction=2]="signAction",s[s.abortAction=3]="abortAction",s[s.listActions=4]="listActions",s[s.internalizeAction=5]="internalizeAction",s[s.listOutputs=6]="listOutputs",s[s.relinquishOutput=7]="relinquishOutput",s[s.getPublicKey=8]="getPublicKey",s[s.revealCounterpartyKeyLinkage=9]="revealCounterpartyKeyLinkage",s[s.revealSpecificKeyLinkage=10]="revealSpecificKeyLinkage",s[s.encrypt=11]="encrypt",s[s.decrypt=12]="decrypt",s[s.createHmac=13]="createHmac",s[s.verifyHmac=14]="verifyHmac",s[s.createSignature=15]="createSignature",s[s.verifySignature=16]="verifySignature",s[s.acquireCertificate=17]="acquireCertificate",s[s.listCertificates=18]="listCertificates",s[s.proveCertificate=19]="proveCertificate",s[s.relinquishCertificate=20]="relinquishCertificate",s[s.discoverByIdentityKey=21]="discoverByIdentityKey",s[s.discoverByAttributes=22]="discoverByAttributes",s[s.isAuthenticated=23]="isAuthenticated",s[s.waitForAuthentication=24]="waitForAuthentication",s[s.getHeight=25]="getHeight",s[s.getHeaderForHeight=26]="getHeaderForHeight",s[s.getNetwork=27]="getNetwork",s[s.getVersion=28]="getVersion"})(bb||(bb={}));const XT=bb;let C_=class{constructor(t){rt(this,"wire");this.wire=t}async transmit(t,i="",r=[]){const e=new le;e.writeUInt8(XT[t]);const o=Pt(i,"utf8");e.writeUInt8(o.length),e.write(o),r.length>0&&e.write(r);const a=e.toArray(),l=await this.wire.transmitToWallet(a),f=new hi(l),n=f.readUInt8();if(n===0)return f.read();{const c=f.readVarIntNum(),d=f.read(c),y=Ve(d),p=f.readVarIntNum(),g=f.read(p),b=Ve(g);throw new $T(y,n,b)}}async createAction(t,i){const r=new le,e=Pt(t.description,"utf8");if(r.writeVarIntNum(e.length),r.write(e),t.inputBEEF!=null?(r.writeVarIntNum(t.inputBEEF.length),r.write(t.inputBEEF)):r.writeVarIntNum(-1),t.inputs!=null){r.writeVarIntNum(t.inputs.length);for(const p of t.inputs){if(r.write(this.encodeOutpoint(p.outpoint)),p.unlockingScript!=null&&p.unlockingScript!==""){const b=Pt(p.unlockingScript,"hex");r.writeVarIntNum(b.length),r.write(b)}else r.writeVarIntNum(-1),r.writeVarIntNum(p.unlockingScriptLength??0);const g=Pt(p.inputDescription,"utf8");r.writeVarIntNum(g.length),r.write(g),typeof p.sequenceNumber=="number"?r.writeVarIntNum(p.sequenceNumber):r.writeVarIntNum(-1)}}else r.writeVarIntNum(-1);if(t.outputs!=null){r.writeVarIntNum(t.outputs.length);for(const p of t.outputs){const g=Pt(p.lockingScript,"hex");r.writeVarIntNum(g.length),r.write(g),r.writeVarIntNum(p.satoshis);const b=Pt(p.outputDescription,"utf8");if(r.writeVarIntNum(b.length),r.write(b),p.basket!=null&&p.basket!==""){const w=Pt(p.basket,"utf8");r.writeVarIntNum(w.length),r.write(w)}else r.writeVarIntNum(-1);if(p.customInstructions!=null&&p.customInstructions!==""){const w=Pt(p.customInstructions,"utf8");r.writeVarIntNum(w.length),r.write(w)}else r.writeVarIntNum(-1);if(p.tags!=null){r.writeVarIntNum(p.tags.length);for(const w of p.tags){const v=Pt(w,"utf8");r.writeVarIntNum(v.length),r.write(v)}}else r.writeVarIntNum(-1)}}else r.writeVarIntNum(-1);if(typeof t.lockTime=="number"?r.writeVarIntNum(t.lockTime):r.writeVarIntNum(-1),typeof t.version=="number"?r.writeVarIntNum(t.version):r.writeVarIntNum(-1),t.labels!=null){r.writeVarIntNum(t.labels.length);for(const p of t.labels){const g=Pt(p,"utf8");r.writeVarIntNum(g.length),r.write(g)}}else r.writeVarIntNum(-1);if(t.options!=null){if(r.writeInt8(1),typeof t.options.signAndProcess=="boolean"?r.writeInt8(t.options.signAndProcess?1:0):r.writeInt8(-1),typeof t.options.acceptDelayedBroadcast=="boolean"?r.writeInt8(t.options.acceptDelayedBroadcast?1:0):r.writeInt8(-1),t.options.trustSelf==="known"?r.writeInt8(1):r.writeInt8(-1),t.options.knownTxids!=null){r.writeVarIntNum(t.options.knownTxids.length);for(const p of t.options.knownTxids){const g=Pt(p,"hex");r.write(g)}}else r.writeVarIntNum(-1);if(typeof t.options.returnTXIDOnly=="boolean"?r.writeInt8(t.options.returnTXIDOnly?1:0):r.writeInt8(-1),typeof t.options.noSend=="boolean"?r.writeInt8(t.options.noSend?1:0):r.writeInt8(-1),t.options.noSendChange!=null){r.writeVarIntNum(t.options.noSendChange.length);for(const p of t.options.noSendChange)r.write(this.encodeOutpoint(p))}else r.writeVarIntNum(-1);if(t.options.sendWith!=null){r.writeVarIntNum(t.options.sendWith.length);for(const p of t.options.sendWith){const g=Pt(p,"hex");r.write(g)}}else r.writeVarIntNum(-1);typeof t.options.randomizeOutputs=="boolean"?r.writeInt8(t.options.randomizeOutputs?1:0):r.writeInt8(-1)}else r.writeInt8(0);const o=await this.transmit("createAction",i,r.toArray()),a=new hi(o),l={};if(a.readInt8()===1){const p=a.read(32);l.txid=Zt(p)}if(a.readInt8()===1){const p=a.readVarIntNum();l.tx=a.read(p)}const c=a.readVarIntNum();if(c>=0){l.noSendChange=[];for(let p=0;p<c;p++){const g=this.readOutpoint(a);l.noSendChange.push(g)}}const d=a.readVarIntNum();if(d>=0){l.sendWithResults=[];for(let p=0;p<d;p++){const g=a.read(32),b=Zt(g),w=a.readInt8();let v="unproven";w===1?v="unproven":w===2?v="sending":w===3&&(v="failed"),l.sendWithResults.push({txid:b,status:v})}}if(a.readInt8()===1){const p=a.readVarIntNum(),g=a.read(p),b=a.readVarIntNum(),w=a.read(b);l.signableTransaction={tx:g,reference:us(w)}}return l}async signAction(t,i){const r=new le,e=Object.keys(t.spends);r.writeVarIntNum(e.length);for(const y of e){r.writeVarIntNum(Number(y));const p=t.spends[Number(y)],g=Pt(p.unlockingScript,"hex");r.writeVarIntNum(g.length),r.write(g),typeof p.sequenceNumber=="number"?r.writeVarIntNum(p.sequenceNumber):r.writeVarIntNum(-1)}const o=Pt(t.reference,"base64");if(r.writeVarIntNum(o.length),r.write(o),t.options!=null)if(r.writeInt8(1),typeof t.options.acceptDelayedBroadcast=="boolean"?r.writeInt8(t.options.acceptDelayedBroadcast?1:0):r.writeInt8(-1),typeof t.options.returnTXIDOnly=="boolean"?r.writeInt8(t.options.returnTXIDOnly?1:0):r.writeInt8(-1),typeof t.options.noSend=="boolean"?r.writeInt8(t.options.noSend?1:0):r.writeInt8(-1),t.options.sendWith!=null){r.writeVarIntNum(t.options.sendWith.length);for(const y of t.options.sendWith){const p=Pt(y,"hex");r.write(p)}}else r.writeVarIntNum(-1);else r.writeInt8(0);const a=await this.transmit("signAction",i,r.toArray()),l=new hi(a),f={};if(l.readInt8()===1){const y=l.read(32);f.txid=Zt(y)}if(l.readInt8()===1){const y=l.readVarIntNum();f.tx=l.read(y)}const d=l.readVarIntNum();if(d>=0){f.sendWithResults=[];for(let y=0;y<d;y++){const p=l.read(32),g=Zt(p),b=l.readInt8();let w="unproven";b===1?w="unproven":b===2?w="sending":b===3&&(w="failed"),f.sendWithResults.push({txid:g,status:w})}}return f}async abortAction(t,i){return await this.transmit("abortAction",i,Pt(t.reference,"base64")),{aborted:!0}}async listActions(t,i){const r=new le;r.writeVarIntNum(t.labels.length);for(const n of t.labels){const c=Pt(n,"utf8");r.writeVarIntNum(c.length),r.write(c)}t.labelQueryMode==="any"?r.writeInt8(1):t.labelQueryMode==="all"?r.writeInt8(2):r.writeInt8(-1);const e=[t.includeLabels,t.includeInputs,t.includeInputSourceLockingScripts,t.includeInputUnlockingScripts,t.includeOutputs,t.includeOutputLockingScripts];for(const n of e)typeof n=="boolean"?r.writeInt8(n?1:0):r.writeInt8(-1);typeof t.limit=="number"?r.writeVarIntNum(t.limit):r.writeVarIntNum(-1),typeof t.offset=="number"?r.writeVarIntNum(t.offset):r.writeVarIntNum(-1),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1);const o=await this.transmit("listActions",i,r.toArray()),a=new hi(o),l=a.readVarIntNum(),f=[];for(let n=0;n<l;n++){const c=a.read(32),d=Zt(c),y=a.readVarIntNum(),p=a.readInt8();let g;switch(p){case 1:g="completed";break;case 2:g="unprocessed";break;case 3:g="sending";break;case 4:g="unproven";break;case 5:g="unsigned";break;case 6:g="nosend";break;case 7:g="nonfinal";break;case 8:g="failed";break;default:throw new Error(`Unknown status code: ${p}`)}const b=a.readInt8()===1,w=a.readVarIntNum(),v=a.read(w),_=Ve(v),S={txid:d,satoshis:y,status:g,isOutgoing:b,description:_,version:0,lockTime:0},T=a.readVarIntNum();if(T>=0){S.labels=[];for(let O=0;O<T;O++){const A=a.readVarIntNum(),R=a.read(A);S.labels.push(Ve(R))}}S.version=a.readVarIntNum(),S.lockTime=a.readVarIntNum();const I=a.readVarIntNum();if(I>=0){S.inputs=[];for(let O=0;O<I;O++){const A=this.readOutpoint(a),R=a.readVarIntNum(),P=a.readVarIntNum();let C;if(P>=0){const V=a.read(P);C=Zt(V)}const N=a.readVarIntNum();let D;if(N>=0){const V=a.read(N);D=Zt(V)}const U=a.readVarIntNum(),F=a.read(U),L=Ve(F),j=a.readVarIntNum();S.inputs.push({sourceOutpoint:A,sourceSatoshis:R,sourceLockingScript:C,unlockingScript:D,inputDescription:L,sequenceNumber:j})}}const k=a.readVarIntNum();if(k>=0){S.outputs=[];for(let O=0;O<k;O++){const A=a.readVarIntNum(),R=a.readVarIntNum(),P=a.readVarIntNum();let C;if(P>=0){const Y=a.read(P);C=Zt(Y)}const N=a.readInt8()===1,D=a.readVarIntNum(),U=a.read(D),F=Ve(U),L=a.readVarIntNum();let j;if(L>=0){const Y=a.read(L);j=Ve(Y)}const V=a.readVarIntNum(),W=[];if(V>=0)for(let Y=0;Y<V;Y++){const Q=a.readVarIntNum(),J=a.read(Q);W.push(Ve(J))}const q=a.readVarIntNum();let $;if(q>=0){const Y=a.read(q);$=Ve(Y)}S.outputs.push({outputIndex:A,satoshis:R,lockingScript:C,spendable:N,outputDescription:F,basket:j,tags:W,customInstructions:$})}}f.push(S)}return{totalActions:l,actions:f}}async internalizeAction(t,i){var o,a,l;const r=new le;r.writeVarIntNum(t.tx.length),r.write(t.tx),r.writeVarIntNum(t.outputs.length);for(const f of t.outputs)if(r.writeVarIntNum(f.outputIndex),f.protocol==="wallet payment"){if(f.paymentRemittance==null)throw new Error("Payment remittance is required for wallet payment");r.writeUInt8(1),r.write(Pt(f.paymentRemittance.senderIdentityKey,"hex"));const n=Pt(f.paymentRemittance.derivationPrefix,"base64");r.writeVarIntNum(n.length),r.write(n);const c=Pt(f.paymentRemittance.derivationSuffix,"base64");r.writeVarIntNum(c.length),r.write(c)}else{r.writeUInt8(2);const n=Pt((o=f.insertionRemittance)==null?void 0:o.basket,"utf8");if(r.writeVarIntNum(n.length),r.write(n),typeof((a=f.insertionRemittance)==null?void 0:a.customInstructions)=="string"&&f.insertionRemittance.customInstructions!==""){const c=Pt(f.insertionRemittance.customInstructions,"utf8");r.writeVarIntNum(c.length),r.write(c)}else r.writeVarIntNum(-1);if(typeof((l=f.insertionRemittance)==null?void 0:l.tags)=="object"){r.writeVarIntNum(f.insertionRemittance.tags.length);for(const c of f.insertionRemittance.tags){const d=Pt(c,"utf8");r.writeVarIntNum(d.length),r.write(d)}}else r.writeVarIntNum(0)}if(typeof t.labels=="object"){r.writeVarIntNum(t.labels.length);for(const f of t.labels){const n=Pt(f,"utf8");r.writeVarIntNum(n.length),r.write(n)}}else r.writeVarIntNum(-1);const e=Pt(t.description);return r.writeVarIntNum(e.length),r.write(e),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),await this.transmit("internalizeAction",i,r.toArray()),{accepted:!0}}async listOutputs(t,i){const r=new le,e=Pt(t.basket,"utf8");if(r.writeVarIntNum(e.length),r.write(e),typeof t.tags=="object"){r.writeVarIntNum(t.tags.length);for(const d of t.tags){const y=Pt(d,"utf8");r.writeVarIntNum(y.length),r.write(y)}}else r.writeVarIntNum(0);t.tagQueryMode==="all"?r.writeInt8(1):t.tagQueryMode==="any"?r.writeInt8(2):r.writeInt8(-1),t.include==="locking scripts"?r.writeInt8(1):t.include==="entire transactions"?r.writeInt8(2):r.writeInt8(-1),typeof t.includeCustomInstructions=="boolean"?r.writeInt8(t.includeCustomInstructions?1:0):r.writeInt8(-1),typeof t.includeTags=="boolean"?r.writeInt8(t.includeTags?1:0):r.writeInt8(-1),typeof t.includeLabels=="boolean"?r.writeInt8(t.includeLabels?1:0):r.writeInt8(-1),typeof t.limit=="number"?r.writeVarIntNum(t.limit):r.writeVarIntNum(-1),typeof t.offset=="number"?r.writeVarIntNum(t.offset):r.writeVarIntNum(-1),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1);const o=await this.transmit("listOutputs",i,r.toArray()),a=new hi(o),l=a.readVarIntNum(),f=a.readVarIntNum();let n;f>=0&&(n=a.read(f));const c=[];for(let d=0;d<l;d++){const y=this.readOutpoint(a),p=a.readVarIntNum(),g={spendable:!0,outpoint:y,satoshis:p},b=a.readVarIntNum();b>=0&&(g.lockingScript=Zt(a.read(b)));const w=a.readVarIntNum();w>=0&&(g.customInstructions=Ve(a.read(w)));const v=a.readVarIntNum();if(v!==-1){const S=[];for(let T=0;T<v;T++){const I=a.readVarIntNum();S.push(Ve(a.read(I)))}g.tags=S}const _=a.readVarIntNum();if(_!==-1){const S=[];for(let T=0;T<_;T++){const I=a.readVarIntNum();S.push(Ve(a.read(I)))}g.labels=S}c.push(g)}return{totalOutputs:l,BEEF:n,outputs:c}}async relinquishOutput(t,i){const r=new le,e=Pt(t.basket,"utf8");return r.writeVarIntNum(e.length),r.write(e),r.write(this.encodeOutpoint(t.output)),await this.transmit("relinquishOutput",i,r.toArray()),{relinquished:!0}}encodeOutpoint(t){const i=new le,[r,e]=t.split(".");return i.write(Pt(r,"hex")),i.writeVarIntNum(Number(e)),i.toArray()}readOutpoint(t){const i=Zt(t.read(32)),r=t.readVarIntNum();return`${i}.${r}`}async getPublicKey(t,i){const r=new le;r.writeUInt8(t.identityKey?1:0),t.identityKey?r.write(this.encodePrivilegedParams(t.privileged,t.privilegedReason)):(r.write(this.encodeKeyRelatedParams(t.protocolID??(t.protocolID=[mb.Silent,"default"]),t.keyID??(t.keyID=""),t.counterparty,t.privileged,t.privilegedReason)),typeof t.forSelf=="boolean"?r.writeInt8(t.forSelf?1:0):r.writeInt8(-1)),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1);const e=await this.transmit("getPublicKey",i,r.toArray());return{publicKey:Zt(e)}}async revealCounterpartyKeyLinkage(t,i){const r=new le;r.write(this.encodePrivilegedParams(t.privileged,t.privilegedReason)),r.write(Pt(t.counterparty,"hex")),r.write(Pt(t.verifier,"hex"));const e=await this.transmit("revealCounterpartyKeyLinkage",i,r.toArray()),o=new hi(e),a=Zt(o.read(33)),l=Zt(o.read(33)),f=Zt(o.read(33)),n=o.readVarIntNum(),c=Ve(o.read(n)),d=o.readVarIntNum(),y=o.read(d),p=o.readVarIntNum(),g=o.read(p);return{prover:a,verifier:l,counterparty:f,revelationTime:c,encryptedLinkage:y,encryptedLinkageProof:g}}async revealSpecificKeyLinkage(t,i){const r=new le;r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),r.write(Pt(t.verifier,"hex"));const e=await this.transmit("revealSpecificKeyLinkage",i,r.toArray()),o=new hi(e),a=Zt(o.read(33)),l=Zt(o.read(33)),f=Zt(o.read(33)),n=o.readUInt8(),c=o.readVarIntNum(),d=Ve(o.read(c)),y=o.readVarIntNum(),p=Ve(o.read(y)),g=o.readVarIntNum(),b=o.read(g),w=o.readVarIntNum(),v=o.read(w),_=o.readUInt8();return{prover:a,verifier:l,counterparty:f,protocolID:[n,d],keyID:p,encryptedLinkage:b,encryptedLinkageProof:v,proofType:_}}async encrypt(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),r.writeVarIntNum(t.plaintext.length),r.write(t.plaintext),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),{ciphertext:await this.transmit("encrypt",i,r.toArray())}}async decrypt(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),r.writeVarIntNum(t.ciphertext.length),r.write(t.ciphertext),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),{plaintext:await this.transmit("decrypt",i,r.toArray())}}async createHmac(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),r.writeVarIntNum(t.data.length),r.write(t.data),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),{hmac:await this.transmit("createHmac",i,r.toArray())}}async verifyHmac(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),r.write(t.hmac),r.writeVarIntNum(t.data.length),r.write(t.data),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),await this.transmit("verifyHmac",i,r.toArray()),{valid:!0}}async createSignature(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),typeof t.data=="object"?(r.writeUInt8(1),r.writeVarIntNum(t.data.length),r.write(t.data)):(r.writeUInt8(2),r.write(t.hashToDirectlySign??(t.hashToDirectlySign=[]))),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),{signature:await this.transmit("createSignature",i,r.toArray())}}async verifySignature(t,i){const r=new le;return r.write(this.encodeKeyRelatedParams(t.protocolID,t.keyID,t.counterparty,t.privileged,t.privilegedReason)),typeof t.forSelf=="boolean"?r.writeInt8(t.forSelf?1:0):r.writeInt8(-1),r.writeVarIntNum(t.signature.length),r.write(t.signature),typeof t.data=="object"?(r.writeUInt8(1),r.writeVarIntNum(t.data.length),r.write(t.data)):(r.writeUInt8(2),r.write(t.hashToDirectlyVerify??[])),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1),await this.transmit("verifySignature",i,r.toArray()),{valid:!0}}encodeKeyRelatedParams(t,i,r,e,o){const a=new le;a.writeUInt8(t[0]);const l=Pt(t[1],"utf8");a.writeVarIntNum(l.length),a.write(l);const f=Pt(i,"utf8");return a.writeVarIntNum(f.length),a.write(f),typeof r!="string"?a.writeUInt8(0):r==="self"?a.writeUInt8(11):r==="anyone"?a.writeUInt8(12):a.write(Pt(r,"hex")),a.write(this.encodePrivilegedParams(e,o)),a.toArray()}async acquireCertificate(t,i){var l;const r=new le;r.write(Pt(t.type,"base64")),r.write(Pt(t.certifier,"hex"));const e=Object.entries(t.fields);r.writeVarIntNum(e.length);for(const[f,n]of e){const c=Pt(f,"utf8"),d=Pt(n,"utf8");r.writeVarIntNum(c.length),r.write(c),r.writeVarIntNum(d.length),r.write(d)}if(r.write(this.encodePrivilegedParams(t.privileged,t.privilegedReason)),r.writeUInt8(t.acquisitionProtocol==="direct"?1:2),t.acquisitionProtocol==="direct"){r.write(Pt(t.serialNumber,"base64")),r.write(this.encodeOutpoint(t.revocationOutpoint??""));const f=Pt(t.signature,"hex");r.writeVarIntNum(f.length),r.write(f);const n=t.keyringRevealer!=="certifier"?Pt(t.keyringRevealer,"hex"):[11];r.write(n);const c=Object.keys(t.keyringForSubject??{});r.writeVarIntNum(c.length);for(let d=0;d<c.length;d++){const y=Pt(c[d],"utf8");r.writeVarIntNum(y.length),r.write(y);const p=Pt((l=t.keyringForSubject)==null?void 0:l[c[d]],"base64");r.writeVarIntNum(p.length),r.write(p)}}else{const f=Pt(t.certifierUrl,"utf8");r.writeVarIntNum(f.length),r.write(f)}const o=await this.transmit("acquireCertificate",i,r.toArray()),a=um.fromBinary(o);return{...a,signature:a.signature}}encodePrivilegedParams(t,i){const r=new le;if(typeof t=="boolean"?r.writeInt8(t?1:0):r.writeInt8(-1),typeof i=="string"){const e=Pt(i,"utf8");r.writeInt8(e.length),r.write(e)}else r.writeInt8(-1);return r.toArray()}async listCertificates(t,i){const r=new le;r.writeVarIntNum(t.certifiers.length);for(let f=0;f<t.certifiers.length;f++)r.write(Pt(t.certifiers[f],"hex"));r.writeVarIntNum(t.types.length);for(let f=0;f<t.types.length;f++)r.write(Pt(t.types[f],"base64"));typeof t.limit=="number"?r.writeVarIntNum(t.limit):r.writeVarIntNum(-1),typeof t.offset=="number"?r.writeVarIntNum(t.offset):r.writeVarIntNum(-1),r.write(this.encodePrivilegedParams(t.privileged,t.privilegedReason));const e=await this.transmit("listCertificates",i,r.toArray()),o=new hi(e),a=o.readVarIntNum(),l=[];for(let f=0;f<a;f++){const n=o.readVarIntNum(),c=o.read(n),d=um.fromBinary(c);l.push({...d,signature:d.signature})}return{totalCertificates:a,certificates:l}}async proveCertificate(t,i){const r=new le,e=Pt(t.certificate.type,"base64");r.write(e);const o=Pt(t.certificate.subject,"hex");r.write(o);const a=Pt(t.certificate.serialNumber,"base64");r.write(a);const l=Pt(t.certificate.certifier,"hex");r.write(l);const f=this.encodeOutpoint(t.certificate.revocationOutpoint??"");r.write(f);const n=Pt(t.certificate.signature,"hex");r.writeVarIntNum(n.length),r.write(n);const c=Object.entries(t.certificate.fields??{});r.writeVarIntNum(c.length);for(const[b,w]of c){const v=Pt(b,"utf8"),_=Pt(w,"utf8");r.writeVarIntNum(v.length),r.write(v),r.writeVarIntNum(_.length),r.write(_)}r.writeVarIntNum(t.fieldsToReveal.length);for(const b of t.fieldsToReveal){const w=Pt(b,"utf8");r.writeVarIntNum(w.length),r.write(w)}r.write(Pt(t.verifier,"hex")),r.write(this.encodePrivilegedParams(t.privileged,t.privilegedReason));const d=await this.transmit("proveCertificate",i,r.toArray()),y=new hi(d),p=y.readVarIntNum(),g={};for(let b=0;b<p;b++){const w=y.readVarIntNum(),v=Ve(y.read(w)),_=y.readVarIntNum();g[v]=us(y.read(_))}return{keyringForVerifier:g}}async relinquishCertificate(t,i){const r=new le,e=Pt(t.type,"base64");r.write(e);const o=Pt(t.serialNumber,"base64");r.write(o);const a=Pt(t.certifier,"hex");return r.write(a),await this.transmit("relinquishCertificate",i,r.toArray()),{relinquished:!0}}parseDiscoveryResult(t){const i=new hi(t),r=i.readVarIntNum(),e=[];for(let o=0;o<r;o++){const a=i.readVarIntNum(),l=i.read(a),f=um.fromBinary(l),n=i.readVarIntNum(),c=Ve(i.read(n)),d=i.readVarIntNum(),y=Ve(i.read(d)),p=i.readVarIntNum(),g=Ve(i.read(p)),b=i.readUInt8(),w={},v=i.readVarIntNum();for(let T=0;T<v;T++){const I=i.readVarIntNum(),k=Ve(i.read(I)),O=i.readVarIntNum();w[k]=i.read(O)}const _={},S=i.readVarIntNum();for(let T=0;T<S;T++){const I=i.readVarIntNum(),k=Ve(i.read(I)),O=i.readVarIntNum();_[k]=Ve(i.read(O))}e.push({...f,signature:f.signature,certifierInfo:{iconUrl:y,name:c,description:g,trust:b},publiclyRevealedKeyring:w,decryptedFields:_})}return{totalCertificates:r,certificates:e}}async discoverByIdentityKey(t,i){const r=new le;r.write(Pt(t.identityKey,"hex")),typeof t.limit=="number"?r.writeVarIntNum(t.limit):r.writeVarIntNum(-1),typeof t.offset=="number"?r.writeVarIntNum(t.offset):r.writeVarIntNum(-1),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1);const e=await this.transmit("discoverByIdentityKey",i,r.toArray());return this.parseDiscoveryResult(e)}async discoverByAttributes(t,i){const r=new le,e=Object.keys(t.attributes);r.writeVarIntNum(e.length);for(let a=0;a<e.length;a++)r.writeVarIntNum(e[a].length),r.write(Pt(e[a],"utf8")),r.writeVarIntNum(t.attributes[e[a]].length),r.write(Pt(t.attributes[e[a]],"utf8"));typeof t.limit=="number"?r.writeVarIntNum(t.limit):r.writeVarIntNum(-1),typeof t.offset=="number"?r.writeVarIntNum(t.offset):r.writeVarIntNum(-1),r.writeInt8(typeof t.seekPermission=="boolean"?t.seekPermission?1:0:-1);const o=await this.transmit("discoverByAttributes",i,r.toArray());return this.parseDiscoveryResult(o)}async isAuthenticated(t,i){return{authenticated:(await this.transmit("isAuthenticated",i))[0]===1}}async waitForAuthentication(t,i){return await this.transmit("waitForAuthentication",i),{authenticated:!0}}async getHeight(t,i){const r=await this.transmit("getHeight",i);return{height:new hi(r).readVarIntNum()}}async getHeaderForHeight(t,i){const r=new le;r.writeVarIntNum(t.height);const e=await this.transmit("getHeaderForHeight",i,r.toArray());return{header:Zt(e)}}async getNetwork(t,i){return{network:(await this.transmit("getNetwork",i))[0]===0?"mainnet":"testnet"}}async getVersion(t,i){const r=await this.transmit("getVersion",i);return{version:Ve(r)}}},D_=class{constructor(t,i="http://localhost:3301",r=fetch){rt(this,"baseUrl");rt(this,"httpClient");rt(this,"originator");this.baseUrl=i,this.httpClient=r,this.originator=t}async transmitToWallet(t){const i=new hi(t),r=i.readUInt8(),e=XT[r];if(e===void 0||e==="")throw new Error(`Invalid call code: ${r}`);const o=i.readUInt8();let a;if(o>0){const c=i.read(o);a=Ve(c)}const l=i.read(),n=await(await fetch(`${this.baseUrl}/${e}`,{method:"POST",headers:{"Content-Type":"application/octet-stream",Origin:a??""},body:new Uint8Array(l)})).arrayBuffer();return Array.from(new Uint8Array(n))}},wC=class extends Error{constructor(i,r,e,o,a){super("Undelayed createAction or signAction results require review.");rt(this,"reviewActionResults");rt(this,"sendWithResults");rt(this,"txid");rt(this,"tx");rt(this,"noSendChange");rt(this,"code");rt(this,"isError",!0);this.reviewActionResults=i,this.sendWithResults=r,this.txid=e,this.tx=o,this.noSendChange=a,this.code=5,this.name=this.constructor.name}},B_=class{constructor(t,i="http://localhost:3321",r=fetch){rt(this,"baseUrl");rt(this,"httpClient");rt(this,"originator");rt(this,"api");this.baseUrl=i,this.originator=t,this.httpClient=r,this.api=async(e,o)=>{const a=await await r(`${this.baseUrl}/${e}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Originator:this.originator??""},body:JSON.stringify(o)}),l=await a.json();if(!a.ok){if(a.status===400&&l.isError&&l.code===5)throw new wC(l.reviewActionResults,l.sendWithResults,l.txid,l.tx,l.noSendChange);{const f={call:e,args:o,message:l.message??`HTTP Client error ${a.status}`};throw new Error(JSON.stringify(f))}}return l}}async createAction(t){return await this.api("createAction",t)}async signAction(t){return await this.api("signAction",t)}async abortAction(t){return await this.api("abortAction",t)}async listActions(t){return await this.api("listActions",t)}async internalizeAction(t){return await this.api("internalizeAction",t)}async listOutputs(t){return await this.api("listOutputs",t)}async relinquishOutput(t){return await this.api("relinquishOutput",t)}async getPublicKey(t){return await this.api("getPublicKey",t)}async revealCounterpartyKeyLinkage(t){return await this.api("revealCounterpartyKeyLinkage",t)}async revealSpecificKeyLinkage(t){return await this.api("revealSpecificKeyLinkage",t)}async encrypt(t){return await this.api("encrypt",t)}async decrypt(t){return await this.api("decrypt",t)}async createHmac(t){return await this.api("createHmac",t)}async verifyHmac(t){return await this.api("verifyHmac",t)}async createSignature(t){return await this.api("createSignature",t)}async verifySignature(t){return await this.api("verifySignature",t)}async acquireCertificate(t){return await this.api("acquireCertificate",t)}async listCertificates(t){return await this.api("listCertificates",t)}async proveCertificate(t){return await this.api("proveCertificate",t)}async relinquishCertificate(t){return await this.api("relinquishCertificate",t)}async discoverByIdentityKey(t){return await this.api("discoverByIdentityKey",t)}async discoverByAttributes(t){return await this.api("discoverByAttributes",t)}async isAuthenticated(t){return await this.api("isAuthenticated",t)}async waitForAuthentication(t){return await this.api("waitForAuthentication",t)}async getHeight(t){return await this.api("getHeight",t)}async getHeaderForHeight(t){return await this.api("getHeaderForHeight",t)}async getNetwork(t){return await this.api("getNetwork",t)}async getVersion(t){return await this.api("getVersion",t)}};const vC=200;let xC=class{constructor(t="auto",i){rt(this,"substrate");rt(this,"originator");t==="Cicada"&&(t=new C_(new D_(i))),t==="window.CWI"&&(t=new R_),t==="XDM"&&(t=new N_),t==="json-api"&&(t=new B_(i)),this.substrate=t,this.originator=i}async connectToSubstrate(){if(typeof this.substrate=="object")return;let t;const i=async r=>{let e;if(typeof r=="number"?e=await Promise.race([t.getVersion({}),new Promise((o,a)=>setTimeout(()=>a(new Error("Timed out.")),r))]):e=await t.getVersion({}),typeof e!="object"||typeof e.version!="string")throw new Error("Failed to use substrate.")};try{t=new R_,await i(),this.substrate=t}catch{try{t=new N_,await i(vC),this.substrate=t}catch{try{t=new C_(new D_(this.originator)),await i(),this.substrate=t}catch{try{t=new B_(this.originator),await i(),this.substrate=t}catch{throw new Error("No wallet available over any communication substrate. Install a BSV wallet today!")}}}}}async createAction(t){return await this.connectToSubstrate(),await this.substrate.createAction(t,this.originator)}async signAction(t){return await this.connectToSubstrate(),await this.substrate.signAction(t,this.originator)}async abortAction(t){return await this.connectToSubstrate(),await this.substrate.abortAction(t,this.originator)}async listActions(t){return await this.connectToSubstrate(),await this.substrate.listActions(t,this.originator)}async internalizeAction(t){return await this.connectToSubstrate(),await this.substrate.internalizeAction(t,this.originator)}async listOutputs(t){return await this.connectToSubstrate(),await this.substrate.listOutputs(t,this.originator)}async relinquishOutput(t){return await this.connectToSubstrate(),await this.substrate.relinquishOutput(t,this.originator)}async getPublicKey(t){return await this.connectToSubstrate(),await this.substrate.getPublicKey(t,this.originator)}async revealCounterpartyKeyLinkage(t){return await this.connectToSubstrate(),await this.substrate.revealCounterpartyKeyLinkage(t,this.originator)}async revealSpecificKeyLinkage(t){return await this.connectToSubstrate(),await this.substrate.revealSpecificKeyLinkage(t,this.originator)}async encrypt(t){return await this.connectToSubstrate(),await this.substrate.encrypt(t,this.originator)}async decrypt(t){return await this.substrate.decrypt(t,this.originator)}async createHmac(t){return await this.connectToSubstrate(),await this.substrate.createHmac(t,this.originator)}async verifyHmac(t){return await this.connectToSubstrate(),await this.substrate.verifyHmac(t,this.originator)}async createSignature(t){return await this.connectToSubstrate(),await this.substrate.createSignature(t,this.originator)}async verifySignature(t){return await this.connectToSubstrate(),await this.substrate.verifySignature(t,this.originator)}async acquireCertificate(t){return await this.connectToSubstrate(),await this.substrate.acquireCertificate(t,this.originator)}async listCertificates(t){return await this.connectToSubstrate(),await this.substrate.listCertificates(t,this.originator)}async proveCertificate(t){return await this.connectToSubstrate(),await this.substrate.proveCertificate(t,this.originator)}async relinquishCertificate(t){return await this.connectToSubstrate(),await this.substrate.relinquishCertificate(t,this.originator)}async discoverByIdentityKey(t){return await this.connectToSubstrate(),await this.substrate.discoverByIdentityKey(t,this.originator)}async discoverByAttributes(t){return await this.connectToSubstrate(),await this.substrate.discoverByAttributes(t,this.originator)}async isAuthenticated(t={}){return await this.connectToSubstrate(),await this.substrate.isAuthenticated(t,this.originator)}async waitForAuthentication(t={}){return await this.connectToSubstrate(),await this.substrate.waitForAuthentication(t,this.originator)}async getHeight(t={}){return await this.connectToSubstrate(),await this.substrate.getHeight(t,this.originator)}async getHeaderForHeight(t){return await this.connectToSubstrate(),await this.substrate.getHeaderForHeight(t,this.originator)}async getNetwork(t={}){return await this.connectToSubstrate(),await this.substrate.getNetwork(t,this.originator)}async getVersion(t={}){return await this.connectToSubstrate(),await this.substrate.getVersion(t,this.originator)}};typeof window<"u"&&fetch.bind(window);var Yn={},Ds={},_l={},F_;function GT(){if(F_)return _l;F_=1,Object.defineProperty(_l,"__esModule",{value:!0}),_l.WalletError=void 0;class s extends Error{constructor(i,r,e,o){super(r),this.details=o,this.isError=!0,this.name=i,e&&(this.stack=e)}get code(){return this.name}set code(i){this.name=i}get description(){return this.message}set description(i){this.message=i}static fromUnknown(i){let r="WERR_UNKNOWN",e="",o;const a={};i!==null&&typeof i=="object"&&(i.name==="Error"||i.name==="FetchError"?r=i.code||i.status||"WERR_UNKNOWN":r=i.name||i.code||i.status||"WERR_UNKNOWN",typeof r!="string"&&(r="WERR_UNKNOWN"),e=i.message||i.description||"",typeof e!="string"&&(e="WERR_UNKNOWN"),typeof i.stack=="string"&&(o=i.stack),typeof i.sql=="string"&&(a.sql=i.sql),typeof i.sqlMessage=="string"&&(a.sqlMessage=i.sqlMessage));const l=new s(r,e,o,Object.keys(a).length>0?a:void 0);if(i!==null&&typeof i=="object"){for(const[f,n]of Object.entries(i))if(!(f!=="walletError"&&typeof n!="string"&&typeof n!="number"&&!Array.isArray(n)))switch(f){case"walletError":l[f]=s.fromUnknown(n);break;case"status":break;case"name":break;case"code":break;case"message":break;case"description":break;case"stack":break;case"sql":break;case"sqlMessage":break;default:l[f]=n;break}}return l}asStatus(){return{status:"error",code:this.name,description:this.message}}}return _l.WalletError=s,_l}var lm={},L_;function _C(){return L_||(L_=1,Object.defineProperty(lm,"__esModule",{value:!0})),lm}var dm={},U_;function SC(){return U_||(U_=1,Object.defineProperty(dm,"__esModule",{value:!0})),dm}var Ce={},q_;function TC(){if(q_)return Ce;q_=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.WERR_REVIEW_ACTIONS=Ce.WERR_INVALID_PUBLIC_KEY=Ce.WERR_INSUFFICIENT_FUNDS=Ce.WERR_NOT_ACTIVE=Ce.WERR_UNAUTHORIZED=Ce.WERR_NETWORK_CHAIN=Ce.WERR_BAD_REQUEST=Ce.WERR_MISSING_PARAMETER=Ce.WERR_INVALID_PARAMETER=Ce.WERR_BROADCAST_UNAVAILABLE=Ce.WERR_INVALID_OPERATION=Ce.WERR_INTERNAL=Ce.WERR_NOT_IMPLEMENTED=void 0;const s=GT();class t extends s.WalletError{constructor(b){super("WERR_NOT_IMPLEMENTED",b??"Not implemented.")}}Ce.WERR_NOT_IMPLEMENTED=t;class i extends s.WalletError{constructor(b){super("WERR_INTERNAL",b??"An internal error has occurred.")}}Ce.WERR_INTERNAL=i;class r extends s.WalletError{constructor(b){super("WERR_INVALID_OPERATION",b??"An invalid operation was requested.")}}Ce.WERR_INVALID_OPERATION=r;class e extends s.WalletError{constructor(b){super("WERR_BROADCAST_UNAVAILABLE","Unable to broadcast transaction at this time.")}}Ce.WERR_BROADCAST_UNAVAILABLE=e;class o extends s.WalletError{constructor(b,w){super("WERR_INVALID_PARAMETER",`The ${b} parameter must be ${w??"valid."}`),this.parameter=b}}Ce.WERR_INVALID_PARAMETER=o;class a extends s.WalletError{constructor(b){super("WERR_MISSING_PARAMETER",`The required ${b} parameter is missing.`),this.parameter=b}}Ce.WERR_MISSING_PARAMETER=a;class l extends s.WalletError{constructor(b){super("WERR_BAD_REQUEST",b??"The request is invalid.")}}Ce.WERR_BAD_REQUEST=l;class f extends s.WalletError{constructor(b){super("WERR_NETWORK_CHAIN",b??"Configured network chain is invalid or does not match across services.")}}Ce.WERR_NETWORK_CHAIN=f;class n extends s.WalletError{constructor(b){super("WERR_UNAUTHORIZED",b??"Access is denied due to an authorization error.")}}Ce.WERR_UNAUTHORIZED=n;class c extends s.WalletError{constructor(b){super("WERR_NOT_ACTIVE",b??"WalletStorageManager is not accessing user's active storage or there are conflicting active stores configured.")}}Ce.WERR_NOT_ACTIVE=c;class d extends s.WalletError{constructor(b,w){super("WERR_INSUFFICIENT_FUNDS",`Insufficient funds in the available inputs to cover the cost of the required outputs and the transaction fee (${w} more satoshis are needed, for a total of ${b}), plus whatever would be required in order to pay the fee to unlock and spend the outputs used to provide the additional satoshis.`),this.totalSatoshisNeeded=b,this.moreSatoshisNeeded=w}}Ce.WERR_INSUFFICIENT_FUNDS=d;class y extends s.WalletError{constructor(b,w="mainnet"){const v=w==="mainnet"?`The provided public key "${b}" is invalid or malformed.`:"The provided public key is invalid or malformed.";super("WERR_INVALID_PUBLIC_KEY",v),this.key=b}}Ce.WERR_INVALID_PUBLIC_KEY=y;class p extends s.WalletError{constructor(b,w,v,_,S){super("WERR_REVIEW_ACTIONS","Undelayed createAction or signAction results require review."),this.reviewActionResults=b,this.sendWithResults=w,this.txid=v,this.tx=_,this.noSendChange=S}}return Ce.WERR_REVIEW_ACTIONS=p,Ce}var xe={},Bs={},Qn={},Kh={},j_;function ui(){if(j_)return Kh;j_=1,Object.defineProperty(Kh,"__esModule",{value:!0});let s=class _e{static isBN(i){return i instanceof _e?!0:i!==null&&typeof i=="object"&&i.constructor.wordSize===_e.wordSize&&Array.isArray(i.words)}static max(i,r){return i.cmp(r)>0?i:r}static min(i,r){return i.cmp(r)<0?i:r}constructor(i=0,r=10,e="be"){if(this.negative=0,this.words=[],this.length=0,this.red=null,i!==null){if((r==="le"||r==="be")&&(e=r,r=10),typeof i=="number"){this.initNumber(i,r,e);return}if(typeof i=="object"){this.initArray(i,e);return}r==="hex"&&(r=16),this.assert(r===(r|0)&&r>=2&&r<=36),i=i.toString().replace(/\s+/g,"");let o=0;i.startsWith("-")&&(o++,this.negative=1),o<i.length&&(r===16?this.parseHex(i,o,e):(this.parseBase(i,r,o),e==="le"&&this.initArray(this.toArray(),e)))}}assert(i,r="Assertion failed"){if(!i)throw new Error(r)}initNumber(i,r,e){return i<0&&(this.negative=1,i=-i),i<67108864?(this.words=[i&67108863],this.length=1):i<4503599627370496?(this.words=[i&67108863,i/67108864&67108863],this.length=2):(this.assert(i<=9007199254740991,"The number is larger than 2 ^ 53 (unsafe)"),this.words=[i&67108863,i/67108864&67108863,1],this.length=3),e!=="le"?this:(this.initArray(this.toArray(),e),this)}initArray(i,r){if(this.assert(typeof i.length=="number","The number must have a length"),i.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(i.length/3),this.words=new Array(this.length);let e=0;for(;e<this.length;e++)this.words[e]=0;let o,a,l=0;if(r==="be")for(e=i.length-1,o=0;e>=0;e-=3)a=i[e]|i[e-1]<<8|i[e-2]<<16,this.words[o]|=a<<l&67108863,this.words[o+1]=a>>>26-l&67108863,l+=24,l>=26&&(l-=26,o++);else if(r==="le")for(e=0,o=0;e<i.length;e+=3)a=i[e]|i[e+1]<<8|i[e+2]<<16,this.words[o]|=a<<l&67108863,this.words[o+1]=a>>>26-l&67108863,l+=24,l>=26&&(l-=26,o++);return this.strip()}parseHex4Bits(i,r){const e=i.charCodeAt(r);if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-55;if(e>=97&&e<=102)return e-87;throw new Error("Invalid character in "+i)}parseHexByte(i,r,e){let o=this.parseHex4Bits(i,e);return e-1>=r&&(o|=this.parseHex4Bits(i,e-1)<<4),o}parseHex(i,r,e){this.length=Math.ceil((i.length-r)/6),this.words=new Array(this.length).fill(0);let o=0,a=0;const l=f=>{const n=this.parseHexByte(i,r,f)<<o;this.words[a]|=n&67108863,o>=18?(o-=18,a+=1,this.words[a]|=n>>>26):o+=8};if(e==="be")for(let f=i.length-1;f>=r;f-=2)l(f);else{const f=i.length-r;for(let n=f%2===0?r+1:r;n<i.length;n+=2)l(n)}return this.strip()}parseBaseWord(i,r,e,o){let a=0,l=0;const f=Math.min(i.length,e);for(let n=r;n<f;n++){const c=i.charCodeAt(n)-48;a*=o,c>=49?l=c-49+10:c>=17?l=c-17+10:l=c,this.assert(c>=0&&l<o,"Invalid character"),a+=l}return a}parseBase(i,r,e){this.words=[0],this.length=1;let o=0,a=1;for(;a<=67108863;a*=r)o++;o--,a=a/r|0;const l=i.length-e,f=l%o,n=Math.min(l,l-f)+e;let c=0,d=e;for(;d<n;d+=o)c=this.parseBaseWord(i,d,d+o,r),this.imuln(a),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(f!==0){let y=1;for(c=this.parseBaseWord(i,d,i.length,r),d=0;d<f;d++)y*=r;this.imuln(y),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}return this.strip()}copy(i){i.words=new Array(this.length);for(let r=0;r<this.length;r++)i.words[r]=this.words[r];i.length=this.length,i.negative=this.negative,i.red=this.red}static move(i,r){i.words=r.words,i.length=r.length,i.negative=r.negative,i.red=r.red}clone(){const i=new _e;return this.copy(i),i}expand(i){for(;this.length<i;)this.words[this.length++]=0;return this}strip(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this.normSign()}normSign(){return this.length===1&&this.words[0]===0&&(this.negative=0),this}inspect(){return(this.red!==null?"<BN-R: ":"<BN: ")+this.toString(16)+">"}toString(i=10,r=1){if(i===16||i==="hex")return this.toHexString(r);if(i===(i|0)&&i>=2&&i<=36)return this.toBaseString(i,r);throw new Error("Base should be between 2 and 36")}toHexString(i){let r="",e=0,o=0;for(let a=0;a<this.length;a++){const l=this.words[a],f=((l<<e|o)&16777215).toString(16);o=l>>>24-e&16777215,e+=2,e>=26&&(e-=26,a--),o!==0||a!==this.length-1?r=_e.zeros[6-f.length]+f+r:r=f+r}if(o!==0&&(r=o.toString(16)+r),i===0&&r==="0")return"";for(;r.length%i!==0&&i!==0;)r="0"+r;return this.negative!==0&&(r="-"+r),r}toBaseString(i,r){const e=_e.groupSizes[i],o=_e.groupBases[i];let a="",l=this.clone();for(l.negative=0;!l.isZero();){const f=l.modrn(o).toString(i);l=l.idivn(o),l.isZero()?a=f+a:a=_e.zeros[e-f.length]+f+a}for(this.isZero()&&(a="0"+a);a.length%r!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}toNumber(){let i=this.words[0];if(this.length===2)i+=this.words[1]*67108864;else if(this.length===3&&this.words[2]===1)i+=4503599627370496+this.words[1]*67108864;else if(this.length>2)throw new Error("Number can only safely store up to 53 bits");return this.negative!==0?-i:i}toJSON(){return this.toString(16)}toArrayLikeLE(i,r){let e=0,o=0;for(let a=0,l=0;a<this.length;a++){const f=this.words[a]<<l|o;i[e++]=f&255,e<i.length&&(i[e++]=f>>8&255),e<i.length&&(i[e++]=f>>16&255),l===6?(e<i.length&&(i[e++]=f>>24&255),o=0,l=0):(o=f>>>24,l+=2)}if(e<i.length)for(i[e++]=o;e<i.length;)i[e++]=0}toArrayLikeBE(i,r){let e=i.length-1,o=0;for(let a=0,l=0;a<this.length;a++){const f=this.words[a]<<l|o;i[e--]=f&255,e>=0&&(i[e--]=f>>8&255),e>=0&&(i[e--]=f>>16&255),l===6?(e>=0&&(i[e--]=f>>24&255),o=0,l=0):(o=f>>>24,l+=2)}if(e>=0)for(i[e--]=o;e>=0;)i[e--]=0}toArray(i="be",r){this.strip();const e=this.byteLength(),o=r??Math.max(1,e);this.assert(e<=o,"byte array longer than desired length"),this.assert(o>0,"Requested array length <= 0");const a=new Array(o);return i==="le"?this.toArrayLikeLE(a,e):this.toArrayLikeBE(a,e),a}countWordBits(i){if(typeof Math.clz32=="function")return 32-Math.clz32(i);let r=i,e=0;return r>=4096&&(e+=13,r>>>=13),r>=64&&(e+=7,r>>>=7),r>=8&&(e+=4,r>>>=4),r>=2&&(e+=2,r>>>=2),e+r}zeroWordBits(i){if(i===0)return 26;let r=i,e=0;return(r&8191)===0&&(e+=13,r>>>=13),(r&127)===0&&(e+=7,r>>>=7),(r&15)===0&&(e+=4,r>>>=4),(r&3)===0&&(e+=2,r>>>=2),(r&1)===0&&e++,e}bitLength(){const i=this.words[this.length-1],r=this.countWordBits(i);return(this.length-1)*26+r}static toBitArray(i){const r=new Array(i.bitLength());for(let e=0;e<r.length;e++){const o=e/26|0,a=e%26;r[e]=i.words[o]>>>a&1}return r}toBitArray(){return _e.toBitArray(this)}zeroBits(){if(this.isZero())return 0;let i=0;for(let r=0;r<this.length;r++){const e=this.zeroWordBits(this.words[r]);if(i+=e,e!==26)break}return i}byteLength(){return Math.ceil(this.bitLength()/8)}toTwos(i){return this.negative!==0?this.abs().inotn(i).iaddn(1):this.clone()}fromTwos(i){return this.testn(i-1)?this.notn(i).iaddn(1).ineg():this.clone()}isNeg(){return this.negative!==0}neg(){return this.clone().ineg()}ineg(){return this.isZero()||(this.negative^=1),this}iuor(i){for(;this.length<i.length;)this.words[this.length++]=0;for(let r=0;r<i.length;r++)this.words[r]=this.words[r]|i.words[r];return this.strip()}ior(i){return this.assert((this.negative|i.negative)===0),this.iuor(i)}or(i){return this.length>i.length?this.clone().ior(i):i.clone().ior(this)}uor(i){return this.length>i.length?this.clone().iuor(i):i.clone().iuor(this)}iuand(i){const r=Math.min(this.length,i.length);for(let e=0;e<r;e++)this.words[e]=this.words[e]&i.words[e];return this.length=r,this.strip()}iand(i){return this.assert((this.negative|i.negative)===0),this.iuand(i)}and(i){return this.length>i.length?this.clone().iand(i):i.clone().iand(this)}uand(i){return this.length>i.length?this.clone().iuand(i):i.clone().iuand(this)}iuxor(i){if(this.length>i.length)for(let r=0;r<i.length;r++)this.words[r]=this.words[r]^i.words[r];else{for(let r=0;r<this.length;r++)this.words[r]=this.words[r]^i.words[r];for(let r=this.length;r<i.length;r++)this.words[r]=i.words[r];this.length=i.length}return this.strip()}ixor(i){return this.assert((this.negative|i.negative)===0,"Neither number can be negative"),this.iuxor(i)}xor(i){return this.length>i.length?this.clone().ixor(i):i.clone().ixor(this)}uxor(i){return this.length>i.length?this.clone().iuxor(i):i.clone().iuxor(this)}inotn(i){this.assert(typeof i=="number"&&i>=0,"The width needs to be a number greater than zero");let r=Math.ceil(i/26)|0;const e=i%26;this.expand(r),e>0&&r--;let o=0;for(;o<r;o++)this.words[o]=~this.words[o]&67108863;return e>0&&(this.words[o]=~this.words[o]&67108863>>26-e),this.strip()}notn(i){return this.clone().inotn(i)}setn(i,r){this.assert(typeof i=="number"&&i>=0);const e=i/26|0,o=i%26;return this.expand(e+1),r===1||r===!0?this.words[e]=this.words[e]|1<<o:this.words[e]=this.words[e]&~(1<<o),this.strip()}iadd(i){let r;if(this.negative!==0&&i.negative===0)return this.negative=0,r=this.isub(i),this.negative^=1,this.normSign();if(this.negative===0&&i.negative!==0)return i.negative=0,r=this.isub(i),i.negative=1,r.normSign();let e,o;this.length>i.length?(e=this,o=i):(e=i,o=this);let a=0,l=0;for(;l<o.length;l++)r=(e.words[l]|0)+(o.words[l]|0)+a,this.words[l]=r&67108863,a=r>>>26;for(;a!==0&&l<e.length;l++)r=(e.words[l]|0)+a,this.words[l]=r&67108863,a=r>>>26;if(this.length=e.length,a!==0)this.words[this.length]=a,this.length++;else if(e!==this)for(;l<e.length;l++)this.words[l]=e.words[l];return this}add(i){let r;return i.negative!==0&&this.negative===0?(i.negative=0,r=this.sub(i),i.negative^=1,r):i.negative===0&&this.negative!==0?(this.negative=0,r=i.sub(this),this.negative=1,r):this.length>i.length?this.clone().iadd(i):i.clone().iadd(this)}isub(i){let r;if(i.negative!==0)return i.negative=0,r=this.iadd(i),i.negative=1,r.normSign();if(this.negative!==0)return this.negative=0,this.iadd(i),this.negative=1,this.normSign();const e=this.cmp(i);if(e===0)return this.negative=0,this.length=1,this.words[0]=0,this;let o,a;e>0?(o=this,a=i):(o=i,a=this);let l=0,f=0;for(;f<a.length;f++)r=(o.words[f]|0)-(a.words[f]|0)+l,l=r>>26,this.words[f]=r&67108863;for(;l!==0&&f<o.length;f++)r=(o.words[f]|0)+l,l=r>>26,this.words[f]=r&67108863;if(l===0&&f<o.length&&o!==this)for(;f<o.length;f++)this.words[f]=o.words[f];return this.length=Math.max(this.length,f),o!==this&&(this.negative=1),this.strip()}sub(i){return this.clone().isub(i)}smallMulTo(i,r,e){e.negative=r.negative^i.negative;let o=i.length+r.length|0;e.length=o,o=o-1|0;let a=i.words[0]|0,l=r.words[0]|0,f=a*l;const n=f&67108863;let c=f/67108864|0;e.words[0]=n;let d=1;for(;d<o;d++){let y=c>>>26,p=c&67108863;const g=Math.min(d,r.length-1);for(let b=Math.max(0,d-i.length+1);b<=g;b++){const w=d-b|0;a=i.words[w]|0,l=r.words[b]|0,f=a*l+p,y+=f/67108864|0,p=f&67108863}e.words[d]=p|0,c=y|0}return c!==0?e.words[d]=c|0:e.length--,e.strip()}comb10MulTo(i,r,e){const o=i.words,a=r.words,l=e.words;let f=0,n,c,d;const y=o[0]|0,p=y&8191,g=y>>>13,b=o[1]|0,w=b&8191,v=b>>>13,_=o[2]|0,S=_&8191,T=_>>>13,I=o[3]|0,k=I&8191,O=I>>>13,A=o[4]|0,R=A&8191,P=A>>>13,C=o[5]|0,N=C&8191,D=C>>>13,U=o[6]|0,F=U&8191,L=U>>>13,j=o[7]|0,V=j&8191,W=j>>>13,q=o[8]|0,$=q&8191,Y=q>>>13,Q=o[9]|0,J=Q&8191,vt=Q>>>13,wt=a[0]|0,dt=wt&8191,yt=wt>>>13,_t=a[1]|0,tt=_t&8191,xt=_t>>>13,It=a[2]|0,Nt=It&8191,Lt=It>>>13,ne=a[3]|0,Ut=ne&8191,Vt=ne>>>13,Jt=a[4]|0,Ct=Jt&8191,K=Jt>>>13,ut=a[5]|0,st=ut&8191,Mt=ut>>>13,Ht=a[6]|0,Kt=Ht&8191,Xt=Ht>>>13,Qt=a[7]|0,Ft=Qt&8191,Rt=Qt>>>13,St=a[8]|0,Ot=St&8191,Wt=St>>>13,Gt=a[9]|0,z=Gt&8191,G=Gt>>>13;e.negative=i.negative^r.negative,e.length=19,n=Math.imul(p,dt),c=Math.imul(p,yt),c=c+Math.imul(g,dt)|0,d=Math.imul(g,yt);let at=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(at>>>26)|0,at&=67108863,n=Math.imul(w,dt),c=Math.imul(w,yt),c=c+Math.imul(v,dt)|0,d=Math.imul(v,yt),n=n+Math.imul(p,tt)|0,c=c+Math.imul(p,xt)|0,c=c+Math.imul(g,tt)|0,d=d+Math.imul(g,xt)|0;let ht=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(ht>>>26)|0,ht&=67108863,n=Math.imul(S,dt),c=Math.imul(S,yt),c=c+Math.imul(T,dt)|0,d=Math.imul(T,yt),n=n+Math.imul(w,tt)|0,c=c+Math.imul(w,xt)|0,c=c+Math.imul(v,tt)|0,d=d+Math.imul(v,xt)|0,n=n+Math.imul(p,Nt)|0,c=c+Math.imul(p,Lt)|0,c=c+Math.imul(g,Nt)|0,d=d+Math.imul(g,Lt)|0;let lt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(lt>>>26)|0,lt&=67108863,n=Math.imul(k,dt),c=Math.imul(k,yt),c=c+Math.imul(O,dt)|0,d=Math.imul(O,yt),n=n+Math.imul(S,tt)|0,c=c+Math.imul(S,xt)|0,c=c+Math.imul(T,tt)|0,d=d+Math.imul(T,xt)|0,n=n+Math.imul(w,Nt)|0,c=c+Math.imul(w,Lt)|0,c=c+Math.imul(v,Nt)|0,d=d+Math.imul(v,Lt)|0,n=n+Math.imul(p,Ut)|0,c=c+Math.imul(p,Vt)|0,c=c+Math.imul(g,Ut)|0,d=d+Math.imul(g,Vt)|0;let bt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(R,dt),c=Math.imul(R,yt),c=c+Math.imul(P,dt)|0,d=Math.imul(P,yt),n=n+Math.imul(k,tt)|0,c=c+Math.imul(k,xt)|0,c=c+Math.imul(O,tt)|0,d=d+Math.imul(O,xt)|0,n=n+Math.imul(S,Nt)|0,c=c+Math.imul(S,Lt)|0,c=c+Math.imul(T,Nt)|0,d=d+Math.imul(T,Lt)|0,n=n+Math.imul(w,Ut)|0,c=c+Math.imul(w,Vt)|0,c=c+Math.imul(v,Ut)|0,d=d+Math.imul(v,Vt)|0,n=n+Math.imul(p,Ct)|0,c=c+Math.imul(p,K)|0,c=c+Math.imul(g,Ct)|0,d=d+Math.imul(g,K)|0;let Dt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,n=Math.imul(N,dt),c=Math.imul(N,yt),c=c+Math.imul(D,dt)|0,d=Math.imul(D,yt),n=n+Math.imul(R,tt)|0,c=c+Math.imul(R,xt)|0,c=c+Math.imul(P,tt)|0,d=d+Math.imul(P,xt)|0,n=n+Math.imul(k,Nt)|0,c=c+Math.imul(k,Lt)|0,c=c+Math.imul(O,Nt)|0,d=d+Math.imul(O,Lt)|0,n=n+Math.imul(S,Ut)|0,c=c+Math.imul(S,Vt)|0,c=c+Math.imul(T,Ut)|0,d=d+Math.imul(T,Vt)|0,n=n+Math.imul(w,Ct)|0,c=c+Math.imul(w,K)|0,c=c+Math.imul(v,Ct)|0,d=d+Math.imul(v,K)|0,n=n+Math.imul(p,st)|0,c=c+Math.imul(p,Mt)|0,c=c+Math.imul(g,st)|0,d=d+Math.imul(g,Mt)|0;let jt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(jt>>>26)|0,jt&=67108863,n=Math.imul(F,dt),c=Math.imul(F,yt),c=c+Math.imul(L,dt)|0,d=Math.imul(L,yt),n=n+Math.imul(N,tt)|0,c=c+Math.imul(N,xt)|0,c=c+Math.imul(D,tt)|0,d=d+Math.imul(D,xt)|0,n=n+Math.imul(R,Nt)|0,c=c+Math.imul(R,Lt)|0,c=c+Math.imul(P,Nt)|0,d=d+Math.imul(P,Lt)|0,n=n+Math.imul(k,Ut)|0,c=c+Math.imul(k,Vt)|0,c=c+Math.imul(O,Ut)|0,d=d+Math.imul(O,Vt)|0,n=n+Math.imul(S,Ct)|0,c=c+Math.imul(S,K)|0,c=c+Math.imul(T,Ct)|0,d=d+Math.imul(T,K)|0,n=n+Math.imul(w,st)|0,c=c+Math.imul(w,Mt)|0,c=c+Math.imul(v,st)|0,d=d+Math.imul(v,Mt)|0,n=n+Math.imul(p,Kt)|0,c=c+Math.imul(p,Xt)|0,c=c+Math.imul(g,Kt)|0,d=d+Math.imul(g,Xt)|0;let Yt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,n=Math.imul(V,dt),c=Math.imul(V,yt),c=c+Math.imul(W,dt)|0,d=Math.imul(W,yt),n=n+Math.imul(F,tt)|0,c=c+Math.imul(F,xt)|0,c=c+Math.imul(L,tt)|0,d=d+Math.imul(L,xt)|0,n=n+Math.imul(N,Nt)|0,c=c+Math.imul(N,Lt)|0,c=c+Math.imul(D,Nt)|0,d=d+Math.imul(D,Lt)|0,n=n+Math.imul(R,Ut)|0,c=c+Math.imul(R,Vt)|0,c=c+Math.imul(P,Ut)|0,d=d+Math.imul(P,Vt)|0,n=n+Math.imul(k,Ct)|0,c=c+Math.imul(k,K)|0,c=c+Math.imul(O,Ct)|0,d=d+Math.imul(O,K)|0,n=n+Math.imul(S,st)|0,c=c+Math.imul(S,Mt)|0,c=c+Math.imul(T,st)|0,d=d+Math.imul(T,Mt)|0,n=n+Math.imul(w,Kt)|0,c=c+Math.imul(w,Xt)|0,c=c+Math.imul(v,Kt)|0,d=d+Math.imul(v,Xt)|0,n=n+Math.imul(p,Ft)|0,c=c+Math.imul(p,Rt)|0,c=c+Math.imul(g,Ft)|0,d=d+Math.imul(g,Rt)|0;let te=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(te>>>26)|0,te&=67108863,n=Math.imul($,dt),c=Math.imul($,yt),c=c+Math.imul(Y,dt)|0,d=Math.imul(Y,yt),n=n+Math.imul(V,tt)|0,c=c+Math.imul(V,xt)|0,c=c+Math.imul(W,tt)|0,d=d+Math.imul(W,xt)|0,n=n+Math.imul(F,Nt)|0,c=c+Math.imul(F,Lt)|0,c=c+Math.imul(L,Nt)|0,d=d+Math.imul(L,Lt)|0,n=n+Math.imul(N,Ut)|0,c=c+Math.imul(N,Vt)|0,c=c+Math.imul(D,Ut)|0,d=d+Math.imul(D,Vt)|0,n=n+Math.imul(R,Ct)|0,c=c+Math.imul(R,K)|0,c=c+Math.imul(P,Ct)|0,d=d+Math.imul(P,K)|0,n=n+Math.imul(k,st)|0,c=c+Math.imul(k,Mt)|0,c=c+Math.imul(O,st)|0,d=d+Math.imul(O,Mt)|0,n=n+Math.imul(S,Kt)|0,c=c+Math.imul(S,Xt)|0,c=c+Math.imul(T,Kt)|0,d=d+Math.imul(T,Xt)|0,n=n+Math.imul(w,Ft)|0,c=c+Math.imul(w,Rt)|0,c=c+Math.imul(v,Ft)|0,d=d+Math.imul(v,Rt)|0,n=n+Math.imul(p,Ot)|0,c=c+Math.imul(p,Wt)|0,c=c+Math.imul(g,Ot)|0,d=d+Math.imul(g,Wt)|0;let oe=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(oe>>>26)|0,oe&=67108863,n=Math.imul(J,dt),c=Math.imul(J,yt),c=c+Math.imul(vt,dt)|0,d=Math.imul(vt,yt),n=n+Math.imul($,tt)|0,c=c+Math.imul($,xt)|0,c=c+Math.imul(Y,tt)|0,d=d+Math.imul(Y,xt)|0,n=n+Math.imul(V,Nt)|0,c=c+Math.imul(V,Lt)|0,c=c+Math.imul(W,Nt)|0,d=d+Math.imul(W,Lt)|0,n=n+Math.imul(F,Ut)|0,c=c+Math.imul(F,Vt)|0,c=c+Math.imul(L,Ut)|0,d=d+Math.imul(L,Vt)|0,n=n+Math.imul(N,Ct)|0,c=c+Math.imul(N,K)|0,c=c+Math.imul(D,Ct)|0,d=d+Math.imul(D,K)|0,n=n+Math.imul(R,st)|0,c=c+Math.imul(R,Mt)|0,c=c+Math.imul(P,st)|0,d=d+Math.imul(P,Mt)|0,n=n+Math.imul(k,Kt)|0,c=c+Math.imul(k,Xt)|0,c=c+Math.imul(O,Kt)|0,d=d+Math.imul(O,Xt)|0,n=n+Math.imul(S,Ft)|0,c=c+Math.imul(S,Rt)|0,c=c+Math.imul(T,Ft)|0,d=d+Math.imul(T,Rt)|0,n=n+Math.imul(w,Ot)|0,c=c+Math.imul(w,Wt)|0,c=c+Math.imul(v,Ot)|0,d=d+Math.imul(v,Wt)|0,n=n+Math.imul(p,z)|0,c=c+Math.imul(p,G)|0,c=c+Math.imul(g,z)|0,d=d+Math.imul(g,G)|0;let ee=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(ee>>>26)|0,ee&=67108863,n=Math.imul(J,tt),c=Math.imul(J,xt),c=c+Math.imul(vt,tt)|0,d=Math.imul(vt,xt),n=n+Math.imul($,Nt)|0,c=c+Math.imul($,Lt)|0,c=c+Math.imul(Y,Nt)|0,d=d+Math.imul(Y,Lt)|0,n=n+Math.imul(V,Ut)|0,c=c+Math.imul(V,Vt)|0,c=c+Math.imul(W,Ut)|0,d=d+Math.imul(W,Vt)|0,n=n+Math.imul(F,Ct)|0,c=c+Math.imul(F,K)|0,c=c+Math.imul(L,Ct)|0,d=d+Math.imul(L,K)|0,n=n+Math.imul(N,st)|0,c=c+Math.imul(N,Mt)|0,c=c+Math.imul(D,st)|0,d=d+Math.imul(D,Mt)|0,n=n+Math.imul(R,Kt)|0,c=c+Math.imul(R,Xt)|0,c=c+Math.imul(P,Kt)|0,d=d+Math.imul(P,Xt)|0,n=n+Math.imul(k,Ft)|0,c=c+Math.imul(k,Rt)|0,c=c+Math.imul(O,Ft)|0,d=d+Math.imul(O,Rt)|0,n=n+Math.imul(S,Ot)|0,c=c+Math.imul(S,Wt)|0,c=c+Math.imul(T,Ot)|0,d=d+Math.imul(T,Wt)|0,n=n+Math.imul(w,z)|0,c=c+Math.imul(w,G)|0,c=c+Math.imul(v,z)|0,d=d+Math.imul(v,G)|0;let pe=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(pe>>>26)|0,pe&=67108863,n=Math.imul(J,Nt),c=Math.imul(J,Lt),c=c+Math.imul(vt,Nt)|0,d=Math.imul(vt,Lt),n=n+Math.imul($,Ut)|0,c=c+Math.imul($,Vt)|0,c=c+Math.imul(Y,Ut)|0,d=d+Math.imul(Y,Vt)|0,n=n+Math.imul(V,Ct)|0,c=c+Math.imul(V,K)|0,c=c+Math.imul(W,Ct)|0,d=d+Math.imul(W,K)|0,n=n+Math.imul(F,st)|0,c=c+Math.imul(F,Mt)|0,c=c+Math.imul(L,st)|0,d=d+Math.imul(L,Mt)|0,n=n+Math.imul(N,Kt)|0,c=c+Math.imul(N,Xt)|0,c=c+Math.imul(D,Kt)|0,d=d+Math.imul(D,Xt)|0,n=n+Math.imul(R,Ft)|0,c=c+Math.imul(R,Rt)|0,c=c+Math.imul(P,Ft)|0,d=d+Math.imul(P,Rt)|0,n=n+Math.imul(k,Ot)|0,c=c+Math.imul(k,Wt)|0,c=c+Math.imul(O,Ot)|0,d=d+Math.imul(O,Wt)|0,n=n+Math.imul(S,z)|0,c=c+Math.imul(S,G)|0,c=c+Math.imul(T,z)|0,d=d+Math.imul(T,G)|0;let Bt=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(J,Ut),c=Math.imul(J,Vt),c=c+Math.imul(vt,Ut)|0,d=Math.imul(vt,Vt),n=n+Math.imul($,Ct)|0,c=c+Math.imul($,K)|0,c=c+Math.imul(Y,Ct)|0,d=d+Math.imul(Y,K)|0,n=n+Math.imul(V,st)|0,c=c+Math.imul(V,Mt)|0,c=c+Math.imul(W,st)|0,d=d+Math.imul(W,Mt)|0,n=n+Math.imul(F,Kt)|0,c=c+Math.imul(F,Xt)|0,c=c+Math.imul(L,Kt)|0,d=d+Math.imul(L,Xt)|0,n=n+Math.imul(N,Ft)|0,c=c+Math.imul(N,Rt)|0,c=c+Math.imul(D,Ft)|0,d=d+Math.imul(D,Rt)|0,n=n+Math.imul(R,Ot)|0,c=c+Math.imul(R,Wt)|0,c=c+Math.imul(P,Ot)|0,d=d+Math.imul(P,Wt)|0,n=n+Math.imul(k,z)|0,c=c+Math.imul(k,G)|0,c=c+Math.imul(O,z)|0,d=d+Math.imul(O,G)|0;let ce=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(ce>>>26)|0,ce&=67108863,n=Math.imul(J,Ct),c=Math.imul(J,K),c=c+Math.imul(vt,Ct)|0,d=Math.imul(vt,K),n=n+Math.imul($,st)|0,c=c+Math.imul($,Mt)|0,c=c+Math.imul(Y,st)|0,d=d+Math.imul(Y,Mt)|0,n=n+Math.imul(V,Kt)|0,c=c+Math.imul(V,Xt)|0,c=c+Math.imul(W,Kt)|0,d=d+Math.imul(W,Xt)|0,n=n+Math.imul(F,Ft)|0,c=c+Math.imul(F,Rt)|0,c=c+Math.imul(L,Ft)|0,d=d+Math.imul(L,Rt)|0,n=n+Math.imul(N,Ot)|0,c=c+Math.imul(N,Wt)|0,c=c+Math.imul(D,Ot)|0,d=d+Math.imul(D,Wt)|0,n=n+Math.imul(R,z)|0,c=c+Math.imul(R,G)|0,c=c+Math.imul(P,z)|0,d=d+Math.imul(P,G)|0;let Si=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Si>>>26)|0,Si&=67108863,n=Math.imul(J,st),c=Math.imul(J,Mt),c=c+Math.imul(vt,st)|0,d=Math.imul(vt,Mt),n=n+Math.imul($,Kt)|0,c=c+Math.imul($,Xt)|0,c=c+Math.imul(Y,Kt)|0,d=d+Math.imul(Y,Xt)|0,n=n+Math.imul(V,Ft)|0,c=c+Math.imul(V,Rt)|0,c=c+Math.imul(W,Ft)|0,d=d+Math.imul(W,Rt)|0,n=n+Math.imul(F,Ot)|0,c=c+Math.imul(F,Wt)|0,c=c+Math.imul(L,Ot)|0,d=d+Math.imul(L,Wt)|0,n=n+Math.imul(N,z)|0,c=c+Math.imul(N,G)|0,c=c+Math.imul(D,z)|0,d=d+Math.imul(D,G)|0;let Qe=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,n=Math.imul(J,Kt),c=Math.imul(J,Xt),c=c+Math.imul(vt,Kt)|0,d=Math.imul(vt,Xt),n=n+Math.imul($,Ft)|0,c=c+Math.imul($,Rt)|0,c=c+Math.imul(Y,Ft)|0,d=d+Math.imul(Y,Rt)|0,n=n+Math.imul(V,Ot)|0,c=c+Math.imul(V,Wt)|0,c=c+Math.imul(W,Ot)|0,d=d+Math.imul(W,Wt)|0,n=n+Math.imul(F,z)|0,c=c+Math.imul(F,G)|0,c=c+Math.imul(L,z)|0,d=d+Math.imul(L,G)|0;let Re=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(J,Ft),c=Math.imul(J,Rt),c=c+Math.imul(vt,Ft)|0,d=Math.imul(vt,Rt),n=n+Math.imul($,Ot)|0,c=c+Math.imul($,Wt)|0,c=c+Math.imul(Y,Ot)|0,d=d+Math.imul(Y,Wt)|0,n=n+Math.imul(V,z)|0,c=c+Math.imul(V,G)|0,c=c+Math.imul(W,z)|0,d=d+Math.imul(W,G)|0;let We=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(We>>>26)|0,We&=67108863,n=Math.imul(J,Ot),c=Math.imul(J,Wt),c=c+Math.imul(vt,Ot)|0,d=Math.imul(vt,Wt),n=n+Math.imul($,z)|0,c=c+Math.imul($,G)|0,c=c+Math.imul(Y,z)|0,d=d+Math.imul(Y,G)|0;let Ti=(f+n|0)+((c&8191)<<13)|0;f=(d+(c>>>13)|0)+(Ti>>>26)|0,Ti&=67108863,n=Math.imul(J,z),c=Math.imul(J,G),c=c+Math.imul(vt,z)|0,d=Math.imul(vt,G);let Hi=(f+n|0)+((c&8191)<<13)|0;return f=(d+(c>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,l[0]=at,l[1]=ht,l[2]=lt,l[3]=bt,l[4]=Dt,l[5]=jt,l[6]=Yt,l[7]=te,l[8]=oe,l[9]=ee,l[10]=pe,l[11]=Bt,l[12]=ce,l[13]=Si,l[14]=Qe,l[15]=Re,l[16]=We,l[17]=Ti,l[18]=Hi,f!==0&&(l[19]=f,e.length++),e}bigMulTo(i,r,e){e.negative=r.negative^i.negative,e.length=i.length+r.length;let o=0,a=0,l=0;for(;l<e.length-1;l++){let f=a;a=0;let n=o&67108863;const c=Math.min(l,r.length-1);for(let d=Math.max(0,l-i.length+1);d<=c;d++){const y=l-d,p=i.words[y]|0,g=r.words[d]|0,b=p*g;let w=b&67108863;f=f+(b/67108864|0)|0,w=w+n|0,n=w&67108863,f=f+(w>>>26)|0,a+=f>>>26,f&=67108863}e.words[l]=n,o=f,f=a}return o!==0?e.words[l]=o:e.length--,e.strip()}mulTo(i,r){let e;const o=this.length+i.length;return this.length===10&&i.length===10?e=this.comb10MulTo(this,i,r):o<63?e=this.smallMulTo(this,i,r):e=this.bigMulTo(this,i,r),e}mul(i){const r=new _e;return r.words=new Array(this.length+i.length),this.mulTo(i,r)}imul(i){return this.clone().mulTo(i,this)}imuln(i){const r=i<0;r&&(i=-i),this.assert(typeof i=="number"),this.assert(i<67108864);let e=0,o=0;for(;o<this.length;o++){const a=(this.words[o]|0)*i,l=(a&67108863)+(e&67108863);e>>=26,e+=a/67108864|0,e+=l>>>26,this.words[o]=l&67108863}return e!==0&&(this.words[o]=e,this.length++),r?this.ineg():this}muln(i){return this.clone().imuln(i)}sqr(){return this.mul(this)}isqr(){return this.imul(this.clone())}pow(i){const r=_e.toBitArray(i);if(r.length===0)return new _e(1);let e=this,o=0;for(;o<r.length&&r[o]===0;o++,e=e.sqr());if(++o<r.length)for(let a=e.sqr();o<r.length;o++,a=a.sqr())r[o]!==0&&(e=e.mul(a));return e}iushln(i){this.assert(typeof i=="number"&&i>=0);const r=i%26,e=(i-r)/26,o=67108863>>>26-r<<26-r;let a;if(r!==0){let l=0;for(a=0;a<this.length;a++){const f=this.words[a]&o,n=(this.words[a]|0)-f<<r;this.words[a]=n|l,l=f>>>26-r}l!==0&&(this.words[a]=l,this.length++)}if(e!==0){for(a=this.length-1;a>=0;a--)this.words[a+e]=this.words[a];for(a=0;a<e;a++)this.words[a]=0;this.length+=e}return this.strip()}ishln(i){return this.assert(this.negative===0),this.iushln(i)}iushrn(i,r,e){this.assert(typeof i=="number"&&i>=0);let o;typeof r=="number"&&r!==0?o=(r-r%26)/26:o=0;const a=i%26,l=Math.min((i-a)/26,this.length),f=67108863^67108863>>>a<<a,n=e;o-=l,o=Math.max(0,o);let c=0;if(typeof n<"u"){for(;c<l;c++)n.words[c]=this.words[c];n.length=l}if(l!==0)if(this.length>l)for(this.length-=l,c=0;c<this.length;c++)this.words[c]=this.words[c+l];else this.words[0]=0,this.length=1;let d=0;for(c=this.length-1;c>=0&&(d!==0||c>=o);c--){const y=this.words[c]|0;this.words[c]=d<<26-a|y>>>a,d=y&f}return n!=null&&d!==0&&(n.words[n.length++]=d),this.length===0&&(this.words[0]=0,this.length=1),this.strip()}ishrn(i,r,e){return this.assert(this.negative===0),this.iushrn(i,r,e)}shln(i){return this.clone().ishln(i)}ushln(i){return this.clone().iushln(i)}shrn(i){return this.clone().ishrn(i)}ushrn(i){return this.clone().iushrn(i)}testn(i){this.assert(typeof i=="number"&&i>=0);const r=i%26,e=(i-r)/26,o=1<<r;return this.length<=e?!1:!!(this.words[e]&o)}imaskn(i){this.assert(typeof i=="number"&&i>=0);const r=i%26;let e=(i-r)/26;if(this.assert(this.negative===0,"imaskn works only with positive numbers"),this.length<=e)return this;if(r!==0&&e++,this.length=Math.min(e,this.length),r!==0){const o=67108863^67108863>>>r<<r;this.words[this.length-1]&=o}return this.strip()}maskn(i){return this.clone().imaskn(i)}iaddn(i){return this.assert(typeof i=="number"),this.assert(i<67108864,"num is too large"),i<0?this.isubn(-i):this.negative!==0?this.length===1&&(this.words[0]|0)<=i?(this.words[0]=i-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(i),this.negative=1,this):this._iaddn(i)}_iaddn(i){this.words[0]+=i;let r=0;for(;r<this.length&&this.words[r]>=67108864;r++)this.words[r]-=67108864,r===this.length-1?this.words[r+1]=1:this.words[r+1]++;return this.length=Math.max(this.length,r+1),this}isubn(i){if(this.assert(typeof i=="number"),this.assert(i<67108864),i<0)return this.iaddn(-i);if(this.negative!==0)return this.negative=0,this.iaddn(i),this.negative=1,this;if(this.words[0]-=i,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(let r=0;r<this.length&&this.words[r]<0;r++)this.words[r]+=67108864,this.words[r+1]-=1;return this.strip()}addn(i){return this.clone().iaddn(i)}subn(i){return this.clone().isubn(i)}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}_ishlnsubmul(i,r,e){const o=i.length+e;let a;this.expand(o);let l,f=0;for(a=0;a<i.length;a++){l=(this.words[a+e]|0)+f;const n=(i.words[a]|0)*r;l-=n&67108863,f=(l>>26)-(n/67108864|0),this.words[a+e]=l&67108863}for(;a<this.length-e;a++)l=(this.words[a+e]|0)+f,f=l>>26,this.words[a+e]=l&67108863;if(f===0)return this.strip();for(this.assert(f===-1,"carry must be -1"),f=0,a=0;a<this.length;a++)l=-(this.words[a]|0)+f,f=l>>26,this.words[a]=l&67108863;return this.negative=1,this.strip()}wordDiv(i,r){let e=this.length-i.length,o=this.clone(),a=i,l=a.words[a.length-1]|0;e=26-this.countWordBits(l),e!==0&&(a=a.ushln(e),o.iushln(e),l=a.words[a.length-1]|0);const n=o.length-a.length;let c;if(r!=="mod"){c=new _e,c.length=n+1,c.words=new Array(c.length);for(let y=0;y<c.length;y++)c.words[y]=0}const d=o.clone()._ishlnsubmul(a,1,n);d.negative===0&&(o=d,typeof c<"u"&&(c.words[n]=1));for(let y=n-1;y>=0;y--){let p=(o.words[a.length+y]|0)*67108864+(o.words[a.length+y-1]|0);for(p=Math.min(p/l|0,67108863),o._ishlnsubmul(a,p,y);o.negative!==0;)p--,o.negative=0,o._ishlnsubmul(a,1,y),o.isZero()||(o.negative^=1);typeof c<"u"&&(c.words[y]=p)}return typeof c<"u"&&c.strip(),o.strip(),r!=="div"&&e!==0&&o.iushrn(e),{div:c??null,mod:o}}divmod(i,r,e){if(this.assert(!i.isZero()),this.isZero())return{div:new _e(0),mod:new _e(0)};let o,a,l;return this.negative!==0&&i.negative===0?(l=this.neg().divmod(i,r),r!=="mod"&&(o=l.div.neg()),r!=="div"&&(a=l.mod.neg(),e===!0&&a.negative!==0&&a.iadd(i)),{div:o,mod:a}):this.negative===0&&i.negative!==0?(l=this.divmod(i.neg(),r),r!=="mod"&&(o=l.div.neg()),{div:o,mod:l.mod}):(this.negative&i.negative)!==0?(l=this.neg().divmod(i.neg(),r),r!=="div"&&(a=l.mod.neg(),e===!0&&a.negative!==0&&a.isub(i)),{div:l.div,mod:a}):i.length>this.length||this.cmp(i)<0?{div:new _e(0),mod:this}:i.length===1?r==="div"?{div:this.divn(i.words[0]),mod:null}:r==="mod"?{div:null,mod:new _e(this.modrn(i.words[0]))}:{div:this.divn(i.words[0]),mod:new _e(this.modrn(i.words[0]))}:this.wordDiv(i,r)}div(i){return this.divmod(i,"div",!1).div}mod(i){return this.divmod(i,"mod",!1).mod}umod(i){return this.divmod(i,"mod",!0).mod}divRound(i){const r=this.divmod(i);if(r.mod.isZero())return r.div;const e=r.div.negative!==0?r.mod.isub(i):r.mod,o=i.ushrn(1),a=i.andln(1),l=e.cmp(o);return l<0||a===1&&l===0?r.div:r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)}modrn(i){const r=i<0;r&&(i=-i),this.assert(i<=67108863);const e=(1<<26)%i;let o=0;for(let a=this.length-1;a>=0;a--)o=(e*o+(this.words[a]|0))%i;return r?-o:o}idivn(i){const r=i<0;r&&(i=-i),this.assert(i<=67108863);let e=0;for(let o=this.length-1;o>=0;o--){const a=(this.words[o]|0)+e*67108864;this.words[o]=a/i|0,e=a%i}return this.strip(),r?this.ineg():this}divn(i){return this.clone().idivn(i)}egcd(i){this.assert(i.negative===0,"p must not be negative"),this.assert(!i.isZero(),"p must not be zero");let r=this;const e=i.clone();r.negative!==0?r=r.umod(i):r=r.clone();const o=new _e(1),a=new _e(0),l=new _e(0),f=new _e(1);let n=0;for(;r.isEven()&&e.isEven();)r.iushrn(1),e.iushrn(1),++n;const c=e.clone(),d=r.clone();for(;!r.isZero();){let y=0,p=1;for(;(r.words[0]&p)===0&&y<26;++y,p<<=1);if(y>0)for(r.iushrn(y);y-- >0;)(o.isOdd()||a.isOdd())&&(o.iadd(c),a.isub(d)),o.iushrn(1),a.iushrn(1);let g=0,b=1;for(;(e.words[0]&b)===0&&g<26;++g,b<<=1);if(g>0)for(e.iushrn(g);g-- >0;)(l.isOdd()||f.isOdd())&&(l.iadd(c),f.isub(d)),l.iushrn(1),f.iushrn(1);r.cmp(e)>=0?(r.isub(e),o.isub(l),a.isub(f)):(e.isub(r),l.isub(o),f.isub(a))}return{a:l,b:f,gcd:e.iushln(n)}}_invmp(i){this.assert(i.negative===0,"p must not be negative"),this.assert(!i.isZero(),"p must not be zero");let r=this;const e=i.clone();r.negative!==0?r=r.umod(i):r=r.clone();const o=new _e(1),a=new _e(0),l=e.clone();for(;r.cmpn(1)>0&&e.cmpn(1)>0;){let n=0,c=1;for(;(r.words[0]&c)===0&&n<26;++n,c<<=1);if(n>0)for(r.iushrn(n);n-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);let d=0,y=1;for(;(e.words[0]&y)===0&&d<26;++d,y<<=1);if(d>0)for(e.iushrn(d);d-- >0;)a.isOdd()&&a.iadd(l),a.iushrn(1);r.cmp(e)>=0?(r.isub(e),o.isub(a)):(e.isub(r),a.isub(o))}let f;return r.cmpn(1)===0?f=o:f=a,f.cmpn(0)<0&&f.iadd(i),f}gcd(i){if(this.isZero())return i.abs();if(i.isZero())return this.abs();let r=this.clone(),e=i.clone();r.negative=0,e.negative=0;let o=0;for(;r.isEven()&&e.isEven();o++)r.iushrn(1),e.iushrn(1);do{for(;r.isEven();)r.iushrn(1);for(;e.isEven();)e.iushrn(1);const a=r.cmp(e);if(a<0){const l=r;r=e,e=l}else if(a===0||e.cmpn(1)===0)break;r.isub(e)}while(!0);return e.iushln(o)}invm(i){return this.egcd(i).a.umod(i)}isEven(){return(this.words[0]&1)===0}isOdd(){return(this.words[0]&1)===1}andln(i){return this.words[0]&i}bincn(i){this.assert(typeof i=="number");const r=i%26,e=(i-r)/26,o=1<<r;if(this.length<=e)return this.expand(e+1),this.words[e]|=o,this;let a=o,l=e;for(;a!==0&&l<this.length;l++){let f=this.words[l]|0;f+=a,a=f>>>26,f&=67108863,this.words[l]=f}return a!==0&&(this.words[l]=a,this.length++),this}isZero(){return this.length===1&&this.words[0]===0}cmpn(i){const r=i<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();let e;if(this.length>1)e=1;else{r&&(i=-i),this.assert(i<=67108863,"Number is too big");const o=this.words[0]|0;e=o===i?0:o<i?-1:1}return this.negative!==0?-e|0:e}cmp(i){if(this.negative!==0&&i.negative===0)return-1;if(this.negative===0&&i.negative!==0)return 1;const r=this.ucmp(i);return this.negative!==0?-r|0:r}ucmp(i){if(this.length>i.length)return 1;if(this.length<i.length)return-1;let r=0;for(let e=this.length-1;e>=0;e--){const o=this.words[e]|0,a=i.words[e]|0;if(o!==a){o<a?r=-1:o>a&&(r=1);break}}return r}gtn(i){return this.cmpn(i)===1}gt(i){return this.cmp(i)===1}gten(i){return this.cmpn(i)>=0}gte(i){return this.cmp(i)>=0}ltn(i){return this.cmpn(i)===-1}lt(i){return this.cmp(i)===-1}lten(i){return this.cmpn(i)<=0}lte(i){return this.cmp(i)<=0}eqn(i){return this.cmpn(i)===0}eq(i){return this.cmp(i)===0}toRed(i){return this.assert(this.red==null,"Already a number in reduction context"),this.assert(this.negative===0,"red works only with positives"),i.convertTo(this).forceRed(i)}fromRed(){return this.assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)}forceRed(i){return this.red=i,this}redAdd(i){return this.assert(this.red,"redAdd works only with red numbers"),this.red.add(this,i)}redIAdd(i){return this.assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,i)}redSub(i){return this.assert(this.red,"redSub works only with red numbers"),this.red.sub(this,i)}redISub(i){return this.assert(this.red,"redISub works only with red numbers"),this.red.isub(this,i)}redShl(i){return this.assert(this.red,"redShl works only with red numbers"),this.red.shl(this,i)}redMul(i){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,i),this.red.mul(this,i)}redIMul(i){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,i),this.red.imul(this,i)}redSqr(){return this.assert(this.red,"redSqr works only with red numbers"),this.red.verify1(this),this.red.sqr(this)}redISqr(){return this.assert(this.red,"redISqr works only with red numbers"),this.red.verify1(this),this.red.isqr(this)}redSqrt(){return this.assert(this.red,"redSqrt works only with red numbers"),this.red.verify1(this),this.red.sqrt(this)}redInvm(){return this.assert(this.red,"redInvm works only with red numbers"),this.red.verify1(this),this.red.invm(this)}redNeg(){return this.assert(this.red,"redNeg works only with red numbers"),this.red.verify1(this),this.red.neg(this)}redPow(i){return this.assert(this.red!=null&&i.red==null,"redPow(normalNum)"),this.red.verify1(this),this.red.pow(this,i)}static fromHex(i,r){return r==="big"?new _e(i,16):new _e(i,16,"le")}toHex(i=0){return this.toString("hex",i*2)}static fromJSON(i){return new _e(i)}static fromNumber(i){return new _e(i)}static fromString(i,r){return new _e(i,r)}static fromSm(i,r="big"){let e=i;return i.length===0?new _e(0):(r==="little"&&(e=[...e],e=e.reverse()),(e[0]&128)!==0?(e=[...e],e[0]=e[0]&127,new _e(e).neg()):new _e(e))}toSm(i="big"){let r;return this.cmpn(0)===-1?(r=this.neg().toArray(),(r[0]&128)!==0?r=[128,...r]:r[0]=r[0]|128):(r=this.toArray(),(r[0]&128)!==0&&(r=[0,...r])),r.length===1&&r[0]===0&&(r=[]),i==="little"&&(r=r.reverse()),r}static fromBits(i,r=!1){if(i=(i&2147483648)!==0?i-4294967296:i,r&&(i&8388608)!==0)throw new Error("negative bit set");const e=i>>24,o=i&8388607;let a=[o>>24&255,o>>16&255,o>>8&255,o&255];if(e<=3)a=a.slice(1,1+e);else for(let l=0;l<e-3;l++)a.push(0);return(i&8388608)!==0?new _e(a).neg():new _e(a)}toBits(){let i;for(this.ltn(0)?i=this.neg().toArray("be"):i=this.toArray("be");i.length<4;)i.unshift(0);if(i.every(a=>a===0))return 0;for(;i[0]===0;)i.shift();let r=i.length,e=i.slice(0,3).reduce((a,l)=>a*256+l,0);(e&8388608)!==0&&(i.unshift(0),r+=1,e>>>=8);let o=r<<24|e;return this.ltn(0)&&(o|=8388608),o>>>0}static fromScriptNum(i,r,e){if(e===void 0&&(e=Number.MAX_SAFE_INTEGER),i.length>e)throw new Error("script number overflow");if(r===!0&&i.length>0&&(i[i.length-1]&127)===0&&(i.length<=1||(i[i.length-2]&128)===0))throw new Error("non-minimally encoded script number");return _e.fromSm(i,"little")}toScriptNum(){return this.toSm("little")}};return s.zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s.groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],s.groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],s.wordSize=26,Kh.default=s,Kh}var pc={},yc={},gc={},mc={},H_;function IC(){if(H_)return mc;H_=1;var s=mc&&mc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mc,"__esModule",{value:!0});const t=s(ui());let i=class{constructor(e,o){this.name=e,this.p=new t.default(o,16),this.n=this.p.bitLength(),this.k=new t.default(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}_tmp(){const e=new t.default;return e.words=new Array(Math.ceil(this.n/13)),e}ireduce(e){let o=e,a;do this.split(o,this.tmp),o=this.imulK(o),o=o.iadd(this.tmp),a=o.bitLength();while(a>this.n);const l=a<this.n?-1:o.ucmp(this.p);return l===0?(o.words[0]=0,o.length=1):l>0?o.isub(this.p):(o.strip,o.strip()),o}split(e,o){e.iushrn(this.n,0,o)}imulK(e){return e.imul(this.k)}};return mc.default=i,mc}var K_;function kC(){if(K_)return gc;K_=1;var s=gc&&gc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(gc,"__esModule",{value:!0});const t=s(IC());let i=class extends t.default{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}split(e,o){const l=Math.min(e.length,9);let f=0;for(;f<l;f++)o.words[f]=e.words[f];if(o.length=l,e.length<=9){e.words[0]=0,e.length=1;return}let n=e.words[9];for(o.words[o.length++]=n&4194303,f=10;f<e.length;f++){const c=e.words[f]|0;e.words[f-10]=(c&4194303)<<4|n>>>22,n=c}n>>>=22,e.words[f-10]=n,n===0&&e.length>10?e.length-=10:e.length-=9}imulK(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;let o=0;for(let a=0;a<e.length;a++){const l=e.words[a]|0;o+=l*977,e.words[a]=o&67108863,o=l*64+(o/67108864|0)}return e.words[e.length-1]===0&&(e.length--,e.words[e.length-1]===0&&e.length--),e}};return gc.default=i,gc}var V_;function f1(){if(V_)return yc;V_=1;var s=yc&&yc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yc,"__esModule",{value:!0});const t=s(ui()),i=s(kC());let r=class{constructor(o){if(o==="k256"){const a=new i.default;this.m=a.p,this.prime=a}else this.assert(o.gtn(1),"modulus must be greater than 1"),this.m=o,this.prime=null}assert(o,a="Assertion failed"){if(!o)throw new Error(a)}verify1(o){this.assert(o.negative===0,"red works only with positives"),this.assert(o.red,"red works only with red numbers")}verify2(o,a){this.assert((o.negative|a.negative)===0,"red works only with positives"),this.assert(o.red!=null&&o.red===a.red,"red works only with red numbers")}imod(o){return this.prime!=null?this.prime.ireduce(o).forceRed(this):(t.default.move(o,o.umod(this.m).forceRed(this)),o)}neg(o){return o.isZero()?o.clone():this.m.sub(o).forceRed(this)}add(o,a){this.verify2(o,a);const l=o.add(a);return l.cmp(this.m)>=0&&l.isub(this.m),l.forceRed(this)}iadd(o,a){this.verify2(o,a);const l=o.iadd(a);return l.cmp(this.m)>=0&&l.isub(this.m),l}sub(o,a){this.verify2(o,a);const l=o.sub(a);return l.cmpn(0)<0&&l.iadd(this.m),l.forceRed(this)}isub(o,a){this.verify2(o,a);const l=o.isub(a);return l.cmpn(0)<0&&l.iadd(this.m),l}shl(o,a){return this.verify1(o),this.imod(o.ushln(a))}imul(o,a){return this.verify2(o,a),this.imod(o.imul(a))}mul(o,a){return this.verify2(o,a),this.imod(o.mul(a))}isqr(o){return this.imul(o,o.clone())}sqr(o){return this.mul(o,o)}sqrt(o){if(o.isZero())return o.clone();const a=this.m.andln(3);if(this.assert(a%2===1),a===3){const _=this.m.add(new t.default(1)).iushrn(2);return this.pow(o,_)}const l=this.m.subn(1);let f=0;for(;!l.isZero()&&l.andln(1)===0;)f++,l.iushrn(1);this.assert(!l.isZero());const n=new t.default(1).toRed(this),c=n.redNeg(),d=this.m.subn(1).iushrn(1),y=this.m.bitLength(),p=new t.default(2*y*y).toRed(this);for(;this.pow(p,d).cmp(c)!==0;)p.redIAdd(c);let g=this.pow(p,l),b=this.pow(o,l.addn(1).iushrn(1)),w=this.pow(o,l),v=f;for(;w.cmp(n)!==0;){let _=w,S=0;for(;_.cmp(n)!==0;S++)_=_.redSqr();this.assert(S<v);const T=this.pow(g,new t.default(1).iushln(v-S-1));b=b.redMul(T),g=T.redSqr(),w=w.redMul(g),v=S}return b}invm(o){const a=o._invmp(this.m);return a.negative!==0?(a.negative=0,this.imod(a).redNeg()):this.imod(a)}pow(o,a){if(a.isZero())return new t.default(1).toRed(this);if(a.cmpn(1)===0)return o.clone();const l=4,f=new Array(1<<l);f[0]=new t.default(1).toRed(this),f[1]=o;let n=2;for(;n<f.length;n++)f[n]=this.mul(f[n-1],o);let c=f[0],d=0,y=0,p=a.bitLength()%26;for(p===0&&(p=26),n=a.length-1;n>=0;n--){const g=a.words[n];for(let b=p-1;b>=0;b--){const w=g>>b&1;if(c!==f[0]&&(c=this.sqr(c)),w===0&&d===0){y=0;continue}d<<=1,d|=w,y++,!(y!==l&&(n!==0||b!==0))&&(c=this.mul(c,f[d]),y=0,d=0)}p=26}return c}convertTo(o){const a=o.umod(this.m);return a===o?a.clone():a}convertFrom(o){const a=o.clone();return a.red=null,a}};return yc.default=r,yc}var bc={},W_;function EC(){if(W_)return bc;W_=1;var s=bc&&bc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bc,"__esModule",{value:!0});const t=s(f1()),i=s(ui());let r=class extends t.default{constructor(o){super(o),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i.default(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}convertTo(o){return this.imod(o.ushln(this.shift))}convertFrom(o){const a=this.imod(o.mul(this.rinv));return a.red=null,a}imul(o,a){if(o.isZero()||a.isZero())return o.words[0]=0,o.length=1,o;const l=o.imul(a),f=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=l.isub(f).iushrn(this.shift);let c=n;return n.cmp(this.m)>=0?c=n.isub(this.m):n.cmpn(0)<0&&(c=n.iadd(this.m)),c.forceRed(this)}mul(o,a){if(o.isZero()||a.isZero())return new i.default(0).forceRed(this);const l=o.mul(a),f=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=l.isub(f).iushrn(this.shift);let c=n;return n.cmp(this.m)>=0?c=n.isub(this.m):n.cmpn(0)<0&&(c=n.iadd(this.m)),c.forceRed(this)}invm(o){return this.imod(o._invmp(this.m).mul(this.r2)).forceRed(this)}};return bc.default=r,bc}var wc={},vc={},$_;function YT(){if($_)return vc;$_=1;var s=vc&&vc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vc,"__esModule",{value:!0});const t=s(Nr());let i=class{constructor(e){this.curve=new t.default,this.type=e,this.precomputed=null}};return vc.default=i,vc}var xc={},z_;function OC(){if(z_)return xc;z_=1;var s=xc&&xc.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(xc,"__esModule",{value:!0});const t=s(YT()),i=s(ui()),r=s(yu());let e=class yo extends t.default{constructor(a,l,f){super("jacobian"),a===null&&l===null&&f===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i.default(0)):(i.default.isBN(a)||(a=new i.default(a,16)),this.x=a,i.default.isBN(l)||(l=new i.default(l,16)),this.y=l,i.default.isBN(f)||(f=new i.default(f,16)),this.z=f),this.x.red==null&&(this.x=this.x.toRed(this.curve.red)),this.y.red==null&&(this.y=this.y.toRed(this.curve.red)),this.z.red==null&&(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}toP(){if(this.isInfinity())return new r.default(null,null);const a=this.z.redInvm(),l=a.redSqr(),f=this.x.redMul(l),n=this.y.redMul(l).redMul(a);return new r.default(f,n)}neg(){return new yo(this.x,this.y.redNeg(),this.z)}add(a){if(this.isInfinity())return a;if(a.isInfinity())return this;const l=a.z.redSqr(),f=this.z.redSqr(),n=this.x.redMul(l),c=a.x.redMul(f),d=this.y.redMul(l.redMul(a.z)),y=a.y.redMul(f.redMul(this.z)),p=n.redSub(c),g=d.redSub(y);if(p.cmpn(0)===0)return g.cmpn(0)!==0?new yo(null,null,null):this.dbl();const b=p.redSqr(),w=b.redMul(p),v=n.redMul(b),_=g.redSqr().redIAdd(w).redISub(v).redISub(v),S=g.redMul(v.redISub(_)).redISub(d.redMul(w)),T=this.z.redMul(a.z).redMul(p);return new yo(_,S,T)}mixedAdd(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;if(a.x===null||a.y===null)throw new Error("Point coordinates cannot be null");const l=this.z.redSqr(),f=this.x,n=a.x.redMul(l),c=this.y,d=a.y.redMul(l).redMul(this.z),y=f.redSub(n),p=c.redSub(d);if(y.cmpn(0)===0)return p.cmpn(0)!==0?new yo(null,null,null):this.dbl();const g=y.redSqr(),b=g.redMul(y),w=f.redMul(g),v=p.redSqr().redIAdd(b).redISub(w).redISub(w),_=p.redMul(w.redISub(v)).redISub(c.redMul(b)),S=this.z.redMul(y);return new yo(v,_,S)}dblp(a){if(a===0)return this;if(this.isInfinity())return this;if(typeof a>"u")return this.dbl();let l=this;for(let f=0;f<a;f++)l=l.dbl();return l}dbl(){if(this.isInfinity())return this;let a,l,f;if(this.zOne){const n=this.x.redSqr(),c=this.y.redSqr(),d=c.redSqr();let y=this.x.redAdd(c).redSqr().redISub(n).redISub(d);y=y.redIAdd(y);const p=n.redAdd(n).redIAdd(n),g=p.redSqr().redISub(y).redISub(y);let b=d.redIAdd(d);b=b.redIAdd(b),b=b.redIAdd(b),a=g,l=p.redMul(y.redISub(g)).redISub(b),f=this.y.redAdd(this.y)}else{const n=this.x.redSqr(),c=this.y.redSqr(),d=c.redSqr();let y=this.x.redAdd(c).redSqr().redISub(n).redISub(d);y=y.redIAdd(y);const p=n.redAdd(n).redIAdd(n),g=p.redSqr();let b=d.redIAdd(d);b=b.redIAdd(b),b=b.redIAdd(b),a=g.redISub(y).redISub(y),l=p.redMul(y.redISub(a)).redISub(b),f=this.y.redMul(this.z),f=f.redIAdd(f)}return new yo(a,l,f)}eq(a){if(a.type==="affine")return this.eq(a.toJ());if(this===a)return!0;const l=this.z.redSqr();a=a;const f=a.z.redSqr();if(this.x.redMul(f).redISub(a.x.redMul(l)).cmpn(0)!==0)return!1;const n=l.redMul(this.z),c=f.redMul(a.z);return this.y.redMul(c).redISub(a.y.redMul(n)).cmpn(0)===0}eqXToP(a){var l;const f=this.z.redSqr(),n=a.toRed((l=this.curve)===null||l===void 0?void 0:l.red).redMul(f);if(this.x.cmp(n)===0)return!0;const c=a.clone();if(this.curve===null||this.curve.redN==null)throw new Error("Curve or redN is not initialized.");const d=this.curve.redN.redMul(f);for(;c.cmp(this.curve.p)<0;){if(c.iadd(this.curve.n),c.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(d),this.x.cmp(n)===0)return!0}return!1}inspect(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"}isInfinity(){return this.z.cmpn(0)===0}};return xc.default=e,xc}var Sl={},fm={},X_;function li(){return X_||(X_=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.pbkdf2=s.sha512hmac=s.sha256hmac=s.hash160=s.hash256=s.sha512=s.sha256=s.sha1=s.ripemd160=s.SHA512HMAC=s.SHA1HMAC=s.SHA256HMAC=s.SHA512=s.SHA1=s.SHA256=s.RIPEMD160=s.toArray=void 0;const t=(z,G="Hash assertion failed")=>{if(!z)throw new Error(G)};class i{constructor(G,at,ht,lt){this.pending=null,this.pendingTotal=0,this.blockSize=G,this.outSize=at,this.hmacStrength=ht,this.padLength=lt/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}_update(G,at){throw new Error("Not implemented")}_digest(){throw new Error("Not implemented")}_digestHex(){throw new Error("Not implemented")}update(G,at){if(G=e(G,at),this.pending==null?this.pending=G:this.pending=this.pending.concat(G),this.pendingTotal+=G.length,this.pending.length>=this._delta8){G=this.pending;const ht=G.length%this._delta8;this.pending=G.slice(G.length-ht,G.length),this.pending.length===0&&(this.pending=null),G=f(G,0,G.length-ht,this.endian);for(let lt=0;lt<G.length;lt+=this._delta32)this._update(G,lt)}return this}digest(){return this.update(this._pad()),t(this.pending===null),this._digest()}digestHex(){return this.update(this._pad()),t(this.pending===null),this._digestHex()}_pad(){let G=this.pendingTotal;const at=this._delta8,ht=at-(G+this.padLength)%at,lt=new Array(ht+this.padLength);lt[0]=128;let bt;for(bt=1;bt<ht;bt++)lt[bt]=0;G<<=3;let Dt;if(this.endian==="big"){for(Dt=8;Dt<this.padLength;Dt++)lt[bt++]=0;lt[bt++]=0,lt[bt++]=0,lt[bt++]=0,lt[bt++]=0,lt[bt++]=G>>>24&255,lt[bt++]=G>>>16&255,lt[bt++]=G>>>8&255,lt[bt++]=G&255}else for(lt[bt++]=G&255,lt[bt++]=G>>>8&255,lt[bt++]=G>>>16&255,lt[bt++]=G>>>24&255,lt[bt++]=0,lt[bt++]=0,lt[bt++]=0,lt[bt++]=0,Dt=8;Dt<this.padLength;Dt++)lt[bt++]=0;return lt}}function r(z,G){return(z.charCodeAt(G)&64512)!==55296||G<0||G+1>=z.length?!1:(z.charCodeAt(G+1)&64512)===56320}function e(z,G){if(Array.isArray(z))return z.slice();if(!z)return[];const at=[];if(typeof z=="string")if(G!=="hex"){let ht=0;for(let lt=0;lt<z.length;lt++){let bt=z.charCodeAt(lt);bt<128?at[ht++]=bt:bt<2048?(at[ht++]=bt>>6|192,at[ht++]=bt&63|128):r(z,lt)?(bt=65536+((bt&1023)<<10)+(z.charCodeAt(++lt)&1023),at[ht++]=bt>>18|240,at[ht++]=bt>>12&63|128,at[ht++]=bt>>6&63|128,at[ht++]=bt&63|128):(at[ht++]=bt>>12|224,at[ht++]=bt>>6&63|128,at[ht++]=bt&63|128)}}else{z=z.replace(/[^a-z0-9]+/gi,""),z.length%2!==0&&(z="0"+z);for(let ht=0;ht<z.length;ht+=2)at.push(parseInt(z[ht]+z[ht+1],16))}else{z=z;for(let ht=0;ht<z.length;ht++)at[ht]=z[ht]|0}return at}s.toArray=e;function o(z){return(z>>>24|z>>>8&65280|z<<8&16711680|(z&255)<<24)>>>0}function a(z,G){let at="";for(let ht=0;ht<z.length;ht++){let lt=z[ht];G==="little"&&(lt=o(lt)),at+=l(lt.toString(16))}return at}function l(z){return z.length===7?"0"+z:z.length===6?"00"+z:z.length===5?"000"+z:z.length===4?"0000"+z:z.length===3?"00000"+z:z.length===2?"000000"+z:z.length===1?"0000000"+z:z}function f(z,G,at,ht){const lt=at-G;t(lt%4===0);const bt=new Array(lt/4);for(let Dt=0,jt=G;Dt<bt.length;Dt++,jt+=4){let Yt;ht==="big"?Yt=z[jt]<<24|z[jt+1]<<16|z[jt+2]<<8|z[jt+3]:Yt=z[jt+3]<<24|z[jt+2]<<16|z[jt+1]<<8|z[jt],bt[Dt]=Yt>>>0}return bt}function n(z,G){const at=new Array(z.length*4);for(let ht=0,lt=0;ht<z.length;ht++,lt+=4){const bt=z[ht];G==="big"?(at[lt]=bt>>>24,at[lt+1]=bt>>>16&255,at[lt+2]=bt>>>8&255,at[lt+3]=bt&255):(at[lt+3]=bt>>>24,at[lt+2]=bt>>>16&255,at[lt+1]=bt>>>8&255,at[lt]=bt&255)}return at}function c(z,G){return z>>>G|z<<32-G}function d(z,G){return z<<G|z>>>32-G}function y(z,G){return z+G>>>0}function p(z,G,at){return z+G+at>>>0}function g(z,G,at,ht){return z+G+at+ht>>>0}function b(z,G,at,ht,lt){return z+G+at+ht+lt>>>0}function w(z,G,at,ht){if(z===0)return v(G,at,ht);if(z===1||z===3)return S(G,at,ht);if(z===2)return _(G,at,ht)}function v(z,G,at){return z&G^~z&at}function _(z,G,at){return z&G^z&at^G&at}function S(z,G,at){return z^G^at}function T(z){return c(z,2)^c(z,13)^c(z,22)}function I(z){return c(z,6)^c(z,11)^c(z,25)}function k(z){return c(z,7)^c(z,18)^z>>>3}function O(z){return c(z,17)^c(z,19)^z>>>10}const A=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],R=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],P=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],C=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function N(z,G,at,ht){return z<=15?G^at^ht:z<=31?G&at|~G&ht:z<=47?(G|~at)^ht:z<=63?G&ht|at&~ht:G^(at|~ht)}function D(z){return z<=15?0:z<=31?1518500249:z<=47?1859775393:z<=63?2400959708:2840853838}function U(z){return z<=15?1352829926:z<=31?1548603684:z<=47?1836072691:z<=63?2053994217:0}function F(z,G,at,ht){const lt=z[G],bt=z[G+1],Dt=ht+bt>>>0,jt=(Dt<ht?1:0)+at+lt;z[G]=jt>>>0,z[G+1]=Dt}function L(z,G,at,ht){return(G+ht>>>0<G?1:0)+z+at>>>0}function j(z,G,at,ht){return G+ht>>>0}function V(z,G,at,ht,lt,bt,Dt,jt){let Yt=0,te=G;return te=te+ht>>>0,Yt+=te<G?1:0,te=te+bt>>>0,Yt+=te<bt?1:0,te=te+jt>>>0,Yt+=te<jt?1:0,z+at+lt+Dt+Yt>>>0}function W(z,G,at,ht,lt,bt,Dt,jt){return G+ht+bt+jt>>>0}function q(z,G,at,ht,lt,bt,Dt,jt,Yt,te){let oe=0,ee=G;return ee=ee+ht>>>0,oe+=ee<G?1:0,ee=ee+bt>>>0,oe+=ee<bt?1:0,ee=ee+jt>>>0,oe+=ee<jt?1:0,ee=ee+te>>>0,oe+=ee<te?1:0,z+at+lt+Dt+Yt+oe>>>0}function $(z,G,at,ht,lt,bt,Dt,jt,Yt,te){return G+ht+bt+jt+te>>>0}function Y(z,G,at){return(G<<32-at|z>>>at)>>>0}function Q(z,G,at){return(z<<32-at|G>>>at)>>>0}function J(z,G,at){return z>>>at}function vt(z,G,at){return(z<<32-at|G>>>at)>>>0}class wt extends i{constructor(){super(512,160,192,64),this.endian="little",this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}_update(G,at){let ht=this.h[0],lt=this.h[1],bt=this.h[2],Dt=this.h[3],jt=this.h[4],Yt=ht,te=lt,oe=bt,ee=Dt,pe=jt,Bt;for(let ce=0;ce<80;ce++)Bt=y(d(g(ht,N(ce,lt,bt,Dt),G[A[ce]+at],D(ce)),P[ce]),jt),ht=jt,jt=Dt,Dt=d(bt,10),bt=lt,lt=Bt,Bt=y(d(g(Yt,N(79-ce,te,oe,ee),G[R[ce]+at],U(ce)),C[ce]),pe),Yt=pe,pe=ee,ee=d(oe,10),oe=te,te=Bt;Bt=p(this.h[1],bt,ee),this.h[1]=p(this.h[2],Dt,pe),this.h[2]=p(this.h[3],jt,Yt),this.h[3]=p(this.h[4],ht,te),this.h[4]=p(this.h[0],lt,oe),this.h[0]=Bt}_digest(){return n(this.h,"little")}_digestHex(){return a(this.h,"little")}}s.RIPEMD160=wt;class dt extends i{constructor(){super(512,256,192,64),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],this.W=new Array(64)}_update(G,at){const ht=this.W;at===void 0&&(at=0);let lt;for(lt=0;lt<16;lt++)ht[lt]=G[at+lt];for(;lt<ht.length;lt++)ht[lt]=g(O(ht[lt-2]),ht[lt-7],k(ht[lt-15]),ht[lt-16]);let bt=this.h[0],Dt=this.h[1],jt=this.h[2],Yt=this.h[3],te=this.h[4],oe=this.h[5],ee=this.h[6],pe=this.h[7];for(t(this.k.length===ht.length),lt=0;lt<ht.length;lt++){const Bt=b(pe,I(te),v(te,oe,ee),this.k[lt],ht[lt]),ce=y(T(bt),_(bt,Dt,jt));pe=ee,ee=oe,oe=te,te=y(Yt,Bt),Yt=jt,jt=Dt,Dt=bt,bt=y(Bt,ce)}this.h[0]=y(this.h[0],bt),this.h[1]=y(this.h[1],Dt),this.h[2]=y(this.h[2],jt),this.h[3]=y(this.h[3],Yt),this.h[4]=y(this.h[4],te),this.h[5]=y(this.h[5],oe),this.h[6]=y(this.h[6],ee),this.h[7]=y(this.h[7],pe)}_digest(){return n(this.h,"big")}_digestHex(){return a(this.h,"big")}}s.SHA256=dt;class yt extends i{constructor(){super(512,160,80,64),this.k=[1518500249,1859775393,2400959708,3395469782],this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}_update(G,at){const ht=this.W;at===void 0&&(at=0);let lt;for(lt=0;lt<16;lt++)ht[lt]=G[at+lt];for(;lt<ht.length;lt++)ht[lt]=d(ht[lt-3]^ht[lt-8]^ht[lt-14]^ht[lt-16],1);let bt=this.h[0],Dt=this.h[1],jt=this.h[2],Yt=this.h[3],te=this.h[4];for(lt=0;lt<ht.length;lt++){const oe=~~(lt/20),ee=b(d(bt,5),w(oe,Dt,jt,Yt),te,ht[lt],this.k[oe]);te=Yt,Yt=jt,jt=d(Dt,30),Dt=bt,bt=ee}this.h[0]=y(this.h[0],bt),this.h[1]=y(this.h[1],Dt),this.h[2]=y(this.h[2],jt),this.h[3]=y(this.h[3],Yt),this.h[4]=y(this.h[4],te)}_digest(){return n(this.h,"big")}_digestHex(){return a(this.h,"big")}}s.SHA1=yt;class _t extends i{constructor(){super(1024,512,192,128),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],this.W=new Array(160)}_prepareBlock(G,at){const ht=this.W;let lt;for(lt=0;lt<32;lt++)ht[lt]=G[at+lt];for(;lt<ht.length;lt+=2){const bt=K(ht[lt-4],ht[lt-3]),Dt=ut(ht[lt-4],ht[lt-3]),jt=ht[lt-14],Yt=ht[lt-13],te=Jt(ht[lt-30],ht[lt-29]),oe=Ct(ht[lt-30],ht[lt-29]),ee=ht[lt-32],pe=ht[lt-31];ht[lt]=V(bt,Dt,jt,Yt,te,oe,ee,pe),ht[lt+1]=W(bt,Dt,jt,Yt,te,oe,ee,pe)}}_update(G,at){this._prepareBlock(G,at);const ht=this.W;let lt=this.h[0],bt=this.h[1],Dt=this.h[2],jt=this.h[3],Yt=this.h[4],te=this.h[5],oe=this.h[6],ee=this.h[7],pe=this.h[8],Bt=this.h[9],ce=this.h[10],Si=this.h[11],Qe=this.h[12],Re=this.h[13],We=this.h[14],Ti=this.h[15];t(this.k.length===ht.length);for(let Hi=0;Hi<ht.length;Hi+=2){let ps=We,ys=Ti,Ea=Ut(pe,Bt),$n=Vt(pe,Bt);const ko=tt(pe,Bt,ce,Si,Qe),Br=xt(pe,Bt,ce,Si,Qe,Re),Fr=this.k[Hi],Oa=this.k[Hi+1],Lr=ht[Hi],ri=ht[Hi+1],gs=q(ps,ys,Ea,$n,ko,Br,Fr,Oa,Lr,ri),ms=$(ps,ys,Ea,$n,ko,Br,Fr,Oa,Lr,ri);ps=Lt(lt,bt),ys=ne(lt,bt),Ea=It(lt,bt,Dt,jt,Yt),$n=Nt(lt,bt,Dt,jt,Yt,te);const dr=L(ps,ys,Ea,$n),Ur=j(ps,ys,Ea,$n);We=Qe,Ti=Re,Qe=ce,Re=Si,ce=pe,Si=Bt,pe=L(oe,ee,gs,ms),Bt=j(ee,ee,gs,ms),oe=Yt,ee=te,Yt=Dt,te=jt,Dt=lt,jt=bt,lt=L(gs,ms,dr,Ur),bt=j(gs,ms,dr,Ur)}F(this.h,0,lt,bt),F(this.h,2,Dt,jt),F(this.h,4,Yt,te),F(this.h,6,oe,ee),F(this.h,8,pe,Bt),F(this.h,10,ce,Si),F(this.h,12,Qe,Re),F(this.h,14,We,Ti)}_digest(){return n(this.h,"big")}_digestHex(){return a(this.h,"big")}}s.SHA512=_t;function tt(z,G,at,ht,lt,bt){let Dt=z&at^~z&lt;return Dt<0&&(Dt+=4294967296),Dt}function xt(z,G,at,ht,lt,bt){let Dt=G&ht^~G&bt;return Dt<0&&(Dt+=4294967296),Dt}function It(z,G,at,ht,lt,bt){let Dt=z&at^z&lt^at&lt;return Dt<0&&(Dt+=4294967296),Dt}function Nt(z,G,at,ht,lt,bt){let Dt=G&ht^G&bt^ht&bt;return Dt<0&&(Dt+=4294967296),Dt}function Lt(z,G){const at=Y(z,G,28),ht=Y(G,z,2),lt=Y(G,z,7);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function ne(z,G){const at=Q(z,G,28),ht=Q(G,z,2),lt=Q(G,z,7);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function Ut(z,G){const at=Y(z,G,14),ht=Y(z,G,18),lt=Y(G,z,9);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function Vt(z,G){const at=Q(z,G,14),ht=Q(z,G,18),lt=Q(G,z,9);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function Jt(z,G){const at=Y(z,G,1),ht=Y(z,G,8),lt=J(z,G,7);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function Ct(z,G){const at=Q(z,G,1),ht=Q(z,G,8),lt=vt(z,G,7);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function K(z,G){const at=Y(z,G,19),ht=Y(G,z,29),lt=J(z,G,6);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}function ut(z,G){const at=Q(z,G,19),ht=Q(G,z,29),lt=vt(z,G,6);let bt=at^ht^lt;return bt<0&&(bt+=4294967296),bt}class st{constructor(G){this.blockSize=64,this.outSize=32,G=e(G,"hex"),G.length>this.blockSize&&(G=new dt().update(G).digest()),t(G.length<=this.blockSize);let at;for(at=G.length;at<this.blockSize;at++)G.push(0);for(at=0;at<G.length;at++)G[at]^=54;for(this.inner=new dt().update(G),at=0;at<G.length;at++)G[at]^=106;this.outer=new dt().update(G)}update(G,at){return this.inner.update(G,at),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}s.SHA256HMAC=st;class Mt{constructor(G){this.blockSize=64,G=e(G,"hex"),G.length>this.blockSize&&(G=new yt().update(G).digest());let at;for(at=G.length;at<this.blockSize;at++)G.push(0);for(at=0;at<G.length;at++)G[at]^=54;for(this.inner=new yt().update(G),at=0;at<G.length;at++)G[at]^=106;this.outer=new yt().update(G)}update(G,at){return this.inner.update(G,at),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}s.SHA1HMAC=Mt;class Ht{constructor(G){this.blockSize=128,this.outSize=32,G=e(G,"hex"),G.length>this.blockSize&&(G=new _t().update(G).digest()),t(G.length<=this.blockSize);let at;for(at=G.length;at<this.blockSize;at++)G.push(0);for(at=0;at<G.length;at++)G[at]^=54;for(this.inner=new _t().update(G),at=0;at<G.length;at++)G[at]^=106;this.outer=new _t().update(G)}update(G,at){return this.inner.update(G,at),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}s.SHA512HMAC=Ht;const Kt=(z,G)=>new wt().update(z,G).digest();s.ripemd160=Kt;const Xt=(z,G)=>new yt().update(z,G).digest();s.sha1=Xt;const Qt=(z,G)=>new dt().update(z,G).digest();s.sha256=Qt;const Ft=(z,G)=>new _t().update(z,G).digest();s.sha512=Ft;const Rt=(z,G)=>{const at=new dt().update(z,G).digest();return new dt().update(at).digest()};s.hash256=Rt;const St=(z,G)=>{const at=new dt().update(z,G).digest();return new wt().update(at).digest()};s.hash160=St;const Ot=(z,G,at)=>new st(z).update(G,at).digest();s.sha256hmac=Ot;const Wt=(z,G,at)=>new Ht(z).update(G,at).digest();s.sha512hmac=Wt;function Gt(z,G,at,ht,lt="sha512"){if(lt!=="sha512")throw new Error("Only sha512 is supported in this PBKDF2 implementation");const bt=new Array(ht),Dt=[...G,0,0,0,0];let jt=0;const Yt=64,te=Math.ceil(ht/Yt);for(let oe=1;oe<=te;oe++){Dt[G.length]=oe>>24&255,Dt[G.length+1]=oe>>16&255,Dt[G.length+2]=oe>>8&255,Dt[G.length+3]=oe&255;const ee=(0,s.sha512hmac)(z,Dt);let pe=ee;for(let Bt=1;Bt<at;Bt++){pe=(0,s.sha512hmac)(z,pe);for(let ce=0;ce<Yt;ce++)ee[ce]^=pe[ce]}for(let Bt=0;Bt<ee.length;Bt++)bt[jt+Bt]=ee[Bt];jt+=Yt}return bt.slice(0,ht)}s.pbkdf2=Gt}(fm)),fm}var G_;function me(){return G_||(G_=1,function(s){var t=Sl&&Sl.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(s,"__esModule",{value:!0}),s.minimallyEncode=s.Reader=s.Writer=s.fromBase58Check=s.toBase58Check=s.toBase58=s.fromBase58=s.toBase64=s.encode=s.toUTF8=s.toArray=s.toHex=s.zero2=void 0;const i=t(ui()),r=li(),e=I=>I.length%2===1?"0"+I:I;s.zero2=e;const o=I=>{let k="";for(const O of I)k+=(0,s.zero2)(O.toString(16));return k};s.toHex=o;const a=(I,k)=>{if(Array.isArray(I))return I.slice();if(I===void 0)return[];if(typeof I!="string")return Array.from(I,O=>O|0);switch(k){case"hex":return l(I);case"base64":return f(I);default:return n(I)}};s.toArray=a;const l=I=>{I=I.replace(/[^a-z0-9]+/gi,""),I.length%2!==0&&(I="0"+I);const k=[];for(let O=0;O<I.length;O+=2)k.push(parseInt(I[O]+I[O+1],16));return k},f=I=>{const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O=[];let A=0,R=0;for(const P of I.replace(/=+$/,""))A=A<<6|k.indexOf(P),R+=6,R>=8&&(R-=8,O.push(A>>R&255),A&=(1<<R)-1);return O};function n(I){const k=[];for(let O=0;O<I.length;O++){const A=I.codePointAt(O);if(A===void 0)throw new Error(`Index out of range: ${O}`);let R=A;R>65535?O++:R>=55296&&R<=57343&&(R=65533),R<=127?k.push(R):R<=2047?k.push(192|R>>6,128|R&63):R<=65535?k.push(224|R>>12,128|R>>6&63,128|R&63):k.push(240|R>>18,128|R>>12&63,128|R>>6&63,128|R&63)}return k}const c=I=>{let k="",O=0;for(let A=0;A<I.length;A++){const R=I[A];if(O>0){O--;continue}if(R<=127)k+=String.fromCharCode(R);else if(R>=192&&R<=223){const P=I[A+1];O=1;const C=(R&31)<<6|P&63;k+=String.fromCharCode(C)}else if(R>=224&&R<=239){const P=I[A+1],C=I[A+2];O=2;const N=(R&15)<<12|(P&63)<<6|C&63;k+=String.fromCharCode(N)}else if(R>=240&&R<=247){const P=I[A+1],C=I[A+2],N=I[A+3];O=3;const D=(R&7)<<18|(P&63)<<12|(C&63)<<6|N&63,U=55296+(D-65536>>10),F=56320+(D-65536&1023);k+=String.fromCharCode(U,F)}}return k};s.toUTF8=c;const d=(I,k)=>{switch(k){case"hex":return(0,s.toHex)(I);case"utf8":return(0,s.toUTF8)(I);default:return I}};s.encode=d;function y(I){const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let O="",A;for(A=0;A<I.length;A+=3){const R=I[A],P=A+1<I.length?I[A+1]:0,C=A+2<I.length?I[A+2]:0,N=R>>2,D=(R&3)<<4|P>>4,U=(P&15)<<2|C>>6,F=C&63;O+=k.charAt(N)+k.charAt(D),O+=A+1<I.length?k.charAt(U):"=",O+=A+2<I.length?k.charAt(F):"="}return O}s.toBase64=y;const p="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",g=I=>{var k;if(I===""||typeof I!="string")throw new Error(`Expected base58 string but got “${I}”`);const O=I.match(/[IOl0]/gmu);if(O!==null)throw new Error(`Invalid base58 character “${O.join("")}”`);const A=I.match(/^1+/gmu),R=A!==null?A[0].length:0,P=(I.length-R)*(Math.log(58)/Math.log(256))+1>>>0;return[...new Uint8Array([...new Uint8Array(R),...((k=I.match(/./gmu))!==null&&k!==void 0?k:[]).map(N=>p.indexOf(N)).reduce((N,D)=>(N=N.map(U=>{const F=U*58+D;return D=F>>8,F}),N),new Uint8Array(P)).reverse().filter((N=>D=>N=N||D)(!1))])]};s.fromBase58=g;const b=I=>{const k=Array(256).fill(-1);for(let A=0;A<p.length;++A)k[p.charCodeAt(A)]=A;const O=[];for(const A of I){let R=A;for(let P=0;P<O.length;++P){const C=(k[O[P]]<<8)+R;O[P]=p.charCodeAt(C%58),R=C/58|0}for(;R!==0;)O.push(p.charCodeAt(R%58)),R=R/58|0}for(const A of I){if(A!==0)break;O.push(49)}return O.reverse(),String.fromCharCode(...O)};s.toBase58=b;const w=(I,k=[0])=>{let O=(0,r.hash256)([...k,...I]);return O=[...k,...I,...O.slice(0,4)],(0,s.toBase58)(O)};s.toBase58Check=w;const v=(I,k,O=1)=>{const A=(0,s.fromBase58)(I);let R=A.slice(0,O),P=A.slice(O,-4),C=[...R,...P];return C=(0,r.hash256)(C),A.slice(-4).forEach((N,D)=>{if(N!==C[D])throw new Error("Invalid checksum")}),k==="hex"&&(R=(0,s.toHex)(R),P=(0,s.toHex)(P)),{prefix:R,data:P}};s.fromBase58Check=v;class _{constructor(k){this.bufs=k!==void 0?k:[]}getLength(){let k=0;for(const O of this.bufs)k=k+O.length;return k}toArray(){const k=this.getLength(),O=new Array(k);let A=0;for(const R of this.bufs)for(const P of R)O[A++]=P;return O}write(k){return this.bufs.push(k),this}writeReverse(k){const O=new Array(k.length);for(let A=0;A<O.length;A++)O[A]=k[k.length-1-A];return this.bufs.push(O),this}writeUInt8(k){const O=new Array(1);return O[0]=k,this.write(O),this}writeInt8(k){const O=new Array(1);return O[0]=k&255,this.write(O),this}writeUInt16BE(k){return this.bufs.push([k>>8&255,k&255]),this}writeInt16BE(k){return this.writeUInt16BE(k&65535)}writeUInt16LE(k){return this.bufs.push([k&255,k>>8&255]),this}writeInt16LE(k){return this.writeUInt16LE(k&65535)}writeUInt32BE(k){return this.bufs.push([k>>24&255,k>>16&255,k>>8&255,k&255]),this}writeInt32BE(k){return this.writeUInt32BE(k>>>0)}writeUInt32LE(k){return this.bufs.push([k&255,k>>8&255,k>>16&255,k>>24&255]),this}writeInt32LE(k){return this.writeUInt32LE(k>>>0)}writeUInt64BEBn(k){const O=k.toArray("be",8);return this.write(O),this}writeUInt64LEBn(k){const O=k.toArray("be",8);return this.writeReverse(O),this}writeUInt64LE(k){const O=new i.default(k).toArray("be",8);return this.writeReverse(O),this}writeVarIntNum(k){const O=_.varIntNum(k);return this.write(O),this}writeVarIntBn(k){const O=_.varIntBn(k);return this.write(O),this}static varIntNum(k){let O;if(k<253)O=[k];else if(k<65536)O=[253,k&255,k>>8&255];else if(k<4294967296)O=[254,k&255,k>>8&255,k>>16&255,k>>24&255];else{const A=k&4294967295,R=Math.floor(k/4294967296)&4294967295;O=[255,A&255,A>>8&255,A>>16&255,A>>24&255,R&255,R>>8&255,R>>16&255,R>>24&255]}return O}static varIntBn(k){let O;if(k.ltn(253))O=[k.toNumber()];else if(k.ltn(65536)){const A=k.toNumber();O=[253,A&255,A>>8&255]}else if(k.lt(new i.default(4294967296))){const A=k.toNumber();O=[254,A&255,A>>8&255,A>>16&255,A>>24&255]}else{const A=new _;A.writeUInt8(255),A.writeUInt64LEBn(k),O=A.toArray()}return O}}s.Writer=_;class S{constructor(k=[],O=0){this.bin=k,this.pos=O}eof(){return this.pos>=this.bin.length}read(k=this.bin.length){const O=this.pos,A=this.pos+k;return this.pos=A,this.bin.slice(O,A)}readReverse(k=this.bin.length){const O=new Array(k);for(let A=0;A<k;A++)O[A]=this.bin[this.pos+k-1-A];return this.pos+=k,O}readUInt8(){const k=this.bin[this.pos];return this.pos+=1,k}readInt8(){const k=this.bin[this.pos];return this.pos+=1,(k&128)!==0?k-256:k}readUInt16BE(){const k=this.bin[this.pos]<<8|this.bin[this.pos+1];return this.pos+=2,k}readInt16BE(){const k=this.readUInt16BE();return(k&32768)!==0?k-65536:k}readUInt16LE(){const k=this.bin[this.pos]|this.bin[this.pos+1]<<8;return this.pos+=2,k}readInt16LE(){const k=this.readUInt16LE();return(k&32768)!==0?k-65536:k}readUInt32BE(){const k=this.bin[this.pos]*16777216+(this.bin[this.pos+1]<<16|this.bin[this.pos+2]<<8|this.bin[this.pos+3]);return this.pos+=4,k}readInt32BE(){const k=this.readUInt32BE();return(k&2147483648)!==0?k-4294967296:k}readUInt32LE(){const k=(this.bin[this.pos]|this.bin[this.pos+1]<<8|this.bin[this.pos+2]<<16|this.bin[this.pos+3]<<24)>>>0;return this.pos+=4,k}readInt32LE(){const k=this.readUInt32LE();return(k&2147483648)!==0?k-4294967296:k}readUInt64BEBn(){const k=this.bin.slice(this.pos,this.pos+8),O=new i.default(k);return this.pos=this.pos+8,O}readUInt64LEBn(){const k=this.readReverse(8);return new i.default(k)}readVarIntNum(){const k=this.readUInt8();let O;switch(k){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:if(O=this.readUInt64LEBn(),O.lte(new i.default(2).pow(new i.default(53))))return O.toNumber();throw new Error("number too large to retain precision - use readVarIntBn");default:return k}}readVarInt(){switch(this.bin[this.pos]){case 253:return this.read(3);case 254:return this.read(5);case 255:return this.read(9);default:return this.read(1)}}readVarIntBn(){const k=this.readUInt8();switch(k){case 253:return new i.default(this.readUInt16LE());case 254:return new i.default(this.readUInt32LE());case 255:return this.readUInt64LEBn();default:return new i.default(k)}}}s.Reader=S;const T=I=>{if(I.length===0)return I;const k=I[I.length-1];if((k&127)!==0)return I;if(I.length===1)return[];if((I[I.length-2]&128)!==0)return I;for(let O=I.length-1;O>0;O--)if(I[O-1]!==0)return(I[O-1]&128)!==0?(I[O]=k,I.slice(0,O+1)):(I[O-1]|=k,I.slice(0,O));return[]};s.minimallyEncode=T}(Sl)),Sl}var Y_;function yu(){if(Y_)return wc;Y_=1;var s=wc&&wc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(wc,"__esModule",{value:!0});const t=s(YT()),i=s(OC()),r=s(ui()),e=me(),o=s(f1());let a=class Oi extends t.default{static fromDER(f){if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1===2*32){if(f[0]===6){if(f[f.length-1]%2!==0)throw new Error("Point string value is wrong length")}else if(f[0]===7&&f[f.length-1]%2!==1)throw new Error("Point string value is wrong length");return new Oi(f.slice(1,33),f.slice(33,1+2*32))}else if((f[0]===2||f[0]===3)&&f.length-1===32)return Oi.fromX(f.slice(1,33),f[0]===3);throw new Error("Unknown point format")}static fromString(f){const n=(0,e.toArray)(f,"hex");return Oi.fromDER(n)}static redSqrtOptimized(f){const d=Oi.red.m.addn(1).iushrn(2);return f.redPow(d)}static fromX(f,n){if(typeof BigInt=="function"){let p=function(A,R){return(A%R+R)%R},g=function(A,R,P){let C=BigInt(1);for(A=p(A,P);R>BigInt(0);)(R&BigInt(1))===BigInt(1)&&(C=p(C*A,P)),R>>=BigInt(1),A=p(A*A,P);return C},b=function(A,R){const P=R+BigInt(1)>>BigInt(2),C=g(A,P,R);return p(C*C,R)===p(A,R)?C:null};var c=p,d=g,y=b;const w=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),v=BigInt(7);let _;if(f instanceof r.default)_=BigInt("0x"+f.toString(16));else if(typeof f=="string")_=BigInt("0x"+f);else if(Array.isArray(f))_=BigInt("0x"+(0,e.toHex)(f).padStart(64,"0"));else if(typeof f=="number")_=BigInt(f);else throw new Error("Invalid x-coordinate type");_=p(_,w);const S=p(g(_,BigInt(3),w)+v,w);let T=b(S,w);if(T===null)throw new Error("Invalid point");const I=T%BigInt(2)===BigInt(1);(n&&!I||!n&&I)&&(T=w-T);const k=new r.default(_.toString(16),16),O=new r.default(T.toString(16),16);return new Oi(k,O)}else{const p=new o.default("k256"),g=new r.default(0).toRed(p),b=new r.default(7).toRed(p),w=new r.default(0).toRed(p);r.default.isBN(f)||(f=new r.default(f,16)),f=f,f.red==null&&(f=f.toRed(p));const v=f.redSqr().redMul(f).redIAdd(f.redMul(g)).redIAdd(b);let _=v.redSqrt();if(_.redSqr().redSub(v).cmp(w)!==0)throw new Error("invalid point");const S=_.fromRed().isOdd();return(n&&!S||!n&&S)&&(_=_.redNeg()),new Oi(f,_)}}static fromJSON(f,n){typeof f=="string"&&(f=JSON.parse(f));const c=new Oi(f[0],f[1],n);if(typeof f[2]!="object")return c;const d=p=>new Oi(p[0],p[1],n),y=f[2];return c.precomputed={beta:null,doubles:typeof y.doubles=="object"&&y.doubles!==null?{step:y.doubles.step,points:[c].concat(y.doubles.points.map(d))}:void 0,naf:typeof y.naf=="object"&&y.naf!==null?{wnd:y.naf.wnd,points:[c].concat(y.naf.points.map(d))}:void 0},c}constructor(f,n,c=!0){super("affine"),this.precomputed=null,f===null&&n===null?(this.x=null,this.y=null,this.inf=!0):(r.default.isBN(f)||(f=new r.default(f,16)),this.x=f,r.default.isBN(n)||(n=new r.default(n,16)),this.y=n,c&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red===null&&(this.x=this.x.toRed(this.curve.red)),this.y.red===null&&(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}validate(){return this.curve.validate(this)}encode(f=!0,n){const c=this.curve.p.byteLength(),d=this.getX().toArray("be",c);let y;return f?y=[this.getY().isEven()?2:3].concat(d):y=[4].concat(d,this.getY().toArray("be",c)),n!=="hex"?y:(0,e.toHex)(y)}toString(){return this.encode(!0,"hex")}toJSON(){return this.precomputed==null?[this.x,this.y]:[this.x,this.y,typeof this.precomputed=="object"&&this.precomputed!==null?{doubles:this.precomputed.doubles!=null?{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)}:void 0,naf:this.precomputed.naf!=null?{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}:void 0}:void 0]}inspect(){var f,n,c,d,y,p;return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+((c=(n=(f=this.x)===null||f===void 0?void 0:f.fromRed())===null||n===void 0?void 0:n.toString(16,2))!==null&&c!==void 0?c:"undefined")+" y: "+((p=(y=(d=this.y)===null||d===void 0?void 0:d.fromRed())===null||y===void 0?void 0:y.toString(16,2))!==null&&p!==void 0?p:"undefined")+">"}isInfinity(){return this.inf}add(f){var n,c,d,y,p,g,b,w,v,_,S,T;if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return new Oi(new r.default(0),new r.default(0));if(((n=this.x)===null||n===void 0?void 0:n.cmp((c=f.x)!==null&&c!==void 0?c:new r.default(0)))===0)return new Oi(new r.default(0),new r.default(0));let I=(p=(d=this.y)===null||d===void 0?void 0:d.redSub((y=f.y)!==null&&y!==void 0?y:new r.default(0)))!==null&&p!==void 0?p:new r.default(0);I.cmpn(0)!==0&&(I=I.redMul((w=(g=this.x)===null||g===void 0?void 0:g.redSub((b=f.x)!==null&&b!==void 0?b:new r.default(0)).redInvm())!==null&&w!==void 0?w:new r.default(1)));const k=I==null?void 0:I.redSqr().redISub((v=this.x)!==null&&v!==void 0?v:new r.default(0)).redISub((_=f.x)!==null&&_!==void 0?_:new r.default(0)),O=(I??new r.default(1)).redMul(((S=this.x)!==null&&S!==void 0?S:new r.default(0)).redSub(k??new r.default(0))).redISub((T=this.y)!==null&&T!==void 0?T:new r.default(0));return new Oi(k??new r.default(0),O??new r.default(0))}dbl(){var f,n,c,d,y,p,g;if(this.inf)return this;const b=((f=this.y)!==null&&f!==void 0?f:new r.default(0)).redAdd((n=this.y)!==null&&n!==void 0?n:new r.default(0));if(b.cmpn(0)===0)return new Oi(new r.default(0),new r.default(0));const w=this.curve.a,v=((c=this.x)!==null&&c!==void 0?c:new r.default(0)).redSqr(),_=b.redInvm(),S=v.redAdd(v).redIAdd(v).redIAdd(w).redMul(_),T=S.redSqr().redISub(((d=this.x)!==null&&d!==void 0?d:new r.default(0)).redAdd((y=this.x)!==null&&y!==void 0?y:new r.default(0))),I=S.redMul(((p=this.x)!==null&&p!==void 0?p:new r.default(0)).redSub(T)).redISub((g=this.y)!==null&&g!==void 0?g:new r.default(0));return new Oi(T,I)}getX(){var f;return((f=this.x)!==null&&f!==void 0?f:new r.default(0)).fromRed()}getY(){var f;return((f=this.y)!==null&&f!==void 0?f:new r.default(0)).fromRed()}mul(f){return r.default.isBN(f)||(f=new r.default(f,16)),f=f,this.isInfinity()?this:this._hasDoubles(f)?this._fixedNafMul(f):this._endoWnafMulAdd([this],[f])}mulAdd(f,n,c){const d=[this,n],y=[f,c];return this._endoWnafMulAdd(d,y)}jmulAdd(f,n,c){const d=[this,n],y=[f,c];return this._endoWnafMulAdd(d,y,!0)}eq(f){var n,c,d,y;return this===f||this.inf===f.inf&&(this.inf||((n=this.x)!==null&&n!==void 0?n:new r.default(0)).cmp((c=f.x)!==null&&c!==void 0?c:new r.default(0))===0&&((d=this.y)!==null&&d!==void 0?d:new r.default(0)).cmp((y=f.y)!==null&&y!==void 0?y:new r.default(0))===0)}neg(f){var n;if(this.inf)return this;const c=new Oi(this.x,((n=this.y)!==null&&n!==void 0?n:new r.default(0)).redNeg());if(f===!0&&this.precomputed!=null){const d=this.precomputed,y=p=>p.neg();c.precomputed={naf:d.naf!=null?{wnd:d.naf.wnd,points:d.naf.points.map(y)}:void 0,doubles:d.doubles!=null?{step:d.doubles.step,points:d.doubles.points.map(p=>p.neg())}:void 0,beta:void 0}}return c}dblp(f){let n=this;for(let c=0;c<f;c++)n=n.dbl();return n}toJ(){return this.inf?new i.default(null,null,null):new i.default(this.x,this.y,this.curve.one)}_getBeta(){var f;if(typeof this.curve.endo!="object")return;const n=this.precomputed;if(typeof n=="object"&&n!==null&&typeof n.beta=="object"&&n.beta!==null)return n.beta;const c=new Oi(((f=this.x)!==null&&f!==void 0?f:new r.default(0)).redMul(this.curve.endo.beta),this.y);if(n!=null){const d=this.curve,y=p=>{if(p.x===null)throw new Error("p.x is null");if(d.endo===void 0||d.endo===null)throw new Error("curve.endo is undefined");return new Oi(p.x.redMul(d.endo.beta),p.y)};n.beta=c,c.precomputed={beta:null,naf:n.naf!=null?{wnd:n.naf.wnd,points:n.naf.points.map(y)}:void 0,doubles:n.doubles!=null?{step:n.doubles.step,points:n.doubles.points.map(y)}:void 0}}return c}_fixedNafMul(f){if(typeof this.precomputed!="object"||this.precomputed===null)throw new Error("_fixedNafMul requires precomputed values for the point");const n=this._getDoubles(),c=this.curve.getNAF(f,1,this.curve._bitLength);let d=(1<<n.step+1)-(n.step%2===0?2:1);d/=3;const y=[];for(let b=0;b<c.length;b+=n.step){let w=0;for(let v=b+n.step-1;v>=b;v--)w=(w<<1)+c[v];y.push(w)}let p=new i.default(null,null,null),g=new i.default(null,null,null);for(let b=d;b>0;b--){for(let w=0;w<y.length;w++){const v=y[w];v===b?g=g.mixedAdd(n.points[w]):v===-b&&(g=g.mixedAdd(n.points[w].neg()))}p=p.add(g)}return p.toP()}_wnafMulAdd(f,n,c,d,y){var p,g,b,w;const v=this.curve._wnafT1.map(O=>O.toNumber()),_=this.curve._wnafT2.map(()=>[]),S=this.curve._wnafT3.map(()=>[]);let T=0;for(let O=0;O<d;O++){const R=n[O]._getNAFPoints(f);v[O]=R.wnd,_[O]=R.points}for(let O=d-1;O>=1;O-=2){const A=O-1,R=O;if(v[A]!==1||v[R]!==1){S[A]=this.curve.getNAF(c[A],v[A],this.curve._bitLength),S[R]=this.curve.getNAF(c[R],v[R],this.curve._bitLength),T=Math.max(S[A].length,T),T=Math.max(S[R].length,T);continue}const P=[n[A],null,null,n[R]];((p=n[A].y)!==null&&p!==void 0?p:new r.default(0)).cmp((g=n[R].y)!==null&&g!==void 0?g:new r.default(0))===0?(P[1]=n[A].add(n[R]),P[2]=n[A].toJ().mixedAdd(n[R].neg())):((b=n[A].y)!==null&&b!==void 0?b:new r.default(0)).cmp(((w=n[R].y)!==null&&w!==void 0?w:new r.default(0)).redNeg())===0?(P[1]=n[A].toJ().mixedAdd(n[R]),P[2]=n[A].add(n[R].neg())):(P[1]=n[A].toJ().mixedAdd(n[R]),P[2]=n[A].toJ().mixedAdd(n[R].neg()));const C=[-3,-1,-5,-7,0,7,5,1,3],N=this.curve.getJSF(c[A],c[R]);T=Math.max(N[0].length,T),S[A]=new Array(T),S[R]=new Array(T);for(let D=0;D<T;D++){const U=N[0][D]|0,F=N[1][D]|0;S[A][D]=C[(U+1)*3+(F+1)],S[R][D]=0,_[A]=P}}let I=new i.default(null,null,null);const k=this.curve._wnafT4;for(let O=T;O>=0;O--){let A=0;for(;O>=0;){let C=!0;for(let N=0;N<d;N++)k[N]=new r.default(typeof S[N][O]=="number"?S[N][O]:0),k[N].isZero()||(C=!1);if(!C)break;A++,O--}if(O>=0&&A++,I=I.dblp(A),O<0)break;const R=new r.default(1),P=new r.default(2);for(let C=0;C<d;C++){const N=k[C];let D;N.cmpn(0)!==0&&(N.isNeg()?D=_[C][N.neg().sub(R).div(P).toNumber()].neg():D=_[C][N.sub(R).div(P).toNumber()],D.type==="affine"?I=I.mixedAdd(D):I=I.add(D))}}for(let O=0;O<d;O++)_[O]=[];return y===!0?I:I.toP()}_endoWnafMulAdd(f,n,c){var d;const y=new Array(f.length*2),p=new Array(f.length*2);let g;for(g=0;g<f.length;g++){const w=this.curve._endoSplit(n[g]);let v=f[g],_=(d=v._getBeta())!==null&&d!==void 0?d:new Oi(new r.default(0),new r.default(0));w.k1.negative!==0&&(w.k1.ineg(),v=v.neg(!0)),w.k2.negative!==0&&(w.k2.ineg(),_=_.neg(!0)),y[g*2]=v,y[g*2+1]=_,p[g*2]=w.k1,p[g*2+1]=w.k2}const b=this._wnafMulAdd(1,y,p,g*2,c);for(let w=0;w<g*2;w++)y[w]=null,p[w]=null;return b}_hasDoubles(f){if(this.precomputed==null)return!1;const n=this.precomputed.doubles;return typeof n!="object"?!1:n.points.length>=Math.ceil((f.bitLength()+1)/n.step)}_getDoubles(f,n){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.doubles=="object"&&this.precomputed.doubles!==null)return this.precomputed.doubles;const c=[this];let d=this;for(let y=0;y<(n??0);y+=f??1){for(let p=0;p<(f??1);p++)d=d.dbl();c.push(d)}return{step:f??1,points:c}}_getNAFPoints(f){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.naf=="object"&&this.precomputed.naf!==null)return this.precomputed.naf;const n=[this],c=(1<<f)-1,d=c===1?null:this.dbl();for(let y=1;y<c;y++)d!==null&&(n[y]=n[y-1].add(d));return{wnd:f,points:n}}};return a.red=new o.default("k256"),a.a=new r.default(0).toRed(a.red),a.b=new r.default(7).toRed(a.red),a.zero=new r.default(0).toRed(a.red),wc.default=a,wc}var Q_;function Nr(){if(Q_)return pc;Q_=1;var s=pc&&pc.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(pc,"__esModule",{value:!0});const t=s(ui()),i=s(f1()),r=s(EC()),e=s(yu()),o=me();let a,l=class QT{static assert(n,c="Elliptic curve assertion failed"){if(!n)throw new Error(c)}getNAF(n,c,d){const y=new Array(Math.max(n.bitLength(),d)+1);y.fill(0);const p=1<<c+1,g=n.clone();for(let b=0;b<y.length;b++){let w;const v=g.andln(p-1);g.isOdd()?(v>(p>>1)-1?w=(p>>1)-v:w=v,g.isubn(w)):w=0,y[b]=w,g.iushrn(1)}return y}getJSF(n,c){const d=[[],[]];n=n.clone(),c=c.clone();let y=0,p=0;for(;n.cmpn(-y)>0||c.cmpn(-p)>0;){let g=n.andln(3)+y&3,b=c.andln(3)+p&3;g===3&&(g=-1),b===3&&(b=-1);let w;if((g&1)===0)w=0;else{const _=n.andln(7)+y&7;(_===3||_===5)&&b===2?w=-g:w=g}d[0].push(w);let v;if((b&1)===0)v=0;else{const _=c.andln(7)+p&7;(_===3||_===5)&&g===2?v=-b:v=b}d[1].push(v),2*y===w+1&&(y=1-y),2*p===v+1&&(p=1-p),n.iushrn(1),c.iushrn(1)}return d}static cachedProperty(n,c,d){const y="_"+c;n.prototype[c]=function(){return this[y]!==void 0?this[y]:this[y]=d.call(this)}}static parseBytes(n){return typeof n=="string"?(0,o.toArray)(n,"hex"):n}static intFromLE(n){return new t.default(n,"hex","le")}constructor(){if(typeof a<"u")return a;a=this;const c={prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",{doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}]};this.p=new t.default(c.p,16),this.red=new i.default(c.prime),this.zero=new t.default(0).toRed(this.red),this.one=new t.default(1).toRed(this.red),this.two=new t.default(2).toRed(this.red),this.n=new t.default(c.n,16),this.g=e.default.fromJSON(c.g,c.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n.bitLength(),this.redN=this.n.toRed(this.red),this.a=new t.default(c.a,16).toRed(this.red),this.b=new t.default(c.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(c),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}_getEndomorphism(n){var c,d;if(!this.zeroA||this.p.modrn(3)!==1)return;let y,p;if(n.beta!==void 0)y=new t.default(n.beta,16).toRed(this.red);else{const b=this._getEndoRoots(this.p);if(b===null)throw new Error("Failed to get endomorphism roots for beta.");y=b[0].cmp(b[1])<0?b[0]:b[1],y=y.toRed(this.red)}if(n.lambda!==void 0)p=new t.default(n.lambda,16);else{const b=this._getEndoRoots(this.n);if(b===null)throw new Error("Failed to get endomorphism roots for lambda.");if(this.g==null)throw new Error("Curve generator point (g) is not defined.");const w=(c=this.g.mul(b[0]))===null||c===void 0?void 0:c.x,v=this.g.x!=null?this.g.x.redMul(y):void 0;if(w!=null&&v!=null&&w.cmp(v)===0)p=b[0];else{if(p=b[1],this.g==null)throw new Error("Curve generator point (g) is not defined.");const _=(d=this.g.mul(p))===null||d===void 0?void 0:d.x,S=this.g.x!=null?this.g.x.redMul(y):void 0;if(_==null||S==null)throw new Error("Lambda computation failed: g.mul(lambda).x or g.x.redMul(beta) is undefined.");QT.assert(_.cmp(S)===0,"Lambda selection does not match computed beta.")}}let g;return typeof n.basis=="object"&&n.basis!==null?g=n.basis.map(function(b){return{a:new t.default(b.a,16),b:new t.default(b.b,16)}}):g=this._getEndoBasis(p),{beta:y,lambda:p,basis:g}}_getEndoRoots(n){const c=n===this.p?this.red:new r.default(n),d=new t.default(2).toRed(c).redInvm(),y=d.redNeg(),p=new t.default(3).toRed(c).redNeg().redSqrt().redMul(d),g=y.redAdd(p).fromRed(),b=y.redSub(p).fromRed();return[g,b]}_getEndoBasis(n){const c=this.n.ushrn(Math.floor(this.n.bitLength()/2));let d=n,y=this.n.clone(),p=new t.default(1),g=new t.default(0),b=new t.default(0),w=new t.default(1),v,_,S,T,I,k,O=new t.default(0),A=0,R=new t.default(0),P=new t.default(0);for(;d.cmpn(0)!==0;){const D=y.div(d);R=y.sub(D.mul(d)),P=b.sub(D.mul(p));const U=w.sub(D.mul(g));if(S===void 0&&R.cmp(c)<0)v=O.neg(),_=p,S=R.neg(),T=P;else if(S!==void 0&&++A===2)break;O=R,y=d,d=R,b=p,p=P,w=g,g=U}if(v===void 0||_===void 0||S===void 0||T===void 0)throw new Error("Failed to compute Endo Basis values");I=R.neg(),k=P;const C=S.sqr().add(T.sqr());return I.sqr().add(k.sqr()).cmp(C)>=0&&(I=v,k=_),S.negative!==0&&(S=S.neg(),T=T.neg()),I.negative!==0&&(I=I.neg(),k=k.neg()),[{a:S,b:T},{a:I,b:k}]}_endoSplit(n){if(this.endo==null)throw new Error("Endomorphism is not defined.");const c=this.endo.basis,d=c[0],y=c[1],p=y.b.mul(n).divRound(this.n),g=d.b.neg().mul(n).divRound(this.n),b=p.mul(d.a),w=g.mul(y.a),v=p.mul(d.b),_=g.mul(y.b),S=n.sub(b).sub(w),T=v.add(_).neg();return{k1:S,k2:T}}validate(n){if(n.inf)return!0;const c=n.x,d=n.y;if(c===null||d===null)throw new Error("Point coordinates cannot be null");const y=this.a.redMul(c),p=c.redSqr().redMul(c).redIAdd(y).redIAdd(this.b);return d.redSqr().redISub(p).cmpn(0)===0}};return pc.default=l,pc}var _c={},na={},Sc={},Z_;function gu(){if(Z_)return Sc;Z_=1;var s=Sc&&Sc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Sc,"__esModule",{value:!0});const t=s(ui()),i=s(ka()),r=mu(),e=li(),o=me(),a=s(yu()),l=s(Nr());let f=class wb{static fromDER(c,d){const y=(T,I)=>{const k=T[I.place++];if((k&128)===0)return k;throw new Error("Invalid DER entity length")};class p{constructor(){this.place=0}}c=(0,o.toArray)(c,d);const g=new p;if(c[g.place++]!==48)throw new Error("Signature DER must start with 0x30");if(y(c,g)+g.place!==c.length)throw new Error("Signature DER invalid");if(c[g.place++]!==2)throw new Error("Signature DER invalid");const w=y(c,g);let v=c.slice(g.place,w+g.place);if(g.place+=w,c[g.place++]!==2)throw new Error("Signature DER invalid");const _=y(c,g);if(c.length!==_+g.place)throw new Error("Invalid R-length in signature DER");let S=c.slice(g.place,_+g.place);if(v[0]===0)if((v[1]&128)!==0)v=v.slice(1);else throw new Error("Invalid R-value in signature DER");if(S[0]===0)if((S[1]&128)!==0)S=S.slice(1);else throw new Error("Invalid S-value in signature DER");return new wb(new t.default(v),new t.default(S))}static fromCompact(c,d){if(c=(0,o.toArray)(c,d),c.length!==65)throw new Error("Invalid Compact Signature");const y=c[0];if(y<27||y>=35)throw new Error("Invalid Compact Byte");return new wb(new t.default(c.slice(1,33)),new t.default(c.slice(33,65)))}constructor(c,d){this.r=c,this.s=d}verify(c,d,y){const p=new t.default((0,e.sha256)(c,y),16);return(0,r.verify)(p,this,d)}toString(c){return this.toDER(c)}toDER(c){const d=(_,S)=>{if(S<128)_.push(S);else throw new Error("len must be < 0x80")},y=_=>{let S=0;const T=_.length-1;for(;_[S]===0&&(_[S+1]&128)===0&&S<T;)S++;return S===0?_:_.slice(S)};let p=this.r.toArray(),g=this.s.toArray();for((p[0]&128)!==0&&(p=[0].concat(p)),(g[0]&128)!==0&&(g=[0].concat(g)),p=y(p),g=y(g);g[0]===0&&(g[1]&128)===0;)g=g.slice(1);let b=[2];d(b,p.length),b=b.concat(p),b.push(2),d(b,g.length);const w=b.concat(g);let v=[48];return d(v,w.length),v=v.concat(w),c==="hex"?(0,o.toHex)(v):c==="base64"?(0,o.toBase64)(v):v}toCompact(c,d,y){if(c<0||c>3)throw new Error("Invalid recovery param");if(typeof d!="boolean")throw new Error("Invalid compressed param");let p=27+c;d&&(p+=4);let g=[p];return g=g.concat(this.r.toArray("be",32)),g=g.concat(this.s.toArray("be",32)),y==="hex"?(0,o.toHex)(g):y==="base64"?(0,o.toBase64)(g):g}RecoverPublicKey(c,d){const y=this.r,p=this.s,g=(c&1)!==0,b=c>>1,w=new l.default,v=w.n,_=w.g,S=b!==0?y.add(v):y,T=a.default.fromX(S,g);if(!T.mul(v).isInfinity())throw new Error("nR is not at infinity");const k=d.neg().umod(v),O=y.invm(v),A=O.mul(p).umod(v),R=O.mul(k).umod(v),P=_.mul(R).add(T.mul(A)),C=new i.default(P);return C.validate(),C}CalculateRecoveryFactor(c,d){for(let y=0;y<4;y++){let p;try{p=this.RecoverPublicKey(y,d)}catch{continue}if(c.eq(p))return y}throw new Error("Unable to find valid recovery factor")}};return Sc.default=f,Sc}var Vh={},J_;function ZT(){if(J_)return Vh;J_=1,Object.defineProperty(Vh,"__esModule",{value:!0});const s=li(),t=me();let i=class{constructor(e,o){if(e=(0,t.toArray)(e,"hex"),o=(0,t.toArray)(o,"hex"),e.length<32)throw new Error("Not enough entropy. Minimum is 256 bits");const a=e.concat(o);this.K=new Array(32),this.V=new Array(32);for(let l=0;l<32;l++)this.K[l]=0,this.V[l]=1;this.update(a)}hmac(){return new s.SHA256HMAC(this.K)}update(e){let o=this.hmac().update(this.V).update([0]);e!==void 0&&(o=o.update(e)),this.K=o.digest(),this.V=this.hmac().update(this.V).digest(),e!==void 0&&(this.K=this.hmac().update(this.V).update([1]).update(e).digest(),this.V=this.hmac().update(this.V).digest())}generate(e){let o=[];for(;o.length<e;)this.V=this.hmac().update(this.V).digest(),o=o.concat(this.V);const a=o.slice(0,e);return this.update(),(0,t.toHex)(a)}};return Vh.default=i,Vh}var tS;function mu(){if(tS)return na;tS=1;var s=na&&na.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(na,"__esModule",{value:!0}),na.verify=na.sign=void 0;const t=s(ui()),i=s(gu()),r=s(Nr()),e=s(ZT());function o(f,n,c=new r.default){const d=f.byteLength()*8-c.n.bitLength();return d>0&&f.iushrn(d),n===null&&f.cmp(c.n)>=0?f.sub(c.n):f}const a=(f,n,c=!1,d)=>{if(typeof BigInt=="function"){let D=function(dt,yt){const _t=dt.toString(16).padStart(yt*2,"0"),tt=new Uint8Array(yt);for(let xt=0;xt<yt;xt++)tt[xt]=parseInt(_t.substr(xt*2,2),16);return tt},q=function(dt,yt,_t=!0){const tt=dt.toString(2).length,xt=yt.toString(2).length,It=tt-xt;return It>0&&(dt=dt>>BigInt(It)),!_t&&dt>=yt?dt-yt:dt},$=function(dt){if(typeof dt=="function"){const _t=dt(W).toString(16);return BigInt("0x"+_t)}else if(dt!=null&&t.default.isBN(dt)){const yt=dt.toString(16);return BigInt("0x"+yt)}else{const yt=j.generate(U);return BigInt("0x"+yt)}},Y=function(dt,yt){return(dt%yt+yt)%yt},Q=function(dt,yt){let _t=T,tt=S,xt=Y(dt,yt),It=yt;for(;xt>T;){const Nt=It/xt,Lt=tt-_t*Nt,ne=It-xt*Nt;tt=_t,_t=Lt,It=xt,xt=ne}return Y(_t,yt)},J=function(dt,yt){if(dt===null)return yt;if(yt===null)return dt;if(dt.x===yt.x&&dt.y===Y(-yt.y,O))return null;let _t;if(dt.x===yt.x&&dt.y===yt.y){if(dt.y===S)return null;const It=Y(BigInt(3)*dt.x*dt.x,O),Nt=Q(I*dt.y,O);_t=Y(It*Nt,O)}else{const It=Y(yt.y-dt.y,O),Nt=Q(yt.x-dt.x,O);_t=Y(It*Nt,O)}const tt=Y(_t*_t-dt.x-yt.x,O),xt=Y(_t*(dt.x-tt)-dt.y,O);return{x:tt,y:xt}},vt=function(dt,yt){var _t,tt;let xt=yt,It=null;for(;dt>BigInt(0);)dt%BigInt(2)===BigInt(1)&&(It=It===null?xt:(_t=J(It,xt))!==null&&_t!==void 0?_t:It),xt=(tt=J(xt,xt))!==null&&tt!==void 0?tt:xt,dt>>=BigInt(1);if(It===null)throw new Error("Scalar multiplication resulted in an invalid point.");return It};var y=D,p=q,g=$,b=Y,w=Q,v=J,_=vt;const S=BigInt(0),T=BigInt(1),I=BigInt(2),k=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),O=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),A=BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),R=BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"),P={x:A,y:R},C=BigInt("0x"+f.toString(16)),N=BigInt("0x"+n.toString(16));if(N<=S||N>=k)throw new Error("Invalid private key");const U=32,F=D(N,U),L=D(C,U),j=new e.default(Array.from(F),Array.from(L)),V=k-T;let W=0,wt=!1;for(;!wt;){W+=1,wt=!0,W+=1;let dt=$(d);if(dt=q(dt,k,!0),dt<=T||dt>=V){if(d instanceof t.default)throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const yt=vt(dt,P);if(yt===null){if(d instanceof t.default)throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const _t=Y(yt.x,k);if(_t===S){if(d instanceof t.default)throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}const tt=Q(dt,k),xt=Y(_t*N,k);let It=Y(tt*(C+xt),k);if(It===S){if(d instanceof t.default)throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}c&&It>k/I&&(It=k-It);const Nt=new t.default(_t.toString(16),16),Lt=new t.default(It.toString(16),16);return new i.default(Nt,Lt)}}else{const S=new r.default;f=p(f);const T=S.n.byteLength(),I=n.toArray("be",T),k=f.toArray("be",T),O=new e.default(I,k),A=S.n.subn(1);for(let R=0;;R++){let P=typeof d=="function"?d(R):t.default.isBN(d)?d:new t.default(O.generate(T),16);if(P!=null)P=p(P,!0);else throw new Error("k is undefined");if(P.cmpn(1)<=0||P.cmp(A)>=0){if(t.default.isBN(d))throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const C=S.g.mul(P);if(C.isInfinity()){if(t.default.isBN(d))throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const D=C.getX().umod(S.n);if(D.cmpn(0)===0){if(t.default.isBN(d))throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}let U=P.invm(S.n).mul(D.mul(n).iadd(f));if(U=U.umod(S.n),U.cmpn(0)===0){if(t.default.isBN(d))throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}return c&&U.cmp(S.n.ushrn(1))>0&&(U=S.n.sub(U)),new i.default(D,U)}}throw new Error("Failed to generate a valid signature")};na.sign=a;const l=(f,n,c)=>{if(typeof BigInt=="function"){const d=BigInt(0),y=BigInt(1),p=BigInt(2),g=BigInt(3),b=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),w=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),v={x:BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),y:BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8")},_=(F,L)=>(F%L+L)%L,S=(F,L)=>{let[j,V]=[F,L],[W,q]=[BigInt(1),BigInt(0)];for(;V!==d;){const $=j/V;[j,V]=[V,j-$*V],[W,q]=[q,W-$*q]}return j>y?d:_(W,L)},T=(F,L,j)=>_(F*L,j),I=(F,L,j)=>_(F-L,j),k=BigInt(4),O=BigInt(8),A=F=>{const{X:L,Y:j,Z:V}=F;if(j===d)return{X:d,Y:y,Z:d};const W=T(j,j,b),q=T(k,T(L,W,b),b),$=T(g,T(L,L,b),b),Y=I(T($,$,b),T(p,q,b),b),Q=I(T($,I(q,Y,b),b),T(O,T(W,W,b),b),b),J=T(p,T(j,V,b),b);return{X:Y,Y:Q,Z:J}},R=(F,L)=>{if(F.Z===d)return L;if(L.Z===d)return F;const j=T(F.Z,F.Z,b),V=T(L.Z,L.Z,b),W=T(F.X,V,b),q=T(L.X,j,b),$=T(F.Y,T(V,L.Z,b),b),Y=T(L.Y,T(j,F.Z,b),b),Q=I(q,W,b),J=I(Y,$,b);if(Q===d)return J===d?A(F):{X:d,Y:y,Z:d};const vt=T(Q,Q,b),wt=T(Q,vt,b),dt=T(W,vt,b),yt=I(I(T(J,J,b),wt,b),T(p,dt,b),b),_t=I(T(J,I(dt,yt,b),b),T($,wt,b),b),tt=T(Q,T(F.Z,L.Z,b),b);return{X:yt,Y:_t,Z:tt}},P=(F,L)=>{const j={X:L.x,Y:L.y,Z:y};let V={X:d,Y:y,Z:d};const W=F.toString(2);for(let q=0;q<W.length;q++)V=A(V),W[q]==="1"&&(V=R(V,j));return V},C=(F,L,j)=>{const{r:V,s:W}=j,q=F;if(V<=d||V>=w||W<=d||W>=w)return!1;const $=S(W,w);if($===d)return!1;const Y=T(q,$,w),Q=T(V,$,w),J=P(Y,v),vt=P(Q,L),wt=R(J,vt);if(wt.Z===d)return!1;const dt=S(wt.Z,b);if(dt===d)return!1;const yt=T(dt,dt,b),_t=T(wt.X,yt,b);return _(_t,w)===V},N=BigInt("0x"+f.toString(16));if(c.x==null||c.y==null)throw new Error("Invalid public key: missing coordinates.");const D={x:BigInt("0x"+c.x.toString(16)),y:BigInt("0x"+c.y.toString(16))},U={r:BigInt("0x"+n.r.toString(16)),s:BigInt("0x"+n.s.toString(16))};return C(N,D,U)}else{const d=new r.default;f=o(f);const y=n.r,p=n.s;if(y.cmpn(1)<0||y.cmp(d.n)>=0||p.cmpn(1)<0||p.cmp(d.n)>=0)return!1;const g=p.invm(d.n),b=g.mul(f).umod(d.n),w=g.mul(y).umod(d.n),v=d.g.jmulAdd(b,c,w);return v.isInfinity()?!1:v.eqXToP(y)}};return na.verify=l,na}var eS;function ka(){if(eS)return _c;eS=1;var s=_c&&_c.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(_c,"__esModule",{value:!0});const t=s(yu()),i=s(Nr()),r=mu(),e=s(ui()),o=li(),a=s(gu()),l=me();let f=class Hd extends t.default{static fromPrivateKey(c){const y=new i.default().g.mul(c);return new Hd(y.x,y.y)}static fromString(c){const d=t.default.fromString(c);return new Hd(d.x,d.y)}static fromDER(c){const d=t.default.fromDER(c);return new Hd(d.x,d.y)}constructor(c,d=null,y=!0){if(c instanceof t.default)super(c.getX(),c.getY());else{if(d===null&&y&&typeof c=="string"&&(c.length===66||c.length===130))throw new Error('You are using the "new PublicKey()" constructor with a DER hex string. You need to use "PublicKey.fromString()" instead.');super(c,d,y)}}deriveSharedSecret(c){if(!this.validate())throw new Error("Public key not valid for ECDH secret derivation");return this.mul(c)}verify(c,d,y){const p=new e.default((0,o.sha256)(c,y),16);return(0,r.verify)(p,d,this)}toDER(c){return c==="hex"?this.encode(!0,c):this.encode(!0)}toHash(c){const d=(0,o.hash160)(this.encode(!0));return c==="hex"?(0,l.toHex)(d):d}toAddress(c=[0]){if(typeof c=="string")if(c==="testnet"||c==="test")c=[111];else if(c==="mainnet"||c==="main")c=[0];else throw new Error(`Invalid prefix ${c}`);return(0,l.toBase58Check)(this.toHash(),c)}deriveChild(c,d){const y=this.deriveSharedSecret(c),p=(0,l.toArray)(d,"utf8"),g=(0,o.sha256hmac)(y.encode(!0),p),w=new i.default().g.mul(new e.default(g)),v=this.add(w);return new Hd(v.x,v.y)}static fromMsgHashAndCompactSignature(c,d,y){const p=(0,l.toArray)(d,y);if(p.length!==65)throw new Error("Invalid Compact Signature");const g=p[0];if(g<27||g>=35)throw new Error("Invalid Compact Byte");let b=p[0]-27;return b>3&&(b-=4),new a.default(new e.default(p.slice(1,33)),new e.default(p.slice(33,65))).RecoverPublicKey(b,c)}};return _c.default=f,_c}var zi={},Wh={};const AC={},PC=Object.freeze(Object.defineProperty({__proto__:null,default:AC},Symbol.toStringTag,{value:"Module"})),S0=y8(PC);var iS;function ji(){if(iS)return Wh;iS=1,Object.defineProperty(Wh,"__esModule",{value:!0});class s{constructor(){var r;const e=()=>{throw new Error("No secure random number generator is available in this environment.")};if(this._rand=e,typeof self=="object")!((r=self.crypto)===null||r===void 0)&&r.getRandomValues?this._rand=o=>{const a=new Uint8Array(o);return self.crypto.getRandomValues(a),[...a]}:this._rand=e;else try{const o=S0;typeof o.randomBytes=="function"&&(this._rand=a=>[...o.randomBytes(a)])}catch{this._rand=e}}generate(r){return this._rand(r)}}let t=null;return Wh.default=i=>(t==null&&(t=new s),t.generate(i)),Wh}var Ja={},nS;function tI(){if(nS)return Ja;nS=1;var s=Ja&&Ja.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.PointInFiniteField=void 0;const t=s(ui()),i=s(Nr()),r=s(ji()),e=me();class o{constructor(f,n){const c=new i.default().p;this.x=f.umod(c),this.y=n.umod(c)}toString(){return(0,e.toBase58)(this.x.toArray())+"."+(0,e.toBase58)(this.y.toArray())}static fromString(f){const[n,c]=f.split(".");return new o(new t.default((0,e.fromBase58)(n)),new t.default((0,e.fromBase58)(c)))}}Ja.PointInFiniteField=o;let a=class JT{constructor(f,n){this.points=f,this.threshold=n??f.length}static fromPrivateKey(f,n){const c=new i.default().p,d=[new o(new t.default(0),new t.default(f.toArray()))];for(let y=1;y<n;y++){const p=new t.default((0,r.default)(32)).umod(c),g=new t.default((0,r.default)(32)).umod(c);d.push(new o(p,g))}return new JT(d)}valueAt(f){const n=new i.default().p;let c=new t.default(0);for(let d=0;d<this.threshold;d++){let y=this.points[d].y;for(let p=0;p<this.threshold;p++)if(d!==p){const g=this.points[p].x,b=this.points[d].x,w=f.sub(g).umod(n),_=b.sub(g).umod(n).invm(n),S=w.mul(_).umod(n);y=y.mul(S).umod(n)}c=c.add(y).umod(n)}return c}};return Ja.default=a,Ja}var rS;function bu(){if(rS)return zi;rS=1;var s=zi&&zi.__createBinding||(Object.create?function(g,b,w,v){v===void 0&&(v=w);var _=Object.getOwnPropertyDescriptor(b,w);(!_||("get"in _?!b.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return b[w]}}),Object.defineProperty(g,v,_)}:function(g,b,w,v){v===void 0&&(v=w),g[v]=b[w]}),t=zi&&zi.__setModuleDefault||(Object.create?function(g,b){Object.defineProperty(g,"default",{enumerable:!0,value:b})}:function(g,b){g.default=b}),i=zi&&zi.__importStar||function(g){if(g&&g.__esModule)return g;var b={};if(g!=null)for(var w in g)w!=="default"&&Object.prototype.hasOwnProperty.call(g,w)&&s(b,g,w);return t(b,g),b},r=zi&&zi.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(zi,"__esModule",{value:!0}),zi.KeyShares=void 0;const e=r(ui()),o=r(ka()),a=r(Nr()),l=mu(),f=li(),n=r(ji()),c=me(),d=i(tI());class y{constructor(b,w,v){this.points=b,this.threshold=w,this.integrity=v}static fromBackupFormat(b){let w=0,v="";const _=b.map((S,T)=>{const I=S.split(".");if(I.length!==4)throw new Error("Invalid share format in share "+T.toString()+'. Expected format: "x.y.t.i" - received '+S);const[k,O,A,R]=I;if(A===void 0)throw new Error("Threshold not found in share "+T.toString());if(R===void 0)throw new Error("Integrity not found in share "+T.toString());const P=parseInt(A);if(T!==0&&w!==P)throw new Error("Threshold mismatch in share "+T.toString());if(T!==0&&v!==R)throw new Error("Integrity mismatch in share "+T.toString());return w=P,v=R,d.PointInFiniteField.fromString([k,O].join("."))});return new y(_,w,v)}toBackupFormat(){return this.points.map(b=>b.toString()+"."+this.threshold.toString()+"."+this.integrity)}}zi.KeyShares=y;let p=class ga extends e.default{static fromRandom(){return new ga((0,n.default)(32))}static fromString(b,w="hex"){return new ga(super.fromString(b,w).toArray())}static fromHex(b){return new ga(super.fromHex(b,"big"))}static fromWif(b,w=1){const v=(0,c.fromBase58Check)(b,void 0,w);if(v.data.length!==33)throw new Error("Invalid WIF length");if(v.data[32]!==1)throw new Error("Invalid WIF padding");return new ga(v.data.slice(0,32))}constructor(b=0,w=10,v="be",_="apply"){if(b instanceof e.default?(super(),b.copy(this)):super(b,w,v),_!=="nocheck"){const S=this.checkInField();if(!S.inField){if(_==="error")throw new Error("Input is out of field");e.default.move(this,S.modN)}}}checkInField(){const b=new a.default,w=this.mod(b.n);return{inField:this.cmp(w)===0,modN:w}}isValid(){return this.checkInField().inField}sign(b,w,v=!0,_){const S=new e.default((0,f.sha256)(b,w),16);return(0,l.sign)(S,this,v,_)}verify(b,w,v){const _=new e.default((0,f.sha256)(b,v),16);return(0,l.verify)(_,w,this.toPublicKey())}toPublicKey(){const w=new a.default().g.mul(this);return new o.default(w.x,w.y)}toWif(b=[128]){if(!this.isValid())throw new Error("Value is out of field");return(0,c.toBase58Check)([...this.toArray("be",32),1],b)}toAddress(b=[0]){return this.toPublicKey().toAddress(b)}toHex(){return super.toHex(32)}toString(b="hex",w=64){return super.toString(b,w)}deriveSharedSecret(b){if(!b.validate())throw new Error("Public key not valid for ECDH secret derivation");return b.mul(this)}deriveChild(b,w){const v=this.deriveSharedSecret(b),_=(0,c.toArray)(w,"utf8"),S=(0,f.sha256hmac)(v.encode(!0),_),T=new a.default;return new ga(this.add(new e.default(S)).mod(T.n).toArray())}toKeyShares(b,w){if(typeof b!="number"||typeof w!="number")throw new Error("threshold and totalShares must be numbers");if(b<2)throw new Error("threshold must be at least 2");if(w<2)throw new Error("totalShares must be at least 2");if(b>w)throw new Error("threshold should be less than or equal to totalShares");const v=d.default.fromPrivateKey(this,b),_=[];for(let T=0;T<w;T++){const I=new e.default(ga.fromRandom().toArray()),k=v.valueAt(I);_.push(new d.PointInFiniteField(I,k))}const S=this.toPublicKey().toHash("hex").slice(0,8);return new y(_,b,S)}toBackupShares(b,w){return this.toKeyShares(b,w).toBackupFormat()}static fromBackupShares(b){return ga.fromKeyShares(y.fromBackupFormat(b))}static fromKeyShares(b){const{points:w,threshold:v,integrity:_}=b;if(v<2)throw new Error("threshold must be at least 2");if(w.length<v)throw new Error(`At least ${v} shares are required to reconstruct the private key`);for(let k=0;k<v;k++)for(let O=k+1;O<v;O++)if(w[k].x.eq(w[O].x))throw new Error("Duplicate share detected, each must be unique.");const S=new d.default(w,v),T=new ga(S.valueAt(new e.default(0)).toArray());if(T.toPublicKey().toHash("hex").slice(0,8)!==_)throw new Error("Integrity hash mismatch");return T}};return zi.default=p,zi}var Tc={},hm={},aS;function RC(){return aS||(aS=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.AESGCMDecrypt=s.AESGCM=s.ghash=s.incrementLeastSignificantThirtyTwoBits=s.multiply=s.rightShift=s.exclusiveOR=s.getBytes=s.checkBit=s.AES=void 0;const t=[[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118],[202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192],[183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21],[4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117],[9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132],[83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207],[208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168],[81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210],[205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115],[96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219],[224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121],[231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8],[186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138],[112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158],[225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223],[140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]],i=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];function r(A,R,P){let C,N;for(C=0;C<4;C++)for(N=0;N<4;N++)A[C][N]=A[C][N]^R[P+N][C]}function e(A){let R,P;for(R=0;R<4;R++)for(P=0;P<4;P++)A[R][P]=t[(A[R][P]&240)>>4][A[R][P]&15]}function o(A){let R;for(R=0;R<4;R++)A[R]=t[(A[R]&240)>>4][A[R]&15]}function a(A){const R=A[0];A[0]=A[1],A[1]=A[2],A[2]=A[3],A[3]=R}function l(A){let R,P,C,N,D;for(R=1;R<4;R++)for(P=0;P<(R-1)%2+1;P++){for(D=A[R][P],C=P;N=C+R,N>=4&&(N=N-4),N!==P;)A[R][C]=A[R][N],C=N;A[R][C]=D}}function f(A,R){let P,C=0;for(P=0;P<8;P++)(R&1)!==0&&(C=C^A),(A&128)!==0?(A=A<<1,A=A^283):A=A<<1,R=R>>1;return C}function n(A){let R,P;const C=[[],[],[],[]];for(R=0;R<4;R++)C[0][R]=f(2,A[0][R])^f(3,A[1][R])^A[2][R]^A[3][R],C[1][R]=A[0][R]^f(2,A[1][R])^f(3,A[2][R])^A[3][R],C[2][R]=A[0][R]^A[1][R]^f(2,A[2][R])^f(3,A[3][R]),C[3][R]=f(3,A[0][R])^A[1][R]^A[2][R]^f(2,A[3][R]);for(R=0;R<4;R++)for(P=0;P<4;P++)A[R][P]=C[R][P]}function c(A,R){let P,C;const N=parseInt(String(R.length/4)),D=[];for(P=0;P<R.length;P++)P%4===0&&D.push([]),D[parseInt(String(P/4))].push(R[P]);for(P=N;P<4*A;P++){D[P]=[];const U=D[P-1].slice();if(P%N===0)for(a(U),o(U),C=0;C<4;C++)U[C]=U[C]^i[parseInt(String(P/N))][C];else N>6&&P%N===4&&o(U);for(C=0;C<4;C++)D[P][C]=D[P-N][C]^U[C]}return D}function d(A,R){let P,C,N,D;const U=[[],[],[],[]],F=[],L=Array.from(R);if(L.length<=16){for(;L.length<16;)L.unshift(0);D=11}else if(L.length<=24){for(;L.length<24;)L.unshift(0);D=13}else if(R.length<=32){for(;L.length<32;)L.unshift(0);D=15}else throw new Error("Illegal key length: "+String(R.length));const j=c(D,L);for(P=0;P<15;P++)U[parseInt(String(P/4))].push(A[P*4%15]);for(U[3].push(A[15]),r(U,j,0),N=1;N<D;N++)e(U),l(U),N+1<D&&n(U),r(U,j,N*4);for(P=0;P<4;P++)for(C=0;C<4;C++)F.push(U[C][P]);return F}s.AES=d;const y=function(A,R,P){return(A[R]&1<<P)!==0?1:0};s.checkBit=y;const p=function(A){return[(A&4278190080)>>>24,(A&16711680)>>16,(A&65280)>>8,A&255]};s.getBytes=p;const g=function(A){let R;const P=[];for(R=0;R<A;R++)P.push(0);return P},b=[225].concat(g(15)),w=function(A,R){let P;const C=[];for(P=0;P<A.length;P++)C[P]=A[P]^R[P];return C};s.exclusiveOR=w;const v=function(A){let R,P=0,C=0;for(R=0;R<A.length;R++)C=P,P=A[R]&1,A[R]=A[R]>>1,C!==0&&(A[R]=A[R]|128);return A};s.rightShift=v;const _=function(A,R){let P,C,N=R.slice(),D=g(16);for(P=0;P<16;P++)for(C=7;C!==-1;C--)(0,s.checkBit)(A,P,C)!==0&&(D=(0,s.exclusiveOR)(D,N)),(0,s.checkBit)(N,15,0)!==0?N=(0,s.exclusiveOR)((0,s.rightShift)(N),b):N=(0,s.rightShift)(N);return D};s.multiply=_;const S=function(A){let R;const P=A.slice();for(R=15;R!==11&&(P[R]=P[R]+1,P[R]===256);R--)P[R]=0;return P};s.incrementLeastSignificantThirtyTwoBits=S;function T(A,R){let P,C=g(16);for(P=0;P<A.length;P+=16)C=(0,s.multiply)((0,s.exclusiveOR)(C,A.slice(P,Math.min(P+16,A.length))),R);return C}s.ghash=T;function I(A,R,P){let C,N,D,U=R;const F=[];if(A.length===0)return A;const L=Math.ceil(A.length/16);for(C=0;C<L;C++){for(D=(0,s.exclusiveOR)(A.slice(C*16,Math.min((C+1)*16,A.length)),d(U,P)),N=0;N<D.length;N++)F.push(D[N]);C+1<L&&(U=(0,s.incrementLeastSignificantThirtyTwoBits)(U))}return F}function k(A,R,P,C){let N,D;const U=d(g(16),C);N=[...P],P.length===12?N=N.concat(g(3)).concat([1]):(P.length%16!==0&&(N=N.concat(g(16-P.length%16))),N=N.concat(g(8)),N=T(N.concat(g(4)).concat((0,s.getBytes)(P.length*8)),U));const F=I(A,(0,s.incrementLeastSignificantThirtyTwoBits)(N),C);return D=R.slice(),R.length===0?D=D.concat(g(16)):R.length%16!==0&&(D=D.concat(g(16-R.length%16))),D=D.concat(F),F.length===0?D=D.concat(g(16)):F.length%16!==0&&(D=D.concat(g(16-F.length%16))),D=D.concat(g(4)).concat((0,s.getBytes)(R.length*8)).concat(g(4)).concat((0,s.getBytes)(F.length*8)),{result:F,authenticationTag:I(T(D,U),N,C)}}s.AESGCM=k;function O(A,R,P,C,N){let D,U;const F=d(g(16),N);D=[...P],P.length===12?D=D.concat(g(3)).concat([1]):(P.length%16!==0&&(D=D.concat(g(16-P.length%16))),D=D.concat(g(8)),D=T(D.concat(g(4)).concat((0,s.getBytes)(P.length*8)),F));const L=I(A,(0,s.incrementLeastSignificantThirtyTwoBits)(D),N);return U=R.slice(),R.length===0?U=U.concat(g(16)):R.length%16!==0&&(U=U.concat(g(16-R.length%16))),U=U.concat(A),A.length===0?U=U.concat(g(16)):A.length%16!==0&&(U=U.concat(g(16-A.length%16))),U=U.concat(g(4)).concat((0,s.getBytes)(R.length*8)).concat(g(4)).concat((0,s.getBytes)(A.length*8)),I(T(U,F),D,N).join()!==C.join()?null:L}s.AESGCMDecrypt=O}(hm)),hm}var sS;function T0(){if(sS)return Tc;sS=1;var s=Tc&&Tc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Tc,"__esModule",{value:!0});const t=s(ui()),i=RC(),r=s(ji()),e=me();let o=class eI extends t.default{static fromRandom(){return new eI((0,r.default)(32))}encrypt(l,f){const n=(0,r.default)(32);l=(0,e.toArray)(l,f);const{result:c,authenticationTag:d}=(0,i.AESGCM)(l,[],n,this.toArray("be",32));return(0,e.encode)([...n,...c,...d],f)}decrypt(l,f){l=(0,e.toArray)(l,f);const n=l.slice(0,32),c=l.slice(32),d=c.slice(-16),y=c.slice(0,-16),p=(0,i.AESGCMDecrypt)(y,[],n,d,this.toArray());if(p===null)throw new Error("Decryption failed!");return(0,e.encode)(p,f)}};return Tc.default=o,Tc}var kn={},oS;function I0(){if(oS)return kn;oS=1;var s=kn&&kn.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),t=kn&&kn.__setModuleDefault||(Object.create?function(n,c){Object.defineProperty(n,"default",{enumerable:!0,value:c})}:function(n,c){n.default=c}),i=kn&&kn.__importStar||function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var d in n)d!=="default"&&Object.prototype.hasOwnProperty.call(n,d)&&s(c,n,d);return t(c,n),c},r=kn&&kn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(kn,"__esModule",{value:!0});const e=r(gu()),o=r(ui()),a=i(li()),l=me();let f=class wr extends e.default{static format(c){const d={sourceTXID:c.sourceTXID,sourceOutputIndex:c.sourceOutputIndex,sequence:c.inputSequence},y=[...c.otherInputs];y.splice(c.inputIndex,0,d);const p=()=>{const O=new l.Writer;for(const P of y){if(typeof P.sourceTXID>"u"){if(P.sourceTransaction==null)throw new Error("Missing sourceTransaction for input");O.write(P.sourceTransaction.hash())}else O.writeReverse((0,l.toArray)(P.sourceTXID,"hex"));O.writeUInt32LE(P.sourceOutputIndex)}const A=O.toArray();return a.hash256(A)},g=()=>{var O;const A=new l.Writer;for(const C of y){const N=(O=C.sequence)!==null&&O!==void 0?O:4294967295;A.writeUInt32LE(N)}const R=A.toArray();return a.hash256(R)};function b(O){var A,R,P,C,N,D;const U=new l.Writer;if(typeof O>"u")for(const j of c.outputs){const V=(A=j.satoshis)!==null&&A!==void 0?A:0;U.writeUInt64LE(V);const W=(P=(R=j.lockingScript)===null||R===void 0?void 0:R.toBinary())!==null&&P!==void 0?P:[];U.writeVarIntNum(W.length),U.write(W)}else{const j=c.outputs[O];if(j===void 0)throw new Error(`Output at index ${O} does not exist`);const V=(C=j.satoshis)!==null&&C!==void 0?C:0;U.writeUInt64LE(V);const W=(D=(N=j.lockingScript)===null||N===void 0?void 0:N.toBinary())!==null&&D!==void 0?D:[];U.writeVarIntNum(W.length),U.write(W)}const F=U.toArray();return a.hash256(F)}let w=new Array(32).fill(0),v=new Array(32).fill(0),_=new Array(32).fill(0);(c.scope&wr.SIGHASH_ANYONECANPAY)===0&&(w=p()),(c.scope&wr.SIGHASH_ANYONECANPAY)===0&&(c.scope&31)!==wr.SIGHASH_SINGLE&&(c.scope&31)!==wr.SIGHASH_NONE&&(v=g()),(c.scope&31)!==wr.SIGHASH_SINGLE&&(c.scope&31)!==wr.SIGHASH_NONE?_=b():(c.scope&31)===wr.SIGHASH_SINGLE&&c.inputIndex<c.outputs.length&&(_=b(c.inputIndex));const S=new l.Writer;S.writeInt32LE(c.transactionVersion),S.write(w),S.write(v),S.writeReverse((0,l.toArray)(c.sourceTXID,"hex")),S.writeUInt32LE(c.sourceOutputIndex);const T=c.subscript.toBinary();S.writeVarIntNum(T.length),S.write(T),S.writeUInt64LE(c.sourceSatoshis);const I=d.sequence;return S.writeUInt32LE(I),S.write(_),S.writeUInt32LE(c.lockTime),S.writeUInt32LE(c.scope>>>0),S.toArray()}static fromChecksigFormat(c){if(c.length===0){const g=new o.default(1),b=new o.default(1),w=1;return new wr(g,b,w)}const d=c[c.length-1],y=c.slice(0,c.length-1),p=e.default.fromDER(y);return new wr(p.r,p.s,d)}constructor(c,d,y){super(c,d),this.scope=y}hasLowS(){return!(this.s.ltn(1)||this.s.gt(new o.default("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))}toChecksigFormat(){return[...this.toDER(),this.scope]}};return f.SIGHASH_ALL=1,f.SIGHASH_NONE=2,f.SIGHASH_SINGLE=3,f.SIGHASH_FORKID=64,f.SIGHASH_ANYONECANPAY=128,kn.default=f,kn}var Ic={},cS;function MC(){if(cS)return Ic;cS=1;var s=Ic&&Ic.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ic,"__esModule",{value:!0});const t=s(ui()),i=s(Nr()),r=li(),e=Cr();let o=class{constructor(){this.curve=new i.default}generateProof(l,f,n,c){const d=e.PrivateKey.fromRandom(),y=d.toPublicKey(),p=n.mul(d),g=this.computeChallenge(f,n,c,p,y),b=d.add(g.mul(l)).umod(this.curve.n);return{R:y,SPrime:p,z:b}}verifyProof(l,f,n,c){const{R:d,SPrime:y,z:p}=c,g=this.computeChallenge(l,f,n,y,d),b=this.curve.g.mul(p),w=d.add(l.mul(g));if(!b.eq(w))return!1;const v=f.mul(p),_=y.add(n.mul(g));return!!v.eq(_)}computeChallenge(l,f,n,c,d){const y=[...l.encode(!0),...f.encode(!0),...n.encode(!0),...c.encode(!0),...d.encode(!0)],p=(0,r.sha256)(y);return new t.default(p).umod(this.curve.n)}};return Ic.default=o,Ic}var uS;function Cr(){return uS||(uS=1,function(s){var t=Qn&&Qn.__createBinding||(Object.create?function(v,_,S,T){T===void 0&&(T=S);var I=Object.getOwnPropertyDescriptor(_,S);(!I||("get"in I?!_.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return _[S]}}),Object.defineProperty(v,T,I)}:function(v,_,S,T){T===void 0&&(T=S),v[T]=_[S]}),i=Qn&&Qn.__setModuleDefault||(Object.create?function(v,_){Object.defineProperty(v,"default",{enumerable:!0,value:_})}:function(v,_){v.default=_}),r=Qn&&Qn.__importStar||function(v){if(v&&v.__esModule)return v;var _={};if(v!=null)for(var S in v)S!=="default"&&Object.prototype.hasOwnProperty.call(v,S)&&t(_,v,S);return i(_,v),_},e=Qn&&Qn.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(s,"__esModule",{value:!0}),s.Schnorr=s.PointInFiniteField=s.Polynomial=s.TransactionSignature=s.Random=s.Hash=s.Utils=s.ECDSA=s.DRBG=s.SymmetricKey=s.KeyShares=s.PrivateKey=s.Signature=s.PublicKey=s.Point=s.Curve=s.BigNumber=void 0;var o=ui();Object.defineProperty(s,"BigNumber",{enumerable:!0,get:function(){return e(o).default}});var a=Nr();Object.defineProperty(s,"Curve",{enumerable:!0,get:function(){return e(a).default}});var l=yu();Object.defineProperty(s,"Point",{enumerable:!0,get:function(){return e(l).default}});var f=ka();Object.defineProperty(s,"PublicKey",{enumerable:!0,get:function(){return e(f).default}});var n=gu();Object.defineProperty(s,"Signature",{enumerable:!0,get:function(){return e(n).default}});var c=bu();Object.defineProperty(s,"PrivateKey",{enumerable:!0,get:function(){return e(c).default}}),Object.defineProperty(s,"KeyShares",{enumerable:!0,get:function(){return c.KeyShares}});var d=T0();Object.defineProperty(s,"SymmetricKey",{enumerable:!0,get:function(){return e(d).default}});var y=ZT();Object.defineProperty(s,"DRBG",{enumerable:!0,get:function(){return e(y).default}}),s.ECDSA=r(mu()),s.Utils=r(me()),s.Hash=r(li());var p=ji();Object.defineProperty(s,"Random",{enumerable:!0,get:function(){return e(p).default}});var g=I0();Object.defineProperty(s,"TransactionSignature",{enumerable:!0,get:function(){return e(g).default}});var b=tI();Object.defineProperty(s,"Polynomial",{enumerable:!0,get:function(){return e(b).default}}),Object.defineProperty(s,"PointInFiniteField",{enumerable:!0,get:function(){return b.PointInFiniteField}});var w=MC();Object.defineProperty(s,"Schnorr",{enumerable:!0,get:function(){return e(w).default}})}(Qn)),Qn}var ra={},$h={},lS;function gf(){if(lS)return $h;lS=1,Object.defineProperty($h,"__esModule",{value:!0});const s={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_SPLIT:127,OP_LEFT:128,OP_NUM2BIN:128,OP_RIGHT:129,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_NOP11:186,OP_NOP12:187,OP_NOP13:188,OP_NOP14:189,OP_NOP15:190,OP_NOP16:191,OP_NOP17:192,OP_NOP18:193,OP_NOP19:194,OP_NOP20:195,OP_NOP21:196,OP_NOP22:197,OP_NOP23:198,OP_NOP24:199,OP_NOP25:200,OP_NOP26:201,OP_NOP27:202,OP_NOP28:203,OP_NOP29:204,OP_NOP30:205,OP_NOP31:206,OP_NOP32:207,OP_NOP33:208,OP_NOP34:209,OP_NOP35:210,OP_NOP36:211,OP_NOP37:212,OP_NOP38:213,OP_NOP39:214,OP_NOP40:215,OP_NOP41:216,OP_NOP42:217,OP_NOP43:218,OP_NOP44:219,OP_NOP45:220,OP_NOP46:221,OP_NOP47:222,OP_NOP48:223,OP_NOP49:224,OP_NOP50:225,OP_NOP51:226,OP_NOP52:227,OP_NOP53:228,OP_NOP54:229,OP_NOP55:230,OP_NOP56:231,OP_NOP57:232,OP_NOP58:233,OP_NOP59:234,OP_NOP60:235,OP_NOP61:236,OP_NOP62:237,OP_NOP63:238,OP_NOP64:239,OP_NOP65:240,OP_NOP66:241,OP_NOP67:242,OP_NOP68:243,OP_NOP69:244,OP_NOP70:245,OP_NOP71:246,OP_NOP72:247,OP_NOP73:248,OP_NOP77:252,OP_SMALLDATA:249,OP_SMALLINTEGER:250,OP_PUBKEYS:251,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};for(const t in s)s[s[t]]=t;return $h.default=s,$h}var kc={},dS;function mf(){if(dS)return kc;dS=1;var s=kc&&kc.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(kc,"__esModule",{value:!0});const t=s(gf()),i=me(),r=s(ui());let e=class Gc{static fromASM(a){const l=[],f=a.split(" ");let n=0;for(;n<f.length;){const c=f[n];let d,y=0;if(c.startsWith("OP_")&&typeof t.default[c]<"u"&&(d=c,y=t.default[c]),c==="0")y=0,l.push({op:y}),n=n+1;else if(c==="-1")y=t.default.OP_1NEGATE,l.push({op:y}),n=n+1;else if(d===void 0){let p=f[n];p.length%2!==0&&(p="0"+p);const g=(0,i.toArray)(p,"hex");if((0,i.encode)(g,"hex")!==p)throw new Error("invalid hex string in script");const b=g.length;b>=0&&b<t.default.OP_PUSHDATA1?y=b:b<Math.pow(2,8)?y=t.default.OP_PUSHDATA1:b<Math.pow(2,16)?y=t.default.OP_PUSHDATA2:b<Math.pow(2,32)&&(y=t.default.OP_PUSHDATA4),l.push({data:g,op:y}),n=n+1}else y===t.default.OP_PUSHDATA1||y===t.default.OP_PUSHDATA2||y===t.default.OP_PUSHDATA4?(l.push({data:(0,i.toArray)(f[n+2],"hex"),op:y}),n=n+3):(l.push({op:y}),n=n+1)}return new Gc(l)}static fromHex(a){if(a.length===0)return Gc.fromBinary([]);if(a.length%2!==0)throw new Error("There is an uneven number of characters in the string which suggests it is not hex encoded.");if(!/^[0-9a-fA-F]+$/.test(a))throw new Error("Some elements in this string are not hex encoded.");return Gc.fromBinary((0,i.toArray)(a,"hex"))}static fromBinary(a){a=[...a];const l=[],f=new i.Reader(a);for(;!f.eof();){const n=f.readUInt8();let c=0,d=[];if(n>0&&n<t.default.OP_PUSHDATA1)c=n,l.push({data:f.read(c),op:n});else if(n===t.default.OP_PUSHDATA1){try{c=f.readUInt8(),d=f.read(c)}catch{f.read()}l.push({data:d,op:n})}else if(n===t.default.OP_PUSHDATA2){try{c=f.readUInt16LE(),d=f.read(c)}catch{f.read()}l.push({data:d,op:n})}else if(n===t.default.OP_PUSHDATA4){try{c=f.readUInt32LE(),d=f.read(c)}catch{f.read()}l.push({data:d,op:n})}else l.push({op:n})}return new Gc(l)}constructor(a=[]){this.chunks=a}toASM(){let a="";for(let l=0;l<this.chunks.length;l++){const f=this.chunks[l];a+=this._chunkToString(f)}return a.slice(1)}toHex(){return(0,i.encode)(this.toBinary(),"hex")}toBinary(){const a=new i.Writer;for(let l=0;l<this.chunks.length;l++){const f=this.chunks[l],n=f.op;a.writeUInt8(n),f.data!=null&&(n<t.default.OP_PUSHDATA1?a.write(f.data):n===t.default.OP_PUSHDATA1?(a.writeUInt8(f.data.length),a.write(f.data)):n===t.default.OP_PUSHDATA2?(a.writeUInt16LE(f.data.length),a.write(f.data)):n===t.default.OP_PUSHDATA4&&(a.writeUInt32LE(f.data.length),a.write(f.data)))}return a.toArray()}writeScript(a){return this.chunks=this.chunks.concat(a.chunks),this}writeOpCode(a){return this.chunks.push({op:a}),this}setChunkOpCode(a,l){return this.chunks[a]={op:l},this}writeBn(a){if(a.cmpn(0)===t.default.OP_0)this.chunks.push({op:t.default.OP_0});else if(a.cmpn(-1)===0)this.chunks.push({op:t.default.OP_1NEGATE});else if(a.cmpn(1)>=0&&a.cmpn(16)<=0)this.chunks.push({op:a.toNumber()+t.default.OP_1-1});else{const l=a.toSm("little");this.writeBin(l)}return this}writeBin(a){let l;if(a.length>0&&a.length<t.default.OP_PUSHDATA1)l=a.length;else if(a.length===0)l=t.default.OP_0;else if(a.length<Math.pow(2,8))l=t.default.OP_PUSHDATA1;else if(a.length<Math.pow(2,16))l=t.default.OP_PUSHDATA2;else if(a.length<Math.pow(2,32))l=t.default.OP_PUSHDATA4;else throw new Error("You can't push that much data");return this.chunks.push({data:a,op:l}),this}writeNumber(a){return this.writeBn(new r.default(a)),this}removeCodeseparators(){const a=[];for(let l=0;l<this.chunks.length;l++)this.chunks[l].op!==t.default.OP_CODESEPARATOR&&a.push(this.chunks[l]);return this.chunks=a,this}findAndDelete(a){const l=a.toHex();for(let f=0;f<this.chunks.length;f++){const c=new Gc([this.chunks[f]]).toHex();l===c&&this.chunks.splice(f,1)}return this}isPushOnly(){for(let a=0;a<this.chunks.length;a++)if(this.chunks[a].op>t.default.OP_16)return!1;return!0}isLockingScript(){throw new Error("Not implemented")}isUnlockingScript(){throw new Error("Not implemented")}_chunkToString(a){const l=a.op;let f="";if(typeof a.data>"u"){const n=t.default[l];f=`${f} ${n}`}else f=`${f} ${(0,i.toHex)(a.data)}`;return f}};return kc.default=e,kc}var Ec={},fS;function bf(){if(fS)return Ec;fS=1;var s=Ec&&Ec.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ec,"__esModule",{value:!0});const t=s(mf());let i=class extends t.default{isLockingScript(){return!0}isUnlockingScript(){return!1}};return Ec.default=i,Ec}var Oc={},hS;function k0(){if(hS)return Oc;hS=1;var s=Oc&&Oc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oc,"__esModule",{value:!0});const t=s(mf());let i=class extends t.default{isLockingScript(){return!1}isUnlockingScript(){return!0}};return Oc.default=i,Oc}var En={},pS;function iI(){if(pS)return En;pS=1;var s=En&&En.__createBinding||(Object.create?function(w,v,_,S){S===void 0&&(S=_);var T=Object.getOwnPropertyDescriptor(v,_);(!T||("get"in T?!v.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return v[_]}}),Object.defineProperty(w,S,T)}:function(w,v,_,S){S===void 0&&(S=_),w[S]=v[_]}),t=En&&En.__setModuleDefault||(Object.create?function(w,v){Object.defineProperty(w,"default",{enumerable:!0,value:v})}:function(w,v){w.default=v}),i=En&&En.__importStar||function(w){if(w&&w.__esModule)return w;var v={};if(w!=null)for(var _ in w)_!=="default"&&Object.prototype.hasOwnProperty.call(w,_)&&s(v,w,_);return t(v,w),v},r=En&&En.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(En,"__esModule",{value:!0});const e=r(mf()),o=r(ui()),a=r(gf()),l=me(),f=i(li()),n=r(I0()),c=r(ka()),d=mu(),y=1024*1024*1024,p=Math.pow(2,31)-1,g=!0;let b=class{constructor(v){var _;this.sourceTXID=v.sourceTXID,this.sourceOutputIndex=v.sourceOutputIndex,this.sourceSatoshis=v.sourceSatoshis,this.lockingScript=v.lockingScript,this.transactionVersion=v.transactionVersion,this.otherInputs=v.otherInputs,this.outputs=v.outputs,this.inputIndex=v.inputIndex,this.unlockingScript=v.unlockingScript,this.inputSequence=v.inputSequence,this.lockTime=v.lockTime,this.memoryLimit=(_=v.memoryLimit)!==null&&_!==void 0?_:1e5,this.stackMem=0,this.altStackMem=0,this.reset()}reset(){this.context="UnlockingScript",this.programCounter=0,this.lastCodeSeparator=null,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0}step(){var v,_,S,T;let I;if(this.stackMem>this.memoryLimit)return this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;if(this.altStackMem>this.memoryLimit)return this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;const k=()=>{I=void 0};this.context==="UnlockingScript"&&this.programCounter>=this.unlockingScript.chunks.length&&(this.context="LockingScript",this.programCounter=0);let O;this.context==="UnlockingScript"?O=this.unlockingScript.chunks[this.programCounter]:O=this.lockingScript.chunks[this.programCounter];const A=St=>St===a.default.OP_2MUL||St===a.default.OP_2DIV||St===a.default.OP_VERIF||St===a.default.OP_VERNOTIF||St===a.default.OP_VER,R=St=>{const Ot=St.data,Wt=St.op;return Array.isArray(Ot)?Ot.length===0?Wt===a.default.OP_0:Ot.length===1&&Ot[0]>=1&&Ot[0]<=16?Wt===a.default.OP_1+(Ot[0]-1):Ot.length===1&&Ot[0]===129?Wt===a.default.OP_1NEGATE:Ot.length<=75?Wt===Ot.length:Ot.length<=255?Wt===a.default.OP_PUSHDATA1:Ot.length<=65535?Wt===a.default.OP_PUSHDATA2:!0:!0},P=(St,Ot=Number.MAX_SAFE_INTEGER)=>!(St.length>Ot||St.length>0&&(St[St.length-1]&127)===0&&(St.length<=1||(St[St.length-2]&128)===0)),C=(St,Ot)=>{const Wt=St;for(;Wt.length<Ot;)Wt.unshift(0);return Wt},N=St=>{if(St.length<9||St.length>73||St[0]!==48||St[1]!==St.length-3)return!1;const Ot=St[3];if(5+Ot>=St.length)return!1;const Wt=St[5+Ot];if(Ot+Wt+7!==St.length)return!1;const Gt=St.slice(4);if(St[2]!==2||St[3]!==Ot||Ot===0||(Gt[0]&128)!==0||Ot>1&&Gt[0]===0&&(Gt[1]&128)===0)return!1;const z=St.slice(6+Ot);return!(St[6+Ot-2]!==2||St[6+Ot-1]!==Wt||Wt===0||(z[0]&128)!==0||Wt>1&&z[0]===0&&(z[1]&128)===0)},D=St=>{if(St.length===0)return!0;N(St)||this.scriptEvaluationError("The signature format is invalid.");const Ot=n.default.fromChecksigFormat(St);return Ot.hasLowS()||this.scriptEvaluationError("The signature must have a low S value."),(Ot.scope&n.default.SIGHASH_FORKID)===0?(this.scriptEvaluationError("The signature must use SIGHASH_FORKID."),!1):!0},U=St=>(St.length<33&&this.scriptEvaluationError("The public key is too short, it must be at least 33 bytes."),St[0]===4?St.length!==65&&this.scriptEvaluationError("The non-compressed public key must be 65 bytes."):St[0]===2||St[0]===3?St.length!==33&&this.scriptEvaluationError("The compressed public key must be 33 bytes."):this.scriptEvaluationError("The public key is in an unknown format."),!0),F=(St,Ot,Wt)=>{const Gt=n.default.format({sourceTXID:this.sourceTXID,sourceOutputIndex:this.sourceOutputIndex,sourceSatoshis:this.sourceSatoshis,transactionVersion:this.transactionVersion,otherInputs:this.otherInputs,outputs:this.outputs,inputIndex:this.inputIndex,subscript:Wt,inputSequence:this.inputSequence,lockTime:this.lockTime,scope:St.scope}),z=new o.default(f.hash256(Gt));return(0,d.verify)(z,St,Ot)},L=!this.ifStack.includes(!1);let j,V,W,q,$,Y,Q,J,vt,wt,dt,yt,_t,tt,xt,It,Nt,Lt,ne,Ut,Vt,Jt,Ct,K,ut,st,Mt,Ht,Kt,Xt,Qt,Ft;const Rt=O.op;if(typeof Rt>"u"&&this.scriptEvaluationError(`An opcode is missing in this chunk of the ${this.context}!`),Array.isArray(O.data)&&O.data.length>y&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${y} bytes.`),L&&A(Rt)&&this.scriptEvaluationError("This opcode is currently disabled."),L&&Rt>=0&&Rt<=a.default.OP_PUSHDATA4)R(O)||this.scriptEvaluationError("This data is not minimally-encoded."),Array.isArray(O.data)?(this.stack.push(O.data),this.stackMem+=O.data.length):(this.stack.push([]),this.stackMem+=0);else if(L||a.default.OP_IF<=Rt&&Rt<=a.default.OP_ENDIF)switch(Rt){case a.default.OP_1NEGATE:case a.default.OP_1:case a.default.OP_2:case a.default.OP_3:case a.default.OP_4:case a.default.OP_5:case a.default.OP_6:case a.default.OP_7:case a.default.OP_8:case a.default.OP_9:case a.default.OP_10:case a.default.OP_11:case a.default.OP_12:case a.default.OP_13:case a.default.OP_14:case a.default.OP_15:case a.default.OP_16:Y=Rt-(a.default.OP_1-1),j=new o.default(Y).toScriptNum(),this.stack.push(j),this.stackMem+=j.length;break;case a.default.OP_NOP:case a.default.OP_NOP2:case a.default.OP_NOP3:case a.default.OP_NOP1:case a.default.OP_NOP4:case a.default.OP_NOP5:case a.default.OP_NOP6:case a.default.OP_NOP7:case a.default.OP_NOP8:case a.default.OP_NOP9:case a.default.OP_NOP10:case a.default.OP_NOP11:case a.default.OP_NOP12:case a.default.OP_NOP13:case a.default.OP_NOP14:case a.default.OP_NOP15:case a.default.OP_NOP16:case a.default.OP_NOP17:case a.default.OP_NOP18:case a.default.OP_NOP19:case a.default.OP_NOP20:case a.default.OP_NOP21:case a.default.OP_NOP22:case a.default.OP_NOP23:case a.default.OP_NOP24:case a.default.OP_NOP25:case a.default.OP_NOP26:case a.default.OP_NOP27:case a.default.OP_NOP28:case a.default.OP_NOP29:case a.default.OP_NOP30:case a.default.OP_NOP31:case a.default.OP_NOP32:case a.default.OP_NOP33:case a.default.OP_NOP34:case a.default.OP_NOP35:case a.default.OP_NOP36:case a.default.OP_NOP37:case a.default.OP_NOP38:case a.default.OP_NOP39:case a.default.OP_NOP40:case a.default.OP_NOP41:case a.default.OP_NOP42:case a.default.OP_NOP43:case a.default.OP_NOP44:case a.default.OP_NOP45:case a.default.OP_NOP46:case a.default.OP_NOP47:case a.default.OP_NOP48:case a.default.OP_NOP49:case a.default.OP_NOP50:case a.default.OP_NOP51:case a.default.OP_NOP52:case a.default.OP_NOP53:case a.default.OP_NOP54:case a.default.OP_NOP55:case a.default.OP_NOP56:case a.default.OP_NOP57:case a.default.OP_NOP58:case a.default.OP_NOP59:case a.default.OP_NOP60:case a.default.OP_NOP61:case a.default.OP_NOP62:case a.default.OP_NOP63:case a.default.OP_NOP64:case a.default.OP_NOP65:case a.default.OP_NOP66:case a.default.OP_NOP67:case a.default.OP_NOP68:case a.default.OP_NOP69:case a.default.OP_NOP70:case a.default.OP_NOP71:case a.default.OP_NOP72:case a.default.OP_NOP73:case a.default.OP_NOP77:break;case a.default.OP_IF:case a.default.OP_NOTIF:Xt=!1,L&&(this.stack.length<1&&this.scriptEvaluationError("OP_IF and OP_NOTIF require at least one item on the stack when they are used!"),j=this.stacktop(-1),Xt=this.castToBool(j),Rt===a.default.OP_NOTIF&&(Xt=!Xt),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k()),this.ifStack.push(Xt);break;case a.default.OP_ELSE:this.ifStack.length===0&&this.scriptEvaluationError("OP_ELSE requires a preceeding OP_IF."),this.ifStack[this.ifStack.length-1]=!this.ifStack[this.ifStack.length-1];break;case a.default.OP_ENDIF:this.ifStack.length===0&&this.scriptEvaluationError("OP_ENDIF requires a preceeding OP_IF."),this.ifStack.pop();break;case a.default.OP_VERIFY:this.stack.length<1&&this.scriptEvaluationError("OP_VERIFY requires at least one item to be on the stack."),j=this.stacktop(-1),Xt=this.castToBool(j),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),Xt||this.scriptEvaluationError("OP_VERIFY requires the top stack value to be truthy.");break;case a.default.OP_RETURN:this.context==="UnlockingScript"?this.programCounter=this.unlockingScript.chunks.length:this.programCounter=this.lockingScript.chunks.length,this.ifStack=[];break;case a.default.OP_TOALTSTACK:this.stack.length<1&&this.scriptEvaluationError("OP_TOALTSTACK requires at oeast one item to be on the stack."),I=this.stack.pop(),I!=null&&(this.altStack.push(I),this.altStackMem+=I.length,this.stackMem-=I.length),k();break;case a.default.OP_FROMALTSTACK:this.altStack.length<1&&this.scriptEvaluationError("OP_FROMALTSTACK requires at least one item to be on the stack."),I=this.altStack.pop(),I!=null&&(this.stack.push(I),this.stackMem+=I.length,this.altStackMem-=I.length),k();break;case a.default.OP_2DROP:this.stack.length<2&&this.scriptEvaluationError("OP_2DROP requires at least two items to be on the stack."),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();break;case a.default.OP_2DUP:this.stack.length<2&&this.scriptEvaluationError("OP_2DUP requires at least two items to be on the stack."),V=this.stacktop(-2),W=this.stacktop(-1),this.stack.push([...V]),this.stackMem+=V.length,this.stack.push([...W]),this.stackMem+=W.length;break;case a.default.OP_3DUP:this.stack.length<3&&this.scriptEvaluationError("OP_3DUP requires at least three items to be on the stack."),V=this.stacktop(-3),W=this.stacktop(-2),q=this.stacktop(-1),this.stack.push([...V]),this.stackMem+=V.length,this.stack.push([...W]),this.stackMem+=W.length,this.stack.push([...q]),this.stackMem+=q.length;break;case a.default.OP_2OVER:this.stack.length<4&&this.scriptEvaluationError("OP_2OVER requires at least four items to be on the stack."),V=this.stacktop(-4),W=this.stacktop(-3),this.stack.push([...V]),this.stackMem+=V.length,this.stack.push([...W]),this.stackMem+=W.length;break;case a.default.OP_2ROT:this.stack.length<6&&this.scriptEvaluationError("OP_2ROT requires at least six items to be on the stack."),$=this.stack.splice(this.stack.length-6,2),this.stack.push($[0]),this.stackMem+=$[0].length,this.stack.push($[1]),this.stackMem+=$[1].length;break;case a.default.OP_2SWAP:this.stack.length<4&&this.scriptEvaluationError("OP_2SWAP requires at least four items to be on the stack."),$=this.stack.splice(this.stack.length-4,2),this.stack.push($[0]),this.stackMem+=$[0].length,this.stack.push($[1]),this.stackMem+=$[1].length;break;case a.default.OP_IFDUP:this.stack.length<1&&this.scriptEvaluationError("OP_IFDUP requires at least one item to be on the stack."),j=this.stacktop(-1),Xt=this.castToBool(j),Xt&&(this.stack.push([...j]),this.stackMem+=j.length);break;case a.default.OP_DEPTH:j=new o.default(this.stack.length).toScriptNum(),this.stack.push(j),this.stackMem+=j.length;break;case a.default.OP_DROP:this.stack.length<1&&this.scriptEvaluationError("OP_DROP requires at least one item to be on the stack."),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();break;case a.default.OP_DUP:this.stack.length<1&&this.scriptEvaluationError("OP_DUP requires at least one item to be on the stack."),this.stack.push([...this.stacktop(-1)]),this.stackMem+=this.stacktop(-1).length;break;case a.default.OP_NIP:this.stack.length<2&&this.scriptEvaluationError("OP_NIP requires at least two items to be on the stack."),this.stack.splice(this.stack.length-2,1),this.stackMem-=this.stacktop(-1).length;break;case a.default.OP_OVER:this.stack.length<2&&this.scriptEvaluationError("OP_OVER requires at least two items to be on the stack."),this.stack.push([...this.stacktop(-2)]),this.stackMem+=this.stacktop(-2).length;break;case a.default.OP_PICK:case a.default.OP_ROLL:this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least two items to be on the stack.`),j=this.stacktop(-1),tt=o.default.fromScriptNum(j,g),Y=tt.toNumber(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),(Y<0||Y>=this.stack.length)&&this.scriptEvaluationError(`${a.default[Rt]} requires the top stack element to be 0 or a positive number less than the current size of the stack.`),j=this.stacktop(-Y-1),Rt===a.default.OP_ROLL&&(this.stack.splice(this.stack.length-Y-1,1),this.stackMem-=j.length),this.stack.push([...j]),this.stackMem+=j.length;break;case a.default.OP_ROT:this.stack.length<3&&this.scriptEvaluationError("OP_ROT requires at least three items to be on the stack."),dt=this.stacktop(-3),yt=this.stacktop(-2),_t=this.stacktop(-1),this.stack[this.stack.length-3]=yt,this.stack[this.stack.length-2]=_t,this.stack[this.stack.length-1]=dt;break;case a.default.OP_SWAP:this.stack.length<2&&this.scriptEvaluationError("OP_SWAP requires at least two items to be on the stack."),dt=this.stacktop(-2),yt=this.stacktop(-1),this.stack[this.stack.length-2]=yt,this.stack[this.stack.length-1]=dt;break;case a.default.OP_TUCK:this.stack.length<2&&this.scriptEvaluationError("OP_TUCK requires at least two items to be on the stack."),this.stack.splice(this.stack.length-2,0,[...this.stacktop(-1)]),this.stackMem+=this.stacktop(-1).length;break;case a.default.OP_SIZE:this.stack.length<1&&this.scriptEvaluationError("OP_SIZE requires at least one item to be on the stack."),tt=new o.default(this.stacktop(-1).length),this.stack.push(tt.toScriptNum()),this.stackMem+=tt.toScriptNum().length;break;case a.default.OP_AND:case a.default.OP_OR:case a.default.OP_XOR:switch(this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least one item to be on the stack.`),V=this.stacktop(-2),W=this.stacktop(-1),V.length!==W.length&&this.scriptEvaluationError(`${a.default[Rt]} requires the top two stack items to be the same size.`),Rt){case a.default.OP_AND:for(let St=0;St<V.length;St++)V[St]&=W[St];break;case a.default.OP_OR:for(let St=0;St<V.length;St++)V[St]|=W[St];break;case a.default.OP_XOR:for(let St=0;St<V.length;St++)V[St]^=W[St];break}I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();break;case a.default.OP_INVERT:this.stack.length<1&&this.scriptEvaluationError("OP_INVERT requires at least one item to be on the stack."),j=this.stacktop(-1);for(let St=0;St<j.length;St++)j[St]=~j[St];break;case a.default.OP_LSHIFT:case a.default.OP_RSHIFT:if(this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least two items to be on the stack.`),V=this.stacktop(-2),V.length===0)I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();else{xt=new o.default(V),It=o.default.fromScriptNum(this.stacktop(-1),g),Y=It.toNumber(),Y<0&&this.scriptEvaluationError(`${a.default[Rt]} requires the top item on the stack not to be negative.`),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();let St;Rt===a.default.OP_LSHIFT&&(St=xt.ushln(Y)),Rt===a.default.OP_RSHIFT&&(St=xt.ushrn(Y));const Ot=C(St.toArray().slice(V.length*-1),V.length);this.stack.push(Ot),this.stackMem+=Ot.length}break;case a.default.OP_EQUAL:case a.default.OP_EQUALVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least two items to be on the stack.`),V=this.stacktop(-2),W=this.stacktop(-1),Qt=(0,l.toHex)(V)===(0,l.toHex)(W),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(Qt?[1]:[]),this.stackMem+=Qt?1:0,Rt===a.default.OP_EQUALVERIFY&&(this.castToBool(this.stacktop(-1))?(I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k()):this.scriptEvaluationError("OP_EQUALVERIFY requires the top two stack items to be equal."));break;case a.default.OP_1ADD:case a.default.OP_1SUB:case a.default.OP_NEGATE:case a.default.OP_ABS:case a.default.OP_NOT:case a.default.OP_0NOTEQUAL:switch(this.stack.length<1&&this.scriptEvaluationError(`${a.default[Rt]} requires at least one items to be on the stack.`),j=this.stacktop(-1),tt=o.default.fromScriptNum(j,g),Rt){case a.default.OP_1ADD:tt=tt.addn(1);break;case a.default.OP_1SUB:tt=tt.subn(1);break;case a.default.OP_NEGATE:tt=tt.neg();break;case a.default.OP_ABS:tt.cmpn(0)<0&&(tt=tt.neg());break;case a.default.OP_NOT:tt=new o.default(tt.cmpn(0)===0?1:0);break;case a.default.OP_0NOTEQUAL:tt=new o.default(tt.cmpn(0)!==0?1:0);break}I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(tt.toScriptNum()),this.stackMem+=tt.toScriptNum().length;break;case a.default.OP_ADD:case a.default.OP_SUB:case a.default.OP_MUL:case a.default.OP_MOD:case a.default.OP_DIV:case a.default.OP_BOOLAND:case a.default.OP_BOOLOR:case a.default.OP_NUMEQUAL:case a.default.OP_NUMEQUALVERIFY:case a.default.OP_NUMNOTEQUAL:case a.default.OP_LESSTHAN:case a.default.OP_GREATERTHAN:case a.default.OP_LESSTHANOREQUAL:case a.default.OP_GREATERTHANOREQUAL:case a.default.OP_MIN:case a.default.OP_MAX:switch(this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least two items to be on the stack.`),xt=o.default.fromScriptNum(this.stacktop(-2),g),It=o.default.fromScriptNum(this.stacktop(-1),g),tt=new o.default(0),Rt){case a.default.OP_ADD:tt=xt.add(It);break;case a.default.OP_SUB:tt=xt.sub(It);break;case a.default.OP_MUL:tt=xt.mul(It);break;case a.default.OP_DIV:It.cmpn(0)===0&&this.scriptEvaluationError("OP_DIV cannot divide by zero!"),tt=xt.div(It);break;case a.default.OP_MOD:It.cmpn(0)===0&&this.scriptEvaluationError("OP_MOD cannot divide by zero!"),tt=xt.mod(It);break;case a.default.OP_BOOLAND:tt=new o.default(xt.cmpn(0)!==0&&It.cmpn(0)!==0?1:0);break;case a.default.OP_BOOLOR:tt=new o.default(xt.cmpn(0)!==0||It.cmpn(0)!==0?1:0);break;case a.default.OP_NUMEQUAL:tt=new o.default(xt.cmp(It)===0?1:0);break;case a.default.OP_NUMEQUALVERIFY:tt=new o.default(xt.cmp(It)===0?1:0);break;case a.default.OP_NUMNOTEQUAL:tt=new o.default(xt.cmp(It)!==0?1:0);break;case a.default.OP_LESSTHAN:tt=new o.default(xt.cmp(It)<0?1:0);break;case a.default.OP_GREATERTHAN:tt=new o.default(xt.cmp(It)>0?1:0);break;case a.default.OP_LESSTHANOREQUAL:tt=new o.default(xt.cmp(It)<=0?1:0);break;case a.default.OP_GREATERTHANOREQUAL:tt=new o.default(xt.cmp(It)>=0?1:0);break;case a.default.OP_MIN:tt=xt.cmp(It)<0?xt:It;break;case a.default.OP_MAX:tt=xt.cmp(It)>0?xt:It;break}I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(tt.toScriptNum()),this.stackMem+=tt.toScriptNum().length,Rt===a.default.OP_NUMEQUALVERIFY&&(this.castToBool(this.stacktop(-1))?(I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k()):this.scriptEvaluationError("OP_NUMEQUALVERIFY requires the top stack item to be truthy."));break;case a.default.OP_WITHIN:this.stack.length<3&&this.scriptEvaluationError("OP_WITHIN requires at least three items to be on the stack."),xt=o.default.fromScriptNum(this.stacktop(-3),g),It=o.default.fromScriptNum(this.stacktop(-2),g),Nt=o.default.fromScriptNum(this.stacktop(-1),g),Xt=It.cmp(xt)<=0&&xt.cmp(Nt)<0,I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(Xt?[1]:[]),this.stackMem+=Xt?1:0;break;case a.default.OP_RIPEMD160:case a.default.OP_SHA1:case a.default.OP_SHA256:case a.default.OP_HASH160:case a.default.OP_HASH256:{this.stack.length<1&&this.scriptEvaluationError(`${a.default[Rt]} requires at least one item to be on the stack.`);let St=[];j=this.stacktop(-1),Rt===a.default.OP_RIPEMD160?St=f.ripemd160(j):Rt===a.default.OP_SHA1?St=f.sha1(j):Rt===a.default.OP_SHA256?St=f.sha256(j):Rt===a.default.OP_HASH160?St=f.hash160(j):Rt===a.default.OP_HASH256&&(St=f.hash256(j)),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(St),this.stackMem+=St.length;break}case a.default.OP_CODESEPARATOR:this.lastCodeSeparator=this.programCounter;break;case a.default.OP_CHECKSIG:case a.default.OP_CHECKSIGVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${a.default[Rt]} requires at least two items to be on the stack.`),Lt=this.stacktop(-2),ne=this.stacktop(-1),(!D(Lt)||!U(ne))&&this.scriptEvaluationError(`${a.default[Rt]} requires correct encoding for the public key and signature.`),this.context==="UnlockingScript"?Ut=new e.default(this.unlockingScript.chunks.slice((v=this.lastCodeSeparator)!==null&&v!==void 0?v:0)):Ut=new e.default(this.lockingScript.chunks.slice((_=this.lastCodeSeparator)!==null&&_!==void 0?_:0)),Ut.findAndDelete(new e.default().writeBin(Lt));try{Vt=n.default.fromChecksigFormat(Lt),Jt=c.default.fromDER(ne),Ft=F(Vt,Jt,Ut)}catch{Ft=!1}!Ft&&Lt.length>0&&this.scriptEvaluationError(`${a.default[Rt]} failed to verify the signature, and requires an empty signature when verification fails.`),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(Ft?[1]:[]),this.stackMem+=Ft?1:0,Rt===a.default.OP_CHECKSIGVERIFY&&(Ft?(I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k()):this.scriptEvaluationError("OP_CHECKSIGVERIFY requires that a valid signature is provided."));break;case a.default.OP_CHECKMULTISIG:case a.default.OP_CHECKMULTISIGVERIFY:Ct=1,this.stack.length<Ct&&this.scriptEvaluationError(`${a.default[Rt]} requires at least 1 item to be on the stack.`),ut=o.default.fromScriptNum(this.stacktop(-Ct),g).toNumber(),(ut<0||ut>p)&&this.scriptEvaluationError(`${a.default[Rt]} requires a key count between 0 and ${p}.`),st=++Ct,Ct+=ut,Mt=ut+2,this.stack.length<Ct&&this.scriptEvaluationError(`${a.default[Rt]} requires the number of stack items not to be less than the number of keys used.`),Ht=o.default.fromScriptNum(this.stacktop(-Ct),g).toNumber(),(Ht<0||Ht>ut)&&this.scriptEvaluationError(`${a.default[Rt]} requires the number of signatures to be no greater than the number of keys.`),Kt=++Ct,Ct+=Ht,this.stack.length<Ct&&this.scriptEvaluationError(`${a.default[Rt]} requires the number of stack items not to be less than the number of signatures provided.`),this.context==="UnlockingScript"?Ut=new e.default(this.unlockingScript.chunks.slice((S=this.lastCodeSeparator)!==null&&S!==void 0?S:0)):Ut=new e.default(this.lockingScript.chunks.slice((T=this.lastCodeSeparator)!==null&&T!==void 0?T:0));for(let St=0;St<Ht;St++)Lt=this.stacktop(-Kt-St),Ut.findAndDelete(new e.default().writeBin(Lt));for(Ft=!0;Ft&&Ht>0;){Lt=this.stacktop(-Kt),ne=this.stacktop(-st),(!D(Lt)||!U(ne))&&this.scriptEvaluationError(`${a.default[Rt]} requires correct encoding for the public key and signature.`);try{Vt=n.default.fromChecksigFormat(Lt),Jt=c.default.fromString((0,l.toHex)(ne)),K=F(Vt,Jt,Ut)}catch{K=!1}K&&(Kt++,Ht--),st++,ut--,Ht>ut&&(Ft=!1)}for(;Ct-- >1;)!Ft&&Mt===0&&this.stacktop(-1).length>0&&this.scriptEvaluationError(`${a.default[Rt]} failed to verify a signature, and requires an empty signature when verification fails.`),Mt>0&&Mt--,I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();this.stack.length<1&&this.scriptEvaluationError(`${a.default[Rt]} requires an extra item to be on the stack.`),this.stacktop(-1).length>0&&this.scriptEvaluationError(`${a.default[Rt]} requires the extra stack item to be empty.`),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),this.stack.push(Ft?[1]:[]),this.stackMem+=Ft?1:0,Rt===a.default.OP_CHECKMULTISIGVERIFY&&(Ft?(I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k()):this.scriptEvaluationError("OP_CHECKMULTISIGVERIFY requires that a sufficient number of valid signatures are provided."));break;case a.default.OP_CAT:this.stack.length<2&&this.scriptEvaluationError("OP_CAT requires at least two items to be on the stack."),V=this.stacktop(-2),W=this.stacktop(-1),V.length+W.length>y&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${y} bytes.`),this.stack[this.stack.length-2]=[...V,...W],this.stackMem-=V.length,this.stackMem-=W.length,this.stackMem+=V.length+W.length,I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k();break;case a.default.OP_SPLIT:this.stack.length<2&&this.scriptEvaluationError("OP_SPLIT requires at least two items to be on the stack."),V=this.stacktop(-2),Y=o.default.fromScriptNum(this.stacktop(-1),g).toNumber(),(Y<0||Y>V.length)&&this.scriptEvaluationError("OP_SPLIT requires the first stack item to be a non-negative number less than or equal to the size of the second-from-top stack item."),W=[...V],this.stack[this.stack.length-2]=W.slice(0,Y),this.stackMem-=V.length,this.stackMem+=Y,this.stack[this.stack.length-1]=W.slice(Y),this.stackMem+=V.length-Y;break;case a.default.OP_NUM2BIN:if(this.stack.length<2&&this.scriptEvaluationError("OP_NUM2BIN requires at least two items to be on the stack."),Q=o.default.fromScriptNum(this.stacktop(-1),g).toNumber(),Q>y&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${y} bytes.`),I=this.stack.pop(),I!=null&&(this.stackMem-=I.length),k(),J=this.stacktop(-1),J=(0,l.minimallyEncode)(J),J.length>Q&&this.scriptEvaluationError("OP_NUM2BIN requires that the size expressed in the top stack item is large enough to hold the value expressed in the second-from-top stack item."),J.length===Q){this.stack[this.stack.length-1]=J;break}for(wt=0,J.length>0&&(wt=J[J.length-1]&128,J[J.length-1]&=127),vt=new Array(Q),vt.fill(0),Y=0;Y<Q;Y++)vt[Y]=J[Y];for(Y=J.length-1;Y++<Q-2;)vt[Y]=0;vt[Y]=wt,this.stack[this.stack.length-1]=vt,this.stackMem-=J.length,this.stackMem+=Q;break;case a.default.OP_BIN2NUM:this.stack.length<1&&this.scriptEvaluationError("OP_BIN2NUM requires at least one item to be on the stack."),V=this.stacktop(-1),W=(0,l.minimallyEncode)(V),this.stack[this.stack.length-1]=W,this.stackMem-=V.length,this.stackMem+=W.length,P(W)||this.scriptEvaluationError("OP_BIN2NUM requires that the resulting number is valid.");break;default:this.scriptEvaluationError("Invalid opcode!")}return this.programCounter++,!0}validate(){for(this.unlockingScript.isPushOnly()||this.scriptEvaluationError("Unlocking scripts can only contain push operations, and no other opcodes.");this.step()&&!(this.context==="LockingScript"&&this.programCounter>=this.lockingScript.chunks.length););return this.ifStack.length>0&&this.scriptEvaluationError("Every OP_IF must be terminated prior to the end of the script."),this.stack.length!==1&&this.scriptEvaluationError("The clean stack rule requires exactly one item to be on the stack after script execution."),this.castToBool(this.stacktop(-1))||this.scriptEvaluationError("The top stack element must be truthy after script evaluation."),!0}stacktop(v){return this.stack[this.stack.length+v]}castToBool(v){for(let _=0;_<v.length;_++)if(v[_]!==0)return!(_===v.length-1&&v[_]===128);return!1}scriptEvaluationError(v){throw new Error(`Script evaluation error: ${v}

Source TXID: ${this.sourceTXID}
Source output index: ${this.sourceOutputIndex}
Context: ${this.context}
Program counter: ${this.programCounter}
Stack size: ${this.stack.length}
Alt stack size: ${this.altStack.length}`)}};return En.default=b,En}var Tl={},Ac={},yS;function h1(){if(yS)return Ac;yS=1;var s=Ac&&Ac.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ac,"__esModule",{value:!0});const t=s(gf()),i=me(),r=s(bf()),e=s(k0()),o=s(I0()),a=li();function l(n){if(n==null)throw new Error("must have value");return n}let f=class{lock(c){let d;if(typeof c=="string"){const y=(0,i.fromBase58Check)(c);if(y.prefix[0]!==0&&y.prefix[0]!==111)throw new Error("only P2PKH is supported");d=y.data}else d=c;if(d.length!==20)throw new Error("P2PKH hash length must be 20 bytes");return new r.default([{op:t.default.OP_DUP},{op:t.default.OP_HASH160},{op:d.length,data:d},{op:t.default.OP_EQUALVERIFY},{op:t.default.OP_CHECKSIG}])}unlock(c,d="all",y=!1,p,g){return{sign:async(b,w)=>{var v,_,S,T;let I=o.default.SIGHASH_FORKID;d==="all"&&(I|=o.default.SIGHASH_ALL),d==="none"&&(I|=o.default.SIGHASH_NONE),d==="single"&&(I|=o.default.SIGHASH_SINGLE),y&&(I|=o.default.SIGHASH_ANYONECANPAY);const k=b.inputs[w],O=b.inputs.filter((U,F)=>F!==w),A=(v=k.sourceTXID)!==null&&v!==void 0?v:(_=k.sourceTransaction)===null||_===void 0?void 0:_.id("hex");if(A==null||A===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(A==="")throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(p||(p=(S=k.sourceTransaction)===null||S===void 0?void 0:S.outputs[k.sourceOutputIndex].satoshis),p==null||p===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(g||(g=(T=k.sourceTransaction)===null||T===void 0?void 0:T.outputs[k.sourceOutputIndex].lockingScript),g==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const R=o.default.format({sourceTXID:A,sourceOutputIndex:l(k.sourceOutputIndex),sourceSatoshis:p,transactionVersion:b.version,otherInputs:O,inputIndex:w,outputs:b.outputs,inputSequence:l(k.sequence),subscript:g,lockTime:b.lockTime,scope:I}),P=c.sign((0,a.sha256)(R)),N=new o.default(P.r,P.s,I).toChecksigFormat(),D=c.toPublicKey().encode(!0);return new e.default([{op:N.length,data:N},{op:D.length,data:D}])},estimateLength:async()=>108}}};return Ac.default=f,Ac}var Pc={},gS;function NC(){if(gS)return Pc;gS=1;var s=Pc&&Pc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Pc,"__esModule",{value:!0});const t=s(gf()),i=s(bf()),r=s(k0()),e=s(bu()),o=s(I0()),a=li(),l=s(mf());let f=class{constructor(c="raw"){this.type="raw",this.type=c}lock(c){const d=[{op:t.default.OP_OVER},{op:t.default.OP_3},{op:t.default.OP_SPLIT},{op:t.default.OP_NIP},{op:t.default.OP_1},{op:t.default.OP_SPLIT},{op:t.default.OP_SWAP},{op:t.default.OP_SPLIT},{op:t.default.OP_DROP}];return this.type!=="raw"&&d.push({op:t.default["OP_"+this.type]}),d.push({op:c.length,data:c}),d.push({op:t.default.OP_EQUALVERIFY}),d.push({op:t.default.OP_CHECKSIG}),new i.default(d)}unlock(c,d,y="all",p=!1){return{sign:async(g,b)=>{var w,v,_,S,T,I,k,O,A,R;typeof d>"u"&&(d=e.default.fromRandom());let P=o.default.SIGHASH_FORKID;y==="all"&&(P|=o.default.SIGHASH_ALL),y==="none"&&(P|=o.default.SIGHASH_NONE),y==="single"&&(P|=o.default.SIGHASH_SINGLE),p&&(P|=o.default.SIGHASH_ANYONECANPAY);const C=[...g.inputs],[N]=C.splice(b,1);if(typeof N.sourceTransaction!="object")throw new Error("The source transaction is needed for transaction signing.");const D=o.default.format({sourceTXID:(v=(w=N.sourceTransaction)===null||w===void 0?void 0:w.id("hex"))!==null&&v!==void 0?v:"",sourceOutputIndex:(_=N.sourceOutputIndex)!==null&&_!==void 0?_:0,sourceSatoshis:(I=(T=(S=N.sourceTransaction)===null||S===void 0?void 0:S.outputs[N.sourceOutputIndex])===null||T===void 0?void 0:T.satoshis)!==null&&I!==void 0?I:0,transactionVersion:g.version,otherInputs:C,inputIndex:b,outputs:g.outputs,inputSequence:(k=N.sequence)!==null&&k!==void 0?k:4294967295,subscript:(R=(A=(O=N.sourceTransaction)===null||O===void 0?void 0:O.outputs[N.sourceOutputIndex])===null||A===void 0?void 0:A.lockingScript)!==null&&R!==void 0?R:new l.default,lockTime:g.lockTime,scope:P}),U=d.sign((0,a.sha256)(D),void 0,!0,c),L=new o.default(U.r,U.s,P).toChecksigFormat(),j=d.toPublicKey().encode(!0);return new r.default([{op:L.length,data:L},{op:j.length,data:j}])},estimateLength:async()=>108}}};return Pc.default=f,Pc}var zh={},mS;function E0(){if(mS)return zh;mS=1,Object.defineProperty(zh,"__esModule",{value:!0});const s=O0(),t=Cr();function i(o){if(o==null)throw new Error("must have value");return o}const r=o=>o.length===0?{op:0}:o.length===1&&o[0]===0?{op:0}:o.length===1&&o[0]>0&&o[0]<=16?{op:80+o[0]}:o.length===1&&o[0]===129?{op:79}:o.length<=75?{op:o.length,data:o}:o.length<=255?{op:76,data:o}:o.length<=65535?{op:77,data:o}:{op:78,data:o};let e=class{static decode(a){var l,f;const n=t.PublicKey.fromString(t.Utils.toHex(i(a.chunks[0].data))),c=[];for(let d=2;d<a.chunks.length;d++){const y=(l=a.chunks[d+1])===null||l===void 0?void 0:l.op;let p=(f=a.chunks[d].data)!==null&&f!==void 0?f:[];if(p.length===0&&(a.chunks[d].op>=80&&a.chunks[d].op<=95?p=[a.chunks[d].op-80]:a.chunks[d].op===0?p=[0]:a.chunks[d].op===79&&(p=[129])),c.push(p),y===s.OP.OP_DROP||y===s.OP.OP_2DROP)break}return{fields:c,lockingPublicKey:n}}constructor(a,l){this.wallet=a,this.originator=l}async lock(a,l,f,n,c=!1,d=!0,y="before"){const{publicKey:p}=await this.wallet.getPublicKey({protocolID:l,keyID:f,counterparty:n,forSelf:c},this.originator),g=[],b=[];if(g.push({op:p.length/2,data:t.Utils.toArray(p,"hex")}),g.push({op:s.OP.OP_CHECKSIG}),d){const v=a.reduce((S,T)=>[...S,...T],[]),{signature:_}=await this.wallet.createSignature({data:v,protocolID:l,keyID:f,counterparty:n},this.originator);a.push(_)}for(const v of a)b.push(r(v));let w=a.length;for(;w>1;)b.push({op:s.OP.OP_2DROP}),w-=2;return w!==0&&b.push({op:s.OP.OP_DROP}),y==="before"?new s.LockingScript([...g,...b]):new s.LockingScript([...b,...g])}unlock(a,l,f,n="all",c=!1,d,y){return{sign:async(p,g)=>{var b,w,v,_,S;let T=t.TransactionSignature.SIGHASH_FORKID;n==="all"&&(T|=t.TransactionSignature.SIGHASH_ALL),n==="none"&&(T|=t.TransactionSignature.SIGHASH_NONE),n==="single"&&(T|=t.TransactionSignature.SIGHASH_SINGLE),c&&(T|=t.TransactionSignature.SIGHASH_ANYONECANPAY);const I=p.inputs[g],k=p.inputs.filter((U,F)=>F!==g),O=(b=I.sourceTXID)!==null&&b!==void 0?b:(w=I.sourceTransaction)===null||w===void 0?void 0:w.id("hex");if(O==null||O===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(d||(d=(v=I.sourceTransaction)===null||v===void 0?void 0:v.outputs[I.sourceOutputIndex].satoshis),d==null||d===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(y||(y=(_=I.sourceTransaction)===null||_===void 0?void 0:_.outputs[I.sourceOutputIndex].lockingScript),y==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const A=t.TransactionSignature.format({sourceTXID:O,sourceOutputIndex:i(I.sourceOutputIndex),sourceSatoshis:d,transactionVersion:p.version,otherInputs:k,inputIndex:g,outputs:p.outputs,inputSequence:(S=I.sequence)!==null&&S!==void 0?S:4294967295,subscript:y,lockTime:p.lockTime,scope:T}),R=t.Hash.sha256(A),{signature:P}=await this.wallet.createSignature({data:R,protocolID:a,keyID:l,counterparty:f},this.originator),C=t.Signature.fromDER([...P]),D=new t.TransactionSignature(C.r,C.s,T).toChecksigFormat();return new s.UnlockingScript([{op:D.length,data:D}])},estimateLength:async()=>73}}};return zh.default=e,zh}var bS;function nI(){return bS||(bS=1,function(s){var t=Tl&&Tl.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(s,"__esModule",{value:!0}),s.PushDrop=s.RPuzzle=s.P2PKH=void 0;var i=h1();Object.defineProperty(s,"P2PKH",{enumerable:!0,get:function(){return t(i).default}});var r=NC();Object.defineProperty(s,"RPuzzle",{enumerable:!0,get:function(){return t(r).default}});var e=E0();Object.defineProperty(s,"PushDrop",{enumerable:!0,get:function(){return t(e).default}})}(Tl)),Tl}var wS;function O0(){return wS||(wS=1,function(s){var t=ra&&ra.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),i=ra&&ra.__exportStar||function(n,c){for(var d in n)d!=="default"&&!Object.prototype.hasOwnProperty.call(c,d)&&t(c,n,d)},r=ra&&ra.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.Spend=s.UnlockingScript=s.LockingScript=s.Script=s.OP=void 0;var e=gf();Object.defineProperty(s,"OP",{enumerable:!0,get:function(){return r(e).default}});var o=mf();Object.defineProperty(s,"Script",{enumerable:!0,get:function(){return r(o).default}});var a=bf();Object.defineProperty(s,"LockingScript",{enumerable:!0,get:function(){return r(a).default}});var l=k0();Object.defineProperty(s,"UnlockingScript",{enumerable:!0,get:function(){return r(l).default}});var f=iI();Object.defineProperty(s,"Spend",{enumerable:!0,get:function(){return r(f).default}}),i(nI(),s)}(ra)),ra}var aa={},Rc={},Xh={},vS;function rI(){if(vS)return Xh;vS=1,Object.defineProperty(Xh,"__esModule",{value:!0});let s=class{constructor(i){this.value=i}async computeFee(i){const r=a=>a>4294967296?9:a>65536?5:a>253?3:1;let e=4;e+=r(i.inputs.length);for(let a=0;a<i.inputs.length;a++){const l=i.inputs[a];e+=40;let f;if(typeof l.unlockingScript=="object")f=l.unlockingScript.toBinary().length;else if(typeof l.unlockingScriptTemplate=="object")f=await l.unlockingScriptTemplate.estimateLength(i,a);else throw new Error("All inputs must have an unlocking script or an unlocking script template for sat/kb fee computation.");e+=r(f),e+=f}e+=r(i.outputs.length);for(const a of i.outputs){e+=8;const l=a.lockingScript.toBinary().length;e+=r(l),e+=l}return e+=4,Math.ceil(e/1e3*this.value)}};return Xh.default=s,Xh}var Fs={},Mc={};function aI(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Il={},kl={},xS;function sI(){if(xS)return kl;xS=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.NodejsHttpClient=void 0;let s=class{constructor(i){this.https=i}async request(i,r){return await new Promise((e,o)=>{const a=this.https.request(i,r,l=>{let f="";l.on("data",n=>{f+=n}),l.on("end",()=>{const n=l.statusCode>=200&&l.statusCode<=299,c=l.headers["content-type"],d=f!==""&&typeof c=="string"&&c.startsWith("application/json")?JSON.parse(f):f;e({status:l.statusCode,statusText:l.statusMessage,ok:n,data:d})})});a.on("error",l=>{o(l)}),r.data!==null&&r.data!==void 0&&a.write(JSON.stringify(r.data)),a.end()})}};return kl.NodejsHttpClient=s,kl}var El={},_S;function oI(){if(_S)return El;_S=1,Object.defineProperty(El,"__esModule",{value:!0}),El.FetchHttpClient=void 0;let s=class{constructor(i){this.fetch=i}async request(i,r){var e;const o={method:r.method,headers:r.headers,body:JSON.stringify(r.data)},a=await this.fetch(i,o),l=a.headers.get("Content-Type"),f=(e=l==null?void 0:l.startsWith("application/json"))!==null&&e!==void 0&&e?await a.json():await a.text();return{ok:a.ok,status:a.status,statusText:a.statusText,data:f}}};return El.FetchHttpClient=s,El}var SS;function A0(){if(SS)return Il;SS=1,Object.defineProperty(Il,"__esModule",{value:!0}),Il.defaultHttpClient=void 0;const s=sI(),t=oI();function i(){const r={async request(...e){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new t.FetchHttpClient(window.fetch.bind(window));if(typeof aI<"u")try{const e=S0;return new s.NodejsHttpClient(e)}catch{return r}else return r}return Il.defaultHttpClient=i,Il}var TS;function cI(){if(TS)return Mc;TS=1;var s=Mc&&Mc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Mc,"__esModule",{value:!0});const t=A0(),i=s(ji()),r=me();function e(){return`ts-sdk-${(0,r.toHex)((0,i.default)(16))}`}class o{constructor(l,f){if(this.URL=l,typeof f=="string")this.apiKey=f,this.httpClient=(0,t.defaultHttpClient)(),this.deploymentId=e(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const n=f??{},{apiKey:c,deploymentId:d,httpClient:y,callbackToken:p,callbackUrl:g,headers:b}=n;this.apiKey=c,this.httpClient=y??(0,t.defaultHttpClient)(),this.deploymentId=d??e(),this.callbackToken=p,this.callbackUrl=g,this.headers=b}}requestHeaders(){const l={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(l.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(l["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(l["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const f in this.headers)l[f]=this.headers[f];return l}async broadcast(l){let f;try{f=l.toHexEF()}catch(c){if(c.message==="All inputs must have source transactions when serializing to EF format")f=l.toHex();else throw c}const n={method:"POST",headers:this.requestHeaders(),data:{rawTx:f}};try{const c=await this.httpClient.request(`${this.URL}/v1/tx`,n);if(c.ok){const{txid:d,extraInfo:y,txStatus:p,competingTxs:g}=c.data,b={status:"success",txid:d,message:`${p} ${y}`};return g!=null&&(b.competingTxs=g),b}else{const d=typeof c.status,y={status:"error",code:d==="number"||d==="string"?c.status.toString():"ERR_UNKNOWN",description:"Unknown error"};let p=c.data;if(typeof p=="string")try{p=JSON.parse(c.data)}catch{}return typeof p=="object"&&(p!==null&&(y.more=p),p!=null&&typeof p.txid=="string"&&(y.txid=p.txid),p!=null&&"detail"in p&&typeof p.detail=="string"&&(y.description=p.detail)),y}}catch(c){return{status:"error",code:"500",description:typeof c.message=="string"?c.message:"Internal Server Error"}}}async broadcastMany(l){const f=l.map(c=>{try{return{rawTx:c.toHexEF()}}catch(d){if(d.message==="All inputs must have source transactions when serializing to EF format")return{rawTx:c.toHex()};throw d}}),n={method:"POST",headers:this.requestHeaders(),data:f};try{return(await this.httpClient.request(`${this.URL}/v1/txs`,n)).data}catch(c){const d={status:"error",code:"500",description:typeof c.message=="string"?c.message:"Internal Server Error"};return l.map(()=>d)}}}return Mc.default=o,Mc}var IS;function uI(){if(IS)return Fs;IS=1;var s=Fs&&Fs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.defaultBroadcaster=void 0;const t=s(cI());function i(r=!1,e={}){return new t.default(r?"https://arc-test.taal.com":"https://arc.taal.com",e)}return Fs.defaultBroadcaster=i,Fs}var Ls={},Gh={},kS;function lI(){if(kS)return Gh;kS=1,Object.defineProperty(Gh,"__esModule",{value:!0});const s=A0();class t{constructor(r="main",e={}){const{apiKey:o,httpClient:a}=e;this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}`,this.httpClient=a??(0,s.defaultHttpClient)(),this.apiKey=o??""}async isValidRootForHeight(r,e){const o={method:"GET",headers:this.getHttpHeaders()},a=await this.httpClient.request(`${this.URL}/block/${e}/header`,o);if(a.ok){const{merkleroot:l}=a.data;return l===r}else{if(a.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${e} because of an error: ${JSON.stringify(a.data)} `)}}async currentHeight(){try{const r={method:"GET",headers:this.getHttpHeaders()},e=await this.httpClient.request(`${this.URL}/block/headers`,r);if(e.ok)return e.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(e.data)} `)}catch(r){throw new Error(`Failed to get current height because of an error: ${r instanceof Error?r.message:String(r)}`)}}getHttpHeaders(){const r={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(r.Authorization=this.apiKey),r}}return Gh.default=t,Gh}var ES;function dI(){if(ES)return Ls;ES=1;var s=Ls&&Ls.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.defaultChainTracker=void 0;const t=s(lI());function i(){return new t.default}return Ls.defaultChainTracker=i,Ls}var Ol={},Yh={},OS;function fI(){if(OS)return Yh;OS=1,Object.defineProperty(Yh,"__esModule",{value:!0});const s=me(),t=li();let i=class Kd{static fromHex(e){return Kd.fromBinary((0,s.toArray)(e,"hex"))}static fromReader(e,o=!0){const a=e.readVarIntNum(),l=e.readUInt8(),f=Array(l).fill(null).map(()=>[]);let n,c,d;for(let y=0;y<l;y++){for(d=e.readVarIntNum();d>0;){c=e.readVarIntNum(),n=e.readUInt8();const p={offset:c};(n&1)!==0?p.duplicate=!0:((n&2)!==0&&(p.txid=!0),p.hash=(0,s.toHex)(e.read(32).reverse())),(!Array.isArray(f[y])||f[y].length===0)&&(f[y]=[]),f[y].push(p),d--}f[y].sort((p,g)=>p.offset-g.offset)}return new Kd(a,f,o)}static fromBinary(e){const o=new s.Reader(e);return Kd.fromReader(o)}static fromCoinbaseTxidAndHeight(e,o){return new Kd(o,[[{offset:0,hash:e,txid:!0}]])}constructor(e,o,a=!0){this.blockHeight=e,this.path=o;const l=Array(this.path.length).fill(0).map(()=>new Set);this.path.forEach((n,c)=>{if(n.length===0&&c===0)throw new Error(`Empty level at height: ${c}`);const d=new Set;n.forEach(y=>{if(d.has(y.offset))throw new Error(`Duplicate offset: ${y.offset}, at height: ${c}`);if(d.add(y.offset),c===0){if(y.duplicate!==!0)for(let p=1;p<this.path.length;p++)l[p].add(y.offset>>p^1)}else if(a&&!l[c].has(y.offset))throw new Error(`Invalid offset: ${y.offset}, at height: ${c}, with legal offsets: ${Array.from(l[c]).join(", ")}`)})});let f;this.path[0].forEach((n,c)=>{if(c===0&&(f=this.computeRoot(n.hash)),f!==this.computeRoot(n.hash))throw new Error("Mismatched roots")})}toBinary(){const e=new s.Writer;e.writeVarIntNum(this.blockHeight);const o=this.path.length;e.writeUInt8(o);for(let a=0;a<o;a++){const l=Object.keys(this.path[a]).length;e.writeVarIntNum(l);for(const f of this.path[a]){e.writeVarIntNum(f.offset);let n=0;(f==null?void 0:f.duplicate)===!0&&(n|=1),(f==null?void 0:f.txid)!==void 0&&f.txid!==null&&(n|=2),e.writeUInt8(n),(n&1)===0&&e.write((0,s.toArray)(f.hash,"hex").reverse())}}return e.toArray()}toHex(){return(0,s.toHex)(this.toBinary())}indexOf(e){const o=this.path[0].find(a=>a.hash===e);if(o==null)throw new Error(`Transaction ID ${e} not found in the Merkle Path`);return o.offset}computeRoot(e){var o,a;if(typeof e!="string"){const c=this.path[0].find(d=>!!(d!=null&&d.hash));if(c==null)throw new Error("No valid leaf found in the Merkle Path");e=c.hash}if(typeof e!="string")throw new Error("Transaction ID is undefined");const l=this.indexOf(e);if(typeof l!="number")throw new Error(`This proof does not contain the txid: ${e??"undefined"}`);const f=c=>(0,s.toHex)((0,t.hash256)((0,s.toArray)(c,"hex").reverse()).reverse());let n=e;if(this.path.length===1&&this.path[0].length===1)return n;for(let c=0;c<this.path.length;c++){this.path[c];const d=l>>c^1,y=this.findOrComputeLeaf(c,d);if(typeof y!="object")throw new Error(`Missing hash for index ${l} at height ${c}`);y.duplicate===!0?n=f((n??"")+(n??"")):d%2!==0?n=f(((o=y.hash)!==null&&o!==void 0?o:"")+(n??"")):n=f((n??"")+((a=y.hash)!==null&&a!==void 0?a:""))}return n}findOrComputeLeaf(e,o){var a,l;const f=b=>(0,s.toHex)((0,t.hash256)((0,s.toArray)(b,"hex").reverse()).reverse());let n=this.path[e].find(b=>b.offset===o);if(n!=null)return n;if(e===0)return;const c=e-1,d=o<<1,y=this.findOrComputeLeaf(c,d);if(y==null||y.hash==null||y.hash==="")return;const p=this.findOrComputeLeaf(c,d+1);if(p==null)return;let g;return p.duplicate===!0?g=f(y.hash+y.hash):g=f(((a=p.hash)!==null&&a!==void 0?a:"")+((l=y.hash)!==null&&l!==void 0?l:"")),n={offset:o,hash:g},n}async verify(e,o){const a=this.computeRoot(e);if(this.indexOf(e)===0){const l=await o.currentHeight();if(this.blockHeight+100<l)return!1}return await o.isValidRootForHeight(a,this.blockHeight)}combine(e){var o,a;if(this.blockHeight!==e.blockHeight)throw new Error("You cannot combine paths which do not have the same block height.");const l=this.computeRoot(),f=e.computeRoot();if(l!==f)throw new Error("You cannot combine paths which do not have the same root.");const n=[];for(let c=0;c<this.path.length;c++){n.push([]);for(let d=0;d<this.path[c].length;d++)n[c].push(this.path[c][d]);for(let d=0;d<e.path[c].length;d++)if(n[c].find(y=>y.offset===e.path[c][d].offset)===void 0)n[c].push(e.path[c][d]);else if(((o=e.path[c][d])===null||o===void 0?void 0:o.txid)!==void 0&&((a=e.path[c][d])===null||a===void 0?void 0:a.txid)!==null){const y=n[c].find(p=>p.offset===e.path[c][d].offset);y!=null&&(y.txid=!0)}}this.path=n,this.trim()}trim(){const e=(n,c)=>{(c.length===0||c.slice(-1)[0]!==n)&&c.push(n)},o=(n,c)=>{for(let d=n.length;d>=0;d--){const y=this.path[c].findIndex(p=>p.offset===n[d]);y>=0&&this.path[c].splice(y,1)}},a=n=>{const c=[];for(const d of n)e(d>>1,c);return c};let l=[],f=[];for(let n=0;n<this.path.length;n++)this.path[n].sort((c,d)=>c.offset-d.offset);for(let n=0;n<this.path[0].length;n++){const c=this.path[0][n];if(c.txid===!0)e(c.offset>>1,l);else{const d=c.offset%2===1,y=this.path[0][n+(d?-1:1)];(y.txid===void 0||y.txid===null||!y.txid)&&e(y.offset,f)}}o(f,0);for(let n=1;n<this.path.length;n++)f=l,l=a(l),o(f,n)}};return Yh.default=i,Yh}var Nc={},AS;function hI(){if(AS)return Nc;AS=1;var s=Nc&&Nc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Nc,"__esModule",{value:!0});const t=li(),i=me(),r=s(vf()),e=wf();let o=class go{get bumpIndex(){return this._bumpIndex}set bumpIndex(l){this._bumpIndex=l,this.updateInputTxids()}get hasProof(){return this._bumpIndex!==void 0}get isTxidOnly(){return this._txid!==void 0&&this._txid!==null&&this._rawTx==null&&this._tx==null}get txid(){if(this._txid!==void 0&&this._txid!==null&&this._txid!=="")return this._txid;if(this._tx!=null)return this._txid=this._tx.id("hex"),this._txid;if(this._rawTx!=null)return this._txid=(0,i.toHex)((0,t.hash256)(this._rawTx)),this._txid;throw new Error("Internal")}get tx(){if(this._tx!=null)return this._tx;if(this._rawTx!=null)return this._tx=r.default.fromBinary(this._rawTx),this._tx}get rawTx(){if(this._rawTx!=null)return this._rawTx;if(this._tx!=null)return this._rawTx=this._tx.toBinary(),this._rawTx}constructor(l,f){this.inputTxids=[],this.isValid=void 0,typeof l=="string"?this._txid=l:Array.isArray(l)?this._rawTx=l:this._tx=l,this.bumpIndex=f,this.updateInputTxids()}static fromTx(l,f){return new go(l,f)}static fromRawTx(l,f){return new go(l,f)}static fromTxid(l,f){return new go(l,f)}updateInputTxids(){if(this.hasProof||this.tx==null)this.inputTxids=[];else{const l={};for(const f of this.tx.inputs)f.sourceTXID!==void 0&&f.sourceTXID!==null&&f.sourceTXID!==""&&(l[f.sourceTXID]=!0);this.inputTxids=Object.keys(l)}}toWriter(l,f){const n=p=>{l.writeUInt8(p)},c=()=>{if(this._txid==null)throw new Error("Transaction ID (_txid) is undefined");l.writeReverse((0,i.toArray)(this._txid,"hex"))},d=()=>{if(this._rawTx!=null)l.write(this._rawTx);else if(this._tx!=null)l.write(this._tx.toBinary());else throw new Error("a valid serialized Transaction is expected")},y=()=>{this.bumpIndex===void 0?n(e.TX_DATA_FORMAT.RAWTX):(n(e.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX),l.writeVarIntNum(this.bumpIndex))};f===e.BEEF_V2?this.isTxidOnly?(n(e.TX_DATA_FORMAT.TXID_ONLY),c()):this.bumpIndex!==void 0?(n(e.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX),l.writeVarIntNum(this.bumpIndex),d()):(n(e.TX_DATA_FORMAT.RAWTX),d()):(d(),y())}static fromReader(l,f){let n,c,d;if(f===e.BEEF_V2){const y=l.readUInt8();y===e.TX_DATA_FORMAT.TXID_ONLY?d=go.fromTxid((0,i.toHex)(l.readReverse(32))):(y===e.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX&&(c=l.readVarIntNum()),n=r.default.fromReader(l),d=go.fromTx(n,c))}else n=r.default.fromReader(l),c=l.readUInt8()!==0?l.readVarIntNum():void 0,d=go.fromTx(n,c);return d}};return Nc.default=o,Nc}var PS;function wf(){return PS||(PS=1,function(s){var t=Ol&&Ol.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.Beef=s.TX_DATA_FORMAT=s.ATOMIC_BEEF=s.BEEF_V2=s.BEEF_V1=void 0;const i=t(fI()),r=t(hI()),e=me(),o=li();function a(n){if(n==null)throw new Error("Expected a valid value, but got undefined.");return n}s.BEEF_V1=4022206465,s.BEEF_V2=4022206466,s.ATOMIC_BEEF=16843009;var l;(function(n){n[n.RAWTX=0]="RAWTX",n[n.RAWTX_AND_BUMP_INDEX=1]="RAWTX_AND_BUMP_INDEX",n[n.TXID_ONLY=2]="TXID_ONLY"})(l||(s.TX_DATA_FORMAT=l={}));let f=class Yc{constructor(c=s.BEEF_V2){this.bumps=[],this.txs=[],this.version=s.BEEF_V2,this.atomicTxid=void 0,this.version=c}findTxid(c){return this.txs.find(d=>d.txid===c)}makeTxidOnly(c){const d=this.txs.findIndex(p=>p.txid===c);if(d===-1)return;let y=this.txs[d];return y.isTxidOnly||(this.txs.splice(d,1),y=this.mergeTxidOnly(c)),y}findBump(c){return this.bumps.find(d=>d.path[0].some(y=>y.hash===c))}findTransactionForSigning(c){const d=this.findTxid(c);if(!(d==null||d.tx==null)){for(const y of d.tx.inputs)if(y.sourceTransaction==null){const p=this.findTxid(a(y.sourceTXID));p!=null&&(y.sourceTransaction=p.tx)}return d.tx}}findAtomicTransaction(c){const d=this.findTxid(c);if(d==null||d.tx==null)return;const y=(p,g)=>{const b=p.findBump(g.id("hex"));if(b!=null)g.merklePath=b;else for(const w of g.inputs){if(w.sourceTransaction==null){const v=p.findTxid(a(w.sourceTXID));v!=null&&(w.sourceTransaction=v.tx)}if(w.sourceTransaction!=null){const v=p.findBump(w.sourceTransaction.id("hex"));v!=null?w.sourceTransaction.merklePath=v:y(p,w.sourceTransaction)}}};return y(this,d.tx),d.tx}mergeBump(c){let d;for(let p=0;p<this.bumps.length;p++){const g=this.bumps[p];if(g===c)return p;if(g.blockHeight===c.blockHeight){const b=g.computeRoot(),w=c.computeRoot();if(b===w){g.combine(c),d=p;break}}}d===void 0&&(d=this.bumps.length,this.bumps.push(c));const y=this.bumps[d];for(const p of this.txs){const g=p.txid;if(p.bumpIndex==null){for(const b of y.path[0])if(b.hash===g){p.bumpIndex=d,b.txid=!0;break}}}return d}mergeRawTx(c,d){const y=new r.default(c,d);return this.removeExistingTxid(y.txid),this.txs.push(y),this.tryToValidateBumpIndex(y),y}mergeTransaction(c){const d=c.id("hex");this.removeExistingTxid(d);let y;c.merklePath!=null&&(y=this.mergeBump(c.merklePath));const p=new r.default(c,y);if(this.txs.push(p),this.tryToValidateBumpIndex(p),y=p.bumpIndex,y===void 0)for(const g of c.inputs)g.sourceTransaction!=null&&this.mergeTransaction(g.sourceTransaction);return p}removeExistingTxid(c){const d=this.txs.findIndex(y=>y.txid===c);d>=0&&this.txs.splice(d,1)}mergeTxidOnly(c){let d=this.txs.find(y=>y.txid===c);return d==null&&(d=new r.default(c),this.txs.push(d),this.tryToValidateBumpIndex(d)),d}mergeBeefTx(c){let d=this.findTxid(c.txid);if(c.isTxidOnly&&d==null?d=this.mergeTxidOnly(c.txid):c._tx!=null&&(d==null||d.isTxidOnly)?d=this.mergeTransaction(c._tx):c._rawTx!=null&&(d==null||d.isTxidOnly)&&(d=this.mergeRawTx(c._rawTx)),d==null)throw new Error(`Failed to merge BeefTx for txid: ${c.txid}`);return d}mergeBeef(c){const d=Array.isArray(c)?Yc.fromBinary(c):c;for(const y of d.bumps)this.mergeBump(y);for(const y of d.txs)this.mergeBeefTx(y)}isValid(c){return this.verifyValid(c).valid}async verify(c,d){const y=this.verifyValid(d);if(!y.valid)return!1;for(const p of Object.keys(y.roots))if(!await c.isValidRootForHeight(y.roots[p],Number(p)))return!1;return!0}verifyValid(c){const d={valid:!1,roots:{}},y=this.sortTxs();if(y.missingInputs.length>0||y.notValid.length>0||y.txidOnly.length>0&&c!==!0||y.withMissingInputs.length>0)return d;const p={};for(const b of this.txs)if(b.isTxidOnly){if(c!==!0)return d;p[b.txid]=!0}const g=(b,w)=>{const v=b.computeRoot(w);return(d.roots[b.blockHeight]===void 0||d.roots[b.blockHeight]==="")&&(d.roots[b.blockHeight]=v),d.roots[b.blockHeight]===v};for(const b of this.bumps)for(const w of b.path[0])if(w.txid===!0&&typeof w.hash=="string"&&w.hash.length>0&&(p[w.hash]=!0,!g(b,w.hash)))return d;for(const b of this.txs)if(b.bumpIndex!==void 0&&this.bumps[b.bumpIndex].path[0].find(v=>v.hash===b.txid)==null)return d;for(const b of this.txs){for(const w of b.inputTxids)if(!p[w])return d;p[b.txid]=!0}return d.valid=!0,d}toWriter(c){c.writeUInt32LE(this.version),c.writeVarIntNum(this.bumps.length);for(const d of this.bumps)c.write(d.toBinary());c.writeVarIntNum(this.txs.length);for(const d of this.txs)d.toWriter(c,this.version)}toBinary(){this.sortTxs();const c=new e.Writer;return this.toWriter(c),c.toArray()}toBinaryAtomic(c){this.sortTxs();const d=this.findTxid(c);if(d==null)throw new Error(`${c} does not exist in this Beef`);const y=this.txs[this.txs.length-1]===d?this:this.clone();if(y!==this){const g=this.txs.findIndex(b=>b.txid===c);y.txs.splice(g+1)}const p=new e.Writer;return p.writeUInt32LE(s.ATOMIC_BEEF),p.writeReverse((0,e.toArray)(c,"hex")),y.toWriter(p),p.toArray()}toHex(){return(0,e.toHex)(this.toBinary())}static fromReader(c){let d=c.readUInt32LE(),y;if(d===s.ATOMIC_BEEF&&(y=(0,e.toHex)(c.readReverse(32)),d=c.readUInt32LE()),d!==s.BEEF_V1&&d!==s.BEEF_V2)throw new Error(`Serialized BEEF must start with ${s.BEEF_V1} or ${s.BEEF_V2} but starts with ${d}`);const p=new Yc(d),g=c.readVarIntNum();for(let w=0;w<g;w++){const v=i.default.fromReader(c,!1);p.bumps.push(v)}const b=c.readVarIntNum();for(let w=0;w<b;w++){const v=r.default.fromReader(c,d);p.txs.push(v)}return p.atomicTxid=y,p}static fromBinary(c){const d=new e.Reader(c);return Yc.fromReader(d)}static fromString(c,d="hex"){const y=(0,e.toArray)(c,d),p=new e.Reader(y);return Yc.fromReader(p)}tryToValidateBumpIndex(c){if(c.bumpIndex!==void 0)return!0;const d=c.txid;for(let y=0;y<this.bumps.length;y++){const p=this.bumps[y].path[0].findIndex(g=>g.hash===d);if(p>=0)return c.bumpIndex=y,this.bumps[y].path[0][p].txid=!0,!0}return!1}sortTxs(){const c={},d={};let y=[];const p=[],g=[];for(const S of this.txs)d[S.txid]=S,S.isValid=S.hasProof,S.isValid?(c[S.txid]=!0,p.push(S)):S.isTxidOnly&&S.inputTxids.length===0?(c[S.txid]=!0,g.push(S)):y.push(S);const b={},w=[],v=y;y=[];for(const S of v){let T=!1;for(const I of S.inputTxids)d[I]===void 0&&(b[I]=!0,T=!0);T?w.push(S):y.push(S)}for(;y.length>0;){const S=y;y=[];for(const T of S)T.inputTxids.every(I=>c[I])?(c[T.txid]=!0,p.push(T)):y.push(T);if(S.length===y.length)break}const _=y;return this.txs=w.concat(_).concat(g).concat(p),{missingInputs:Object.keys(b),notValid:_.map(S=>S.txid),valid:Object.keys(c),withMissingInputs:w.map(S=>S.txid),txidOnly:g.map(S=>S.txid)}}clone(){const c=new Yc;return c.version=this.version,c.bumps=Array.from(this.bumps),c.txs=Array.from(this.txs),c}trimKnownTxids(c){for(let d=0;d<this.txs.length;){const y=this.txs[d];y.isTxidOnly&&c.includes(y.txid)?this.txs.splice(d,1):d++}}getValidTxids(){return this.sortTxs().valid}toLogString(){var c,d;let y="";y+=`BEEF with ${this.bumps.length} BUMPS and ${this.txs.length} Transactions, isValid ${this.isValid().toString()}
`;let p=-1;for(const g of this.bumps)p++,y+=`  BUMP ${p}
    block: ${g.blockHeight}
    txids: [
${g.path[0].filter(b=>b.txid===!0).map(b=>{var w;return`      '${(w=b.hash)!==null&&w!==void 0?w:""}'`}).join(`,
`)}
    ]
`;p=-1;for(const g of this.txs)p++,y+=`  TX ${p}
    txid: ${g.txid}
`,g.bumpIndex!==void 0&&(y+=`    bumpIndex: ${g.bumpIndex}
`),g.isTxidOnly?y+=`    txidOnly
`:y+=`    rawTx length=${(d=(c=g.rawTx)===null||c===void 0?void 0:c.length)!==null&&d!==void 0?d:0}
`,g.inputTxids.length>0&&(y+=`    inputs: [
${g.inputTxids.map(b=>`      '${b}'`).join(`,
`)}
    ]
`);return y}addComputedLeaves(){const c=d=>(0,e.toHex)((0,o.hash256)((0,e.toArray)(d,"hex").reverse()).reverse());for(const d of this.bumps)for(let y=1;y<d.path.length;y++)for(const p of d.path[y-1])if(typeof p.hash=="string"&&(p.offset&1)===0){const g=d.path[y-1].find(w=>w.offset===p.offset+1),b=p.offset>>1;g!==void 0&&typeof g.hash=="string"&&d.path[y].every(w=>w.offset!==b)&&d.path[y].push({offset:b,hash:c(g.hash+p.hash)})}}};s.Beef=f}(Ol)),Ol}var RS;function vf(){if(RS)return Rc;RS=1;var s=Rc&&Rc.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(Rc,"__esModule",{value:!0});const t=s(k0()),i=s(bf()),r=me(),e=li(),o=s(rI()),a=s(iI()),l=uI(),f=dI(),n=wf(),c=s(h1());let d=class or{static addPathOrInputs(p,g,b){var w;if(typeof p.pathIndex=="number"){const v=b[p.pathIndex];if(typeof v!="object")throw new Error("Invalid merkle path index found in BEEF!");p.tx.merklePath=v}else for(const v of p.tx.inputs){if(v.sourceTXID===void 0)throw new Error("Input sourceTXID is undefined");const _=g[v.sourceTXID];if(typeof _!="object")throw new Error(`Reference to unknown TXID in BEEF: ${(w=v.sourceTXID)!==null&&w!==void 0?w:"undefined"}`);v.sourceTransaction=_.tx,this.addPathOrInputs(_,g,b)}}static fromBEEF(p,g){const{tx:b}=or.fromAnyBeef(p,g);return b}static fromAtomicBEEF(p){const{tx:g,txid:b,beef:w}=or.fromAnyBeef(p);if(b!==w.atomicTxid)throw w.atomicTxid?new Error(`Transaction with TXID ${w.atomicTxid} not found in BEEF data.`):new Error("beef must conform to BRC-95 and must contain the subject txid.");return g}static fromAnyBeef(p,g){const b=n.Beef.fromBinary(p);if(b.txs.length<1)throw new Error("beef must include at least one transaction.");const w=g||b.atomicTxid||b.txs.slice(-1)[0].txid,v=b.findAtomicTransaction(w);if(v==null)throw g?new Error(`Transaction with TXID ${w} not found in BEEF data.`):new Error("beef does not contain transaction for atomic txid.");return{tx:v,beef:b,txid:w}}static fromEF(p){const g=new r.Reader(p),b=g.readUInt32LE();if((0,r.toHex)(g.read(6))!=="0000000000ef")throw new Error("Invalid EF marker");const w=g.readVarIntNum(),v=[];for(let I=0;I<w;I++){const k=(0,r.toHex)(g.readReverse(32)),O=g.readUInt32LE(),A=g.readVarIntNum(),R=g.read(A),P=t.default.fromBinary(R),C=g.readUInt32LE(),N=g.readUInt64LEBn().toNumber(),D=g.readVarIntNum(),U=g.read(D),F=i.default.fromBinary(U),L=new or(void 0,[],[],void 0);L.outputs=Array(O+1).fill(null),L.outputs[O]={satoshis:N,lockingScript:F},v.push({sourceTransaction:L,sourceTXID:k,sourceOutputIndex:O,unlockingScript:P,sequence:C})}const _=g.readVarIntNum(),S=[];for(let I=0;I<_;I++){const k=g.readUInt64LEBn().toNumber(),O=g.readVarIntNum(),A=g.read(O),R=i.default.fromBinary(A);S.push({satoshis:k,lockingScript:R})}const T=g.readUInt32LE();return new or(b,v,S,T)}static parseScriptOffsets(p){const g=new r.Reader(p),b=[],w=[];g.pos+=4;const v=g.readVarIntNum();for(let S=0;S<v;S++){g.pos+=36;const T=g.readVarIntNum();b.push({vin:S,offset:g.pos,length:T}),g.pos+=T+4}const _=g.readVarIntNum();for(let S=0;S<_;S++){g.pos+=8;const T=g.readVarIntNum();w.push({vout:S,offset:g.pos,length:T}),g.pos+=T}return{inputs:b,outputs:w}}static fromReader(p){const g=p.readUInt32LE(),b=p.readVarIntNum(),w=[];for(let T=0;T<b;T++){const I=(0,r.toHex)(p.readReverse(32)),k=p.readUInt32LE(),O=p.readVarIntNum(),A=p.read(O),R=t.default.fromBinary(A),P=p.readUInt32LE();w.push({sourceTXID:I,sourceOutputIndex:k,unlockingScript:R,sequence:P})}const v=p.readVarIntNum(),_=[];for(let T=0;T<v;T++){const I=p.readUInt64LEBn().toNumber(),k=p.readVarIntNum(),O=p.read(k),A=i.default.fromBinary(O);_.push({satoshis:I,lockingScript:A})}const S=p.readUInt32LE();return new or(g,w,_,S)}static fromBinary(p){const g=new r.Reader(p);return or.fromReader(g)}static fromHex(p){return or.fromBinary((0,r.toArray)(p,"hex"))}static fromHexEF(p){return or.fromEF((0,r.toArray)(p,"hex"))}static fromHexBEEF(p,g){return or.fromBEEF((0,r.toArray)(p,"hex"),g)}constructor(p=1,g=[],b=[],w=0,v={},_){this.version=p,this.inputs=g,this.outputs=b,this.lockTime=w,this.metadata=v,this.merklePath=_}addInput(p){if(typeof p.sourceTXID>"u"&&typeof p.sourceTransaction>"u")throw new Error("A reference to an an input transaction is required. If the input transaction itself cannot be referenced, its TXID must still be provided.");typeof p.sequence>"u"&&(p.sequence=4294967295),this.cachedHash=void 0,this.inputs.push(p)}addOutput(p){if(this.cachedHash=void 0,p.change!==!0){if(typeof p.satoshis>"u")throw new Error("either satoshis must be defined or change must be set to true");if(p.satoshis<0)throw new Error("satoshis must be a positive integer or zero")}if(p.lockingScript==null)throw new Error("lockingScript must be defined");this.outputs.push(p)}addP2PKHOutput(p,g){const b=new c.default().lock(p);if(typeof g>"u")return this.addOutput({lockingScript:b,change:!0});this.addOutput({lockingScript:b,satoshis:g})}updateMetadata(p){this.metadata={...this.metadata,...p}}async fee(p=new o.default(1),g="equal"){if(this.cachedHash=void 0,typeof p=="number"){const v=p;p={computeFee:async()=>v}}const b=await p.computeFee(this),w=this.calculateChange(b);if(w<=0){this.outputs=this.outputs.filter(v=>v.change!==!0);return}this.distributeChange(w,g)}calculateChange(p){var g;let b=0;for(const w of this.inputs){if(typeof w.sourceTransaction!="object")throw new Error("Source transactions are required for all inputs during fee computation");b+=(g=w.sourceTransaction.outputs[w.sourceOutputIndex].satoshis)!==null&&g!==void 0?g:0}b-=p;for(const w of this.outputs)w.change!==!0&&w.satoshis!==void 0&&(b-=w.satoshis);return b}distributeChange(p,g){let b=0;const w=this.outputs.filter(v=>v.change);if(g==="random"?b=this.distributeRandomChange(p,w):g==="equal"&&(b=this.distributeEqualChange(p,w)),b<p){const v=this.outputs[this.outputs.length-1];v.satoshis!==void 0?v.satoshis+=p-b:v.satoshis=p-b}}distributeRandomChange(p,g){let b=0,w=p;const v=Array(g.length).fill(1);w-=g.length,b+=g.length;for(let _=0;_<g.length-1;_++){const S=this.benfordNumber(0,w);v[_]=v[_]+S,b+=S,w-=S}for(const _ of this.outputs)_.change===!0&&(_.satoshis=v.shift());return b}distributeEqualChange(p,g){let b=0;const w=Math.floor(p/g.length);for(const v of g)b+=w,v.satoshis=w;return b}benfordNumber(p,g){const b=Math.floor(Math.random()*9)+1;return Math.floor(p+(g-p)*Math.log10(1+1/b)/Math.log10(10))}getFee(){var p,g;let b=0;for(const v of this.inputs){if(typeof v.sourceTransaction!="object")throw new Error("Source transactions or sourceSatoshis are required for all inputs to calculate fee");b+=(p=v.sourceTransaction.outputs[v.sourceOutputIndex].satoshis)!==null&&p!==void 0?p:0}let w=0;for(const v of this.outputs)w+=(g=v.satoshis)!==null&&g!==void 0?g:0;return b-w}async sign(){this.cachedHash=void 0;for(const g of this.outputs)if(typeof g.satoshis>"u")throw g.change===!0?new Error("There are still change outputs with uncomputed amounts. Use the fee() method to compute the change amounts and transaction fees prior to signing."):new Error("One or more transaction outputs is missing an amount. Ensure all output amounts are provided before signing.");const p=await Promise.all(this.inputs.map(async(g,b)=>{var w,v;return typeof this.inputs[b].unlockingScriptTemplate=="object"?await((v=(w=this.inputs[b])===null||w===void 0?void 0:w.unlockingScriptTemplate)===null||v===void 0?void 0:v.sign(this,b)):await Promise.resolve(void 0)}));for(let g=0,b=this.inputs.length;g<b;g++)typeof this.inputs[g].unlockingScriptTemplate=="object"&&(this.inputs[g].unlockingScript=p[g])}async broadcast(p=(0,l.defaultBroadcaster)()){return await p.broadcast(this)}toBinary(){var p,g;const b=new r.Writer;b.writeUInt32LE(this.version),b.writeVarIntNum(this.inputs.length);for(const w of this.inputs){if(typeof w.sourceTXID>"u")if(w.sourceTransaction!=null)b.write(w.sourceTransaction.hash());else throw new Error("sourceTransaction is undefined");else b.writeReverse((0,r.toArray)(w.sourceTXID,"hex"));if(b.writeUInt32LE(w.sourceOutputIndex),w.unlockingScript==null)throw new Error("unlockingScript is undefined");const v=w.unlockingScript.toBinary();b.writeVarIntNum(v.length),b.write(v),b.writeUInt32LE((p=w.sequence)!==null&&p!==void 0?p:0)}b.writeVarIntNum(this.outputs.length);for(const w of this.outputs){b.writeUInt64LE((g=w.satoshis)!==null&&g!==void 0?g:0);const v=w.lockingScript.toBinary();b.writeVarIntNum(v.length),b.write(v)}return b.writeUInt32LE(this.lockTime),b.toArray()}toEF(){var p,g,b;const w=new r.Writer;w.writeUInt32LE(this.version),w.write([0,0,0,0,0,239]),w.writeVarIntNum(this.inputs.length);for(const v of this.inputs){if(typeof v.sourceTransaction>"u")throw new Error("All inputs must have source transactions when serializing to EF format");if(typeof v.sourceTXID>"u"?w.write(v.sourceTransaction.hash()):w.write((0,r.toArray)(v.sourceTXID,"hex").reverse()),w.writeUInt32LE(v.sourceOutputIndex),v.unlockingScript==null)throw new Error("unlockingScript is undefined");const _=v.unlockingScript.toBinary();w.writeVarIntNum(_.length),w.write(_),w.writeUInt32LE((p=v.sequence)!==null&&p!==void 0?p:0),w.writeUInt64LE((g=v.sourceTransaction.outputs[v.sourceOutputIndex].satoshis)!==null&&g!==void 0?g:0);const S=v.sourceTransaction.outputs[v.sourceOutputIndex].lockingScript.toBinary();w.writeVarIntNum(S.length),w.write(S)}w.writeVarIntNum(this.outputs.length);for(const v of this.outputs){w.writeUInt64LE((b=v.satoshis)!==null&&b!==void 0?b:0);const _=v.lockingScript.toBinary();w.writeVarIntNum(_.length),w.write(_)}return w.writeUInt32LE(this.lockTime),w.toArray()}toHexEF(){return(0,r.toHex)(this.toEF())}toHex(){return(0,r.toHex)(this.toBinary())}toHexBEEF(){return(0,r.toHex)(this.toBEEF())}toHexAtomicBEEF(){return(0,r.toHex)(this.toAtomicBEEF())}hash(p){let g;return this.cachedHash!=null?g=this.cachedHash:(g=(0,e.hash256)(this.toBinary()),this.cachedHash=g),p==="hex"?(0,r.toHex)(g):g}id(p){const g=[...this.hash()];return g.reverse(),p==="hex"?(0,r.toHex)(g):g}async verify(p=(0,f.defaultChainTracker)(),g,b){var w,v,_,S;const T=new Set,I=[this];for(;I.length>0;){const k=I.shift(),O=(w=k==null?void 0:k.id("hex"))!==null&&w!==void 0?w:"";if(O!=null&&O!==""&&T.has(O))continue;if(typeof(k==null?void 0:k.merklePath)=="object"){if(p==="scripts only"){O!=null&&T.add(O);continue}else if(await k.merklePath.verify(O,p)){T.add(O);continue}}if(typeof g<"u"){if(k===void 0)throw new Error("Transaction is undefined");const P=or.fromEF(k.toEF());if(delete P.outputs[0].satoshis,P.outputs[0].change=!0,await P.fee(g),k.getFee()<P.getFee())throw new Error(`Verification failed because the transaction ${O} has an insufficient fee and has not been mined.`)}let A=0;if(k===void 0)throw new Error("Transaction is undefined");for(let P=0;P<k.inputs.length;P++){const C=k.inputs[P];if(typeof C.sourceTransaction!="object")throw new Error(`Verification failed because the input at index ${P} of transaction ${O} is missing an associated source transaction. This source transaction is required for transaction verification because there is no merkle proof for the transaction spending a UTXO it contains.`);if(typeof C.unlockingScript!="object")throw new Error(`Verification failed because the input at index ${P} of transaction ${O} is missing an associated unlocking script. This script is required for transaction verification because there is no merkle proof for the transaction spending the UTXO.`);const N=C.sourceTransaction.outputs[C.sourceOutputIndex];A+=(v=N.satoshis)!==null&&v!==void 0?v:0;const D=C.sourceTransaction.id("hex");T.has(D)||I.push(C.sourceTransaction);const U=k.inputs.filter((j,V)=>V!==P);if(typeof C.sourceTXID>"u"&&(C.sourceTXID=D),!new a.default({sourceTXID:C.sourceTXID,sourceOutputIndex:C.sourceOutputIndex,lockingScript:N.lockingScript,sourceSatoshis:(_=N.satoshis)!==null&&_!==void 0?_:0,transactionVersion:k.version,otherInputs:U,unlockingScript:C.unlockingScript,inputSequence:(S=C.sequence)!==null&&S!==void 0?S:0,inputIndex:P,outputs:k.outputs,lockTime:k.lockTime,memoryLimit:b}).validate())return!1}let R=0;for(const P of k.outputs){if(typeof P.satoshis!="number")throw new Error("Every output must have a defined amount during transaction verification.");R+=P.satoshis}if(R>A)return!1;T.add(O)}return!0}toBEEF(p){const g=new r.Writer;g.writeUInt32LE(n.BEEF_V1);const b=[],w=[],v=_=>{const S={tx:_},T=typeof _.merklePath=="object";if(T){let k=!1;for(let O=0;O<b.length;O++){if(b[O]===_.merklePath){S.pathIndex=O,k=!0;break}if(_.merklePath!==null&&_.merklePath!==void 0&&b[O].blockHeight===_.merklePath.blockHeight){const A=b[O].computeRoot(),R=_.merklePath.computeRoot();if(A===R){b[O].combine(_.merklePath),S.pathIndex=O,k=!0;break}}}k||(S.pathIndex=b.length,_.merklePath!==null&&_.merklePath!==void 0&&b.push(_.merklePath))}if(w.some(k=>k.tx.id("hex")===_.id("hex"))||w.unshift(S),!T)for(let k=0;k<_.inputs.length;k++){const O=_.inputs[k];if(typeof O.sourceTransaction=="object")v(O.sourceTransaction);else if(p===!1)throw new Error("A required source transaction is missing!")}};v(this),g.writeVarIntNum(b.length);for(const _ of b)g.write(_.toBinary());g.writeVarIntNum(w.length);for(const _ of w)g.write(_.tx.toBinary()),typeof _.pathIndex=="number"?(g.writeUInt8(1),g.writeVarIntNum(_.pathIndex)):g.writeUInt8(0);return g.toArray()}toAtomicBEEF(p){const g=new r.Writer;g.writeUInt32LE(16843009),g.write(this.hash());const b=this.toBEEF(p);return g.write(b),g.toArray()}};return Rc.default=d,Rc}var Us={},MS;function CC(){if(MS)return Us;MS=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.isBroadcastFailure=Us.isBroadcastResponse=void 0;function s(i){return i.status==="success"}Us.isBroadcastResponse=s;function t(i){return i.status==="error"}return Us.isBroadcastFailure=t,Us}var Cc={},NS;function DC(){if(NS)return Cc;NS=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.BeefParty=void 0;const s=wf();let t=class extends s.Beef{constructor(r){if(super(),this.knownTo={},r!=null)for(const e of r)this.addParty(e)}isParty(r){return Object.keys(this.knownTo).includes(r)}addParty(r){if(this.isParty(r))throw new Error(`Party ${r} already exists.`);this.knownTo[r]={}}getKnownTxidsForParty(r){const e=this.knownTo[r];if(e===void 0)throw new Error(`Party ${r} is unknown.`);return Object.keys(e)}getTrimmedBeefForParty(r){const e=this.getKnownTxidsForParty(r),o=this.clone();return o.trimKnownTxids(e),o}addKnownTxidsForParty(r,e){this.isParty(r)||this.addParty(r);const o=this.knownTo[r];for(const a of e)o[a]=!0,this.mergeTxidOnly(a)}mergeBeefFromParty(r,e){const o=Array.isArray(e)?s.Beef.fromBinary(e):e,a=o.getValidTxids();this.mergeBeef(o),this.addKnownTxidsForParty(r,a)}};return Cc.BeefParty=t,Cc.default=t,Cc}var CS;function xf(){return CS||(CS=1,function(s){var t=aa&&aa.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),i=aa&&aa.__exportStar||function(n,c){for(var d in n)d!=="default"&&!Object.prototype.hasOwnProperty.call(c,d)&&t(c,n,d)},r=aa&&aa.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.BeefParty=s.BeefTx=s.isBroadcastFailure=s.isBroadcastResponse=s.MerklePath=s.Transaction=void 0;var e=vf();Object.defineProperty(s,"Transaction",{enumerable:!0,get:function(){return r(e).default}});var o=fI();Object.defineProperty(s,"MerklePath",{enumerable:!0,get:function(){return r(o).default}});var a=CC();Object.defineProperty(s,"isBroadcastResponse",{enumerable:!0,get:function(){return a.isBroadcastResponse}}),Object.defineProperty(s,"isBroadcastFailure",{enumerable:!0,get:function(){return a.isBroadcastFailure}});var l=hI();Object.defineProperty(s,"BeefTx",{enumerable:!0,get:function(){return r(l).default}}),i(wf(),s);var f=DC();Object.defineProperty(s,"BeefParty",{enumerable:!0,get:function(){return r(f).default}})}(aa)),aa}var Al={},DS;function BC(){return DS||(DS=1,function(s){var t=Al&&Al.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0}),s.SatoshisPerKilobyte=void 0;var i=rI();Object.defineProperty(s,"SatoshisPerKilobyte",{enumerable:!0,get:function(){return t(i).default}})}(Al)),Al}var Pl={},Qh={},BS;function FC(){if(BS)return Qh;BS=1,Object.defineProperty(Qh,"__esModule",{value:!0});const s=A0();let t=class{constructor(r="main",e=(0,s.defaultHttpClient)()){this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}/tx/raw`,this.httpClient=e}async broadcast(r){var e,o;const a=r.toHex(),l={method:"POST",headers:{"Content-Type":"application/json",Accept:"text/plain"},data:{txhex:a}};try{const f=await this.httpClient.request(this.URL,l);return f.ok?{status:"success",txid:f.data,message:"broadcast successful"}:{status:"error",code:(e=f.status.toString())!==null&&e!==void 0?e:"ERR_UNKNOWN",description:(o=f.data)!==null&&o!==void 0?o:"Unknown error"}}catch(f){return{status:"error",code:"500",description:typeof f.message=="string"?f.message:"Internal Server Error"}}}};return Qh.default=t,Qh}var Zh={},pm={},sa={},FS;function LC(){if(FS)return sa;FS=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.binaryHttpClient=sa.BinaryFetchClient=sa.BinaryNodejsHttpClient=void 0;class s{constructor(e){this.https=e}async request(e,o){return await new Promise((a,l)=>{const f=this.https.request(e,o,n=>{let c="";n.on("data",d=>{c+=d}),n.on("end",()=>{const d=n.statusCode>=200&&n.statusCode<=299,y=n.headers["content-type"],p=c!==""&&typeof y=="string"&&y.startsWith("application/json")?JSON.parse(c):c;a({status:n.statusCode,statusText:n.statusMessage,ok:d,data:p})})});f.on("error",n=>{l(n)}),o.data!==null&&o.data!==void 0&&f.write(Buffer.from(o.data)),f.end()})}}sa.BinaryNodejsHttpClient=s;let t=class{constructor(e){this.fetch=e}async request(e,o){const a={method:o.method,headers:o.headers,body:o.data},l=await this.fetch(e,a),f=await l.text();return{ok:l.ok,status:l.status,statusText:l.statusText,data:f}}};sa.BinaryFetchClient=t;function i(){const r={async request(...e){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new t(window.fetch.bind(window));if(typeof aI<"u")try{const e=S0;return new s(e)}catch{return r}else return r}return sa.binaryHttpClient=i,sa}var LS;function pI(){return LS||(LS=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.FetchHttpClient=s.NodejsHttpClient=s.binaryHttpClient=s.defaultHttpClient=void 0;var t=A0();Object.defineProperty(s,"defaultHttpClient",{enumerable:!0,get:function(){return t.defaultHttpClient}});var i=LC();Object.defineProperty(s,"binaryHttpClient",{enumerable:!0,get:function(){return i.binaryHttpClient}});var r=sI();Object.defineProperty(s,"NodejsHttpClient",{enumerable:!0,get:function(){return r.NodejsHttpClient}});var e=oI();Object.defineProperty(s,"FetchHttpClient",{enumerable:!0,get:function(){return e.FetchHttpClient}})}(pm)),pm}var US;function UC(){if(US)return Zh;US=1,Object.defineProperty(Zh,"__esModule",{value:!0});const s=pI();let t=class{constructor(r,e=(0,s.binaryHttpClient)()){this.URL=r,this.httpClient=e}async broadcast(r){var e,o;const a=r.toEF(),l={method:"POST",headers:{"Content-Type":"application/octet-stream"},data:new Blob([new Uint8Array(a)])};try{const f=await this.httpClient.request(this.URL,l);return f.ok?{status:"success",txid:r.id("hex"),message:"broadcast successful"}:{status:"error",code:(e=f.status.toString())!==null&&e!==void 0?e:"ERR_UNKNOWN",description:(o=f.data)!==null&&o!==void 0?o:"Unknown error"}}catch(f){return{status:"error",code:"500",description:typeof f.message=="string"?f.message:"Internal Server Error"}}}};return Zh.default=t,Zh}var qS;function qC(){return qS||(qS=1,function(s){var t=Pl&&Pl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(s,"__esModule",{value:!0}),s.defaultBroadcaster=s.Teranode=s.WhatsOnChainBroadcaster=s.ARC=void 0;var i=cI();Object.defineProperty(s,"ARC",{enumerable:!0,get:function(){return t(i).default}});var r=FC();Object.defineProperty(s,"WhatsOnChainBroadcaster",{enumerable:!0,get:function(){return t(r).default}});var e=UC();Object.defineProperty(s,"Teranode",{enumerable:!0,get:function(){return t(e).default}});var o=uI();Object.defineProperty(s,"defaultBroadcaster",{enumerable:!0,get:function(){return o.defaultBroadcaster}})}(Pl)),Pl}var Rl={},jS;function jC(){return jS||(jS=1,function(s){var t=Rl&&Rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.defaultChainTracker=s.WhatsOnChain=void 0;var i=lI();Object.defineProperty(s,"WhatsOnChain",{enumerable:!0,get:function(){return t(i).default}});var r=dI();Object.defineProperty(s,"defaultChainTracker",{enumerable:!0,get:function(){return r.defaultChainTracker}})}(Rl)),Rl}var on={},oa={},HS;function HC(){if(HS)return oa;HS=1;var s=oa&&oa.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(oa,"__esModule",{value:!0}),oa.verify=oa.sign=void 0;const t=s(ka()),i=s(bu()),r=s(gu()),e=s(Nr()),o=s(ji()),a=me(),l="42423301",f=(c,d,y)=>{const p=typeof y!="object";if(p){const I=new e.default,k=new i.default(1),O=I.g.mul(k);y=new t.default(O.x,O.y)}const g=(0,o.default)(32),w=`2-message signing-${(0,a.toBase64)(g)}`,_=d.deriveChild(y,w).sign(c).toDER(),S=d.toPublicKey().encode(!0);return[...(0,a.toArray)(l,"hex"),...S,...p?[0]:y.encode(!0),...g,..._]};oa.sign=f;const n=(c,d,y)=>{const p=new a.Reader(d),g=(0,a.toHex)(p.read(4));if(g!==l)throw new Error(`Message version mismatch: Expected ${l}, received ${g}`);const b=t.default.fromString((0,a.toHex)(p.read(33))),[w]=p.read(1);if(w===0)y=new i.default(1);else{const O=p.read(32),A=(0,a.toHex)([w,...O]);if(typeof y!="object")throw new Error(`This signature can only be verified with knowledge of a specific private key. The associated public key is: ${A}`);const R=y.toPublicKey().encode(!0,"hex");if(A!==R)throw new Error(`The recipient public key is ${R} but the signature requres the recipient to have public key ${A}`)}const v=(0,a.toBase64)(p.read(32)),_=(0,a.toHex)(p.read(p.bin.length-p.pos)),S=r.default.fromDER(_,"hex"),T=`2-message signing-${v}`;return b.deriveChild(y,T).verify(c,S)};return oa.verify=n,oa}var ca={},KS;function KC(){if(KS)return ca;KS=1;var s=ca&&ca.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(ca,"__esModule",{value:!0}),ca.decrypt=ca.encrypt=void 0;const t=s(ka()),i=s(T0()),r=s(ji()),e=me(),o="42421033",a=(f,n,c)=>{const d=(0,r.default)(32),p=`2-message encryption-${(0,e.toBase64)(d)}`,g=n.deriveChild(c,p),b=c.deriveChild(n,p),w=g.deriveSharedSecret(b),_=new i.default(w.encode(!0).slice(1)).encrypt(f),S=n.toPublicKey().encode(!0);return[...(0,e.toArray)(o,"hex"),...S,...c.encode(!0),...d,..._]};ca.encrypt=a;const l=(f,n)=>{const c=new e.Reader(f),d=(0,e.toHex)(c.read(4));if(d!==o)throw new Error(`Message version mismatch: Expected ${o}, received ${d}`);const y=t.default.fromString((0,e.toHex)(c.read(33))),p=(0,e.toHex)(c.read(33)),g=n.toPublicKey().encode(!0,"hex");if(p!==g)throw new Error(`The encrypted message expects a recipient public key of ${p}, but the provided key is ${g}`);const b=(0,e.toBase64)(c.read(32)),w=c.read(c.bin.length-c.pos),v=`2-message encryption-${b}`,_=y.deriveChild(n,v),S=n.deriveChild(y,v),T=_.deriveSharedSecret(S);return new i.default(T.encode(!0).slice(1)).decrypt(w)};return ca.decrypt=l,ca}var VS;function VC(){if(VS)return on;VS=1;var s=on&&on.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),t=on&&on.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),i=on&&on.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var o in r)o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)&&s(e,r,o);return t(e,r),e};return Object.defineProperty(on,"__esModule",{value:!0}),on.EncryptedMessage=on.SignedMessage=void 0,on.SignedMessage=i(HC()),on.EncryptedMessage=i(KC()),on}var Zn={},Jn={},WS;function WC(){return WS||(WS=1,function(s){var t=Jn&&Jn.__createBinding||(Object.create?function(p,g,b,w){w===void 0&&(w=b);var v=Object.getOwnPropertyDescriptor(g,b);(!v||("get"in v?!g.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return g[b]}}),Object.defineProperty(p,w,v)}:function(p,g,b,w){w===void 0&&(w=b),p[w]=g[b]}),i=Jn&&Jn.__setModuleDefault||(Object.create?function(p,g){Object.defineProperty(p,"default",{enumerable:!0,value:g})}:function(p,g){p.default=g}),r=Jn&&Jn.__importStar||function(p){if(p&&p.__esModule)return p;var g={};if(p!=null)for(var b in p)b!=="default"&&Object.prototype.hasOwnProperty.call(p,b)&&t(g,p,b);return i(g,p),g},e=Jn&&Jn.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(s,"__esModule",{value:!0}),s.verify=s.sign=s.magicHash=void 0;const o=e(ui()),a=me(),l=r(mu()),f=r(li()),n=`Bitcoin Signed Message:
`,c=p=>{const g=new a.Writer;g.writeVarIntNum(n.length),g.write((0,a.toArray)(n,"utf8")),g.writeVarIntNum(p.length),g.write(p);const b=g.toArray();return f.hash256(b)};s.magicHash=c;const d=(p,g,b="base64")=>{const w=(0,s.magicHash)(p),v=l.sign(new o.default(w),g,!0);if(b==="raw")return v;const _=new o.default(w),S=v.CalculateRecoveryFactor(g.toPublicKey(),_);return v.toCompact(S,!0,"base64")};s.sign=d;const y=(p,g,b)=>{const w=(0,s.magicHash)(p);return l.verify(new o.default(w),g,b)};s.verify=y}(Jn)),Jn}var On={},$S;function $C(){if($S)return On;$S=1;var s=On&&On.__createBinding||(Object.create?function(y,p,g,b){b===void 0&&(b=g);var w=Object.getOwnPropertyDescriptor(p,g);(!w||("get"in w?!p.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return p[g]}}),Object.defineProperty(y,b,w)}:function(y,p,g,b){b===void 0&&(b=g),y[b]=p[g]}),t=On&&On.__setModuleDefault||(Object.create?function(y,p){Object.defineProperty(y,"default",{enumerable:!0,value:p})}:function(y,p){y.default=p}),i=On&&On.__importStar||function(y){if(y&&y.__esModule)return y;var p={};if(y!=null)for(var g in y)g!=="default"&&Object.prototype.hasOwnProperty.call(y,g)&&s(p,y,g);return t(p,y),p},r=On&&On.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(On,"__esModule",{value:!0});const e=me(),o=i(li()),a=r(Nr()),l=r(bu()),f=r(ka()),n=r(ji()),c=r(ui());let d=class Ap{constructor(p,g,b,w,v,_,S){this.constants={pubKey:76067358,privKey:76066276},this.versionBytesNum=p,this.depth=g,this.parentFingerPrint=b,this.childIndex=w,this.chainCode=v,this.privKey=_,this.pubKey=S}fromRandom(){return this.versionBytesNum=this.constants.privKey,this.depth=0,this.parentFingerPrint=[0,0,0,0],this.childIndex=0,this.chainCode=(0,n.default)(32),this.privKey=l.default.fromRandom(),this.pubKey=this.privKey.toPublicKey(),this}static fromRandom(){return new this().fromRandom()}static fromString(p){return new this().fromString(p)}fromString(p){const g=(0,e.fromBase58Check)(p);return this.fromBinary([...g.prefix,...g.data])}static fromSeed(p){return new this().fromSeed(p)}fromSeed(p){if(p.length<128/8)throw new Error("Need more than 128 bits of entropy");if(p.length>512/8)throw new Error("More than 512 bits of entropy is nonstandard");const g=o.sha512hmac((0,e.toArray)("Bitcoin seed","utf8"),p);return this.depth=0,this.parentFingerPrint=[0,0,0,0],this.childIndex=0,this.chainCode=g.slice(32,64),this.versionBytesNum=this.constants.privKey,this.privKey=new l.default(g.slice(0,32)),this.pubKey=this.privKey.toPublicKey(),this}static fromBinary(p){return new this().fromBinary(p)}fromBinary(p){if(p.length!==78)throw new Error("incorrect bip32 data length");const g=new e.Reader(p);this.versionBytesNum=g.readUInt32BE(),this.depth=g.readUInt8(),this.parentFingerPrint=g.read(4),this.childIndex=g.readUInt32BE(),this.chainCode=g.read(32);const b=g.read(33),w=this.versionBytesNum===this.constants.privKey,v=this.versionBytesNum===this.constants.pubKey;if(w&&b[0]===0)this.privKey=new l.default(b.slice(1,33)),this.pubKey=this.privKey.toPublicKey();else if(v&&(b[0]===2||b[0]===3))this.pubKey=f.default.fromString((0,e.toHex)(b));else throw new Error("Invalid key");return this}toString(){const p=this.toBinary();return(0,e.toBase58Check)(p,[])}derive(p){if(p==="m")return this;const g=p.split("/");let b=this;for(const[w,v]of g.entries()){if(w===0){if(v!=="m")throw new Error("invalid path");continue}if(parseInt(v.replace("'",""),10).toString()!==v.replace("'",""))throw new Error("invalid path");const _=v.length>1&&v[v.length-1]==="'";let S=parseInt(_?v.slice(0,v.length-1):v,10)&2147483647;_&&(S+=2147483648),b=b.deriveChild(S)}return b}deriveChild(p){if(typeof p!="number")throw new Error("i must be a number");const g=[];g.push(p>>24&255),g.push(p>>16&255),g.push(p>>8&255),g.push(p&255);const b=[...g],w=(p&2147483648)!==0,v=this.versionBytesNum===this.constants.privKey;if(w&&(this.privKey===null||this.privKey===void 0||!v))throw new Error("Cannot do private key derivation without private key");let _=null;if(this.privKey!==null&&this.privKey!==void 0){let T=null;w?T=[0,...this.privKey.toArray("be",32),...b]:T=[...this.pubKey.encode(!0),...b];const I=o.sha512hmac(this.chainCode,T),k=new c.default(I.slice(0,32)),O=I.slice(32,64),A=k.add(this.privKey).mod(new a.default().n);_=new Ap,_.chainCode=O,_.privKey=new l.default(A.toArray()),_.pubKey=_.privKey.toPublicKey()}else{const T=[...this.pubKey.encode(!0),...b],I=o.sha512hmac(this.chainCode,T),k=new c.default(I.slice(0,32)),O=I.slice(32,64),A=new a.default().g.mul(k),R=this.pubKey,P=A.add(R),C=new f.default(P.x,P.y);_=new Ap,_.chainCode=O,_.pubKey=C}_.childIndex=p;const S=o.hash160(this.pubKey.encode(!0));return _.parentFingerPrint=S.slice(0,4),_.versionBytesNum=this.versionBytesNum,_.depth=this.depth+1,_}toPublic(){const p=new Ap(this.versionBytesNum,this.depth,this.parentFingerPrint,this.childIndex,this.chainCode,this.privKey,this.pubKey);return p.versionBytesNum=this.constants.pubKey,p.privKey=void 0,p}toBinary(){const p=this.versionBytesNum===this.constants.privKey,g=this.versionBytesNum===this.constants.pubKey;if(p)return new e.Writer().writeUInt32BE(this.versionBytesNum).writeUInt8(this.depth).write(this.parentFingerPrint).writeUInt32BE(this.childIndex).write(this.chainCode).writeUInt8(0).write(this.privKey.toArray("be",32)).toArray();if(g)return new e.Writer().writeUInt32BE(this.versionBytesNum).writeUInt8(this.depth).write(this.parentFingerPrint).writeUInt32BE(this.childIndex).write(this.chainCode).write(this.pubKey.encode(!0)).toArray();throw new Error("bip32: invalid versionBytesNum byte")}isPrivate(){return this.versionBytesNum===this.constants.privKey}};return On.default=d,On}var An={},Ml={},zS;function zC(){return zS||(zS=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.wordList=void 0,Ml.wordList={value:["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"],space:" "}),Ml}var XS;function XC(){if(XS)return An;XS=1;var s=An&&An.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),t=An&&An.__setModuleDefault||(Object.create?function(n,c){Object.defineProperty(n,"default",{enumerable:!0,value:c})}:function(n,c){n.default=c}),i=An&&An.__importStar||function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var d in n)d!=="default"&&Object.prototype.hasOwnProperty.call(n,d)&&s(c,n,d);return t(c,n),c},r=An&&An.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(An,"__esModule",{value:!0});const e=zC(),o=me(),a=i(li()),l=r(ji());let f=class yI{constructor(c,d,y=e.wordList){this.mnemonic=c??"",this.seed=d??[],this.Wordlist=y}toBinary(){const c=new o.Writer;if(this.mnemonic!==""){const d=(0,o.toArray)(this.mnemonic,"utf8");c.writeVarIntNum(d.length),c.write(d)}else c.writeVarIntNum(0);return this.seed.length>0?(c.writeVarIntNum(this.seed.length),c.write(this.seed)):c.writeVarIntNum(0),c.toArray()}fromBinary(c){const d=new o.Reader(c),y=d.readVarIntNum();y>0&&(this.mnemonic=(0,o.encode)(d.read(y),"utf8"));const p=d.readVarIntNum();return p>0&&(this.seed=d.read(p)),this}fromRandom(c){if((c==null||isNaN(c)||c===0)&&(c=128),c%32!==0)throw new Error("bits must be multiple of 32");if(c<128)throw new Error("bits must be at least 128");const d=(0,l.default)(c/8);return this.entropy2Mnemonic(d),this.mnemonic2Seed(),this}static fromRandom(c){return new this().fromRandom(c)}fromEntropy(c){return this.entropy2Mnemonic(c),this}static fromEntropy(c){return new this().fromEntropy(c)}fromString(c){return this.mnemonic=c,this}static fromString(c){return new this().fromString(c)}toString(){return this.mnemonic}toSeed(c){return this.mnemonic2Seed(c),this.seed}entropy2Mnemonic(c){if(c.length<128/8)throw new Error("Entropy is less than 128 bits. It must be 128 bits or more.");const d=a.sha256(c);let y="";const p=c.length*8;for(let w=0;w<c.length;w++)y=y+("00000000"+c[w].toString(2)).slice(-8);let g=d[0].toString(2);if(g=("00000000"+g).slice(-8).slice(0,p/32),y=y+g,y.length%11!==0)throw new Error("internal error - entropy not an even multiple of 11 bits - "+y.length.toString());let b="";for(let w=0;w<y.length/11;w++){b!==""&&(b=b+this.Wordlist.space);const v=parseInt(y.slice(w*11,(w+1)*11),2);b=b+this.Wordlist.value[v]}return this.mnemonic=b,this}check(){const d=this.mnemonic.split(this.Wordlist.space);let y="";for(let S=0;S<d.length;S++){const T=this.Wordlist.value.indexOf(d[S]);if(T<0)return!1;y=y+("00000000000"+T.toString(2)).slice(-11)}if(y.length%11!==0)throw new Error("internal error - entropy not an even multiple of 11 bits - "+y.length.toString());const p=y.length/33,g=y.slice(-p),b=y.slice(0,y.length-p),w=[];for(let S=0;S<b.length/8;S++)w.push(parseInt(y.slice(S*8,(S+1)*8),2));let _=a.sha256(w.slice(0,b.length/8))[0].toString(2);return _=("00000000"+_).slice(-8).slice(0,p),_===g}mnemonic2Seed(c=""){let d=this.mnemonic;if(!this.check())throw new Error("Mnemonic does not pass the check - was the mnemonic typed incorrectly? Are there extra spaces?");if(typeof c!="string")throw new Error("passphrase must be a string or undefined");d=d.normalize("NFKD"),c=c.normalize("NFKD");const y=(0,o.toArray)(d,"utf8"),p=[...(0,o.toArray)("mnemonic","utf8"),...(0,o.toArray)(c,"utf8")];return this.seed=a.pbkdf2(y,p,2048,64,"sha512"),this}isValid(c=""){let d;try{this.mnemonic2Seed(c),d=!0}catch{d=!1}return d}static isValid(c,d=""){return new yI(c).isValid(d)}};return An.default=f,An}var Pn={},GS;function GC(){if(GS)return Pn;GS=1;var s=Pn&&Pn.__createBinding||(Object.create?function(b,w,v,_){_===void 0&&(_=v);var S=Object.getOwnPropertyDescriptor(w,v);(!S||("get"in S?!w.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return w[v]}}),Object.defineProperty(b,_,S)}:function(b,w,v,_){_===void 0&&(_=v),b[_]=w[v]}),t=Pn&&Pn.__setModuleDefault||(Object.create?function(b,w){Object.defineProperty(b,"default",{enumerable:!0,value:w})}:function(b,w){b.default=w}),i=Pn&&Pn.__importStar||function(b){if(b&&b.__esModule)return b;var w={};if(b!=null)for(var v in b)v!=="default"&&Object.prototype.hasOwnProperty.call(b,v)&&s(w,b,v);return t(w,b),w},r=Pn&&Pn.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(Pn,"__esModule",{value:!0});const e=r(ji()),o=r(bu()),a=r(ka()),l=r(yu()),f=i(li()),n=me();function c(b){this._tables[0][0][0]===0&&this._precompute();let w,v,_;const S=this._tables[0][4],T=this._tables[1],I=b.length;let k=1;if(I!==4&&I!==6&&I!==8)throw new Error("invalid aes key size");this._key=[v=b.slice(0),_=[]];let O;for(O=I;O<4*I+28;O++)w=v[O-1],(O%I===0||I===8&&O%I===4)&&(w=S[w>>>24]<<24^S[w>>16&255]<<16^S[w>>8&255]<<8^S[w&255],O%I===0&&(w=w<<8^w>>>24^k<<24,k=k<<1^(k>>7)*283)),v[O]=v[O-I]^w;for(let A=0;O>0;A++,O--)w=v[(A&3)!==0?O:O-4],O<=4||A<4?_[A]=w:_[A]=T[0][S[w>>>24]]^T[1][S[w>>16&255]]^T[2][S[w>>8&255]]^T[3][S[w&255]]}c.prototype={encrypt:function(b){return this._crypt(b,0)},decrypt:function(b){return this._crypt(b,1)},_tables:[[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]],_precompute:function(){const b=this._tables[0],w=this._tables[1],v=b[4],_=w[4];let S,T,I;const k=new Uint8Array(256),O=new Uint8Array(256);let A,R,P,C,N,D;for(S=0;S<256;S++)O[(k[S]=S<<1^(S>>7)*283)^S]=S;for(T=I=0;v[T]===0;T^=A!==0?A:1,I=O[I]!==0?O[I]:1)for(C=I^I<<1^I<<2^I<<3^I<<4,C=C>>8^C&255^99,v[T]=C,_[C]=T,P=k[R=k[A=k[T]]],D=P*16843009^R*65537^A*257^T*16843008,N=k[C]*257^C*16843008,S=0;S<4;S++)b[S][T]=N=N<<24^N>>>8,w[S][C]=D=D<<24^D>>>8},_crypt:function(b,w){if(b.length!==4)throw new Error("invalid aes block size");const v=this._key[w];let _=b[0]^v[0],S=b[w===1?3:1]^v[1],T=b[2]^v[2],I=b[w===1?1:3]^v[3],k,O,A;const R=v.length/4-2;let P,C=4;const N=new Uint32Array(4),D=this._tables[w],U=D[0],F=D[1],L=D[2],j=D[3],V=D[4];for(P=0;P<R;P++)k=U[_>>>24]^F[S>>16&255]^L[T>>8&255]^j[I&255]^v[C],O=U[S>>>24]^F[T>>16&255]^L[I>>8&255]^j[_&255]^v[C+1],A=U[T>>>24]^F[I>>16&255]^L[_>>8&255]^j[S&255]^v[C+2],I=U[I>>>24]^F[_>>16&255]^L[S>>8&255]^j[T&255]^v[C+3],C+=4,_=k,S=O,T=A;for(P=0;P<4;P++)N[w===1?3&-P:P]=V[_>>>24]<<24^V[S>>16&255]<<16^V[T>>8&255]<<8^V[I&255]^v[C++],k=_,_=S,S=T,T=I,I=k;return N}};class d{static encrypt(w,v){const _=d.buf2Words(v),S=d.buf2Words(w),I=new c(_).encrypt(S);return d.words2Buf(I)}static decrypt(w,v){const _=d.buf2Words(w),S=d.buf2Words(v),I=new c(S).decrypt(_);return d.words2Buf(I)}static buf2Words(w){if(w.length%4!==0)throw new Error("buf length must be a multiple of 4");const v=[];for(let _=0;_<w.length/4;_++){const S=w[_*4]*16777216+(w[_*4+1]<<16|w[_*4+2]<<8|w[_*4+3]);v.push(S)}return v}static words2Buf(w){const v=new Array(w.length*4);for(let _=0;_<w.length;_++){const S=w[_];v[_*4]=S>>>24&255,v[_*4+1]=S>>>16&255,v[_*4+2]=S>>>8&255,v[_*4+3]=S&255}return v}}class y{static buf2BlocksBuf(w,v){const _=v/8,S=[];for(let T=0;T<=w.length/_;T++){let I=w.slice(T*_,T*_+_);I.length<v&&(I=y.pkcs7Pad(I,v)),S.push(I)}return S}static blockBufs2Buf(w){let v=w[w.length-1];return v=y.pkcs7Unpad(v),w[w.length-1]=v,w.flat()}static encrypt(w,v,_,S){const T=v.length*8,I=y.buf2BlocksBuf(w,T);return y.encryptBlocks(I,v,_,S).flat()}static decrypt(w,v,_,S){const T=v.length,I=[];for(let A=0;A<w.length/T;A++)I.push(w.slice(A*T,A*T+T));const k=y.decryptBlocks(I,v,_,S);return y.blockBufs2Buf(k)}static encryptBlock(w,v,_,S){const T=y.xorBufs(w,v);return _.encrypt(T,S)}static decryptBlock(w,v,_,S){const T=_.decrypt(w,S);return y.xorBufs(T,v)}static encryptBlocks(w,v,_,S){const T=[];for(let I=0;I<w.length;I++){const k=w[I],O=y.encryptBlock(k,v,_,S);T.push(O),v=O}return T}static decryptBlocks(w,v,_,S){const T=[];for(let I=0;I<w.length;I++){const k=w[I],O=y.decryptBlock(k,v,_,S);T.push(O),v=k}return T}static pkcs7Pad(w,v){const S=v/8-w.length,T=new Array(S);return T.fill(S),[...w,...T]}static pkcs7Unpad(w){const v=w[w.length-1],_=w.slice(w.length-v,w.length),S=new Array(v);if(S.fill(v),(0,n.toHex)(_)!==(0,n.toHex)(S))throw new Error("invalid padding");return w.slice(0,w.length-v)}static xorBufs(w,v){if(w.length!==v.length)throw new Error("bufs must have the same length");const _=new Array(w.length);for(let S=0;S<w.length;S++)_[S]=w[S]^v[S];return _}}class p{static encrypt(w,v,_,S=!0){_=_??(0,e.default)(128/8);const T=y.encrypt(w,_,d,v);return S?[..._,...T]:[...T]}static decrypt(w,v,_){if(_==null){_=w.slice(0,128/8);const S=w.slice(128/8);return y.decrypt(S,_,d,v)}else{const S=w;return y.decrypt(S,_,d,v)}}}let g=class vb{static ivkEkM(w,v){const _=w,T=v.mul(_),k=new a.default(T.x,T.y).encode(!0),O=f.sha512(k);return{iv:O.slice(0,16),kE:O.slice(16,32),kM:O.slice(32,64)}}static electrumEncrypt(w,v,_,S=!1){let T=null;_==null&&(_=o.default.fromRandom()),S||(T=_.toPublicKey().encode(!0));const{iv:I,kE:k,kM:O}=vb.ivkEkM(_,v),A=p.encrypt(w,k,I,!1),R=(0,n.toArray)("BIE1","utf8");let P;T!=null&&T.length>0?P=[...R,...T,...A]:P=[...R,...A];const C=f.sha256hmac(O,P);return[...P,...C]}static electrumDecrypt(w,v,_){const T=w.slice(0,4);if((0,n.encode)(T,"utf8")!=="BIE1")throw new Error("Invalid Magic");let I=4,k=null;if(w.length-I-32>=33){const D=w[I];D===2||D===3?(k=w.slice(I,I+33),I+=33):D===4&&(k=w.slice(I,I+65),I+=65)}if(k!==null)_==null&&(_=a.default.fromString((0,n.toHex)(k)));else if(_==null)throw new Error("Sender public key is required");const{iv:O,kE:A,kM:R}=vb.ivkEkM(v,_),P=w.slice(I,w.length-32),C=w.slice(w.length-32,w.length),N=f.sha256hmac(R,w.slice(0,w.length-32));if((0,n.toHex)(C)!==(0,n.toHex)(N))throw new Error("Invalid checksum");return p.decrypt(P,A,O)}static bitcoreEncrypt(w,v,_,S){_==null&&(_=o.default.fromRandom()),S==null&&(S=(0,e.default)(16));const T=_,k=_.toPublicKey().encode(!0),P=v.mul(T).getX().toArray("be",32),C=f.sha512(P),N=C.slice(0,32),D=C.slice(32,64),U=p.encrypt(w,N,S),F=f.sha256hmac(D,[...U]);return[...k,...U,...F]}static bitcoreDecrypt(w,v){const _=v,I=a.default.fromString((0,n.toHex)(w.slice(0,33))).mul(_);if(I.eq(new l.default(0,0)))throw new Error("P equals 0");const O=I.getX().toArray("be",32),A=f.sha512(O),R=A.slice(0,32),P=A.slice(32,64),C=w.slice(33,w.length-32),N=w.slice(w.length-32,w.length),D=f.sha256hmac(P,C);if((0,n.toHex)(N)!==(0,n.toHex)(D))throw new Error("Invalid checksum");return[...p.decrypt(C,R)]}};return Pn.default=g,Pn}var Dc={},YS;function YC(){if(YS)return Dc;YS=1;var s=Dc&&Dc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dc,"__esModule",{value:!0});const t=s(vf()),i=s(bf());function r(e,o){const a=new t.default(0,[],[],0);return a.outputs=Array(e.vout+1).fill(null),a.outputs[e.vout]={satoshis:e.satoshis,lockingScript:i.default.fromHex(e.script)},{sourceTransaction:a,sourceTXID:e.txid,sourceOutputIndex:e.vout,unlockingScriptTemplate:o,sequence:4294967295}}return Dc.default=r,Dc}var QS;function QC(){return QS||(QS=1,function(s){var t=Zn&&Zn.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),i=Zn&&Zn.__setModuleDefault||(Object.create?function(n,c){Object.defineProperty(n,"default",{enumerable:!0,value:c})}:function(n,c){n.default=c}),r=Zn&&Zn.__importStar||function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var d in n)d!=="default"&&Object.prototype.hasOwnProperty.call(n,d)&&t(c,n,d);return i(c,n),c},e=Zn&&Zn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.fromUtxo=s.ECIES=s.Mnemonic=s.HD=s.BSM=void 0,s.BSM=r(WC());var o=$C();Object.defineProperty(s,"HD",{enumerable:!0,get:function(){return e(o).default}});var a=XC();Object.defineProperty(s,"Mnemonic",{enumerable:!0,get:function(){return e(a).default}});var l=GC();Object.defineProperty(s,"ECIES",{enumerable:!0,get:function(){return e(l).default}});var f=YC();Object.defineProperty(s,"fromUtxo",{enumerable:!0,get:function(){return e(f).default}})}(Zn)),Zn}var qs={},js={},ZS;function ZC(){if(ZS)return js;ZS=1;var s=js&&js.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(js,"__esModule",{value:!0}),js.TOTP=void 0;const t=li(),i=s(ui());class r{static generate(l,f){const n=this.withDefaultOptions(f),c=this.getCounter(n.timestamp,n.period);return e(l,c,n)}static validate(l,f,n){const c=this.withDefaultValidateOptions(n);if(f=f.trim(),f.length!==c.digits)return!1;const d=this.getCounter(c.timestamp,c.period),y=[d];for(let p=1;p<=c.skew;p++)y.push(d+p),y.push(d-p);for(const p of y)if(f===e(l,p,c))return!0;return!1}static getCounter(l,f){const n=Math.floor(l/1e3);return Math.floor(n/f)}static withDefaultOptions(l){return{digits:2,algorithm:"SHA-1",period:30,timestamp:Date.now(),...l}}static withDefaultValidateOptions(l){return{skew:1,...this.withDefaultOptions(l)}}}js.TOTP=r;function e(a,l,f){const n=new i.default(l).toArray("be",8),d=o(a,n,f.algorithm).digest(),y=d[d.length-1]&15,p=d.slice(y,y+4);return(new i.default(p).toNumber()&2147483647).toString().slice(-f.digits)}function o(a,l,f){switch(f){case"SHA-1":return new t.SHA1HMAC(a).update(l);case"SHA-256":return new t.SHA256HMAC(a).update(l);case"SHA-512":return new t.SHA512HMAC(a).update(l);default:throw new Error("unsupported HMAC algorithm")}}return js}var JS;function JC(){return JS||(JS=1,function(s){var t=qs&&qs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=qs&&qs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(ZC(),s)}(qs)),qs}var ua={},Nl={},t3;function gI(){if(t3)return Nl;t3=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.SecurityLevels=void 0;var s;return function(t){t[t.Silent=0]="Silent",t[t.App=1]="App",t[t.Counterparty=2]="Counterparty"}(s||(Nl.SecurityLevels=s={})),Nl}var Bc={},e3;function p1(){if(e3)return Bc;e3=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.KeyDeriver=void 0;const s=Cr();let t=class{constructor(r){r==="anyone"?this.rootKey=new s.PrivateKey(1):this.rootKey=r,this.identityKey=this.rootKey.toPublicKey().toString()}derivePublicKey(r,e,o,a=!1){return o=this.normalizeCounterparty(o),a?this.rootKey.deriveChild(o,this.computeInvoiceNumber(r,e)).toPublicKey():o.deriveChild(this.rootKey,this.computeInvoiceNumber(r,e))}derivePrivateKey(r,e,o){return o=this.normalizeCounterparty(o),this.rootKey.deriveChild(o,this.computeInvoiceNumber(r,e))}deriveSymmetricKey(r,e,o){var a,l,f;o==="anyone"&&(o=new s.PrivateKey(1).toPublicKey()),o=this.normalizeCounterparty(o);const n=this.derivePublicKey(r,e,o),c=this.derivePrivateKey(r,e,o);return new s.SymmetricKey((f=(l=(a=c.deriveSharedSecret(n))===null||a===void 0?void 0:a.x)===null||l===void 0?void 0:l.toArray())!==null&&f!==void 0?f:[])}revealCounterpartySecret(r){if(r==="self")throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");r=this.normalizeCounterparty(r);const e=this.rootKey.toPublicKey(),o=this.rootKey.deriveChild(e,"test").toHex(),a=this.rootKey.deriveChild(r,"test").toHex();if(o===a)throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");return this.rootKey.deriveSharedSecret(r).encode(!0)}revealSpecificSecret(r,e,o){r=this.normalizeCounterparty(r);const a=this.rootKey.deriveSharedSecret(r),l=s.Utils.toArray(this.computeInvoiceNumber(e,o),"utf8");return s.Hash.sha256hmac(a.encode(!0),l)}normalizeCounterparty(r){if(r==null)throw new Error("counterparty must be self, anyone or a public key!");return r==="self"?this.rootKey.toPublicKey():r==="anyone"?new s.PrivateKey(1).toPublicKey():typeof r=="string"?s.PublicKey.fromString(r):r}computeInvoiceNumber(r,e){const o=r[0];if(!Number.isInteger(o)||o<0||o>2)throw new Error("Protocol security level must be 0, 1, or 2");const a=r[1].toLowerCase().trim();if(e.length>800)throw new Error("Key IDs must be 800 characters or less");if(e.length<1)throw new Error("Key IDs must be 1 character or more");if(a.length>400)if(a.startsWith("specific linkage revelation ")){if(a.length>430)throw new Error("Specific linkage revelation protocol names must be 430 characters or less")}else throw new Error("Protocol names must be 400 characters or less");if(a.length<5)throw new Error("Protocol names must be 5 characters or more");if(a.includes("  "))throw new Error('Protocol names cannot contain multiple consecutive spaces ("  ")');if(!/^[a-z0-9 ]+$/g.test(a))throw new Error("Protocol names can only contain letters, numbers and spaces");if(a.endsWith(" protocol"))throw new Error('No need to end your protocol name with " protocol"');return`${o}-${a}-${e}`}};return Bc.KeyDeriver=t,Bc.default=t,Bc}var Jh={},i3;function tD(){if(i3)return Jh;i3=1,Object.defineProperty(Jh,"__esModule",{value:!0});const s=Cr(),t=p1();let i=class{constructor(e,o){this.keyDeriver=new t.KeyDeriver(e),this.cache=new Map;const a=o==null?void 0:o.maxCacheSize;this.maxCacheSize=a!=null&&!isNaN(a)&&a>0?a:1e3}derivePublicKey(e,o,a,l=!1){const f=this.generateCacheKey("derivePublicKey",e,o,a,l);if(this.cache.has(f)){const n=this.cacheGet(f);if(n===void 0)throw new Error("Cached value is undefined");return n}else{const n=this.keyDeriver.derivePublicKey(e,o,a,l);return this.cacheSet(f,n),n}}derivePrivateKey(e,o,a){const l=this.generateCacheKey("derivePrivateKey",e,o,a);if(this.cache.has(l)){const f=this.cacheGet(l);if(f===void 0)throw new Error("Cached value is undefined");return f}else{const f=this.keyDeriver.derivePrivateKey(e,o,a);return this.cacheSet(l,f),f}}deriveSymmetricKey(e,o,a){const l=this.generateCacheKey("deriveSymmetricKey",e,o,a);if(this.cache.has(l)){const f=this.cacheGet(l);if(f===void 0)throw new Error("Cached value is undefined");return f}else{const f=this.keyDeriver.deriveSymmetricKey(e,o,a);return this.cacheSet(l,f),f}}revealCounterpartySecret(e){const o=this.generateCacheKey("revealCounterpartySecret",e);if(this.cache.has(o)){const a=this.cacheGet(o);if(a===void 0)throw new Error("Cached value is undefined");return a}else{const a=this.keyDeriver.revealCounterpartySecret(e);return this.cacheSet(o,a),a}}revealSpecificSecret(e,o,a){const l=this.generateCacheKey("revealSpecificSecret",e,o,a);if(this.cache.has(l)){const f=this.cacheGet(l);if(f===void 0)throw new Error("Cached value is undefined");return f}else{const f=this.keyDeriver.revealSpecificSecret(e,o,a);return this.cacheSet(l,f),f}}generateCacheKey(e,...o){const a=o.map(l=>this.serializeArgument(l)).join("|");return`${e}|${a}`}serializeArgument(e){return e instanceof s.PublicKey||e instanceof s.PrivateKey?e.toString():Array.isArray(e)?e.map(o=>this.serializeArgument(o)).join(","):typeof e=="object"&&e!==null?JSON.stringify(e):String(e)}cacheGet(e){const o=this.cache.get(e);return this.cache.delete(e),o!==void 0&&this.cache.set(e,o),o}cacheSet(e,o){if(this.cache.size>=this.maxCacheSize){const a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(e,o)}};return Jh.default=i,Jh}var Fc={},n3;function mI(){if(n3)return Fc;n3=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.ProtoWallet=void 0;const s=p1(),t=Cr();let i=class{constructor(e){typeof e.identityKey!="string"&&(e=new s.KeyDeriver(e)),this.keyDeriver=e}async getPublicKey(e){var o,a;if(e.identityKey){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(e.protocolID==null||e.keyID==null||e.keyID==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");return{publicKey:((o=this.keyDeriver)!==null&&o!==void 0?o:(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(e.protocolID,e.keyID,(a=e.counterparty)!==null&&a!==void 0?a:"self",e.forSelf).toString()}}}async revealCounterpartyKeyLinkage(e){const{publicKey:o}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.revealCounterpartySecret(e.counterparty),l=new t.Schnorr().generateProof(this.keyDeriver.rootKey,this.keyDeriver.rootKey.toPublicKey(),t.PublicKey.fromString(e.counterparty),t.Point.fromDER(a)),f=[...l.R.encode(!0),...l.SPrime.encode(!0),...l.z.toArray()],n=new Date().toISOString(),{ciphertext:c}=await this.encrypt({plaintext:a,protocolID:[2,"counterparty linkage revelation"],keyID:n,counterparty:e.verifier}),{ciphertext:d}=await this.encrypt({plaintext:f,protocolID:[2,"counterparty linkage revelation"],keyID:n,counterparty:e.verifier});return{prover:o,verifier:e.verifier,counterparty:e.counterparty,revelationTime:n,encryptedLinkage:c,encryptedLinkageProof:d}}async revealSpecificKeyLinkage(e){const{publicKey:o}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.revealSpecificSecret(e.counterparty,e.protocolID,e.keyID),{ciphertext:l}=await this.encrypt({plaintext:a,protocolID:[2,`specific linkage revelation ${e.protocolID[0]} ${e.protocolID[1]}`],keyID:e.keyID,counterparty:e.verifier}),{ciphertext:f}=await this.encrypt({plaintext:[0],protocolID:[2,`specific linkage revelation ${e.protocolID[0]} ${e.protocolID[1]}`],keyID:e.keyID,counterparty:e.verifier});return{prover:o,verifier:e.verifier,counterparty:e.counterparty,protocolID:e.protocolID,keyID:e.keyID,encryptedLinkage:l,encryptedLinkageProof:f,proofType:0}}async encrypt(e){var o;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{ciphertext:this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,(o=e.counterparty)!==null&&o!==void 0?o:"self").encrypt(e.plaintext)}}async decrypt(e){var o;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{plaintext:this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,(o=e.counterparty)!==null&&o!==void 0?o:"self").decrypt(e.ciphertext)}}async createHmac(e){var o;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,(o=e.counterparty)!==null&&o!==void 0?o:"self");return{hmac:t.Hash.sha256hmac(a.toArray(),e.data)}}async verifyHmac(e){var o;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,(o=e.counterparty)!==null&&o!==void 0?o:"self"),l=t.Hash.sha256hmac(a.toArray(),e.data).toString()===e.hmac.toString();if(!l){const f=new Error("HMAC is not valid");throw f.code="ERR_INVALID_HMAC",f}return{valid:l}}async createSignature(e){var o,a,l,f;if(e.hashToDirectlySign==null&&e.data==null)throw new Error("args.data or args.hashToDirectlySign must be valid");const n=(o=e.hashToDirectlySign)!==null&&o!==void 0?o:t.Hash.sha256((a=e.data)!==null&&a!==void 0?a:[]),d=((l=this.keyDeriver)!==null&&l!==void 0?l:(()=>{throw new Error("keyDeriver is undefined")})()).derivePrivateKey(e.protocolID,e.keyID,(f=e.counterparty)!==null&&f!==void 0?f:"anyone");return{signature:t.ECDSA.sign(new t.BigNumber(n),d,!0).toDER()}}async verifySignature(e){var o,a,l,f;if(e.hashToDirectlyVerify==null&&e.data==null)throw new Error("args.data or args.hashToDirectlyVerify must be valid");const n=(o=e.hashToDirectlyVerify)!==null&&o!==void 0?o:t.Hash.sha256((a=e.data)!==null&&a!==void 0?a:[]),d=((l=this.keyDeriver)!==null&&l!==void 0?l:(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(e.protocolID,e.keyID,(f=e.counterparty)!==null&&f!==void 0?f:"self",e.forSelf),y=t.ECDSA.verify(new t.BigNumber(n),t.Signature.fromDER(e.signature),d);if(!y){const p=new Error("Signature is not valid");throw p.code="ERR_INVALID_SIGNATURE",p}return{valid:y}}};return Fc.ProtoWallet=i,Fc.default=i,Fc}var Lc={},tp={},r3;function bI(){if(r3)return tp;r3=1,Object.defineProperty(tp,"__esModule",{value:!0});class s{constructor(){if(typeof window!="object")throw new Error("The window.CWI substrate requires a global window object.");if(typeof window.CWI!="object")throw new Error("The window.CWI interface does not appear to be bound to the window object.");this.CWI=window.CWI}async createAction(i,r){return await this.CWI.createAction(i,r)}async signAction(i,r){return await this.CWI.signAction(i,r)}async abortAction(i,r){return await this.CWI.abortAction(i,r)}async listActions(i,r){return await this.CWI.listActions(i,r)}async internalizeAction(i,r){return await this.CWI.internalizeAction(i,r)}async listOutputs(i,r){return await this.CWI.listOutputs(i,r)}async relinquishOutput(i,r){return await this.CWI.relinquishOutput(i,r)}async getPublicKey(i,r){return await this.CWI.getPublicKey(i,r)}async revealCounterpartyKeyLinkage(i,r){return await this.CWI.revealCounterpartyKeyLinkage(i,r)}async revealSpecificKeyLinkage(i,r){return await this.CWI.revealSpecificKeyLinkage(i,r)}async encrypt(i,r){return await this.CWI.encrypt(i,r)}async decrypt(i,r){return await this.CWI.decrypt(i,r)}async createHmac(i,r){return await this.CWI.createHmac(i,r)}async verifyHmac(i,r){return await this.CWI.verifyHmac(i,r)}async createSignature(i,r){return await this.CWI.createSignature(i,r)}async verifySignature(i,r){return await this.CWI.verifySignature(i,r)}async acquireCertificate(i,r){return await this.CWI.acquireCertificate(i,r)}async listCertificates(i,r){return await this.CWI.listCertificates(i,r)}async proveCertificate(i,r){return await this.CWI.proveCertificate(i,r)}async relinquishCertificate(i,r){return await this.CWI.relinquishCertificate(i,r)}async discoverByIdentityKey(i,r){return await this.CWI.discoverByIdentityKey(i,r)}async discoverByAttributes(i,r){return await this.CWI.discoverByAttributes(i,r)}async isAuthenticated(i,r){return await this.CWI.isAuthenticated(i,r)}async waitForAuthentication(i,r){return await this.CWI.waitForAuthentication(i,r)}async getHeight(i,r){return await this.CWI.getHeight(i,r)}async getHeaderForHeight(i,r){return await this.CWI.getHeaderForHeight(i,r)}async getNetwork(i,r){return await this.CWI.getNetwork(i,r)}async getVersion(i,r){return await this.CWI.getVersion(i,r)}}return tp.default=s,tp}var Rn={},ts={},a3;function Gp(){if(a3)return ts;a3=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.walletErrors=ts.WalletError=void 0;let s=class extends Error{constructor(r,e=1,o){super(r),this.isError=!0,this.code=e,this.name=this.constructor.name,o!=null&&o!==""?this.stack=o:Error.captureStackTrace(this,this.constructor)}};ts.WalletError=s;var t;return function(i){i[i.unknownError=1]="unknownError",i[i.unsupportedAction=2]="unsupportedAction",i[i.invalidHmac=3]="invalidHmac",i[i.invalidSignature=4]="invalidSignature",i[i.reviewActions=5]="reviewActions"}(t||(ts.walletErrors=t={})),ts.default=s,ts}var s3;function wI(){if(s3)return Rn;s3=1;var s=Rn&&Rn.__createBinding||(Object.create?function(f,n,c,d){d===void 0&&(d=c);var y=Object.getOwnPropertyDescriptor(n,c);(!y||("get"in y?!n.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return n[c]}}),Object.defineProperty(f,d,y)}:function(f,n,c,d){d===void 0&&(d=c),f[d]=n[c]}),t=Rn&&Rn.__setModuleDefault||(Object.create?function(f,n){Object.defineProperty(f,"default",{enumerable:!0,value:n})}:function(f,n){f.default=n}),i=Rn&&Rn.__importStar||function(f){if(f&&f.__esModule)return f;var n={};if(f!=null)for(var c in f)c!=="default"&&Object.prototype.hasOwnProperty.call(f,c)&&s(n,f,c);return t(n,f),n},r=Rn&&Rn.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Rn,"__esModule",{value:!0});const e=r(ji()),o=i(me()),a=Gp();class l{constructor(n="*"){if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(typeof window.postMessage!="function")throw new Error("The window object does not seem to support postMessage calls.");this.domain=n}async invoke(n,c){return await new Promise((d,y)=>{const p=o.toBase64((0,e.default)(12)),g=b=>{if(!(b.data.type!=="CWI"||!b.isTrusted||b.data.id!==p||b.data.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",g),b.data.status==="error"){const w=new a.WalletError(b.data.description,b.data.code);y(w)}else d(b.data.result)};window.addEventListener("message",g),window.parent.postMessage({type:"CWI",isInvocation:!0,id:p,call:n,args:c},this.domain)})}async createAction(n){return await this.invoke("createAction",n)}async signAction(n){return await this.invoke("signAction",n)}async abortAction(n){return await this.invoke("abortAction",n)}async listActions(n){return await this.invoke("listActions",n)}async internalizeAction(n){return await this.invoke("internalizeAction",n)}async listOutputs(n){return await this.invoke("listOutputs",n)}async relinquishOutput(n){return await this.invoke("relinquishOutput",n)}async getPublicKey(n){return await this.invoke("getPublicKey",n)}async revealCounterpartyKeyLinkage(n){return await this.invoke("revealCounterpartyKeyLinkage",n)}async revealSpecificKeyLinkage(n){return await this.invoke("revealSpecificKeyLinkage",n)}async encrypt(n){return await this.invoke("encrypt",n)}async decrypt(n){return await this.invoke("decrypt",n)}async createHmac(n){return await this.invoke("createHmac",n)}async verifyHmac(n){return await this.invoke("verifyHmac",n)}async createSignature(n){return await this.invoke("createSignature",n)}async verifySignature(n){return await this.invoke("verifySignature",n)}async acquireCertificate(n){return await this.invoke("acquireCertificate",n)}async listCertificates(n){return await this.invoke("listCertificates",n)}async proveCertificate(n){return await this.invoke("proveCertificate",n)}async relinquishCertificate(n){return await this.invoke("relinquishCertificate",n)}async discoverByIdentityKey(n){return await this.invoke("discoverByIdentityKey",n)}async discoverByAttributes(n){return await this.invoke("discoverByAttributes",n)}async isAuthenticated(n){return await this.invoke("isAuthenticated",n)}async waitForAuthentication(n){return await this.invoke("waitForAuthentication",n)}async getHeight(n){return await this.invoke("getHeight",n)}async getHeaderForHeight(n){return await this.invoke("getHeaderForHeight",n)}async getNetwork(n){return await this.invoke("getNetwork",n)}async getVersion(n){return await this.invoke("getVersion",n)}}return Rn.default=l,Rn}var Mn={},Nn={},o3;function wu(){if(o3)return Nn;o3=1;var s=Nn&&Nn.__createBinding||(Object.create?function(f,n,c,d){d===void 0&&(d=c);var y=Object.getOwnPropertyDescriptor(n,c);(!y||("get"in y?!n.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return n[c]}}),Object.defineProperty(f,d,y)}:function(f,n,c,d){d===void 0&&(d=c),f[d]=n[c]}),t=Nn&&Nn.__setModuleDefault||(Object.create?function(f,n){Object.defineProperty(f,"default",{enumerable:!0,value:n})}:function(f,n){f.default=n}),i=Nn&&Nn.__importStar||function(f){if(f&&f.__esModule)return f;var n={};if(f!=null)for(var c in f)c!=="default"&&Object.prototype.hasOwnProperty.call(f,c)&&s(n,f,c);return t(n,f),n},r=Nn&&Nn.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Nn,"__esModule",{value:!0});const e=i(me()),o=r(mI()),a=r(gu());let l=class vI{constructor(n,c,d,y,p,g,b){this.type=n,this.serialNumber=c,this.subject=d,this.certifier=y,this.revocationOutpoint=p,this.fields=g,this.signature=b}toBinary(n=!0){var c;const d=new e.Writer,y=e.toArray(this.type,"base64");d.write(y);const p=e.toArray(this.serialNumber,"base64");d.write(p);const g=e.toArray(this.subject,"hex");d.write(g);const b=e.toArray(this.certifier,"hex");d.write(b);const[w,v]=this.revocationOutpoint.split("."),_=e.toArray(w,"hex");d.write(_),d.writeVarIntNum(Number(v));const S=Object.keys(this.fields).sort();d.writeVarIntNum(S.length);for(const T of S){const I=this.fields[T],k=e.toArray(T,"utf8");d.writeVarIntNum(k.length),d.write(k);const O=e.toArray(I,"utf8");d.writeVarIntNum(O.length),d.write(O)}if(n&&((c=this.signature)!==null&&c!==void 0?c:"").length>0){const T=e.toArray(this.signature,"hex");d.write(T)}return d.toArray()}static fromBinary(n){const c=new e.Reader(n),d=c.read(32),y=e.toBase64(d),p=c.read(32),g=e.toBase64(p),b=c.read(33),w=e.toHex(b),v=c.read(33),_=e.toHex(v),S=c.read(32),T=e.toHex(S),I=c.readVarIntNum(),k=`${T}.${I}`,O=c.readVarIntNum(),A={};for(let P=0;P<O;P++){const C=c.readVarIntNum(),N=c.read(C),D=e.toUTF8(N),U=c.readVarIntNum(),F=c.read(U),L=e.toUTF8(F);A[D]=L}let R;if(!c.eof()){const P=c.read();R=a.default.fromDER(P).toString("hex")}return new vI(y,g,w,_,k,A,R)}async verify(){var n;const c=new o.default("anyone"),d=this.toBinary(!1),y=(n=this.signature)!==null&&n!==void 0?n:"",{valid:p}=await c.verifySignature({signature:e.toArray(y,"hex"),data:d,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`,counterparty:this.certifier});return p}async sign(n){if(this.signature!=null&&this.signature.length>0)throw new Error(`Certificate has already been signed! Signature present: ${this.signature}`);this.certifier=(await n.getPublicKey({identityKey:!0})).publicKey;const c=this.toBinary(!1),{signature:d}=await n.createSignature({data:c,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`});this.signature=e.toHex(d)}static getCertificateFieldEncryptionDetails(n,c){return{protocolID:[2,"certificate field encryption"],keyID:c?`${c} ${n}`:n}}};return Nn.default=l,Nn}var ep={},c3;function P0(){if(c3)return ep;c3=1,Object.defineProperty(ep,"__esModule",{value:!0});var s;return function(t){t[t.createAction=1]="createAction",t[t.signAction=2]="signAction",t[t.abortAction=3]="abortAction",t[t.listActions=4]="listActions",t[t.internalizeAction=5]="internalizeAction",t[t.listOutputs=6]="listOutputs",t[t.relinquishOutput=7]="relinquishOutput",t[t.getPublicKey=8]="getPublicKey",t[t.revealCounterpartyKeyLinkage=9]="revealCounterpartyKeyLinkage",t[t.revealSpecificKeyLinkage=10]="revealSpecificKeyLinkage",t[t.encrypt=11]="encrypt",t[t.decrypt=12]="decrypt",t[t.createHmac=13]="createHmac",t[t.verifyHmac=14]="verifyHmac",t[t.createSignature=15]="createSignature",t[t.verifySignature=16]="verifySignature",t[t.acquireCertificate=17]="acquireCertificate",t[t.listCertificates=18]="listCertificates",t[t.proveCertificate=19]="proveCertificate",t[t.relinquishCertificate=20]="relinquishCertificate",t[t.discoverByIdentityKey=21]="discoverByIdentityKey",t[t.discoverByAttributes=22]="discoverByAttributes",t[t.isAuthenticated=23]="isAuthenticated",t[t.waitForAuthentication=24]="waitForAuthentication",t[t.getHeight=25]="getHeight",t[t.getHeaderForHeight=26]="getHeaderForHeight",t[t.getNetwork=27]="getNetwork",t[t.getVersion=28]="getVersion"}(s||(s={})),ep.default=s,ep}var u3;function xI(){if(u3)return Mn;u3=1;var s=Mn&&Mn.__createBinding||(Object.create?function(c,d,y,p){p===void 0&&(p=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(c,p,g)}:function(c,d,y,p){p===void 0&&(p=y),c[p]=d[y]}),t=Mn&&Mn.__setModuleDefault||(Object.create?function(c,d){Object.defineProperty(c,"default",{enumerable:!0,value:d})}:function(c,d){c.default=d}),i=Mn&&Mn.__importStar||function(c){if(c&&c.__esModule)return c;var d={};if(c!=null)for(var y in c)y!=="default"&&Object.prototype.hasOwnProperty.call(c,y)&&s(d,c,y);return t(d,c),d},r=Mn&&Mn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Mn,"__esModule",{value:!0});const e=gI(),o=r(wu()),a=i(me()),l=r(P0()),f=Gp();let n=class{constructor(d){this.wire=d}async transmit(d,y="",p=[]){const g=new a.Writer;g.writeUInt8(l.default[d]);const b=a.toArray(y,"utf8");g.writeUInt8(b.length),g.write(b),p.length>0&&g.write(p);const w=g.toArray(),v=await this.wire.transmitToWallet(w),_=new a.Reader(v),S=_.readUInt8();if(S===0)return _.read();{const T=_.readVarIntNum(),I=_.read(T),k=a.toUTF8(I),O=_.readVarIntNum(),A=_.read(O),R=a.toUTF8(A);throw new f.WalletError(k,S,R)}}async createAction(d,y){var p;const g=new a.Writer,b=a.toArray(d.description,"utf8");if(g.writeVarIntNum(b.length),g.write(b),d.inputBEEF!=null?(g.writeVarIntNum(d.inputBEEF.length),g.write(d.inputBEEF)):g.writeVarIntNum(-1),d.inputs!=null){g.writeVarIntNum(d.inputs.length);for(const A of d.inputs){if(g.write(this.encodeOutpoint(A.outpoint)),A.unlockingScript!=null&&A.unlockingScript!==""){const P=a.toArray(A.unlockingScript,"hex");g.writeVarIntNum(P.length),g.write(P)}else g.writeVarIntNum(-1),g.writeVarIntNum((p=A.unlockingScriptLength)!==null&&p!==void 0?p:0);const R=a.toArray(A.inputDescription,"utf8");g.writeVarIntNum(R.length),g.write(R),typeof A.sequenceNumber=="number"?g.writeVarIntNum(A.sequenceNumber):g.writeVarIntNum(-1)}}else g.writeVarIntNum(-1);if(d.outputs!=null){g.writeVarIntNum(d.outputs.length);for(const A of d.outputs){const R=a.toArray(A.lockingScript,"hex");g.writeVarIntNum(R.length),g.write(R),g.writeVarIntNum(A.satoshis);const P=a.toArray(A.outputDescription,"utf8");if(g.writeVarIntNum(P.length),g.write(P),A.basket!=null&&A.basket!==""){const C=a.toArray(A.basket,"utf8");g.writeVarIntNum(C.length),g.write(C)}else g.writeVarIntNum(-1);if(A.customInstructions!=null&&A.customInstructions!==""){const C=a.toArray(A.customInstructions,"utf8");g.writeVarIntNum(C.length),g.write(C)}else g.writeVarIntNum(-1);if(A.tags!=null){g.writeVarIntNum(A.tags.length);for(const C of A.tags){const N=a.toArray(C,"utf8");g.writeVarIntNum(N.length),g.write(N)}}else g.writeVarIntNum(-1)}}else g.writeVarIntNum(-1);if(typeof d.lockTime=="number"?g.writeVarIntNum(d.lockTime):g.writeVarIntNum(-1),typeof d.version=="number"?g.writeVarIntNum(d.version):g.writeVarIntNum(-1),d.labels!=null){g.writeVarIntNum(d.labels.length);for(const A of d.labels){const R=a.toArray(A,"utf8");g.writeVarIntNum(R.length),g.write(R)}}else g.writeVarIntNum(-1);if(d.options!=null){if(g.writeInt8(1),typeof d.options.signAndProcess=="boolean"?g.writeInt8(d.options.signAndProcess?1:0):g.writeInt8(-1),typeof d.options.acceptDelayedBroadcast=="boolean"?g.writeInt8(d.options.acceptDelayedBroadcast?1:0):g.writeInt8(-1),d.options.trustSelf==="known"?g.writeInt8(1):g.writeInt8(-1),d.options.knownTxids!=null){g.writeVarIntNum(d.options.knownTxids.length);for(const A of d.options.knownTxids){const R=a.toArray(A,"hex");g.write(R)}}else g.writeVarIntNum(-1);if(typeof d.options.returnTXIDOnly=="boolean"?g.writeInt8(d.options.returnTXIDOnly?1:0):g.writeInt8(-1),typeof d.options.noSend=="boolean"?g.writeInt8(d.options.noSend?1:0):g.writeInt8(-1),d.options.noSendChange!=null){g.writeVarIntNum(d.options.noSendChange.length);for(const A of d.options.noSendChange)g.write(this.encodeOutpoint(A))}else g.writeVarIntNum(-1);if(d.options.sendWith!=null){g.writeVarIntNum(d.options.sendWith.length);for(const A of d.options.sendWith){const R=a.toArray(A,"hex");g.write(R)}}else g.writeVarIntNum(-1);typeof d.options.randomizeOutputs=="boolean"?g.writeInt8(d.options.randomizeOutputs?1:0):g.writeInt8(-1)}else g.writeInt8(0);const w=await this.transmit("createAction",y,g.toArray()),v=new a.Reader(w),_={};if(v.readInt8()===1){const A=v.read(32);_.txid=a.toHex(A)}if(v.readInt8()===1){const A=v.readVarIntNum();_.tx=v.read(A)}const I=v.readVarIntNum();if(I>=0){_.noSendChange=[];for(let A=0;A<I;A++){const R=this.readOutpoint(v);_.noSendChange.push(R)}}const k=v.readVarIntNum();if(k>=0){_.sendWithResults=[];for(let A=0;A<k;A++){const R=v.read(32),P=a.toHex(R),C=v.readInt8();let N="unproven";C===1?N="unproven":C===2?N="sending":C===3&&(N="failed"),_.sendWithResults.push({txid:P,status:N})}}if(v.readInt8()===1){const A=v.readVarIntNum(),R=v.read(A),P=v.readVarIntNum(),C=v.read(P);_.signableTransaction={tx:R,reference:a.toBase64(C)}}return _}async signAction(d,y){const p=new a.Writer,g=Object.keys(d.spends);p.writeVarIntNum(g.length);for(const k of g){p.writeVarIntNum(Number(k));const O=d.spends[Number(k)],A=a.toArray(O.unlockingScript,"hex");p.writeVarIntNum(A.length),p.write(A),typeof O.sequenceNumber=="number"?p.writeVarIntNum(O.sequenceNumber):p.writeVarIntNum(-1)}const b=a.toArray(d.reference,"base64");if(p.writeVarIntNum(b.length),p.write(b),d.options!=null)if(p.writeInt8(1),typeof d.options.acceptDelayedBroadcast=="boolean"?p.writeInt8(d.options.acceptDelayedBroadcast?1:0):p.writeInt8(-1),typeof d.options.returnTXIDOnly=="boolean"?p.writeInt8(d.options.returnTXIDOnly?1:0):p.writeInt8(-1),typeof d.options.noSend=="boolean"?p.writeInt8(d.options.noSend?1:0):p.writeInt8(-1),d.options.sendWith!=null){p.writeVarIntNum(d.options.sendWith.length);for(const k of d.options.sendWith){const O=a.toArray(k,"hex");p.write(O)}}else p.writeVarIntNum(-1);else p.writeInt8(0);const w=await this.transmit("signAction",y,p.toArray()),v=new a.Reader(w),_={};if(v.readInt8()===1){const k=v.read(32);_.txid=a.toHex(k)}if(v.readInt8()===1){const k=v.readVarIntNum();_.tx=v.read(k)}const I=v.readVarIntNum();if(I>=0){_.sendWithResults=[];for(let k=0;k<I;k++){const O=v.read(32),A=a.toHex(O),R=v.readInt8();let P="unproven";R===1?P="unproven":R===2?P="sending":R===3&&(P="failed"),_.sendWithResults.push({txid:A,status:P})}}return _}async abortAction(d,y){return await this.transmit("abortAction",y,a.toArray(d.reference,"base64")),{aborted:!0}}async listActions(d,y){const p=new a.Writer;p.writeVarIntNum(d.labels.length);for(const S of d.labels){const T=a.toArray(S,"utf8");p.writeVarIntNum(T.length),p.write(T)}d.labelQueryMode==="any"?p.writeInt8(1):d.labelQueryMode==="all"?p.writeInt8(2):p.writeInt8(-1);const g=[d.includeLabels,d.includeInputs,d.includeInputSourceLockingScripts,d.includeInputUnlockingScripts,d.includeOutputs,d.includeOutputLockingScripts];for(const S of g)typeof S=="boolean"?p.writeInt8(S?1:0):p.writeInt8(-1);typeof d.limit=="number"?p.writeVarIntNum(d.limit):p.writeVarIntNum(-1),typeof d.offset=="number"?p.writeVarIntNum(d.offset):p.writeVarIntNum(-1),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1);const b=await this.transmit("listActions",y,p.toArray()),w=new a.Reader(b),v=w.readVarIntNum(),_=[];for(let S=0;S<v;S++){const T=w.read(32),I=a.toHex(T),k=w.readVarIntNum(),O=w.readInt8();let A;switch(O){case 1:A="completed";break;case 2:A="unprocessed";break;case 3:A="sending";break;case 4:A="unproven";break;case 5:A="unsigned";break;case 6:A="nosend";break;case 7:A="nonfinal";break;case 8:A="failed";break;default:throw new Error(`Unknown status code: ${O}`)}const R=w.readInt8()===1,P=w.readVarIntNum(),C=w.read(P),N=a.toUTF8(C),D={txid:I,satoshis:k,status:A,isOutgoing:R,description:N,version:0,lockTime:0},U=w.readVarIntNum();if(U>=0){D.labels=[];for(let j=0;j<U;j++){const V=w.readVarIntNum(),W=w.read(V);D.labels.push(a.toUTF8(W))}}D.version=w.readVarIntNum(),D.lockTime=w.readVarIntNum();const F=w.readVarIntNum();if(F>=0){D.inputs=[];for(let j=0;j<F;j++){const V=this.readOutpoint(w),W=w.readVarIntNum(),q=w.readVarIntNum();let $;if(q>=0){const yt=w.read(q);$=a.toHex(yt)}const Y=w.readVarIntNum();let Q;if(Y>=0){const yt=w.read(Y);Q=a.toHex(yt)}const J=w.readVarIntNum(),vt=w.read(J),wt=a.toUTF8(vt),dt=w.readVarIntNum();D.inputs.push({sourceOutpoint:V,sourceSatoshis:W,sourceLockingScript:$,unlockingScript:Q,inputDescription:wt,sequenceNumber:dt})}}const L=w.readVarIntNum();if(L>=0){D.outputs=[];for(let j=0;j<L;j++){const V=w.readVarIntNum(),W=w.readVarIntNum(),q=w.readVarIntNum();let $;if(q>=0){const It=w.read(q);$=a.toHex(It)}const Y=w.readInt8()===1,Q=w.readVarIntNum(),J=w.read(Q),vt=a.toUTF8(J),wt=w.readVarIntNum();let dt;if(wt>=0){const It=w.read(wt);dt=a.toUTF8(It)}const yt=w.readVarIntNum(),_t=[];if(yt>=0)for(let It=0;It<yt;It++){const Nt=w.readVarIntNum(),Lt=w.read(Nt);_t.push(a.toUTF8(Lt))}const tt=w.readVarIntNum();let xt;if(tt>=0){const It=w.read(tt);xt=a.toUTF8(It)}D.outputs.push({outputIndex:V,satoshis:W,lockingScript:$,spendable:Y,outputDescription:vt,basket:dt,tags:_t,customInstructions:xt})}}_.push(D)}return{totalActions:v,actions:_}}async internalizeAction(d,y){var p,g,b;const w=new a.Writer;w.writeVarIntNum(d.tx.length),w.write(d.tx),w.writeVarIntNum(d.outputs.length);for(const _ of d.outputs)if(w.writeVarIntNum(_.outputIndex),_.protocol==="wallet payment"){if(_.paymentRemittance==null)throw new Error("Payment remittance is required for wallet payment");w.writeUInt8(1),w.write(a.toArray(_.paymentRemittance.senderIdentityKey,"hex"));const S=a.toArray(_.paymentRemittance.derivationPrefix,"base64");w.writeVarIntNum(S.length),w.write(S);const T=a.toArray(_.paymentRemittance.derivationSuffix,"base64");w.writeVarIntNum(T.length),w.write(T)}else{w.writeUInt8(2);const S=a.toArray((p=_.insertionRemittance)===null||p===void 0?void 0:p.basket,"utf8");if(w.writeVarIntNum(S.length),w.write(S),typeof((g=_.insertionRemittance)===null||g===void 0?void 0:g.customInstructions)=="string"&&_.insertionRemittance.customInstructions!==""){const T=a.toArray(_.insertionRemittance.customInstructions,"utf8");w.writeVarIntNum(T.length),w.write(T)}else w.writeVarIntNum(-1);if(typeof((b=_.insertionRemittance)===null||b===void 0?void 0:b.tags)=="object"){w.writeVarIntNum(_.insertionRemittance.tags.length);for(const T of _.insertionRemittance.tags){const I=a.toArray(T,"utf8");w.writeVarIntNum(I.length),w.write(I)}}else w.writeVarIntNum(0)}if(typeof d.labels=="object"){w.writeVarIntNum(d.labels.length);for(const _ of d.labels){const S=a.toArray(_,"utf8");w.writeVarIntNum(S.length),w.write(S)}}else w.writeVarIntNum(-1);const v=a.toArray(d.description);return w.writeVarIntNum(v.length),w.write(v),w.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),await this.transmit("internalizeAction",y,w.toArray()),{accepted:!0}}async listOutputs(d,y){const p=new a.Writer,g=a.toArray(d.basket,"utf8");if(p.writeVarIntNum(g.length),p.write(g),typeof d.tags=="object"){p.writeVarIntNum(d.tags.length);for(const I of d.tags){const k=a.toArray(I,"utf8");p.writeVarIntNum(k.length),p.write(k)}}else p.writeVarIntNum(0);d.tagQueryMode==="all"?p.writeInt8(1):d.tagQueryMode==="any"?p.writeInt8(2):p.writeInt8(-1),d.include==="locking scripts"?p.writeInt8(1):d.include==="entire transactions"?p.writeInt8(2):p.writeInt8(-1),typeof d.includeCustomInstructions=="boolean"?p.writeInt8(d.includeCustomInstructions?1:0):p.writeInt8(-1),typeof d.includeTags=="boolean"?p.writeInt8(d.includeTags?1:0):p.writeInt8(-1),typeof d.includeLabels=="boolean"?p.writeInt8(d.includeLabels?1:0):p.writeInt8(-1),typeof d.limit=="number"?p.writeVarIntNum(d.limit):p.writeVarIntNum(-1),typeof d.offset=="number"?p.writeVarIntNum(d.offset):p.writeVarIntNum(-1),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1);const b=await this.transmit("listOutputs",y,p.toArray()),w=new a.Reader(b),v=w.readVarIntNum(),_=w.readVarIntNum();let S;_>=0&&(S=w.read(_));const T=[];for(let I=0;I<v;I++){const k=this.readOutpoint(w),O=w.readVarIntNum(),A={spendable:!0,outpoint:k,satoshis:O},R=w.readVarIntNum();R>=0&&(A.lockingScript=a.toHex(w.read(R)));const P=w.readVarIntNum();P>=0&&(A.customInstructions=a.toUTF8(w.read(P)));const C=w.readVarIntNum();if(C!==-1){const D=[];for(let U=0;U<C;U++){const F=w.readVarIntNum();D.push(a.toUTF8(w.read(F)))}A.tags=D}const N=w.readVarIntNum();if(N!==-1){const D=[];for(let U=0;U<N;U++){const F=w.readVarIntNum();D.push(a.toUTF8(w.read(F)))}A.labels=D}T.push(A)}return{totalOutputs:v,BEEF:S,outputs:T}}async relinquishOutput(d,y){const p=new a.Writer,g=a.toArray(d.basket,"utf8");return p.writeVarIntNum(g.length),p.write(g),p.write(this.encodeOutpoint(d.output)),await this.transmit("relinquishOutput",y,p.toArray()),{relinquished:!0}}encodeOutpoint(d){const y=new a.Writer,[p,g]=d.split(".");return y.write(a.toArray(p,"hex")),y.writeVarIntNum(Number(g)),y.toArray()}readOutpoint(d){const y=a.toHex(d.read(32)),p=d.readVarIntNum();return`${y}.${p}`}async getPublicKey(d,y){var p,g;const b=new a.Writer;b.writeUInt8(d.identityKey?1:0),d.identityKey?b.write(this.encodePrivilegedParams(d.privileged,d.privilegedReason)):(b.write(this.encodeKeyRelatedParams((p=d.protocolID)!==null&&p!==void 0?p:d.protocolID=[e.SecurityLevels.Silent,"default"],(g=d.keyID)!==null&&g!==void 0?g:d.keyID="",d.counterparty,d.privileged,d.privilegedReason)),typeof d.forSelf=="boolean"?b.writeInt8(d.forSelf?1:0):b.writeInt8(-1)),b.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1);const w=await this.transmit("getPublicKey",y,b.toArray());return{publicKey:a.toHex(w)}}async revealCounterpartyKeyLinkage(d,y){const p=new a.Writer;p.write(this.encodePrivilegedParams(d.privileged,d.privilegedReason)),p.write(a.toArray(d.counterparty,"hex")),p.write(a.toArray(d.verifier,"hex"));const g=await this.transmit("revealCounterpartyKeyLinkage",y,p.toArray()),b=new a.Reader(g),w=a.toHex(b.read(33)),v=a.toHex(b.read(33)),_=a.toHex(b.read(33)),S=b.readVarIntNum(),T=a.toUTF8(b.read(S)),I=b.readVarIntNum(),k=b.read(I),O=b.readVarIntNum(),A=b.read(O);return{prover:w,verifier:v,counterparty:_,revelationTime:T,encryptedLinkage:k,encryptedLinkageProof:A}}async revealSpecificKeyLinkage(d,y){const p=new a.Writer;p.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),p.write(a.toArray(d.verifier,"hex"));const g=await this.transmit("revealSpecificKeyLinkage",y,p.toArray()),b=new a.Reader(g),w=a.toHex(b.read(33)),v=a.toHex(b.read(33)),_=a.toHex(b.read(33)),S=b.readUInt8(),T=b.readVarIntNum(),I=a.toUTF8(b.read(T)),k=b.readVarIntNum(),O=a.toUTF8(b.read(k)),A=b.readVarIntNum(),R=b.read(A),P=b.readVarIntNum(),C=b.read(P),N=b.readUInt8();return{prover:w,verifier:v,counterparty:_,protocolID:[S,I],keyID:O,encryptedLinkage:R,encryptedLinkageProof:C,proofType:N}}async encrypt(d,y){const p=new a.Writer;return p.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),p.writeVarIntNum(d.plaintext.length),p.write(d.plaintext),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),{ciphertext:await this.transmit("encrypt",y,p.toArray())}}async decrypt(d,y){const p=new a.Writer;return p.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),p.writeVarIntNum(d.ciphertext.length),p.write(d.ciphertext),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),{plaintext:await this.transmit("decrypt",y,p.toArray())}}async createHmac(d,y){const p=new a.Writer;return p.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),p.writeVarIntNum(d.data.length),p.write(d.data),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),{hmac:await this.transmit("createHmac",y,p.toArray())}}async verifyHmac(d,y){const p=new a.Writer;return p.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),p.write(d.hmac),p.writeVarIntNum(d.data.length),p.write(d.data),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),await this.transmit("verifyHmac",y,p.toArray()),{valid:!0}}async createSignature(d,y){var p;const g=new a.Writer;return g.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),typeof d.data=="object"?(g.writeUInt8(1),g.writeVarIntNum(d.data.length),g.write(d.data)):(g.writeUInt8(2),g.write((p=d.hashToDirectlySign)!==null&&p!==void 0?p:d.hashToDirectlySign=[])),g.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),{signature:await this.transmit("createSignature",y,g.toArray())}}async verifySignature(d,y){var p;const g=new a.Writer;return g.write(this.encodeKeyRelatedParams(d.protocolID,d.keyID,d.counterparty,d.privileged,d.privilegedReason)),typeof d.forSelf=="boolean"?g.writeInt8(d.forSelf?1:0):g.writeInt8(-1),g.writeVarIntNum(d.signature.length),g.write(d.signature),typeof d.data=="object"?(g.writeUInt8(1),g.writeVarIntNum(d.data.length),g.write(d.data)):(g.writeUInt8(2),g.write((p=d.hashToDirectlyVerify)!==null&&p!==void 0?p:[])),g.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1),await this.transmit("verifySignature",y,g.toArray()),{valid:!0}}encodeKeyRelatedParams(d,y,p,g,b){const w=new a.Writer;w.writeUInt8(d[0]);const v=a.toArray(d[1],"utf8");w.writeVarIntNum(v.length),w.write(v);const _=a.toArray(y,"utf8");return w.writeVarIntNum(_.length),w.write(_),typeof p!="string"?w.writeUInt8(0):p==="self"?w.writeUInt8(11):p==="anyone"?w.writeUInt8(12):w.write(a.toArray(p,"hex")),w.write(this.encodePrivilegedParams(g,b)),w.toArray()}async acquireCertificate(d,y){var p,g,b;const w=new a.Writer;w.write(a.toArray(d.type,"base64")),w.write(a.toArray(d.certifier,"hex"));const v=Object.entries(d.fields);w.writeVarIntNum(v.length);for(const[T,I]of v){const k=a.toArray(T,"utf8"),O=a.toArray(I,"utf8");w.writeVarIntNum(k.length),w.write(k),w.writeVarIntNum(O.length),w.write(O)}if(w.write(this.encodePrivilegedParams(d.privileged,d.privilegedReason)),w.writeUInt8(d.acquisitionProtocol==="direct"?1:2),d.acquisitionProtocol==="direct"){w.write(a.toArray(d.serialNumber,"base64")),w.write(this.encodeOutpoint((p=d.revocationOutpoint)!==null&&p!==void 0?p:""));const T=a.toArray(d.signature,"hex");w.writeVarIntNum(T.length),w.write(T);const I=d.keyringRevealer!=="certifier"?a.toArray(d.keyringRevealer,"hex"):[11];w.write(I);const k=Object.keys((g=d.keyringForSubject)!==null&&g!==void 0?g:{});w.writeVarIntNum(k.length);for(let O=0;O<k.length;O++){const A=a.toArray(k[O],"utf8");w.writeVarIntNum(A.length),w.write(A);const R=a.toArray((b=d.keyringForSubject)===null||b===void 0?void 0:b[k[O]],"base64");w.writeVarIntNum(R.length),w.write(R)}}else{const T=a.toArray(d.certifierUrl,"utf8");w.writeVarIntNum(T.length),w.write(T)}const _=await this.transmit("acquireCertificate",y,w.toArray()),S=o.default.fromBinary(_);return{...S,signature:S.signature}}encodePrivilegedParams(d,y){const p=new a.Writer;if(typeof d=="boolean"?p.writeInt8(d?1:0):p.writeInt8(-1),typeof y=="string"){const g=a.toArray(y,"utf8");p.writeInt8(g.length),p.write(g)}else p.writeInt8(-1);return p.toArray()}async listCertificates(d,y){const p=new a.Writer;p.writeVarIntNum(d.certifiers.length);for(let _=0;_<d.certifiers.length;_++)p.write(a.toArray(d.certifiers[_],"hex"));p.writeVarIntNum(d.types.length);for(let _=0;_<d.types.length;_++)p.write(a.toArray(d.types[_],"base64"));typeof d.limit=="number"?p.writeVarIntNum(d.limit):p.writeVarIntNum(-1),typeof d.offset=="number"?p.writeVarIntNum(d.offset):p.writeVarIntNum(-1),p.write(this.encodePrivilegedParams(d.privileged,d.privilegedReason));const g=await this.transmit("listCertificates",y,p.toArray()),b=new a.Reader(g),w=b.readVarIntNum(),v=[];for(let _=0;_<w;_++){const S=b.readVarIntNum(),T=b.read(S),I=o.default.fromBinary(T);v.push({...I,signature:I.signature})}return{totalCertificates:w,certificates:v}}async proveCertificate(d,y){var p,g;const b=new a.Writer,w=a.toArray(d.certificate.type,"base64");b.write(w);const v=a.toArray(d.certificate.subject,"hex");b.write(v);const _=a.toArray(d.certificate.serialNumber,"base64");b.write(_);const S=a.toArray(d.certificate.certifier,"hex");b.write(S);const T=this.encodeOutpoint((p=d.certificate.revocationOutpoint)!==null&&p!==void 0?p:"");b.write(T);const I=a.toArray(d.certificate.signature,"hex");b.writeVarIntNum(I.length),b.write(I);const k=Object.entries((g=d.certificate.fields)!==null&&g!==void 0?g:{});b.writeVarIntNum(k.length);for(const[C,N]of k){const D=a.toArray(C,"utf8"),U=a.toArray(N,"utf8");b.writeVarIntNum(D.length),b.write(D),b.writeVarIntNum(U.length),b.write(U)}b.writeVarIntNum(d.fieldsToReveal.length);for(const C of d.fieldsToReveal){const N=a.toArray(C,"utf8");b.writeVarIntNum(N.length),b.write(N)}b.write(a.toArray(d.verifier,"hex")),b.write(this.encodePrivilegedParams(d.privileged,d.privilegedReason));const O=await this.transmit("proveCertificate",y,b.toArray()),A=new a.Reader(O),R=A.readVarIntNum(),P={};for(let C=0;C<R;C++){const N=A.readVarIntNum(),D=a.toUTF8(A.read(N)),U=A.readVarIntNum();P[D]=a.toBase64(A.read(U))}return{keyringForVerifier:P}}async relinquishCertificate(d,y){const p=new a.Writer,g=a.toArray(d.type,"base64");p.write(g);const b=a.toArray(d.serialNumber,"base64");p.write(b);const w=a.toArray(d.certifier,"hex");return p.write(w),await this.transmit("relinquishCertificate",y,p.toArray()),{relinquished:!0}}parseDiscoveryResult(d){const y=new a.Reader(d),p=y.readVarIntNum(),g=[];for(let b=0;b<p;b++){const w=y.readVarIntNum(),v=y.read(w),_=o.default.fromBinary(v),S=y.readVarIntNum(),T=a.toUTF8(y.read(S)),I=y.readVarIntNum(),k=a.toUTF8(y.read(I)),O=y.readVarIntNum(),A=a.toUTF8(y.read(O)),R=y.readUInt8(),P={},C=y.readVarIntNum();for(let U=0;U<C;U++){const F=y.readVarIntNum(),L=a.toUTF8(y.read(F)),j=y.readVarIntNum();P[L]=y.read(j)}const N={},D=y.readVarIntNum();for(let U=0;U<D;U++){const F=y.readVarIntNum(),L=a.toUTF8(y.read(F)),j=y.readVarIntNum();N[L]=a.toUTF8(y.read(j))}g.push({..._,signature:_.signature,certifierInfo:{iconUrl:k,name:T,description:A,trust:R},publiclyRevealedKeyring:P,decryptedFields:N})}return{totalCertificates:p,certificates:g}}async discoverByIdentityKey(d,y){const p=new a.Writer;p.write(a.toArray(d.identityKey,"hex")),typeof d.limit=="number"?p.writeVarIntNum(d.limit):p.writeVarIntNum(-1),typeof d.offset=="number"?p.writeVarIntNum(d.offset):p.writeVarIntNum(-1),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1);const g=await this.transmit("discoverByIdentityKey",y,p.toArray());return this.parseDiscoveryResult(g)}async discoverByAttributes(d,y){const p=new a.Writer,g=Object.keys(d.attributes);p.writeVarIntNum(g.length);for(let w=0;w<g.length;w++)p.writeVarIntNum(g[w].length),p.write(a.toArray(g[w],"utf8")),p.writeVarIntNum(d.attributes[g[w]].length),p.write(a.toArray(d.attributes[g[w]],"utf8"));typeof d.limit=="number"?p.writeVarIntNum(d.limit):p.writeVarIntNum(-1),typeof d.offset=="number"?p.writeVarIntNum(d.offset):p.writeVarIntNum(-1),p.writeInt8(typeof d.seekPermission=="boolean"?d.seekPermission?1:0:-1);const b=await this.transmit("discoverByAttributes",y,p.toArray());return this.parseDiscoveryResult(b)}async isAuthenticated(d,y){return{authenticated:(await this.transmit("isAuthenticated",y))[0]===1}}async waitForAuthentication(d,y){return await this.transmit("waitForAuthentication",y),{authenticated:!0}}async getHeight(d,y){const p=await this.transmit("getHeight",y);return{height:new a.Reader(p).readVarIntNum()}}async getHeaderForHeight(d,y){const p=new a.Writer;p.writeVarIntNum(d.height);const g=await this.transmit("getHeaderForHeight",y,p.toArray());return{header:a.toHex(g)}}async getNetwork(d,y){return{network:(await this.transmit("getNetwork",y))[0]===0?"mainnet":"testnet"}}async getVersion(d,y){const p=await this.transmit("getVersion",y);return{version:a.toUTF8(p)}}};return Mn.default=n,Mn}var Cn={},l3;function _I(){if(l3)return Cn;l3=1;var s=Cn&&Cn.__createBinding||(Object.create?function(l,f,n,c){c===void 0&&(c=n);var d=Object.getOwnPropertyDescriptor(f,n);(!d||("get"in d?!f.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return f[n]}}),Object.defineProperty(l,c,d)}:function(l,f,n,c){c===void 0&&(c=n),l[c]=f[n]}),t=Cn&&Cn.__setModuleDefault||(Object.create?function(l,f){Object.defineProperty(l,"default",{enumerable:!0,value:f})}:function(l,f){l.default=f}),i=Cn&&Cn.__importStar||function(l){if(l&&l.__esModule)return l;var f={};if(l!=null)for(var n in l)n!=="default"&&Object.prototype.hasOwnProperty.call(l,n)&&s(f,l,n);return t(f,l),f},r=Cn&&Cn.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Cn,"__esModule",{value:!0});const e=r(P0()),o=i(me());let a=class{constructor(f,n="http://localhost:3301",c=fetch){this.baseUrl=n,this.httpClient=c,this.originator=f}async transmitToWallet(f){const n=new o.Reader(f),c=n.readUInt8(),d=e.default[c];if(d===void 0||d==="")throw new Error(`Invalid call code: ${c}`);const y=n.readUInt8();let p;if(y>0){const v=n.read(y);p=o.toUTF8(v)}const g=n.read(),w=await(await fetch(`${this.baseUrl}/${d}`,{method:"POST",headers:{"Content-Type":"application/octet-stream",Origin:p??""},body:new Uint8Array(g)})).arrayBuffer();return Array.from(new Uint8Array(w))}};return Cn.default=a,Cn}var ip={},Uc={},d3;function SI(){if(d3)return Uc;d3=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.WERR_REVIEW_ACTIONS=void 0;let s=class extends Error{constructor(i,r,e,o,a){super("Undelayed createAction or signAction results require review."),this.reviewActionResults=i,this.sendWithResults=r,this.txid=e,this.tx=o,this.noSendChange=a,this.isError=!0,this.code=5,this.name=this.constructor.name}};return Uc.WERR_REVIEW_ACTIONS=s,Uc.default=s,Uc}var f3;function TI(){if(f3)return ip;f3=1,Object.defineProperty(ip,"__esModule",{value:!0});const s=SI();let t=class{constructor(r,e="http://localhost:3321",o=fetch){this.baseUrl=e,this.originator=r,this.httpClient=o,this.api=async(a,l)=>{var f,n;const c=await await o(`${this.baseUrl}/${a}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Originator:(f=this.originator)!==null&&f!==void 0?f:""},body:JSON.stringify(l)}),d=await c.json();if(!c.ok){if(c.status===400&&d.isError&&d.code===5)throw new s.WERR_REVIEW_ACTIONS(d.reviewActionResults,d.sendWithResults,d.txid,d.tx,d.noSendChange);{const y={call:a,args:l,message:(n=d.message)!==null&&n!==void 0?n:`HTTP Client error ${c.status}`};throw new Error(JSON.stringify(y))}}return d}}async createAction(r){return await this.api("createAction",r)}async signAction(r){return await this.api("signAction",r)}async abortAction(r){return await this.api("abortAction",r)}async listActions(r){return await this.api("listActions",r)}async internalizeAction(r){return await this.api("internalizeAction",r)}async listOutputs(r){return await this.api("listOutputs",r)}async relinquishOutput(r){return await this.api("relinquishOutput",r)}async getPublicKey(r){return await this.api("getPublicKey",r)}async revealCounterpartyKeyLinkage(r){return await this.api("revealCounterpartyKeyLinkage",r)}async revealSpecificKeyLinkage(r){return await this.api("revealSpecificKeyLinkage",r)}async encrypt(r){return await this.api("encrypt",r)}async decrypt(r){return await this.api("decrypt",r)}async createHmac(r){return await this.api("createHmac",r)}async verifyHmac(r){return await this.api("verifyHmac",r)}async createSignature(r){return await this.api("createSignature",r)}async verifySignature(r){return await this.api("verifySignature",r)}async acquireCertificate(r){return await this.api("acquireCertificate",r)}async listCertificates(r){return await this.api("listCertificates",r)}async proveCertificate(r){return await this.api("proveCertificate",r)}async relinquishCertificate(r){return await this.api("relinquishCertificate",r)}async discoverByIdentityKey(r){return await this.api("discoverByIdentityKey",r)}async discoverByAttributes(r){return await this.api("discoverByAttributes",r)}async isAuthenticated(r){return await this.api("isAuthenticated",r)}async waitForAuthentication(r){return await this.api("waitForAuthentication",r)}async getHeight(r){return await this.api("getHeight",r)}async getHeaderForHeight(r){return await this.api("getHeaderForHeight",r)}async getNetwork(r){return await this.api("getNetwork",r)}async getVersion(r){return await this.api("getVersion",r)}};return ip.default=t,ip}var h3;function II(){if(h3)return Lc;h3=1;var s=Lc&&Lc.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Lc,"__esModule",{value:!0});const t=s(bI()),i=s(wI()),r=s(xI()),e=s(_I()),o=s(TI()),a=200;let l=class{constructor(n="auto",c){n==="Cicada"&&(n=new r.default(new e.default(c))),n==="window.CWI"&&(n=new t.default),n==="XDM"&&(n=new i.default),n==="json-api"&&(n=new o.default(c)),this.substrate=n,this.originator=c}async connectToSubstrate(){if(typeof this.substrate=="object")return;let n;const c=async d=>{let y;if(typeof d=="number"?y=await Promise.race([n.getVersion({}),new Promise((p,g)=>setTimeout(()=>g(new Error("Timed out.")),d))]):y=await n.getVersion({}),typeof y!="object"||typeof y.version!="string")throw new Error("Failed to use substrate.")};try{n=new t.default,await c(),this.substrate=n}catch{try{n=new i.default,await c(a),this.substrate=n}catch{try{n=new r.default(new e.default(this.originator)),await c(),this.substrate=n}catch{try{n=new o.default(this.originator),await c(),this.substrate=n}catch{throw new Error("No wallet available over any communication substrate. Install a BSV wallet today!")}}}}}async createAction(n){return await this.connectToSubstrate(),await this.substrate.createAction(n,this.originator)}async signAction(n){return await this.connectToSubstrate(),await this.substrate.signAction(n,this.originator)}async abortAction(n){return await this.connectToSubstrate(),await this.substrate.abortAction(n,this.originator)}async listActions(n){return await this.connectToSubstrate(),await this.substrate.listActions(n,this.originator)}async internalizeAction(n){return await this.connectToSubstrate(),await this.substrate.internalizeAction(n,this.originator)}async listOutputs(n){return await this.connectToSubstrate(),await this.substrate.listOutputs(n,this.originator)}async relinquishOutput(n){return await this.connectToSubstrate(),await this.substrate.relinquishOutput(n,this.originator)}async getPublicKey(n){return await this.connectToSubstrate(),await this.substrate.getPublicKey(n,this.originator)}async revealCounterpartyKeyLinkage(n){return await this.connectToSubstrate(),await this.substrate.revealCounterpartyKeyLinkage(n,this.originator)}async revealSpecificKeyLinkage(n){return await this.connectToSubstrate(),await this.substrate.revealSpecificKeyLinkage(n,this.originator)}async encrypt(n){return await this.connectToSubstrate(),await this.substrate.encrypt(n,this.originator)}async decrypt(n){return await this.substrate.decrypt(n,this.originator)}async createHmac(n){return await this.connectToSubstrate(),await this.substrate.createHmac(n,this.originator)}async verifyHmac(n){return await this.connectToSubstrate(),await this.substrate.verifyHmac(n,this.originator)}async createSignature(n){return await this.connectToSubstrate(),await this.substrate.createSignature(n,this.originator)}async verifySignature(n){return await this.connectToSubstrate(),await this.substrate.verifySignature(n,this.originator)}async acquireCertificate(n){return await this.connectToSubstrate(),await this.substrate.acquireCertificate(n,this.originator)}async listCertificates(n){return await this.connectToSubstrate(),await this.substrate.listCertificates(n,this.originator)}async proveCertificate(n){return await this.connectToSubstrate(),await this.substrate.proveCertificate(n,this.originator)}async relinquishCertificate(n){return await this.connectToSubstrate(),await this.substrate.relinquishCertificate(n,this.originator)}async discoverByIdentityKey(n){return await this.connectToSubstrate(),await this.substrate.discoverByIdentityKey(n,this.originator)}async discoverByAttributes(n){return await this.connectToSubstrate(),await this.substrate.discoverByAttributes(n,this.originator)}async isAuthenticated(n={}){return await this.connectToSubstrate(),await this.substrate.isAuthenticated(n,this.originator)}async waitForAuthentication(n={}){return await this.connectToSubstrate(),await this.substrate.waitForAuthentication(n,this.originator)}async getHeight(n={}){return await this.connectToSubstrate(),await this.substrate.getHeight(n,this.originator)}async getHeaderForHeight(n){return await this.connectToSubstrate(),await this.substrate.getHeaderForHeight(n,this.originator)}async getNetwork(n={}){return await this.connectToSubstrate(),await this.substrate.getNetwork(n,this.originator)}async getVersion(n={}){return await this.connectToSubstrate(),await this.substrate.getVersion(n,this.originator)}};return Lc.default=l,Lc}var la={},ym={},p3;function eD(){return p3||(p3=1,Object.defineProperty(ym,"__esModule",{value:!0})),ym}var Dn={},y3;function iD(){if(y3)return Dn;y3=1;var s=Dn&&Dn.__createBinding||(Object.create?function(f,n,c,d){d===void 0&&(d=c);var y=Object.getOwnPropertyDescriptor(n,c);(!y||("get"in y?!n.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return n[c]}}),Object.defineProperty(f,d,y)}:function(f,n,c,d){d===void 0&&(d=c),f[d]=n[c]}),t=Dn&&Dn.__setModuleDefault||(Object.create?function(f,n){Object.defineProperty(f,"default",{enumerable:!0,value:n})}:function(f,n){f.default=n}),i=Dn&&Dn.__importStar||function(f){if(f&&f.__esModule)return f;var n={};if(f!=null)for(var c in f)c!=="default"&&Object.prototype.hasOwnProperty.call(f,c)&&s(n,f,c);return t(n,f),n},r=Dn&&Dn.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Dn,"__esModule",{value:!0});const e=i(me()),o=r(P0()),a=r(wu());let l=class{constructor(n){this.wallet=n}decodeOutpoint(n){const c=n.read(32),d=e.toHex(c),y=n.readVarIntNum();return`${d}.${y}`}encodeOutpoint(n){const c=new e.Writer,[d,y]=n.split(".");return c.write(e.toArray(d,"hex")),c.writeVarIntNum(Number(y)),c.toArray()}async transmitToWallet(n){const c=new e.Reader(n);try{const d=c.readUInt8(),y=o.default[d];if(y===void 0||y==="")throw new Error(`Invalid call code: ${d}`);const p=c.readUInt8(),g=c.read(p),b=e.toUTF8(g),w=c;switch(y){case"createAction":{const v={},_=w.readVarIntNum(),S=w.read(_);v.description=e.toUTF8(S);const T=w.readVarIntNum();T>=0?v.inputBEEF=w.read(T):v.inputBEEF=void 0;const I=w.readVarIntNum();if(I>=0){v.inputs=[];for(let U=0;U<I;U++){const F={};F.outpoint=this.decodeOutpoint(w);const L=w.readVarIntNum();if(L>=0){const q=w.read(L);F.unlockingScript=e.toHex(q)}else{F.unlockingScript=void 0;const q=w.readVarIntNum();F.unlockingScriptLength=q}const j=w.readVarIntNum(),V=w.read(j);F.inputDescription=e.toUTF8(V);const W=w.readVarIntNum();W>=0?F.sequenceNumber=W:F.sequenceNumber=void 0,v.inputs.push(F)}}else v.inputs=void 0;const k=w.readVarIntNum();if(k>=0){v.outputs=[];for(let U=0;U<k;U++){const F={},L=w.readVarIntNum(),j=w.read(L);F.lockingScript=e.toHex(j),F.satoshis=w.readVarIntNum();const V=w.readVarIntNum(),W=w.read(V);F.outputDescription=e.toUTF8(W);const q=w.readVarIntNum();if(q>=0){const Q=w.read(q);F.basket=e.toUTF8(Q)}else F.basket=void 0;const $=w.readVarIntNum();if($>=0){const Q=w.read($);F.customInstructions=e.toUTF8(Q)}else F.customInstructions=void 0;const Y=w.readVarIntNum();if(Y>=0){F.tags=[];for(let Q=0;Q<Y;Q++){const J=w.readVarIntNum(),vt=w.read(J),wt=e.toUTF8(vt);F.tags.push(wt)}}else F.tags=void 0;v.outputs.push(F)}}else v.outputs=void 0;const O=w.readVarIntNum();O>=0?v.lockTime=O:v.lockTime=void 0;const A=w.readVarIntNum();A>=0?v.version=A:v.version=void 0;const R=w.readVarIntNum();if(R>=0){v.labels=[];for(let U=0;U<R;U++){const F=w.readVarIntNum(),L=w.read(F),j=e.toUTF8(L);v.labels.push(j)}}else v.labels=void 0;if(w.readInt8()===1){v.options={};const U=w.readInt8();U===-1?v.options.signAndProcess=void 0:v.options.signAndProcess=U===1;const F=w.readInt8();F===-1?v.options.acceptDelayedBroadcast=void 0:v.options.acceptDelayedBroadcast=F===1;const L=w.readInt8();L===-1?v.options.trustSelf=void 0:L===1&&(v.options.trustSelf="known");const j=w.readVarIntNum();if(j>=0){v.options.knownTxids=[];for(let Q=0;Q<j;Q++){const J=w.read(32),vt=e.toHex(J);v.options.knownTxids.push(vt)}}else v.options.knownTxids=void 0;const V=w.readInt8();V===-1?v.options.returnTXIDOnly=void 0:v.options.returnTXIDOnly=V===1;const W=w.readInt8();W===-1?v.options.noSend=void 0:v.options.noSend=W===1;const q=w.readVarIntNum();if(q>=0){v.options.noSendChange=[];for(let Q=0;Q<q;Q++){const J=this.decodeOutpoint(w);v.options.noSendChange.push(J)}}else v.options.noSendChange=void 0;const $=w.readVarIntNum();if($>=0){v.options.sendWith=[];for(let Q=0;Q<$;Q++){const J=w.read(32),vt=e.toHex(J);v.options.sendWith.push(vt)}}else v.options.sendWith=void 0;const Y=w.readInt8();Y===-1?v.options.randomizeOutputs=void 0:v.options.randomizeOutputs=Y===1}else v.options=void 0;const C=await this.wallet.createAction(v,b),N=new e.Writer;if(C.txid!=null&&C.txid!==""?(N.writeInt8(1),N.write(e.toArray(C.txid,"hex"))):N.writeInt8(0),C.tx!=null?(N.writeInt8(1),N.writeVarIntNum(C.tx.length),N.write(C.tx)):N.writeInt8(0),C.noSendChange!=null){N.writeVarIntNum(C.noSendChange.length);for(const U of C.noSendChange)N.write(this.encodeOutpoint(U))}else N.writeVarIntNum(-1);if(C.sendWithResults!=null){N.writeVarIntNum(C.sendWithResults.length);for(const U of C.sendWithResults){N.write(e.toArray(U.txid,"hex"));let F;U.status==="unproven"?F=1:U.status==="sending"?F=2:U.status==="failed"&&(F=3),N.writeInt8(F)}}else N.writeVarIntNum(-1);if(C.signableTransaction!=null){N.writeInt8(1),N.writeVarIntNum(C.signableTransaction.tx.length),N.write(C.signableTransaction.tx);const U=e.toArray(C.signableTransaction.reference,"base64");N.writeVarIntNum(U.length),N.write(U)}else N.writeInt8(0);const D=new e.Writer;return D.writeUInt8(0),D.write(N.toArray()),D.toArray()}case"signAction":{const v={},_=w.readVarIntNum();v.spends={};for(let R=0;R<_;R++){const P=w.readVarIntNum(),C={},N=w.readVarIntNum(),D=w.read(N);C.unlockingScript=e.toHex(D);const U=w.readVarIntNum();U>=0?C.sequenceNumber=U:C.sequenceNumber=void 0,v.spends[P]=C}const S=w.readVarIntNum(),T=w.read(S);if(v.reference=e.toBase64(T),w.readInt8()===1){v.options={};const R=w.readInt8();R===-1?v.options.acceptDelayedBroadcast=void 0:v.options.acceptDelayedBroadcast=R===1;const P=w.readInt8();P===-1?v.options.returnTXIDOnly=void 0:v.options.returnTXIDOnly=P===1;const C=w.readInt8();C===-1?v.options.noSend=void 0:v.options.noSend=C===1;const N=w.readVarIntNum();if(N>=0){v.options.sendWith=[];for(let D=0;D<N;D++){const U=w.read(32),F=e.toHex(U);v.options.sendWith.push(F)}}else v.options.sendWith=void 0}else v.options=void 0;const k=await this.wallet.signAction(v,b),O=new e.Writer;if(k.txid!=null&&k.txid!==""?(O.writeInt8(1),O.write(e.toArray(k.txid,"hex"))):O.writeInt8(0),k.tx!=null?(O.writeInt8(1),O.writeVarIntNum(k.tx.length),O.write(k.tx)):O.writeInt8(0),k.sendWithResults!=null){O.writeVarIntNum(k.sendWithResults.length);for(const R of k.sendWithResults){O.write(e.toArray(R.txid,"hex"));let P;R.status==="unproven"?P=1:R.status==="sending"?P=2:R.status==="failed"&&(P=3),O.writeInt8(P)}}else O.writeVarIntNum(-1);const A=new e.Writer;return A.writeUInt8(0),A.write(O.toArray()),A.toArray()}case"abortAction":{const v=w.read(),_=e.toBase64(v);await this.wallet.abortAction({reference:_},b);const S=new e.Writer;return S.writeUInt8(0),S.toArray()}case"listActions":{const v={},_=w.readVarIntNum();v.labels=[];for(let C=0;C<_;C++){const N=w.readVarIntNum(),D=w.read(N);v.labels.push(e.toUTF8(D))}const S=w.readInt8();S===-1?v.labelQueryMode=void 0:S===1?v.labelQueryMode="any":S===2&&(v.labelQueryMode="all");const T=["includeLabels","includeInputs","includeInputSourceLockingScripts","includeInputUnlockingScripts","includeOutputs","includeOutputLockingScripts"];for(const C of T){const N=w.readInt8();N===-1?v[C]=void 0:v[C]=N===1}const I=w.readVarIntNum();I>=0?v.limit=I:v.limit=void 0;const k=w.readVarIntNum();k>=0?v.offset=k:v.offset=void 0;const O=w.readInt8();O>=0?v.seekPermission=O===1:v.seekPermission=void 0;const A=await this.wallet.listActions(v,b),R=new e.Writer;R.writeVarIntNum(A.totalActions);for(const C of A.actions){R.write(e.toArray(C.txid,"hex")),R.writeVarIntNum(C.satoshis);let N;switch(C.status){case"completed":N=1;break;case"unprocessed":N=2;break;case"sending":N=3;break;case"unproven":N=4;break;case"unsigned":N=5;break;case"nosend":N=6;break;case"nonfinal":N=7;break;case"failed":N=8;break;default:N=-1;break}R.writeInt8(N),R.writeInt8(C.isOutgoing?1:0);const D=e.toArray(C.description,"utf8");if(R.writeVarIntNum(D.length),R.write(D),C.labels!==void 0){R.writeVarIntNum(C.labels.length);for(const U of C.labels){const F=e.toArray(U,"utf8");R.writeVarIntNum(F.length),R.write(F)}}else R.writeVarIntNum(-1);if(R.writeVarIntNum(C.version),R.writeVarIntNum(C.lockTime),C.inputs!==void 0){R.writeVarIntNum(C.inputs.length);for(const U of C.inputs){if(R.write(this.encodeOutpoint(U.sourceOutpoint)),R.writeVarIntNum(U.sourceSatoshis),U.sourceLockingScript!==void 0){const L=e.toArray(U.sourceLockingScript,"hex");R.writeVarIntNum(L.length),R.write(L)}else R.writeVarIntNum(-1);if(U.unlockingScript!==void 0){const L=e.toArray(U.unlockingScript,"hex");R.writeVarIntNum(L.length),R.write(L)}else R.writeVarIntNum(-1);const F=e.toArray(U.inputDescription,"utf8");R.writeVarIntNum(F.length),R.write(F),R.writeVarIntNum(U.sequenceNumber)}}else R.writeVarIntNum(-1);if(C.outputs!==void 0){R.writeVarIntNum(C.outputs.length);for(const U of C.outputs){if(R.writeVarIntNum(U.outputIndex),R.writeVarIntNum(U.satoshis),U.lockingScript!==void 0){const L=e.toArray(U.lockingScript,"hex");R.writeVarIntNum(L.length),R.write(L)}else R.writeVarIntNum(-1);R.writeInt8(U.spendable?1:0);const F=e.toArray(U.outputDescription,"utf8");if(R.writeVarIntNum(F.length),R.write(F),U.basket!==void 0){const L=e.toArray(U.basket,"utf8");R.writeVarIntNum(L.length),R.write(L)}else R.writeVarIntNum(-1);if(U.tags!==void 0){R.writeVarIntNum(U.tags.length);for(const L of U.tags){const j=e.toArray(L,"utf8");R.writeVarIntNum(j.length),R.write(j)}}else R.writeVarIntNum(-1);if(U.customInstructions!==void 0){const L=e.toArray(U.customInstructions,"utf8");R.writeVarIntNum(L.length),R.write(L)}else R.writeVarIntNum(-1)}}else R.writeVarIntNum(-1)}const P=new e.Writer;return P.writeUInt8(0),P.write(R.toArray()),P.toArray()}case"internalizeAction":{const v={},_=w.readVarIntNum();v.tx=w.read(_);const S=w.readVarIntNum();v.outputs=[];for(let A=0;A<S;A++){const R={};R.outputIndex=w.readVarIntNum();const P=w.readUInt8();if(P===1){R.protocol="wallet payment",R.paymentRemittance={};const C=w.read(33);R.paymentRemittance.senderIdentityKey=e.toHex(C);const N=w.readVarIntNum(),D=w.read(N);R.paymentRemittance.derivationPrefix=e.toBase64(D);const U=w.readVarIntNum(),F=w.read(U);R.paymentRemittance.derivationSuffix=e.toBase64(F)}else if(P===2){R.protocol="basket insertion",R.insertionRemittance={};const C=w.readVarIntNum(),N=w.read(C);R.insertionRemittance.basket=e.toUTF8(N);const D=w.readVarIntNum();if(D>=0){const F=w.read(D);R.insertionRemittance.customInstructions=e.toUTF8(F)}const U=w.readVarIntNum();if(U>0){R.insertionRemittance.tags=[];for(let F=0;F<U;F++){const L=w.readVarIntNum(),j=w.read(L);R.insertionRemittance.tags.push(e.toUTF8(j))}}else R.insertionRemittance.tags=[]}v.outputs.push(R)}const T=w.readVarIntNum();if(T>=0){v.labels=[];for(let A=0;A<T;A++){const R=w.readVarIntNum();v.labels.push(e.toUTF8(w.read(R)))}}const I=w.readVarIntNum();v.description=e.toUTF8(w.read(I));const k=w.readInt8();k>=0?v.seekPermission=k===1:v.seekPermission=void 0,await this.wallet.internalizeAction(v,b);const O=new e.Writer;return O.writeUInt8(0),O.toArray()}case"listOutputs":{const v={},_=w.readVarIntNum(),S=w.read(_);v.basket=e.toUTF8(S);const T=w.readVarIntNum();if(T>0){v.tags=[];for(let L=0;L<T;L++){const j=w.readVarIntNum(),V=w.read(j);v.tags.push(e.toUTF8(V))}}else v.tags=void 0;const I=w.readInt8();I===1?v.tagQueryMode="all":I===2?v.tagQueryMode="any":v.tagQueryMode=void 0;const k=w.readInt8();k===1?v.include="locking scripts":k===2?v.include="entire transactions":v.include=void 0;const O=w.readInt8();O===-1?v.includeCustomInstructions=void 0:v.includeCustomInstructions=O===1;const A=w.readInt8();A===-1?v.includeTags=void 0:v.includeTags=A===1;const R=w.readInt8();R===-1?v.includeLabels=void 0:v.includeLabels=R===1;const P=w.readVarIntNum();P>=0?v.limit=P:v.limit=void 0;const C=w.readVarIntNum();C>=0?v.offset=C:v.offset=void 0;const N=w.readInt8();N>=0?v.seekPermission=N===1:v.seekPermission=void 0;const D=await this.wallet.listOutputs(v,b),U=new e.Writer;U.writeVarIntNum(D.totalOutputs),D.BEEF!=null?(U.writeVarIntNum(D.BEEF.length),U.write(D.BEEF)):U.writeVarIntNum(-1);for(const L of D.outputs){if(U.write(this.encodeOutpoint(L.outpoint)),U.writeVarIntNum(L.satoshis),L.lockingScript!==void 0){const j=e.toArray(L.lockingScript,"hex");U.writeVarIntNum(j.length),U.write(j)}else U.writeVarIntNum(-1);if(L.customInstructions!==void 0){const j=e.toArray(L.customInstructions,"utf8");U.writeVarIntNum(j.length),U.write(j)}else U.writeVarIntNum(-1);if(L.tags!==void 0){U.writeVarIntNum(L.tags.length);for(const j of L.tags){const V=e.toArray(j,"utf8");U.writeVarIntNum(V.length),U.write(V)}}else U.writeVarIntNum(-1);if(L.labels!==void 0){U.writeVarIntNum(L.labels.length);for(const j of L.labels){const V=e.toArray(j,"utf8");U.writeVarIntNum(V.length),U.write(V)}}else U.writeVarIntNum(-1)}const F=new e.Writer;return F.writeUInt8(0),F.write(U.toArray()),F.toArray()}case"relinquishOutput":{const v={},_=w.readVarIntNum(),S=w.read(_);v.basket=e.toUTF8(S),v.output=this.decodeOutpoint(w),await this.wallet.relinquishOutput(v,b);const T=new e.Writer;return T.writeUInt8(0),T.toArray()}case"getPublicKey":{const v={},_=w.readUInt8();if(v.identityKey=_===1,v.identityKey!==!0){v.protocolID=this.decodeProtocolID(w),v.keyID=this.decodeString(w),v.counterparty=this.decodeCounterparty(w);const O=w.readInt8();O===-1?v.privileged=void 0:v.privileged=O===1;const A=w.readInt8();if(A!==-1){const P=w.read(A);v.privilegedReason=e.toUTF8(P)}else v.privilegedReason=void 0;const R=w.readInt8();R===-1?v.forSelf=void 0:v.forSelf=R===1}else{const O=w.readInt8();O===-1?v.privileged=void 0:v.privileged=O===1;const A=w.readInt8();if(A!==-1){const R=w.read(A);v.privilegedReason=e.toUTF8(R)}else v.privilegedReason=void 0}const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const T=await this.wallet.getPublicKey(v,b),I=new e.Writer;I.writeUInt8(0);const k=e.toArray(T.publicKey,"hex");return I.write(k),I.toArray()}case"encrypt":{const v=this.decodeKeyRelatedParams(w),_=w.readVarIntNum();v.plaintext=w.read(_);const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const T=await this.wallet.encrypt(v,b),I=new e.Writer;return I.writeUInt8(0),I.write(T.ciphertext),I.toArray()}case"decrypt":{const v=this.decodeKeyRelatedParams(w),_=w.readVarIntNum();v.ciphertext=w.read(_);const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const T=await this.wallet.decrypt(v,b),I=new e.Writer;return I.writeUInt8(0),I.write(T.plaintext),I.toArray()}case"createHmac":{const v=this.decodeKeyRelatedParams(w),_=w.readVarIntNum();v.data=w.read(_);const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const T=await this.wallet.createHmac(v,b),I=new e.Writer;return I.writeUInt8(0),I.write(T.hmac),I.toArray()}case"verifyHmac":{const v=this.decodeKeyRelatedParams(w);v.hmac=w.read(32);const _=w.readVarIntNum();v.data=w.read(_);const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0,await this.wallet.verifyHmac(v,b);const T=new e.Writer;return T.writeUInt8(0),T.toArray()}case"createSignature":{const v=this.decodeKeyRelatedParams(w),_=w.readUInt8();if(_===1){const k=w.readVarIntNum();v.data=w.read(k)}else _===2&&(v.hashToDirectlySign=w.read(32));const S=w.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const T=await this.wallet.createSignature(v,b),I=new e.Writer;return I.writeUInt8(0),I.write(T.signature),I.toArray()}case"verifySignature":{const v=this.decodeKeyRelatedParams(w),_=w.readInt8();_===-1?v.forSelf=void 0:v.forSelf=_===1;const S=w.readVarIntNum();v.signature=w.read(S);const T=w.readUInt8();if(T===1){const O=w.readVarIntNum();v.data=w.read(O)}else T===2&&(v.hashToDirectlyVerify=w.read(32));const I=w.readInt8();I>=0?v.seekPermission=I===1:v.seekPermission=void 0,await this.wallet.verifySignature(v,b);const k=new e.Writer;return k.writeUInt8(0),k.toArray()}case"isAuthenticated":{const v=await this.wallet.isAuthenticated({},b),_=new e.Writer;return _.writeUInt8(0),_.writeUInt8(v.authenticated?1:0),_.toArray()}case"waitForAuthentication":{await this.wallet.waitForAuthentication({},b);const v=new e.Writer;return v.writeUInt8(0),v.toArray()}case"getHeight":{const v=await this.wallet.getHeight({},b),_=new e.Writer;return _.writeUInt8(0),_.writeVarIntNum(v.height),_.toArray()}case"getHeaderForHeight":{const v={};v.height=w.readVarIntNum();const _=await this.wallet.getHeaderForHeight(v,b),S=new e.Writer;S.writeUInt8(0);const T=e.toArray(_.header,"hex");return S.write(T),S.toArray()}case"getNetwork":{const v=await this.wallet.getNetwork({},b),_=new e.Writer;return _.writeUInt8(0),_.writeUInt8(v.network==="mainnet"?0:1),_.toArray()}case"getVersion":{const v=await this.wallet.getVersion({},b),_=new e.Writer;_.writeUInt8(0);const S=e.toArray(v.version,"utf8");return _.write(S),_.toArray()}case"revealCounterpartyKeyLinkage":{const v={},_=w.readInt8();_===-1?v.privileged=void 0:v.privileged=_===1;const S=w.readInt8();if(S===-1)v.privilegedReason=void 0;else{const P=w.read(S);v.privilegedReason=e.toUTF8(P)}const T=w.read(33);v.counterparty=e.toHex(T);const I=w.read(33);v.verifier=e.toHex(I);const k=await this.wallet.revealCounterpartyKeyLinkage(v,b),O=new e.Writer;O.write(e.toArray(k.prover,"hex")),O.write(e.toArray(k.verifier,"hex")),O.write(e.toArray(k.counterparty,"hex"));const A=e.toArray(k.revelationTime,"utf8");O.writeVarIntNum(A.length),O.write(A),O.writeVarIntNum(k.encryptedLinkage.length),O.write(k.encryptedLinkage),O.writeVarIntNum(k.encryptedLinkageProof.length),O.write(k.encryptedLinkageProof);const R=new e.Writer;return R.writeUInt8(0),R.write(O.toArray()),R.toArray()}case"revealSpecificKeyLinkage":{const v=this.decodeKeyRelatedParams(w),_=w.read(33);v.verifier=e.toHex(_);const S=await this.wallet.revealSpecificKeyLinkage(v,b),T=new e.Writer;T.write(e.toArray(S.prover,"hex")),T.write(e.toArray(S.verifier,"hex")),T.write(e.toArray(S.counterparty,"hex")),T.writeUInt8(S.protocolID[0]);const I=e.toArray(S.protocolID[1],"utf8");T.writeVarIntNum(I.length),T.write(I);const k=e.toArray(S.keyID,"utf8");T.writeVarIntNum(k.length),T.write(k),T.writeVarIntNum(S.encryptedLinkage.length),T.write(S.encryptedLinkage),T.writeVarIntNum(S.encryptedLinkageProof.length),T.write(S.encryptedLinkageProof),T.writeUInt8(S.proofType);const O=new e.Writer;return O.writeUInt8(0),O.write(T.toArray()),O.toArray()}case"acquireCertificate":{const v={},_=w.read(32);v.type=e.toBase64(_);const S=w.read(33);v.certifier=e.toHex(S);const T=w.readVarIntNum();v.fields={};for(let N=0;N<T;N++){const D=w.readVarIntNum(),U=w.read(D),F=e.toUTF8(U),L=w.readVarIntNum(),j=w.read(L),V=e.toUTF8(j);v.fields[F]=V}const I=w.readInt8();I===-1?v.privileged=void 0:v.privileged=I===1;const k=w.readInt8();if(k===-1)v.privilegedReason=void 0;else{const N=w.read(k);v.privilegedReason=e.toUTF8(N)}const O=w.readUInt8();if(v.acquisitionProtocol=O===1?"direct":"issuance",v.acquisitionProtocol==="direct"){const N=w.read(32);v.serialNumber=e.toBase64(N),v.revocationOutpoint=this.decodeOutpoint(w);const D=w.readVarIntNum(),U=w.read(D);v.signature=e.toHex(U);const F=w.readUInt8();if(F===11)v.keyringRevealer="certifier";else{const j=[F].concat(w.read(32));v.keyringRevealer=e.toHex(j)}const L=w.readVarIntNum();v.keyringForSubject={};for(let j=0;j<L;j++){const V=w.readVarIntNum(),W=w.read(V),q=e.toUTF8(W),$=w.readVarIntNum(),Y=w.read($),Q=e.toBase64(Y);v.keyringForSubject[q]=Q}}else{const N=w.readVarIntNum(),D=w.read(N);v.certifierUrl=e.toUTF8(D)}const A=await this.wallet.acquireCertificate(v,b),P=new a.default(A.type,A.serialNumber,A.subject,A.certifier,A.revocationOutpoint,A.fields,A.signature).toBinary(),C=new e.Writer;return C.writeUInt8(0),C.write(P),C.toArray()}case"listCertificates":{const v={},_=w.readVarIntNum();v.certifiers=[];for(let C=0;C<_;C++){const N=w.read(33);v.certifiers.push(e.toHex(N))}const S=w.readVarIntNum();v.types=[];for(let C=0;C<S;C++){const N=w.read(32);v.types.push(e.toBase64(N))}const T=w.readVarIntNum();T>=0?v.limit=T:v.limit=void 0;const I=w.readVarIntNum();I>=0?v.offset=I:v.offset=void 0;const k=w.readInt8();k===-1?v.privileged=void 0:v.privileged=k===1;const O=w.readInt8();if(O===-1)v.privilegedReason=void 0;else{const C=w.read(O);v.privilegedReason=e.toUTF8(C)}const A=await this.wallet.listCertificates(v,b),R=new e.Writer;R.writeVarIntNum(A.totalCertificates);for(const C of A.certificates){const D=new a.default(C.type,C.serialNumber,C.subject,C.certifier,C.revocationOutpoint,C.fields,C.signature).toBinary();R.writeVarIntNum(D.length),R.write(D)}const P=new e.Writer;return P.writeUInt8(0),P.write(R.toArray()),P.toArray()}case"proveCertificate":{const v={},_={},S=w.read(32);_.type=e.toBase64(S);const T=w.read(33);_.subject=e.toHex(T);const I=w.read(32);_.serialNumber=e.toBase64(I);const k=w.read(33);_.certifier=e.toHex(k),_.revocationOutpoint=this.decodeOutpoint(w);const O=w.readVarIntNum(),A=w.read(O);_.signature=e.toHex(A);const R=w.readVarIntNum();_.fields={};for(let V=0;V<R;V++){const W=w.readVarIntNum(),q=w.read(W),$=e.toUTF8(q),Y=w.readVarIntNum(),Q=w.read(Y),J=e.toUTF8(Q);_.fields[$]=J}v.certificate=_;const P=w.readVarIntNum();v.fieldsToReveal=[];for(let V=0;V<P;V++){const W=w.readVarIntNum(),q=w.read(W),$=e.toUTF8(q);v.fieldsToReveal.push($)}const C=w.read(33);v.verifier=e.toHex(C);const N=w.readInt8();N===-1?v.privileged=void 0:v.privileged=N===1;const D=w.readInt8();if(D===-1)v.privilegedReason=void 0;else{const V=w.read(D);v.privilegedReason=e.toUTF8(V)}const U=await this.wallet.proveCertificate(v,b),F=new e.Writer,L=Object.entries(U.keyringForVerifier);F.writeVarIntNum(L.length);for(const[V,W]of L){const q=e.toArray(V,"utf8");F.writeVarIntNum(q.length),F.write(q);const $=e.toArray(W,"base64");F.writeVarIntNum($.length),F.write($)}const j=new e.Writer;return j.writeUInt8(0),j.write(F.toArray()),j.toArray()}case"relinquishCertificate":{const v={},_=w.read(32);v.type=e.toBase64(_);const S=w.read(32);v.serialNumber=e.toBase64(S);const T=w.read(33);v.certifier=e.toHex(T),await this.wallet.relinquishCertificate(v,b);const I=new e.Writer;return I.writeUInt8(0),I.toArray()}case"discoverByIdentityKey":{const v={},_=w.read(33);v.identityKey=e.toHex(_);const S=w.readVarIntNum();S>=0?v.limit=S:v.limit=void 0;const T=w.readVarIntNum();T>=0?v.offset=T:v.offset=void 0;const I=w.readInt8();I>=0?v.seekPermission=I===1:v.seekPermission=void 0;const k=await this.wallet.discoverByIdentityKey(v,b),O=this.serializeDiscoveryResult(k),A=new e.Writer;return A.writeUInt8(0),A.write(O),A.toArray()}case"discoverByAttributes":{const v={},_=w.readVarIntNum();v.attributes={};for(let R=0;R<_;R++){const P=w.readVarIntNum(),C=w.read(P),N=e.toUTF8(C),D=w.readVarIntNum(),U=w.read(D),F=e.toUTF8(U);v.attributes[N]=F}const S=w.readVarIntNum();S>=0?v.limit=S:v.limit=void 0;const T=w.readVarIntNum();T>=0?v.offset=T:v.offset=void 0;const I=w.readInt8();I>=0?v.seekPermission=I===1:v.seekPermission=void 0;const k=await this.wallet.discoverByAttributes(v,b),O=this.serializeDiscoveryResult(k),A=new e.Writer;return A.writeUInt8(0),A.write(O),A.toArray()}default:throw new Error(`Method ${y} not implemented`)}}catch(d){const y=new e.Writer;y.writeUInt8(typeof d.code=="number"?d.code:1);const p=typeof d.message=="string"?d.message:"Unknown error",g=e.toArray(p,"utf8");y.writeVarIntNum(g.length),y.write(g);const b=typeof d.stack=="string"?d.stack:"",w=e.toArray(b,"utf8");return y.writeVarIntNum(w.length),y.write(w),y.toArray()}}decodeProtocolID(n){const c=n.readUInt8(),d=n.readVarIntNum(),y=n.read(d),p=e.toUTF8(y);return[c,p]}decodeString(n){const c=n.readVarIntNum(),d=n.read(c);return e.toUTF8(d)}decodeCounterparty(n){const c=n.readUInt8();if(c===11)return"self";if(c===12)return"anyone";if(c===0)return;{const d=n.read(32);return e.toHex([c,...d])}}serializeDiscoveryResult(n){const c=new e.Writer;c.writeVarIntNum(n.totalCertificates);for(const d of n.certificates){const p=new a.default(d.type,d.serialNumber,d.subject,d.certifier,d.revocationOutpoint,d.fields,d.signaturre).toBinary();c.writeVarIntNum(p.length),c.write(p);const g=e.toArray(d.certifierInfo.name,"utf8");c.writeVarIntNum(g.length),c.write(g);const b=e.toArray(d.certifierInfo.iconUrl,"utf8");c.writeVarIntNum(b.length),c.write(b);const w=e.toArray(d.certifierInfo.description,"utf8");c.writeVarIntNum(w.length),c.write(w),c.writeUInt8(d.certifierInfo.trust);const v=Object.entries(d.publiclyRevealedKeyring);c.writeVarIntNum(v.length);for(const[S,T]of v){const I=e.toArray(S,"utf8");c.writeVarIntNum(I.length),c.write(I);const k=e.toArray(T,"base64");c.writeVarIntNum(k.length),c.write(k)}const _=Object.entries(d.decryptedFields);c.writeVarIntNum(_.length);for(const[S,T]of _){const I=e.toArray(S,"utf8");c.writeVarIntNum(I.length),c.write(I);const k=e.toArray(T,"utf8");c.writeVarIntNum(k.length),c.write(k)}}return c.toArray()}decodeKeyRelatedParams(n){const c={};c.protocolID=this.decodeProtocolID(n);const d=n.readVarIntNum(),y=n.read(d);c.keyID=e.toUTF8(y),c.counterparty=this.decodeCounterparty(n);const p=n.readInt8();p===-1?c.privileged=void 0:c.privileged=p===1;const g=n.readInt8();if(g===-1)c.privilegedReason=void 0;else{const b=n.read(g);c.privilegedReason=e.toUTF8(b)}return c}};return Dn.default=l,Dn}var g3;function kI(){return g3||(g3=1,function(s){var t=la&&la.__createBinding||(Object.create?function(c,d,y,p){p===void 0&&(p=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(c,p,g)}:function(c,d,y,p){p===void 0&&(p=y),c[p]=d[y]}),i=la&&la.__exportStar||function(c,d){for(var y in c)y!=="default"&&!Object.prototype.hasOwnProperty.call(d,y)&&t(d,c,y)},r=la&&la.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(s,"__esModule",{value:!0}),s.HTTPWalletJSON=s.HTTPWalletWire=s.WalletWireProcessor=s.WalletWireTransceiver=s.XDM=s.WindowCWISubstrate=void 0;var e=bI();Object.defineProperty(s,"WindowCWISubstrate",{enumerable:!0,get:function(){return r(e).default}});var o=wI();Object.defineProperty(s,"XDM",{enumerable:!0,get:function(){return r(o).default}}),i(eD(),s),i(P0(),s);var a=xI();Object.defineProperty(s,"WalletWireTransceiver",{enumerable:!0,get:function(){return r(a).default}});var l=iD();Object.defineProperty(s,"WalletWireProcessor",{enumerable:!0,get:function(){return r(l).default}});var f=_I();Object.defineProperty(s,"HTTPWalletWire",{enumerable:!0,get:function(){return r(f).default}});var n=TI();Object.defineProperty(s,"HTTPWalletJSON",{enumerable:!0,get:function(){return r(n).default}})}(la)),la}var m3;function R0(){return m3||(m3=1,function(s){var t=ua&&ua.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),i=ua&&ua.__exportStar||function(n,c){for(var d in n)d!=="default"&&!Object.prototype.hasOwnProperty.call(c,d)&&t(c,n,d)},r=ua&&ua.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.WERR_REVIEW_ACTIONS=s.WalletErrors=s.WalletClient=s.ProtoWallet=s.CachedKeyDeriver=void 0,i(gI(),s),i(p1(),s);var e=tD();Object.defineProperty(s,"CachedKeyDeriver",{enumerable:!0,get:function(){return r(e).default}});var o=mI();Object.defineProperty(s,"ProtoWallet",{enumerable:!0,get:function(){return r(o).default}});var a=II();Object.defineProperty(s,"WalletClient",{enumerable:!0,get:function(){return r(a).default}});var l=Gp();Object.defineProperty(s,"WalletErrors",{enumerable:!0,get:function(){return r(l).default}});var f=SI();Object.defineProperty(s,"WERR_REVIEW_ACTIONS",{enumerable:!0,get:function(){return r(f).default}}),i(Gp(),s),i(kI(),s)}(ua)),ua}var Hs={},da={},cn={},b3;function nD(){if(b3)return cn;b3=1;var s=cn&&cn.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),t=cn&&cn.__setModuleDefault||(Object.create?function(n,c){Object.defineProperty(n,"default",{enumerable:!0,value:c})}:function(n,c){n.default=c}),i=cn&&cn.__importStar||function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var d in n)d!=="default"&&Object.prototype.hasOwnProperty.call(n,d)&&s(c,n,d);return t(c,n),c},r=cn&&cn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cn,"__esModule",{value:!0}),cn.MasterCertificate=void 0;const e=r(wu()),o=i(me()),a=r(T0()),l=r(ji());let f=class EI extends e.default{constructor(c,d,y,p,g,b,w,v){super(c,d,y,p,g,b,v);for(const _ of Object.keys(b))if(w[_]===void 0||w[_]==="")throw new Error(`Master keyring must contain a value for every field. Missing or empty key for field: "${_}".`);this.masterKeyring=w}static async createCertificateFields(c,d,y,p,g){const b={},w={};for(const[v,_]of Object.entries(y)){const S=a.default.fromRandom(),T=S.encrypt(o.toArray(_,"utf8"));b[v]=o.toBase64(T);const{ciphertext:I}=await c.encrypt({plaintext:S.toArray(),...e.default.getCertificateFieldEncryptionDetails(v),counterparty:d,privileged:p,privilegedReason:g});w[v]=o.toBase64(I)}return{certificateFields:b,masterKeyring:w}}static async createKeyringForVerifier(c,d,y,p,g,b,w,v,_){if(!Array.isArray(g))throw new Error("fieldsToReveal must be an array of strings");const S={};for(const T of g){if(p[T]===void 0||p[T]===null||p[T]==="")throw new Error(`Fields to reveal must be a subset of the certificate fields. Missing the "${T}" field.`);const I=(await this.decryptField(c,b,T,p[T],d,v,_)).fieldRevelationKey,{ciphertext:k}=await c.encrypt({plaintext:I,...e.default.getCertificateFieldEncryptionDetails(T,w),counterparty:y,privileged:v,privilegedReason:_});S[T]=o.toBase64(k)}return S}static async issueCertificateForSubject(c,d,y,p,g=async w=>"Certificate revocation not tracked.",b){const w=b??o.toBase64((0,l.default)(32)),{certificateFields:v,masterKeyring:_}=await this.createCertificateFields(c,d,y),S=await g(w),T=new EI(p,w,d,(await c.getPublicKey({identityKey:!0})).publicKey,S,v,_);return await T.sign(c),T}static async decryptFields(c,d,y,p,g,b){if(d==null||Object.keys(d).length===0)throw new Error("A MasterCertificate must have a valid masterKeyring!");try{const w={};for(const v of Object.keys(y))w[v]=(await this.decryptField(c,d,v,y[v],p,g,b)).decryptedFieldValue;return w}catch{throw new Error("Failed to decrypt all master certificate fields.")}}static async decryptField(c,d,y,p,g,b,w){if(d==null||Object.keys(d).length===0)throw new Error("A MasterCertificate must have a valid masterKeyring!");try{const{plaintext:v}=await c.decrypt({ciphertext:o.toArray(d[y],"base64"),...e.default.getCertificateFieldEncryptionDetails(y),counterparty:g,privileged:b,privilegedReason:w}),_=new a.default(v).decrypt(o.toArray(p,"base64"));return{fieldRevelationKey:v,decryptedFieldValue:o.toUTF8(_)}}catch{throw new Error("Failed to decrypt certificate field!")}}};return cn.MasterCertificate=f,cn}var un={},w3;function y1(){if(w3)return un;w3=1;var s=un&&un.__createBinding||(Object.create?function(f,n,c,d){d===void 0&&(d=c);var y=Object.getOwnPropertyDescriptor(n,c);(!y||("get"in y?!n.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return n[c]}}),Object.defineProperty(f,d,y)}:function(f,n,c,d){d===void 0&&(d=c),f[d]=n[c]}),t=un&&un.__setModuleDefault||(Object.create?function(f,n){Object.defineProperty(f,"default",{enumerable:!0,value:n})}:function(f,n){f.default=n}),i=un&&un.__importStar||function(f){if(f&&f.__esModule)return f;var n={};if(f!=null)for(var c in f)c!=="default"&&Object.prototype.hasOwnProperty.call(f,c)&&s(n,f,c);return t(n,f),n},r=un&&un.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(un,"__esModule",{value:!0}),un.VerifiableCertificate=void 0;const e=r(T0()),o=i(me()),a=r(wu());let l=class OI extends a.default{constructor(n,c,d,y,p,g,b,w,v){super(n,c,d,y,p,g,w),this.keyring=b,this.decryptedFields=v}static fromCertificate(n,c){return new OI(n.type,n.serialNumber,n.subject,n.certifier,n.revocationOutpoint,n.fields,c,n.signature)}async decryptFields(n,c,d){if(this.keyring==null||Object.keys(this.keyring).length===0)throw new Error("A keyring is required to decrypt certificate fields for the verifier.");try{const y={};for(const p in this.keyring){const{plaintext:g}=await n.decrypt({ciphertext:o.toArray(this.keyring[p],"base64"),...a.default.getCertificateFieldEncryptionDetails(p,this.serialNumber),counterparty:this.subject,privileged:c,privilegedReason:d}),b=new e.default(g).decrypt(o.toArray(this.fields[p],"base64"));y[p]=o.toUTF8(b)}return y}catch(y){throw new Error(`Failed to decrypt selectively revealed certificate fields using keyring: ${String(y instanceof Error?y.message:y)}`)}}};return un.VerifiableCertificate=l,un}var Ks={},v3;function rD(){if(v3)return Ks;v3=1;var s=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.CompletedProtoWallet=void 0;const t=s(bu()),i=R0();let r=class extends i.ProtoWallet{constructor(o){if(super(o),o instanceof i.KeyDeriver)this.keyDeriver=o;else if(typeof o=="string"||o instanceof t.default)this.keyDeriver=new i.KeyDeriver(o);else throw new Error("Invalid key deriver provided")}async isAuthenticated(){throw new Error("not implemented")}async waitForAuthentication(){throw new Error("not implemented")}async getNetwork(){throw new Error("not implemented")}async getVersion(){throw new Error("not implemented")}async getPublicKey(o){if(o.privileged===!0)throw new Error("no privilege support");if(o.identityKey===!0){if(this.keyDeriver===null||this.keyDeriver===void 0)throw new Error("keyDeriver is not initialized");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(o.protocolID==null||typeof o.keyID!="string"||o.keyID.trim()==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");if(this.keyDeriver===null||this.keyDeriver===void 0)throw new Error("keyDeriver is not initialized");return{publicKey:this.keyDeriver.derivePublicKey(o.protocolID,o.keyID,typeof o.counterparty=="string"&&o.counterparty.trim()!==""?o.counterparty:"self",!!o.forSelf).toString()}}}async createAction(){throw new Error("not implemented")}async signAction(){throw new Error("not implemented")}async abortAction(){throw new Error("not implemented")}async listActions(){throw new Error("not implemented")}async internalizeAction(){throw new Error("not implemented")}async listOutputs(){throw new Error("not implemented")}async relinquishOutput(){throw new Error("not implemented")}async acquireCertificate(){throw new Error("not implemented")}async listCertificates(){throw new Error("not implemented")}async proveCertificate(){throw new Error("not implemented")}async relinquishCertificate(){throw new Error("not implemented")}async discoverByIdentityKey(){throw new Error("not implemented")}async discoverByAttributes(){throw new Error("not implemented")}async getHeight(){throw new Error("not implemented")}async getHeaderForHeight(){throw new Error("not implemented")}};return Ks.CompletedProtoWallet=r,Ks}var x3;function aD(){return x3||(x3=1,function(s){var t=da&&da.__createBinding||(Object.create?function(o,a,l,f){f===void 0&&(f=l);var n=Object.getOwnPropertyDescriptor(a,l);(!n||("get"in n?!a.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(o,f,n)}:function(o,a,l,f){f===void 0&&(f=l),o[f]=a[l]}),i=da&&da.__exportStar||function(o,a){for(var l in o)l!=="default"&&!Object.prototype.hasOwnProperty.call(a,l)&&t(a,o,l)},r=da&&da.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(s,"__esModule",{value:!0}),s.Certificate=void 0;var e=wu();Object.defineProperty(s,"Certificate",{enumerable:!0,get:function(){return r(e).default}}),i(nD(),s),i(y1(),s),i(rD(),s)}(da)),da}var ln={},Cl={},_3;function g1(){if(_3)return Cl;_3=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.SessionManager=void 0;let s=class{constructor(){this.sessionNonceToSession=new Map,this.identityKeyToNonces=new Map}addSession(i){if(typeof i.sessionNonce!="string")throw new Error("Invalid session: sessionNonce is required to add a session.");if(this.sessionNonceToSession.set(i.sessionNonce,i),typeof i.peerIdentityKey=="string"){let r=this.identityKeyToNonces.get(i.peerIdentityKey);r==null&&(r=new Set,this.identityKeyToNonces.set(i.peerIdentityKey,r)),r.add(i.sessionNonce)}}updateSession(i){this.removeSession(i),this.addSession(i)}getSession(i){var r,e;const o=this.sessionNonceToSession.get(i);if(o!=null)return o;const a=this.identityKeyToNonces.get(i);if(a==null||a.size===0)return;let l;for(const f of a){const n=this.sessionNonceToSession.get(f);n!=null&&(l==null||((r=n.lastUpdate)!==null&&r!==void 0?r:0)>((e=l.lastUpdate)!==null&&e!==void 0?e:0))&&(l=n)}return l}removeSession(i){var r;if(typeof i.sessionNonce=="string"&&this.sessionNonceToSession.delete(i.sessionNonce),typeof i.peerIdentityKey=="string"){const e=this.identityKeyToNonces.get(i.peerIdentityKey);e!=null&&(e.delete((r=i.sessionNonce)!==null&&r!==void 0?r:""),e.size===0&&this.identityKeyToNonces.delete(i.peerIdentityKey))}}hasSession(i){if(this.sessionNonceToSession.has(i))return!0;const e=this.identityKeyToNonces.get(i);return e!=null&&e.size>0}};return Cl.SessionManager=s,Cl}var Vs={},tr={},S3;function sD(){if(S3)return tr;S3=1;var s=tr&&tr.__createBinding||(Object.create?function(o,a,l,f){f===void 0&&(f=l);var n=Object.getOwnPropertyDescriptor(a,l);(!n||("get"in n?!a.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(o,f,n)}:function(o,a,l,f){f===void 0&&(f=l),o[f]=a[l]}),t=tr&&tr.__setModuleDefault||(Object.create?function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}:function(o,a){o.default=a}),i=tr&&tr.__importStar||function(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&s(a,o,l);return t(a,o),a};Object.defineProperty(tr,"__esModule",{value:!0}),tr.verifyNonce=void 0;const r=i(me());async function e(o,a,l="self"){const f=r.toArray(o,"base64"),n=f.slice(0,16),c=f.slice(16),{valid:d}=await a.verifyHmac({data:n,hmac:c,protocolID:[2,"server hmac"],keyID:r.toUTF8(n),counterparty:l});return d}return tr.verifyNonce=e,tr}var dn={},T3;function AI(){if(T3)return dn;T3=1;var s=dn&&dn.__createBinding||(Object.create?function(l,f,n,c){c===void 0&&(c=n);var d=Object.getOwnPropertyDescriptor(f,n);(!d||("get"in d?!f.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return f[n]}}),Object.defineProperty(l,c,d)}:function(l,f,n,c){c===void 0&&(c=n),l[c]=f[n]}),t=dn&&dn.__setModuleDefault||(Object.create?function(l,f){Object.defineProperty(l,"default",{enumerable:!0,value:f})}:function(l,f){l.default=f}),i=dn&&dn.__importStar||function(l){if(l&&l.__esModule)return l;var f={};if(l!=null)for(var n in l)n!=="default"&&Object.prototype.hasOwnProperty.call(l,n)&&s(f,l,n);return t(f,l),f},r=dn&&dn.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(dn,"__esModule",{value:!0}),dn.createNonce=void 0;const e=i(me()),o=r(ji());async function a(l,f="self"){const n=(0,o.default)(16),{hmac:c}=await l.createHmac({protocolID:[2,"server hmac"],keyID:e.toUTF8(n),data:n,counterparty:f}),d=[...n,...c];return e.toBase64(d)}return dn.createNonce=a,dn}var Dl={},I3;function oD(){if(I3)return Dl;I3=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.getVerifiableCertificates=void 0;const s=y1(),t=async(i,r,e)=>{const o=await i.listCertificates({certifiers:r.certifiers,types:Object.keys(r.types)});return await Promise.all(o.certificates.map(async a=>{const{keyringForVerifier:l}=await i.proveCertificate({certificate:a,fieldsToReveal:r.types[a.type],verifier:e});return new s.VerifiableCertificate(a.type,a.serialNumber,a.subject,a.certifier,a.revocationOutpoint,a.fields,l,a.signature)}))};return Dl.getVerifiableCertificates=t,Dl}var Bl={},k3;function cD(){if(k3)return Bl;k3=1,Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.validateCertificates=void 0;const s=y1(),t=async(i,r,e)=>{if(r.certificates==null||r.certificates.length===0)throw new Error("No certificates were provided in the AuthMessage.");await Promise.all(r.certificates.map(async o=>{if(o.subject!==r.identityKey)throw new Error(`The subject of one of your certificates ("${o.subject}") is not the same as the request sender ("${r.identityKey}").`);const a=new s.VerifiableCertificate(o.type,o.serialNumber,o.subject,o.certifier,o.revocationOutpoint,o.fields,o.keyring,o.signature);if(!await a.verify())throw new Error(`The signature for the certificate with serial number ${a.serialNumber} is invalid!`);if(e!=null){const{certifiers:f,types:n}=e;if(!f.includes(a.certifier))throw new Error(`Certificate with serial number ${a.serialNumber} has an unrequested certifier: ${a.certifier}`);if(n[a.type]==null)throw new Error(`Certificate with type ${a.type} was not requested`)}await a.decryptFields(i)}))};return Bl.validateCertificates=t,Bl}var E3;function m1(){return E3||(E3=1,function(s){var t=Vs&&Vs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Vs&&Vs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(sD(),s),i(AI(),s),i(oD(),s),i(cD(),s)}(Vs)),Vs}var O3;function PI(){if(O3)return ln;O3=1;var s=ln&&ln.__createBinding||(Object.create?function(c,d,y,p){p===void 0&&(p=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(c,p,g)}:function(c,d,y,p){p===void 0&&(p=y),c[p]=d[y]}),t=ln&&ln.__setModuleDefault||(Object.create?function(c,d){Object.defineProperty(c,"default",{enumerable:!0,value:d})}:function(c,d){c.default=d}),i=ln&&ln.__importStar||function(c){if(c&&c.__esModule)return c;var d={};if(c!=null)for(var y in c)y!=="default"&&Object.prototype.hasOwnProperty.call(c,y)&&s(d,c,y);return t(d,c),d},r=ln&&ln.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(ln,"__esModule",{value:!0}),ln.Peer=void 0;const e=g1(),o=m1(),a=r(ji()),l=i(me()),f="0.1";let n=class{constructor(d,y,p,g,b){this.onGeneralMessageReceivedCallbacks=new Map,this.onCertificatesReceivedCallbacks=new Map,this.onCertificateRequestReceivedCallbacks=new Map,this.onInitialResponseReceivedCallbacks=new Map,this.callbackIdCounter=0,this.autoPersistLastSession=!0,this.wallet=d,this.transport=y,this.certificatesToRequest=p??{certifiers:[],types:{}},this.transport.onData(this.handleIncomingMessage.bind(this)).catch(w=>{throw w}),this.sessionManager=g??new e.SessionManager,b===!1?this.autoPersistLastSession=!1:this.autoPersistLastSession=!0}async toPeer(d,y,p){var g,b;this.autoPersistLastSession&&typeof this.lastInteractedWithPeer=="string"&&typeof y!="string"&&(y=this.lastInteractedWithPeer);const w=await this.getAuthenticatedSession(y,p),v=l.toBase64((0,a.default)(32)),{signature:_}=await this.wallet.createSignature({data:d,protocolID:[2,"auth message signature"],keyID:`${v} ${(g=w.peerNonce)!==null&&g!==void 0?g:""}`,counterparty:w.peerIdentityKey}),S={version:f,messageType:"general",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:v,yourNonce:w.peerNonce,payload:d,signature:_};w.lastUpdate=Date.now(),this.sessionManager.updateSession(w);try{await this.transport.send(S)}catch(T){const I=new Error(`Failed to send message to peer ${(b=w.peerIdentityKey)!==null&&b!==void 0?b:"unknown"}: ${String(T.message)}`);throw I.stack=T.stack,I}}async requestCertificates(d,y,p=1e4){var g,b;this.autoPersistLastSession&&typeof this.lastInteractedWithPeer=="string"&&typeof y!="string"&&(y=this.lastInteractedWithPeer);const w=await this.getAuthenticatedSession(y,p),v=l.toBase64((0,a.default)(32)),{signature:_}=await this.wallet.createSignature({data:l.toArray(JSON.stringify(d),"utf8"),protocolID:[2,"auth message signature"],keyID:`${v} ${(g=w.peerNonce)!==null&&g!==void 0?g:""}`,counterparty:w.peerIdentityKey}),S={version:f,messageType:"certificateRequest",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:v,initialNonce:w.sessionNonce,yourNonce:w.peerNonce,requestedCertificates:d,signature:_};w.lastUpdate=Date.now(),this.sessionManager.updateSession(w);try{await this.transport.send(S)}catch(T){throw new Error(`Failed to send certificate request message to peer ${(b=w.peerIdentityKey)!==null&&b!==void 0?b:"unknown"}: ${String(T.message)}`)}}async getAuthenticatedSession(d,y){if(this.transport===void 0)throw new Error("Peer transport is not connected!");let p;if(typeof d=="string"&&(p=this.sessionManager.getSession(d)),p==null||!p.isAuthenticated){const g=await this.initiateHandshake(d,y);if(p=this.sessionManager.getSession(g),p==null||!p.isAuthenticated)throw new Error("Unable to establish mutual authentication with peer!")}return p}listenForGeneralMessages(d){const y=this.callbackIdCounter++;return this.onGeneralMessageReceivedCallbacks.set(y,d),y}stopListeningForGeneralMessages(d){this.onGeneralMessageReceivedCallbacks.delete(d)}listenForCertificatesReceived(d){const y=this.callbackIdCounter++;return this.onCertificatesReceivedCallbacks.set(y,d),y}stopListeningForCertificatesReceived(d){this.onCertificatesReceivedCallbacks.delete(d)}listenForCertificatesRequested(d){const y=this.callbackIdCounter++;return this.onCertificateRequestReceivedCallbacks.set(y,d),y}stopListeningForCertificatesRequested(d){this.onCertificateRequestReceivedCallbacks.delete(d)}async initiateHandshake(d,y=1e4){const p=await(0,o.createNonce)(this.wallet),g=Date.now();this.sessionManager.addSession({isAuthenticated:!1,sessionNonce:p,peerIdentityKey:d,lastUpdate:g});const b={version:f,messageType:"initialRequest",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,initialNonce:p,requestedCertificates:this.certificatesToRequest};return await this.transport.send(b),await this.waitForInitialResponse(p,y)}async waitForInitialResponse(d,y=1e4){return await new Promise((p,g)=>{const b=this.listenForInitialResponse(d,v=>{clearTimeout(w),this.stopListeningForInitialResponses(b),p(v)}),w=setTimeout(()=>{this.stopListeningForInitialResponses(b),g(new Error("Initial response timed out."))},y)})}listenForInitialResponse(d,y){const p=this.callbackIdCounter++;return this.onInitialResponseReceivedCallbacks.set(p,{callback:y,sessionNonce:d}),p}stopListeningForInitialResponses(d){this.onInitialResponseReceivedCallbacks.delete(d)}async handleIncomingMessage(d){if(typeof d.version!="string"||d.version!==f)throw new Error(`Invalid or unsupported message auth version! Received: ${d.version}, expected: ${f}`);switch(d.messageType){case"initialRequest":await this.processInitialRequest(d);break;case"initialResponse":await this.processInitialResponse(d);break;case"certificateRequest":await this.processCertificateRequest(d);break;case"certificateResponse":await this.processCertificateResponse(d);break;case"general":await this.processGeneralMessage(d);break;default:throw new Error(`Unknown message type of ${String(d.messageType)} from ${String(d.identityKey)}`)}}async processInitialRequest(d){if(typeof d.identityKey!="string"||typeof d.initialNonce!="string"||d.initialNonce==="")throw new Error("Missing required fields in initialRequest message.");const y=await(0,o.createNonce)(this.wallet),p=Date.now();this.sessionManager.addSession({isAuthenticated:!0,sessionNonce:y,peerNonce:d.initialNonce,peerIdentityKey:d.identityKey,lastUpdate:p});let g;d.requestedCertificates!=null&&Array.isArray(d.requestedCertificates.certifiers)&&d.requestedCertificates.certifiers.length>0&&(this.onCertificateRequestReceivedCallbacks.size>0?this.onCertificateRequestReceivedCallbacks.forEach(v=>{v(d.identityKey,d.requestedCertificates)}):g=await(0,o.getVerifiableCertificates)(this.wallet,d.requestedCertificates,d.identityKey));const{signature:b}=await this.wallet.createSignature({data:l.toArray(d.initialNonce+y,"base64"),protocolID:[2,"auth message signature"],keyID:`${d.initialNonce} ${y}`,counterparty:d.identityKey}),w={version:f,messageType:"initialResponse",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,initialNonce:y,yourNonce:d.initialNonce,certificates:g,requestedCertificates:this.certificatesToRequest,signature:b};this.lastInteractedWithPeer===void 0&&(this.lastInteractedWithPeer=d.identityKey),await this.transport.send(w)}async processInitialResponse(d){var y,p,g,b,w,v,_;if(!await(0,o.verifyNonce)(d.yourNonce,this.wallet))throw new Error(`Initial response nonce verification failed from peer: ${d.identityKey}`);const T=this.sessionManager.getSession(d.yourNonce);if(T==null)throw new Error(`Peer session not found for peer: ${d.identityKey}`);const I=l.toArray(((y=T.sessionNonce)!==null&&y!==void 0?y:"")+((p=d.initialNonce)!==null&&p!==void 0?p:""),"base64"),{valid:k}=await this.wallet.verifySignature({data:I,signature:d.signature,protocolID:[2,"auth message signature"],keyID:`${(g=T.sessionNonce)!==null&&g!==void 0?g:""} ${(b=d.initialNonce)!==null&&b!==void 0?b:""}`,counterparty:d.identityKey});if(!k)throw new Error(`Unable to verify initial response signature for peer: ${d.identityKey}`);if(T.peerNonce=d.initialNonce,T.peerIdentityKey=d.identityKey,T.isAuthenticated=!0,T.lastUpdate=Date.now(),this.sessionManager.updateSession(T),((v=(w=this.certificatesToRequest)===null||w===void 0?void 0:w.certifiers)===null||v===void 0?void 0:v.length)>0&&((_=d.certificates)===null||_===void 0?void 0:_.length)>0&&(await(0,o.validateCertificates)(this.wallet,d,this.certificatesToRequest),this.onCertificatesReceivedCallbacks.forEach(O=>O(d.identityKey,d.certificates))),this.lastInteractedWithPeer=d.identityKey,this.onInitialResponseReceivedCallbacks.forEach(O=>{O.sessionNonce===T.sessionNonce&&O.callback(T.sessionNonce)}),d.requestedCertificates!=null&&Array.isArray(d.requestedCertificates.certifiers)&&d.requestedCertificates.certifiers.length>0)if(this.onCertificateRequestReceivedCallbacks.size>0)this.onCertificateRequestReceivedCallbacks.forEach(O=>{O(d.identityKey,d.requestedCertificates)});else{const O=await(0,o.getVerifiableCertificates)(this.wallet,d.requestedCertificates,d.identityKey);await this.sendCertificateResponse(d.identityKey,O)}}async processCertificateRequest(d){var y,p;if(!await(0,o.verifyNonce)(d.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for certificate request message from: ${d.identityKey}`);const b=this.sessionManager.getSession(d.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${d.yourNonce}`);const{valid:w}=await this.wallet.verifySignature({data:l.toArray(JSON.stringify(d.requestedCertificates),"utf8"),signature:d.signature,protocolID:[2,"auth message signature"],keyID:`${(y=d.nonce)!==null&&y!==void 0?y:""} ${(p=b.sessionNonce)!==null&&p!==void 0?p:""}`,counterparty:b.peerIdentityKey});if(!w)throw new Error(`Invalid signature in certificate request message from ${b.peerIdentityKey}`);if(b.lastUpdate=Date.now(),this.sessionManager.updateSession(b),d.requestedCertificates!=null&&Array.isArray(d.requestedCertificates.certifiers)&&d.requestedCertificates.certifiers.length>0)if(this.onCertificateRequestReceivedCallbacks.size>0)this.onCertificateRequestReceivedCallbacks.forEach(v=>{v(d.identityKey,d.requestedCertificates)});else{const v=await(0,o.getVerifiableCertificates)(this.wallet,d.requestedCertificates,d.identityKey);await this.sendCertificateResponse(d.identityKey,v)}}async sendCertificateResponse(d,y){var p,g;const b=await this.getAuthenticatedSession(d),w=l.toBase64((0,a.default)(32)),{signature:v}=await this.wallet.createSignature({data:l.toArray(JSON.stringify(y),"utf8"),protocolID:[2,"auth message signature"],keyID:`${w} ${(p=b.peerNonce)!==null&&p!==void 0?p:""}`,counterparty:b.peerIdentityKey}),_={version:f,messageType:"certificateResponse",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:w,initialNonce:b.sessionNonce,yourNonce:b.peerNonce,certificates:y,signature:v};b.lastUpdate=Date.now(),this.sessionManager.updateSession(b);try{await this.transport.send(_)}catch(S){const T=S instanceof Error?S.message:String(S);throw new Error(`Failed to send certificate response message to peer ${(g=b.peerIdentityKey)!==null&&g!==void 0?g:"unknown"}: ${T}`)}}async processCertificateResponse(d){var y,p;if(!await(0,o.verifyNonce)(d.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for certificate response from: ${d.identityKey}`);const b=this.sessionManager.getSession(d.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${d.yourNonce}`);const{valid:w}=await this.wallet.verifySignature({data:l.toArray(JSON.stringify(d.certificates),"utf8"),signature:d.signature,protocolID:[2,"auth message signature"],keyID:`${(y=d.nonce)!==null&&y!==void 0?y:""} ${(p=b.sessionNonce)!==null&&p!==void 0?p:""}`,counterparty:d.identityKey});if(!w)throw new Error(`Unable to verify certificate response signature for peer: ${d.identityKey}`);await(0,o.validateCertificates)(this.wallet,d,d.requestedCertificates),this.onCertificatesReceivedCallbacks.forEach(v=>{var _;v(d.identityKey,(_=d.certificates)!==null&&_!==void 0?_:[])}),b.lastUpdate=Date.now(),this.sessionManager.updateSession(b)}async processGeneralMessage(d){var y,p;if(!await(0,o.verifyNonce)(d.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for general message from: ${d.identityKey}`);const b=this.sessionManager.getSession(d.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${d.yourNonce}`);const{valid:w}=await this.wallet.verifySignature({data:d.payload,signature:d.signature,protocolID:[2,"auth message signature"],keyID:`${(y=d.nonce)!==null&&y!==void 0?y:""} ${(p=b.sessionNonce)!==null&&p!==void 0?p:""}`,counterparty:b.peerIdentityKey});if(!w)throw new Error(`Invalid signature in generalMessage from ${b.peerIdentityKey}`);b.lastUpdate=Date.now(),this.sessionManager.updateSession(b),this.lastInteractedWithPeer=d.identityKey,this.onGeneralMessageReceivedCallbacks.forEach(v=>{var _;v(d.identityKey,(_=d.payload)!==null&&_!==void 0?_:[])})}};return ln.Peer=n,ln}var gm={},A3;function uD(){return A3||(A3=1,Object.defineProperty(gm,"__esModule",{value:!0})),gm}var Ws={},fn={},er={},P3;function RI(){if(P3)return er;P3=1;var s=er&&er.__createBinding||(Object.create?function(a,l,f,n){n===void 0&&(n=f);var c=Object.getOwnPropertyDescriptor(l,f);(!c||("get"in c?!l.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(a,n,c)}:function(a,l,f,n){n===void 0&&(n=f),a[n]=l[f]}),t=er&&er.__setModuleDefault||(Object.create?function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}:function(a,l){a.default=l}),i=er&&er.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var f in a)f!=="default"&&Object.prototype.hasOwnProperty.call(a,f)&&s(l,a,f);return t(l,a),l};Object.defineProperty(er,"__esModule",{value:!0}),er.SimplifiedFetchTransport=void 0;const r=i(me()),e=typeof window<"u"?fetch.bind(window):fetch;let o=class{constructor(l,f=e){this.fetchClient=f,this.baseUrl=l}async send(l){if(!this.onDataCallback)throw new Error("Listen before you start speaking. God gave you two ears and one mouth for a reason.");if(l.messageType!=="general")return new Promise(async(f,n)=>{try{const c=this.fetchClient(`${this.baseUrl}/.well-known/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});l.messageType!=="initialRequest"&&f();const d=await c;if(d.ok&&this.onDataCallback){const y=await d.json();this.onDataCallback(y)}else throw new Error("HTTP server failed to authenticate");l.messageType==="initialRequest"&&f()}catch(c){n(c);return}});{const f=this.deserializeRequestPayload(l.payload),n=`${this.baseUrl}${f.urlPostfix}`;let c=f;if(typeof f.headers!="object"&&(c.headers={}),c.headers["x-bsv-auth-version"]=l.version,c.headers["x-bsv-auth-identity-key"]=l.identityKey,c.headers["x-bsv-auth-nonce"]=l.nonce,c.headers["x-bsv-auth-your-nonce"]=l.yourNonce,c.headers["x-bsv-auth-signature"]=r.toHex(l.signature),c.headers["x-bsv-auth-request-id"]=f.requestId,c.body){const w=c.headers;if(!w["content-type"])throw new Error("Content-Type header is required for requests with a body.");const v=w["content-type"];v.includes("application/json")||v.includes("application/x-www-form-urlencoded")||v.includes("text/plain")?c.body=r.toUTF8(c.body):c.body=new Uint8Array(c.body)}const d=await this.fetchClient(n,{method:c.method,headers:c.headers,body:c.body});if(d.status===500&&!d.headers.get("x-bsv-auth-request-id")){const w=await d.json();throw new Error(`HTTP ${d.status} - ${JSON.stringify(w)}`)}const y=await d.arrayBuffer(),p=new r.Writer;p.write(r.toArray(d.headers.get("x-bsv-auth-request-id"),"base64")),p.writeVarIntNum(d.status);const g=[];d.headers.forEach((w,v)=>{const _=v.toLowerCase();(_.startsWith("x-bsv-")||_==="authorization")&&!_.startsWith("x-bsv-auth")&&g.push([_,w])}),g.sort(([w],[v])=>w.localeCompare(v)),p.writeVarIntNum(g.length);for(let w=0;w<g.length;w++){const v=r.toArray(g[w][0],"utf8");p.writeVarIntNum(v.length),p.write(v);const _=r.toArray(g[w][1],"utf8");p.writeVarIntNum(_.length),p.write(_)}if(y){const w=Array.from(new Uint8Array(y));p.writeVarIntNum(w.length),p.write(w)}else p.writeVarIntNum(-1);const b={version:d.headers.get("x-bsv-auth-version"),messageType:d.headers.get("x-bsv-auth-message-type")==="certificateRequest"?"certificateRequest":"general",identityKey:d.headers.get("x-bsv-auth-identity-key"),nonce:d.headers.get("x-bsv-auth-nonce"),yourNonce:d.headers.get("x-bsv-auth-your-nonce"),requestedCertificates:JSON.parse(d.headers.get("x-bsv-auth-requested-certificates")),payload:p.toArray(),signature:r.toArray(d.headers.get("x-bsv-auth-signature"),"hex")};if(!b.version)throw new Error("HTTP server failed to authenticate");this.onDataCallback(b)}}async onData(l){this.onDataCallback=f=>{l(f)}}deserializeRequestPayload(l){const f=new r.Reader(l),n=r.toBase64(f.read(32)),c=f.readVarIntNum();let d="GET";c>0&&(d=r.toUTF8(f.read(c)));const y=f.readVarIntNum();let p="";y>0&&(p=r.toUTF8(f.read(y)));const g=f.readVarIntNum();let b="";g>0&&(b=r.toUTF8(f.read(g)));const w={},v=f.readVarIntNum();if(v>0)for(let T=0;T<v;T++){const I=f.readVarIntNum(),k=f.read(I),O=r.toUTF8(k),A=f.readVarIntNum(),R=f.read(A),P=r.toUTF8(R);w[O]=P}let _;const S=f.readVarIntNum();return S>0&&(_=f.read(S)),{urlPostfix:p+b,method:d,headers:w,body:_,requestId:n}}};return er.SimplifiedFetchTransport=o,er}var R3;function MI(){if(R3)return fn;R3=1;var s=fn&&fn.__createBinding||(Object.create?function(b,w,v,_){_===void 0&&(_=v);var S=Object.getOwnPropertyDescriptor(w,v);(!S||("get"in S?!w.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return w[v]}}),Object.defineProperty(b,_,S)}:function(b,w,v,_){_===void 0&&(_=v),b[_]=w[v]}),t=fn&&fn.__setModuleDefault||(Object.create?function(b,w){Object.defineProperty(b,"default",{enumerable:!0,value:w})}:function(b,w){b.default=w}),i=fn&&fn.__importStar||function(b){if(b&&b.__esModule)return b;var w={};if(b!=null)for(var v in b)v!=="default"&&Object.prototype.hasOwnProperty.call(b,v)&&s(w,b,v);return t(w,b),w},r=fn&&fn.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(fn,"__esModule",{value:!0}),fn.AuthFetch=void 0;const e=i(me()),o=r(ji()),a=r(h1()),l=r(ka()),f=AI(),n=PI(),c=RI(),d=g1(),y=m1(),p="1.0";let g=class{constructor(w,v,_){this.callbacks={},this.certificatesReceived=[],this.peers={},this.wallet=w,this.requestedCertificates=v,this.sessionManager=_||new d.SessionManager}async fetch(w,v={}){if(typeof v.retryCounter=="number"){if(v.retryCounter<=0)throw new Error("Request failed after maximum number of retries.");v.retryCounter--}const _=await new Promise(async(S,T)=>{try{const{method:I="GET",headers:k={},body:O}=v,A=new URL(w),R=A.origin;let P;if(typeof this.peers[R]>"u"){const F=new c.SimplifiedFetchTransport(R);P={peer:new n.Peer(this.wallet,F,this.requestedCertificates,this.sessionManager),pendingCertificateRequests:[]},this.peers[R]=P,this.peers[R].peer.listenForCertificatesReceived((L,j)=>{this.certificatesReceived.push(...j)}),this.peers[R].peer.listenForCertificatesRequested(async(L,j)=>{try{this.peers[R].pendingCertificateRequests.push(!0);const V=await(0,y.getVerifiableCertificates)(this.wallet,j,L);await this.peers[R].peer.sendCertificateResponse(L,V)}finally{await new Promise(V=>setTimeout(V,500)),this.peers[R].pendingCertificateRequests.shift()}})}else{if(this.peers[R].supportsMutualAuth===!1){try{const F=await this.handleFetchAndValidate(w,v,this.peers[R]);S(F)}catch(F){T(F)}return}P=this.peers[R]}const C=(0,o.default)(32),N=e.toBase64(C),D=await this.serializeRequest(I,k,O,A,C);this.callbacks[N]={resolve:S,reject:T};const U=P.peer.listenForGeneralMessages((F,L)=>{const j=new e.Reader(L);if(e.toBase64(j.read(32))!==N)return;P.peer.stopListeningForGeneralMessages(U),this.peers[R].identityKey=F,this.peers[R].supportsMutualAuth=!0;const W=j.readVarIntNum(),q={},$=j.readVarIntNum();if($>0)for(let vt=0;vt<$;vt++){const wt=j.readVarIntNum(),dt=j.read(wt),yt=e.toUTF8(dt),_t=j.readVarIntNum(),tt=j.read(_t),xt=e.toUTF8(tt);q[yt]=xt}q["x-bsv-auth-identity-key"]=F;let Y;const Q=j.readVarIntNum();Q>0&&(Y=j.read(Q));const J=new Response(Y?new Uint8Array(Y):null,{status:W,statusText:`${W}`,headers:new Headers(q)});this.callbacks[N].resolve(J),delete this.callbacks[N]});P.pendingCertificateRequests.length>0&&await new Promise(F=>{setInterval(()=>{P.pendingCertificateRequests.length===0&&F()},100)}),await P.peer.toPeer(D.toArray(),P.identityKey).catch(async F=>{var L;if(F.message.includes("Session not found for nonce")){delete this.peers[R],(L=v.retryCounter)!==null&&L!==void 0||(v.retryCounter=3);const j=await this.fetch(w,v);S(j);return}if(F.message.includes("HTTP server failed to authenticate"))try{const j=await this.handleFetchAndValidate(w,v,P);S(j);return}catch(j){T(j)}else T(F)})}catch(I){T(I)}});return _.status===402?await this.handlePaymentAndRetry(w,v,_):_}async sendCertificateRequest(w,v){const S=new URL(w).origin;let T;if(typeof this.peers[S]<"u")T={peer:this.peers[S].peer};else{const I=new c.SimplifiedFetchTransport(S);T={peer:new n.Peer(this.wallet,I,this.requestedCertificates,this.sessionManager)},this.peers[S]=T}return await new Promise(async(I,k)=>{const O=T.peer.listenForCertificatesReceived((A,R)=>{T.peer.stopListeningForCertificatesReceived(O),this.certificatesReceived.push(...R),I(R)});try{await T.peer.requestCertificates(v,T.identityKey)}catch(A){T.peer.stopListeningForCertificatesReceived(O),k(A)}})}consumeReceivedCertificates(){return this.certificatesReceived.splice(0)}async serializeRequest(w,v,_,S,T){const I=new e.Writer;if(I.write(T),I.writeVarIntNum(w.length),I.write(e.toArray(w)),S.pathname.length>0){const A=e.toArray(S.pathname);I.writeVarIntNum(A.length),I.write(A)}else I.writeVarIntNum(-1);if(S.search.length>0){const A=e.toArray(S.search);I.writeVarIntNum(A.length),I.write(A)}else I.writeVarIntNum(-1);const k=[];for(let[A,R]of Object.entries(v))if(A=A.toLowerCase(),A.startsWith("x-bsv-")||A==="authorization"){if(A.startsWith("x-bsv-auth"))throw new Error("No BSV auth headers allowed here!");k.push([A,R])}else if(A.startsWith("content-type"))R=R.split(";")[0].trim(),k.push([A,R]);else throw new Error("Unsupported header in the simplified fetch implementation. Only content-type, authorization, and x-bsv-* headers are supported.");k.sort(([A],[R])=>A.localeCompare(R)),I.writeVarIntNum(k.length);for(let A=0;A<k.length;A++){const R=e.toArray(k[A][0],"utf8");I.writeVarIntNum(R.length),I.write(R);const P=e.toArray(k[A][1],"utf8");I.writeVarIntNum(P.length),I.write(P)}if(["POST","PUT","PATCH","DELETE"].includes(w.toUpperCase())&&_===void 0){const A=k.find(([R])=>R==="content-type");A&&A[1].includes("application/json")?_="{}":_=""}if(_){const A=await this.normalizeBodyToNumberArray(_);I.writeVarIntNum(A.length),I.write(A)}else I.writeVarIntNum(-1);return I}async handleFetchAndValidate(w,v,_){const S=await fetch(w,v);if(S.headers.forEach(T=>{if(T.toLocaleLowerCase().startsWith("x-bsv"))throw new Error("The server is trying to claim it has been authenticated when it has not!")}),S.ok)return _.supportsMutualAuth=!1,S;throw new Error(`Request failed with status: ${S.status}`)}async handlePaymentAndRetry(w,v={},_){var S;const T=_.headers.get("x-bsv-payment-version");if(!T||T!==p)throw new Error(`Unsupported x-bsv-payment-version response header. Client version: ${p}, Server version: ${T}`);const I=_.headers.get("x-bsv-payment-satoshis-required");if(!I)throw new Error("Missing x-bsv-payment-satoshis-required response header.");const k=parseInt(I);if(isNaN(k)||k<=0)throw new Error("Invalid x-bsv-payment-satoshis-required response header value.");const O=_.headers.get("x-bsv-auth-identity-key");if(!O)throw new Error("Missing x-bsv-auth-identity-key response header.");const A=_.headers.get("x-bsv-payment-derivation-prefix");if(typeof A!="string"||A.length<1)throw new Error("Missing x-bsv-payment-derivation-prefix response header.");const R=await(0,f.createNonce)(this.wallet),{publicKey:P}=await this.wallet.getPublicKey({protocolID:[2,"3241645161d8"],keyID:`${A} ${R}`,counterparty:O}),C=new a.default().lock(l.default.fromString(P).toAddress()).toHex(),{tx:N}=await this.wallet.createAction({description:`Payment for request to ${new URL(w).origin}`,outputs:[{satoshis:k,lockingScript:C,customInstructions:JSON.stringify({derivationPrefix:A,derivationSuffix:R,payee:O}),outputDescription:"HTTP request payment"}],options:{randomizeOutputs:!1}});return v.headers=v.headers||{},v.headers["x-bsv-payment"]=JSON.stringify({derivationPrefix:A,derivationSuffix:R,transaction:e.toBase64(N)}),(S=v.retryCounter)!==null&&S!==void 0||(v.retryCounter=3),this.fetch(w,v)}async normalizeBodyToNumberArray(w){if(w==null)return[];if(typeof w=="object")return e.toArray(JSON.stringify(w,"utf8"));if(Array.isArray(w)&&w.every(v=>typeof v=="number"))return w;if(typeof w=="string")return e.toArray(w,"utf8");if(w instanceof ArrayBuffer||ArrayBuffer.isView(w)){const v=w instanceof ArrayBuffer?new Uint8Array(w):new Uint8Array(w.buffer);return Array.from(v)}if(w instanceof Blob){const v=await w.arrayBuffer();return Array.from(new Uint8Array(v))}if(w instanceof FormData){const v=[];w.forEach((S,T)=>{v.push([T,S.toString()])});const _=new URLSearchParams(v).toString();return e.toArray(_,"utf8")}if(w instanceof URLSearchParams)return e.toArray(w.toString(),"utf8");throw w instanceof ReadableStream?new Error("ReadableStream cannot be directly converted to number[]."):new Error("Unsupported body type in this SimplifiedFetch implementation.")}};return fn.AuthFetch=g,fn}var M3;function NI(){return M3||(M3=1,function(s){var t=Ws&&Ws.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Ws&&Ws.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(MI(),s)}(Ws)),Ws}var $s={},N3;function lD(){return N3||(N3=1,function(s){var t=$s&&$s.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=$s&&$s.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(RI(),s)}($s)),$s}var C3;function dD(){return C3||(C3=1,function(s){var t=Hs&&Hs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Hs&&Hs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(aD(),s),i(PI(),s),i(g1(),s),i(uD(),s),i(m1(),s),i(NI(),s),i(lD(),s)}(Hs)),Hs}var fa={},Fl={},qc={},D3;function b1(){if(D3)return qc;D3=1;var s=qc&&qc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qc,"__esModule",{value:!0});const t=s(E0()),i=Cr();let r=class{static decode(o){const a=t.default.decode(o);if(a.fields.length<4)throw new Error("Invalid SHIP/SLAP advertisement!");const l=i.Utils.toUTF8(a.fields[0]);if(l!=="SHIP"&&l!=="SLAP")throw new Error("Invalid protocol type!");const f=i.Utils.toHex(a.fields[1]),n=i.Utils.toUTF8(a.fields[2]),c=i.Utils.toUTF8(a.fields[3]);return{protocol:l,identityKey:f,domain:n,topicOrService:c}}constructor(o){this.pushDrop=new t.default(o)}async lock(o,a,l){const{publicKey:f}=await this.pushDrop.wallet.getPublicKey({identityKey:!0});return await this.pushDrop.lock([i.Utils.toArray(o,"utf8"),i.Utils.toArray(f,"hex"),i.Utils.toArray(a,"utf8"),i.Utils.toArray(l,"utf8")],[2,o==="SHIP"?"Service Host Interconnect":"Service Lookup Availability"],"1","self")}unlock(o){return this.pushDrop.unlock([2,o==="SHIP"?"Service Host Interconnect":"Service Lookup Availability"],"1","self")}};return qc.default=r,qc}var B3;function xb(){return B3||(B3=1,function(s){var t=Fl&&Fl.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.HTTPSOverlayLookupFacilitator=s.DEFAULT_TESTNET_SLAP_TRACKERS=s.DEFAULT_SLAP_TRACKERS=void 0;const i=xf(),r=t(b1());s.DEFAULT_SLAP_TRACKERS=["https://users.bapp.dev"],s.DEFAULT_TESTNET_SLAP_TRACKERS=["https://testnet-users.bapp.dev"];const e=5e3;class o{constructor(f=fetch,n=!1){this.fetchClient=f,this.allowHTTP=n}async lookup(f,n,c=5e3){if(!f.startsWith("https:")&&!this.allowHTTP)throw new Error('HTTPS facilitator can only use URLs that start with "https:"');const d=new Promise((g,b)=>setTimeout(()=>b(new Error("Request timed out")),c)),y=fetch(`${f}/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:n.service,query:n.query})}),p=await Promise.race([y,d]);if(p.ok)return await p.json();throw new Error("Failed to facilitate lookup")}}s.HTTPSOverlayLookupFacilitator=o;let a=class{constructor(f={}){var n,c,d,y,p;this.networkPreset=(n=f.networkPreset)!==null&&n!==void 0?n:"mainnet",this.facilitator=(c=f.facilitator)!==null&&c!==void 0?c:new o(void 0,this.networkPreset==="local"),this.slapTrackers=(d=f.slapTrackers)!==null&&d!==void 0?d:this.networkPreset==="mainnet"?s.DEFAULT_SLAP_TRACKERS:s.DEFAULT_TESTNET_SLAP_TRACKERS,this.hostOverrides=(y=f.hostOverrides)!==null&&y!==void 0?y:{},this.additionalHosts=(p=f.additionalHosts)!==null&&p!==void 0?p:{}}async query(f,n){var c;let d=[];if(f.service==="ls_slap"?d=this.networkPreset==="local"?["http://localhost:8080"]:this.slapTrackers:this.hostOverrides[f.service]!=null?d=this.hostOverrides[f.service]:this.networkPreset==="local"?d=["http://localhost:8080"]:d=await this.findCompetentHosts(f.service),((c=this.additionalHosts[f.service])===null||c===void 0?void 0:c.length)>0&&(d=[...d,...this.additionalHosts[f.service]]),d.length<1)throw new Error(`No competent ${this.networkPreset} hosts found by the SLAP trackers for lookup service: ${f.service}`);const p=(await Promise.allSettled(d.map(async b=>await this.facilitator.lookup(b,f,n)))).filter(b=>b.status==="fulfilled").map(b=>b.value);if(p.length===0)throw new Error("No successful responses from any hosts");if(p[0].type==="freeform")return p[0];const g=new Map;for(const b of p)if(b.type==="output-list")try{for(const w of b.outputs)try{const v=String(i.Transaction.fromBEEF(w.beef).id("hex"));if(v!==""){const _=`${String(v)}.${String(w.outputIndex)}`;g.set(_,w)}else console.warn("Invalid transaction ID:",v)}catch{continue}}catch{}return{type:"output-list",outputs:Array.from(g.values())}}async findCompetentHosts(f){const n={service:"ls_slap",query:{service:f}},c=await Promise.allSettled(this.slapTrackers.map(async y=>await this.facilitator.lookup(y,n,e))),d=new Set;for(const y of c)if(y.status==="fulfilled"){const p=y.value;if(p.type!=="output-list")continue;for(const g of p.outputs)try{const w=i.Transaction.fromBEEF(g.beef).outputs[g.outputIndex].lockingScript,v=r.default.decode(w);if(v.topicOrService!==f||v.protocol!=="SLAP")continue;d.add(v.domain)}catch{continue}}else continue;return[...d]}};s.default=a}(Fl)),Fl}var es={},F3;function np(){if(F3)return es;F3=1;var s=es&&es.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(es,"__esModule",{value:!0}),es.HTTPSOverlayBroadcastFacilitator=void 0;const t=xf(),i=s(xb()),r=s(b1()),e=5e3;class o{constructor(f=fetch,n=!1){this.httpClient=f,this.allowHTTP=n}async send(f,n){if(console.log(f),!f.startsWith("https:")&&!this.allowHTTP)throw new Error('HTTPS facilitator can only use URLs that start with "https:"');const c=await fetch(`${f}/submit`,{method:"POST",headers:{"Content-Type":"application/octet-stream","X-Topics":JSON.stringify(n.topics)},body:new Uint8Array(n.beef)});if(c.ok)return await c.json();throw new Error("Failed to facilitate broadcast")}}es.HTTPSOverlayBroadcastFacilitator=o;class a{constructor(f,n={}){var c,d,y,p,g,b;if(f.length===0)throw new Error("At least one topic is required for broadcast.");if(f.some(w=>!w.startsWith("tm_")))throw new Error('Every topic must start with "tm_".');this.topics=f,this.networkPreset=(c=n.networkPreset)!==null&&c!==void 0?c:"mainnet",this.facilitator=(d=n.facilitator)!==null&&d!==void 0?d:new o(void 0,this.networkPreset==="local"),this.resolver=(y=n.resolver)!==null&&y!==void 0?y:new i.default({networkPreset:this.networkPreset}),this.requireAcknowledgmentFromAllHostsForTopics=(p=n.requireAcknowledgmentFromAllHostsForTopics)!==null&&p!==void 0?p:[],this.requireAcknowledgmentFromAnyHostForTopics=(g=n.requireAcknowledgmentFromAnyHostForTopics)!==null&&g!==void 0?g:"all",this.requireAcknowledgmentFromSpecificHostsForTopics=(b=n.requireAcknowledgmentFromSpecificHostsForTopics)!==null&&b!==void 0?b:{}}async broadcast(f){console.log(f);let n;try{n=f.toBEEF()}catch{throw new Error("Transactions sent via SHIP to Overlay Services must be serializable to BEEF format.")}const c=await this.findInterestedHosts();if(console.log(c),Object.keys(c).length===0)return{status:"error",code:"ERR_NO_HOSTS_INTERESTED",description:`No ${this.networkPreset} hosts are interested in receiving this transaction.`};const d=Object.entries(c).map(async([S,T])=>{try{const I=await this.facilitator.send(S,{beef:n,topics:[...T]});if(I==null||Object.keys(I).length===0)throw new Error("Steak has no topics.");return{host:S,success:!0,steak:I}}catch(I){return console.error(I),{host:S,success:!1,error:I}}}),p=(await Promise.all(d)).filter(S=>S.success);if(p.length===0)return{status:"error",code:"ERR_ALL_HOSTS_REJECTED",description:`All ${this.networkPreset} topical hosts have rejected the transaction.`};const g={};for(const S of p){const T=S.host,I=S.steak,k=new Set;for(const[O,A]of Object.entries(I)){const R=A.outputsToAdmit,P=A.coinsToRetain,C=A.coinsRemoved;((R==null?void 0:R.length)>0||(P==null?void 0:P.length)>0||(C==null?void 0:C.length)>0)&&k.add(O)}g[T]=k}let b,w;if(this.requireAcknowledgmentFromAllHostsForTopics==="all"?(b=this.topics,w="all"):this.requireAcknowledgmentFromAllHostsForTopics==="any"?(b=this.topics,w="any"):Array.isArray(this.requireAcknowledgmentFromAllHostsForTopics)?(b=this.requireAcknowledgmentFromAllHostsForTopics,w="all"):(b=this.topics,w="all"),b.length>0&&!this.checkAcknowledgmentFromAllHosts(g,b,w))return{status:"error",code:"ERR_REQUIRE_ACK_FROM_ALL_HOSTS_FAILED",description:"Not all hosts acknowledged the required topics."};let v,_;return this.requireAcknowledgmentFromAnyHostForTopics==="all"?(v=this.topics,_="all"):this.requireAcknowledgmentFromAnyHostForTopics==="any"?(v=this.topics,_="any"):Array.isArray(this.requireAcknowledgmentFromAnyHostForTopics)?(v=this.requireAcknowledgmentFromAnyHostForTopics,_="all"):(v=[],_="all"),v.length>0&&!this.checkAcknowledgmentFromAnyHost(g,v,_)?{status:"error",code:"ERR_REQUIRE_ACK_FROM_ANY_HOST_FAILED",description:"No host acknowledged the required topics."}:Object.keys(this.requireAcknowledgmentFromSpecificHostsForTopics).length>0&&!this.checkAcknowledgmentFromSpecificHosts(g,this.requireAcknowledgmentFromSpecificHostsForTopics)?{status:"error",code:"ERR_REQUIRE_ACK_FROM_SPECIFIC_HOSTS_FAILED",description:"Specific hosts did not acknowledge the required topics."}:{status:"success",txid:f.id("hex"),message:`Sent to ${p.length} Overlay Services ${p.length===1?"host":"hosts"}.`}}checkAcknowledgmentFromAllHosts(f,n,c){for(const d of Object.values(f))if(c==="all"){for(const y of n)if(!d.has(y))return!1}else if(c==="any"){let y=!1;for(const p of n)if(d.has(p)){y=!0;break}if(!y)return!1}return!0}checkAcknowledgmentFromAnyHost(f,n,c){if(c==="all"){for(const d of Object.values(f)){let y=!0;for(const p of n)if(!d.has(p)){y=!1;break}if(y)return!0}return!1}else{for(const d of Object.values(f))for(const y of n)if(d.has(y))return!0;return!1}}checkAcknowledgmentFromSpecificHosts(f,n){for(const[c,d]of Object.entries(n)){const y=f[c];if(y==null)return!1;let p,g;if(d==="all"||d==="any")g=d,p=this.topics;else if(Array.isArray(d))p=d,g="all";else continue;if(g==="all"){for(const b of p)if(!y.has(b))return!1}else if(g==="any"){let b=!1;for(const w of p)if(y.has(w)){b=!0;break}if(!b)return!1}}return!0}async findInterestedHosts(){if(this.networkPreset==="local"){const c=new Set;for(let d=0;d<this.topics.length;d++)c.add(this.topics[d]);return{"http://localhost:8080":c}}const f={},n=await this.resolver.query({service:"ls_ship",query:{topics:this.topics}},e);if(n.type!=="output-list")throw new Error("SHIP answer is not an output list.");for(const c of n.outputs)try{const y=t.Transaction.fromBEEF(c.beef).outputs[c.outputIndex].lockingScript,p=r.default.decode(y);if(!this.topics.includes(p.topicOrService)||p.protocol!=="SHIP")continue;f[p.domain]===void 0&&(f[p.domain]=new Set),f[p.domain].add(p.topicOrService)}catch{continue}return f}}return es.default=a,es}var L3;function M0(){return L3||(L3=1,function(s){var t=fa&&fa.__createBinding||(Object.create?function(n,c,d,y){y===void 0&&(y=d);var p=Object.getOwnPropertyDescriptor(c,d);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[d]}}),Object.defineProperty(n,y,p)}:function(n,c,d,y){y===void 0&&(y=d),n[y]=c[d]}),i=fa&&fa.__exportStar||function(n,c){for(var d in n)d!=="default"&&!Object.prototype.hasOwnProperty.call(c,d)&&t(c,n,d)},r=fa&&fa.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(s,"__esModule",{value:!0}),s.SHIPCast=s.SHIPBroadcaster=s.TopicBroadcaster=s.LookupResolver=s.OverlayAdminTokenTemplate=void 0,i(xb(),s),i(np(),s);var e=b1();Object.defineProperty(s,"OverlayAdminTokenTemplate",{enumerable:!0,get:function(){return r(e).default}});var o=xb();Object.defineProperty(s,"LookupResolver",{enumerable:!0,get:function(){return r(o).default}});var a=np();Object.defineProperty(s,"TopicBroadcaster",{enumerable:!0,get:function(){return r(a).default}});var l=np();Object.defineProperty(s,"SHIPBroadcaster",{enumerable:!0,get:function(){return r(l).default}});var f=np();Object.defineProperty(s,"SHIPCast",{enumerable:!0,get:function(){return r(f).default}})}(fa)),fa}var ha={},mm={},U3;function CI(){return U3||(U3=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.isValidURL=s.getHashFromURL=s.getURLForFile=s.getURLForHash=s.normalizeURL=void 0;const t=li(),i=me(),r=f=>(f.toLowerCase().startsWith("uhrp:")&&(f=f.slice(5)),f.startsWith("//")&&(f=f.slice(2)),f);s.normalizeURL=r;const e=f=>{if(f.length!==32)throw new Error("Hash length must be 32 bytes (sha256)");return(0,i.toBase58Check)(f,(0,i.toArray)("ce00","hex"))};s.getURLForHash=e;const o=f=>{const n=(0,t.sha256)(f);return(0,s.getURLForHash)(n)};s.getURLForFile=o;const a=f=>{f=(0,s.normalizeURL)(f);const{data:n,prefix:c}=(0,i.fromBase58Check)(f,void 0,2);if(n.length!==32)throw new Error("Invalid length!");if((0,i.toHex)(c)!=="ce00")throw new Error("Bad prefix");return n};s.getHashFromURL=a;const l=f=>{try{return(0,s.getHashFromURL)(f),!0}catch{return!1}};s.isValidURL=l}(mm)),mm}var ir={},q3;function fD(){if(q3)return ir;q3=1;var s=ir&&ir.__createBinding||(Object.create?function(a,l,f,n){n===void 0&&(n=f);var c=Object.getOwnPropertyDescriptor(l,f);(!c||("get"in c?!l.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(a,n,c)}:function(a,l,f,n){n===void 0&&(n=f),a[n]=l[f]}),t=ir&&ir.__setModuleDefault||(Object.create?function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}:function(a,l){a.default=l}),i=ir&&ir.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var f in a)f!=="default"&&Object.prototype.hasOwnProperty.call(a,f)&&s(l,a,f);return t(l,a),l};Object.defineProperty(ir,"__esModule",{value:!0}),ir.StorageUploader=void 0;const r=MI(),e=i(CI());let o=class{constructor(l){this.baseURL=l.storageURL,this.authFetch=new r.AuthFetch(l.wallet)}async getUploadInfo(l,f){const n=`${this.baseURL}/upload`,c={fileSize:l,retentionPeriod:f},d=await this.authFetch.fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok)throw new Error(`Upload info request failed: HTTP ${d.status}`);const y=await d.json();if(y.status==="error")throw new Error("Upload route returned an error.");return{uploadURL:y.uploadURL,requiredHeaders:y.requiredHeaders,amount:y.amount}}async uploadFile(l,f,n){const c=Uint8Array.from(f.data),d=await fetch(l,{method:"PUT",body:c,headers:{"Content-Type":f.type,...n}});if(!d.ok)throw new Error(`File upload failed: HTTP ${d.status}`);return{published:!0,uhrpURL:await e.getURLForFile(f.data)}}async publishFile(l){const{file:f,retentionPeriod:n}=l,c=f.data.length,{uploadURL:d,requiredHeaders:y}=await this.getUploadInfo(c,n);return await this.uploadFile(d,f,y)}async findFile(l){var f,n;const c=new URL(`${this.baseURL}/find`);c.searchParams.set("uhrpUrl",l);const d=await this.authFetch.fetch(c.toString(),{method:"GET"});if(!d.ok)throw new Error(`findFile request failed: HTTP ${d.status}`);const y=await d.json();if(y.status==="error"){const p=(f=y.code)!==null&&f!==void 0?f:"unknown-code",g=(n=y.description)!==null&&n!==void 0?n:"no-description";throw new Error(`findFile returned an error: ${p} - ${g}`)}return y.data}async listUploads(){var l,f;const n=`${this.baseURL}/list`,c=await this.authFetch.fetch(n,{method:"GET"});if(!c.ok)throw new Error(`listUploads request failed: HTTP ${c.status}`);const d=await c.json();if(d.status==="error"){const y=(l=d.code)!==null&&l!==void 0?l:"unknown-code",p=(f=d.description)!==null&&f!==void 0?f:"no-description";throw new Error(`listUploads returned an error: ${y} - ${p}`)}return d.uploads}async renewFile(l,f){var n,c;const d=`${this.baseURL}/renew`,y={uhrpUrl:l,additionalMinutes:f},p=await this.authFetch.fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!p.ok)throw new Error(`renewFile request failed: HTTP ${p.status}`);const g=await p.json();if(g.status==="error"){const b=(n=g.code)!==null&&n!==void 0?n:"unknown-code",w=(c=g.description)!==null&&c!==void 0?c:"no-description";throw new Error(`renewFile returned an error: ${b} - ${w}`)}return{status:g.status,prevExpiryTime:g.prevExpiryTime,newExpiryTime:g.newExpiryTime,amount:g.amount}}};return ir.StorageUploader=o,ir}var zs={},j3;function hD(){if(j3)return zs;j3=1;var s=zs&&zs.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(zs,"__esModule",{value:!0}),zs.StorageDownloader=void 0;const t=M0(),i=DI(),r=s(E0()),e=s(vf()),o=Cr();let a=class{constructor(f){this.networkPreset="mainnet",this.networkPreset=f==null?void 0:f.networkPreset}async resolve(f){const c=await new t.LookupResolver({networkPreset:this.networkPreset}).query({service:"ls_uhrp",query:{uhrpUrl:f}});if(c.type!=="output-list")throw new Error("Lookup answer must be an output list");const d=[],y=Math.floor(Date.now()/1e3);for(let p=0;p<c.outputs.length;p++){const g=e.default.fromBEEF(c.outputs[p].beef),{fields:b}=r.default.decode(g.outputs[c.outputs[p].outputIndex].lockingScript);new o.Utils.Reader(b[3]).readVarIntNum()<y||d.push(o.Utils.toUTF8(b[2]))}return d}async download(f){if(!i.StorageUtils.isValidURL(f))throw new Error("Invalid parameter UHRP url");const n=i.StorageUtils.getHashFromURL(f),c=await this.resolve(f);if(!Array.isArray(c)||c.length===0)throw new Error("No one currently hosts this file!");for(let d=0;d<c.length;d++)try{const y=await fetch(c[d],{method:"GET"});if(!y.ok||y.status>=400)continue;const p=await y.arrayBuffer(),g=[...new Uint8Array(p)],b=o.Hash.sha256(g);for(let w=0;w<b.length;++w)if(b[w]!==n[w])throw new Error("Value of content does not match hash of the url given");return{data:g,mimeType:y.headers.get("Content-Type")}}catch{continue}throw new Error(`Unable to download content from ${f}`)}};return zs.StorageDownloader=a,zs}var H3;function DI(){return H3||(H3=1,function(s){var t=ha&&ha.__createBinding||(Object.create?function(a,l,f,n){n===void 0&&(n=f);var c=Object.getOwnPropertyDescriptor(l,f);(!c||("get"in c?!l.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(a,n,c)}:function(a,l,f,n){n===void 0&&(n=f),a[n]=l[f]}),i=ha&&ha.__setModuleDefault||(Object.create?function(a,l){Object.defineProperty(a,"default",{enumerable:!0,value:l})}:function(a,l){a.default=l}),r=ha&&ha.__importStar||function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var f in a)f!=="default"&&Object.prototype.hasOwnProperty.call(a,f)&&t(l,a,f);return i(l,a),l};Object.defineProperty(s,"__esModule",{value:!0}),s.StorageDownloader=s.StorageUploader=s.StorageUtils=void 0,s.StorageUtils=r(CI());var e=fD();Object.defineProperty(s,"StorageUploader",{enumerable:!0,get:function(){return e.StorageUploader}});var o=hD();Object.defineProperty(s,"StorageDownloader",{enumerable:!0,get:function(){return o.StorageDownloader}})}(ha)),ha}var Xs={},Gs={},pa={},K3;function BI(){return K3||(K3=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.KNOWN_IDENTITY_TYPES=pa.DEFAULT_IDENTITY_CLIENT_OPTIONS=pa.defaultIdentity=void 0,pa.defaultIdentity={name:"Unknown Identity",avatarURL:"XUUB8bbn9fEthk15Ge3zTQXypUShfC94vFjp65v7u5CQ8qkpxzst",identityKey:"",abbreviatedKey:"",badgeIconURL:"XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",badgeLabel:"Not verified by anyone you trust.",badgeClickURL:"https://projectbabbage.com/docs/unknown-identity"},pa.DEFAULT_IDENTITY_CLIENT_OPTIONS={protocolID:[1,"identity"],keyID:"1",tokenAmount:1,outputIndex:0},pa.KNOWN_IDENTITY_TYPES={identiCert:"z40BOInXkI8m7f/wBrv4MJ09bZfzZbTj2fJqCtONqCY=",discordCert:"2TgqRC35B1zehGmB21xveZNc7i5iqHc0uxMb+1NMPW4=",phoneCert:"mffUklUzxbHr65xLohn0hRL0Tq2GjW1GYF/OPfzqJ6A=",xCert:"vdDWvftf1H+5+ZprUw123kjHlywH+v20aPQTuXgMpNc=",registrant:"YoPsbfR6YQczjzPdHCoGC7nJsOdPQR50+SYqcWpJ0y0=",emailCert:"exOl3KM0dIJ04EW5pZgbZmPag6MdJXd3/a1enmUU/BA=",anyone:"mfkOMfLDQmrr3SBxBQ5WeE+6Hy3VJRFq6w4A5Ljtlis=",self:"Hkge6X5JRxt1cWXtHLCrSTg6dCVTxjQJJ48iOYd7n3g=",coolCert:"AGfk/WrT1eBDXpz3mcw386Zww2HmqcIn3uY6x4Af1eo="}),pa}var V3;function pD(){if(V3)return Gs;V3=1;var s=Gs&&Gs.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.IdentityClient=void 0;const t=NI(),i=BI(),r=R0(),e=xf(),o=s(wu()),a=O0(),l=Cr(),f=M0();let n=class _b{constructor(d,y=i.DEFAULT_IDENTITY_CLIENT_OPTIONS,p){this.options=y,this.originator=p,this.wallet=d??new r.WalletClient,this.authClient=new t.AuthFetch(this.wallet)}async publiclyRevealAttributes(d,y){if(Object.keys(d.fields).length===0)throw new Error("Public reveal failed: Certificate has no fields to reveal!");if(y.length===0)throw new Error("Public reveal failed: You must reveal at least one field!");try{await new o.default(d.type,d.serialNumber,d.subject,d.certifier,d.revocationOutpoint,d.fields,d.signature).verify()}catch{throw new Error("Public reveal failed: Certificate verification failed!")}const{keyringForVerifier:p}=await this.wallet.proveCertificate({certificate:d,fieldsToReveal:y,verifier:new l.PrivateKey(1).toPublicKey().toString()}),g=await new a.PushDrop(this.wallet).lock([l.Utils.toArray(JSON.stringify({...d,keyring:p}))],this.options.protocolID,this.options.keyID,"anyone",!0,!0),{tx:b}=await this.wallet.createAction({description:"Create a new Identity Token",outputs:[{satoshis:this.options.tokenAmount,lockingScript:g.toHex(),outputDescription:"Identity Token"}],options:{randomizeOutputs:!1}});if(b!==void 0)return await new f.TopicBroadcaster(["tm_identity"],{networkPreset:(await this.wallet.getNetwork({})).network}).broadcast(e.Transaction.fromAtomicBEEF(b));throw new Error("Public reveal failed: failed to create action!")}async resolveByIdentityKey(d){const{certificates:y}=await this.wallet.discoverByIdentityKey(d,this.originator);return y.map(p=>_b.parseIdentity(p))}async resolveByAttributes(d){const{certificates:y}=await this.wallet.discoverByAttributes(d,this.originator);return y.map(p=>_b.parseIdentity(p))}static parseIdentity(d){const{type:y,decryptedFields:p,certifierInfo:g}=d;let b,w,v,_,S;switch(y){case i.KNOWN_IDENTITY_TYPES.xCert:b=p.userName,w=p.profilePhoto,v=`X account certified by ${g.name}`,_=g.iconUrl,S="https://socialcert.net";break;case i.KNOWN_IDENTITY_TYPES.discordCert:b=p.userName,w=p.profilePhoto,v=`Discord account certified by ${g.name}`,_=g.iconUrl,S="https://socialcert.net";break;case i.KNOWN_IDENTITY_TYPES.emailCert:b=p.email,w="XUTZxep7BBghAJbSBwTjNfmcsDdRFs5EaGEgkESGSgjJVYgMEizu",v=`Email certified by ${g.name}`,_=g.iconUrl,S="https://socialcert.net";break;case i.KNOWN_IDENTITY_TYPES.phoneCert:b=p.phoneNumber,w="XUTLxtX3ELNUwRhLwL7kWNGbdnFM8WG2eSLv84J7654oH8HaJWrU",v=`Phone certified by ${g.name}`,_=g.iconUrl,S="https://socialcert.net";break;case i.KNOWN_IDENTITY_TYPES.identiCert:b=`${p.firstName} ${p.lastName}`,w=p.profilePhoto,v=`Government ID certified by ${g.name}`,_=g.iconUrl,S="https://identicert.me";break;case i.KNOWN_IDENTITY_TYPES.registrant:b=p.name,w=p.icon,v=`Entity certified by ${g.name}`,_=g.iconUrl,S="https://projectbabbage.com/docs/registrant";break;case i.KNOWN_IDENTITY_TYPES.coolCert:b=p.cool==="true"?"Cool Person!":"Not cool!";break;case i.KNOWN_IDENTITY_TYPES.anyone:b="Anyone",w="XUT4bpQ6cpBaXi1oMzZsXfpkWGbtp2JTUYAoN7PzhStFJ6wLfoeR",v="Represents the ability for anyone to access this information.",_="XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",S="https://projectbabbage.com/docs/anyone-identity";break;case i.KNOWN_IDENTITY_TYPES.self:b="You",w="XUT9jHGk2qace148jeCX5rDsMftkSGYKmigLwU2PLLBc7Hm63VYR",v="Represents your ability to access this information.",_="XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",S="https://projectbabbage.com/docs/self-identity";break;default:b=i.defaultIdentity.name,w=p.profilePhoto,v=i.defaultIdentity.badgeLabel,_=i.defaultIdentity.badgeIconURL,S=i.defaultIdentity.badgeClickURL;break}return{name:b,avatarURL:w,abbreviatedKey:d.subject.length>0?`${d.subject.substring(0,10)}...`:"",identityKey:d.subject,badgeIconURL:_,badgeLabel:v,badgeClickURL:S}}};return Gs.IdentityClient=n,Gs}var W3;function yD(){return W3||(W3=1,function(s){var t=Xs&&Xs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Xs&&Xs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(pD(),s),i(BI(),s)}(Xs)),Xs}var Ys={},Qs={},$3;function gD(){if($3)return Qs;$3=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.deserializeWalletProtocol=Qs.RegistryClient=void 0;const s=R0(),t=Cr(),i=xf(),r=M0(),e=O0(),o=1;let a=class{constructor(n=new s.WalletClient){this.wallet=n}async registerDefinition(n){var c;const d=(await this.wallet.getPublicKey({identityKey:!0})).publicKey,y=new e.PushDrop(this.wallet),p=this.buildPushDropFields(n,d),g=this.mapDefinitionTypeToWalletProtocol(n.definitionType),b=await y.lock(p,g,"1","anyone",!0),{tx:w}=await this.wallet.createAction({description:`Register a new ${n.definitionType} item`,outputs:[{satoshis:o,lockingScript:b.toHex(),outputDescription:`New ${n.definitionType} registration token`,basket:this.mapDefinitionTypeToBasketName(n.definitionType)}],options:{randomizeOutputs:!1}});if(w===void 0)throw new Error(`Failed to create ${n.definitionType} registration transaction!`);return await new r.TopicBroadcaster([this.mapDefinitionTypeToTopic(n.definitionType)],{networkPreset:(c=this.network)!==null&&c!==void 0?c:this.network=(await this.wallet.getNetwork({})).network}).broadcast(i.Transaction.fromAtomicBEEF(w))}async resolve(n,c){const d=new r.LookupResolver,y=this.mapDefinitionTypeToServiceName(n),p=await d.query({service:y,query:c});if(p.type!=="output-list")return[];const g=[];for(const b of p.outputs)try{const v=i.Transaction.fromBEEF(b.beef).outputs[b.outputIndex].lockingScript,_=await this.parseLockingScript(n,v);g.push(_)}catch{}return g}async listOwnRegistryEntries(n){const c=this.mapDefinitionTypeToBasketName(n),{outputs:d,BEEF:y}=await this.wallet.listOutputs({basket:c,include:"entire transactions"}),p=[];for(const g of d)if(g.spendable)try{const[b,w]=g.outpoint.split("."),_=i.Transaction.fromBEEF(y).outputs[w].lockingScript,S=await this.parseLockingScript(n,_);p.push({...S,txid:b,outputIndex:Number(w),satoshis:g.satoshis,lockingScript:_.toHex(),beef:y})}catch{}return p}async revokeOwnRegistryEntry(n){var c;if(n.txid===void 0||typeof n.outputIndex>"u"||n.lockingScript===void 0)throw new Error("Invalid registry record. Missing txid, outputIndex, or lockingScript.");const d=(await this.wallet.getPublicKey({identityKey:!0})).publicKey;if(n.registryOperator!==d)throw new Error("This registry token does not belong to the current wallet.");const y=n.definitionType==="basket"?n.basketID:n.definitionType==="protocol"?n.name:n.definitionType==="certificate"?n.name!==void 0?n.name:n.type:"unknown",p=`${n.txid}.${n.outputIndex}`,{signableTransaction:g}=await this.wallet.createAction({description:`Revoke ${n.definitionType} item: ${y}`,inputBEEF:n.beef,inputs:[{outpoint:p,unlockingScriptLength:73,inputDescription:`Revoking ${n.definitionType} token`}]});if(g===void 0)throw new Error("Failed to create signable transaction.");const b=i.Transaction.fromBEEF(g.tx),_=await(await new e.PushDrop(this.wallet).unlock(this.mapDefinitionTypeToWalletProtocol(n.definitionType),"1","anyone","all",!1,n.satoshis,e.LockingScript.fromHex(n.lockingScript))).sign(b,n.outputIndex),{tx:S}=await this.wallet.signAction({reference:g.reference,spends:{[n.outputIndex]:{unlockingScript:_.toHex()}},options:{acceptDelayedBroadcast:!1}});if(S===void 0)throw new Error("Failed to finalize the transaction signature.");return await new r.TopicBroadcaster([this.mapDefinitionTypeToTopic(n.definitionType)],{networkPreset:(c=this.network)!==null&&c!==void 0?c:this.network=(await this.wallet.getNetwork({})).network}).broadcast(i.Transaction.fromAtomicBEEF(S))}buildPushDropFields(n,c){let d;switch(n.definitionType){case"basket":d=[n.basketID,n.name,n.iconURL,n.description,n.documentationURL];break;case"protocol":d=[JSON.stringify(n.protocolID),n.name,n.iconURL,n.description,n.documentationURL];break;case"certificate":d=[n.type,n.name,n.iconURL,n.description,n.documentationURL,JSON.stringify(n.fields)];break;default:throw new Error("Unsupported definition type")}return d.push(c),d.map(y=>t.Utils.toArray(y))}async parseLockingScript(n,c){const d=e.PushDrop.decode(c);if(d.fields.length===0)throw new Error("Not a valid registry pushdrop script.");let y,p;switch(n){case"basket":{if(d.fields.length!==7)throw new Error("Unexpected field count for basket type.");const[g,b,w,v,_,S]=d.fields;y=t.Utils.toUTF8(S),p={definitionType:"basket",basketID:t.Utils.toUTF8(g),name:t.Utils.toUTF8(b),iconURL:t.Utils.toUTF8(w),description:t.Utils.toUTF8(v),documentationURL:t.Utils.toUTF8(_)};break}case"protocol":{if(d.fields.length!==7)throw new Error("Unexpected field count for protocol type.");const[g,b,w,v,_,S]=d.fields;y=t.Utils.toUTF8(S),p={definitionType:"protocol",protocolID:l(t.Utils.toUTF8(g)),name:t.Utils.toUTF8(b),iconURL:t.Utils.toUTF8(w),description:t.Utils.toUTF8(v),documentationURL:t.Utils.toUTF8(_)};break}case"certificate":{if(d.fields.length!==8)throw new Error("Unexpected field count for certificate type.");const[g,b,w,v,_,S,T]=d.fields;y=t.Utils.toUTF8(T);let I={};try{I=JSON.parse(t.Utils.toUTF8(S))}catch{}p={definitionType:"certificate",type:t.Utils.toUTF8(g),name:t.Utils.toUTF8(b),iconURL:t.Utils.toUTF8(w),description:t.Utils.toUTF8(v),documentationURL:t.Utils.toUTF8(_),fields:I};break}default:throw new Error(`Unsupported definition type: ${n}`)}return{...p,registryOperator:y}}mapDefinitionTypeToWalletProtocol(n){switch(n){case"basket":return[1,"basketmap"];case"protocol":return[1,"protomap"];case"certificate":return[1,"certmap"];default:throw new Error(`Unknown definition type: ${n}`)}}mapDefinitionTypeToBasketName(n){switch(n){case"basket":return"basketmap";case"protocol":return"protomap";case"certificate":return"certmap";default:throw new Error(`Unknown definition type: ${n}`)}}mapDefinitionTypeToTopic(n){switch(n){case"basket":return"tm_basketmap";case"protocol":return"tm_protomap";case"certificate":return"tm_certmap";default:throw new Error(`Unknown definition type: ${n}`)}}mapDefinitionTypeToServiceName(n){switch(n){case"basket":return"ls_basketmap";case"protocol":return"ls_protomap";case"certificate":return"ls_certmap";default:throw new Error(`Unknown definition type: ${n}`)}}};Qs.RegistryClient=a;function l(f){const n=JSON.parse(f);if(!Array.isArray(n)||n.length!==2)throw new Error("Invalid wallet protocol format.");const[c,d]=n;if(![0,1,2].includes(c))throw new Error("Invalid security level.");if(typeof d!="string")throw new Error("Invalid protocolID");return[c,d]}return Qs.deserializeWalletProtocol=l,Qs}var bm={},z3;function mD(){return z3||(z3=1,Object.defineProperty(bm,"__esModule",{value:!0})),bm}var X3;function bD(){return X3||(X3=1,function(s){var t=Ys&&Ys.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Ys&&Ys.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(gD(),s),i(mD(),s)}(Ys)),Ys}var Ll={},Bn={},G3;function wD(){if(G3)return Bn;G3=1;var s=Bn&&Bn.__createBinding||(Object.create?function(c,d,y,p){p===void 0&&(p=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(c,p,g)}:function(c,d,y,p){p===void 0&&(p=y),c[p]=d[y]}),t=Bn&&Bn.__setModuleDefault||(Object.create?function(c,d){Object.defineProperty(c,"default",{enumerable:!0,value:d})}:function(c,d){c.default=d}),i=Bn&&Bn.__importStar||function(c){if(c&&c.__esModule)return c;var d={};if(c!=null)for(var y in c)y!=="default"&&Object.prototype.hasOwnProperty.call(c,y)&&s(d,c,y);return t(d,c),d},r=Bn&&Bn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Bn,"__esModule",{value:!0});const e=r(E0()),o=i(me()),a=r(II()),l=r(vf()),f=wf();let n=class{constructor(d=new a.default,y="kvstore default",p=!0,g){if(typeof y!="string"||y.length<1)throw new Error("A context in which to operate is required.");this.wallet=d,this.context=y,this.encrypt=p,this.originator=g}getProtocol(d){return{protocolID:[2,this.context],keyID:d}}async getOutputs(d,y){return await this.wallet.listOutputs({basket:this.context,tags:[d],tagQueryMode:"all",include:"entire transactions",limit:y})}async get(d,y=void 0){return(await this.lookupValue(d,y,5)).value}getLockingScript(d,y){var p;const[g,b]=d.outpoint.split("."),w=(p=y.findTxid(g))===null||p===void 0?void 0:p.tx;if(w==null)throw new Error(`beef must contain txid ${g}`);return w.outputs[Number(b)].lockingScript}async lookupValue(d,y,p){const g=await this.getOutputs(d,p),b={value:y,outpoint:void 0,lor:g},{outputs:w}=g;if(w.length===0)return b;const v=w.slice(-1)[0];b.outpoint=v.outpoint;let _;try{if(g.BEEF===void 0)throw new Error("entire transactions listOutputs option must return valid BEEF");const S=this.getLockingScript(v,f.Beef.fromBinary(g.BEEF)),T=e.default.decode(S);if(T.fields.length<1||T.fields.length>2)throw new Error("Invalid token.");_=T.fields[0]}catch{throw new Error(`Invalid value found. You need to call set to collapse the corrupted state (or relinquish the corrupted ${w[0].outpoint} output from the ${this.context} basket) before you can get this value again.`)}if(!this.encrypt)b.value=o.toUTF8(_);else{const{plaintext:S}=await this.wallet.decrypt({...this.getProtocol(d),ciphertext:_});b.value=o.toUTF8(S)}return b}getInputs(d){const y=[];for(let p=0;p<d.length;p++)y.push({outpoint:d[p].outpoint,unlockingScriptLength:74,inputDescription:"Previous key-value token"});return y}async getSpends(d,y,p,g){const b=this.getProtocol(d),w=l.default.fromAtomicBEEF(g),v={};for(let _=0;_<y.length;_++){const T=await p.unlock(b.protocolID,b.keyID,"self").sign(w,_);v[_]={unlockingScript:T.toHex()}}return v}async set(d,y){const p=await this.lookupValue(d,void 0,10);if(p.value===y){if(p.outpoint===void 0)throw new Error("outpoint must be valid when value is valid and unchanged");return p.outpoint}const g=this.getProtocol(d);let b=o.toArray(y,"utf8");if(this.encrypt){const{ciphertext:I}=await this.wallet.encrypt({...g,plaintext:b});b=I}const w=new e.default(this.wallet,this.originator),v=await w.lock([b],g.protocolID,g.keyID,"self"),{outputs:_,BEEF:S}=p.lor;let T;try{const I=this.getInputs(_),{txid:k,signableTransaction:O}=await this.wallet.createAction({description:`Update ${d} in ${this.context}`,inputBEEF:S,inputs:I,outputs:[{basket:this.context,tags:[d],lockingScript:v.toHex(),satoshis:1,outputDescription:"Key-value token"}],options:{acceptDelayedBroadcast:!1,randomizeOutputs:!1}});if(_.length>0&&typeof O!="object")throw new Error("Wallet did not return a signable transaction when expected.");if(O==null)T=`${k}.0`;else{const A=await this.getSpends(d,_,w,O.tx),{txid:R}=await this.wallet.signAction({reference:O.reference,spends:A});T=`${R}.0`}}catch{throw new Error(`There are ${_.length} outputs with tag ${d} that cannot be unlocked.`)}return T}async remove(d){const y=[];for(;;){const{outputs:p,BEEF:g,totalOutputs:b}=await this.getOutputs(d);if(p.length>0){const w=new e.default(this.wallet,this.originator);try{const v=this.getInputs(p),{signableTransaction:_}=await this.wallet.createAction({description:`Remove ${d} in ${this.context}`,inputBEEF:g,inputs:v,options:{acceptDelayedBroadcast:!1}});if(typeof _!="object")throw new Error("Wallet did not return a signable transaction when expected.");const S=await this.getSpends(d,p,w,_.tx),{txid:T}=await this.wallet.signAction({reference:_.reference,spends:S});if(T===void 0)throw new Error("signAction must return a valid txid");y.push(T)}catch{throw new Error(`There are ${b} outputs with tag ${d} that cannot be unlocked.`)}}if(p.length===b)break}return y}};return Bn.default=n,Bn}var Y3;function vD(){return Y3||(Y3=1,function(s){var t=Ll&&Ll.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0}),s.LocalKVStore=void 0;var i=wD();Object.defineProperty(s,"LocalKVStore",{enumerable:!0,get:function(){return t(i).default}})}(Ll)),Ll}var Q3;function ge(){return Q3||(Q3=1,function(s){var t=Bs&&Bs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Bs&&Bs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(Cr(),s),i(O0(),s),i(nI(),s),i(xf(),s),i(BC(),s),i(qC(),s),i(jC(),s),i(pI(),s),i(VC(),s),i(QC(),s),i(JC(),s),i(R0(),s),i(kI(),s),i(dD(),s),i(M0(),s),i(DI(),s),i(yD(),s),i(bD(),s),i(vD(),s)}(Bs)),Bs}var Z3;function xD(){if(Z3)return xe;Z3=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.parseWalletOutpoint=i,xe.validateSatoshis=c,xe.validateOptionalInteger=d,xe.validateInteger=y,xe.validatePositiveIntegerOrZero=p,xe.validateStringLength=g,xe.isHexString=A,xe.validateCreateActionInput=R,xe.validateCreateActionOutput=P,xe.validateCreateActionOptions=C,xe.validateCreateActionArgs=N,xe.validateSignActionOptions=D,xe.validateSignActionArgs=U,xe.validateAbortActionArgs=F,xe.validateWalletPayment=L,xe.validateBasketInsertion=j,xe.validateInternalizeOutput=V,xe.validateOriginator=W,xe.validateInternalizeActionArgs=q,xe.validateOptionalOutpointString=$,xe.validateOutpointString=Y,xe.validateRelinquishOutputArgs=Q,xe.validateRelinquishCertificateArgs=J,xe.validateListCertificatesArgs=vt,xe.validateAcquireCertificateArgs=xt,xe.validateAcquireIssuanceCertificateArgs=It,xe.validateAcquireDirectCertificateArgs=Nt,xe.validateProveCertificateArgs=Lt,xe.validateDiscoverByIdentityKeyArgs=ne,xe.validateDiscoverByAttributesArgs=Vt,xe.validateListOutputsArgs=Jt,xe.validateListActionsArgs=Ct;const s=ge(),t=se();function i(K){const[ut,st]=K.split(".");return{txid:ut,vout:Number(st)}}function r(K){return K??!0}function e(K){return K??!1}function o(K){return K??0}function a(K){return K??4294967295}function l(K){return K??1}function f(K){return K??[]}function n(K,ut,st,Mt){if(K!==void 0)return g(K,ut,st,Mt)}function c(K,ut,st){if(K===void 0||!Number.isInteger(K)||K<0||K>21e14)throw new t.sdk.WERR_INVALID_PARAMETER(ut,"a valid number of satoshis");if(st!==void 0&&K<st)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`at least ${st} satoshis.`);return K}function d(K,ut,st,Mt){if(K!==void 0)return y(K,ut,void 0,st,Mt)}function y(K,ut,st,Mt,Ht){if(K===void 0){if(st!==void 0)return st;throw new t.sdk.WERR_INVALID_PARAMETER(ut,"a valid integer")}if(!Number.isInteger(K))throw new t.sdk.WERR_INVALID_PARAMETER(ut,"an integer");if(K=Number(K),Mt!==void 0&&K<Mt)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`at least ${Mt} length.`);if(Ht!==void 0&&K>Ht)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`no more than ${Ht} length.`);return K}function p(K,ut){return y(K,ut,0,0)}function g(K,ut,st,Mt){const Ht=s.Utils.toArray(K,"utf8").length;if(st!==void 0&&Ht<st)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`at least ${st} length.`);if(Mt!==void 0&&Ht>Mt)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`no more than ${Mt} length.`);return K}function b(K){if(K!==void 0)return w(K)}function w(K){return S(K,"basket",1,300)}function v(K){return S(K,"label",1,300)}function _(K){return S(K,"tag",1,300)}function S(K,ut,st,Mt){K=K.trim().toLowerCase();const Ht=s.Utils.toArray(K,"utf8").length;if(Ht<st)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`at least ${st} length.`);if(Ht>Mt)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`no more than ${Mt} length.`);return K}function T(K,ut,st,Mt){if(K!==void 0)return I(K,ut)}function I(K,ut,st,Mt){K=K.trim();const Ht=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,Kt=/=+$/.exec(K),Xt=Kt?Kt[0].length:0;if(Xt>2||K.length%4!==0&&Xt!==0||!Ht.test(K))throw new t.sdk.WERR_INVALID_PARAMETER(ut,"balid base64 string");return s.Utils.toArray(K,"base64").length,K}function k(K,ut,st,Mt){if(K!==void 0)return O(K,ut,st,Mt)}function O(K,ut,st,Mt){if(K=K.trim().toLowerCase(),K.length%2===1)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`even length, not ${K.length}.`);if(!/^[0-9A-Fa-f]+$/.test(K))throw new t.sdk.WERR_INVALID_PARAMETER(ut,"hexadecimal string.");if(st!==void 0&&K.length<st)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`at least ${st} length.`);if(Mt!==void 0&&K.length>Mt)throw new t.sdk.WERR_INVALID_PARAMETER(ut,`no more than ${Mt} length.`);return K}function A(K){return K=K.trim(),!(K.length%2===1||!/^[0-9A-Fa-f]+$/.test(K))}function R(K){var ut;if(K.unlockingScript===void 0&&K.unlockingScriptLength===void 0)throw new t.sdk.WERR_INVALID_PARAMETER("unlockingScript, unlockingScriptLength","at least one valid value.");const st=k(K.unlockingScript,"unlockingScript"),Mt=(ut=K.unlockingScriptLength)!==null&&ut!==void 0?ut:st.length/2;if(st&&Mt!==st.length/2)throw new t.sdk.WERR_INVALID_PARAMETER("unlockingScriptLength","length unlockingScript if both valid.");return{outpoint:i(K.outpoint),inputDescription:g(K.inputDescription,"inputDescription",5,2e3),unlockingScript:st,unlockingScriptLength:Mt,sequenceNumber:a(K.sequenceNumber)}}function P(K){return{lockingScript:O(K.lockingScript,"lockingScript"),satoshis:c(K.satoshis,"satoshis"),outputDescription:g(K.outputDescription,"outputDescription",5,2e3),basket:b(K.basket),customInstructions:K.customInstructions,tags:f(K.tags).map(st=>_(st))}}function C(K){const ut=K||{};return{signAndProcess:r(ut.signAndProcess),acceptDelayedBroadcast:r(ut.acceptDelayedBroadcast),knownTxids:f(ut.knownTxids),returnTXIDOnly:e(ut.returnTXIDOnly),noSend:e(ut.noSend),noSendChange:f(ut.noSendChange).map(Mt=>i(Mt)),sendWith:f(ut.sendWith),randomizeOutputs:r(ut.randomizeOutputs)}}function N(K){var ut;const st={description:g(K.description,"description",5,2e3),inputBEEF:K.inputBEEF,inputs:f(K.inputs).map(Mt=>R(Mt)),outputs:f(K.outputs).map(Mt=>P(Mt)),lockTime:o(K.lockTime),version:l(K.version),labels:f((ut=K.labels)===null||ut===void 0?void 0:ut.map(Mt=>v(Mt))),options:C(K.options),isSendWith:!1,isDelayed:!1,isNoSend:!1,isNewTx:!1,isRemixChange:!1,isSignAction:!1,randomVals:void 0,includeAllSourceTransactions:!1};return st.isSendWith=st.options.sendWith.length>0,st.isRemixChange=!st.isSendWith&&st.inputs.length===0&&st.outputs.length===0,st.isNewTx=st.isRemixChange||st.inputs.length>0||st.outputs.length>0,st.isSignAction=st.isNewTx&&(st.options.signAndProcess===!1||st.inputs.some(Mt=>Mt.unlockingScript===void 0)),st.isDelayed=st.options.acceptDelayedBroadcast,st.isNoSend=st.options.noSend,st}function D(K){const ut=K||{};return{acceptDelayedBroadcast:r(ut.acceptDelayedBroadcast),returnTXIDOnly:e(ut.returnTXIDOnly),noSend:e(ut.noSend),sendWith:f(ut.sendWith)}}function U(K){const ut={spends:K.spends,reference:K.reference,options:D(K.options),isSendWith:!1,isDelayed:!1,isNoSend:!1,isNewTx:!0,isRemixChange:!1};return ut.isSendWith=ut.options.sendWith.length>0,ut.isDelayed=ut.options.acceptDelayedBroadcast,ut.isNoSend=ut.options.noSend,ut}function F(K){return{reference:I(K.reference,"reference")}}function L(K){return K===void 0?void 0:{derivationPrefix:I(K.derivationPrefix,"derivationPrefix"),derivationSuffix:I(K.derivationSuffix,"derivationSuffix"),senderIdentityKey:O(K.senderIdentityKey,"senderIdentityKey")}}function j(K){return K===void 0?void 0:{basket:w(K.basket),customInstructions:n(K.customInstructions,"customInstructions",0,1e3),tags:f(K.tags).map(st=>_(st))}}function V(K){if(K.protocol!=="basket insertion"&&K.protocol!=="wallet payment")throw new t.sdk.WERR_INVALID_PARAMETER("protocol","'basket insertion' or 'wallet payment'");return{outputIndex:p(K.outputIndex,"outputIndex"),protocol:K.protocol,paymentRemittance:L(K.paymentRemittance),insertionRemittance:j(K.insertionRemittance)}}function W(K){if(K===void 0)return;K=K.trim().toLowerCase(),g(K,"originator",1,250);const ut=K.split(".");for(const st of ut)g(st,"originator part",1,63)}function q(K){const ut={tx:K.tx,outputs:K.outputs.map(st=>V(st)),description:g(K.description,"description",5,2e3),labels:(K.labels||[]).map(st=>v(st)),seekPermission:r(K.seekPermission)};try{if(s.Beef.fromBinary(ut.tx).txs.length<1)throw new t.sdk.WERR_INVALID_PARAMETER("tx","at least one transaction to internalize an output from")}catch{throw new t.sdk.WERR_INVALID_PARAMETER("tx","valid with at least one transaction to internalize an output from")}if(ut.outputs.length<1)throw new t.sdk.WERR_INVALID_PARAMETER("outputs","at least one output to internalize from the transaction");return ut}function $(K,ut){if(K!==void 0)return Y(K,ut)}function Y(K,ut){const st=K.split(".");if(st.length!==2||!Number.isInteger(Number(st[1])))throw new t.sdk.WERR_INVALID_PARAMETER(ut,"txid as hex string and numeric output index joined with '.'");const Mt=O(st[0],`${ut} txid`,void 0,64),Ht=p(Number(st[1]),`${ut} vout`);return`${Mt}.${Ht}`}function Q(K){return{basket:w(K.basket),output:Y(K.output,"output")}}function J(K){return{type:I(K.type,"type"),serialNumber:I(K.serialNumber,"serialNumber"),certifier:O(K.certifier,"certifier")}}function vt(K){return{certifiers:f(K.certifiers.map(st=>O(st.trim(),"certifiers"))),types:f(K.types.map(st=>I(st.trim(),"types"))),limit:y(K.limit,"limit",10,1,1e4),offset:p(o(K.offset),"offset"),privileged:e(K.privileged),privilegedReason:n(K.privilegedReason,"privilegedReason",5,50),partial:void 0}}function wt(K){for(const ut of Object.keys(K))g(ut,"field name",1,50);return K}function dt(K,ut){return K==="certifier"?K:O(K,ut)}function yt(K,ut){if(K!==void 0)return dt(K,ut)}function _t(K,ut){for(const st of Object.keys(K))g(st,`${ut} field name`,1,50),I(K[st],`${ut} field value`);return K}function tt(K,ut){if(K!==void 0)return _t(K,ut)}async function xt(K){const ut={acquisitionProtocol:K.acquisitionProtocol,type:I(K.type,"type"),serialNumber:T(K.serialNumber,"serialNumber"),certifier:O(K.certifier,"certifier"),revocationOutpoint:$(K.revocationOutpoint,"revocationOutpoint"),fields:wt(K.fields),signature:k(K.signature,"signature"),certifierUrl:K.certifierUrl,keyringRevealer:yt(K.keyringRevealer,"keyringRevealer"),keyringForSubject:tt(K.keyringForSubject,"keyringForSubject"),privileged:e(K.privileged),privilegedReason:n(K.privilegedReason,"privilegedReason",5,50)};if(ut.privileged&&!ut.privilegedReason)throw new t.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");if(ut.acquisitionProtocol==="direct"){if(!ut.serialNumber)throw new t.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(!ut.signature)throw new t.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(!ut.revocationOutpoint)throw new t.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"')}return ut}function It(K){if(K.acquisitionProtocol!=="issuance")throw new t.sdk.WERR_INTERNAL("Only acquire certificate via issuance requests allowed here.");if(K.serialNumber)throw new t.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(K.signature)throw new t.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(K.revocationOutpoint)throw new t.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"');if(K.keyringRevealer)throw new t.sdk.WERR_INVALID_PARAMETER("keyringRevealer",'valid when acquisitionProtocol is "direct"');if(K.keyringForSubject)throw new t.sdk.WERR_INVALID_PARAMETER("keyringForSubject",'valid when acquisitionProtocol is "direct"');if(!K.certifierUrl)throw new t.sdk.WERR_INVALID_PARAMETER("certifierUrl",'valid when acquisitionProtocol is "issuance"');if(K.privileged&&!K.privilegedReason)throw new t.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:I(K.type,"type"),certifier:O(K.certifier,"certifier"),certifierUrl:K.certifierUrl,fields:wt(K.fields),privileged:e(K.privileged),privilegedReason:n(K.privilegedReason,"privilegedReason",5,50),subject:""}}function Nt(K){if(K.acquisitionProtocol!=="direct")throw new t.sdk.WERR_INTERNAL("Only acquire direct certificate requests allowed here.");if(!K.serialNumber)throw new t.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(!K.signature)throw new t.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(!K.revocationOutpoint)throw new t.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"');if(!K.keyringRevealer)throw new t.sdk.WERR_INVALID_PARAMETER("keyringRevealer",'valid when acquisitionProtocol is "direct"');if(!K.keyringForSubject)throw new t.sdk.WERR_INVALID_PARAMETER("keyringForSubject",'valid when acquisitionProtocol is "direct"');if(K.privileged&&!K.privilegedReason)throw new t.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:I(K.type,"type"),serialNumber:I(K.serialNumber,"serialNumber"),certifier:O(K.certifier,"certifier"),revocationOutpoint:Y(K.revocationOutpoint,"revocationOutpoint"),fields:wt(K.fields),signature:O(K.signature,"signature"),keyringRevealer:dt(K.keyringRevealer,"keyringRevealer"),keyringForSubject:_t(K.keyringForSubject,"keyringForSubject"),privileged:e(K.privileged),privilegedReason:n(K.privilegedReason,"privilegedReason",5,50),subject:""}}function Lt(K){if(K.privileged&&!K.privilegedReason)throw new t.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:T(K.certificate.type,"certificate.type"),serialNumber:T(K.certificate.serialNumber,"certificate.serialNumber"),certifier:k(K.certificate.certifier,"certificate.certifier"),subject:k(K.certificate.subject,"certificate.subject"),revocationOutpoint:$(K.certificate.revocationOutpoint,"certificate.revocationOutpoint"),signature:k(K.certificate.signature,"certificate.signature"),fieldsToReveal:f(K.fieldsToReveal).map(st=>g(st,`fieldsToReveal ${st}`,1,50)),verifier:O(K.verifier,"verifier"),privileged:e(K.privileged),privilegedReason:n(K.privilegedReason,"privilegedReason",5,50)}}function ne(K){return{identityKey:O(K.identityKey,"identityKey",66,66),limit:y(K.limit,"limit",10,1,1e4),offset:p(o(K.offset),"offset"),seekPermission:e(K.seekPermission)}}function Ut(K){for(const ut of Object.keys(K))g(ut,`field name ${ut}`,1,50);return K}function Vt(K){return{attributes:Ut(K.attributes),limit:y(K.limit,"limit",10,1,1e4),offset:p(o(K.offset),"offset"),seekPermission:e(K.seekPermission)}}function Jt(K){let ut;if(K.tagQueryMode===void 0||K.tagQueryMode==="any")ut="any";else if(K.tagQueryMode==="all")ut="all";else throw new t.sdk.WERR_INVALID_PARAMETER("tagQueryMode","undefined, 'any', or 'all'");return{basket:g(K.basket,"basket",1,300),tags:(K.tags||[]).map(Mt=>g(Mt,"tag",1,300)),tagQueryMode:ut,includeLockingScripts:K.include==="locking scripts",includeTransactions:K.include==="entire transactions",includeCustomInstructions:e(K.includeCustomInstructions),includeTags:e(K.includeTags),includeLabels:e(K.includeLabels),limit:y(K.limit,"limit",10,1,1e4),offset:y(K.offset,"offset",0,0),seekPermission:r(K.seekPermission),knownTxids:[]}}function Ct(K){let ut;if(K.labelQueryMode===void 0||K.labelQueryMode==="any")ut="any";else if(K.labelQueryMode==="all")ut="all";else throw new t.sdk.WERR_INVALID_PARAMETER("labelQueryMode","undefined, 'any', or 'all'");return{labels:(K.labels||[]).map(Mt=>v(Mt)),labelQueryMode:ut,includeLabels:e(K.includeLabels),includeInputs:e(K.includeInputs),includeInputSourceLockingScripts:e(K.includeInputSourceLockingScripts),includeInputUnlockingScripts:e(K.includeInputUnlockingScripts),includeOutputs:e(K.includeOutputs),includeOutputLockingScripts:e(K.includeOutputLockingScripts),limit:y(K.limit,"limit",10,1,1e4),offset:y(K.offset,"offset",0,0),seekPermission:r(K.seekPermission)}}return xe}var wm={},J3;function _D(){return J3||(J3=1,Object.defineProperty(wm,"__esModule",{value:!0})),wm}var vm={},t4;function SD(){return t4||(t4=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.specOpThrowReviewActions=s.specOpFailedActions=s.specOpNoSendActions=s.specOpSetWalletChangeParams=s.specOpInvalidChange=s.specOpWalletBalance=s.ProvenTxReqNonTerminalStatus=s.ProvenTxReqTerminalStatus=void 0,s.isListOutputsSpecOp=t,s.isListActionsSpecOp=i,s.isCreateActionSpecOp=r,s.ProvenTxReqTerminalStatus=["completed","invalid","doubleSpend"],s.ProvenTxReqNonTerminalStatus=["sending","unsent","nosend","unknown","nonfinal","unprocessed","unmined","callback","unconfirmed"],s.specOpWalletBalance="893b7646de0e1c9f741bd6e9169b76a8847ae34adef7bef1e6a285371206d2e8",s.specOpInvalidChange="5a76fd430a311f8bc0553859061710a4475c19fed46e2ff95969aa918e612e57",s.specOpSetWalletChangeParams="a4979d28ced8581e9c1c92f1001cc7cb3aabf8ea32e10888ad898f0a509a3929";function t(e){return[s.specOpWalletBalance,s.specOpInvalidChange,s.specOpSetWalletChangeParams].indexOf(e)>=0}s.specOpNoSendActions="ac6b20a3bb320adafecd637b25c84b792ad828d3aa510d05dc841481f664277d",s.specOpFailedActions="97d4eb1e49215e3374cc2c1939a7c43a55e95c7427bf2d45ed63e3b4e0c88153";function i(e){return[s.specOpNoSendActions,s.specOpFailedActions].indexOf(e)>=0}s.specOpThrowReviewActions="a496e747fc3ad5fabdd4ae8f91184e71f87539bd3d962aa2548942faaaf0047a";function r(e){return[s.specOpThrowReviewActions].indexOf(e)>=0}}(vm)),vm}var xm={},e4;function TD(){return e4||(e4=1,Object.defineProperty(xm,"__esModule",{value:!0})),xm}var Ul={},i4;function w1(){if(i4)return Ul;i4=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.PrivilegedKeyManager=void 0;const s=ge();let t=class{constructor(r,e=12e4){this.chunkPropNames=[],this.chunkPadPropNames=[],this.decoyPropNamesDestroy=[],this.decoyPropNamesRemain=[],this.CHUNK_COUNT=4,this.keyGetter=r,this.retentionPeriod=e;for(let o=0;o<2;o++){const a=this.generateRandomPropName();this[a]=Uint8Array.from((0,s.Random)(16)),this.decoyPropNamesRemain.push(a)}}destroyKey(){try{for(const r of this.chunkPropNames){const e=this[r];e&&e.fill(0),delete this[r]}for(const r of this.chunkPadPropNames){const e=this[r];e&&e.fill(0),delete this[r]}for(const r of this.decoyPropNamesDestroy){const e=this[r];e&&e.fill(0),delete this[r]}this.chunkPropNames=[],this.chunkPadPropNames=[],this.decoyPropNamesDestroy=[]}catch{}finally{this.destroyTimer&&(clearTimeout(this.destroyTimer),this.destroyTimer=void 0)}}scheduleKeyDestruction(){this.destroyTimer&&clearTimeout(this.destroyTimer),this.destroyTimer=setTimeout(()=>{this.destroyKey()},this.retentionPeriod)}xorBytes(r,e){const o=new Uint8Array(r.length);for(let a=0;a<r.length;a++)o[a]=r[a]^e[a];return o}splitKeyIntoChunks(r){const e=Math.floor(r.length/this.CHUNK_COUNT),o=[];let a=0;for(let l=0;l<this.CHUNK_COUNT;l++){const f=l===this.CHUNK_COUNT-1?r.length-a:e;o.push(r.slice(a,a+f)),a+=f}return o}reassembleKeyFromChunks(){try{const r=[];for(let l=0;l<this.chunkPropNames.length;l++){const f=this[this.chunkPropNames[l]],n=this[this.chunkPadPropNames[l]];if(!f||!n||f.length!==n.length)return null;const c=this.xorBytes(f,n);r.push(c)}const e=r.reduce((l,f)=>l+f.length,0);if(e!==32)return null;const o=new Uint8Array(e);let a=0;for(const l of r)o.set(l,a),a+=l.length,l.fill(0);return o}catch{return null}}generateRandomPropName(){return`_${s.Utils.toHex((0,s.Random)(4))}_${Math.floor(Math.random()*1e6)}`}get32ByteRepresentation(r){const e=r.toArray();if(e.length>32)throw new Error("PrivilegedKeyManager: Expected a 32-byte key, but got more.");const o=new Uint8Array(32);return o.set(e,32-e.length),o}async getPrivilegedKey(r){if(this.chunkPropNames.length>0&&this.chunkPadPropNames.length>0){const l=this.reassembleKeyFromChunks();if(l&&l.length===32){const f=s.Utils.toHex([...l]);return l.fill(0),this.scheduleKeyDestruction(),new s.PrivateKey(f,"hex")}}const e=await this.keyGetter(r),o=this.get32ByteRepresentation(e);this.destroyKey();const a=this.splitKeyIntoChunks(o);for(let l=0;l<a.length;l++){const f=this.generateRandomPropName(),n=this.generateRandomPropName();this.chunkPropNames.push(f),this.chunkPadPropNames.push(n);const c=Uint8Array.from((0,s.Random)(a[l].length)),d=this.xorBytes(a[l],c);this[f]=d,this[n]=c}for(let l=0;l<2;l++){const f=this.generateRandomPropName();this[f]=Uint8Array.from((0,s.Random)(32)),this.decoyPropNamesDestroy.push(f)}return o.fill(0),this.scheduleKeyDestruction(),e}async getPublicKey(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).getPublicKey(r)}async revealCounterpartyKeyLinkage(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).revealCounterpartyKeyLinkage(r)}async revealSpecificKeyLinkage(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).revealSpecificKeyLinkage(r)}async encrypt(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).encrypt(r)}async decrypt(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).decrypt(r)}async createHmac(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).createHmac(r)}async verifyHmac(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).verifyHmac(r)}async createSignature(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).createSignature(r)}async verifySignature(r){return new s.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).verifySignature(r)}};return Ul.PrivilegedKeyManager=t,Ul}var n4;function Rr(){return n4||(n4=1,function(s){var t=Ds&&Ds.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Ds&&Ds.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(GT(),s),i(_C(),s),i(SC(),s),i(TC(),s),i(xD(),s),i(_D(),s),i(SD(),s),i(TD(),s),i(w1(),s)}(Ds)),Ds}var Zs={},ql={},r4;function ID(){if(r4)return ql;r4=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.stampLog=s,ql.stampLogFormat=t;function s(i,r){const e=`${new Date().toISOString()} ${r}
`;if(typeof i=="object"&&typeof i.log=="string")return i.log=i.log+e;if(typeof i=="string")return i+e}function t(i){if(typeof i!="string")return"";const r=i.split(`
`),e=[];let o=0;const a=[];for(const n of r){const c=n.indexOf(" ");if(c>-1){const d=new Date(n.substring(0,c)).getTime(),y=n.substring(c+1),p=d-(o||d),g=y.indexOf("**NETWORK**")>-1;g&&a.push(e.length),e.push({when:d,rest:y,delta:p,newClock:g}),o=d}}const l=e[e.length-1].when-e[0].when;if(a.length%2===0){let n=l,c=0;for(const y of a)n-=e[y-1].when-e[c].when,c=y;n-=e[e.length-1].when-e[c].when;let d=a.length;for(const y of a){const p=d>1?Math.floor(n/d):n;e[y].delta=p,n-=p,d--}}let f=`${new Date(e[0].when).toISOString()} Total = ${l} msecs
`;for(const n of e){let c=n.delta.toString();c=`${" ".repeat(8-c.length)}${c}`,f+=`${c} ${n.rest}
`}return f}return ql}var _m={},a4;function FI(){return a4||(a4=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.ScriptTemplateBRC29=s.brc29ProtocolID=void 0;const t=v1(),i=ge();s.brc29ProtocolID=[2,"3241645161d8"];class r{constructor(o){this.params=o,this.unlockLength=108,this.p2pkh=new i.P2PKH,(0,t.verifyTruthy)(o.derivationPrefix),(0,t.verifyTruthy)(o.derivationSuffix)}getKeyID(){return`${this.params.derivationPrefix} ${this.params.derivationSuffix}`}getKeyDeriver(o){return typeof o=="string"&&(o=i.PrivateKey.fromHex(o)),!this.params.keyDeriver||this.params.keyDeriver.rootKey.toHex()!==o.toHex()?new i.KeyDeriver(o):this.params.keyDeriver}lock(o,a){const l=this.getKeyDeriver(o).derivePublicKey(s.brc29ProtocolID,this.getKeyID(),a,!1).toAddress();return this.p2pkh.lock(l)}unlock(o,a,l,f){const n=this.getKeyDeriver(o).derivePrivateKey(s.brc29ProtocolID,this.getKeyID(),a).toHex();return this.p2pkh.unlock((0,t.asBsvSdkPrivateKey)(n),"all",!1,l,f)}}s.ScriptTemplateBRC29=r}(_m)),_m}var rp={},s4;function kD(){if(s4)return rp;s4=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.parseTxScriptOffsets=t;const s=ge();function t(i){const r=new s.Utils.Reader(i),e=[],o=[];r.pos+=4;const a=r.readVarIntNum();for(let f=0;f<a;f++){r.pos+=36;const n=r.readVarIntNum();e.push({vin:f,offset:r.pos,length:n}),r.pos+=n+4}const l=r.readVarIntNum();for(let f=0;f<l;f++){r.pos+=8;const n=r.readVarIntNum();o.push({vout:f,offset:r.pos,length:n}),r.pos+=n}return{inputs:e,outputs:o}}return rp}var ap={},o4;function LI(){if(o4)return ap;o4=1,Object.defineProperty(ap,"__esModule",{value:!0}),ap.convertProofToMerklePath=t;const s=ge();function t(i,r){const e=r.height,o=r.nodes.length,a=Array(o).fill(0).map(()=>[]);let l=r.index;for(let f=0;f<o;f++){const n=r.nodes[f],c=l%2===1,y={offset:c?l-1:l+1};if(n==="*"||f===0&&n===i?y.duplicate=!0:y.hash=n,a[f].push(y),f===0){const p={offset:r.index,hash:i,txid:!0};c?a[0].push(p):a[0].unshift(p)}l=l>>1}return new s.MerklePath(e,a)}return ap}var De={},c4;function vu(){if(c4)return De;c4=1,Object.defineProperty(De,"__esModule",{value:!0}),De.getIdentityKey=i,De.toWalletNetwork=r,De.makeAtomicBeef=e,De.asBsvSdkTx=o,De.asBsvSdkScript=a,De.asBsvSdkPrivateKey=l,De.asBsvSdkPublickKey=f,De.verifyTruthy=n,De.verifyHexString=c,De.verifyOptionalHexString=d,De.verifyNumber=y,De.verifyInteger=p,De.verifyId=g,De.verifyOneOrNone=b,De.verifyOne=w,De.wait=v,De.randomBytes=_,De.randomBytesHex=S,De.randomBytesBase64=T,De.validateSecondsSinceEpoch=I,De.arraysEqual=k,De.optionalArraysEqual=O,De.maxDate=A,De.sha256Hash=R,De.doubleSha256HashLE=P,De.doubleSha256BE=C;const s=ge(),t=se();async function i(N){return(await N.getPublicKey({identityKey:!0})).publicKey}function r(N){return N==="main"?"mainnet":"testnet"}function e(N,D){return Array.isArray(D)&&(D=s.Beef.fromBinary(D)),D.mergeTransaction(N),D.toBinaryAtomic(N.id("hex"))}function o(N){return Array.isArray(N)?N=s.Transaction.fromBinary(N):typeof N=="string"&&(N=s.Transaction.fromHex(N)),N}function a(N){return Array.isArray(N)?N=s.Script.fromBinary(N):typeof N=="string"&&(N=s.Script.fromHex(N)),N}function l(N){return s.PrivateKey.fromString(N,"hex")}function f(N){return s.PublicKey.fromString(N)}function n(N,D){if(!N)throw new t.sdk.WERR_INTERNAL(D??"A truthy value is required.");return N}function c(N){if(typeof N!="string")throw new t.sdk.WERR_INTERNAL("A string is required.");return N=N.trim().toLowerCase(),N}function d(N){if(N)return c(N)}function y(N){if(typeof N!="number")throw new t.sdk.WERR_INTERNAL("A number is required.");return N}function p(N){if(typeof N!="number"||!Number.isInteger(N))throw new t.sdk.WERR_INTERNAL("An integer is required.");return N}function g(N){if(N=p(N),N<1)throw new t.sdk.WERR_INTERNAL("id must be valid integer greater than zero.");return N}function b(N){if(N.length>1)throw new t.sdk.WERR_BAD_REQUEST("Result must be unique.");return N[0]}function w(N,D){if(N.length!==1)throw new t.sdk.WERR_BAD_REQUEST(D??"Result must exist and be unique.");return N[0]}function v(N){return new Promise(D=>setTimeout(D,N))}function _(N){return(0,s.Random)(N)}function S(N){return s.Utils.toHex((0,s.Random)(N))}function T(N){return s.Utils.toBase64((0,s.Random)(N))}function I(N){const D=new Date(N*1e3);if(D.getTime()/1e3!==N||N<16e8||N>1e11)throw new t.sdk.WERR_INVALID_PARAMETER("time",'valid "since epoch" unix time');return D}function k(N,D){if(N.length!==D.length)return!1;for(let U=0;U<N.length;U++)if(N[U]!==D[U])return!1;return!0}function O(N,D){return!N&&!D?!0:!N||!D?!1:k(N,D)}function A(N,D){if(N&&D)return N>D?N:D;if(N)return N;if(D)return D}function R(N){return new s.Hash.SHA256().update(N).digest()}function P(N){const D=new s.Hash.SHA256().update(N).digest();return new s.Hash.SHA256().update(D).digest()}function C(N){return P(N).reverse()}return De}var jl={},u4;function UI(){if(u4)return jl;u4=1,Object.defineProperty(jl,"__esModule",{value:!0}),jl.asString=t,jl.asArray=i;const s=ge();function t(r){return typeof r=="string"?r:s.Utils.toHex(r)}function i(r){return Array.isArray(r)?r:s.Utils.toArray(r,"hex")}return jl}var l4;function v1(){return l4||(l4=1,function(s){var t=Zs&&Zs.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Zs&&Zs.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(ID(),s),i(FI(),s),i(kD(),s),i(LI(),s),i(vu(),s),i(UI(),s)}(Zs)),Zs}var Hl={},Kl={};const Sb=(s,t)=>t.some(i=>s instanceof i);let d4,f4;function ED(){return d4||(d4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OD(){return f4||(f4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tb=new WeakMap,Sm=new WeakMap,N0=new WeakMap;function AD(s){const t=new Promise((i,r)=>{const e=()=>{s.removeEventListener("success",o),s.removeEventListener("error",a)},o=()=>{i(_a(s.result)),e()},a=()=>{r(s.error),e()};s.addEventListener("success",o),s.addEventListener("error",a)});return N0.set(t,s),t}function PD(s){if(Tb.has(s))return;const t=new Promise((i,r)=>{const e=()=>{s.removeEventListener("complete",o),s.removeEventListener("error",a),s.removeEventListener("abort",a)},o=()=>{i(),e()},a=()=>{r(s.error||new DOMException("AbortError","AbortError")),e()};s.addEventListener("complete",o),s.addEventListener("error",a),s.addEventListener("abort",a)});Tb.set(s,t)}let Ib={get(s,t,i){if(s instanceof IDBTransaction){if(t==="done")return Tb.get(s);if(t==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return _a(s[t])},set(s,t,i){return s[t]=i,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function qI(s){Ib=s(Ib)}function RD(s){return OD().includes(s)?function(...t){return s.apply(Yp(this),t),_a(this.request)}:function(...t){return _a(s.apply(Yp(this),t))}}function MD(s){return typeof s=="function"?RD(s):(s instanceof IDBTransaction&&PD(s),Sb(s,ED())?new Proxy(s,Ib):s)}function _a(s){if(s instanceof IDBRequest)return AD(s);if(Sm.has(s))return Sm.get(s);const t=MD(s);return t!==s&&(Sm.set(s,t),N0.set(t,s)),t}const Yp=s=>N0.get(s);function ND(s,t,{blocked:i,upgrade:r,blocking:e,terminated:o}={}){const a=indexedDB.open(s,t),l=_a(a);return r&&a.addEventListener("upgradeneeded",f=>{r(_a(a.result),f.oldVersion,f.newVersion,_a(a.transaction),f)}),i&&a.addEventListener("blocked",f=>i(f.oldVersion,f.newVersion,f)),l.then(f=>{o&&f.addEventListener("close",()=>o()),e&&f.addEventListener("versionchange",n=>e(n.oldVersion,n.newVersion,n))}).catch(()=>{}),l}function CD(s,{blocked:t}={}){const i=indexedDB.deleteDatabase(s);return t&&i.addEventListener("blocked",r=>t(r.oldVersion,r)),_a(i).then(()=>{})}const DD=["get","getKey","getAll","getAllKeys","count"],BD=["put","add","delete","clear"],Tm=new Map;function h4(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(Tm.get(t))return Tm.get(t);const i=t.replace(/FromIndex$/,""),r=t!==i,e=BD.includes(i);if(!(i in(r?IDBIndex:IDBObjectStore).prototype)||!(e||DD.includes(i)))return;const o=async function(a,...l){const f=this.transaction(a,e?"readwrite":"readonly");let n=f.store;return r&&(n=n.index(l.shift())),(await Promise.all([n[i](...l),e&&f.done]))[0]};return Tm.set(t,o),o}qI(s=>({...s,get:(t,i,r)=>h4(t,i)||s.get(t,i,r),has:(t,i)=>!!h4(t,i)||s.has(t,i)}));const FD=["continue","continuePrimaryKey","advance"],p4={},kb=new WeakMap,jI=new WeakMap,LD={get(s,t){if(!FD.includes(t))return s[t];let i=p4[t];return i||(i=p4[t]=function(...r){kb.set(this,jI.get(this)[t](...r))}),i}};async function*UD(...s){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...s)),!t)return;t=t;const i=new Proxy(t,LD);for(jI.set(i,t),N0.set(i,Yp(t));t;)yield i,t=await(kb.get(i)||t.continue()),kb.delete(i)}function y4(s,t){return t===Symbol.asyncIterator&&Sb(s,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Sb(s,[IDBIndex,IDBObjectStore])}qI(s=>({...s,get(t,i,r){return y4(t,i)?UD:s.get(t,i,r)},has(t,i){return y4(t,i)||s.has(t,i)}}));const qD=Object.freeze(Object.defineProperty({__proto__:null,deleteDB:CD,openDB:ND,unwrap:Yp,wrap:_a},Symbol.toStringTag,{value:"Module"})),jD=y8(qD);var jc={},sp={},g4;function HD(){if(g4)return sp;g4=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.getBeefForTransaction=i;const s=ge(),t=se();async function i(o,a,l){const f=Array.isArray(l.mergeToBeef)?s.Beef.fromBinary(l.mergeToBeef):l.mergeToBeef||new s.Beef;return await e(f,o,a,l,0),f}async function r(o,a,l){var f;o.getServices();const n=await t.EntityProvenTx.fromTxid(a,await o.getServices());return n.proven&&!l.ignoreStorage&&!l.ignoreNewProven&&(n.proven.provenTxId=await o.insertProvenTx(n.proven.toApi())),{proven:(f=n.proven)===null||f===void 0?void 0:f.toApi(),rawTx:n.rawTx}}async function e(o,a,l,f,n){const c=a.maxRecursionDepth;if(c&&c<=n)throw new t.sdk.WERR_INVALID_OPERATION(`Maximum BEEF depth exceeded. Limit is ${a.maxRecursionDepth}`);if(f.knownTxids&&f.knownTxids.indexOf(l)>-1)return o.mergeTxidOnly(l),o;if(!f.ignoreStorage){const p=await a.getValidBeefForTxid(l,o,f.trustSelf,f.knownTxids);if(p)return p}if(f.ignoreServices)throw new t.sdk.WERR_INVALID_PARAMETER(`txid ${l}`,`valid transaction on chain ${a.chain}`);const d=await r(a,l,f);if(d.proven&&f.minProofLevel&&f.minProofLevel>n&&(d.proven=void 0),d.proven)return o.mergeRawTx(d.proven.rawTx),o.mergeBump(new t.EntityProvenTx(d.proven).getMerklePath()),o;if(!d.rawTx)throw new t.sdk.WERR_INVALID_PARAMETER(`txid ${l}`,`valid transaction on chain ${a.chain}`);o.mergeRawTx(d.rawTx);const y=(0,t.asBsvSdkTx)(d.rawTx);for(const p of y.inputs){const g=(0,t.verifyTruthy)(p.sourceTXID);o.findTxid(g)||await e(o,a,g,f,n+1)}return o}return sp}var op={},m4;function KD(){if(m4)return op;m4=1,Object.defineProperty(op,"__esModule",{value:!0}),op.processAction=i;const s=ge(),t=se();async function i(l,f,n){(0,t.stampLog)(n.log,"start storage processActionSdk");const c=(0,t.verifyId)(f.userId),d={sendWithResults:void 0};let y;const p=[...n.sendWith];if(n.isNewTx){const w=await e(l,c,n);if({req:y,log:n.log}=await o(l,c,w),!y)throw new t.sdk.WERR_INTERNAL;n.isNoSend&&!n.isSendWith?(0,t.stampLog)(n.log,"... storage processActionSdk newTx committed noSend"):(p.push(y.txid),(0,t.stampLog)(n.log,`... storage processActionSdk newTx committed sendWith ${y.txid}`))}const{swr:g,ndr:b}=await r(l,c,p,n.isDelayed);return d.sendWithResults=g,d.notDelayedResults=b,(0,t.stampLog)(n.log,"end storage processActionSdk"),d}async function r(l,f,n,c){let d=[],y;if(n.length<1)return{swr:d,ndr:y};const p=await l.getReqsAndBeefToShareWithWorld(n,[]),g=[],b=[];for(const I of p.details){let k="failed";I.status==="alreadySent"?k="unproven":I.status==="readyToSend"&&(k="sending",b.push(new t.EntityProvenTxReq(I.req))),g.push({txid:I.txid,getReq:I,status:k})}const w=b.map(I=>I.id),v=b.map(I=>I.notify.transactionIds||[]).flat();if(b.length>0&&!await p.beef.verify(await l.getServices().getChainTracker()))throw new t.sdk.WERR_INTERNAL("merged Beef failed validation.");const _=n.length>1?(0,t.randomBytesBase64)(16):void 0;if(c)return w.length>0&&await l.transaction(async I=>{await l.updateProvenTxReq(w,{status:"unsent",batch:_},I),await l.updateTransaction(v,{status:"sending"},I)}),T();if(w.length<1)return T();if(_){for(const I of b)I.batch=_;await l.updateProvenTxReq(w,{batch:_})}const S=await l.attemptToPostReqsToNetwork(b);for(const I of g){const k=I.txid,O=S.details.find(A=>A.txid===k);if(!O)throw new t.sdk.WERR_INTERNAL(`missing details for ${k}`);switch(I.ndr={txid:O.txid,status:"success",competingTxs:O.competingTxs},O.status){case"success":I.status="unproven";break;case"doubleSpend":I.status="failed",I.ndr.status="doubleSpend",O.competingTxs&&(I.ndr.competingBeef=await a(O.competingTxs,l));break;case"serviceError":I.status="sending",I.ndr.status="serviceError";break;case"invalidTx":I.status="failed",I.ndr.status="invalidTx";break;case"unknown":case"invalid":default:throw new t.sdk.WERR_INTERNAL(`processAction with notDelayed status ${O.status} should not occur.`)}}return T();function T(){d=[],y=c?void 0:[];for(const I of g)d.push({txid:I.txid,status:I.status}),I.ndr&&y&&y.push(I.ndr);return{swr:d,ndr:y}}}async function e(l,f,n){if(!n.reference||!n.txid||!n.rawTx)throw new t.sdk.WERR_INVALID_OPERATION("One or more expected params are undefined.");let c;try{c=s.Transaction.fromBinary(n.rawTx)}catch{throw new t.sdk.WERR_INVALID_OPERATION("Parsing serialized transaction failed.")}if(n.txid!==c.id("hex"))throw new t.sdk.WERR_INVALID_OPERATION("Hash of serialized transaction doesn't match expected txid");if(!(await l.getServices()).nLockTimeIsFinal(c))throw new t.sdk.WERR_INVALID_OPERATION(`This transaction is not final.
         Ensure that the transaction meets the rules for being a finalized
         which can be found at https://wiki.bitcoinsv.io/index.php/NLocktime_and_nSequence`);const d=(0,t.parseTxScriptOffsets)(n.rawTx),y=(0,t.verifyOne)(await l.findTransactions({partial:{userId:f,reference:n.reference}}));if(!y.isOutgoing)throw new t.sdk.WERR_INVALID_OPERATION("isOutgoing is not true");if(!y.inputBEEF)throw new t.sdk.WERR_INVALID_OPERATION;const p=s.Beef.fromBinary((0,t.asArray)(y.inputBEEF));if(y.status!=="unsigned"&&y.status!=="unprocessed")throw new t.sdk.WERR_INVALID_OPERATION(`invalid transaction status ${y.status}`);const g=(0,t.verifyId)(y.transactionId),b=await l.findOutputs({partial:{userId:f,transactionId:g}}),w=await l.findOutputs({partial:{userId:f,spentBy:g}}),v=(0,t.verifyOneOrNone)(await l.findCommissions({partial:{transactionId:g,userId:f}}));if(l.commissionSatoshis>0){if(!v)throw new t.sdk.WERR_INTERNAL;if(!c.outputs.some(O=>O.satoshis===v.satoshis&&O.lockingScript.toHex()===(0,t.asString)(v.lockingScript)))throw new t.sdk.WERR_INVALID_OPERATION("Transaction did not include an output to cover service fee.")}const _=t.EntityProvenTxReq.fromTxid(n.txid,n.rawTx,y.inputBEEF);_.addNotifyTransactionId(g);let S,T;if(n.isNoSend&&!n.isSendWith)T={req:"nosend",tx:"nosend"};else if(!n.isNoSend&&n.isDelayed)T={req:"unsent",tx:"unprocessed"};else if(!n.isNoSend&&!n.isDelayed)T={req:"unprocessed",tx:"unprocessed"},S={req:"unmined",tx:"unproven"};else throw new t.sdk.WERR_INTERNAL("logic error");_.status=T.req;const I={reference:n.reference,txid:n.txid,rawTx:n.rawTx,isSendWith:!!n.sendWith&&n.sendWith.length>0,isDelayed:n.isDelayed,isNoSend:n.isNoSend,tx:c,txScriptOffsets:d,transactionId:g,transaction:y,inputOutputs:w,outputOutputs:b,commission:v,beef:p,req:_,outputUpdates:[],transactionUpdate:{txid:n.txid,rawTx:void 0,inputBEEF:void 0,status:T.tx},postStatus:S};for(const k of I.outputOutputs){const O=(0,t.verifyInteger)(k.vout),A=I.txScriptOffsets.outputs[O],R=(0,t.asString)(I.rawTx.slice(A.offset,A.offset+A.length));if(k.lockingScript&&R!==(0,t.asString)(k.lockingScript))throw new t.sdk.WERR_INVALID_OPERATION(`rawTx output locking script for vout ${O} not equal to expected output script.`);if(c.outputs[O].lockingScript.toHex()!==R)throw new t.sdk.WERR_INVALID_OPERATION(`parsed transaction output locking script for vout ${O} not equal to expected output script.`);const P={txid:I.txid,spendable:k.basketId!==void 0,scriptLength:A.length,scriptOffset:A.offset};A.length>(await l.getSettings()).maxOutputScript&&(P.lockingScript=void 0),I.outputUpdates.push({id:k.outputId,update:P})}return I}async function o(l,f,n){let c=n.log;c=(0,t.stampLog)(c,"start storage commitNewTxToStorage");let d;await l.transaction(async p=>{c=(0,t.stampLog)(c,"... storage commitNewTxToStorage storage transaction start"),d=await n.req.insertOrMerge(l,p),c=(0,t.stampLog)(c,"... storage commitNewTxToStorage req inserted");for(const g of n.outputUpdates)await l.updateOutput(g.id,g.update,p);c=(0,t.stampLog)(c,"... storage commitNewTxToStorage outputs updated"),await l.updateTransaction(n.transactionId,n.transactionUpdate,p),c=(0,t.stampLog)(c,"... storage commitNewTxToStorage storage transaction end")}),c=(0,t.stampLog)(c,"... storage commitNewTxToStorage storage transaction await done");const y={req:(0,t.verifyTruthy)(d),log:c};return c=(0,t.stampLog)(c,"end storage commitNewTxToStorage"),y}async function a(l,f){const n=new s.Beef,c={mergeToBeef:n,ignoreNewProven:!0};for(const d of l)await f.getBeefForTransaction(d,c);return n.toBinary()}return op}var br={},b4;function HI(){if(b4)return br;b4=1;var s=br&&br.__createBinding||(Object.create?function(y,p,g,b){b===void 0&&(b=g);var w=Object.getOwnPropertyDescriptor(p,g);(!w||("get"in w?!p.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return p[g]}}),Object.defineProperty(y,b,w)}:function(y,p,g,b){b===void 0&&(b=g),y[b]=p[g]}),t=br&&br.__setModuleDefault||(Object.create?function(y,p){Object.defineProperty(y,"default",{enumerable:!0,value:p})}:function(y,p){y.default=p}),i=br&&br.__importStar||function(){var y=function(p){return y=Object.getOwnPropertyNames||function(g){var b=[];for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&(b[b.length]=w);return b},y(p)};return function(p){if(p&&p.__esModule)return p;var g={};if(p!=null)for(var b=y(p),w=0;w<b.length;w++)b[w]!=="default"&&s(g,p,b[w]);return t(g,p),g}}();Object.defineProperty(br,"__esModule",{value:!0}),br.attemptToPostReqsToNetwork=a;const r=ge(),e=i(Rr()),o=vu();async function a(y,p,g){const{r:b,vreqs:w,txids:v}=await l(y,p,g),_=y.getServices(),S=await _.postBeef(b.beef,v);await f(v,w,S,y,g);const T=n(v,w,S);return await c(v,b,T,y,_,g),b}async function l(y,p,g){const b={status:"success",beef:new r.Beef,details:[],log:""},w=[];for(const v of p)try{const _=!v.rawTx,S=!v.notify.transactionIds||v.notify.transactionIds.length<1,T=!v.inputBEEF;if(_||S||T)v.addHistoryNote({when:new Date().toISOString(),what:"validateReqFailed",noRawTx:_,noTxIds:S,noInputBEEF:T}),v.status="invalid",await v.updateStorageDynamicProperties(y,g),b.details.push({txid:v.txid,req:v,status:"invalid"});else{const I={txid:v.txid,req:v,status:"unknown"};await y.mergeReqToBeefToShareExternally(v.api,b.beef,[],g),w.push(I),b.details.push(I)}}catch(_){const{code:S,message:T}=e.WalletError.fromUnknown(_);v.addHistoryNote({when:new Date().toISOString(),what:"validateReqError",txid:v.txid,code:S,message:T}),v.attempts++,v.attempts>6&&(v.status="invalid",b.details.push({txid:v.txid,req:v,status:"invalid"})),await v.updateStorageDynamicProperties(y,g)}return{r:b,vreqs:w,txids:w.map(v=>v.txid)}}async function f(y,p,g,b,w){for(const v of y){const _=p.find(T=>T.txid===v);if(!_)throw new e.WERR_INTERNAL;const S=[];for(const T of g){S.push(...T.notes||[]);const I=T.txidResults.find(k=>k.txid===v);I&&S.push(...I.notes||[])}for(const T of S)_.req.addHistoryNote(T);await _.req.updateStorageDynamicProperties(b,w)}}function n(y,p,g){const b={};for(const w of y){const v=p.find(S=>S.txid===w),_={txid:w,vreq:v,txidResults:[],status:"success",successCount:0,doubleSpendCount:0,statusErrorCount:0,serviceErrorCount:0,competingTxs:[]};b[w]=_;for(const S of g){const T=S.txidResults.find(I=>I.txid===w);T&&(_.txidResults.push(T),T.status==="success"?_.successCount++:T.doubleSpend?(_.doubleSpendCount++,T.competingTxs&&(_.competingTxs=[...T.competingTxs])):T.serviceError?_.serviceErrorCount++:_.statusErrorCount++),_.competingTxs.length>1&&(_.competingTxs=[...new Set(_.competingTxs)])}_.successCount>0&&_.doubleSpendCount===0?_.status="success":_.doubleSpendCount>0?_.status="doubleSpend":_.statusErrorCount>0?_.status="invalidTx":_.status="serviceError"}return b}async function c(y,p,g,b,w,v){for(const _ of y){const S=g[_],T=S.vreq.req;await T.refreshFromStorage(b,v);const{successCount:I,doubleSpendCount:k,statusErrorCount:O,serviceErrorCount:A}=S,R={when:new Date().toISOString(),what:"aggregateResults",reqStatus:T.status,aggStatus:S.status,attempts:T.attempts,successCount:I,doubleSpendCount:k,statusErrorCount:O,serviceErrorCount:A};if(["completed","unmined"].indexOf(T.status)>=0)continue;S.status==="doubleSpend"&&w&&!v&&await d(S,p.beef,b,w);let P,C;switch(S.status){case"success":P="unmined",C="unproven";break;case"doubleSpend":P="doubleSpend",C="failed";break;case"invalidTx":P="invalid",C="failed";break;case"serviceError":P="sending",C="sending",T.attempts++;break;default:throw new e.WERR_INTERNAL(`unimplemented AggregateStatus ${S.status}`)}if(R.newReqStatus=P,R.newTxStatus=C,R.newAttempts=T.attempts,P&&(T.status=P),T.addHistoryNote(R),await T.updateStorageDynamicProperties(b,v),C){const D=T.notify.transactionIds;D&&await b.updateTransactionsStatus(D,C,v)}const N=p.details.find(D=>D.txid===_);N.status=S.status,N.competingTxs=S.competingTxs}}async function d(y,p,g,b){var w,v;const _=y.vreq.req,S={when:new Date().toISOString(),what:"confirmDoubleSpend"};let T=!1;for(let I=0;I<3;I++){const k=await b.getStatusForTxids([_.txid]);if(S[`getStatus${I}`]=`${k.status}${k.error?`${k.error.code}`:""},${(w=k.results[0])===null||w===void 0?void 0:w.status}`,k.status==="success"&&k.results[0].status!=="unknown"){T=!0;break}else await(0,o.wait)(1e3)}if(T)y.status="success",S.newStatus=y.status;else{const I=r.Transaction.fromBinary(_.rawTx),k=new Set(y.competingTxs);for(const O of I.inputs){const A=(v=p.findTxid(O.sourceTXID))===null||v===void 0?void 0:v.tx;if(!A)throw new e.WERR_INTERNAL(`beef lacks tx for ${O.sourceTXID}`);const R=A.outputs[O.sourceOutputIndex].lockingScript.toHex(),P=b.hashOutputScript(R),C=await b.getScriptHashHistory(P);if(C.status==="success")for(const N of C.history)N.txid!==O.sourceTXID&&N.txid!==y.txid&&k.add(N.txid)}y.competingTxs=[...k].slice(-24),S.competingTxs=y.competingTxs.join(",")}_.addHistoryNote(S)}return br}var cp={},w4;function VD(){if(w4)return cp;w4=1,Object.defineProperty(cp,"__esModule",{value:!0}),cp.listCertificates=s;async function s(t,i,r,e){const o={limit:r.limit,offset:r.offset},a={userId:i.userId,isDeleted:!1};if(r.partial){const f=r.partial;f.type&&(a.type=f.type),f.subject&&(a.subject=f.subject),f.serialNumber&&(a.serialNumber=f.serialNumber),f.certifier&&(a.certifier=f.certifier),f.revocationOutpoint&&(a.revocationOutpoint=f.revocationOutpoint),f.signature&&(a.signature=f.signature)}return await t.transaction(async f=>{const n={partial:a,certifiers:r.certifiers,types:r.types,paged:o,trx:f},c=await t.findCertificates(n),y={totalCertificates:0,certificates:(await Promise.all(c.map(async p=>{const g=await t.findCertificateFields({partial:{certificateId:p.certificateId,userId:i.userId},trx:f});return{...p,fields:Object.fromEntries(g.map(b=>[b.fieldName,b.fieldValue])),masterKeyring:Object.fromEntries(g.map(b=>[b.fieldName,b.masterKey]))}}))).map(p=>({type:p.type,subject:p.subject,serialNumber:p.serialNumber,certifier:p.certifier,revocationOutpoint:p.revocationOutpoint,signature:p.signature,fields:p.fields,verifier:p.verifier,keyring:p.masterKeyring}))};return y.certificates.length<o.limit?y.totalCertificates=y.certificates.length:y.totalCertificates=await t.countCertificates(n),y})}return cp}var is={},Im={},v4;function KI(){return v4||(v4=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.maxPossibleSatoshis=void 0,s.generateChangeSdk=i,s.validateGenerateChangeSdkResult=r,s.validateGenerateChangeSdkParams=o,s.generateChangeSdkMakeStorage=a,s.varUintSize=l,s.transactionInputSize=f,s.transactionOutputSize=n,s.transactionSize=c;const t=se();s.maxPossibleSatoshis=0x775f05a073fff;async function i(d,y,p){d.noLogging===!1&&e(d);const g={allocatedChangeInputs:[],changeOutputs:[],size:0,fee:0,satsPerKb:0};try{const b=o(d),w=d.feeModel.value||0,v=[...d.randomVals||[]],_=[],S=()=>{let Q=0;return!v||v.length===0?Q=Math.random():(Q=v.shift()||0,v.push(Q)),_.push(Q),Q},T=(Q,J)=>{if(J<Q)throw new t.sdk.WERR_INVALID_PARAMETER("max",`less than min (${Q}). max is (${J})`);return Math.floor(S()*(J-Q+1)+Q)},I=d.fixedInputs,k=d.fixedOutputs,O=()=>I.reduce((Q,J)=>Q+J.satoshis,0)+g.allocatedChangeInputs.reduce((Q,J)=>Q+J.satoshis,0),A=()=>k.reduce((Q,J)=>Q+J.satoshis,0),R=()=>g.changeOutputs.reduce((Q,J)=>Q+J.satoshis,0),P=()=>O()-A()-R(),C=(Q,J)=>{const vt=[...I.map(yt=>yt.unlockingScriptLength),...Array(g.allocatedChangeInputs.length+(Q||0)).fill(d.changeUnlockingScriptLength)],wt=[...k.map(yt=>yt.lockingScriptLength),...Array(g.changeOutputs.length+(J||0)).fill(d.changeLockingScriptLength)];return c(vt,wt)},N=(Q,J)=>Math.ceil(C(Q,J)/1e3*w),D=(Q,J)=>{const vt=O()-A()-R()-N(Q,J);return!Q&&!J&&(U=vt),vt};let U=0;D();const F=d.targetNetCount!==void 0,L=d.targetNetCount||0,j=()=>g.changeOutputs.length-g.allocatedChangeInputs.length,V=()=>F?j()-1<L:!1,W=async()=>{for(;g.allocatedChangeInputs.length>0;){const Q=g.allocatedChangeInputs.pop();Q&&await p(Q.outputId)}U=D()};for(;F&&L>j()||g.changeOutputs.length===0&&D()>0;)g.changeOutputs.push({satoshis:g.changeOutputs.length===0?d.changeFirstSatoshis:d.changeInitialSatoshis,lockingScriptLength:d.changeLockingScriptLength});if(await(async()=>{let Q=!1;const J=async()=>{if(D()>0)return!0;let vt;!F&&g.changeOutputs.length===0&&(vt=-D(1));const wt=V()?1:0,dt=-D(1,wt)+(wt===1?2*d.changeInitialSatoshis:0),yt=await y(dt,vt);return yt?(g.allocatedChangeInputs.push(yt),!Q&&D()>0&&(wt==1||g.changeOutputs.length===0)&&g.changeOutputs.push({satoshis:Math.min(D(),g.changeOutputs.length===0?d.changeFirstSatoshis:d.changeInitialSatoshis),lockingScriptLength:d.changeLockingScriptLength}),!0):!1};for(;;){for(await W();D()<0&&await J(););if(D()>=0||g.changeOutputs.length===0)break;for(Q=!0;g.changeOutputs.length>0&&D()<0;)g.changeOutputs.pop();if(D()<0)break;const vt=[...g.allocatedChangeInputs];for(;vt.length>1&&g.changeOutputs.length>1;){const wt=g.changeOutputs.slice(-1)[0],dt=vt.findIndex(yt=>yt.satoshis<=wt.satoshis);if(dt<0)break;g.changeOutputs.pop(),vt.splice(dt,1)}}})(),D()<0&&b.hasMaxPossibleOutput!==void 0){if(k[b.hasMaxPossibleOutput].satoshis!==s.maxPossibleSatoshis)throw new t.sdk.WERR_INTERNAL;k[b.hasMaxPossibleOutput].satoshis+=D(),g.maxPossibleSatoshisAdjustment={fixedOutputIndex:b.hasMaxPossibleOutput,satoshis:k[b.hasMaxPossibleOutput].satoshis}}if(D()<0)throw await W(),new t.sdk.WERR_INSUFFICIENT_FUNDS(A()+N(),-U);if(g.changeOutputs.length===0&&U>0)throw await W(),new t.sdk.WERR_INSUFFICIENT_FUNDS(A()+N(),d.changeFirstSatoshis);for(;g.changeOutputs.length>0&&U>0;)if(g.changeOutputs.length===1)g.changeOutputs[0].satoshis+=U,U=0;else if(g.changeOutputs[0].satoshis<d.changeInitialSatoshis){const Q=Math.min(U,d.changeInitialSatoshis-g.changeOutputs[0].satoshis);U-=Q,g.changeOutputs[0].satoshis+=Q}else{const Q=Math.max(1,Math.floor(T(2500,5e3)/1e4*U));U-=Q;const J=T(0,g.changeOutputs.length-1);g.changeOutputs[J].satoshis+=Q}g.size=C(),g.fee=P(),g.satsPerKb=w;const{ok:$,log:Y}=r(d,g);if(!$)throw new t.sdk.WERR_INTERNAL(`generateChangeSdk error: ${Y}`);return g.allocatedChangeInputs.length>4&&g.changeOutputs.length>4&&(console.log("generateChangeSdk_Capture_too_many_ins_and_outs"),e(d)),g}catch(b){throw t.sdk.WalletError.fromUnknown(b).code==="WERR_INSUFFICIENT_FUNDS",b}}function r(d,y){let p=!0,g="";const b=d.fixedInputs.reduce((S,T)=>S+T.satoshis,0)+y.allocatedChangeInputs.reduce((S,T)=>S+T.satoshis,0),w=d.fixedOutputs.reduce((S,T)=>S+T.satoshis,0)+y.changeOutputs.reduce((S,T)=>S+T.satoshis,0);y.fee&&Number.isInteger(y.fee)&&y.fee<0&&(g+=`basic fee error ${y.fee};`,p=!1);const v=b-w;v!==y.fee&&(g+=`exact fee error ${v} !== ${y.fee};`,p=!1);const _=Math.ceil((y.size||0)/1e3*(y.satsPerKb||0));return _!==y.fee&&(g+=`required fee error ${_} !== ${y.fee};`,p=!1),{ok:p,log:g}}function e(d,y){let p=JSON.stringify(d);console.log(`generateChangeSdk params length ${p.length}`);let g=-1;const b=99900;for(;g++,console.log(`generateChangeSdk params ${g} XXX${p.slice(0,b)}XXX`),p=p.slice(b),!(!p||g>100););}function o(d){if(!Array.isArray(d.fixedInputs))throw new t.sdk.WERR_INVALID_PARAMETER("fixedInputs","an array of objects");const y={};if(d.fixedInputs.forEach((p,g)=>{t.sdk.validateSatoshis(p.satoshis,`fixedInputs[${g}].satoshis`),t.sdk.validateInteger(p.unlockingScriptLength,`fixedInputs[${g}].unlockingScriptLength`,void 0,0)}),!Array.isArray(d.fixedOutputs))throw new t.sdk.WERR_INVALID_PARAMETER("fixedOutputs","an array of objects");if(d.fixedOutputs.forEach((p,g)=>{if(t.sdk.validateSatoshis(p.satoshis,`fixedOutputs[${g}].satoshis`),t.sdk.validateInteger(p.lockingScriptLength,`fixedOutputs[${g}].lockingScriptLength`,void 0,0),p.satoshis===s.maxPossibleSatoshis){if(y.hasMaxPossibleOutput!==void 0)throw new t.sdk.WERR_INVALID_PARAMETER(`fixedOutputs[${g}].satoshis`,"valid satoshis amount. Only one 'maxPossibleSatoshis' output allowed.");y.hasMaxPossibleOutput=g}}),d.feeModel=(0,t.validateStorageFeeModel)(d.feeModel),d.feeModel.model!=="sat/kb")throw new t.sdk.WERR_INVALID_PARAMETER("feeModel.model","'sat/kb'");return t.sdk.validateOptionalInteger(d.targetNetCount,"targetNetCount"),t.sdk.validateSatoshis(d.changeFirstSatoshis,"changeFirstSatoshis",1),t.sdk.validateSatoshis(d.changeInitialSatoshis,"changeInitialSatoshis",1),t.sdk.validateInteger(d.changeLockingScriptLength,"changeLockingScriptLength"),t.sdk.validateInteger(d.changeUnlockingScriptLength,"changeUnlockingScriptLength"),y}function a(d){const y=d.map(_=>({..._,spendable:!0}));y.sort((_,S)=>_.satoshis<S.satoshis?-1:_.satoshis>S.satoshis?1:_.outputId<S.outputId?-1:_.outputId>S.outputId?1:0);let p="";for(const _ of y)p+=`change ${_.satoshis} ${_.outputId}
`;const g=()=>p,b=_=>(p+=` -> ${_.satoshis} sats, id ${_.outputId}
`,_.spendable=!1,_);return{allocateChangeInput:async(_,S)=>{if(p+=`allocate target ${_} exact ${S}`,S!==void 0){const k=y.find(O=>O.spendable&&O.satoshis===S);if(k)return b(k)}const T=y.find(k=>k.spendable&&k.satoshis>=_);if(T)return b(T);let I;for(let k=y.length-1;k>=0;k--)if(y[k].spendable){I=y[k];break}if(I)return b(I);p+=`
`},releaseChangeInput:async _=>{p+=`release id ${_}
`;const S=y.find(T=>T.outputId===_);if(!S)throw new t.sdk.WERR_INTERNAL(`unknown outputId ${_}`);if(S.spendable)throw new t.sdk.WERR_INTERNAL(`release of spendable outputId ${_}`);S.spendable=!0},getLog:g}}function l(d){if(d<0)throw new t.sdk.WERR_INVALID_PARAMETER("varUint","non-negative");return d<=252?1:d<=65535?3:d<=4294967295?5:9}function f(d){return 36+l(d)+d+4}function n(d){return l(d)+d+8}function c(d,y){return 4+l(d.length)+d.reduce((p,g)=>p+f(g),0)+l(y.length)+y.reduce((p,g)=>p+n(g),0)+4}}(Im)),Im}var x4;function WD(){if(x4)return is;x4=1,Object.defineProperty(is,"__esModule",{value:!0}),is.setDisableDoubleSpendCheckForTest=e,is.createAction=o,is.offsetPubKey=v,is.lockScriptWithKeyOffsetFromPubKey=_,is.createStorageServiceChargeScript=S;const s=ge(),t=se(),i=KI();let r=!0;function e(T){r=T}async function o(T,I,k,O){if(!k.isNewTx)throw new t.sdk.WERR_INTERNAL;const A=I.userId,{storageBeef:R,beef:P,xinputs:C}=await d(T,A,k),N=c(T,A,k),D="default",U=(0,t.verifyOne)(await T.findOutputBaskets({partial:{userId:A,name:D}}),`Invalid outputGeneration basket "${D}"`),F=await y(T,A,k,U),L=await T.countChangeInputs(A,U.basketId,!k.isDelayed),j=(0,t.validateStorageFeeModel)(T.feeModel),V=await n(T,A,k,R),W={xinputs:C,xoutputs:N,changeBasket:U,noSendChangeIn:F,availableChangeCount:L,feeModel:j,transactionId:V.transactionId},{allocatedChange:q,changeOutputs:$,derivationPrefix:Y,maxPossibleSatoshisAdjustment:Q}=await p(T,A,k,W);if(Q){const tt=Q;if(W.xoutputs[tt.fixedOutputIndex].satoshis!==i.maxPossibleSatoshis)throw new t.sdk.WERR_INTERNAL;W.xoutputs[tt.fixedOutputIndex].satoshis=tt.satoshis}const J=$.reduce((tt,xt)=>tt+xt.satoshis,0)-q.reduce((tt,xt)=>tt+xt.satoshis,0);await T.updateTransaction(V.transactionId,{satoshis:J});const{outputs:vt,changeVouts:wt}=await f(T,A,k,W,$),dt=await b(T,A,k,q,P),yt=await l(T,A,k,W,q);return{reference:V.reference,version:V.version,lockTime:V.lockTime,inputs:yt,outputs:vt,derivationPrefix:Y,inputBeef:dt,noSendChangeOutputVouts:k.isNoSend?wt:void 0}}function a(T,I,k,O){const A=new Date;return{created_at:A,updated_at:A,outputId:0,userId:T,transactionId:I,satoshis:k,vout:O,basketId:void 0,change:!1,customInstructions:void 0,derivationPrefix:void 0,derivationSuffix:void 0,outputDescription:"",lockingScript:void 0,providedBy:"you",purpose:"",senderIdentityKey:void 0,spendable:!0,spendingDescription:void 0,spentBy:void 0,txid:void 0,type:""}}async function l(T,I,k,O,A){const R=[],P=[];for(const N of O.xinputs){const D=N.output;P.push({i:N,o:D}),D&&await T.updateOutput(D.outputId,{spendable:!1,spentBy:O.transactionId,spendingDescription:N.inputDescription})}for(const N of A)P.push({o:N,unlockLen:107});let C=-1;for(const{i:N,o:D,unlockLen:U}of P)if(C++,D){if(!N&&!U)throw new t.sdk.WERR_INTERNAL(`vin ${C} non-fixedInput without unlockLen`);const F=k.includeAllSourceTransactions&&k.isSignAction?await T.getRawTxOfKnownValidTransaction(D.txid):void 0,L={vin:C,sourceTxid:D.txid,sourceVout:D.vout,sourceSatoshis:D.satoshis,sourceLockingScript:(0,t.asString)(D.lockingScript),sourceTransaction:F,unlockingScriptLength:U||N.unlockingScriptLength,providedBy:N&&D.providedBy==="storage"?"you-and-storage":D.providedBy,type:D.type,spendingDescription:D.spendingDescription||void 0,derivationPrefix:D.derivationPrefix||void 0,derivationSuffix:D.derivationSuffix||void 0,senderIdentityKey:D.senderIdentityKey||void 0};R.push(L)}else{if(!N)throw new t.sdk.WERR_INTERNAL(`vin ${C} without output or xinput`);const F={vin:C,sourceTxid:N.outpoint.txid,sourceVout:N.outpoint.vout,sourceSatoshis:N.satoshis,sourceLockingScript:N.lockingScript.toHex(),unlockingScriptLength:N.unlockingScriptLength,providedBy:"you",type:"custom",spendingDescription:void 0,derivationPrefix:void 0,derivationSuffix:void 0,senderIdentityKey:void 0};R.push(F)}return R}async function f(T,I,k,O,A){var R;const P=[],C={};for(const F of O.xoutputs)F.basket!==void 0&&!C[F.basket]&&(C[F.basket]=await T.findOrInsertOutputBasket(I,F.basket));const N={};for(const F of O.xoutputs)for(const L of F.tags)N[L]=await T.findOrInsertOutputTag(I,L);const D=[];for(const F of O.xoutputs){const L=(0,t.asArray)(F.lockingScript);if(F.purpose==="service-charge"){const j=new Date;await T.insertCommission({userId:I,transactionId:O.transactionId,lockingScript:L,satoshis:F.satoshis,isRedeemed:!1,keyOffset:(0,t.verifyTruthy)(F.keyOffset),created_at:j,updated_at:j,commissionId:0});const V=a(I,O.transactionId,F.satoshis,F.vout);V.lockingScript=L,V.providedBy="storage",V.purpose="storage-commission",V.type="custom",V.spendable=!1,D.push({o:V,tags:[]})}else{const j=F.basket?C[F.basket].basketId:void 0,V=a(I,O.transactionId,F.satoshis,F.vout);V.lockingScript=L,V.basketId=j,V.customInstructions=F.customInstructions,V.outputDescription=F.outputDescription,V.providedBy=F.providedBy,V.purpose=F.purpose||"",V.type="custom",D.push({o:V,tags:F.tags})}}for(const F of A)F.spendable=!0,D.push({o:F,tags:[]});if(k.options.randomizeOutputs){const F=[],L=()=>{let q=0;return!F||F.length===0?q=Math.random():(q=F.shift()||0,F.push(q)),q},j=q=>{let $=q.length,Y,Q;for(;$!==0;)Q=Math.floor(L()*$),$-=1,Y=q[$],q[$]=q[Q],q[Q]=Y;return q};let V=-1;const W=Array(D.length);for(let q=0;q<W.length;q++)W[q]=q;j(W);for(const q of D){if(V++,q.o.vout!==V)throw new t.sdk.WERR_INTERNAL(`new output ${V} has out of order vout ${q.o.vout}`);q.o.vout=W[V]}}const U=[];for(const{o:F,tags:L}of D){F.outputId=await T.insertOutput(F),F.change&&F.purpose==="change"&&F.providedBy==="storage"&&U.push(F.vout);for(const V of L){const W=N[V];await T.findOrInsertOutputTagMap((0,t.verifyId)(F.outputId),(0,t.verifyId)(W.outputTagId))}const j={vout:(0,t.verifyInteger)(F.vout),satoshis:(0,t.verifyTruthy)(F.satoshis),lockingScript:F.lockingScript?(0,t.asString)(F.lockingScript):"",providedBy:(0,t.verifyTruthy)(F.providedBy),purpose:F.purpose||void 0,basket:(R=Object.values(C).find(V=>V.basketId===F.basketId))===null||R===void 0?void 0:R.name,tags:L,outputDescription:F.outputDescription,derivationSuffix:F.derivationSuffix,customInstructions:F.customInstructions};P.push(j)}return{outputs:P,changeVouts:U}}async function n(T,I,k,O){const A=new Date,R={created_at:A,updated_at:A,transactionId:0,version:k.version,lockTime:k.lockTime,status:"unsigned",reference:(0,t.randomBytesBase64)(12),satoshis:0,userId:I,isOutgoing:!0,inputBEEF:O.toBinary(),description:k.description,txid:void 0,rawTx:void 0};R.transactionId=await T.insertTransaction(R);for(const P of k.labels){const C=await T.findOrInsertTxLabel(I,P);await T.findOrInsertTxLabelMap((0,t.verifyId)(R.transactionId),(0,t.verifyId)(C.txLabelId))}return R}function c(T,I,k){const O=[];let A=-1;for(const R of k.outputs){A++;const P={...R,vout:A,providedBy:"you",purpose:void 0,derivationSuffix:void 0,keyOffset:void 0};O.push(P)}if(T.commissionSatoshis>0&&T.commissionPubKeyHex){A++;const{script:R,keyOffset:P}=S(T.commissionPubKeyHex);O.push({lockingScript:R,satoshis:T.commissionSatoshis,outputDescription:"Storage Service Charge",basket:void 0,tags:[],vout:A,providedBy:"storage",purpose:"service-charge",keyOffset:P})}return O}async function d(T,I,k){const O=new s.Beef;if(k.inputs.length===0)return{storageBeef:O,beef:O,xinputs:[]};k.inputBEEF&&O.mergeBeef(k.inputBEEF);const A=k.inputs.map((N,D)=>({...N,vin:D,satoshis:-1,lockingScript:new s.Script})),R=k.options.trustSelf==="known",P={};for(const N of A)P[N.outpoint.txid]=!0;for(const N of O.txs)if(N.isTxidOnly){if(!R)throw new t.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain complete proof data for ${N.txid}`);if(!P[N.txid]&&!await T.verifyKnownValidTransaction(N.txid))throw new t.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain complete proof data for unknown ${N.txid}`)}for(const N of Object.keys(P)){let D=O.findTxid(N);if(!D&&R&&await T.verifyKnownValidTransaction(N)&&(D=O.mergeTxidOnly(N)),!D)throw new t.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain proof data for possibly known ${N}`)}if(!await O.verify(await T.getServices().getChainTracker(),!0))throw console.log(`verifyInputBeef failed, inputBEEF failed to verify.
${O.toLogString()}
`),new t.sdk.WERR_INVALID_PARAMETER("inputBEEF","valid Beef when factoring options.trustSelf");const C=O.clone();for(const N of A){const{txid:D,vout:U}=N.outpoint,F=(0,t.verifyOneOrNone)(await T.findOutputs({partial:{userId:I,txid:D,vout:U}}));if(F){if(N.output=F,!Array.isArray(F.lockingScript)||!Number.isInteger(F.satoshis))throw new t.sdk.WERR_INVALID_PARAMETER(`${D}.${U}`,"output with valid lockingScript and satoshis");if(!r&&!F.spendable&&!k.isNoSend)throw new t.sdk.WERR_INVALID_PARAMETER(`${D}.${U}`,"spendable output unless noSend is true");N.satoshis=(0,t.verifyNumber)(F.satoshis),N.lockingScript=s.Script.fromBinary((0,t.asArray)(F.lockingScript))}else{let L=O.findTxid(D);if(L.isTxidOnly){const{rawTx:V,proven:W}=await T.getProvenOrRawTx(D);if(!V)throw new t.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain proof data for ${D}`);L=O.mergeRawTx((0,t.asArray)(V)),W&&O.mergeBump(new t.EntityProvenTx(W).getMerklePath())}if(U>=L.tx.outputs.length)throw new t.sdk.WERR_INVALID_PARAMETER(`${D}.${U}`,"valid outpoint");const j=L.tx.outputs[U];N.satoshis=(0,t.verifyTruthy)(j.satoshis),N.lockingScript=j.lockingScript}}return{beef:O,storageBeef:C,xinputs:A}}async function y(T,I,k,O){const A=[];if(!k.isNoSend)return[];const R=k.options.noSendChange;if(R&&R.length>0)for(const P of R){const C=(0,t.verifyOneOrNone)(await T.findOutputs({partial:{userId:I,txid:P.txid,vout:P.vout}}));if(!C||C.providedBy!=="storage"||C.purpose!=="change"||C.spendable===!1||Number.isInteger(C.spentBy)||!(0,t.verifyNumber)(C.satoshis)||C.basketId!==O.basketId)throw new t.sdk.WERR_INVALID_PARAMETER("noSendChange outpoint","valid");if(-1<A.findIndex(N=>N.outputId===C.outputId))throw new t.sdk.WERR_INVALID_PARAMETER("noSendChange outpoint","unique. Duplicates are not allowed.");A.push(C)}return A}async function p(T,I,k,O){const A={fixedInputs:O.xinputs.map(W=>({satoshis:W.satoshis,unlockingScriptLength:W.unlockingScriptLength})),fixedOutputs:O.xoutputs.map(W=>({satoshis:W.satoshis,lockingScriptLength:W.lockingScript.length/2})),feeModel:O.feeModel,changeInitialSatoshis:O.changeBasket.minimumDesiredUTXOValue,changeFirstSatoshis:Math.max(1,Math.round(O.changeBasket.minimumDesiredUTXOValue/4)),changeLockingScriptLength:25,changeUnlockingScriptLength:107,targetNetCount:O.changeBasket.numberOfDesiredUTXOs-O.availableChangeCount,randomVals:k.randomVals},R=[...O.noSendChangeIn],P={},C=async(W,q)=>{if(R.length>0){const J=R.pop();return P[J.outputId]=J,await T.updateOutput(J.outputId,{spendable:!1,spentBy:O.transactionId}),J.spendable=!1,J.spentBy=O.transactionId,{outputId:J.outputId,satoshis:J.satoshis}}const $=O.changeBasket.basketId,Y=await T.allocateChangeInput(I,$,W,q,!k.isDelayed,O.transactionId);return Y?(P[Y.outputId]=Y,{outputId:Y.outputId,satoshis:Y.satoshis}):void 0},N=async W=>{const q=O.noSendChangeIn.find($=>$.outputId===W);if(q){R.push(q);return}await T.updateOutput(W,{spendable:!0,spentBy:void 0})},D=await(0,i.generateChangeSdk)(A,C,N),U=()=>{let W=0;return!k.randomVals||k.randomVals.length===0?W=Math.random():(W=k.randomVals.shift()||0,k.randomVals.push(W)),W},F=(W,q)=>Math.floor(U()*(q-W+1)+W),L=W=>{let q=[];if(!k.randomVals||k.randomVals.length===0)q=(0,s.Random)(W);else for(let $=0;$<W;$++)q.push(F(0,255));return s.Utils.toBase64(q)},j=L(16);return{maxPossibleSatoshisAdjustment:D.maxPossibleSatoshisAdjustment,allocatedChange:D.allocatedChangeInputs.map(W=>P[W.outputId]),changeOutputs:D.changeOutputs.map((W,q)=>({created_at:new Date,updated_at:new Date,outputId:0,userId:I,transactionId:O.transactionId,vout:A.fixedOutputs.length+q,satoshis:W.satoshis,basketId:O.changeBasket.basketId,spendable:!1,change:!0,type:"P2PKH",derivationPrefix:j,derivationSuffix:L(16),providedBy:"storage",purpose:"change",customInstructions:void 0,senderIdentityKey:void 0,outputDescription:"",txid:void 0,lockingScript:void 0,spentBy:void 0,spendingDescription:void 0})),derivationPrefix:j}}function g(T,I){if(I.options.returnTXIDOnly)return;const k={};for(const O of I.options.knownTxids)k[O]=!0;for(const O of T.txs.map(A=>A.txid))k[O]&&T.makeTxidOnly(O);return T.toBinary()}async function b(T,I,k,O,A){const R={trustSelf:void 0,knownTxids:k.options.knownTxids,mergeToBeef:A,ignoreStorage:!1,ignoreServices:!0,ignoreNewProven:!1,minProofLevel:void 0};if(!k.options.returnTXIDOnly){for(const P of O)!A.findTxid(P.txid)&&!k.options.knownTxids.find(C=>C===P.txid)&&await T.getBeefForTransaction(P.txid,R);return g(A,k)}}function w(T,I){let k;I!==void 0&&typeof I=="string"?I.length===64?k=s.PrivateKey.fromString(I,"hex"):k=s.PrivateKey.fromWif(I):(k=s.PrivateKey.fromRandom(),I=k.toWif());const O=T.mul(k).encode(!0,void 0),A=(0,t.sha256Hash)(O);return{hashedSecret:new s.BigNumber(A),keyOffset:I}}function v(T,I){const k=s.PublicKey.fromString(T),O=w(k,I),A=new s.Curve().g.mul(O.hashedSecret);return{offsetPubKey:new s.PublicKey(k.add(A)).toString(),keyOffset:O.keyOffset}}function _(T,I){const k=v(T,I),A=s.PublicKey.fromString(k.offsetPubKey).toHash();return{script:new s.P2PKH().lock(A).toHex(),keyOffset:k.keyOffset}}function S(T){return _(T)}return is}var up={},_4;function $D(){if(_4)return up;_4=1,Object.defineProperty(up,"__esModule",{value:!0}),up.internalizeAction=i;const s=ge(),t=se();async function i(e,o,a){const l=new r(e,o,a);return await l.asyncSetup(),l.isMerge?await l.mergedInternalize():await l.newInternalize(),l.r}class r{constructor(o,a,l){this.storage=o,this.auth=a,this.args=l,this.vargs=t.sdk.validateInternalizeActionArgs(l),this.userId=a.userId,this.r={accepted:!0,isMerge:!1,txid:"",satoshis:0},this.ab=new s.Beef,this.tx=new s.Transaction,this.changeBasket={},this.baskets={},this.basketInsertions=[],this.walletPayments=[],this.eos=[]}get isMerge(){return this.r.isMerge}set isMerge(o){this.r.isMerge=o}get txid(){return this.r.txid}set txid(o){this.r.txid=o}get satoshis(){return this.r.satoshis}set satoshis(o){this.r.satoshis=o}async getBasket(o){let a=this.baskets[o];return a||(a=await this.storage.findOrInsertOutputBasket(this.userId,o),this.baskets[o]=a,a)}async asyncSetup(){({ab:this.ab,tx:this.tx,txid:this.txid}=await this.validateAtomicBeef(this.args.tx));for(const o of this.args.outputs){if(o.outputIndex<0||o.outputIndex>=this.tx.outputs.length)throw new t.sdk.WERR_INVALID_PARAMETER("outputIndex",`a valid output index in range 0 to ${this.tx.outputs.length-1}`);const a=this.tx.outputs[o.outputIndex];switch(o.protocol){case"basket insertion":{if(!o.insertionRemittance||o.paymentRemittance)throw new t.sdk.WERR_INVALID_PARAMETER("basket insertion","valid insertionRemittance and no paymentRemittance");this.basketInsertions.push({...o.insertionRemittance,txo:a,vout:o.outputIndex})}break;case"wallet payment":{if(o.insertionRemittance||!o.paymentRemittance)throw new t.sdk.WERR_INVALID_PARAMETER("wallet payment","valid paymentRemittance and no insertionRemittance");this.walletPayments.push({...o.paymentRemittance,txo:a,vout:o.outputIndex,ignore:!1})}break;default:throw new t.sdk.WERR_INTERNAL(`unexpected protocol ${o.protocol}`)}}if(this.changeBasket=(0,t.verifyOne)(await this.storage.findOutputBaskets({partial:{userId:this.userId,name:"default"}})),this.baskets={},this.etx=(0,t.verifyOneOrNone)(await this.storage.findTransactions({partial:{userId:this.userId,txid:this.txid}})),this.etx&&!(this.etx.status=="completed"||this.etx.status==="unproven"||this.etx.status==="nosend"))throw new t.sdk.WERR_INVALID_PARAMETER("tx",`target transaction of internalizeAction has invalid status ${this.etx.status}.`);if(this.isMerge=!!this.etx,this.isMerge){this.eos=await this.storage.findOutputs({partial:{userId:this.userId,txid:this.txid}});for(const o of this.eos){const a=this.basketInsertions.find(f=>f.vout===o.vout),l=this.walletPayments.find(f=>f.vout===o.vout);if(a&&l)throw new t.sdk.WERR_INVALID_PARAMETER("outputs","unique outputIndex values");a&&(a.eo=o),l&&(l.eo=o)}}for(const o of this.basketInsertions)this.isMerge&&o.eo&&o.eo.basketId===this.changeBasket.basketId&&(this.satoshis-=o.txo.satoshis);for(const o of this.walletPayments)this.isMerge?o.eo?o.eo.basketId===this.changeBasket.basketId?o.ignore=!0:this.satoshis+=o.txo.satoshis:this.satoshis+=o.txo.satoshis:this.satoshis+=o.txo.satoshis}async validateAtomicBeef(o){const a=s.Beef.fromBinary(o);if(!await a.verify(await this.storage.getServices().getChainTracker(),!1)||!a.atomicTxid)throw new t.sdk.WERR_INVALID_PARAMETER("tx","valid AtomicBEEF");const f=a.atomicTxid,n=a.findTxid(f);if(!n)throw new t.sdk.WERR_INVALID_PARAMETER("tx",`valid AtomicBEEF with newest txid of ${f}`);const c=n.tx;return{ab:a,tx:c,txid:f}}async findOrInsertTargetTransaction(o,a){const l=new Date,f={created_at:l,updated_at:l,transactionId:0,status:a,satoshis:o,version:this.tx.version,lockTime:this.tx.lockTime,reference:(0,t.randomBytesBase64)(7),userId:this.userId,isOutgoing:!1,description:this.args.description,inputBEEF:void 0,txid:this.txid,rawTx:void 0},n=await this.storage.findOrInsertTransaction(f);if(!n.isNew){if(!this.isMerge)throw new t.sdk.WERR_INVALID_PARAMETER("tx","target transaction of internalizeAction is undergoing active changes.");await this.storage.updateTransaction(n.tx.transactionId,{satoshis:n.tx.satoshis+o})}return n.tx}async mergedInternalize(){const o=this.etx.transactionId;await this.addLabels(o);for(const a of this.walletPayments)a.eo&&!a.ignore?await this.mergeWalletPaymentForOutput(o,a):a.ignore||await this.storeNewWalletPaymentForOutput(o,a);for(const a of this.basketInsertions)a.eo?await this.mergeBasketInsertionForOutput(o,a):await this.storeNewBasketInsertionForOutput(o,a)}async newInternalize(){this.etx=await this.findOrInsertTargetTransaction(this.satoshis,"unproven");const o=this.etx.transactionId,a=t.EntityProvenTxReq.fromTxid(this.txid,this.tx.toBinary(),this.args.tx);a.status="unmined",a.addHistoryNote({what:"internalizeAction",userId:this.userId}),a.addNotifyTransactionId(o),await this.storage.getProvenOrReq(this.txid,a.toApi()),await this.addLabels(o);for(const l of this.walletPayments)await this.storeNewWalletPaymentForOutput(o,l);for(const l of this.basketInsertions)await this.storeNewBasketInsertionForOutput(o,l)}async addLabels(o){for(const a of this.vargs.labels){const l=await this.storage.findOrInsertTxLabel(this.userId,a);await this.storage.findOrInsertTxLabelMap((0,t.verifyId)(o),(0,t.verifyId)(l.txLabelId))}}async addBasketTags(o,a){for(const l of o.tags||[])await this.storage.tagOutput({outputId:a,userId:this.userId},l)}async storeNewWalletPaymentForOutput(o,a){const l=new Date,f={created_at:l,updated_at:l,outputId:0,transactionId:o,userId:this.userId,spendable:!0,lockingScript:a.txo.lockingScript.toBinary(),vout:a.vout,basketId:this.changeBasket.basketId,satoshis:a.txo.satoshis,txid:this.txid,senderIdentityKey:a.senderIdentityKey,type:"P2PKH",providedBy:"storage",purpose:"change",derivationPrefix:a.derivationPrefix,derivationSuffix:a.derivationSuffix,change:!0,spentBy:void 0,customInstructions:void 0,outputDescription:"",spendingDescription:void 0};f.outputId=await this.storage.insertOutput(f),a.eo=f}async mergeWalletPaymentForOutput(o,a){const l=a.eo.outputId,f={basketId:this.changeBasket.basketId,type:"P2PKH",customInstructions:void 0,change:!0,providedBy:"storage",purpose:"change",senderIdentityKey:a.senderIdentityKey,derivationPrefix:a.derivationPrefix,derivationSuffix:a.derivationSuffix};await this.storage.updateOutput(l,f),a.eo={...a.eo,...f}}async mergeBasketInsertionForOutput(o,a){const l=a.eo.outputId,f={basketId:(await this.getBasket(a.basket)).basketId,type:"custom",customInstructions:a.customInstructions,change:!1,providedBy:"you",purpose:"",senderIdentityKey:void 0,derivationPrefix:void 0,derivationSuffix:void 0};await this.storage.updateOutput(l,f),a.eo={...a.eo,...f}}async storeNewBasketInsertionForOutput(o,a){const l=new Date,f={created_at:l,updated_at:l,outputId:0,transactionId:o,userId:this.userId,spendable:!0,lockingScript:a.txo.lockingScript.toBinary(),vout:a.vout,basketId:(await this.getBasket(a.basket)).basketId,satoshis:a.txo.satoshis,txid:this.txid,type:"custom",customInstructions:a.customInstructions,change:!1,spentBy:void 0,outputDescription:"",spendingDescription:void 0,providedBy:"you",purpose:"",senderIdentityKey:void 0,derivationPrefix:void 0,derivationSuffix:void 0};f.outputId=await this.storage.insertOutput(f),await this.addBasketTags(a,f.outputId),a.eo=f}}return up}var Vl={},Js={},Hc={},S4;function zD(){if(S4)return Hc;S4=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.EntityBase=void 0,Hc.createSyncMap=t;let s=class{constructor(r){this.api=r}toApi(){return this.updateApi(),this.api}};Hc.EntityBase=s;function t(){return{provenTx:{entityName:"provenTx",idMap:{},maxUpdated_at:void 0,count:0},outputBasket:{entityName:"outputBasket",idMap:{},maxUpdated_at:void 0,count:0},transaction:{entityName:"transaction",idMap:{},maxUpdated_at:void 0,count:0},provenTxReq:{entityName:"provenTxReq",idMap:{},maxUpdated_at:void 0,count:0},txLabel:{entityName:"txLabel",idMap:{},maxUpdated_at:void 0,count:0},txLabelMap:{entityName:"txLabelMap",idMap:{},maxUpdated_at:void 0,count:0},output:{entityName:"output",idMap:{},maxUpdated_at:void 0,count:0},outputTag:{entityName:"outputTag",idMap:{},maxUpdated_at:void 0,count:0},outputTagMap:{entityName:"outputTagMap",idMap:{},maxUpdated_at:void 0,count:0},certificate:{entityName:"certificate",idMap:{},maxUpdated_at:void 0,count:0},certificateField:{entityName:"certificateField",idMap:{},maxUpdated_at:void 0,count:0},commission:{entityName:"commission",idMap:{},maxUpdated_at:void 0,count:0}}}return Hc}var Wl={},T4;function XD(){if(T4)return Wl;T4=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.EntitySyncState=void 0;const s=gi(),t=se();let i=class cr extends s.EntityBase{constructor(e){const o=new Date;super(e||{syncStateId:0,created_at:o,updated_at:o,userId:0,storageIdentityKey:"",storageName:"",init:!1,refNum:"",status:"unknown",when:void 0,errorLocal:void 0,errorOther:void 0,satoshis:void 0,syncMap:JSON.stringify((0,s.createSyncMap)())}),this.errorLocal=this.api.errorLocal?JSON.parse(this.api.errorLocal):void 0,this.errorOther=this.api.errorOther?JSON.parse(this.api.errorOther):void 0,this.syncMap=JSON.parse(this.api.syncMap),this.validateSyncMap(this.syncMap)}validateSyncMap(e){for(const o of Object.keys(e)){const a=e[o];typeof a.maxUpdated_at=="string"&&(a.maxUpdated_at=new Date(a.maxUpdated_at))}}static async fromStorage(e,o,a){const{user:l}=(0,t.verifyTruthy)(await e.findOrInsertUser(o));let{syncState:f}=(0,t.verifyTruthy)(await e.findOrInsertSyncStateAuth({userId:l.userId,identityKey:o},a.storageIdentityKey,a.storageName));return(!f.syncMap||f.syncMap==="{}")&&(f.syncMap=JSON.stringify((0,s.createSyncMap)())),new cr(f)}async updateStorage(e,o,a){if(this.updated_at=new Date,this.updateApi(o&&this.id>0),this.id===0)await e.insertSyncState(this.api);else{const l={...this.api};o&&delete l.syncMap,delete l.created_at,await e.updateSyncState((0,t.verifyId)(this.id),l,a)}}updateApi(e){this.api.errorLocal=this.apiErrorLocal,this.api.errorOther=this.apiErrorOther,e||(this.api.syncMap=this.apiSyncMap)}set created_at(e){this.api.created_at=e}get created_at(){return this.api.created_at}set updated_at(e){this.api.updated_at=e}get updated_at(){return this.api.updated_at}set userId(e){this.api.userId=e}get userId(){return this.api.userId}set storageIdentityKey(e){this.api.storageIdentityKey=e}get storageIdentityKey(){return this.api.storageIdentityKey}set storageName(e){this.api.storageName=e}get storageName(){return this.api.storageName}set init(e){this.api.init=e}get init(){return this.api.init}set refNum(e){this.api.refNum=e}get refNum(){return this.api.refNum}set status(e){this.api.status=e}get status(){return this.api.status}set when(e){this.api.when=e}get when(){return this.api.when}set satoshis(e){this.api.satoshis=e}get satoshis(){return this.api.satoshis}get apiErrorLocal(){return this.errorToString(this.errorLocal)}get apiErrorOther(){return this.errorToString(this.errorOther)}get apiSyncMap(){return JSON.stringify(this.syncMap)}get id(){return this.api.syncStateId}set id(e){this.api.syncStateId=e}get entityName(){return"syncState"}get entityTable(){return"sync_states"}static mergeIdMap(e,o){for(const[a,l]of Object.entries(e)){const f=e[a],n=o[a];if(n!==void 0&&n!==f)throw new t.sdk.WERR_INVALID_PARAMETER("syncMap",`an unmapped id or the same mapped id. ${a} maps to ${n} not equal to ${f}`);n===void 0&&(o[a]=l)}}mergeSyncMap(e){cr.mergeIdMap(e.provenTx.idMap,this.syncMap.provenTx.idMap),cr.mergeIdMap(e.outputBasket.idMap,this.syncMap.outputBasket.idMap),cr.mergeIdMap(e.transaction.idMap,this.syncMap.transaction.idMap),cr.mergeIdMap(e.provenTxReq.idMap,this.syncMap.provenTxReq.idMap),cr.mergeIdMap(e.txLabel.idMap,this.syncMap.txLabel.idMap),cr.mergeIdMap(e.output.idMap,this.syncMap.output.idMap),cr.mergeIdMap(e.outputTag.idMap,this.syncMap.outputTag.idMap),cr.mergeIdMap(e.certificate.idMap,this.syncMap.certificate.idMap),cr.mergeIdMap(e.commission.idMap,this.syncMap.commission.idMap)}errorToString(e){if(!e)return;const o={code:e.code,description:e.description,stack:e.stack};return JSON.stringify(o)}equals(e,o){return!1}async mergeNew(e,o,a,l){}async mergeExisting(e,o,a,l,f){return!1}makeRequestSyncChunkArgs(e,o,a,l){const f={identityKey:e,maxRoughSize:a||1e7,maxItems:l||1e3,offsets:[],since:this.when,fromStorageIdentityKey:this.storageIdentityKey,toStorageIdentityKey:o};for(const n of[this.syncMap.provenTx,this.syncMap.outputBasket,this.syncMap.outputTag,this.syncMap.txLabel,this.syncMap.transaction,this.syncMap.output,this.syncMap.txLabelMap,this.syncMap.outputTagMap,this.syncMap.certificate,this.syncMap.certificateField,this.syncMap.commission,this.syncMap.provenTxReq]){if(!n||!n.entityName)debugger;f.offsets.push({name:n.entityName,offset:n.count})}return f}static syncChunkSummary(e){let o="";if(o+=`SYNC CHUNK SUMMARY
  from storage: ${e.fromStorageIdentityKey}
  to storage: ${e.toStorageIdentityKey}
  for user: ${e.userIdentityKey}
`,e.user&&(o+=`  USER activeStorage ${e.user.activeStorage}
`),e.provenTxs){o+=`  PROVEN_TXS
`;for(const a of e.provenTxs)o+=`    ${a.provenTxId} ${a.txid}
`}if(e.provenTxReqs){o+=`  PROVEN_TX_REQS
`;for(const a of e.provenTxReqs)o+=`    ${a.provenTxReqId} ${a.txid} ${a.status} ${a.provenTxId||""}
`}if(e.transactions){o+=`  TRANSACTIONS
`;for(const a of e.transactions)o+=`    ${a.transactionId} ${a.txid} ${a.status} ${a.provenTxId||""} sats:${a.satoshis}
`}if(e.outputs){o+=`  OUTPUTS
`;for(const a of e.outputs)o+=`    ${a.outputId} ${a.txid}.${a.vout} ${a.transactionId} ${a.spendable?"spendable":""} sats:${a.satoshis}
`}return o}async processSyncChunk(e,o,a){var l;const f=[new s.MergeEntity(a.provenTxs,s.EntityProvenTx.mergeFind,this.syncMap.provenTx),new s.MergeEntity(a.outputBaskets,s.EntityOutputBasket.mergeFind,this.syncMap.outputBasket),new s.MergeEntity(a.outputTags,s.EntityOutputTag.mergeFind,this.syncMap.outputTag),new s.MergeEntity(a.txLabels,s.EntityTxLabel.mergeFind,this.syncMap.txLabel),new s.MergeEntity(a.transactions,s.EntityTransaction.mergeFind,this.syncMap.transaction),new s.MergeEntity(a.outputs,s.EntityOutput.mergeFind,this.syncMap.output),new s.MergeEntity(a.txLabelMaps,s.EntityTxLabelMap.mergeFind,this.syncMap.txLabelMap),new s.MergeEntity(a.outputTagMaps,s.EntityOutputTagMap.mergeFind,this.syncMap.outputTagMap),new s.MergeEntity(a.certificates,s.EntityCertificate.mergeFind,this.syncMap.certificate),new s.MergeEntity(a.certificateFields,s.EntityCertificateField.mergeFind,this.syncMap.certificateField),new s.MergeEntity(a.commissions,s.EntityCommission.mergeFind,this.syncMap.commission),new s.MergeEntity(a.provenTxReqs,s.EntityProvenTxReq.mergeFind,this.syncMap.provenTxReq)];let n=0,c=0,d,y=!0;if(a.user){const p=a.user,{found:g,eo:b}=await s.EntityUser.mergeFind(e,this.userId,p);g&&await b.mergeExisting(e,o.since,p)&&(d=(0,t.maxDate)(d,p.updated_at),n++)}for(const p of f){const g=await p.merge(o.since,e,this.userId,this.syncMap);p.esm.count+=((l=p.stateArray)===null||l===void 0?void 0:l.length)||0,n+=g.updates,c+=g.inserts,d=(0,t.maxDate)(d,p.esm.maxUpdated_at),(p.stateArray===void 0||p.stateArray.length>0)&&(y=!1)}if(y){this.when=d;for(const p of f)p.esm.count=0}return await this.updateStorage(e,!1),{done:y,maxUpdated_at:d,updates:n,inserts:c}}};return Wl.EntitySyncState=i,Wl}var $l={},I4;function GD(){if(I4)return $l;I4=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.EntityProvenTx=void 0;const s=ge(),t=se(),i=gi();let r=class mo extends i.EntityBase{static async fromTxid(o,a,l){var f;const n={proven:void 0,rawTx:l};if(a.chain,!n.rawTx){const d=await a.getRawTx(o);if(!(d!=null&&d.rawTx))return n;n.rawTx=d.rawTx}const c=await a.getMerklePath(o);if(c.merklePath&&c.header){const d=(f=c.merklePath.path[0].find(y=>y.hash===o))===null||f===void 0?void 0:f.offset;if(d!==void 0){const y={created_at:new Date,updated_at:new Date,provenTxId:0,txid:o,height:c.header.height,index:d,merklePath:c.merklePath.toBinary(),rawTx:n.rawTx,blockHash:c.header.hash,merkleRoot:c.header.merkleRoot};n.proven=new mo(y)}}return n}constructor(o){const a=new Date;super(o||{provenTxId:0,created_at:a,updated_at:a,txid:"",height:0,index:0,merklePath:[],rawTx:[],blockHash:"",merkleRoot:""})}updateApi(){}getMerklePath(){return this._mp||(this._mp=s.MerklePath.fromBinary(this.api.merklePath)),this._mp}get provenTxId(){return this.api.provenTxId}set provenTxId(o){this.api.provenTxId=o}get created_at(){return this.api.created_at}set created_at(o){this.api.created_at=o}get updated_at(){return this.api.updated_at}set updated_at(o){this.api.updated_at=o}get txid(){return this.api.txid}set txid(o){this.api.txid=o}get height(){return this.api.height}set height(o){this.api.height=o}get index(){return this.api.index}set index(o){this.api.index=o}get merklePath(){return this.api.merklePath}set merklePath(o){this.api.merklePath=o}get rawTx(){return this.api.rawTx}set rawTx(o){this.api.rawTx=o}get blockHash(){return this.api.blockHash}set blockHash(o){this.api.blockHash=o}get merkleRoot(){return this.api.merkleRoot}set merkleRoot(o){this.api.merkleRoot=o}get id(){return this.api.provenTxId}set id(o){this.api.provenTxId=o}get entityName(){return"provenTx"}get entityTable(){return"proven_txs"}equals(o,a){const l=this.toApi();if(l.txid!=o.txid||l.height!=o.height||l.index!=o.index||!(0,t.arraysEqual)(l.merklePath,o.merklePath)||!(0,t.arraysEqual)(l.rawTx,o.rawTx)||l.blockHash!==o.blockHash||l.merkleRoot!==o.merkleRoot)return!1;if(a){if(l.provenTxId!==a.provenTx.idMap[o.provenTxId])return!1}else if(l.provenTxId!==o.provenTxId)return!1;return!0}static async mergeFind(o,a,l,f,n){const c=(0,t.verifyOneOrNone)(await o.findProvenTxs({partial:{txid:l.txid},trx:n}));return{found:!!c,eo:new mo(c||{...l}),eiId:(0,t.verifyId)(l.provenTxId)}}async mergeNew(o,a,l,f){this.provenTxId=0,this.provenTxId=await o.insertProvenTx(this.toApi(),f)}async mergeExisting(o,a,l,f,n){return!1}static async fromReq(o,a,l){if(!o.txid)throw new t.sdk.WERR_MISSING_PARAMETER("req.txid");if(!o.rawTx)throw new t.sdk.WERR_MISSING_PARAMETER("req.rawTx");if(!o.rawTx)throw new t.sdk.WERR_INTERNAL("rawTx must be valid");for(const n of a.notes||[])o.addHistoryNote(n,!0);if(!a.name&&!a.merklePath&&!a.error)return;if(!a.merklePath){if(o.created_at){const n=Date.now()-o.created_at.getTime(),c=Math.ceil(n<1?0:n/(1e3*60));if(o.attempts>mo.getProofAttemptsLimit&&c>mo.getProofMinutes){const d=mo.getProofAttemptsLimit,{attempts:y}=o;o.addHistoryNote({what:"getMerklePathGiveUp",attempts:y,limit:d,ageInMinutes:c},!0),o.notified=!1,o.status="invalid"}}return}l&&o.attempts++;const f=Array.isArray(a.merklePath)?a.merklePath:[a.merklePath];for(const n of f)try{const c=new Date,d=n.path[0].find(p=>p.txid===!0&&p.hash===o.txid);if(!d)throw o.addHistoryNote({what:"getMerklePathTxidNotFound"},!0),new t.sdk.WERR_INTERNAL("merkle path does not contain leaf for txid");return new mo({created_at:c,updated_at:c,provenTxId:0,txid:o.txid,height:n.blockHeight,index:d.offset,merklePath:n.toBinary(),rawTx:o.rawTx,merkleRoot:a.header.merkleRoot,blockHash:a.header.hash})}catch(c){const{code:d,description:y}=t.sdk.WalletError.fromUnknown(c),{attempts:p}=o;o.addHistoryNote({what:"getMerklePathProvenError",attempts:p,code:d,description:y},!0)}}};return $l.EntityProvenTx=r,r.getProofAttemptsLimit=8,r.getProofMinutes=60,$l}var zl={},k4;function YD(){if(k4)return zl;k4=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.EntityProvenTxReq=void 0;const s=se(),t=gi();let i=class ma extends t.EntityBase{static async fromStorageTxid(e,o,a){const l=(0,s.verifyOneOrNone)(await e.findProvenTxReqs({partial:{txid:o},trx:a}));if(l)return new ma(l)}static async fromStorageId(e,o,a){const l=(0,s.verifyOneOrNone)(await e.findProvenTxReqs({partial:{provenTxReqId:o},trx:a}));if(!l)throw new s.sdk.WERR_INTERNAL(`proven_tx_reqs with id ${o} is missing.`);return new ma(l)}static fromTxid(e,o,a){const l=new Date;return new ma({provenTxReqId:0,created_at:l,updated_at:l,txid:e,inputBEEF:a,rawTx:o,status:"unknown",history:"{}",notify:"{}",attempts:0,notified:!1})}packApiHistory(){this.api.history=JSON.stringify(this.history)}packApiNotify(){this.api.notify=JSON.stringify(this.notify)}unpackApiHistory(){this.history=JSON.parse(this.api.history)}unpackApiNotify(){this.notify=JSON.parse(this.api.notify)}get apiHistory(){return this.packApiHistory(),this.api.history}get apiNotify(){return this.packApiNotify(),this.api.notify}set apiHistory(e){this.api.history=e,this.unpackApiHistory()}set apiNotify(e){this.api.notify=e,this.unpackApiNotify()}updateApi(){this.packApiHistory(),this.packApiNotify()}unpackApi(){if(this.unpackApiHistory(),this.unpackApiNotify(),this.notify.transactionIds){const e=[];for(const o of this.notify.transactionIds)Number.isInteger(o)&&!e.some(a=>a===o)&&e.push(o);this.notify.transactionIds=e}}async refreshFromStorage(e,o){const a=(0,s.verifyOne)(await e.findProvenTxReqs({partial:{provenTxReqId:this.id},trx:o}));this.api=a,this.unpackApi()}constructor(e){const o=new Date;super(e||{provenTxReqId:0,created_at:o,updated_at:o,txid:"",rawTx:[],history:"",notify:"",attempts:0,status:"unknown",notified:!1}),this.history={},this.notify={},this.unpackApi()}historySince(e){const o={notes:[]},a=e.toISOString(),l=this.history.notes;if(l&&o.notes)for(const f of l)f.when&&f.when>a&&o.notes.push(f);return o}historyPretty(e,o=0){const a=e?this.historySince(e):{...this.history};if(!a.notes)return"";const l=e?e.toISOString():void 0;let f="";for(const n of a.notes)l&&n.when&&n.when<l||(f+=this.prettyNote(n)+`
`);return f}prettyNote(e){let o=`${e.when}: ${e.what}`;for(const[a,l]of Object.entries(e))a!=="when"&&a!=="what"&&(typeof l=="string"?o+=" "+a+":`"+l+"`":o+=" "+a+":"+l);return o}getHistorySummary(){const e={setToCompleted:!1,setToUnmined:!1,setToCallback:!1,setToDoubleSpend:!1,setToSending:!1,setToUnconfirmed:!1},o=this.history;if(o.notes)for(const a of o.notes)this.parseHistoryNote(a,e);return e}parseHistoryNote(e,o){const a=o||{setToCompleted:!1,setToUnmined:!1,setToCallback:!1,setToDoubleSpend:!1,setToSending:!1,setToUnconfirmed:!1};let l=this.prettyNote(e);try{switch(e.what){case"status":switch(e.status_now){case"completed":a.setToCompleted=!0;break;case"unmined":a.setToUnmined=!0;break;case"callback":a.setToCallback=!0;break;case"doubleSpend":a.setToDoubleSpend=!0;break;case"sending":a.setToSending=!0;break;case"unconfirmed":a.setToUnconfirmed=!0;break;default:break}break;default:break}}catch{}return l}addNotifyTransactionId(e){if(!Number.isInteger(e))throw new s.sdk.WERR_INVALID_PARAMETER("id","integer");const o=new Set(this.notify.transactionIds||[]);o.add(e),this.notify.transactionIds=[...o].sort((a,l)=>a>l?1:a<l?-1:0),this.notified=!1}addHistoryNote(e,o){this.history.notes||(this.history.notes=[]),e.when||(e.when=new Date().toISOString()),o&&(this.history.notes=this.history.notes.filter(l=>l.what!==e.what||l.when&&l.when>e.when));let a=!0;for(const l of this.history.notes){let f=!0;for(const[n,c]of Object.entries(l))if(c!==e[n]){f=!1;break}if(f&&(a=!1),!a)break}if(a){this.history.notes.push(e);const l=f=>`${f.when} ${f.what}`;this.history.notes.sort((f,n)=>l(f)<l(n)?-1:l(f)>l(n)?1:0)}}async updateStorage(e,o){this.updated_at=new Date,this.updateApi(),this.id===0&&await e.insertProvenTxReq(this.api);const a={...this.api};await e.updateProvenTxReq(this.id,a,o)}async updateStorageDynamicProperties(e,o){this.updated_at=new Date,this.updateApi();const a={updated_at:this.api.updated_at,provenTxId:this.api.provenTxId,status:this.api.status,history:this.api.history,notify:this.api.notify,notified:this.api.notified,attempts:this.api.attempts,batch:this.api.batch};e.isStorageProvider()?await e.updateProvenTxReqDynamics(this.id,a,o):await e.runAsStorageProvider(async f=>{await f.updateProvenTxReqDynamics(this.id,a,o)})}async insertOrMerge(e,o){return await e.transaction(async l=>{let f=this.toApi();const{req:n,isNew:c}=await e.findOrInsertProvenTxReq(f,l);if(c)return new ma(n);{const d=new ma(n);return d.mergeNotifyTransactionIds(f),d.mergeHistory(f,void 0,!0),await d.updateStorage(e,l),d}},o)}get status(){return this.api.status}set status(e){e!==this.api.status&&(this.addHistoryNote({what:"status",status_was:this.api.status,status_now:e}),this.api.status=e)}get provenTxReqId(){return this.api.provenTxReqId}set provenTxReqId(e){this.api.provenTxReqId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get txid(){return this.api.txid}set txid(e){this.api.txid=e}get inputBEEF(){return this.api.inputBEEF}set inputBEEF(e){this.api.inputBEEF=e}get rawTx(){return this.api.rawTx}set rawTx(e){this.api.rawTx=e}get attempts(){return this.api.attempts}set attempts(e){this.api.attempts=e}get provenTxId(){return this.api.provenTxId}set provenTxId(e){this.api.provenTxId=e}get notified(){return this.api.notified}set notified(e){this.api.notified=e}get batch(){return this.api.batch}set batch(e){this.api.batch=e}get id(){return this.api.provenTxReqId}set id(e){this.api.provenTxReqId=e}get entityName(){return"provenTxReq"}get entityTable(){return"proven_tx_reqs"}equals(e,o){const a=this.toApi();if(a.txid!=e.txid||!(0,s.arraysEqual)(a.rawTx,e.rawTx)||!a.inputBEEF&&e.inputBEEF||a.inputBEEF&&!e.inputBEEF||a.inputBEEF&&e.inputBEEF&&!(0,s.arraysEqual)(a.inputBEEF,e.inputBEEF)||a.batch!=e.batch)return!1;if(o){if(a.provenTxReqId!==o.provenTxReq.idMap[(0,s.verifyId)(e.provenTxReqId)]||!a.provenTxId&&e.provenTxId||a.provenTxId&&!e.provenTxId||e.provenTxId&&a.provenTxId!==o.provenTx.idMap[e.provenTxId])return!1}else if(a.attempts!=e.attempts||a.history!=e.history||a.notify!=e.notify||a.provenTxReqId!==e.provenTxReqId||a.provenTxId!==e.provenTxId)return!1;return!0}static async mergeFind(e,o,a,l,f){const n=(0,s.verifyOneOrNone)(await e.findProvenTxReqs({partial:{txid:a.txid},trx:f}));return{found:!!n,eo:new ma(n||{...a}),eiId:(0,s.verifyId)(a.provenTxReqId)}}mapNotifyTransactionIds(e){const o=this.notify.transactionIds||[];this.notify.transactionIds=[];for(const a of o){const l=e.transaction.idMap[a];l&&this.addNotifyTransactionId(l)}}mergeNotifyTransactionIds(e,o){var a;const l=new ma(e);if(l.notify.transactionIds){(a=this.notify).transactionIds||(a.transactionIds=[]);for(const f of l.notify.transactionIds){const n=o?o.transaction.idMap[f]:f;n&&this.addNotifyTransactionId(n)}}}mergeHistory(e,o,a){const l=new ma(e);if(l.history.notes)for(const f of l.history.notes)this.addHistoryNote(f)}static isTerminalStatus(e){return s.sdk.ProvenTxReqTerminalStatus.some(o=>o===e)}async mergeNew(e,o,a,l){this.provenTxId&&(this.provenTxId=a.provenTx.idMap[this.provenTxId]),this.mapNotifyTransactionIds(a),this.provenTxReqId=0,this.provenTxReqId=await e.insertProvenTxReq(this.toApi(),l)}async mergeExisting(e,o,a,l,f){if(!this.batch&&a.batch)this.batch=a.batch;else if(this.batch&&a.batch&&this.batch!==a.batch)throw new s.sdk.WERR_INTERNAL("ProvenTxReq merge batch not equal.");return this.mergeHistory(a,l,!0),this.mergeNotifyTransactionIds(a,l),this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateProvenTxReq(this.id,this.toApi(),f),!1}};return zl.EntityProvenTxReq=i,zl}var Xl={},E4;function QD(){if(E4)return Xl;E4=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.MergeEntity=void 0;const s=se();let t=class{constructor(r,e,o){this.stateArray=r,this.find=e,this.esm=o,this.idMap=o.idMap}updateSyncMap(r,e,o){const a=(0,s.verifyId)(e),l=(0,s.verifyId)(o);if(r[a]===void 0)r[a]=l;else if(r[a]!==l)throw new s.sdk.WERR_INTERNAL(`updateSyncMap map[${e}] can't override ${r[a]} with ${l}`)}async merge(r,e,o,a,l){let f=0,n=0;if(!this.stateArray)return{inserts:f,updates:n};for(const c of this.stateArray){this.esm.maxUpdated_at=(0,s.maxDate)(this.esm.maxUpdated_at,c.updated_at);try{const{found:d,eo:y,eiId:p}=await this.find(e,o,c,a,l);d?await y.mergeExisting(e,r,c,a,l)&&n++:(await y.mergeNew(e,o,a,l),f++),p>-1&&this.updateSyncMap(this.idMap,p,y.id)}catch(d){throw d}}return{inserts:f,updates:n}}};return Xl.MergeEntity=t,Xl}var Gl={},O4;function ZD(){if(O4)return Gl;O4=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.EntityOutputBasket=void 0;const s=se(),t=gi();let i=class VI extends t.EntityBase{constructor(e){const o=new Date;super(e||{basketId:0,created_at:o,updated_at:o,userId:0,name:"",numberOfDesiredUTXOs:0,minimumDesiredUTXOValue:0,isDeleted:!1})}get basketId(){return this.api.basketId}set basketId(e){this.api.basketId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get name(){return this.api.name}set name(e){this.api.name=e}get numberOfDesiredUTXOs(){return this.api.numberOfDesiredUTXOs}set numberOfDesiredUTXOs(e){this.api.numberOfDesiredUTXOs=e}get minimumDesiredUTXOValue(){return this.api.minimumDesiredUTXOValue}set minimumDesiredUTXOValue(e){this.api.minimumDesiredUTXOValue=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){return this.api.basketId}set id(e){this.api.basketId=e}get entityName(){return"outputBasket"}get entityTable(){return"output_baskets"}updateApi(){}equals(e,o){const a=this.api;if(a.name!=e.name||a.numberOfDesiredUTXOs!=e.numberOfDesiredUTXOs||a.minimumDesiredUTXOValue!=e.minimumDesiredUTXOValue)return!1;if(o){if(a.basketId!==o.outputBasket.idMap[(0,s.verifyId)(e.basketId)])return!1}else if(a.basketId!==e.basketId||a.userId!==e.userId)return!1;return!0}static async mergeFind(e,o,a,l,f){const n=(0,s.verifyOneOrNone)(await e.findOutputBaskets({partial:{name:a.name,userId:o},trx:f}));return{found:!!n,eo:new VI(n||{...a}),eiId:(0,s.verifyId)(a.basketId)}}async mergeNew(e,o,a,l){this.userId=o,this.name||(this.name="default"),this.basketId=0,this.basketId=await e.insertOutputBasket(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.minimumDesiredUTXOValue=a.minimumDesiredUTXOValue,this.numberOfDesiredUTXOs=a.numberOfDesiredUTXOs,this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateOutputBasket(this.id,this.toApi(),f),n=!0),n}};return Gl.EntityOutputBasket=i,Gl}var Yl={},A4;function JD(){if(A4)return Yl;A4=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.EntityUser=void 0;const s=se(),t=gi();let i=class WI extends t.EntityBase{constructor(e){const o=new Date;super(e||{userId:0,created_at:o,updated_at:o,identityKey:"",activeStorage:""})}updateApi(){}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get identityKey(){return this.api.identityKey}set identityKey(e){this.api.identityKey=e}get activeStorage(){return this.api.activeStorage}set activeStorage(e){this.api.activeStorage=e}get id(){return this.api.userId}set id(e){this.api.userId=e}get entityName(){return"user"}get entityTable(){return"users"}equals(e,o){const a=this.toApi();return!(a.identityKey!=e.identityKey||a.activeStorage!=e.activeStorage)}static async mergeFind(e,o,a,l){const f=(0,s.verifyOneOrNone)(await e.findUsers({partial:{identityKey:a.identityKey},trx:l}));if(f&&f.userId!=o)throw new s.sdk.WERR_INTERNAL("logic error, userIds don not match.");return{found:!!f,eo:new WI(f||{...a}),eiId:(0,s.verifyId)(a.userId)}}async mergeNew(e,o,a,l){throw new s.sdk.WERR_INTERNAL("a sync chunk merge must never create a new user")}async mergeExisting(e,o,a,l,f){let n=!1;return(a.updated_at>this.updated_at||this.activeStorage===void 0&&a.activeStorage!==void 0)&&(this.activeStorage=a.activeStorage,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateUser(this.id,this.toApi(),f),n=!0),n}};return Yl.EntityUser=i,Yl}var Ql={},P4;function tB(){if(P4)return Ql;P4=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.EntityTxLabelMap=void 0;const s=se(),t=gi();let i=class $I extends t.EntityBase{constructor(e){const o=new Date;super(e||{created_at:o,updated_at:o,transactionId:0,txLabelId:0,isDeleted:!1})}updateApi(){}get txLabelId(){return this.api.txLabelId}set txLabelId(e){this.api.txLabelId=e}get transactionId(){return this.api.transactionId}set transactionId(e){this.api.transactionId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){throw new s.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"txLabelMap"}get entityTable(){return"tx_labels_map"}equals(e,o){const a=this.toApi();return!(a.transactionId!==(o?o.transaction.idMap[(0,s.verifyId)(e.transactionId)]:e.transactionId)||a.txLabelId!==(o?o.txLabel.idMap[(0,s.verifyId)(e.txLabelId)]:e.txLabelId)||a.isDeleted!==e.isDeleted)}static async mergeFind(e,o,a,l,f){const n=l.transaction.idMap[a.transactionId],c=l.txLabel.idMap[a.txLabelId],d=(0,s.verifyOneOrNone)(await e.findTxLabelMaps({partial:{transactionId:n,txLabelId:c},trx:f}));return{found:!!d,eo:new $I(d||{...a}),eiId:-1}}async mergeNew(e,o,a,l){this.transactionId=a.transaction.idMap[this.transactionId],this.txLabelId=a.txLabel.idMap[this.txLabelId],await e.insertTxLabelMap(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateTxLabelMap(this.transactionId,this.txLabelId,this.toApi(),f),n=!0),n}};return Ql.EntityTxLabelMap=i,Ql}var Zl={},R4;function eB(){if(R4)return Zl;R4=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.EntityTxLabel=void 0;const s=se(),t=gi();let i=class zI extends t.EntityBase{constructor(e){const o=new Date;super(e||{txLabelId:0,created_at:o,updated_at:o,label:"",userId:0,isDeleted:!1})}updateApi(){}get txLabelId(){return this.api.txLabelId}set txLabelId(e){this.api.txLabelId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get label(){return this.api.label}set label(e){this.api.label=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){return this.api.txLabelId}set id(e){this.api.txLabelId=e}get entityName(){return"txLabel"}get entityTable(){return"tx_labels"}equals(e,o){const a=this.toApi();return!(a.label!=e.label||a.isDeleted!=e.isDeleted||!o&&a.userId!==e.userId)}static async mergeFind(e,o,a,l,f){const n=(0,s.verifyOneOrNone)(await e.findTxLabels({partial:{label:a.label,userId:o},trx:f}));return{found:!!n,eo:new zI(n||{...a}),eiId:(0,s.verifyId)(a.txLabelId)}}async mergeNew(e,o,a,l){this.userId=o,this.txLabelId=0,this.txLabelId=await e.insertTxLabel(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateTxLabel(this.id,this.toApi(),f),n=!0),n}};return Zl.EntityTxLabel=i,Zl}var Jl={},M4;function iB(){if(M4)return Jl;M4=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.EntityOutputTag=void 0;const s=se(),t=gi();let i=class XI extends t.EntityBase{constructor(e){const o=new Date;super(e||{outputTagId:0,created_at:o,updated_at:o,tag:"",userId:0,isDeleted:!1})}updateApi(){}get outputTagId(){return this.api.outputTagId}set outputTagId(e){this.api.outputTagId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get tag(){return this.api.tag}set tag(e){this.api.tag=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){return this.api.outputTagId}set id(e){this.api.outputTagId=e}get entityName(){return"outputTag"}get entityTable(){return"output_tags"}equals(e,o){const a=this.toApi();return!(a.tag!=e.tag||a.isDeleted!=e.isDeleted||!o&&a.userId!==e.userId)}static async mergeFind(e,o,a,l,f){const n=(0,s.verifyOneOrNone)(await e.findOutputTags({partial:{tag:a.tag,userId:o},trx:f}));return{found:!!n,eo:new XI(n||{...a}),eiId:(0,s.verifyId)(a.outputTagId)}}async mergeNew(e,o,a,l){this.userId=o,this.outputTagId=0,this.outputTagId=await e.insertOutputTag(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateOutputTag(this.id,this.toApi(),f),n=!0),n}};return Jl.EntityOutputTag=i,Jl}var td={},N4;function nB(){if(N4)return td;N4=1,Object.defineProperty(td,"__esModule",{value:!0}),td.EntityOutputTagMap=void 0;const s=se(),t=gi();let i=class GI extends t.EntityBase{constructor(e){const o=new Date;super(e||{created_at:o,updated_at:o,outputId:0,outputTagId:0,isDeleted:!1})}updateApi(){}get outputTagId(){return this.api.outputTagId}set outputTagId(e){this.api.outputTagId=e}get outputId(){return this.api.outputId}set outputId(e){this.api.outputId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){throw new s.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"outputTagMap"}get entityTable(){return"output_tags_map"}equals(e,o){const a=this.toApi();return!(a.outputId!==(o?o.output.idMap[(0,s.verifyId)(e.outputId)]:e.outputId)||a.outputTagId!==(o?o.outputTag.idMap[(0,s.verifyId)(e.outputTagId)]:e.outputTagId)||a.isDeleted!==e.isDeleted)}static async mergeFind(e,o,a,l,f){const n=l.output.idMap[a.outputId],c=l.outputTag.idMap[a.outputTagId],d=(0,s.verifyOneOrNone)(await e.findOutputTagMaps({partial:{outputId:n,outputTagId:c},trx:f}));return{found:!!d,eo:new GI(d||{...a}),eiId:-1}}async mergeNew(e,o,a,l){this.outputId=a.output.idMap[this.outputId],this.outputTagId=a.outputTag.idMap[this.outputTagId],await e.insertOutputTagMap(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateOutputTagMap(this.outputId,this.outputTagId,this.toApi(),f),n=!0),n}};return td.EntityOutputTagMap=i,td}var ed={},C4;function rB(){if(C4)return ed;C4=1,Object.defineProperty(ed,"__esModule",{value:!0}),ed.EntityCommission=void 0;const s=se(),t=gi();let i=class YI extends t.EntityBase{constructor(e){const o=new Date;super(e||{commissionId:0,created_at:o,updated_at:o,transactionId:0,userId:0,isRedeemed:!1,keyOffset:"",lockingScript:[],satoshis:0})}updateApi(){}get commissionId(){return this.api.commissionId}set commissionId(e){this.api.commissionId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get transactionId(){return this.api.transactionId}set transactionId(e){this.api.transactionId=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get isRedeemed(){return this.api.isRedeemed}set isRedeemed(e){this.api.isRedeemed=e}get keyOffset(){return this.api.keyOffset}set keyOffset(e){this.api.keyOffset=e}get lockingScript(){return this.api.lockingScript}set lockingScript(e){this.api.lockingScript=e}get satoshis(){return this.api.satoshis}set satoshis(e){this.api.satoshis=e}get id(){return this.api.commissionId}set id(e){this.api.commissionId=e}get entityName(){return"commission"}get entityTable(){return"commissions"}equals(e,o){return!(this.isRedeemed!==e.isRedeemed||this.transactionId!==(o?o.transaction.idMap[e.transactionId]:e.transactionId)||this.keyOffset!==e.keyOffset||!(0,s.arraysEqual)(this.lockingScript,e.lockingScript)||this.satoshis!==e.satoshis)}static async mergeFind(e,o,a,l,f){const n=l.transaction.idMap[a.transactionId],c=(0,s.verifyOneOrNone)(await e.findCommissions({partial:{transactionId:n,userId:o},trx:f}));return{found:!!c,eo:new YI(c||{...a}),eiId:(0,s.verifyId)(a.commissionId)}}async mergeNew(e,o,a,l){this.transactionId&&(this.transactionId=a.transaction.idMap[this.transactionId]),this.userId=o,this.commissionId=0,this.commissionId=await e.insertCommission(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.isRedeemed=a.isRedeemed,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateCommission(this.id,this.toApi(),f),n=!0),n}};return ed.EntityCommission=i,ed}var id={},D4;function aB(){if(D4)return id;D4=1,Object.defineProperty(id,"__esModule",{value:!0}),id.EntityCertificate=void 0;const s=se(),t=gi();let i=class QI extends t.EntityBase{constructor(e){const o=new Date;super(e||{certificateId:0,created_at:o,updated_at:o,userId:0,type:"",subject:"",verifier:void 0,serialNumber:"",certifier:"",revocationOutpoint:"",signature:"",isDeleted:!1})}updateApi(){}get certificateId(){return this.api.certificateId}set certificateId(e){this.api.certificateId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get type(){return this.api.type}set type(e){this.api.type=e}get subject(){return this.api.subject}set subject(e){this.api.subject=e}get verifier(){return this.api.verifier}set verifier(e){this.api.verifier=e}get serialNumber(){return this.api.serialNumber}set serialNumber(e){this.api.serialNumber=e}get certifier(){return this.api.certifier}set certifier(e){this.api.certifier=e}get revocationOutpoint(){return this.api.revocationOutpoint}set revocationOutpoint(e){this.api.revocationOutpoint=e}get signature(){return this.api.signature}set signature(e){this.api.signature=e}get isDeleted(){return this.api.isDeleted}set isDeleted(e){this.api.isDeleted=e}get id(){return this.api.certificateId}set id(e){this.api.certificateId=e}get entityName(){return"certificate"}get entityTable(){return"certificates"}equals(e,o){return!(this.type!==e.type||this.subject!==e.subject||this.serialNumber!==e.serialNumber||this.revocationOutpoint!==e.revocationOutpoint||this.signature!==e.signature||this.verifier!==e.verifier||this.isDeleted!==e.isDeleted)}static async mergeFind(e,o,a,l,f){const n=(0,s.verifyOneOrNone)(await e.findCertificates({partial:{serialNumber:a.serialNumber,certifier:a.certifier,userId:o},trx:f}));return{found:!!n,eo:new QI(n||{...a}),eiId:(0,s.verifyId)(a.certificateId)}}async mergeNew(e,o,a,l){this.userId=o,this.certificateId=0,this.certificateId=await e.insertCertificate(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.type=a.type,this.subject=a.subject,this.serialNumber=a.serialNumber,this.revocationOutpoint=a.revocationOutpoint,this.signature=a.signature,this.verifier=a.verifier,this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateCertificate(this.id,this.toApi(),f),n=!0),n}};return id.EntityCertificate=i,id}var nd={},B4;function sB(){if(B4)return nd;B4=1,Object.defineProperty(nd,"__esModule",{value:!0}),nd.EntityCertificateField=void 0;const s=se(),t=gi();let i=class ZI extends t.EntityBase{constructor(e){const o=new Date;super(e||{created_at:o,updated_at:o,userId:0,certificateId:0,fieldName:"",fieldValue:"",masterKey:""})}updateApi(){}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get certificateId(){return this.api.certificateId}set certificateId(e){this.api.certificateId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get fieldName(){return this.api.fieldName}set fieldName(e){this.api.fieldName=e}get fieldValue(){return this.api.fieldValue}set fieldValue(e){this.api.fieldValue=e}get masterKey(){return this.api.masterKey}set masterKey(e){this.api.masterKey=e}get id(){throw new s.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"certificateField"}get entityTable(){return"certificate_fields"}equals(e,o){return!(this.certificateId!==(o?o.certificate.idMap[e.certificateId]:e.certificateId)||this.fieldName!==e.fieldName||this.fieldValue!==e.fieldValue||this.masterKey!==e.masterKey)}static async mergeFind(e,o,a,l,f){const n=l.certificate.idMap[a.certificateId],c=(0,s.verifyOneOrNone)(await e.findCertificateFields({partial:{certificateId:n,userId:o,fieldName:a.fieldName},trx:f}));return{found:!!c,eo:new ZI(c||{...a}),eiId:-1}}async mergeNew(e,o,a,l){this.certificateId=a.certificate.idMap[this.certificateId],this.userId=o,await e.insertCertificateField(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.fieldValue=a.fieldValue,this.masterKey=a.masterKey,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateCertificateField(this.certificateId,this.fieldName,this.toApi(),f),n=!0),n}};return nd.EntityCertificateField=i,nd}var rd={},F4;function oB(){if(F4)return rd;F4=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.EntityTransaction=void 0;const s=ge(),t=se(),i=gi();let r=class JI extends i.EntityBase{getBsvTx(){if(this.rawTx)return s.Transaction.fromBinary(this.rawTx)}getBsvTxIns(){const o=this.getBsvTx();return o?o.inputs:[]}async getInputs(o,a){const l=await o.findOutputs({partial:{userId:this.userId,spentBy:this.id},trx:a});for(const f of this.getBsvTxIns()){const n=(0,t.verifyOneOrNone)(await o.findOutputs({partial:{userId:this.userId,txid:f.sourceTXID,vout:f.sourceOutputIndex},trx:a}));n&&!l.some(c=>c.outputId===n.outputId)&&l.push(n)}return l}constructor(o){const a=new Date;super(o||{transactionId:0,created_at:a,updated_at:a,userId:0,txid:"",status:"unprocessed",reference:"",satoshis:0,description:"",isOutgoing:!1,rawTx:void 0,inputBEEF:void 0})}updateApi(){}get transactionId(){return this.api.transactionId}set transactionId(o){this.api.transactionId=o}get created_at(){return this.api.created_at}set created_at(o){this.api.created_at=o}get updated_at(){return this.api.updated_at}set updated_at(o){this.api.updated_at=o}get version(){return this.api.version}set version(o){this.api.version=o}get lockTime(){return this.api.lockTime}set lockTime(o){this.api.lockTime=o}get isOutgoing(){return this.api.isOutgoing}set isOutgoing(o){this.api.isOutgoing=o}get status(){return this.api.status}set status(o){this.api.status=o}get userId(){return this.api.userId}set userId(o){this.api.userId=o}get provenTxId(){return this.api.provenTxId}set provenTxId(o){this.api.provenTxId=o}get satoshis(){return this.api.satoshis}set satoshis(o){this.api.satoshis=o}get txid(){return this.api.txid}set txid(o){this.api.txid=o}get reference(){return this.api.reference}set reference(o){this.api.reference=o}get inputBEEF(){return this.api.inputBEEF}set inputBEEF(o){this.api.inputBEEF=o}get description(){return this.api.description}set description(o){this.api.description=o}get rawTx(){return this.api.rawTx}set rawTx(o){this.api.rawTx=o}get id(){return this.api.transactionId}set id(o){this.api.transactionId=o}get entityName(){return"transaction"}get entityTable(){return"transactions"}equals(o,a){const l=this.toApi();return!(l.transactionId!==(a?a.transaction.idMap[(0,t.verifyId)(o.transactionId)]:o.transactionId)||l.reference!==o.reference||l.version!==o.version||l.lockTime!==o.lockTime||l.isOutgoing!==o.isOutgoing||l.status!==o.status||l.satoshis!==o.satoshis||l.txid!==o.txid||l.description!==o.description||!(0,t.optionalArraysEqual)(l.rawTx,o.rawTx)||!(0,t.optionalArraysEqual)(l.inputBEEF,o.inputBEEF)||!l.provenTxId!=!o.provenTxId||o.provenTxId&&l.provenTxId!==(a?a.provenTx.idMap[(0,t.verifyId)(o.provenTxId)]:o.provenTxId))}static async mergeFind(o,a,l,f,n){const c=(0,t.verifyOneOrNone)(await o.findTransactions({partial:{reference:l.reference,userId:a},trx:n}));return{found:!!c,eo:new JI(c||{...l}),eiId:(0,t.verifyId)(l.transactionId)}}async mergeNew(o,a,l,f){this.provenTxId&&(this.provenTxId=l.provenTx.idMap[this.provenTxId]),this.userId=a,this.transactionId=0,this.transactionId=await o.insertTransaction(this.toApi(),f)}async mergeExisting(o,a,l,f,n){let c=!1;return l.updated_at>this.updated_at&&(this.version=l.version,this.lockTime=l.lockTime,this.isOutgoing=l.isOutgoing,this.status=l.status,this.provenTxId=l.provenTxId?f.provenTx.idMap[l.provenTxId]:void 0,this.satoshis=l.satoshis,this.txid=l.txid,this.description=l.description,this.rawTx=l.rawTx,this.inputBEEF=l.inputBEEF,this.updated_at=new Date(Math.max(l.updated_at.getTime(),this.updated_at.getTime())),await o.updateTransaction(this.id,this.toApi(),n),c=!0),c}async getProvenTx(o,a){if(!this.provenTxId)return;const l=(0,t.verifyOneOrNone)(await o.findProvenTxs({partial:{provenTxId:this.provenTxId},trx:a}));if(l)return new i.EntityProvenTx(l)}};return rd.EntityTransaction=r,rd}var ad={},L4;function cB(){if(L4)return ad;L4=1,Object.defineProperty(ad,"__esModule",{value:!0}),ad.EntityOutput=void 0;const s=se(),t=gi();let i=class tk extends t.EntityBase{constructor(e){const o=new Date;super(e||{outputId:0,created_at:o,updated_at:o,userId:0,transactionId:0,spendable:!1,change:!1,satoshis:0,outputDescription:"",vout:0,type:"",providedBy:"you",purpose:"",txid:void 0,basketId:void 0,spentBy:void 0,derivationPrefix:void 0,derivationSuffix:void 0,senderIdentityKey:void 0,customInstructions:void 0,spendingDescription:void 0,scriptLength:void 0,scriptOffset:void 0,lockingScript:void 0})}updateApi(){}get outputId(){return this.api.outputId}set outputId(e){this.api.outputId=e}get created_at(){return this.api.created_at}set created_at(e){this.api.created_at=e}get updated_at(){return this.api.updated_at}set updated_at(e){this.api.updated_at=e}get userId(){return this.api.userId}set userId(e){this.api.userId=e}get transactionId(){return this.api.transactionId}set transactionId(e){this.api.transactionId=e}get basketId(){return this.api.basketId}set basketId(e){this.api.basketId=e}get spentBy(){return this.api.spentBy}set spentBy(e){this.api.spentBy=e}get vout(){return this.api.vout}set vout(e){this.api.vout=e}get satoshis(){return this.api.satoshis}set satoshis(e){this.api.satoshis=e}get outputDescription(){return this.api.outputDescription}set outputDescription(e){this.api.outputDescription=e}get spendable(){return this.api.spendable}set spendable(e){this.api.spendable=e}get change(){return this.api.change}set change(e){this.api.change=e}get txid(){return this.api.txid}set txid(e){this.api.txid=e}get type(){return this.api.type}set type(e){this.api.type=e}get providedBy(){return this.api.providedBy}set providedBy(e){this.api.providedBy=e}get purpose(){return this.api.purpose}set purpose(e){this.api.purpose=e}get spendingDescription(){return this.api.spendingDescription}set spendingDescription(e){this.api.spendingDescription=e}get derivationPrefix(){return this.api.derivationPrefix}set derivationPrefix(e){this.api.derivationPrefix=e}get derivationSuffix(){return this.api.derivationSuffix}set derivationSuffix(e){this.api.derivationSuffix=e}get senderIdentityKey(){return this.api.senderIdentityKey}set senderIdentityKey(e){this.api.senderIdentityKey=e}get customInstructions(){return this.api.customInstructions}set customInstructions(e){this.api.customInstructions=e}get lockingScript(){return this.api.lockingScript}set lockingScript(e){this.api.lockingScript=e}get scriptLength(){return this.api.scriptLength}set scriptLength(e){this.api.scriptLength=e}get scriptOffset(){return this.api.scriptOffset}set scriptOffset(e){this.api.scriptOffset=e}get id(){return this.api.outputId}set id(e){this.api.outputId=e}get entityName(){return"output"}get entityTable(){return"outputs"}equals(e,o){return!(this.transactionId!==(o?o.transaction.idMap[e.transactionId]:e.transactionId)||this.basketId!==(o&&e.basketId?o.outputBasket.idMap[e.basketId]:e.basketId)||this.spentBy!==(o&&e.spentBy?o.transaction.idMap[e.spentBy]:e.spentBy)||this.vout!==e.vout||this.satoshis!==e.satoshis||this.spendable!==e.spendable||this.change!==e.change||this.txid!==e.txid||this.type!==e.type||this.providedBy!==e.providedBy||this.purpose!==e.purpose||this.outputDescription!==e.outputDescription||this.spendingDescription!==e.spendingDescription||this.derivationPrefix!==e.derivationPrefix||this.derivationSuffix!==e.derivationSuffix||this.senderIdentityKey!==e.senderIdentityKey||this.customInstructions!==e.customInstructions||!(0,s.optionalArraysEqual)(this.lockingScript,e.lockingScript)||this.scriptLength!==e.scriptLength||this.scriptOffset!==e.scriptOffset)}static async mergeFind(e,o,a,l,f){const n=l.transaction.idMap[a.transactionId];a.basketId&&l.outputBasket.idMap[a.basketId];const c=(0,s.verifyOneOrNone)(await e.findOutputs({partial:{userId:o,transactionId:n,vout:a.vout},trx:f}));return{found:!!c,eo:new tk(c||{...a}),eiId:(0,s.verifyId)(a.outputId)}}async mergeNew(e,o,a,l){this.userId=o,this.basketId=this.basketId?a.outputBasket.idMap[this.basketId]:void 0,this.transactionId=a.transaction.idMap[this.transactionId],this.spentBy=this.spentBy?a.transaction.idMap[this.spentBy]:void 0,this.outputId=0,this.outputId=await e.insertOutput(this.toApi(),l)}async mergeExisting(e,o,a,l,f){let n=!1;return a.updated_at>this.updated_at&&(this.spentBy=a.spentBy?l.transaction.idMap[a.spentBy]:void 0,this.spendable=a.spendable,this.change=a.change,this.type=a.type,this.providedBy=a.providedBy,this.purpose=a.purpose,this.outputDescription=a.outputDescription,this.spendingDescription=a.spendingDescription,this.senderIdentityKey=a.senderIdentityKey,this.customInstructions=a.customInstructions,this.scriptLength=a.scriptLength,this.scriptOffset=a.scriptOffset,this.lockingScript=a.lockingScript,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await e.updateOutput(this.id,this.toApi(),f),n=!0),n}};return ad.EntityOutput=i,ad}var U4;function gi(){return U4||(U4=1,function(s){var t=Js&&Js.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=Js&&Js.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(zD(),s),i(XD(),s),i(GD(),s),i(YD(),s),i(QD(),s),i(ZD(),s),i(JD(),s),i(tB(),s),i(eB(),s),i(iB(),s),i(nB(),s),i(rB(),s),i(aB(),s),i(sB(),s),i(oB(),s),i(cB(),s)}(Js)),Js}var sd={},lp={},q4;function uB(){if(q4)return lp;q4=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.getSyncChunk=t;const s=se();async function t(e,o){const a={fromStorageIdentityKey:o.fromStorageIdentityKey,toStorageIdentityKey:o.toStorageIdentityKey,userIdentityKey:o.identityKey};let l=o.maxItems,f=o.maxRoughSize,n=0,c=!1;const d=(0,s.verifyTruthy)(await e.findUserByIdentityKey(o.identityKey));(!o.since||d.updated_at>new Date(o.since))&&(a.user=d);const y=[{name:"provenTx",maxDivider:100,preAdd:()=>{a.provenTxs=[]},addItem:g=>{a.provenTxs.push(g)},findItems:async(g,b)=>await g.getProvenTxsForUser(b)},{name:"outputBasket",maxDivider:1,preAdd:()=>{a.outputBaskets=[]},addItem:g=>{a.outputBaskets.push(g)},findItems:async(g,b)=>await g.findOutputBaskets({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"outputTag",maxDivider:1,preAdd:()=>{a.outputTags=[]},addItem:g=>{a.outputTags.push(g)},findItems:async(g,b)=>await g.findOutputTags({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"txLabel",maxDivider:1,preAdd:()=>{a.txLabels=[]},addItem:g=>{a.txLabels.push(g)},findItems:async(g,b)=>await g.findTxLabels({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"transaction",maxDivider:25,preAdd:()=>{a.transactions=[]},addItem:g=>{a.transactions.push(g)},findItems:async(g,b)=>await g.findTransactions({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"output",maxDivider:25,preAdd:()=>{a.outputs=[]},addItem:g=>{a.outputs.push(g)},findItems:async(g,b)=>await g.findOutputs({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"txLabelMap",maxDivider:1,preAdd:()=>{a.txLabelMaps=[]},addItem:g=>{a.txLabelMaps.push(g)},findItems:async(g,b)=>await g.getTxLabelMapsForUser(b)},{name:"outputTagMap",maxDivider:1,preAdd:()=>{a.outputTagMaps=[]},addItem:g=>{a.outputTagMaps.push(g)},findItems:async(g,b)=>await g.getOutputTagMapsForUser(b)},{name:"certificate",maxDivider:25,preAdd:()=>{a.certificates=[]},addItem:g=>{a.certificates.push(g)},findItems:async(g,b)=>await g.findCertificates({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"certificateField",maxDivider:25,preAdd:()=>{a.certificateFields=[]},addItem:g=>{a.certificateFields.push(g)},findItems:async(g,b)=>await g.findCertificateFields({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"commission",maxDivider:25,preAdd:()=>{a.commissions=[]},addItem:g=>{a.commissions.push(g)},findItems:async(g,b)=>await g.findCommissions({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"provenTxReq",maxDivider:100,preAdd:()=>{a.provenTxReqs=[]},addItem:g=>{a.provenTxReqs.push(g)},findItems:async(g,b)=>await g.getProvenTxReqsForUser(b)}],p=async g=>{if(n>=o.offsets.length){c=!0;return}let{offset:b,name:w}=o.offsets[n++];if(g.name!==w)throw new s.sdk.WERR_INVALID_PARAMETER("offsets",`in dependency order. '${g.name}' expected, found ${w}.`);let v=!1;for(;!c;){const _=Math.min(l,Math.max(10,o.maxItems/g.maxDivider));if(_<=0)break;const S=await g.findItems(e,{userId:d.userId,since:o.since,paged:{limit:_,offset:b}});if(r(S),v||(g.preAdd(),v=!0),S.length===0)break;for(const T of S)if(b++,g.addItem(T),l--,f-=JSON.stringify(T).length,l<=0||f<0){c=!0;break}}};for(;!c;)for(const g of y)await p(g);return a}function i(e){if(!(e instanceof Date))throw new s.sdk.WERR_INVALID_OPERATION("bad date")}function r(e){for(const o of e){i(o.created_at),i(o.updated_at);for(const a of Object.keys(o))if(o[a]===null)throw new s.sdk.WERR_INVALID_OPERATION}}return lp}var j4;function lB(){if(j4)return sd;j4=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.StorageReader=void 0;const s=se(),t=uB();let i=class{get dbtype(){var e;return(e=this._settings)===null||e===void 0?void 0:e.dbtype}constructor(e){this.chain=e.chain}isAvailable(){return!!this._settings}async makeAvailable(){return this._settings?this._settings:this._settings=await this.readSettings()}getSettings(){if(!this._settings)throw new s.sdk.WERR_INVALID_OPERATION('must call "makeAvailable" before accessing "settings"');return this._settings}isStorageProvider(){return!1}async findUserByIdentityKey(e){return(0,s.verifyOneOrNone)(await this.findUsers({partial:{identityKey:e}}))}async getSyncChunk(e){return(0,t.getSyncChunk)(this,e)}validateEntityDate(e){if(!this.dbtype)throw new s.sdk.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");let o=this.validateDate(e);switch(this.dbtype){case"IndexedDB":case"MySQL":break;case"SQLite":o=o.toISOString();break;default:throw new s.sdk.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return o}validateOptionalEntityDate(e,o){if(!this.dbtype)throw new s.sdk.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");let a=this.validateOptionalDate(e);switch(!a&&o&&(a=new Date),this.dbtype){case"IndexedDB":case"MySQL":break;case"SQLite":a&&(a=a.toISOString());break;default:throw new s.sdk.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return a}validateDate(e){let o;return e instanceof Date?o=e:o=new Date(e),o}validateOptionalDate(e){if(e!=null)return this.validateDate(e)}validateDateForWhere(e){if(!this.dbtype)throw new s.sdk.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");typeof e=="number"&&(e=(0,s.validateSecondsSinceEpoch)(e));const o=(0,s.verifyTruthy)(this.validateDate(e));let a;switch(this.dbtype){case"IndexedDB":case"MySQL":a=o;break;case"SQLite":a=o.toISOString();break;default:throw new s.sdk.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return a}};return sd.StorageReader=i,sd}var H4;function dB(){if(H4)return Vl;H4=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.StorageReaderWriter=void 0;const s=se(),t=gi(),i=lB();let r=class extends i.StorageReader{constructor(o){super(o)}async setActive(o,a){return await this.updateUser((0,s.verifyId)(o.userId),{activeStorage:a})}async findCertificateById(o,a){return(0,s.verifyOneOrNone)(await this.findCertificates({partial:{certificateId:o},trx:a}))}async findCommissionById(o,a){return(0,s.verifyOneOrNone)(await this.findCommissions({partial:{commissionId:o},trx:a}))}async findOutputById(o,a,l){return(0,s.verifyOneOrNone)(await this.findOutputs({partial:{outputId:o},noScript:l,trx:a}))}async findOutputBasketById(o,a){return(0,s.verifyOneOrNone)(await this.findOutputBaskets({partial:{basketId:o},trx:a}))}async findProvenTxById(o,a){return(0,s.verifyOneOrNone)(await this.findProvenTxs({partial:{provenTxId:o},trx:a}))}async findProvenTxReqById(o,a){return(0,s.verifyOneOrNone)(await this.findProvenTxReqs({partial:{provenTxReqId:o},trx:a}))}async findSyncStateById(o,a){return(0,s.verifyOneOrNone)(await this.findSyncStates({partial:{syncStateId:o},trx:a}))}async findTransactionById(o,a,l){return(0,s.verifyOneOrNone)(await this.findTransactions({partial:{transactionId:o},noRawTx:l,trx:a}))}async findTxLabelById(o,a){return(0,s.verifyOneOrNone)(await this.findTxLabels({partial:{txLabelId:o},trx:a}))}async findOutputTagById(o,a){return(0,s.verifyOneOrNone)(await this.findOutputTags({partial:{outputTagId:o},trx:a}))}async findUserById(o,a){return(0,s.verifyOneOrNone)(await this.findUsers({partial:{userId:o},trx:a}))}async findOrInsertUser(o,a){let l,f=!1;for(let n=0;;n++)try{if(l=(0,s.verifyOneOrNone)(await this.findUsers({partial:{identityKey:o},trx:a})),l)break;const c=new Date;l={created_at:c,updated_at:new Date("1971-01-01"),userId:0,identityKey:o,activeStorage:this.getSettings().storageIdentityKey},l.userId=await this.insertUser(l,a),f=!0,await this.insertOutputBasket({created_at:c,updated_at:new Date("1971-01-01"),basketId:0,userId:l.userId,name:"default",numberOfDesiredUTXOs:144,minimumDesiredUTXOValue:32,isDeleted:!1});break}catch(c){if(console.log(`findOrInsertUser catch: ${JSON.stringify(c).slice(0,512)}`),n>0)throw c}return{user:l,isNew:f}}async findOrInsertTransaction(o,a){let l,f=!1;for(let n=0;;n++)try{if(l=(0,s.verifyOneOrNone)(await this.findTransactions({partial:{userId:o.userId,txid:o.txid},trx:a})),l)break;o.transactionId=await this.insertTransaction(o,a),f=!0,l=o;break}catch(c){if(n>0)throw c}return{tx:l,isNew:f}}async findOrInsertOutputBasket(o,a,l){const f={name:a,userId:o};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findOutputBaskets({partial:f,trx:l}));return d||(d={...f,minimumDesiredUTXOValue:0,numberOfDesiredUTXOs:0,basketId:0,created_at:c,updated_at:c,isDeleted:!1},d.basketId=await this.insertOutputBasket(d,l)),d.isDeleted&&await this.updateOutputBasket((0,s.verifyId)(d.basketId),{isDeleted:!1}),d}catch(c){if(n>0)throw c}}async findOrInsertTxLabel(o,a,l){const f={label:a,userId:o};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findTxLabels({partial:f,trx:l}));return d||(d={...f,txLabelId:0,created_at:c,updated_at:c,isDeleted:!1},d.txLabelId=await this.insertTxLabel(d,l)),d.isDeleted&&await this.updateTxLabel((0,s.verifyId)(d.txLabelId),{isDeleted:!1}),d}catch(c){if(n>0)throw c}}async findOrInsertTxLabelMap(o,a,l){const f={transactionId:o,txLabelId:a};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findTxLabelMaps({partial:f,trx:l}));return d||(d={...f,created_at:c,updated_at:c,isDeleted:!1},await this.insertTxLabelMap(d,l)),d.isDeleted&&await this.updateTxLabelMap(o,a,{isDeleted:!1}),d}catch(c){if(n>0)throw c}}async findOrInsertOutputTag(o,a,l){const f={tag:a,userId:o};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findOutputTags({partial:f,trx:l}));return d||(d={...f,outputTagId:0,created_at:c,updated_at:c,isDeleted:!1},d.outputTagId=await this.insertOutputTag(d,l)),d.isDeleted&&await this.updateOutputTag((0,s.verifyId)(d.outputTagId),{isDeleted:!1}),d}catch(c){if(n>0)throw c}}async findOrInsertOutputTagMap(o,a,l){const f={outputId:o,outputTagId:a};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findOutputTagMaps({partial:f,trx:l}));return d||(d={...f,created_at:c,updated_at:c,isDeleted:!1},await this.insertOutputTagMap(d,l)),d.isDeleted&&await this.updateOutputTagMap(o,a,{isDeleted:!1}),d}catch(c){if(n>0)throw c}}async findOrInsertSyncStateAuth(o,a,l){const f={userId:o.userId,storageIdentityKey:a,storageName:l};for(let n=0;;n++)try{const c=new Date;let d=(0,s.verifyOneOrNone)(await this.findSyncStates({partial:f}));return d?{syncState:d,isNew:!1}:(d={...f,created_at:c,updated_at:c,syncStateId:0,status:"unknown",init:!1,refNum:(0,s.randomBytesBase64)(12),syncMap:JSON.stringify((0,t.createSyncMap)())},await this.insertSyncState(d),{syncState:d,isNew:!0})}catch(c){if(n>0)throw c}}async findOrInsertProvenTxReq(o,a){let l,f=!1;for(let n=0;;n++)try{if(l=(0,s.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:o.txid},trx:a})),l)break;o.provenTxReqId=await this.insertProvenTxReq(o,a),f=!0,l=o;break}catch(c){if(n>0)throw c}return{req:l,isNew:f}}async findOrInsertProvenTx(o,a){let l,f=!1;for(let n=0;;n++)try{if(l=(0,s.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:o.txid},trx:a})),l)break;o.provenTxId=await this.insertProvenTx(o,a),f=!0,l=o;break}catch(c){if(n>0)throw c}return{proven:l,isNew:f}}async tagOutput(o,a,l){await this.transaction(async f=>{const n=(0,s.verifyOne)(await this.findOutputs({partial:o,noScript:!0,trx:f})),c=await this.findOrInsertOutputTag(n.userId,a,f);await this.findOrInsertOutputTagMap((0,s.verifyId)(n.outputId),(0,s.verifyId)(c.outputTagId),f)},l)}};return Vl.StorageReaderWriter=r,Vl}var K4;function x1(){if(K4)return jc;K4=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.StorageProvider=void 0,jc.validateStorageFeeModel=d;const s=ge(),t=se(),i=HD(),r=KD(),e=HI(),o=VD(),a=WD(),l=$D(),f=dB(),n=gi();let c=class ek extends f.StorageReaderWriter{static defaultOptions(){return{feeModel:{model:"sat/kb",value:1},commissionSatoshis:0,commissionPubKeyHex:void 0}}static createStorageBaseOptions(p){return{...ek.defaultOptions(),chain:p}}constructor(p){super(p),this.isDirty=!1,this.feeModel=p.feeModel,this.commissionPubKeyHex=p.commissionPubKeyHex,this.commissionSatoshis=p.commissionSatoshis}isStorageProvider(){return!0}setServices(p){this._services=p}getServices(){if(!this._services)throw new t.sdk.WERR_INVALID_OPERATION("Must setServices first.");return this._services}async abortAction(p,g){if(!p.userId)throw new t.sdk.WERR_INVALID_PARAMETER("auth.userId","valid");const b=p.userId;let w=g.reference,v;return await this.transaction(async S=>{let T=(0,t.verifyOneOrNone)(await this.findTransactions({partial:{reference:w,userId:b},noRawTx:!0,trx:S}));!T&&g.reference.length===64&&(v=w,w=void 0,T=(0,t.verifyOneOrNone)(await this.findTransactions({partial:{txid:v,userId:b},noRawTx:!0,trx:S})));const I=["completed","failed","sending","unproven"];if(!T||!T.isOutgoing||-1<I.findIndex(O=>O===T.status))throw new t.sdk.WERR_INVALID_PARAMETER("reference","an inprocess, outgoing action that has not been signed and shared to the network.");if(await this.updateTransactionStatus("failed",T.transactionId,b,w,S),T.txid){const O=await n.EntityProvenTxReq.fromStorageTxid(this,T.txid,S);O&&(O.addHistoryNote({what:"abortAction",reference:g.reference}),O.status="invalid",await O.updateStorageDynamicProperties(this,S))}return{aborted:!0}})}async internalizeAction(p,g){return await(0,l.internalizeAction)(this,p,g)}async getReqsAndBeefToShareWithWorld(p,g,b){const w={beef:new s.Beef,details:[]};for(const v of p){const _={txid:v,status:"unknown"};w.details.push(_);try{if(_.proven=(0,t.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:v},trx:b})),_.proven)_.status="alreadySent";else{const S=["unmined","callback","unconfirmed","completed"],T=["sending","unsent","nosend","unprocessed"],I=["unknown","nonfinal","invalid","doubleSpend"];_.req=(0,t.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:v},trx:b})),_.req?I.indexOf(_.req.status)>-1?(_.status="error",_.error=`ERR_INVALID_PARAMETER: ${v} is not ready to send.`):S.indexOf(_.req.status)>-1?_.status="alreadySent":T.indexOf(_.req.status)>-1?!_.req.rawTx||!_.req.inputBEEF?(_.status="error",_.error=`ERR_INTERNAL: ${v} req is missing rawTx or beef.`):_.status="readyToSend":(_.status="error",_.error=`ERR_INTERNAL: ${v} has unexpected req status ${_.req.status}`):(_.status="error",_.error=`ERR_UNKNOWN_TXID: ${v} was not found.`),_.status==="readyToSend"&&await this.mergeReqToBeefToShareExternally(_.req,w.beef,g,b)}}catch(S){const T=t.sdk.WalletError.fromUnknown(S);_.error=`${T.name}: ${T.message}`}}return w}async mergeReqToBeefToShareExternally(p,g,b,w){const{rawTx:v,inputBEEF:_}=p;if(!v||!_)throw new t.sdk.WERR_INTERNAL("req rawTx and beef must be valid.");g.mergeRawTx((0,t.asArray)(v)),g.mergeBeef((0,t.asArray)(_));const S=s.Transaction.fromBinary((0,t.asArray)(v));for(const T of S.inputs){if(!T.sourceTXID)throw new t.sdk.WERR_INTERNAL("req all transaction inputs must have valid sourceTXID");const I=T.sourceTXID;g.findTxid(I)||(b&&b.indexOf(I)>-1?g.mergeTxidOnly(I):await this.getValidBeefForKnownTxid(I,g,void 0,b,w))}}async getProvenOrReq(p,g,b){if(g&&p!==g.txid)throw new t.sdk.WERR_INVALID_PARAMETER("newReq","same txid");const w={proven:void 0,req:void 0};if(w.proven=(0,t.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:p},trx:b})),w.proven)return w;for(let v=0;;v++)try{if(w.req=(0,t.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:p},trx:b})),!w.req&&!g)break;if(!w.req&&g&&await this.insertProvenTxReq(g,b),w.req&&g){const _=new n.EntityProvenTxReq(w.req);_.mergeHistory(g,void 0,!0),_.mergeNotifyTransactionIds(g),await _.updateStorageDynamicProperties(this,b)}break}catch(_){if(v>0)throw _}return w}async updateTransactionsStatus(p,g,b){await this.transaction(async w=>{for(const v of p)await this.updateTransactionStatus(g,v,void 0,void 0,w)},b)}async updateTransactionStatus(p,g,b,w,v){if(!g&&!(b&&w))throw new t.sdk.WERR_MISSING_PARAMETER("either transactionId or userId and reference");await this.transaction(async _=>{const S={};g&&(S.transactionId=g),b&&(S.userId=b),w&&(S.reference=w);const T=(0,t.verifyOne)(await this.findTransactions({partial:S,noRawTx:!0,trx:_}));if(p!=="completed"&&T.status==="completed"||T.provenTxId)throw new t.sdk.WERR_INVALID_OPERATION('The status of a "completed" transaction cannot be changed.');if(p!=="failed"&&T.status==="failed")throw new t.sdk.WERR_INVALID_OPERATION('A "failed" transaction may not be un-failed by this method.');switch(p){case"failed":{const k=await new n.EntityTransaction(T).getInputs(this,_);for(const O of k)await this.updateOutput((0,t.verifyId)(O.outputId),{spendable:!0,spentBy:void 0},_)}break;case"nosend":case"unsigned":case"unprocessed":case"sending":case"unproven":case"completed":break;default:throw new t.sdk.WERR_INVALID_PARAMETER("status",`not be ${p}`)}await this.updateTransaction(T.transactionId,{status:p},_)},v)}async createAction(p,g){if(!p.userId)throw new t.sdk.WERR_UNAUTHORIZED;return await(0,a.createAction)(this,p,g)}async processAction(p,g){if(!p.userId)throw new t.sdk.WERR_UNAUTHORIZED;return await(0,r.processAction)(this,p,g)}async attemptToPostReqsToNetwork(p,g){return await(0,e.attemptToPostReqsToNetwork)(this,p,g)}async listCertificates(p,g){return await(0,o.listCertificates)(this,p,g)}async verifyKnownValidTransaction(p,g){const{proven:b,rawTx:w}=await this.getProvenOrRawTx(p,g);return b!=null||w!=null}async getValidBeefForKnownTxid(p,g,b,w,v){const _=await this.getValidBeefForTxid(p,g,b,w,v);if(!_)throw new t.sdk.WERR_INVALID_PARAMETER("txid",`${p} is not known to storage.`);return _}async getValidBeefForTxid(p,g,b,w,v){const _=g||new s.Beef,S=await this.getProvenOrRawTx(p,v);if(S.proven)if(b==="known")_.mergeTxidOnly(p);else{_.mergeRawTx(S.proven.rawTx);const T=new n.EntityProvenTx(S.proven).getMerklePath();return _.mergeBump(T),_}if(S.rawTx&&S.inputBEEF)if(b==="known")_.mergeTxidOnly(p);else{_.mergeRawTx(S.rawTx),_.mergeBeef(S.inputBEEF);const T=s.Transaction.fromBinary(S.rawTx);for(const I of T.inputs)_.findTxid(I.sourceTXID)||(w&&w.indexOf(I.sourceTXID)>-1?_.mergeTxidOnly(I.sourceTXID):await this.getValidBeefForKnownTxid(I.sourceTXID,_,b,w,v));return _}}async getBeefForTransaction(p,g){return await(0,i.getBeefForTransaction)(this,p,g)}async findMonitorEventById(p,g){return(0,t.verifyOneOrNone)(await this.findMonitorEvents({partial:{id:p},trx:g}))}async relinquishCertificate(p,g){const b=t.sdk.validateRelinquishCertificateArgs(g),w=(0,t.verifyOne)(await this.findCertificates({partial:{certifier:b.certifier,serialNumber:b.serialNumber,type:b.type}}));return await this.updateCertificate(w.certificateId,{isDeleted:!0})}async relinquishOutput(p,g){const b=t.sdk.validateRelinquishOutputArgs(g),{txid:w,vout:v}=t.sdk.parseWalletOutpoint(b.output),_=(0,t.verifyOne)(await this.findOutputs({partial:{txid:w,vout:v}}));return await this.updateOutput(_.outputId,{basketId:void 0})}async processSyncChunk(p,g){const b=(0,t.verifyTruthy)(await this.findUserByIdentityKey(p.identityKey));return await new n.EntitySyncState((0,t.verifyOne)(await this.findSyncStates({partial:{storageIdentityKey:p.fromStorageIdentityKey,userId:b.userId}}))).processSyncChunk(this,p,g)}async updateProvenTxReqWithNewProvenTx(p){const g=await n.EntityProvenTxReq.fromStorageId(this,p.provenTxReqId);let b;if(g.provenTxId)b=new n.EntityProvenTx((0,t.verifyOne)(await this.findProvenTxs({partial:{txid:p.txid}})));else{let v;if({proven:b,isNew:v}=await this.transaction(async _=>{const{proven:S,isNew:T}=await this.findOrInsertProvenTx({created_at:new Date,updated_at:new Date,provenTxId:0,txid:p.txid,height:p.height,index:p.index,merklePath:p.merklePath,rawTx:g.rawTx,blockHash:p.blockHash,merkleRoot:p.merkleRoot},_);return b=new n.EntityProvenTx(S),T&&(g.status="completed",g.provenTxId=b.provenTxId,await g.updateStorageDynamicProperties(this,_)),{proven:b,isNew:T}}),v){const _=g.notify.transactionIds||[];if(_.length>0){for(const S of _)try{await this.updateTransaction(S,{provenTxId:b.provenTxId,status:"completed"}),g.addHistoryNote({what:"notifyTxOfProof",transactionId:S})}catch(T){const{code:I,description:k}=t.sdk.WalletError.fromUnknown(T),{provenTxId:O}=b;g.addHistoryNote({what:"notifyTxOfProofError",id:S,provenTxId:O,code:I,description:k})}await g.updateStorageDynamicProperties(this)}}}return{status:g.status,history:g.apiHistory,provenTxId:b.provenTxId}}async confirmSpendableOutputs(){const p=[],g=await this.findUsers({partial:{}});for(const{userId:b}of g){const w=(0,t.verifyOne)(await this.findOutputBaskets({partial:{userId:b,name:"default"}})),v={userId:b,basketId:w.basketId,spendable:!0},_=await this.findOutputs({partial:v}),S=this.getServices();for(let T=_.length-1;T>=0;T--){const I=_[T];if((0,t.verifyId)(I.outputId),I.spendable){let k=!1;if(I.lockingScript&&I.lockingScript.length>0){const O=S.hashOutputScript((0,t.asString)(I.lockingScript));(await S.getUtxoStatus(O,void 0,`${I.txid}.${I.vout}`)).isUtxo===!0&&(k=!0)}k||p.push(I)}}}return{invalidSpendableOutputs:p}}async updateProvenTxReqDynamics(p,g,b){const w={};return g.updated_at&&(w.updated_at=g.updated_at),g.provenTxId&&(w.provenTxId=g.provenTxId),g.status&&(w.status=g.status),Number.isInteger(g.attempts)&&(w.attempts=g.attempts),g.notified!==void 0&&(w.notified=g.notified),g.batch&&(w.batch=g.batch),g.history&&(w.history=g.history),g.notify&&(w.notify=g.notify),await this.updateProvenTxReq(p,w,b)}async extendOutput(p,g=!1,b=!1,w){const v=p;return g&&v.basketId&&(v.basket=await this.findOutputBasketById(p.basketId,w)),b&&(v.tags=await this.getTagsForOutputId(p.outputId)),p}async validateOutputScript(p,g){if(!p.scriptLength||!p.scriptOffset||!p.txid||p.lockingScript&&p.lockingScript.length===p.scriptLength)return;const b=await this.getRawTxOfKnownValidTransaction(p.txid,p.scriptOffset,p.scriptLength,g);b&&(p.lockingScript=b)}};jc.StorageProvider=c;function d(y){const p={model:"sat/kb",value:1};if(typeof y=="object"){if(y.model!=="sat/kb")throw new t.sdk.WERR_INVALID_PARAMETER("StorageFeeModel.model",'"sat/kb"');typeof y.value=="number"&&(p.value=y.value)}return p}return jc}var dp={},od={},V4;function fB(){if(V4)return od;V4=1,Object.defineProperty(od,"__esModule",{value:!0}),od.getLabelToSpecOp=void 0;const s=se(),t=()=>({[s.sdk.specOpNoSendActions]:{name:"noSendActions",labelsToIntercept:["abort"],setStatusFilter:()=>["nosend"],postProcess:async(i,r,e,o,a)=>{if(o.indexOf("abort")>=0)for(const l of a)l.status==="nosend"&&(await i.abortAction(r,{reference:l.reference}),l.status="failed")}},[s.sdk.specOpFailedActions]:{name:"failedActions",labelsToIntercept:["unfail"],setStatusFilter:()=>["failed"],postProcess:async(i,r,e,o,a)=>{if(o.indexOf("unfail")>=0)for(const l of a)l.status==="failed"&&await i.updateTransaction(l.transactionId,{status:"unfail"})}}});return od.getLabelToSpecOp=t,od}var W4;function hB(){if(W4)return dp;W4=1,Object.defineProperty(dp,"__esModule",{value:!0}),dp.listActionsIdb=e;const s=ge(),t=se(),i=Rr(),r=fB();async function e(o,a,l){l.limit,l.offset;const f={totalActions:0,actions:[]};let n,c=[],d=[];for(const w of l.labels)(0,i.isListActionsSpecOp)(w)?n=(0,r.getLabelToSpecOp)()[w]:d.push(w);if((n==null?void 0:n.labelsToIntercept)!==void 0){const w=n.labelsToIntercept,v=d;d=[],w.length===0&&(c=v);for(const _ of v)w.indexOf(_)>=0?c.push(_):d.push(_)}let y=[];d.length>0&&await o.filterTxLabels({partial:{userId:a.userId,isDeleted:!1}},w=>{d.includes(w.label)&&y.push(w.txLabelId)});const p=l.labelQueryMode==="all";if(p&&y.length<d.length||!p&&y.length===0&&d.length>0)return f;const g=n!=null&&n.setStatusFilter?n.setStatusFilter():["completed","unprocessed","sending","unproven","unsigned","nosend","nonfinal"];y.length;const b=await o.findTransactions({partial:{userId:a.userId},status:g,paged:{limit:l.limit,offset:l.offset},noRawTx:!0},y,p);b.length===l.limit?f.totalActions=await o.countTransactions({partial:{userId:a.userId},status:g},y,p):f.totalActions=b.length,n!=null&&n.postProcess&&await n.postProcess(o,a,l,c,b);for(const w of b){const v={txid:w.txid||"",satoshis:w.satoshis||0,status:w.status,isOutgoing:!!w.isOutgoing,description:w.description||"",version:w.version||0,lockTime:w.lockTime||0};f.actions.push(v)}return(l.includeLabels||l.includeInputs||l.includeOutputs)&&await Promise.all(b.map(async(w,v)=>{var _,S,T;const I=f.actions[v];if(l.includeLabels&&(I.labels=(await o.getLabelsForTransactionId(w.transactionId)).map(k=>k.label)),l.includeOutputs){const k=await o.findOutputs({partial:{transactionId:w.transactionId},noScript:!l.includeOutputLockingScripts});I.outputs=[];for(const O of k){await o.extendOutput(O,!0,!0);const A={satoshis:O.satoshis||0,spendable:!!O.spendable,tags:((_=O.tags)===null||_===void 0?void 0:_.map(R=>R.tag))||[],outputIndex:Number(O.vout),outputDescription:O.outputDescription||"",basket:((S=O.basket)===null||S===void 0?void 0:S.name)||""};l.includeOutputLockingScripts&&(A.lockingScript=(0,t.asString)(O.lockingScript||[])),I.outputs.push(A)}}if(l.includeInputs){const k=await o.findOutputs({partial:{spentBy:w.transactionId},noScript:!l.includeInputSourceLockingScripts});if(I.inputs=[],k.length>0){const O=await o.getRawTxOfKnownValidTransaction(w.txid);let A;O&&(A=s.Transaction.fromBinary(O));for(const R of k){await o.extendOutput(R,!0,!0);const P=A==null?void 0:A.inputs.find(N=>N.sourceTXID===R.txid&&N.sourceOutputIndex===R.vout),C={sourceOutpoint:`${R.txid}.${R.vout}`,sourceSatoshis:R.satoshis||0,inputDescription:R.outputDescription||"",sequenceNumber:(P==null?void 0:P.sequence)||0};I.inputs.push(C),l.includeInputSourceLockingScripts&&(C.sourceLockingScript=(0,t.asString)(R.lockingScript||[])),l.includeInputUnlockingScripts&&(C.unlockingScript=(T=P==null?void 0:P.unlockingScript)===null||T===void 0?void 0:T.toHex())}}}})),f}return dp}var fp={},cd={},$4;function pB(){if($4)return cd;$4=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.getBasketToSpecOp=void 0;const s=se(),t=()=>({[s.sdk.specOpWalletBalance]:{name:"totalOutputsIsWalletBalance",useBasket:"default",ignoreLimit:!0,resultFromOutputs:async(i,r,e,o,a)=>{let l=0;for(const f of a)l+=f.satoshis;return{totalOutputs:l,outputs:[]}}},[s.sdk.specOpInvalidChange]:{name:"invalidChangeOutputs",useBasket:"default",ignoreLimit:!0,includeOutputScripts:!0,includeSpent:!1,tagsToIntercept:["release","all"],filterOutputs:async(i,r,e,o,a)=>{const l=[],f=i.getServices();for(const n of a){await i.validateOutputScript(n);let c=!1;n.lockingScript&&n.lockingScript.length>0?c=await f.isUtxo(n):c=void 0,c===!1&&l.push(n)}if(o.indexOf("release")>=0)for(const n of l)await i.updateOutput(n.outputId,{spendable:!1}),n.spendable=!1;return l}},[s.sdk.specOpSetWalletChangeParams]:{name:"setWalletChangeParams",tagsParamsCount:2,resultFromTags:async(i,r,e,o)=>{if(o.length!==2)throw new s.sdk.WERR_INVALID_PARAMETER("numberOfDesiredUTXOs and minimumDesiredUTXOValue","valid");const a=(0,s.verifyInteger)(Number(o[0])),l=(0,s.verifyInteger)(Number(o[1])),f=(0,s.verifyOne)(await i.findOutputBaskets({partial:{userId:(0,s.verifyId)(r.userId),name:"default"}}));return await i.updateOutputBasket(f.basketId,{numberOfDesiredUTXOs:a,minimumDesiredUTXOValue:l}),{totalOutputs:0,outputs:[]}}}});return cd.getBasketToSpecOp=t,cd}var z4;function yB(){if(z4)return fp;z4=1,Object.defineProperty(fp,"__esModule",{value:!0}),fp.listOutputsIdb=r;const s=ge(),t=se(),i=pB();async function r(e,o,a,l){const f=(0,t.verifyId)(o.userId),n=a.limit,c=a.offset,d={totalOutputs:0,outputs:[]};let y,p;if(a.basket){let O=a.basket;if(y=(0,i.getBasketToSpecOp)()[O],O=y?y.useBasket?y.useBasket:"":O,O){const A=await e.findOutputBaskets({partial:{userId:f,name:O}});if(A.length!==1)return d;p=A[0].basketId}}let g=[...a.tags];const b=[];if(y&&y.tagsParamsCount&&b.push(...g.splice(0,Math.min(g.length,y.tagsParamsCount))),y&&y.tagsToIntercept){const O=g;g=[];for(const A of O)y.tagsToIntercept.length===0||y.tagsToIntercept.indexOf(A)>=0?(b.push(A),A==="all"&&(p=void 0)):g.push(A)}if(y&&y.resultFromTags)return await y.resultFromTags(e,o,a,b);let w=[];g&&g.length>0&&await e.filterOutputTags({partial:{userId:f,isDeleted:!1}},O=>{g.includes(O.tag)&&w.push(O.outputTagId)});const v=a.tagQueryMode==="all";if(v&&w.length<g.length||!v&&w.length===0&&g.length>0)return d;w.length;const S={partial:{userId:f,basketId:p,spendable:!0},txStatus:["completed","unproven","nosend"],noScript:!0};(!y||!y.ignoreLimit)&&(S.paged={limit:n,offset:c});let T=await e.findOutputs(S,w,v);if(T.length===a.limit?(S.paged=void 0,d.totalOutputs=await e.countOutputs(S,w,v)):d.totalOutputs=T.length,y&&(y.filterOutputs&&(T=await y.filterOutputs(e,o,a,b,T)),y.resultFromOutputs))return await y.resultFromOutputs(e,o,a,b,T);const I={},k=new s.Beef;for(const O of T){const A={satoshis:Number(O.satoshis),spendable:!!O.spendable,outpoint:`${O.txid}.${O.vout}`};d.outputs.push(A),a.includeCustomInstructions&&O.customInstructions&&(A.customInstructions=O.customInstructions),a.includeLabels&&O.txid&&(I[O.txid]===void 0&&(I[O.txid]=(await e.getLabelsForTransactionId(O.transactionId)).map(R=>R.label)),A.labels=I[O.txid]),a.includeTags&&(A.tags=(await e.getTagsForOutputId(O.outputId)).map(R=>R.tag)),a.includeLockingScripts&&(await e.validateOutputScript(O),O.lockingScript&&(A.lockingScript=(0,t.asString)(O.lockingScript))),a.includeTransactions&&!k.findTxid(O.txid)&&await e.getValidBeefForKnownTxid(O.txid,k,void 0,a.knownTxids)}return a.includeTransactions&&(d.BEEF=k.toBinary()),d}return fp}var hp={},X4;function gB(){if(X4)return hp;X4=1,Object.defineProperty(hp,"__esModule",{value:!0}),hp.reviewStatusIdb=s;async function s(t,i){const r={log:""},e=[];await t.filterProvenTxReqs({partial:{status:"invalid"}},o=>{e.push(o.txid)});for(const o of e){const a=await t.findTransactions({partial:{txid:o}});for(const l of a)l.status!=="failed"&&(r.log+=`transaction ${l.transactionId} updated to status of 'failed' was ${l.status}
`,await t.updateTransactionStatus("failed",l.transactionId))}return r}return hp}var pp={},G4;function mB(){if(G4)return pp;G4=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.purgeDataIdb=s;async function s(t,i,r){return{count:0,log:""}}return pp}var Y4;function ik(){if(Y4)return Kl;Y4=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.StorageIdb=void 0;const s=jD,t=se(),i=x1(),r=hB(),e=yB(),o=gB(),a=mB();let l=class extends i.StorageProvider{constructor(n){super(n),this.allStores=["certificates","certificate_fields","commissions","monitor_events","outputs","output_baskets","output_tags","output_tags_map","proven_txs","proven_tx_reqs","sync_states","transactions","tx_labels","tx_labels_map","users"],this.dbName=`wallet-toolbox-${this.chain}net`}async migrate(n,c){return(await this.verifyDB(n,c)).version.toString()}async verifyDB(n,c){return this.db?this.db:(this.db=await this.initDB(n,c),this._settings=(await this.db.getAll("settings"))[0],this.whenLastAccess=new Date,this.db)}toDbTrx(n,c,d){if(d)return d;{if(!this.db)throw new Error("not initialized");const p=this.db.transaction(n||this.allStores,c||"readwrite");return this.whenLastAccess=new Date,p}}async readSettings(n){return await this.verifyDB(),this._settings}async initDB(n,c){const d=this.chain,y=1024;return await(0,s.openDB)(this.dbName,1,{upgrade(g,b,w,v){if(g.objectStoreNames.contains("proven_txs")||g.createObjectStore("proven_txs",{keyPath:"provenTxId",autoIncrement:!0}).createIndex("txid","txid",{unique:!0}),!g.objectStoreNames.contains("proven_tx_reqs")){const _=g.createObjectStore("proven_tx_reqs",{keyPath:"provenTxReqId",autoIncrement:!0});_.createIndex("provenTxId","provenTxId"),_.createIndex("txid","txid",{unique:!0}),_.createIndex("status","status"),_.createIndex("batch","batch")}if(g.objectStoreNames.contains("users")||g.createObjectStore("users",{keyPath:"userId",autoIncrement:!0}).createIndex("identityKey","identityKey",{unique:!0}),!g.objectStoreNames.contains("certificates")){const _=g.createObjectStore("certificates",{keyPath:"certificateId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("userId_type_certifier_serialNumber",["userId","type","certifier","serialNumber"],{unique:!0})}if(!g.objectStoreNames.contains("certificate_fields")){const _=g.createObjectStore("certificate_fields",{keyPath:["certificateId","fieldName"]});_.createIndex("userId","userId"),_.createIndex("certificateId","certificateId")}if(!g.objectStoreNames.contains("output_baskets")){const _=g.createObjectStore("output_baskets",{keyPath:"basketId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("name_userId",["name","userId"],{unique:!0})}if(!g.objectStoreNames.contains("transactions")){const _=g.createObjectStore("transactions",{keyPath:"transactionId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("status","status"),_.createIndex("status_userId",["status","userId"]),_.createIndex("provenTxId","provenTxId"),_.createIndex("reference","reference",{unique:!0})}if(!g.objectStoreNames.contains("commissions")){const _=g.createObjectStore("commissions",{keyPath:"commissionId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("transactionId","transactionId",{unique:!0})}if(!g.objectStoreNames.contains("outputs")){const _=g.createObjectStore("outputs",{keyPath:"outputId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("transactionId","transactionId"),_.createIndex("basketId","basketId"),_.createIndex("spentBy","spentBy"),_.createIndex("transactionId_vout_userId",["transactionId","vout","userId"],{unique:!0})}if(!g.objectStoreNames.contains("output_tags")){const _=g.createObjectStore("output_tags",{keyPath:"outputTagId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("tag_userId",["tag","userId"],{unique:!0})}if(!g.objectStoreNames.contains("output_tags_map")){const _=g.createObjectStore("output_tags_map",{keyPath:["outputTagId","outputId"]});_.createIndex("outputTagId","outputTagId"),_.createIndex("outputId","outputId")}if(!g.objectStoreNames.contains("tx_labels")){const _=g.createObjectStore("tx_labels",{keyPath:"txLabelId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("label_userId",["label","userId"],{unique:!0})}if(!g.objectStoreNames.contains("tx_labels_map")){const _=g.createObjectStore("tx_labels_map",{keyPath:["txLabelId","transactionId"]});_.createIndex("txLabelId","txLabelId"),_.createIndex("transactionId","transactionId")}if(g.objectStoreNames.contains("monitor_events")||g.createObjectStore("monitor_events",{keyPath:"id",autoIncrement:!0}),!g.objectStoreNames.contains("sync_states")){const _=g.createObjectStore("sync_states",{keyPath:"syncStateId",autoIncrement:!0});_.createIndex("userId","userId"),_.createIndex("refNum","refNum",{unique:!0}),_.createIndex("status","status")}if(!g.objectStoreNames.contains("settings")){if(!n||!c)throw new t.sdk.WERR_INVALID_OPERATION("migrate must be called before first access");const _=g.createObjectStore("settings",{keyPath:"storageIdentityKey"}),S={created_at:new Date,updated_at:new Date,storageIdentityKey:c,storageName:n,chain:d,dbtype:"IndexedDB",maxOutputScript:y};_.put(S)}}})}async reviewStatus(n){return await(0,o.reviewStatusIdb)(this,n)}async purgeData(n,c){return await(0,a.purgeDataIdb)(this,n,c)}async allocateChangeInput(n,c,d,y,p,g){const b=this.toDbTrx(["outputs","transactions"],"readwrite");try{const w=["completed","unproven"];p||w.push("sending");const v={partial:{userId:n,basketId:c,spendable:!0},txStatus:w,trx:b},_=await this.findOutputs(v);let S,T=[];for(const I of _){if(y&&I.satoshis===y){S=I;break}const k=I.satoshis-d;T.push({output:I,score:k})}if(!S){T=T.sort((k,O)=>k.score-O.score);const I=T.find(k=>k.score>=0);I?S=I.output:T.length>0?S=T.slice(-1)[0].output:S=void 0}return S&&await this.updateOutput(S.outputId,{spendable:!1,spentBy:g},b),S}finally{await b.done}}async getProvenOrRawTx(n,c){const d={proven:void 0,rawTx:void 0,inputBEEF:void 0};if(d.proven=(0,t.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:n},trx:c})),!d.proven){const y=(0,t.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:n},trx:c}));y&&["unsent","unmined","unconfirmed","sending","nosend","completed"].includes(y.status)&&(d.rawTx=y.rawTx,d.inputBEEF=y.inputBEEF)}return d}async getRawTxOfKnownValidTransaction(n,c,d,y){if(!n)return;this.isAvailable()||await this.makeAvailable();let p;const g=await this.getProvenOrRawTx(n,y);return g.proven?p=g.proven.rawTx:p=g.rawTx,p&&c!==void 0&&d!==void 0&&Number.isInteger(c)&&Number.isInteger(d)&&(p=p.slice(c,c+d)),p}async getLabelsForTransactionId(n,c){const y=(await this.findTxLabelMaps({partial:{transactionId:n,isDeleted:!1},trx:c})).map(g=>g.txLabelId),p=[];for(const g of y){const b=(0,t.verifyOne)(await this.findTxLabels({partial:{txLabelId:g,isDeleted:!1},trx:c}));p.push(b)}return p}async getTagsForOutputId(n,c){const y=(await this.findOutputTagMaps({partial:{outputId:n,isDeleted:!1},trx:c})).map(g=>g.outputTagId),p=[];for(const g of y){const b=(0,t.verifyOne)(await this.findOutputTags({partial:{outputTagId:g,isDeleted:!1},trx:c}));p.push(b)}return p}async listActions(n,c){if(!n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return await(0,r.listActionsIdb)(this,n,c)}async listOutputs(n,c){if(!n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return await(0,e.listOutputsIdb)(this,n,c)}async countChangeInputs(n,c,d){const y=["completed","unproven"];d||y.push("sending");const p={partial:{userId:n,basketId:c},txStatus:y};let g=0;return await this.filterOutputs(p,b=>{g++}),g}async findCertificatesAuth(n,c){if(!n.userId||c.partial.userId&&c.partial.userId!==n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return c.partial.userId=n.userId,await this.findCertificates(c)}async findOutputBasketsAuth(n,c){if(!n.userId||c.partial.userId&&c.partial.userId!==n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return c.partial.userId=n.userId,await this.findOutputBaskets(c)}async findOutputsAuth(n,c){if(!n.userId||c.partial.userId&&c.partial.userId!==n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return c.partial.userId=n.userId,await this.findOutputs(c)}async insertCertificateAuth(n,c){if(!n.userId||c.userId&&c.userId!==n.userId)throw new t.sdk.WERR_UNAUTHORIZED;return c.userId=n.userId,await this.insertCertificate(c)}async dropAllData(){await(0,s.deleteDB)(this.dbName)}async filterOutputTagMaps(n,c,d){var y,p,g,b;const w=((y=n.paged)===null||y===void 0?void 0:y.offset)||0;let v=0,_=0;const S=this.toDbTrx(["output_tags_map"],"readonly",n.trx);let T;((p=n.partial)===null||p===void 0?void 0:p.outputTagId)!==void 0?T=await S.objectStore("output_tags_map").index("outputTagId").openCursor(n.partial.outputTagId):((g=n.partial)===null||g===void 0?void 0:g.outputId)!==void 0?T=await S.objectStore("output_tags_map").index("outputId").openCursor(n.partial.outputId):T=await S.objectStore("output_tags_map").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.tagIds&&!n.tagIds.includes(k.outputTagId))&&!(n.partial&&(n.partial.outputTagId&&k.outputTagId!==n.partial.outputTagId||n.partial.outputId&&k.outputId!==n.partial.outputId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.isDeleted!==void 0&&k.isDeleted!==n.partial.isDeleted))&&!(d!==void 0&&k.txid&&await this.countOutputTags({partial:{userId:d,outputTagId:k.outputTagId},trx:n.trx})===0)){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findOutputTagMaps(n){const c=[];return await this.filterOutputTagMaps(n,d=>{c.push(this.validateEntity(d))}),c}async filterProvenTxReqs(n,c,d){var y,p,g,b,w,v,_;if(n.partial.rawTx)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. ProvenTxReqs may not be found by rawTx value.");if(n.partial.inputBEEF)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.inputBEEF","undefined. ProvenTxReqs may not be found by inputBEEF value.");const S=((y=n.paged)===null||y===void 0?void 0:y.offset)||0;let T=0,I=0;const k=this.toDbTrx(["proven_tx_reqs"],"readonly",n.trx);let O;!((p=n.partial)===null||p===void 0)&&p.provenTxReqId?O=await k.objectStore("proven_tx_reqs").openCursor(n.partial.provenTxReqId):((g=n.partial)===null||g===void 0?void 0:g.provenTxId)!==void 0?O=await k.objectStore("proven_tx_reqs").index("provenTxId").openCursor(n.partial.provenTxId):((b=n.partial)===null||b===void 0?void 0:b.txid)!==void 0?O=await k.objectStore("proven_tx_reqs").index("txid").openCursor(n.partial.txid):((w=n.partial)===null||w===void 0?void 0:w.status)!==void 0?O=await k.objectStore("proven_tx_reqs").index("status").openCursor(n.partial.status):((v=n.partial)===null||v===void 0?void 0:v.batch)!==void 0?O=await k.objectStore("proven_tx_reqs").index("batch").openCursor(n.partial.batch):O=await k.objectStore("proven_tx_reqs").openCursor();let A=!0;for(;O&&(A||(O=await O.continue()),!!O);){A=!1;const R=O.value;if(!(n.since&&n.since>R.updated_at)&&!(n.partial&&(n.partial.provenTxReqId&&R.provenTxReqId!==n.partial.provenTxReqId||n.partial.provenTxId&&R.provenTxId!==n.partial.provenTxId||n.partial.created_at&&R.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&R.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.status&&R.status!==n.partial.status||n.partial.attempts!==void 0&&R.attempts!==n.partial.attempts||n.partial.notified!==void 0&&R.notified!==n.partial.notified||n.partial.txid&&R.txid!==n.partial.txid||n.partial.batch&&R.batch!==n.partial.batch||n.partial.history&&R.history!==n.partial.history||n.partial.notify&&R.notify!==n.partial.notify))&&!(d!==void 0&&R.txid&&await this.countTransactions({partial:{userId:d,txid:R.txid},trx:n.trx})===0)){if(T<S){T++;continue}if(c(R),I++,!((_=n.paged)===null||_===void 0)&&_.limit&&I>=n.paged.limit)break}}n.trx||await k.done}async findProvenTxReqs(n){const c=[];return await this.filterProvenTxReqs(n,d=>{c.push(this.validateEntity(d))}),c}async filterProvenTxs(n,c,d){var y,p,g,b;if(n.partial.rawTx)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. ProvenTxs may not be found by rawTx value.");if(n.partial.merklePath)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.merklePath","undefined. ProvenTxs may not be found by merklePath value.");const w=((y=n.paged)===null||y===void 0?void 0:y.offset)||0;let v=0,_=0;const S=this.toDbTrx(["proven_txs"],"readonly",n.trx);let T;!((p=n.partial)===null||p===void 0)&&p.provenTxId?T=await S.objectStore("proven_txs").openCursor(n.partial.provenTxId):((g=n.partial)===null||g===void 0?void 0:g.txid)!==void 0?T=await S.objectStore("proven_txs").index("txid").openCursor(n.partial.txid):T=await S.objectStore("proven_txs").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.provenTxId&&k.provenTxId!==n.partial.provenTxId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.txid&&k.txid!==n.partial.txid||n.partial.height!==void 0&&k.height!==n.partial.height||n.partial.index!==void 0&&k.index!==n.partial.index||n.partial.blockHash&&k.blockHash!==n.partial.blockHash||n.partial.merkleRoot&&k.merkleRoot!==n.partial.merkleRoot))&&!(d!==void 0&&await this.countTransactions({partial:{userId:d,provenTxId:k.provenTxId},trx:n.trx})===0)){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findProvenTxs(n){const c=[];return await this.filterProvenTxs(n,d=>{c.push(this.validateEntity(d))}),c}async filterTxLabelMaps(n,c,d){var y,p,g,b;const w=((y=n.paged)===null||y===void 0?void 0:y.offset)||0;let v=0,_=0;const S=this.toDbTrx(["tx_labels_map"],"readonly",n.trx);let T;((p=n.partial)===null||p===void 0?void 0:p.transactionId)!==void 0?T=await S.objectStore("tx_labels_map").index("transactionId").openCursor(n.partial.transactionId):((g=n.partial)===null||g===void 0?void 0:g.txLabelId)!==void 0?T=await S.objectStore("tx_labels_map").index("txLabelId").openCursor(n.partial.txLabelId):T=await S.objectStore("tx_labels_map").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.txLabelId&&k.txLabelId!==n.partial.txLabelId||n.partial.transactionId&&k.transactionId!==n.partial.transactionId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.isDeleted!==void 0&&k.isDeleted!==n.partial.isDeleted))&&!(d!==void 0&&await this.countTxLabels({partial:{userId:d,txLabelId:k.txLabelId},trx:n.trx})===0)){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findTxLabelMaps(n){const c=[];return await this.filterTxLabelMaps(n,d=>{c.push(this.validateEntity(d))}),c}async countOutputTagMaps(n){let c=0;return await this.filterOutputTagMaps(n,()=>{c++}),c}async countProvenTxReqs(n){let c=0;return await this.filterProvenTxReqs(n,()=>{c++}),c}async countProvenTxs(n){let c=0;return await this.filterProvenTxs(n,()=>{c++}),c}async countTxLabelMaps(n){let c=0;return await this.filterTxLabelMaps(n,()=>{c++}),c}async insertCertificate(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]),y=d.fields;d.fields&&delete d.fields,d.certificateId===0&&delete d.certificateId;const p=this.toDbTrx(["certificates","certificate_fields"],"readwrite",c),g=p.objectStore("certificates");try{const b=Number(await g.add(d));if(n.certificateId=b,y)for(const w of y)w.certificateId=n.certificateId,w.userId=n.userId,await this.insertCertificateField(w,p)}finally{c||await p.done}return n.certificateId}async insertCertificateField(n,c){const d=await this.validateEntityForInsert(n,c),y=this.toDbTrx(["certificate_fields"],"readwrite",c),p=y.objectStore("certificate_fields");try{await p.add(d)}finally{c||await y.done}}async insertCommission(n,c){const d=await this.validateEntityForInsert(n,c);d.commissionId===0&&delete d.commissionId;const y=this.toDbTrx(["commissions"],"readwrite",c),p=y.objectStore("commissions");try{const g=Number(await p.add(d));n.commissionId=g}finally{c||await y.done}return n.commissionId}async insertMonitorEvent(n,c){const d=await this.validateEntityForInsert(n,c);d.id===0&&delete d.id;const y=this.toDbTrx(["monitor_events"],"readwrite",c),p=y.objectStore("monitor_events");try{const g=Number(await p.add(d));n.id=g}finally{c||await y.done}return n.id}async insertOutput(n,c){const d=await this.validateEntityForInsert(n,c);d.outputId===0&&delete d.outputId;const y=this.toDbTrx(["outputs"],"readwrite",c),p=y.objectStore("outputs");try{const g=Number(await p.add(d));n.outputId=g}finally{c||await y.done}return n.outputId}async insertOutputBasket(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]);d.basketId===0&&delete d.basketId;const y=this.toDbTrx(["output_baskets"],"readwrite",c),p=y.objectStore("output_baskets");try{const g=Number(await p.add(d));n.basketId=g}finally{c||await y.done}return n.basketId}async insertOutputTag(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]);d.outputTagId===0&&delete d.outputTagId;const y=this.toDbTrx(["output_tags"],"readwrite",c),p=y.objectStore("output_tags");try{const g=Number(await p.add(d));n.outputTagId=g}finally{c||await y.done}return n.outputTagId}async insertOutputTagMap(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]),y=this.toDbTrx(["output_tags_map"],"readwrite",c),p=y.objectStore("output_tags_map");try{await p.add(d)}finally{c||await y.done}}async insertProvenTx(n,c){const d=await this.validateEntityForInsert(n,c);d.provenTxId===0&&delete d.provenTxId;const y=this.toDbTrx(["proven_txs"],"readwrite",c),p=y.objectStore("proven_txs");try{const g=Number(await p.add(d));n.provenTxId=g}finally{c||await y.done}return n.provenTxId}async insertProvenTxReq(n,c){const d=await this.validateEntityForInsert(n,c);d.provenTxReqId===0&&delete d.provenTxReqId;const y=this.toDbTrx(["proven_tx_reqs"],"readwrite",c),p=y.objectStore("proven_tx_reqs");try{const g=Number(await p.add(d));n.provenTxReqId=g}finally{c||await y.done}return n.provenTxReqId}async insertSyncState(n,c){const d=await this.validateEntityForInsert(n,c,["when"],["init"]);d.syncStateId===0&&delete d.syncStateId;const y=this.toDbTrx(["sync_states"],"readwrite",c),p=y.objectStore("sync_states");try{const g=Number(await p.add(d));n.syncStateId=g}finally{c||await y.done}return n.syncStateId}async insertTransaction(n,c){const d=await this.validateEntityForInsert(n,c);d.transactionId===0&&delete d.transactionId;const y=this.toDbTrx(["transactions"],"readwrite",c),p=y.objectStore("transactions");try{const g=Number(await p.add(d));n.transactionId=g}finally{c||await y.done}return n.transactionId}async insertTxLabel(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]);d.txLabelId===0&&delete d.txLabelId;const y=this.toDbTrx(["tx_labels"],"readwrite",c),p=y.objectStore("tx_labels");try{const g=Number(await p.add(d));n.txLabelId=g}finally{c||await y.done}return n.txLabelId}async insertTxLabelMap(n,c){const d=await this.validateEntityForInsert(n,c,void 0,["isDeleted"]),y=this.toDbTrx(["tx_labels_map"],"readwrite",c),p=y.objectStore("tx_labels_map");try{await p.add(d)}finally{c||await y.done}}async insertUser(n,c){const d=await this.validateEntityForInsert(n,c);d.userId===0&&delete d.userId;const y=this.toDbTrx(["users"],"readwrite",c),p=y.objectStore("users");try{const g=Number(await p.add(d));n.userId=g}finally{c||await y.done}return n.userId}async updateIdb(n,c,d,y,p){if(c[d]!==void 0&&(Array.isArray(n)||c[d]!==n))throw new t.sdk.WERR_INVALID_PARAMETER(`update.${d}`,"undefined");const g=this.validatePartialForUpdate(c),b=this.toDbTrx([y],"readwrite",p),w=b.objectStore(y),v=Array.isArray(n)?n:[n];try{for(const _ of v){const S=await w.get(_);if(!S)throw new t.sdk.WERR_INVALID_PARAMETER("id",`an existing record to update ${d} ${_} not found`);const T={...S,...g},I=await w.put(T);if(I!==_)throw new t.sdk.WERR_INTERNAL(`updated id ${I} does not match original ${n}`)}}finally{p||await b.done}return 1}async updateIdbKey(n,c,d,y,p){if(n.length!==d.length)throw new t.sdk.WERR_INTERNAL(`key.length ${n.length} !== keyProps.length ${d.length}`);for(let v=0;v<n.length;v++)if(c[d[v]]!==void 0&&c[d[v]]!==n[v])throw new t.sdk.WERR_INVALID_PARAMETER(`update.${d[v]}`,"undefined");const g=this.validatePartialForUpdate(c),b=this.toDbTrx([y],"readwrite",p),w=b.objectStore(y);try{const v=await w.get(n);if(!v)throw new t.sdk.WERR_INVALID_PARAMETER("key",`an existing record to update ${d.join(",")} ${n.join(",")} not found`);const _={...v,...g},S=await w.put(_);for(let T=0;T<n.length;T++)if(S[T]!==n[T])throw new t.sdk.WERR_INTERNAL(`updated key ${S[T]} does not match original ${n[T]}`)}finally{p||await b.done}return 1}async updateCertificate(n,c,d){return this.updateIdb(n,c,"certificateId","certificates",d)}async updateCertificateField(n,c,d,y){return this.updateIdbKey([n,c],d,["certificateId","fieldName"],"certificate_fields",y)}async updateCommission(n,c,d){return this.updateIdb(n,c,"commissionId","commissions",d)}async updateMonitorEvent(n,c,d){return this.updateIdb(n,c,"id","monitor_events",d)}async updateOutput(n,c,d){return this.updateIdb(n,c,"outputId","outputs",d)}async updateOutputBasket(n,c,d){return this.updateIdb(n,c,"basketId","output_baskets",d)}async updateOutputTag(n,c,d){return this.updateIdb(n,c,"outputTagId","output_tags",d)}async updateProvenTx(n,c,d){return this.updateIdb(n,c,"provenTxId","proven_txs",d)}async updateProvenTxReq(n,c,d){return this.updateIdb(n,c,"provenTxReqId","proven_tx_reqs",d)}async updateSyncState(n,c,d){return this.updateIdb(n,c,"syncStateId","sync_states",d)}async updateTransaction(n,c,d){return this.updateIdb(n,c,"transactionId","transactions",d)}async updateTxLabel(n,c,d){return this.updateIdb(n,c,"txLabelId","tx_labels",d)}async updateUser(n,c,d){return this.updateIdb(n,c,"userId","users",d)}async updateOutputTagMap(n,c,d,y){return this.updateIdbKey([c,n],d,["outputTagId","outputId"],"output_tags_map",y)}async updateTxLabelMap(n,c,d,y){return this.updateIdbKey([c,n],d,["txLabelId","transactionId"],"tx_labels_map",y)}async destroy(){this.db&&this.db.close(),this.db=void 0,this._settings=void 0}async transaction(n,c){if(c)return await n(c);const d=this.allStores,p=(await this.verifyDB()).transaction(d,"readwrite");try{const g=await n(p);return await p.done,g}catch(g){throw p.abort(),await p.done,g}}async filterCertificateFields(n,c){var d,y,p,g;const b=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let w=0,v=0;const _=this.toDbTrx(["certificate_fields"],"readonly",n.trx);let S;((y=n.partial)===null||y===void 0?void 0:y.certificateId)!==void 0?S=await _.objectStore("certificate_fields").index("certificateId").openCursor(n.partial.certificateId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?S=await _.objectStore("certificate_fields").index("userId").openCursor(n.partial.userId):S=await _.objectStore("certificate_fields").openCursor();let T=!0;for(;S&&(T||(S=await S.continue()),!!S);){T=!1;const I=S.value;if(!(n.since&&n.since>I.updated_at)&&!(n.partial&&(n.partial.userId&&I.userId!==n.partial.userId||n.partial.certificateId&&I.certificateId!==n.partial.certificateId||n.partial.created_at&&I.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&I.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.fieldName&&I.fieldName!==n.partial.fieldName||n.partial.fieldValue&&I.fieldValue!==n.partial.fieldValue||n.partial.masterKey&&I.masterKey!==n.partial.masterKey))){if(w<b){w++;continue}if(c(I),v++,!((g=n.paged)===null||g===void 0)&&g.limit&&v>=n.paged.limit)break}}n.trx||await _.done}async findCertificateFields(n){const c=[];return await this.filterCertificateFields(n,d=>{c.push(this.validateEntity(d))}),c}async filterCertificates(n,c){var d,y,p,g,b,w,v;const _=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let S=0,T=0;const I=this.toDbTrx(["certificates"],"readonly",n.trx);let k;!((y=n.partial)===null||y===void 0)&&y.certificateId?k=await I.objectStore("certificates").openCursor(n.partial.certificateId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?!((g=n.partial)===null||g===void 0)&&g.type&&(!((b=n.partial)===null||b===void 0)&&b.certifier)&&(!((w=n.partial)===null||w===void 0)&&w.serialNumber)?k=await I.objectStore("certificates").index("userId_type_certifier_serialNumber").openCursor([n.partial.userId,n.partial.type,n.partial.certifier,n.partial.serialNumber]):k=await I.objectStore("certificates").index("userId").openCursor(n.partial.userId):k=await I.objectStore("certificates").openCursor();let O=!0;for(;k&&(O||(k=await k.continue()),!!k);){O=!1;const A=k.value;if(!(n.since&&n.since>A.updated_at)&&!(n.certifiers&&!n.certifiers.includes(A.certifier))&&!(n.types&&!n.types.includes(A.type))&&!(n.partial&&(n.partial.userId&&A.userId!==n.partial.userId||n.partial.certificateId&&A.certificateId!==n.partial.certificateId||n.partial.created_at&&A.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&A.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.type&&A.type!==n.partial.type||n.partial.serialNumber&&A.serialNumber!==n.partial.serialNumber||n.partial.certifier&&A.certifier!==n.partial.certifier||n.partial.subject&&A.subject!==n.partial.subject||n.partial.verifier&&A.verifier!==n.partial.verifier||n.partial.revocationOutpoint&&A.revocationOutpoint!==n.partial.revocationOutpoint||n.partial.signature&&A.signature!==n.partial.signature||n.partial.isDeleted&&A.isDeleted!==n.partial.isDeleted))){if(S<_){S++;continue}if(c(A),T++,!((v=n.paged)===null||v===void 0)&&v.limit&&T>=n.paged.limit)break}}n.trx||await I.done}async findCertificates(n){const c=[];if(await this.filterCertificates(n,d=>{c.push(this.validateEntity(d))}),n.includeFields)for(const d of c){const y=await this.findCertificateFields({partial:{certificateId:d.certificateId},trx:n.trx});d.fields=y}return c}async filterCommissions(n,c){var d,y,p,g,b;if(n.partial.lockingScript)throw new t.sdk.WERR_INVALID_PARAMETER("partial.lockingScript","undefined. Commissions may not be found by lockingScript value.");const w=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let v=0,_=0;const S=this.toDbTrx(["commissions"],"readonly",n.trx);let T;!((y=n.partial)===null||y===void 0)&&y.commissionId?T=await S.objectStore("commissions").openCursor(n.partial.commissionId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?T=await S.objectStore("commissions").index("userId").openCursor(n.partial.userId):((g=n.partial)===null||g===void 0?void 0:g.transactionId)!==void 0?T=await S.objectStore("commissions").index("transactionId").openCursor(n.partial.transactionId):T=await S.objectStore("commissions").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.commissionId&&k.commissionId!==n.partial.commissionId||n.partial.transactionId&&k.transactionId!==n.partial.transactionId||n.partial.userId&&k.userId!==n.partial.userId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.satoshis!==void 0&&k.satoshis!==n.partial.satoshis||n.partial.keyOffset&&k.keyOffset!==n.partial.keyOffset||n.partial.isRedeemed!==void 0&&k.isRedeemed!==n.partial.isRedeemed))){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findCommissions(n){const c=[];return await this.filterCommissions(n,d=>{c.push(this.validateEntity(d))}),c}async filterMonitorEvents(n,c){var d,y,p;const g=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let b=0,w=0;const v=this.toDbTrx(["monitor_events"],"readonly",n.trx);let _;!((y=n.partial)===null||y===void 0)&&y.id?_=await v.objectStore("monitor_events").openCursor(n.partial.id):_=await v.objectStore("monitor_events").openCursor();let S=!0;for(;_&&(S||(_=await _.continue()),!!_);){S=!1;const T=_.value;if(!(n.since&&n.since>T.updated_at)&&!(n.partial&&(n.partial.id&&T.id!==n.partial.id||n.partial.created_at&&T.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&T.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.event&&T.event!==n.partial.event||n.partial.details&&T.details!==n.partial.details))){if(b<g){b++;continue}if(c(T),w++,!((p=n.paged)===null||p===void 0)&&p.limit&&w>=n.paged.limit)break}}n.trx||await v.done}async findMonitorEvents(n){const c=[];return await this.filterMonitorEvents(n,d=>{c.push(this.validateEntity(d))}),c}async filterOutputBaskets(n,c){var d,y,p,g,b;const w=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let v=0,_=0;const S=this.toDbTrx(["output_baskets"],"readonly",n.trx);let T;!((y=n.partial)===null||y===void 0)&&y.basketId?T=await S.objectStore("output_baskets").openCursor(n.partial.basketId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?((g=n.partial)===null||g===void 0?void 0:g.name)!==void 0?T=await S.objectStore("output_baskets").index("name_userId").openCursor([n.partial.name,n.partial.userId]):T=await S.objectStore("output_baskets").index("userId").openCursor(n.partial.userId):T=await S.objectStore("output_baskets").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.basketId&&k.basketId!==n.partial.basketId||n.partial.userId&&k.userId!==n.partial.userId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.name&&k.name!==n.partial.name||n.partial.numberOfDesiredUTXOs!==void 0&&k.numberOfDesiredUTXOs!==n.partial.numberOfDesiredUTXOs||n.partial.minimumDesiredUTXOValue!==void 0&&k.numberOfDesiredSatoshis!==n.partial.minimumDesiredUTXOValue||n.partial.isDeleted!==void 0&&k.isDeleted!==n.partial.isDeleted))){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findOutputBaskets(n){const c=[];return await this.filterOutputBaskets(n,d=>{c.push(this.validateEntity(d))}),c}async filterOutputs(n,c,d,y){var p,g,b,w,v,_,S,T,I;if(n.partial.lockingScript)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.lockingScript","undefined. Outputs may not be found by lockingScript value.");const k=((p=n.paged)===null||p===void 0?void 0:p.offset)||0;let O=0,A=0;const R=["outputs"];d&&d.length>0&&R.push("output_tags_map"),n.txStatus&&R.push("transactions");const P=this.toDbTrx(R,"readonly",n.trx);let C;!((g=n.partial)===null||g===void 0)&&g.outputId?C=await P.objectStore("outputs").openCursor(n.partial.outputId):((b=n.partial)===null||b===void 0?void 0:b.userId)!==void 0?!((w=n.partial)===null||w===void 0)&&w.transactionId&&((v=n.partial)===null||v===void 0?void 0:v.vout)!==void 0?C=await P.objectStore("outputs").index("transactionId_vout_userId").openCursor([n.partial.transactionId,n.partial.vout,n.partial.userId]):C=await P.objectStore("outputs").index("userId").openCursor(n.partial.userId):((_=n.partial)===null||_===void 0?void 0:_.transactionId)!==void 0?C=await P.objectStore("outputs").index("transactionId").openCursor(n.partial.transactionId):((S=n.partial)===null||S===void 0?void 0:S.basketId)!==void 0?C=await P.objectStore("outputs").index("basketId").openCursor(n.partial.basketId):((T=n.partial)===null||T===void 0?void 0:T.spentBy)!==void 0?C=await P.objectStore("outputs").index("spentBy").openCursor(n.partial.spentBy):C=await P.objectStore("outputs").openCursor();let N=!0;for(;C&&(N||(C=await C.continue()),!!C);){N=!1;const D=C.value;if(!(n.since&&n.since>D.updated_at)&&!(n.partial&&(n.partial.outputId&&D.outputId!==n.partial.outputId||n.partial.userId&&D.userId!==n.partial.userId||n.partial.transactionId&&D.transactionId!==n.partial.transactionId||n.partial.basketId&&D.basketId!==n.partial.basketId||n.partial.created_at&&D.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&D.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.spendable!==void 0&&D.spendable!==n.partial.spendable||n.partial.change!==void 0&&D.change!==n.partial.change||n.partial.outputDescription&&D.outputDescription!==n.partial.outputDescription||n.partial.vout!==void 0&&D.vout!==n.partial.vout||n.partial.satoshis!==void 0&&D.satoshis!==n.partial.satoshis||n.partial.providedBy&&D.providedBy!==n.partial.providedBy||n.partial.purpose&&D.purpose!==n.partial.purpose||n.partial.type&&D.type!==n.partial.type||n.partial.txid&&D.txid!==n.partial.txid||n.partial.senderIdentityKey&&D.senderIdentityKey!==n.partial.senderIdentityKey||n.partial.derivationPrefix&&D.derivationPrefix!==n.partial.derivationPrefix||n.partial.derivationSuffix&&D.derivationSuffix!==n.partial.derivationSuffix||n.partial.customInstructions&&D.customInstructions!==n.partial.customInstructions||n.partial.spentBy&&D.spentBy!==n.partial.spentBy||n.partial.sequenceNumber!==void 0&&D.sequenceNumber!==n.partial.sequenceNumber||n.partial.scriptLength!==void 0&&D.scriptLength!==n.partial.scriptLength||n.partial.scriptOffset!==void 0&&D.scriptOffset!==n.partial.scriptOffset))&&!(n.txStatus!==void 0&&await this.countTransactions({partial:{transactionId:D.transactionId},status:n.txStatus,trx:P})===0)){if(d&&d.length>0){let U=[...d];if(await this.filterOutputTagMaps({partial:{outputId:D.outputId},trx:P},F=>{if(U.length>0){const L=U.indexOf(F.outputTagId);L>=0&&(y?U.splice(L,1):U=[])}}),U.length>0)continue}if(O<k){O++;continue}if(n.noScript===!0&&(D.script=void 0),c(D),A++,!((I=n.paged)===null||I===void 0)&&I.limit&&A>=n.paged.limit)break}}n.trx||await P.done}async findOutputs(n,c,d){const y=[];await this.filterOutputs(n,p=>{y.push(this.validateEntity(p))},c,d);for(const p of y)n.noScript?p.lockingScript=void 0:await this.validateOutputScript(p);return y}async filterOutputTags(n,c){var d,y,p,g,b;const w=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let v=0,_=0;const S=this.toDbTrx(["output_tags"],"readonly",n.trx);let T;!((y=n.partial)===null||y===void 0)&&y.outputTagId?T=await S.objectStore("output_tags").openCursor(n.partial.outputTagId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?((g=n.partial)===null||g===void 0?void 0:g.tag)!==void 0?T=await S.objectStore("output_tags").index("tag_userId").openCursor([n.partial.tag,n.partial.userId]):T=await S.objectStore("output_tags").index("userId").openCursor(n.partial.userId):T=await S.objectStore("output_tags").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.outputTagId&&k.outputTagId!==n.partial.outputTagId||n.partial.userId&&k.userId!==n.partial.userId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.tag&&k.tag!==n.partial.tag||n.partial.isDeleted!==void 0&&k.isDeleted!==n.partial.isDeleted))){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findOutputTags(n){const c=[];return await this.filterOutputTags(n,d=>{c.push(this.validateEntity(d))}),c}async filterSyncStates(n,c){var d,y,p,g,b,w,v;if(n.partial.syncMap)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.syncMap","undefined. SyncStates may not be found by syncMap value.");const _=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let S=0,T=0;const I=this.toDbTrx(["sync_states"],"readonly",n.trx);let k;!((y=n.partial)===null||y===void 0)&&y.syncStateId?k=await I.objectStore("sync_states").openCursor(n.partial.syncStateId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?k=await I.objectStore("sync_states").index("userId").openCursor(n.partial.userId):((g=n.partial)===null||g===void 0?void 0:g.refNum)!==void 0?k=await I.objectStore("sync_states").index("refNum").openCursor(n.partial.refNum):((b=n.partial)===null||b===void 0?void 0:b.status)!==void 0?k=await I.objectStore("sync_states").index("status").openCursor(n.partial.status):k=await I.objectStore("sync_states").openCursor();let O=!0;for(;k&&(O||(k=await k.continue()),!!k);){O=!1;const A=k.value;if(!(n.since&&n.since>A.updated_at)&&!(n.partial&&(n.partial.syncStateId&&A.syncStateId!==n.partial.syncStateId||n.partial.userId&&A.userId!==n.partial.userId||n.partial.created_at&&A.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&A.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.storageIdentityKey&&A.storageIdentityKey!==n.partial.storageIdentityKey||n.partial.storageName&&A.storageName!==n.partial.storageName||n.partial.status&&A.status!==n.partial.status||n.partial.init!==void 0&&A.init!==n.partial.init||n.partial.refNum!==void 0&&A.refNum!==n.partial.refNum||n.partial.when&&((w=A.when)===null||w===void 0?void 0:w.getTime())!==n.partial.when.getTime()||n.partial.satoshis!==void 0&&A.satoshis!==n.partial.satoshis||n.partial.errorLocal&&A.errorLocale!==n.partial.errorLocal||n.partial.errorOther&&A.errorOther!==n.partial.errorOther))){if(S<_){S++;continue}if(c(A),T++,!((v=n.paged)===null||v===void 0)&&v.limit&&T>=n.paged.limit)break}}n.trx||await I.done}async findSyncStates(n){const c=[];return await this.filterSyncStates(n,d=>{c.push(this.validateEntity(d))}),c}async filterTransactions(n,c,d,y){var p,g,b,w,v,_,S,T;if(n.partial.rawTx)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. Transactions may not be found by rawTx value.");if(n.partial.inputBEEF)throw new t.sdk.WERR_INVALID_PARAMETER("args.partial.inputBEEF","undefined. Transactions may not be found by inputBEEF value.");const I=((p=n.paged)===null||p===void 0?void 0:p.offset)||0;let k=0,O=0;const A=["transactions"];d&&d.length>0&&A.push("tx_labels_map");const R=this.toDbTrx(A,"readonly",n.trx);let P;!((g=n.partial)===null||g===void 0)&&g.transactionId?P=await R.objectStore("transactions").openCursor(n.partial.transactionId):((b=n.partial)===null||b===void 0?void 0:b.userId)!==void 0?((w=n.partial)===null||w===void 0?void 0:w.status)!==void 0?P=await R.objectStore("transactions").index("status_userId").openCursor([n.partial.status,n.partial.userId]):P=await R.objectStore("transactions").index("userId").openCursor(n.partial.userId):((v=n.partial)===null||v===void 0?void 0:v.status)!==void 0?P=await R.objectStore("transactions").index("status").openCursor(n.partial.status):((_=n.partial)===null||_===void 0?void 0:_.provenTxId)!==void 0?P=await R.objectStore("transactions").index("provenTxId").openCursor(n.partial.provenTxId):((S=n.partial)===null||S===void 0?void 0:S.reference)!==void 0?P=await R.objectStore("transactions").index("reference").openCursor(n.partial.reference):P=await R.objectStore("transactions").openCursor();let C=!0;for(;P&&(C||(P=await P.continue()),!!P);){C=!1;const N=P.value;if(!(n.since&&n.since>N.updated_at)&&!(n.status&&!n.status.includes(N.status))&&!(n.partial&&(n.partial.transactionId&&N.transactionId!==n.partial.transactionId||n.partial.userId&&N.userId!==n.partial.userId||n.partial.created_at&&N.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&N.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.provenTxId&&N.provenTxId!==n.partial.provenTxId||n.partial.status&&N.status!==n.partial.status||n.partial.reference&&N.reference!==n.partial.reference||n.partial.isOutgoing!==void 0&&N.isOutgoing!==n.partial.isOutgoing||n.partial.satoshis!==void 0&&N.satoshis!==n.partial.satoshis||n.partial.description&&N.description!==n.partial.description||n.partial.version!==void 0&&N.version!==n.partial.version||n.partial.lockTime!==void 0&&N.lockTime!==n.partial.lockTime||n.partial.txid&&N.txid!==n.partial.txid))){if(d&&d.length>0){let D=[...d];if(await this.filterTxLabelMaps({partial:{transactionId:N.transactionId},trx:R},U=>{if(D.length>0){const F=D.indexOf(U.txLabelId);F>=0&&(y?D.splice(F,1):D=[])}}),D.length>0)continue}if(k<I){k++;continue}if(c(N),O++,!((T=n.paged)===null||T===void 0)&&T.limit&&O>=n.paged.limit)break}}n.trx||await R.done}async findTransactions(n,c,d){const y=[];await this.filterTransactions(n,p=>{y.push(this.validateEntity(p))},c,d);for(const p of y)n.noRawTx?(p.rawTx=void 0,p.inputBEEF=void 0):await this.validateRawTransaction(p,n.trx);return y}async filterTxLabels(n,c){var d,y,p,g,b;const w=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let v=0,_=0;const S=this.toDbTrx(["tx_labels"],"readonly",n.trx);let T;!((y=n.partial)===null||y===void 0)&&y.txLabelId?T=await S.objectStore("tx_labels").openCursor(n.partial.txLabelId):((p=n.partial)===null||p===void 0?void 0:p.userId)!==void 0?((g=n.partial)===null||g===void 0?void 0:g.label)!==void 0?T=await S.objectStore("tx_labels").index("label_userId").openCursor([n.partial.label,n.partial.userId]):T=await S.objectStore("tx_labels").index("userId").openCursor(n.partial.userId):T=await S.objectStore("tx_labels").openCursor();let I=!0;for(;T&&(I||(T=await T.continue()),!!T);){I=!1;const k=T.value;if(!(n.since&&n.since>k.updated_at)&&!(n.partial&&(n.partial.txLabelId&&k.txLabelId!==n.partial.txLabelId||n.partial.userId&&k.userId!==n.partial.userId||n.partial.created_at&&k.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&k.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.label&&k.label!==n.partial.label||n.partial.isDeleted!==void 0&&k.isDeleted!==n.partial.isDeleted))){if(v<w){v++;continue}if(c(k),_++,!((b=n.paged)===null||b===void 0)&&b.limit&&_>=n.paged.limit)break}}n.trx||await S.done}async findTxLabels(n){const c=[];return await this.filterTxLabels(n,d=>{c.push(this.validateEntity(d))}),c}async filterUsers(n,c){var d,y;const p=((d=n.paged)===null||d===void 0?void 0:d.offset)||0;let g=0,b=0;const w=this.toDbTrx(["users"],"readonly",n.trx);let v=await w.objectStore("users").openCursor(),_=!0;for(;v&&(_||(v=await v.continue()),!!v);){_=!1;const S=v.value;if(!(n.since&&n.since>S.updated_at)&&!(n.partial&&(n.partial.userId&&S.userId!==n.partial.userId||n.partial.created_at&&S.created_at.getTime()!==n.partial.created_at.getTime()||n.partial.updated_at&&S.updated_at.getTime()!==n.partial.updated_at.getTime()||n.partial.identityKey&&S.identityKey!==n.partial.identityKey||n.partial.activeStorage&&S.activeStorage!==n.partial.activeStorage))){if(g<p){g++;continue}if(c(S),b++,!((y=n.paged)===null||y===void 0)&&y.limit&&b>=n.paged.limit)break}}n.trx||await w.done}async findUsers(n){const c=[];return await this.filterUsers(n,d=>{c.push(this.validateEntity(d))}),c}async countCertificateFields(n){let c=0;return await this.filterCertificateFields(n,()=>{c++}),c}async countCertificates(n){let c=0;return await this.filterCertificates(n,()=>{c++}),c}async countCommissions(n){let c=0;return await this.filterCommissions(n,()=>{c++}),c}async countMonitorEvents(n){let c=0;return await this.filterMonitorEvents(n,()=>{c++}),c}async countOutputBaskets(n){let c=0;return await this.filterOutputBaskets(n,()=>{c++}),c}async countOutputs(n,c,d){let y=0;return await this.filterOutputs({...n,noScript:!0},()=>{y++},c,d),y}async countOutputTags(n){let c=0;return await this.filterOutputTags(n,()=>{c++}),c}async countSyncStates(n){let c=0;return await this.filterSyncStates(n,()=>{c++}),c}async countTransactions(n,c,d){let y=0;return await this.filterTransactions({...n,noRawTx:!0},()=>{y++},c,d),y}async countTxLabels(n){let c=0;return await this.filterTxLabels(n,()=>{c++}),c}async countUsers(n){let c=0;return await this.filterUsers(n,()=>{c++}),c}async getProvenTxsForUser(n){const c=[],d={partial:{},since:n.since,paged:n.paged,trx:n.trx};return await this.filterProvenTxs(d,y=>{c.push(this.validateEntity(y))},n.userId),c}async getProvenTxReqsForUser(n){const c=[],d={partial:{},since:n.since,paged:n.paged,trx:n.trx};return await this.filterProvenTxReqs(d,y=>{c.push(this.validateEntity(y))},n.userId),c}async getTxLabelMapsForUser(n){const c=[],d={partial:{},since:n.since,paged:n.paged,trx:n.trx};return await this.filterTxLabelMaps(d,y=>{c.push(this.validateEntity(y))},n.userId),c}async getOutputTagMapsForUser(n){const c=[],d={partial:{},since:n.since,paged:n.paged,trx:n.trx};return await this.filterOutputTagMaps(d,y=>{c.push(this.validateEntity(y))},n.userId),c}async verifyReadyForDatabaseAccess(n){return this._settings||(this._settings=await this.readSettings()),this._settings.dbtype}validateEntity(n,c,d){if(n.created_at=this.validateDate(n.created_at),n.updated_at=this.validateDate(n.updated_at),c)for(const y of c)n[y]&&(n[y]=this.validateDate(n[y]));if(d)for(const y of d)n[y]!==void 0&&(n[y]=!!n[y]);for(const y of Object.keys(n)){const p=n[y];p===null?n[y]=void 0:p instanceof Uint8Array&&(n[y]=Array.from(p))}return n}validateEntities(n,c,d){for(let y=0;y<n.length;y++)n[y]=this.validateEntity(n[y],c,d);return n}validatePartialForUpdate(n,c,d){if(!this.dbtype)throw new t.sdk.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");const y={...n};if(y.created_at&&(y.created_at=this.validateEntityDate(y.created_at)),y.updated_at&&(y.updated_at=this.validateEntityDate(y.updated_at)),y.created_at||delete y.created_at,y.updated_at||(y.updated_at=this.validateEntityDate(new Date)),c)for(const p of c)y[p]&&(y[p]=this.validateOptionalEntityDate(y[p]));if(d)for(const p of d)n[p]!==void 0&&(n[p]=n[p]?1:0);for(const p of Object.keys(y)){const g=y[p];Array.isArray(g)&&(g.length===0||Number.isInteger(g[0]))?y[p]=Uint8Array.from(g):g===null&&(y[p]=void 0)}return this.isDirty=!0,y}async validateEntityForInsert(n,c,d,y){await this.verifyReadyForDatabaseAccess(c);const p={...n};if(p.created_at=this.validateOptionalEntityDate(p.created_at,!0),p.updated_at=this.validateOptionalEntityDate(p.updated_at,!0),p.created_at||delete p.created_at,p.updated_at||delete p.updated_at,d)for(const g of d)p[g]&&(p[g]=this.validateOptionalEntityDate(p[g]));if(y)for(const g of y)n[g]!==void 0&&(n[g]=n[g]?1:0);for(const g of Object.keys(p)){const b=p[g];Array.isArray(b)&&(b.length===0||Number.isInteger(b[0]))?p[g]=Uint8Array.from(b):b===null&&(p[g]=void 0)}return this.isDirty=!0,p}async validateRawTransaction(n,c){if(n.rawTx||!n.txid)return;const d=await this.getRawTxOfKnownValidTransaction(n.txid,void 0,void 0,c);d&&(n.rawTx=d)}async adminStats(n){throw new Error("Method intentionally not implemented for personal storage.")}};return Kl.StorageIdb=l,Kl}var Q4;function bB(){if(Q4)return Hl;Q4=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.SetupClient=void 0;const s=ge(),t=se(),i=ik();let r=class ns{static async createWallet(o){const a=o.chain,l=s.PrivateKey.fromHex(o.rootKeyHex),f=l.toPublicKey().toString(),n=new s.KeyDeriver(l),c=new t.WalletStorageManager(f,o.active,o.backups);c.canMakeAvailable()&&await c.makeAvailable();const d=t.Services.createDefaultOptions(a);d.taalApiKey=o.taalApiKey;const y=new t.Services(d),p=t.Monitor.createDefaultWalletMonitorOptions(a,c,y),g=new t.Monitor(p);g.addDefaultTasks();const b=o.privilegedKeyGetter?new t.sdk.PrivilegedKeyManager(o.privilegedKeyGetter):void 0,w=new t.Wallet({chain:a,keyDeriver:n,storage:c,services:y,monitor:g,privilegedKeyManager:b});return{rootKey:l,identityKey:f,keyDeriver:n,chain:a,storage:c,services:y,monitor:g,wallet:w}}static async createWalletClientNoEnv(o){const a=o.chain,l=o.storageUrl||`https://${o.chain!=="main"?"staging-":""}storage.babbage.systems`,f=s.PrivateKey.fromHex(o.rootKeyHex),n=new s.KeyDeriver(f),c=new t.WalletStorageManager(n.identityKey),d=new t.Services(a),y=o.privilegedKeyGetter?new t.sdk.PrivilegedKeyManager(o.privilegedKeyGetter):void 0,p=new t.Wallet({chain:a,keyDeriver:n,storage:c,services:d,privilegedKeyManager:y}),g=new t.StorageClient(p,l);return await c.addWalletStorageProvider(g),await c.makeAvailable(),p}static async createWalletClient(o){const a=await ns.createWallet(o),l=o.endpointUrl||`https://${o.chain!=="main"?"staging-":""}storage.babbage.systems`,f=new t.StorageClient(a.wallet,l);return await a.storage.addWalletStorageProvider(f),await a.storage.makeAvailable(),{...a,endpointUrl:l}}static getKeyPair(o){o===void 0?o=s.PrivateKey.fromRandom():typeof o=="string"&&(o=new s.PrivateKey(o,"hex"));const a=s.PublicKey.fromPrivateKey(o),l=a.toAddress();return{privateKey:o,publicKey:a,address:l}}static getLockP2PKH(o){return new s.P2PKH().lock(o)}static getUnlockP2PKH(o,a){const l=new s.P2PKH,f=ns.getLockP2PKH(ns.getKeyPair(o).address);return l.unlock(o,"all",!1,a,f)}static createP2PKHOutputs(o){const a=[],l=o.length;for(let f=0;f<l;f++){const n=o[f];a.push({basket:n.basket,tags:n.tags,satoshis:n.satoshis,lockingScript:ns.getLockP2PKH(n.address).toHex(),outputDescription:n.outputDescription||`p2pkh ${f}`})}return a}static async createP2PKHOutputsAction(o,a,l){const f=ns.createP2PKHOutputs(a),n={description:"createP2PKHOutputs",outputs:f,options:{...l,randomizeOutputs:!1}},c=await o.createAction(n);let d;return c.txid&&(d=f.map((y,p)=>`${c.txid}.${p}`)),{cr:c,outpoints:d}}static async fundWalletFromP2PKHOutpoints(o,a,l,f){}static async createWalletIdb(o){const a=await ns.createWallet(o),l=await ns.createStorageIdb(o);await a.storage.addWalletStorageProvider(l);const{user:f,isNew:n}=await l.findOrInsertUser(a.identityKey),c=f.userId;return{...a,activeStorage:l,userId:c}}static async createStorageIdb(o){const a=new i.StorageIdb({chain:o.chain,commissionSatoshis:0,commissionPubKeyHex:void 0,feeModel:{model:"sat/kb",value:1}});return await a.migrate(o.databaseName,(0,t.randomBytesHex)(33)),await a.makeAvailable(),a}};return Hl.SetupClient=r,Hl}var km={},Z4;function wB(){return Z4||(Z4=1,Object.defineProperty(km,"__esModule",{value:!0})),km}var ud={},J4;function vB(){if(J4)return ud;J4=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.WalletSigner=void 0;let s=class{constructor(i,r,e){this.isWalletSigner=!0,this.chain=i,this.keyDeriver=r,this.storage=e}};return ud.WalletSigner=s,ud}var ld={},t6;function xB(){if(t6)return ld;t6=1,Object.defineProperty(ld,"__esModule",{value:!0}),ld.WalletPermissionsManager=void 0;const s=ge(),t=Rr(),i={protocol:"admin protocol-permission",basket:"admin basket-access",certificate:"admin certificate-access",spending:"admin spending-authorization"};let r=class ba{constructor(o,a,l={}){this.callbacks={onProtocolPermissionRequested:[],onBasketAccessRequested:[],onCertificateAccessRequested:[],onSpendingAuthorizationRequested:[]},this.activeRequests=new Map,this.underlying=o,this.adminOriginator=a,this.config={seekProtocolPermissionsForSigning:!0,seekProtocolPermissionsForEncrypting:!0,seekProtocolPermissionsForHMAC:!0,seekPermissionsForKeyLinkageRevelation:!0,seekPermissionsForPublicKeyRevelation:!0,seekPermissionsForIdentityKeyRevelation:!0,seekPermissionsForIdentityResolution:!0,seekBasketInsertionPermissions:!0,seekBasketRemovalPermissions:!0,seekBasketListingPermissions:!0,seekPermissionWhenApplyingActionLabels:!0,seekPermissionWhenListingActionsByLabel:!0,seekCertificateDisclosurePermissions:!0,seekCertificateAcquisitionPermissions:!0,seekCertificateRelinquishmentPermissions:!0,seekCertificateListingPermissions:!0,encryptWalletMetadata:!0,seekSpendingPermissions:!0,differentiatePrivilegedOperations:!0,...l}}bindCallback(o,a){const l=this.callbacks[o];return l.push(a),l.length-1}unbindCallback(o,a){if(!this.callbacks[o])return!1;const l=this.callbacks[o];if(typeof a=="number")return l[a]?(l[a]=null,!0):!1;{const f=l.indexOf(a);return f!==-1?(l[f]=null,!0):!1}}async callEvent(o,a){const l=this.callbacks[o]||[];for(const f of l)if(typeof f=="function")try{await f(a)}catch{}}async grantPermission(o){const a=this.activeRequests.get(o.requestID);if(!a)throw new Error("Request ID not found.");for(const l of a.pending)l.resolve(!0);this.activeRequests.delete(o.requestID),o.ephemeral||(a.request.renewal?await this.renewPermissionOnChain(a.request.previousToken,a.request,o.expiry||Math.floor(Date.now()/1e3)+3600*24*30,o.amount):await this.createPermissionOnChain(a.request,o.expiry||Math.floor(Date.now()/1e3)+3600*24*30,o.amount))}async denyPermission(o){const a=this.activeRequests.get(o);if(!a)throw new Error("Request ID not found.");for(const l of a.pending)l.reject(new Error("Permission denied."));this.activeRequests.delete(o)}async ensureProtocolPermission({originator:o,privileged:a,protocolID:l,counterparty:f,reason:n,seekPermission:c=!0,usageType:d}){if(this.isAdminOriginator(o))return!0;const[y,p]=l;if(y===0)return!0;if(this.isAdminProtocol(l))throw new Error(`Protocol “${p}” is admin-only.`);if(d==="signing"&&!this.config.seekProtocolPermissionsForSigning||d==="encrypting"&&!this.config.seekProtocolPermissionsForEncrypting||d==="hmac"&&!this.config.seekProtocolPermissionsForHMAC||d==="publicKey"&&!this.config.seekPermissionsForPublicKeyRevelation||d==="identityKey"&&!this.config.seekPermissionsForIdentityKeyRevelation||d==="linkageRevelation"&&!this.config.seekPermissionsForKeyLinkageRevelation)return!0;this.config.differentiatePrivilegedOperations||(a=!1);const g=await this.findProtocolToken(o,a,l,f,!0);if(g)if(this.isTokenExpired(g.expiry)){if(!c)throw new Error("Protocol permission expired and no further user consent allowed (seekPermission=false).");return await this.requestPermissionFlow({type:"protocol",originator:o,privileged:a,protocolID:l,counterparty:f,reason:n,renewal:!0,previousToken:g})}else return!0;else{if(!c)throw new Error("No protocol permission token found (seekPermission=false).");return await this.requestPermissionFlow({type:"protocol",originator:o,privileged:a,protocolID:l,counterparty:f,reason:n,renewal:!1})}}async ensureBasketAccess({originator:o,basket:a,reason:l,seekPermission:f=!0,usageType:n}){if(this.isAdminOriginator(o))return!0;if(this.isAdminBasket(a))throw new Error(`Basket “${a}” is admin-only.`);if(n==="insertion"&&!this.config.seekBasketInsertionPermissions||n==="removal"&&!this.config.seekBasketRemovalPermissions||n==="listing"&&!this.config.seekBasketListingPermissions)return!0;const c=await this.findBasketToken(o,a,!0);if(c)if(this.isTokenExpired(c.expiry)){if(!f)throw new Error("Basket permission expired (seekPermission=false).");return await this.requestPermissionFlow({type:"basket",originator:o,basket:a,reason:l,renewal:!0,previousToken:c})}else return!0;else{if(!f)throw new Error("No basket permission found, and no user consent allowed (seekPermission=false).");return await this.requestPermissionFlow({type:"basket",originator:o,basket:a,reason:l,renewal:!1})}}async ensureCertificateAccess({originator:o,privileged:a,verifier:l,certType:f,fields:n,reason:c,seekPermission:d=!0,usageType:y}){if(this.isAdminOriginator(o)||y==="disclosure"&&!this.config.seekCertificateDisclosurePermissions)return!0;this.config.differentiatePrivilegedOperations||(a=!1);const p=await this.findCertificateToken(o,a,l,f,n,!0);if(p)if(this.isTokenExpired(p.expiry)){if(!d)throw new Error("Certificate permission expired (seekPermission=false).");return await this.requestPermissionFlow({type:"certificate",originator:o,privileged:a,certificate:{verifier:l,certType:f,fields:n},reason:c,renewal:!0,previousToken:p})}else return!0;else{if(!d)throw new Error("No certificate permission found (seekPermission=false).");return await this.requestPermissionFlow({type:"certificate",originator:o,privileged:a,certificate:{verifier:l,certType:f,fields:n},reason:c,renewal:!1})}}async ensureSpendingAuthorization({originator:o,satoshis:a,lineItems:l,reason:f,seekPermission:n=!0}){if(this.isAdminOriginator(o)||!this.config.seekSpendingPermissions)return!0;const c=await this.findSpendingToken(o);if(c!=null&&c.authorizedAmount){if(await this.querySpentSince(c)+a<=c.authorizedAmount)return!0;if(!n)throw new Error(`Spending authorization insufficient for ${a}, no user consent (seekPermission=false).`);return await this.requestPermissionFlow({type:"spending",originator:o,spending:{satoshis:a,lineItems:l},reason:f,renewal:!0,previousToken:c})}else{if(!n)throw new Error("No spending authorization found, (seekPermission=false).");return await this.requestPermissionFlow({type:"spending",originator:o,spending:{satoshis:a,lineItems:l},reason:f,renewal:!1})}}async ensureLabelAccess({originator:o,label:a,reason:l,seekPermission:f=!0,usageType:n}){if(this.isAdminOriginator(o))return!0;if(this.isAdminLabel(a))throw new Error(`Label “${a}” is admin-only.`);return n==="apply"&&!this.config.seekPermissionWhenApplyingActionLabels||n==="list"&&!this.config.seekPermissionWhenListingActionsByLabel?!0:await this.ensureProtocolPermission({originator:o,privileged:!1,protocolID:[1,`action label ${a}`],counterparty:"self",reason:l,seekPermission:f,usageType:"generic"})}async requestPermissionFlow(o){const a=this.buildRequestKey(o),l=this.activeRequests.get(a);return l&&l.pending.length>0?new Promise((f,n)=>{l.pending.push({resolve:f,reject:n})}):new Promise(async(f,n)=>{switch(this.activeRequests.set(a,{request:o,pending:[{resolve:f,reject:n}]}),o.type){case"protocol":await this.callEvent("onProtocolPermissionRequested",{...o,requestID:a});break;case"basket":await this.callEvent("onBasketAccessRequested",{...o,requestID:a});break;case"certificate":await this.callEvent("onCertificateAccessRequested",{...o,requestID:a});break;case"spending":await this.callEvent("onSpendingAuthorizationRequested",{...o,requestID:a});break}})}async encryptPermissionTokenField(o){const a=typeof o=="string"?s.Utils.toArray(o,"utf8"):o,{ciphertext:l}=await this.underlying.encrypt({plaintext:a,protocolID:ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return l}async decryptPermissionTokenField(o){try{const{plaintext:a}=await this.underlying.decrypt({ciphertext:o,protocolID:ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return a}catch{return o}}async maybeEncryptMetadata(o){if(!this.config.encryptWalletMetadata)return o;const{ciphertext:a}=await this.underlying.encrypt({plaintext:s.Utils.toArray(o,"utf8"),protocolID:ba.METADATA_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return s.Utils.toBase64(a)}async maybeDecryptMetadata(o){try{const{plaintext:a}=await this.underlying.decrypt({ciphertext:s.Utils.toArray(o,"base64"),protocolID:ba.METADATA_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return s.Utils.toUTF8(a)}catch{return o}}isTokenExpired(o){const a=Math.floor(Date.now()/1e3);return o>0&&o<a}async findProtocolToken(o,a,l,f,n){const[c,d]=l,y=await this.underlying.listOutputs({basket:i.protocol,tags:[`originator ${o}`,`privileged ${!!a}`,`protocolName ${d}`,`protocolSecurityLevel ${c}`,`counterparty ${f}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const p of y.outputs){const[g,b]=p.outpoint.split("."),w=s.Transaction.fromBEEF(y.BEEF,g),v=s.PushDrop.decode(w.outputs[Number(b)].lockingScript);if(!v||!v.fields||v.fields.length<6)continue;const _=v.fields[0],S=v.fields[1],T=v.fields[2],I=v.fields[3],k=v.fields[4],O=v.fields[5],A=s.Utils.toUTF8(await this.decryptPermissionTokenField(_)),R=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(S)),10),P=s.Utils.toUTF8(await this.decryptPermissionTokenField(T))==="true",C=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(I)),10),N=s.Utils.toUTF8(await this.decryptPermissionTokenField(k)),D=s.Utils.toUTF8(await this.decryptPermissionTokenField(O));if(!(A!==o||P!==!!a||C!==c||N!==d||D!==f)&&!(!n&&this.isTokenExpired(R)))return{tx:w.toBEEF(),txid:p.outpoint.split(".")[0],outputIndex:parseInt(p.outpoint.split(".")[1],10),outputScript:w.outputs[Number(b)].lockingScript.toHex(),satoshis:p.satoshis,originator:o,privileged:a,protocol:d,securityLevel:c,expiry:R,counterparty:D}}}async findBasketToken(o,a,l){const f=await this.underlying.listOutputs({basket:i.basket,tags:[`originator ${o}`,`basket ${a}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const n of f.outputs){const[c,d]=n.outpoint.split("."),y=s.Transaction.fromBEEF(f.BEEF,c),p=s.PushDrop.decode(y.outputs[Number(d)].lockingScript);if(!(p!=null&&p.fields)||p.fields.length<3)continue;const g=p.fields[0],b=p.fields[1],w=p.fields[2],v=s.Utils.toUTF8(await this.decryptPermissionTokenField(g)),_=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(b)),10),S=s.Utils.toUTF8(await this.decryptPermissionTokenField(w));if(!(v!==o||S!==a)&&!(!l&&this.isTokenExpired(_)))return{tx:y.toBEEF(),txid:n.outpoint.split(".")[0],outputIndex:parseInt(n.outpoint.split(".")[1],10),outputScript:y.outputs[Number(d)].lockingScript.toHex(),satoshis:n.satoshis,originator:o,basketName:S,expiry:_}}}async findCertificateToken(o,a,l,f,n,c){const d=await this.underlying.listOutputs({basket:i.certificate,tags:[`originator ${o}`,`privileged ${!!a}`,`type ${f}`,`verifier ${l}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const y of d.outputs){const[p,g]=y.outpoint.split("."),b=s.Transaction.fromBEEF(d.BEEF,p),w=s.PushDrop.decode(b.outputs[Number(g)].lockingScript);if(!(w!=null&&w.fields)||w.fields.length<6)continue;const[v,_,S,T,I,k]=w.fields,O=s.Utils.toUTF8(await this.decryptPermissionTokenField(v)),A=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(_)),10),R=s.Utils.toUTF8(await this.decryptPermissionTokenField(S))==="true",P=s.Utils.toUTF8(await this.decryptPermissionTokenField(T)),C=s.Utils.toUTF8(await this.decryptPermissionTokenField(k)),N=await this.decryptPermissionTokenField(I),D=JSON.parse(s.Utils.toUTF8(N));if(O!==o||R!==!!a||P!==f||C!==l)continue;const U=new Set(D);if(!n.some(F=>!U.has(F))&&!(!c&&this.isTokenExpired(A)))return{tx:b.toBEEF(),txid:y.outpoint.split(".")[0],outputIndex:parseInt(y.outpoint.split(".")[1],10),outputScript:b.outputs[Number(g)].lockingScript.toHex(),satoshis:y.satoshis,originator:o,privileged:a,verifier:C,certType:P,certFields:D,expiry:A}}}async findSpendingToken(o){const a=await this.underlying.listOutputs({basket:i.spending,tags:[`originator ${o}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const l of a.outputs){const[f,n]=l.outpoint.split("."),c=s.Transaction.fromBEEF(a.BEEF,f),d=s.PushDrop.decode(c.outputs[Number(n)].lockingScript);if(!(d!=null&&d.fields)||d.fields.length<2)continue;const y=d.fields[0],p=d.fields[1];if(s.Utils.toUTF8(await this.decryptPermissionTokenField(y))!==o)continue;const b=s.Utils.toUTF8(await this.decryptPermissionTokenField(p)),w=parseInt(b,10);return{tx:c.toBEEF(),txid:l.outpoint.split(".")[0],outputIndex:parseInt(l.outpoint.split(".")[1],10),outputScript:c.outputs[Number(n)].lockingScript.toHex(),satoshis:l.satoshis,originator:o,authorizedAmount:w,expiry:0}}}getCurrentMonthYearUTC(){const o=new Date,a=o.getUTCFullYear(),l=(o.getUTCMonth()+1).toString().padStart(2,"0");return`${a}-${l}`}async querySpentSince(o){const{actions:a}=await this.underlying.listActions({labels:[`admin originator ${o.originator}`,`admin month ${this.getCurrentMonthYearUTC()}`],labelQueryMode:"all"},this.adminOriginator);return a.reduce((l,f)=>l+f.satoshis,0)}async createPermissionOnChain(o,a,l){const f=i[o.type];if(!f)return;const n=await this.buildPushdropFields(o,a,l),c=await new s.PushDrop(this.underlying).lock(n,ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self",!0,!0),d=this.buildTagsForRequest(o);await this.createAction({description:`Grant ${o.type} permission`,outputs:[{lockingScript:c.toHex(),satoshis:1,outputDescription:`${o.type} permission token`,basket:f,tags:d}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator)}async renewPermissionOnChain(o,a,l,f){const n=await this.buildPushdropFields(a,l,f),c=await new s.PushDrop(this.underlying).lock(n,ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self",!0,!0),d=this.buildTagsForRequest(a),y=`${o.txid}.${o.outputIndex}`,{signableTransaction:p}=await this.createAction({description:`Renew ${a.type} permission`,inputBEEF:o.tx,inputs:[{outpoint:y,unlockingScriptLength:73,inputDescription:`Consume old ${a.type} token`}],outputs:[{lockingScript:c.toHex(),satoshis:1,outputDescription:`Renewed ${a.type} permission token`,basket:i[a.type],tags:d}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator),g=s.Transaction.fromBEEF(p.tx),w=await new s.PushDrop(this.underlying).unlock(ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self","all",!1,1,s.LockingScript.fromHex(o.outputScript)).sign(g,0);await this.underlying.signAction({reference:p.reference,spends:{0:{unlockingScript:w.toHex()}}})}async buildPushdropFields(o,a,l){var f;switch(o.type){case"protocol":{const[n,c]=o.protocolID;return[await this.encryptPermissionTokenField(o.originator),await this.encryptPermissionTokenField(String(a)),await this.encryptPermissionTokenField(o.privileged===!0?"true":"false"),await this.encryptPermissionTokenField(String(n)),await this.encryptPermissionTokenField(c),await this.encryptPermissionTokenField(o.counterparty)]}case"basket":return[await this.encryptPermissionTokenField(o.originator),await this.encryptPermissionTokenField(String(a)),await this.encryptPermissionTokenField(o.basket)];case"certificate":{const{certType:n,fields:c,verifier:d}=o.certificate;return[await this.encryptPermissionTokenField(o.originator),await this.encryptPermissionTokenField(String(a)),await this.encryptPermissionTokenField(o.privileged?"true":"false"),await this.encryptPermissionTokenField(n),await this.encryptPermissionTokenField(JSON.stringify(c)),await this.encryptPermissionTokenField(d)]}case"spending":{const n=l??(((f=o.spending)===null||f===void 0?void 0:f.satoshis)||0);return[await this.encryptPermissionTokenField(o.originator),await this.encryptPermissionTokenField(String(n))]}}}buildTagsForRequest(o){const a=[`originator ${o.originator}`];switch(o.type){case"protocol":{a.push(`privileged ${!!o.privileged}`),a.push(`protocolName ${o.protocolID[1]}`),a.push(`protocolSecurityLevel ${o.protocolID[0]}`),a.push(`counterparty ${o.counterparty}`);break}case"basket":{a.push(`basket ${o.basket}`);break}case"certificate":{a.push(`privileged ${!!o.privileged}`),a.push(`type ${o.certificate.certType}`),a.push(`verifier ${o.certificate.verifier}`);break}}return a}async listProtocolPermissions({originator:o}){const a=i.protocol,l=o?[`originator ${o}`]:[],f=await this.underlying.listOutputs({basket:a,tags:l,tagQueryMode:"all",include:"entire transactions",limit:100},this.adminOriginator),n=[];for(const c of f.outputs){const[d,y]=c.outpoint.split("."),p=s.Transaction.fromBEEF(f.BEEF,d),g=s.PushDrop.decode(p.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<6)continue;const[b,w,v,_,S,T]=g.fields,I=s.Utils.toUTF8(await this.decryptPermissionTokenField(b)),k=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(w)),10),O=s.Utils.toUTF8(await this.decryptPermissionTokenField(v))==="true",A=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(_)),10),R=s.Utils.toUTF8(await this.decryptPermissionTokenField(S)),P=s.Utils.toUTF8(await this.decryptPermissionTokenField(T));n.push({tx:p.toBEEF(),txid:c.outpoint.split(".")[0],outputIndex:parseInt(c.outpoint.split(".")[1],10),outputScript:p.outputs[Number(y)].lockingScript.toHex(),satoshis:c.satoshis,originator:I,expiry:k,privileged:O,securityLevel:A,protocol:R,counterparty:P})}return n}async hasProtocolPermission(o){try{return await this.ensureProtocolPermission({...o,reason:"hasProtocolPermission",seekPermission:!1,usageType:"generic"}),!0}catch{return!1}}async listBasketAccess(o){const a=i.basket,l=[];o.originator&&l.push(`originator ${o.originator}`);const f=await this.underlying.listOutputs({basket:a,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),n=[];for(const c of f.outputs){const[d,y]=c.outpoint.split("."),p=s.Transaction.fromBEEF(f.BEEF,d),g=s.PushDrop.decode(p.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<3)continue;const[b,w,v]=g.fields,_=s.Utils.toUTF8(await this.decryptPermissionTokenField(b)),S=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(w)),10),T=s.Utils.toUTF8(await this.decryptPermissionTokenField(v));n.push({tx:p.toBEEF(),txid:c.outpoint.split(".")[0],outputIndex:parseInt(c.outpoint.split(".")[1],10),satoshis:c.satoshis,outputScript:p.outputs[Number(y)].lockingScript.toHex(),originator:_,basketName:T,expiry:S})}return n}async hasBasketAccess(o){try{return await this.ensureBasketAccess({originator:o.originator,basket:o.basket,seekPermission:!1,usageType:"insertion"}),!0}catch{return!1}}async listSpendingAuthorizations(o){const a=i.spending,l=[];o.originator&&l.push(`originator ${o.originator}`);const f=await this.underlying.listOutputs({basket:a,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),n=[];for(const c of f.outputs){const[d,y]=c.outpoint.split("."),p=s.Transaction.fromBEEF(f.BEEF,d),g=s.PushDrop.decode(p.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<2)continue;const[b,w]=g.fields,v=s.Utils.toUTF8(await this.decryptPermissionTokenField(b)),_=s.Utils.toUTF8(await this.decryptPermissionTokenField(w)),S=parseInt(_,10);n.push({tx:p.toBEEF(),txid:c.outpoint.split(".")[0],outputIndex:parseInt(c.outpoint.split(".")[1],10),satoshis:c.satoshis,outputScript:p.outputs[Number(y)].lockingScript.toHex(),originator:v,authorizedAmount:S,expiry:0})}return n}async hasSpendingAuthorization(o){try{return await this.ensureSpendingAuthorization({originator:o.originator,satoshis:o.satoshis,seekPermission:!1}),!0}catch{return!1}}async listCertificateAccess(o){const a=i.certificate,l=[];o.originator&&l.push(`originator ${o.originator}`);const f=await this.underlying.listOutputs({basket:a,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),n=[];for(const c of f.outputs){const[d,y]=c.outpoint.split("."),p=s.Transaction.fromBEEF(f.BEEF,d),g=s.PushDrop.decode(p.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<6)continue;const[b,w,v,_,S,T]=g.fields,I=s.Utils.toUTF8(await this.decryptPermissionTokenField(b)),k=parseInt(s.Utils.toUTF8(await this.decryptPermissionTokenField(w)),10),O=s.Utils.toUTF8(await this.decryptPermissionTokenField(v))==="true",A=s.Utils.toUTF8(await this.decryptPermissionTokenField(_)),R=s.Utils.toUTF8(await this.decryptPermissionTokenField(T)),P=await this.decryptPermissionTokenField(S),C=JSON.parse(s.Utils.toUTF8(P));n.push({tx:p.toBEEF(),txid:c.outpoint.split(".")[0],outputIndex:parseInt(c.outpoint.split(".")[1],10),satoshis:c.satoshis,outputScript:p.outputs[Number(y)].lockingScript.toHex(),originator:I,privileged:O,certType:A,certFields:C,verifier:R,expiry:k})}return n}async hasCertificateAccess(o){try{return await this.ensureCertificateAccess({originator:o.originator,privileged:o.privileged,verifier:o.verifier,certType:o.certType,fields:o.fields,seekPermission:!1,usageType:"disclosure"}),!0}catch{return!1}}async revokePermission(o){const a=`${o.txid}.${o.outputIndex}`,{signableTransaction:l}=await this.createAction({description:"Revoke permission",inputBEEF:o.tx,inputs:[{outpoint:a,unlockingScriptLength:73,inputDescription:"Consume old permission token"}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator),f=s.Transaction.fromBEEF(l.tx),c=await new s.PushDrop(this.underlying).unlock(ba.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self","all",!1,1,s.LockingScript.fromHex(o.outputScript)).sign(f,0);await this.underlying.signAction({reference:l.reference,spends:{0:{unlockingScript:c.toHex()}}})}async createAction(o,a){if(o.outputs)for(const T of o.outputs)T.basket&&await this.ensureBasketAccess({originator:a,basket:T.basket,reason:o.description,usageType:"insertion"});if(o.labels)for(const T of o.labels)await this.ensureLabelAccess({originator:a,label:T,reason:o.description,usageType:"apply"});const l={...o.options||{}};if(l.signAndProcess!==!0)l.signAndProcess=!1;else if(!this.isAdminOriginator(a))throw new Error("Only the admin originator can set signAndProcess=true explicitly.");const f=o.description,n={},c={};o.description=await this.maybeEncryptMetadata(o.description);for(let T=0;T<(o.inputs||[]).length;T++)o.inputs[T].inputDescription&&(n[T]=o.inputs[T].inputDescription,o.inputs[T].inputDescription=await this.maybeEncryptMetadata(o.inputs[T].inputDescription));for(let T=0;T<(o.outputs||[]).length;T++)o.outputs[T].outputDescription&&(c[T]=o.outputs[T].outputDescription,o.outputs[T].outputDescription=await this.maybeEncryptMetadata(o.outputs[T].outputDescription)),o.outputs[T].customInstructions&&(o.outputs[T].customInstructions=await this.maybeEncryptMetadata(o.outputs[T].customInstructions));const d=await this.underlying.createAction({...o,options:l,labels:[...o.labels||[],`admin originator ${a}`,`admin month ${this.getCurrentMonthYearUTC()}`]},a);if(!d.signableTransaction)return d;const y=s.Transaction.fromAtomicBEEF(d.signableTransaction.tx),p=d.signableTransaction.reference;let g=0;const b=[];let w=0;for(const T of y.inputs){const I=`${T.sourceTXID}.${T.sourceOutputIndex}`,k=(o.inputs||[]).findIndex(O=>O.outpoint===I);if(k!==-1){const O=T.sourceTransaction.outputs[T.sourceOutputIndex].satoshis;w+=O,b.push({type:"input",description:n[k]||"No input description provided",satoshis:O})}}const v=(o.outputs||[]).reduce((T,I)=>T+I.satoshis,0);for(const T in o.outputs||[]){const I=o.outputs[T];b.push({type:"output",satoshis:I.satoshis,description:c[T]||"No output description provided"})}if(b.push({type:"fee",satoshis:y.getFee(),description:"Network fee"}),g=v+y.getFee()-w,g>0)try{await this.ensureSpendingAuthorization({originator:a,satoshis:g,lineItems:b,reason:f})}catch(T){throw await this.underlying.abortAction({reference:p}),T}if((0,t.validateCreateActionArgs)(o).isSignAction)return d;const S=await this.underlying.signAction({reference:p,spends:{},options:o.options},a);return{...d,...S,signableTransaction:void 0}}async signAction(...o){return this.underlying.signAction(...o)}async abortAction(...o){return this.underlying.abortAction(...o)}async listActions(...o){const[a,l]=o;if(a.labels)for(const n of a.labels)await this.ensureLabelAccess({originator:l,label:n,reason:"listActions",usageType:"list"});const f=await this.underlying.listActions(...o);if(f.actions)for(let n=0;n<f.actions.length;n++){if(f.actions[n].description&&(f.actions[n].description=await this.maybeDecryptMetadata(f.actions[n].description)),f.actions[n].inputs)for(let c=0;c<f.actions[n].inputs.length;c++)f.actions[n].inputs[c].inputDescription&&(f.actions[n].inputs[c].inputDescription=await this.maybeDecryptMetadata(f.actions[n].inputs[c].inputDescription));if(f.actions[n].outputs)for(let c=0;c<f.actions[n].outputs.length;c++)f.actions[n].outputs[c].outputDescription&&(f.actions[n].outputs[c].outputDescription=await this.maybeDecryptMetadata(f.actions[n].outputs[c].outputDescription)),f.actions[n].outputs[c].customInstructions&&(f.actions[n].outputs[c].customInstructions=await this.maybeDecryptMetadata(f.actions[n].outputs[c].customInstructions))}return f}async internalizeAction(...o){const[a,l]=o;for(const f in a.outputs){const n=a.outputs[f];n.protocol==="basket insertion"&&(await this.ensureBasketAccess({originator:l,basket:n.insertionRemittance.basket,reason:a.description,usageType:"insertion"}),n.insertionRemittance.customInstructions&&(a.outputs[f].insertionRemittance.customInstructions=await this.maybeEncryptMetadata(n.insertionRemittance.customInstructions)))}return this.underlying.internalizeAction(...o)}async listOutputs(...o){const[a,l]=o;await this.ensureBasketAccess({originator:l,basket:a.basket,reason:"listOutputs",usageType:"listing"});const f=await this.underlying.listOutputs(...o);if(f.outputs)for(let n=0;n<f.outputs.length;n++)f.outputs[n].customInstructions&&(f.outputs[n].customInstructions=await this.maybeDecryptMetadata(f.outputs[n].customInstructions));return f}async relinquishOutput(...o){const[a,l]=o;return await this.ensureBasketAccess({originator:l,basket:a.basket,reason:"relinquishOutput",usageType:"removal"}),this.underlying.relinquishOutput(...o)}async getPublicKey(...o){const[a,l]=o;return a.protocolID&&await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"publicKey"}),a.identityKey&&await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:[1,"identity key retrieval"],counterparty:"self",reason:a.privilegedReason,usageType:"identityKey"}),this.underlying.getPublicKey(...o)}async revealCounterpartyKeyLinkage(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:[2,`counterparty key linkage revelation ${a.counterparty}`],counterparty:a.verifier,reason:a.privilegedReason,usageType:"linkageRevelation"}),this.underlying.revealCounterpartyKeyLinkage(...o)}async revealSpecificKeyLinkage(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:[2,`specific key linkage revelation ${a.protocolID[1]} ${a.protocolID[0]===2?a.keyID:"all"}`],counterparty:a.verifier,reason:a.privilegedReason,usageType:"linkageRevelation"}),this.underlying.revealSpecificKeyLinkage(...o)}async encrypt(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,protocolID:a.protocolID,privileged:a.privileged,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"encrypting"}),this.underlying.encrypt(...o)}async decrypt(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"encrypting"}),this.underlying.decrypt(...o)}async createHmac(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"hmac"}),this.underlying.createHmac(...o)}async verifyHmac(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"hmac"}),this.underlying.verifyHmac(...o)}async createSignature(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"signing"}),this.underlying.createSignature(...o)}async verifySignature(...o){const[a,l]=o;return await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:a.protocolID,counterparty:a.counterparty||"self",reason:a.privilegedReason,usageType:"signing"}),this.underlying.verifySignature(...o)}async acquireCertificate(...o){const[a,l]=o;return this.config.seekCertificateAcquisitionPermissions&&await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:[1,`certificate acquisition ${a.type}`],counterparty:"self",reason:a.privilegedReason,usageType:"generic"}),this.underlying.acquireCertificate(...o)}async listCertificates(...o){const[a,l]=o;return this.config.seekCertificateListingPermissions&&await this.ensureProtocolPermission({originator:l,privileged:a.privileged,protocolID:[1,"certificate list"],counterparty:"self",reason:a.privilegedReason,usageType:"generic"}),this.underlying.listCertificates(...o)}async proveCertificate(...o){const[a,l]=o;return await this.ensureCertificateAccess({originator:l,privileged:a.privileged,verifier:a.verifier,certType:a.certificate.type,fields:a.fieldsToReveal,reason:"proveCertificate",usageType:"disclosure"}),this.underlying.proveCertificate(...o)}async relinquishCertificate(...o){const[a,l]=o;return this.config.seekCertificateRelinquishmentPermissions&&await this.ensureProtocolPermission({originator:l,privileged:!!a.privileged,protocolID:[1,`certificate relinquishment ${a.type}`],counterparty:"self",reason:a.privilegedReason||"relinquishCertificate",usageType:"generic"}),this.underlying.relinquishCertificate(...o)}async discoverByIdentityKey(...o){const[a,l]=o;return this.config.seekPermissionsForIdentityResolution&&await this.ensureProtocolPermission({originator:l,privileged:!1,protocolID:[1,"identity resolution"],counterparty:"self",reason:"discoverByIdentityKey",usageType:"generic"}),this.underlying.discoverByIdentityKey(...o)}async discoverByAttributes(...o){const[a,l]=o;return this.config.seekPermissionsForIdentityResolution&&await this.ensureProtocolPermission({originator:l,privileged:!1,protocolID:[1,"identity resolution"],counterparty:"self",reason:"discoverByAttributes",usageType:"generic"}),this.underlying.discoverByAttributes(...o)}async isAuthenticated(...o){return this.underlying.isAuthenticated(...o)}async waitForAuthentication(...o){return this.underlying.waitForAuthentication(...o)}async getHeight(...o){return this.underlying.getHeight(...o)}async getHeaderForHeight(...o){return this.underlying.getHeaderForHeight(...o)}async getNetwork(...o){return this.underlying.getNetwork(...o)}async getVersion(...o){return this.underlying.getVersion(...o)}isAdminOriginator(o){return o===this.adminOriginator}isAdminProtocol(o){const a=o[1];return!!(a.startsWith("admin")||a.startsWith("p "))}isAdminLabel(o){return!!o.startsWith("admin")}isAdminBasket(o){return!!(o==="default"||o.startsWith("admin")||o.startsWith("p "))}buildRequestKey(o){var a,l,f,n;switch(o.type){case"protocol":return`proto:${o.originator}:${!!o.privileged}:${(a=o.protocolID)===null||a===void 0?void 0:a.join(",")}:${o.counterparty}`;case"basket":return`basket:${o.originator}:${o.basket}`;case"certificate":return`cert:${o.originator}:${!!o.privileged}:${(l=o.certificate)===null||l===void 0?void 0:l.verifier}:${(f=o.certificate)===null||f===void 0?void 0:f.certType}:${(n=o.certificate)===null||n===void 0?void 0:n.fields.join("|")}`;case"spending":return`spend:${o.originator}`}}};return ld.WalletPermissionsManager=r,r.PERM_TOKEN_ENCRYPTION_PROTOCOL=[2,"admin permission token encryption"],r.METADATA_ENCRYPTION_PROTOCOL=[2,"admin metadata encryption"],ld}var Em={},e6;function nk(){return e6||(e6=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.CWIStyleWalletManager=s.OverlayUMPTokenInteractor=s.DEFAULT_PROFILE_ID=s.PBKDF2_NUM_ROUNDS=void 0;const t=ge(),i=w1();s.PBKDF2_NUM_ROUNDS=7777,s.DEFAULT_PROFILE_ID=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class r{constructor(a=new t.LookupResolver,l=new t.SHIPBroadcaster(["tm_users"])){this.resolver=a,this.broadcaster=l}async findByPresentationKeyHash(a){const l={service:"ls_users",query:{presentationHash:t.Utils.toHex(a)}},f=await this.resolver.query(l);return this.parseLookupAnswer(f)}async findByRecoveryKeyHash(a){const l={service:"ls_users",query:{recoveryHash:t.Utils.toHex(a)}},f=await this.resolver.query(l);return this.parseLookupAnswer(f)}async buildAndSend(a,l,f,n){const c=[];c[0]=f.passwordSalt,c[1]=f.passwordPresentationPrimary,c[2]=f.passwordRecoveryPrimary,c[3]=f.presentationRecoveryPrimary,c[4]=f.passwordPrimaryPrivileged,c[5]=f.presentationRecoveryPrivileged,c[6]=f.presentationHash,c[7]=f.recoveryHash,c[8]=f.presentationKeyEncrypted,c[9]=f.passwordKeyEncrypted,c[10]=f.recoveryKeyEncrypted,f.profilesEncrypted&&(c[11]=f.profilesEncrypted);const d=await new t.PushDrop(a,l).lock(c,[2,"admin user management token"],"1","self",!0,!0),y=[];let p;n!=null&&n.currentOutpoint&&(p=await this.findByOutpoint(n.currentOutpoint),p?y.push({outpoint:n.currentOutpoint,unlockingScriptLength:73,inputDescription:"Consume old UMP token"}):n=void 0);const g=[{lockingScript:d.toHex(),satoshis:1,outputDescription:"New UMP token output"}];let b;try{b=await a.createAction({description:n?"Renew UMP token (consume old, create new)":"Create new UMP token",inputs:y,outputs:g,inputBEEF:p==null?void 0:p.beef,options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1}},l)}catch(S){console.error("Error with UMP token update. Attempting a last-ditch effort to get a new one",S),b=await a.createAction({description:"Recover UMP token",outputs:g,options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1}},l)}if(!b.signableTransaction){const S=b.txid||(b.tx?t.Transaction.fromAtomicBEEF(b.tx).id("hex"):void 0);if(!S)throw new Error("No signableTransaction and no final TX found.");const T=t.Transaction.fromAtomicBEEF(b.tx),I=await this.broadcaster.broadcast(T);return console.log("BROADCAST RESULT",I),`${S}.0`}let w="";const v=b.signableTransaction.reference,_=t.Transaction.fromBEEF(b.signableTransaction.tx);if(n!=null&&n.currentOutpoint){const T=await new t.PushDrop(a,l).unlock([2,"admin user management token"],"1","self").sign(_,0),I=await a.signAction({reference:v,spends:{0:{unlockingScript:T.toHex()}}},l);if(w=I.txid||(I.tx?t.Transaction.fromAtomicBEEF(I.tx).id("hex"):""),!w)throw new Error("Could not finalize transaction for renewed UMP token.");const k=I.tx;if(!k)throw new Error("Final transaction data missing after signing renewed UMP token.");const O=t.Transaction.fromAtomicBEEF(k),A=await this.broadcaster.broadcast(O);return console.log("BROADCAST RESULT",A),`${w}.0`}else{const S=await a.signAction({reference:v,spends:{}},l);if(w=S.txid||(S.tx?t.Transaction.fromAtomicBEEF(S.tx).id("hex"):""),!w)throw new Error("Failed to finalize new UMP token transaction.");const T=S.tx;if(!T)throw new Error("Final transaction data missing after signing new UMP token.");const I=t.Transaction.fromAtomicBEEF(T),k=await this.broadcaster.broadcast(I);return console.log("BROADCAST RESULT",k),`${w}.0`}}parseLookupAnswer(a){var l;if(a.type!=="output-list"||!a.outputs||a.outputs.length===0)return;const{beef:f,outputIndex:n}=a.outputs[0];try{const c=t.Transaction.fromBEEF(f),d=`${c.id("hex")}.${n}`,y=t.PushDrop.decode(c.outputs[n].lockingScript);if(!y.fields||y.fields.length<11){console.warn(`Unexpected number of fields in UMP token: ${(l=y.fields)===null||l===void 0?void 0:l.length}`);return}return{passwordSalt:y.fields[0],passwordPresentationPrimary:y.fields[1],passwordRecoveryPrimary:y.fields[2],presentationRecoveryPrimary:y.fields[3],passwordPrimaryPrivileged:y.fields[4],presentationRecoveryPrivileged:y.fields[5],presentationHash:y.fields[6],recoveryHash:y.fields[7],presentationKeyEncrypted:y.fields[8],passwordKeyEncrypted:y.fields[9],recoveryKeyEncrypted:y.fields[10],profilesEncrypted:y.fields[12]?y.fields[11]:void 0,currentOutpoint:d}}catch(c){console.error("Failed to parse or decode UMP token:",c);return}}async findByOutpoint(a){const l=await this.resolver.query({service:"ls_users",query:{outpoint:a}});if(l.type==="output-list"&&!(!l.outputs||!l.outputs.length))return l.outputs[0]}}s.OverlayUMPTokenInteractor=r;class e{constructor(a,l,f=new r,n,c,d,y){this.authenticationMode="presentation-key-and-password",this.authenticationFlow="new-user",this.activeProfileId=s.DEFAULT_PROFILE_ID,this.profiles=[],this.adminOriginator=a,this.walletBuilder=l,this.UMPTokenInteractor=f,this.recoveryKeySaver=n,this.passwordRetriever=c,this.authenticated=!1,this.newWalletFunder=d,y&&this.loadSnapshot(y).catch(p=>{console.error("Failed to load snapshot during construction:",p),this.destroy()})}async providePresentationKey(a){if(this.authenticated)throw new Error("User is already authenticated");if(this.authenticationMode==="recovery-key-and-password")throw new Error("Presentation key is not needed in this mode");const l=t.Hash.sha256(a),f=await this.UMPTokenInteractor.findByPresentationKeyHash(l);f?(this.authenticationFlow="existing-user",this.presentationKey=a,this.currentUMPToken=f):(this.authenticationFlow="new-user",this.presentationKey=a)}async providePassword(a){if(this.authenticated)throw new Error("User is already authenticated");if(this.authenticationMode==="presentation-key-and-recovery-key")throw new Error("Password is not needed in this mode");if(this.authenticationFlow==="existing-user"){if(!this.currentUMPToken)throw new Error("Provide presentation or recovery key first.");const l=t.Hash.pbkdf2(t.Utils.toArray(a,"utf8"),this.currentUMPToken.passwordSalt,s.PBKDF2_NUM_ROUNDS,32,"sha512");let f,n;if(this.authenticationMode==="presentation-key-and-password"){if(!this.presentationKey)throw new Error("No presentation key found!");const c=this.XOR(this.presentationKey,l);f=new t.SymmetricKey(c).decrypt(this.currentUMPToken.passwordPresentationPrimary)}else{if(!this.recoveryKey)throw new Error("No recovery key found!");const c=this.XOR(this.recoveryKey,l);f=new t.SymmetricKey(c).decrypt(this.currentUMPToken.passwordRecoveryPrimary);const d=this.XOR(f,l);n=new t.SymmetricKey(d).decrypt(this.currentUMPToken.passwordPrimaryPrivileged)}await this.setupRootInfrastructure(f,n),await this.switchProfile(this.activeProfileId)}else{if(this.authenticationMode!=="presentation-key-and-password")throw new Error("New-user flow requires presentation key and password mode.");if(!this.presentationKey)throw new Error("No presentation key provided for new-user flow.");const l=(0,t.Random)(32);await this.recoveryKeySaver(l);const f=(0,t.Random)(32),n=t.Hash.pbkdf2(t.Utils.toArray(a,"utf8"),f,s.PBKDF2_NUM_ROUNDS,32,"sha512"),c=(0,t.Random)(32),d=(0,t.Random)(32),y=new t.SymmetricKey(this.XOR(this.presentationKey,n)),p=new t.SymmetricKey(this.XOR(this.presentationKey,l)),g=new t.SymmetricKey(this.XOR(l,n)),b=new t.SymmetricKey(this.XOR(c,n)),w=new i.PrivilegedKeyManager(async()=>new t.PrivateKey(d)),v={passwordSalt:f,passwordPresentationPrimary:y.encrypt(c),passwordRecoveryPrimary:g.encrypt(c),presentationRecoveryPrimary:p.encrypt(c),passwordPrimaryPrivileged:b.encrypt(d),presentationRecoveryPrivileged:p.encrypt(d),presentationHash:t.Hash.sha256(this.presentationKey),recoveryHash:t.Hash.sha256(l),presentationKeyEncrypted:(await w.encrypt({plaintext:this.presentationKey,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,passwordKeyEncrypted:(await w.encrypt({plaintext:n,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,recoveryKeyEncrypted:(await w.encrypt({plaintext:l,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,profilesEncrypted:void 0};if(this.currentUMPToken=v,await this.setupRootInfrastructure(c),await this.switchProfile(s.DEFAULT_PROFILE_ID),this.newWalletFunder&&this.underlying)try{await this.newWalletFunder(this.presentationKey,this.underlying,this.adminOriginator)}catch(_){console.error("Error funding new wallet:",_)}if(!this.underlying)throw new Error("Default profile wallet not built before attempting to publish UMP token.");this.currentUMPToken.currentOutpoint=await this.UMPTokenInteractor.buildAndSend(this.underlying,this.adminOriginator,v)}}async provideRecoveryKey(a){if(this.authenticated)throw new Error("Already authenticated");if(this.authenticationFlow==="new-user")throw new Error("Do not submit recovery key in new-user flow");if(this.authenticationMode==="presentation-key-and-password")throw new Error("No recovery key required in this mode");if(this.authenticationMode==="recovery-key-and-password"){const l=t.Hash.sha256(a),f=await this.UMPTokenInteractor.findByRecoveryKeyHash(l);if(!f)throw new Error("No user found with this recovery key");this.recoveryKey=a,this.currentUMPToken=f}else{if(!this.presentationKey)throw new Error("Provide the presentation key first");if(!this.currentUMPToken)throw new Error("Current UMP token not found");const l=this.XOR(this.presentationKey,a),f=new t.SymmetricKey(l).decrypt(this.currentUMPToken.presentationRecoveryPrimary),n=new t.SymmetricKey(l).decrypt(this.currentUMPToken.presentationRecoveryPrivileged);await this.setupRootInfrastructure(f,n),await this.switchProfile(this.activeProfileId)}}saveSnapshot(){if(!this.rootPrimaryKey||!this.currentUMPToken)throw new Error("No root primary key or current UMP token set");const a=(0,t.Random)(32),l=new t.Utils.Writer;if(l.write(this.rootPrimaryKey),!this.currentUMPToken.currentOutpoint)throw new Error("UMP token cannot be saved without a current outpoint.");const f=this.serializeUMPToken(this.currentUMPToken);l.writeVarIntNum(f.length),l.write(f);const n=l.toArray(),c=new t.SymmetricKey(a).encrypt(n),d=new t.Utils.Writer;return d.writeUInt8(2),d.write(a),d.write(this.activeProfileId),d.write(c),d.toArray()}async loadSnapshot(a){try{const l=new t.Utils.Reader(a),f=l.readUInt8();let n,c,d=s.DEFAULT_PROFILE_ID;if(f===1)n=l.read(32),c=l.read();else if(f===2)n=l.read(32),d=l.read(16),c=l.read();else throw new Error(`Unsupported snapshot version: ${f}`);const y=new t.SymmetricKey(n).decrypt(c),p=new t.Utils.Reader(y),g=p.read(32),b=p.readVarIntNum(),w=p.read(b),v=this.deserializeUMPToken(w);this.currentUMPToken=v,await this.setupRootInfrastructure(g),await this.switchProfile(d),this.authenticationFlow="existing-user"}catch(l){throw this.destroy(),new Error(`Failed to load snapshot: ${l.message}`)}}destroy(){this.underlying=void 0,this.rootPrivilegedKeyManager=void 0,this.authenticated=!1,this.rootPrimaryKey=void 0,this.currentUMPToken=void 0,this.presentationKey=void 0,this.recoveryKey=void 0,this.profiles=[],this.activeProfileId=s.DEFAULT_PROFILE_ID,this.authenticationMode="presentation-key-and-password",this.authenticationFlow="new-user"}listProfiles(){if(!this.authenticated)throw new Error("Not authenticated.");return[{id:s.DEFAULT_PROFILE_ID,name:"default",createdAt:null,active:this.activeProfileId.every(l=>l===0)},...this.profiles.map(l=>({id:l.id,name:l.name,createdAt:l.createdAt,active:this.activeProfileId.every((f,n)=>f===l.id[n])}))]}async addProfile(a){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Wallet not fully initialized or authenticated.");if(a==="default"||this.profiles.some(f=>f.name.toLowerCase()===a.toLowerCase()))throw new Error(`Profile name "${a}" is already in use.`);const l={name:a,id:(0,t.Random)(16),primaryPad:(0,t.Random)(32),privilegedPad:(0,t.Random)(32),createdAt:Math.floor(Date.now()/1e3)};return this.profiles.push(l),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,await this.getFactor("passwordKey"),await this.getFactor("presentationKey"),await this.getFactor("recoveryKey"),this.rootPrimaryKey,await this.getFactor("privilegedKey"),this.profiles),l.id}async deleteProfile(a){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Wallet not fully initialized or authenticated.");if(a.every(f=>f===0))throw new Error("Cannot delete the default profile.");const l=this.profiles.findIndex(f=>f.id.every((n,c)=>n===a[c]));if(l===-1)throw new Error("Profile not found.");this.profiles.splice(l,1),this.activeProfileId.every((f,n)=>f===a[n])&&await this.switchProfile(s.DEFAULT_PROFILE_ID),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,await this.getFactor("passwordKey"),await this.getFactor("presentationKey"),await this.getFactor("recoveryKey"),this.rootPrimaryKey,await this.getFactor("privilegedKey"),this.profiles)}async switchProfile(a){if(!this.authenticated||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Cannot switch profile: Wallet not authenticated or root keys missing.");let l,f;if(a.every(c=>c===0))l=this.rootPrimaryKey,f=void 0,this.activeProfileId=s.DEFAULT_PROFILE_ID;else{const c=this.profiles.find(d=>d.id.every((y,p)=>y===a[p]));if(!c)throw new Error("Profile not found.");l=this.XOR(this.rootPrimaryKey,c.primaryPad),f=c.privilegedPad,this.activeProfileId=a}const n=new i.PrivilegedKeyManager(async c=>{const y=(await this.rootPrivilegedKeyManager.getPrivilegedKey(c)).toArray(),p=f?this.XOR(y,f):y;return new t.PrivateKey(p)});this.underlying=await this.walletBuilder(l,n,this.activeProfileId)}async changePassword(a){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");const l=(0,t.Random)(32),f=t.Hash.pbkdf2(t.Utils.toArray(a,"utf8"),l,s.PBKDF2_NUM_ROUNDS,32,"sha512"),n=await this.getFactor("recoveryKey"),c=await this.getFactor("presentationKey"),d=await this.getFactor("privilegedKey");await this.updateAuthFactors(l,f,c,n,this.rootPrimaryKey,d,this.profiles)}async getRecoveryKey(){if(!this.authenticated||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");return this.getFactor("recoveryKey")}async changeRecoveryKey(){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");const a=await this.getFactor("passwordKey"),l=await this.getFactor("presentationKey"),f=await this.getFactor("privilegedKey"),n=(0,t.Random)(32);await this.recoveryKeySaver(n),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,a,l,n,this.rootPrimaryKey,f,this.profiles)}async changePresentationKey(a){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");if(a.length!==32)throw new Error("Presentation key must be 32 bytes.");const l=await this.getFactor("recoveryKey"),f=await this.getFactor("passwordKey"),n=await this.getFactor("privilegedKey");await this.updateAuthFactors(this.currentUMPToken.passwordSalt,f,a,l,this.rootPrimaryKey,n,this.profiles),this.presentationKey&&(this.presentationKey=a)}XOR(a,l){if(a.length!==l.length)throw new Error(`XOR length mismatch: ${a.length} vs ${l.length}`);const f=new Array(a.length);for(let n=0;n<a.length;n++)f[n]=a[n]^l[n];return f}async getFactor(a){if(!this.authenticated||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error(`Cannot get factor "${a}": Wallet not ready.`);const l=[2,"admin key wrapping"],f="1";try{switch(a){case"passwordKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.passwordKeyEncrypted,protocolID:l,keyID:f})).plaintext;case"presentationKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.presentationKeyEncrypted,protocolID:l,keyID:f})).plaintext;case"recoveryKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.recoveryKeyEncrypted,protocolID:l,keyID:f})).plaintext;case"privilegedKey":return(await this.rootPrivilegedKeyManager.getPrivilegedKey("UMP token update",!0)).toArray();default:throw new Error(`Unknown factor name: ${a}`)}}catch(n){throw console.error(`Error decrypting factor ${a}:`,n),new Error(`Failed to decrypt factor "${a}": ${n.message}`)}}async updateAuthFactors(a,l,f,n,c,d,y){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken)throw new Error("Wallet is not properly authenticated or missing data for update.");const p={...this.currentUMPToken};if(!p.currentOutpoint)throw new Error("Cannot update UMP token: Old token has no outpoint.");const g=new t.SymmetricKey(this.XOR(f,l)),b=new t.SymmetricKey(this.XOR(f,n)),w=new t.SymmetricKey(this.XOR(n,l)),v=new t.SymmetricKey(this.XOR(c,l)),_=new i.PrivilegedKeyManager(async()=>new t.PrivateKey(d));let S;if(y&&y.length>0){const O=JSON.stringify(y),A=t.Utils.toArray(O,"utf8");S=new t.SymmetricKey(c).encrypt(A)}const T={passwordSalt:a,passwordPresentationPrimary:g.encrypt(c),passwordRecoveryPrimary:w.encrypt(c),presentationRecoveryPrimary:b.encrypt(c),passwordPrimaryPrivileged:v.encrypt(d),presentationRecoveryPrivileged:b.encrypt(d),presentationHash:t.Hash.sha256(f),recoveryHash:t.Hash.sha256(n),presentationKeyEncrypted:(await _.encrypt({plaintext:f,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,passwordKeyEncrypted:(await _.encrypt({plaintext:l,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,recoveryKeyEncrypted:(await _.encrypt({plaintext:n,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,profilesEncrypted:S},I=this.activeProfileId;let k=this.underlying;if(I.every(O=>O===0)||(console.log("Temporarily switching to default profile to update UMP token..."),await this.switchProfile(s.DEFAULT_PROFILE_ID),k=this.underlying),!k)throw new Error("Default profile wallet could not be activated for UMP token update.");try{T.currentOutpoint=await this.UMPTokenInteractor.buildAndSend(k,this.adminOriginator,T,p),this.currentUMPToken=T}finally{I.every(O=>O===0)||(console.log("Switching back to original profile..."),await this.switchProfile(I))}}serializeUMPToken(a){if(!a.currentOutpoint)throw new Error("Token must have outpoint for serialization");const l=new t.Utils.Writer;l.writeUInt8(2);const f=c=>{l.writeVarIntNum(c.length),l.write(c)};f(a.passwordSalt),f(a.passwordPresentationPrimary),f(a.passwordRecoveryPrimary),f(a.presentationRecoveryPrimary),f(a.passwordPrimaryPrivileged),f(a.presentationRecoveryPrivileged),f(a.presentationHash),f(a.recoveryHash),f(a.presentationKeyEncrypted),f(a.passwordKeyEncrypted),f(a.recoveryKeyEncrypted),a.profilesEncrypted&&a.profilesEncrypted.length>0?(l.writeUInt8(1),f(a.profilesEncrypted)):l.writeUInt8(0);const n=t.Utils.toArray(a.currentOutpoint,"utf8");return l.writeVarIntNum(n.length),l.write(n),l.toArray()}deserializeUMPToken(a){const l=new t.Utils.Reader(a),f=l.readUInt8();if(f!==1&&f!==2)throw new Error(`Unsupported UMP token serialization version: ${f}`);const n=()=>{const P=l.readVarIntNum();return l.read(P)},c=n(),d=n(),y=n(),p=n(),g=n(),b=n(),w=n(),v=n(),_=n(),S=n(),T=n();let I;f===2&&l.readUInt8()===1&&(I=n());const k=l.readVarIntNum(),O=l.read(k),A=t.Utils.toUTF8(O);return{passwordSalt:c,passwordPresentationPrimary:d,passwordRecoveryPrimary:y,presentationRecoveryPrimary:p,passwordPrimaryPrivileged:g,presentationRecoveryPrivileged:b,presentationHash:w,recoveryHash:v,presentationKeyEncrypted:_,passwordKeyEncrypted:S,recoveryKeyEncrypted:T,profilesEncrypted:I,currentOutpoint:A}}async setupRootInfrastructure(a,l){if(!this.currentUMPToken)throw new Error("A UMP token must exist before setting up root infrastructure!");this.rootPrimaryKey=a;let f=l?new t.PrivateKey(l):void 0;if(this.rootPrivilegedKeyManager=new i.PrivilegedKeyManager(async n=>{if(f){const g=f;return f=void 0,g}const c=await this.passwordRetriever(n,g=>{try{const b=t.Hash.pbkdf2(t.Utils.toArray(g,"utf8"),this.currentUMPToken.passwordSalt,s.PBKDF2_NUM_ROUNDS,32,"sha512"),w=this.XOR(this.rootPrimaryKey,b);return!!new t.SymmetricKey(w).decrypt(this.currentUMPToken.passwordPrimaryPrivileged)}catch{return!1}}),d=t.Hash.pbkdf2(t.Utils.toArray(c,"utf8"),this.currentUMPToken.passwordSalt,s.PBKDF2_NUM_ROUNDS,32,"sha512"),y=this.XOR(this.rootPrimaryKey,d),p=new t.SymmetricKey(y).decrypt(this.currentUMPToken.passwordPrimaryPrivileged);return new t.PrivateKey(p)}),this.profiles=[],this.currentUMPToken.profilesEncrypted&&this.currentUMPToken.profilesEncrypted.length>0)try{const n=new t.SymmetricKey(a).decrypt(this.currentUMPToken.profilesEncrypted),c=t.Utils.toUTF8(n);this.profiles=JSON.parse(c)}catch(n){throw console.error("Failed to decrypt or parse profiles:",n),this.profiles=[],new Error(`Failed to load profiles: ${n.message}`)}this.authenticated=!0}checkAuthAndUnderlying(a){if(!this.authenticated)throw new Error("User is not authenticated.");if(!this.underlying)throw new Error("Underlying wallet for the active profile is not initialized.");if(a===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.")}async getPublicKey(a,l){return this.checkAuthAndUnderlying(l),this.underlying.getPublicKey(a,l)}async revealCounterpartyKeyLinkage(a,l){return this.checkAuthAndUnderlying(l),this.underlying.revealCounterpartyKeyLinkage(a,l)}async revealSpecificKeyLinkage(a,l){return this.checkAuthAndUnderlying(l),this.underlying.revealSpecificKeyLinkage(a,l)}async encrypt(a,l){return this.checkAuthAndUnderlying(l),this.underlying.encrypt(a,l)}async decrypt(a,l){return this.checkAuthAndUnderlying(l),this.underlying.decrypt(a,l)}async createHmac(a,l){return this.checkAuthAndUnderlying(l),this.underlying.createHmac(a,l)}async verifyHmac(a,l){return this.checkAuthAndUnderlying(l),this.underlying.verifyHmac(a,l)}async createSignature(a,l){return this.checkAuthAndUnderlying(l),this.underlying.createSignature(a,l)}async verifySignature(a,l){return this.checkAuthAndUnderlying(l),this.underlying.verifySignature(a,l)}async createAction(a,l){return this.checkAuthAndUnderlying(l),this.underlying.createAction(a,l)}async signAction(a,l){return this.checkAuthAndUnderlying(l),this.underlying.signAction(a,l)}async abortAction(a,l){return this.checkAuthAndUnderlying(l),this.underlying.abortAction(a,l)}async listActions(a,l){return this.checkAuthAndUnderlying(l),this.underlying.listActions(a,l)}async internalizeAction(a,l){return this.checkAuthAndUnderlying(l),this.underlying.internalizeAction(a,l)}async listOutputs(a,l){return this.checkAuthAndUnderlying(l),this.underlying.listOutputs(a,l)}async relinquishOutput(a,l){return this.checkAuthAndUnderlying(l),this.underlying.relinquishOutput(a,l)}async acquireCertificate(a,l){return this.checkAuthAndUnderlying(l),this.underlying.acquireCertificate(a,l)}async listCertificates(a,l){return this.checkAuthAndUnderlying(l),this.underlying.listCertificates(a,l)}async proveCertificate(a,l){return this.checkAuthAndUnderlying(l),this.underlying.proveCertificate(a,l)}async relinquishCertificate(a,l){return this.checkAuthAndUnderlying(l),this.underlying.relinquishCertificate(a,l)}async discoverByIdentityKey(a,l){return this.checkAuthAndUnderlying(l),this.underlying.discoverByIdentityKey(a,l)}async discoverByAttributes(a,l){return this.checkAuthAndUnderlying(l),this.underlying.discoverByAttributes(a,l)}async isAuthenticated(a,l){if(!this.authenticated)throw new Error("User is not authenticated.");if(l===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.");return{authenticated:!0}}async waitForAuthentication(a,l){if(l===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.");for(;!this.authenticated||!this.underlying;)await new Promise(f=>setTimeout(f,100));return{authenticated:!0}}async getHeight(a,l){return this.checkAuthAndUnderlying(l),this.underlying.getHeight({},l)}async getHeaderForHeight(a,l){return this.checkAuthAndUnderlying(l),this.underlying.getHeaderForHeight(a,l)}async getNetwork(a,l){return this.checkAuthAndUnderlying(l),this.underlying.getNetwork({},l)}async getVersion(a,l){return this.checkAuthAndUnderlying(l),this.underlying.getVersion({},l)}}s.CWIStyleWalletManager=e}(Em)),Em}var dd={},i6;function _B(){if(i6)return dd;i6=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.WalletAuthenticationManager=void 0;const s=nk(),t=ge();let i=class extends s.CWIStyleWalletManager{constructor(e,o,a=new s.OverlayUMPTokenInteractor,l,f,n,c,d){super(e,o,a,l,f,async(y,p,g)=>{debugger;const{paymentData:b}=await this.wabClient.requestFaucet(t.Utils.toHex(y));if(!b.k||!b.tx)throw new Error("Invalid");const w=t.Transaction.fromAtomicBEEF(b.tx);console.log(b);const v=await p.createAction({inputBEEF:w.toBEEF(),inputs:[{outpoint:`${b.txid}.0`,unlockingScriptLength:108,inputDescription:"Fund from faucet"}],description:"Fund wallet",options:{acceptDelayedBroadcast:!1}},g),_=t.Transaction.fromAtomicBEEF(v.signableTransaction.tx),S=new t.RPuzzle,T=t.PrivateKey.fromRandom(),k=await S.unlock(new t.BigNumber(b.k,16),T).sign(_,0),O=await p.signAction({reference:v.signableTransaction.reference,spends:{0:{unlockingScript:k.toHex()}}});console.log("Sign action result:",O)},d),this.wabClient=n,this.authMethod=c}setAuthMethod(e){this.authMethod=e}async startAuth(e){if(!this.authMethod)throw new Error("No AuthMethod selected in WalletAuthenticationManager");this.tempPresentationKey=this.generateTemporaryPresentationKey();const o=await this.wabClient.startAuthMethod(this.authMethod,this.tempPresentationKey,e);if(!o.success)throw new Error(o.message||"Failed to start WAB auth method")}async completeAuth(e){if(!this.authMethod||!this.tempPresentationKey)throw new Error("No AuthMethod selected in WalletAuthenticationManager or startAuth has yet to be called.");const o=this.tempPresentationKey;this.tempPresentationKey=void 0;const a=await this.wabClient.completeAuthMethod(this.authMethod,o,e);if(!a.success||!a.presentationKey)throw new Error(a.message||"Failed to complete WAB auth");const l=a.presentationKey,f=t.Utils.toArray(l,"hex");await this.providePresentationKey(f)}generateTemporaryPresentationKey(){const e=(0,t.Random)(32);return t.Utils.toHex(e)}};return dd.WalletAuthenticationManager=i,dd}var to={},n6;function SB(){if(n6)return to;n6=1;var s=to&&to.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(to,"__esModule",{value:!0}),to.WABClient=void 0;const t=s(S0);let i=class{constructor(e){this.serverUrl=e}async getInfo(){return(await fetch(`${this.serverUrl}/info`)).json()}generateRandomPresentationKey(){return t.default.randomBytes(32).toString("hex")}async startAuthMethod(e,o,a){return e.startAuth(this.serverUrl,o,a)}async completeAuthMethod(e,o,a){return e.completeAuth(this.serverUrl,o,a)}async listLinkedMethods(e){return(await fetch(`${this.serverUrl}/user/linkedMethods`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:e})})).json()}async unlinkMethod(e,o){return(await fetch(`${this.serverUrl}/user/unlinkMethod`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:e,authMethodId:o})})).json()}async requestFaucet(e){return(await fetch(`${this.serverUrl}/faucet/request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:e})})).json()}async deleteUser(e){return(await fetch(`${this.serverUrl}/user/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:e})})).json()}};return to.WABClient=i,to}var fd={},hd={},r6;function _1(){if(r6)return hd;r6=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.AuthMethodInteractor=void 0;let s=class{};return hd.AuthMethodInteractor=s,hd}var a6;function TB(){if(a6)return fd;a6=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.TwilioPhoneInteractor=void 0;const s=_1();let t=class extends s.AuthMethodInteractor{constructor(){super(...arguments),this.methodType="TwilioPhone"}async startAuth(r,e,o){const a=await fetch(`${r}/auth/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:e,payload:o})});return a.ok?a.json():{success:!1,message:`HTTP error ${a.status}`}}async completeAuth(r,e,o){const a=await fetch(`${r}/auth/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:e,payload:o})});return a.ok?a.json():{success:!1,message:`HTTP error ${a.status}`}}};return fd.TwilioPhoneInteractor=t,fd}var pd={},s6;function IB(){if(s6)return pd;s6=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.PersonaIDInteractor=void 0;const s=_1();let t=class extends s.AuthMethodInteractor{constructor(){super(...arguments),this.methodType="PersonaID"}async startAuth(r,e,o){return(await fetch(`${r}/auth/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:e,payload:o})})).json()}async completeAuth(r,e,o){return(await fetch(`${r}/auth/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:e,payload:o})})).json()}};return pd.PersonaIDInteractor=t,pd}var eo={},yd={},o6;function kB(){if(o6)return yd;o6=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.ServiceCollection=void 0;let s=class rk{constructor(i){this.services=i||[],this._index=0}add(i){return this.services.push(i),this}remove(i){this.services=this.services.filter(r=>r.name!==i)}get name(){return this.services[this._index].name}get service(){return this.services[this._index].service}get allServices(){return this.services.map(i=>i.service)}get count(){return this.services.length}get index(){return this._index}reset(){this._index=0}next(){return this._index=(this._index+1)%this.count,this._index}clone(){return new rk([...this.services])}};return yd.ServiceCollection=s,yd}var gd={},io={},no={},md={},c6;function sk(){if(c6)return md;c6=1,Object.defineProperty(md,"__esModule",{value:!0}),md.ChaintracksServiceClient=void 0;const s=se();let t=class ak{static createChaintracksServiceClientOptions(){return{useAuthrite:!1}}constructor(r,e,o){this.chain=r,this.serviceUrl=e,this.options=o||ak.createChaintracksServiceClientOptions()}async currentHeight(){return await this.getPresentHeight()}async isValidRootForHeight(r,e){const o=await this.findHeaderForHeight(e);return o?r===(0,s.asString)(o.merkleRoot):!1}async getJsonOrUndefined(r){let e;for(let o=0;o<3;o++){try{const l=await(await fetch(`${this.serviceUrl}${r}`)).json();if(l.status==="success")return l.value;e=new Error(JSON.stringify(l))}catch(a){e=a}if(e&&e.name!=="ECONNRESET")break}if(e)throw e}async getJson(r){const e=await this.getJsonOrUndefined(r);if(e===void 0)throw new Error("Value was undefined. Requested object may not exist.");return e}async postJsonVoid(r,e){const o={};o["Content-Type"]="application/json";const a=await fetch(`${this.serviceUrl}${r}`,{body:JSON.stringify(e),method:"POST",headers:o});try{const l=await a.json();if(l.status==="success")return;throw new Error(JSON.stringify(l))}catch(l){throw console.log(`Exception: ${JSON.stringify(l)}`),new Error(JSON.stringify(l))}}async addHeader(r){const e=await this.postJsonVoid("/addHeaderHex",r);if(typeof e=="string")throw new Error(e)}async startListening(){return await this.getJsonOrUndefined("/startListening")}async listening(){return await this.getJsonOrUndefined("/listening")}async getChain(){return this.chain}async isListening(){return await this.getJson("/isListening")}async isSynchronized(){return await this.getJson("/isSynchronized")}async getPresentHeight(){return await this.getJson("/getPresentHeight")}async findChainTipHeader(){return await this.getJson("/findChainTipHeaderHex")}async findChainTipHashHex(){return await this.getJson("/findChainTipHashHex")}async getHeaders(r,e){return await this.getJson(`/getHeaders?height=${r}&count=${e}`)}async findHeaderForHeight(r){return await this.getJsonOrUndefined(`/findHeaderHexForHeight?height=${r}`)}async findChainWorkForBlockHash(r){return await this.getJsonOrUndefined(`/findChainWorkHexForBlockHash?hash=${(0,s.asString)(r)}`)}async findHeaderForBlockHash(r){return await this.getJsonOrUndefined(`/findHeaderHexForBlockHash?hash=${(0,s.asString)(r)}`)}async findHeaderForMerkleRoot(r,e){return await this.getJsonOrUndefined(`/findHeaderHexForMerkleRoot?root=${(0,s.asString)(r)}&height=${e}`)}};return md.ChaintracksServiceClient=t,md}var ro={},u6;function EB(){if(u6)return ro;u6=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.isLive=s,ro.isBaseBlockHeader=t,ro.isBlockHeader=i,ro.isLiveBlockHeader=r;function s(e){return e.headerId!==void 0}function t(e){return typeof e.previousHash=="string"}function i(e){return"height"in e&&typeof e.previousHash=="string"}function r(e){return"chainwork"in e&&typeof e.previousHash=="string"}return ro}var l6;function OB(){return l6||(l6=1,function(s){var t=no&&no.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=no&&no.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(sk(),s),i(EB(),s)}(no)),no}var bd={},d6;function AB(){if(d6)return bd;d6=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.ChaintracksChainTracker=void 0;const s=se(),t=sk();let i=class{constructor(e,o,a){e||(e="main"),this.chaintracks=o??new t.ChaintracksServiceClient(e,`https://npm-registry.babbage.systems:808${e==="main"?"4":"3"}`),this.cache={},this.options=a||{}}async currentHeight(){return await this.chaintracks.getPresentHeight()}async isValidRootForHeight(e,o){const a=this.cache[o];if(a)return a===e;let l;const f=this.options.maxRetries||3;let n;for(let c=1;c<=f;c++)try{if(l=await this.chaintracks.findHeaderForHeight(o),!l)return!1;break}catch(d){if(n=s.sdk.WalletError.fromUnknown(d),c>f)throw n;await(0,s.wait)(1e3)}if(!l)throw new s.sdk.WERR_INTERNAL("no header should have returned false or thrown an error.");return this.cache[o]=l.merkleRoot,l.merkleRoot===e}};return bd.ChaintracksChainTracker=i,bd}var f6;function ok(){return f6||(f6=1,function(s){var t=io&&io.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=io&&io.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(OB(),s),i(AB(),s)}(io)),io}var h6;function PB(){if(h6)return gd;h6=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.createDefaultWalletServicesOptions=i,gd.arcDefaultUrl=r;const s=se(),t=ok();function i(e){const o=e==="main"?"mainnet_9596de07e92300c6287e4393594ae39c":"testnet_0e6cf72133b43ea2d7861da2a38684e3";return{chain:e,taalApiKey:o,bsvExchangeRate:{timestamp:new Date("2023-12-13"),base:"USD",rate:47.52},bsvUpdateMsecs:1e3*60*15,fiatExchangeRates:{timestamp:new Date("2023-12-13"),base:"USD",rates:{USD:1,GBP:.8,EUR:.93}},fiatUpdateMsecs:1e3*60*60*24,disableMapiCallback:!0,exchangeratesapiKey:"bd539d2ff492bcb5619d5f27726a766f",chaintracksFiatExchangeRatesUrl:`https://npm-registry.babbage.systems:${e==="main"?8084:8083}/getFiatExchangeRates`,chaintracks:new t.ChaintracksServiceClient(e,`https://npm-registry.babbage.systems:${e==="main"?8084:8083}`),arcUrl:r(e),arcConfig:{apiKey:o,deploymentId:`wallet-toolbox-${(0,s.randomBytesHex)(16)}`}}}function r(e){return e==="main"?"https://arc.taal.com":"https://arc-test.taal.com"}return gd}var ao={},yp={},p6;function RB(){if(p6)return yp;p6=1,Object.defineProperty(yp,"__esModule",{value:!0});const s=ge();let t=class{constructor(r="main",e={}){const{apiKey:o,httpClient:a}=e;this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}`,this.httpClient=a??(0,s.defaultHttpClient)(),this.apiKey=o??""}async isValidRootForHeight(r,e){const o={method:"GET",headers:this.getHttpHeaders()},a=await this.httpClient.request(`${this.URL}/block/${e}/header`,o);if(a.ok){const{merkleroot:l}=a.data;return l===r}else{if(a.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${e} because of an error: ${JSON.stringify(a.data)} `)}}async currentHeight(){try{const r={method:"GET",headers:this.getHttpHeaders()},e=await this.httpClient.request(`${this.URL}/block/headers`,r);if(e.ok)return e.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(e.data)} `)}catch(r){throw new Error(`Failed to get current height because of an error: ${r instanceof Error?r.message:String(r)}`)}}getHttpHeaders(){const r={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(r.Authorization=this.apiKey),r}};return yp.default=t,yp}var y6;function MB(){if(y6)return ao;y6=1;var s=ao&&ao.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(ao,"__esModule",{value:!0}),ao.WhatsOnChain=void 0;const t=ge(),i=se(),r=LI(),e=s(RB()),o=Rr();let a=class extends e.default{constructor(f="main",n={},c){super(f,n),this.services=c||new i.Services(f)}async getStatusForTxids(f){const n={name:"WoC",status:"error",error:void 0,results:[]},c={method:"POST",headers:this.getHttpHeaders(),data:{txids:f}},d=`${this.URL}/txs/status`;try{const y=await this.httpClient.request(d,c);if(!y.data||!y.ok||y.status!==200)throw new i.sdk.WERR_INVALID_OPERATION("Unable to get status for txids at this timei.");const p=y.data;for(const g of f){const b=p.find(w=>w.txid===g);!b||b.error==="unknown"?n.results.push({txid:g,status:"unknown",depth:void 0}):b.error!==void 0?(console.log(`WhatsOnChain getStatusForTxids unexpected error ${b.error} ${g}`),n.results.push({txid:g,status:"unknown",depth:void 0})):b.confirmations===void 0?n.results.push({txid:g,status:"known",depth:0}):n.results.push({txid:g,status:"mined",depth:b.confirmations})}n.status="success"}catch(y){const p=i.sdk.WalletError.fromUnknown(y);n.error=p}return n}async getTxPropagation(f){const n={method:"GET",headers:this.getHttpHeaders()},c=await this.httpClient.request(`${this.URL}/tx/hash/${f}/propagation`,n);if(!c.data||!c.ok||c.status!==200)throw new i.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${f}' response ${c.statusText}`);return 0}async getRawTx(f){const n=this.getHttpHeaders();n["Cache-Control"]="no-cache";const c={method:"GET",headers:n},d=`${this.URL}/tx/${f}/hex`;for(let y=0;y<2;y++){const p=await this.httpClient.request(d,c);if(p.statusText==="Too Many Requests"&&y<2){await(0,i.wait)(2e3);continue}if(p.status===404&&p.statusText==="Not Found")return;if(!p.data||!p.ok||p.status!==200)throw new i.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${f}' response ${p.statusText}`);return p.data}throw new i.sdk.WERR_INTERNAL}async getRawTxResult(f){const n={name:"WoC",txid:(0,i.asString)(f)};try{const c=await this.getRawTx(f);c&&(n.rawTx=(0,i.asArray)(c))}catch(c){n.error=i.sdk.WalletError.fromUnknown(c)}return n}async postBeef(f,n){const c={name:"WoC",status:"success",txidResults:[],notes:[]};let d=!1;const y=()=>({name:"WoCpostBeef",when:new Date().toISOString()}),p=()=>({...y(),beef:f.toHex(),txids:n.join(",")});for(const g of n){const b=t.Utils.toHex(f.findTxid(g).rawTx);d&&await(0,i.wait)(3e3),d=!0;const w=await this.postRawTx(b);g!==w.txid&&w.notes.push({...p(),what:"postRawTxTxidChanged",txid:g,trTxid:w.txid}),c.txidResults.push(w),c.status==="success"&&w.status!=="success"&&(c.status="error")}return c.status==="success"?c.notes.push({...y(),what:"postBeefSuccess"}):c.notes.push({...p(),what:"postBeefError"}),c}async postRawTx(f){let n=t.Utils.toHex((0,i.doubleSha256BE)(t.Utils.toArray(f,"hex")));const c={txid:n,status:"success",notes:[]},d=this.getHttpHeaders();d["Content-Type"]="application/json",d.Accept="text/plain";const y={method:"POST",headers:d,data:{txhex:f}},p=`${this.URL}/tx/raw`,g=()=>({name:"WoCpostRawTx",when:new Date().toISOString()}),b=()=>({...g(),rawTx:f,txid:n,url:p}),w=5;for(let v=0;v<w;v++){try{const _=await this.httpClient.request(p,y);if(_.statusText==="Too Many Requests"&&v<2){c.notes.push({...g(),what:"postRawTxRateLimit"}),await(0,i.wait)(2e3);continue}if(_.ok){const S=_.data;c.notes.push({...g(),what:"postRawTxSuccess"})}else if(_.data==="unexpected response code 500: Transaction already in the mempool")c.notes.push({...b(),what:"postRawTxSuccessAlreadyInMempool"});else if(c.status="error",_.data==="unexpected response code 500: 258: txn-mempool-conflict")c.doubleSpend=!0,c.competingTxs=void 0,c.notes.push({...b(),what:"postRawTxErrorMempoolConflict"});else if(_.data==="unexpected response code 500: Missing inputs")c.doubleSpend=!0,c.competingTxs=void 0,c.notes.push({...b(),what:"postRawTxErrorMissingInputs"});else{const S={...b(),what:"postRawTxError"};typeof _.data=="string"?(S.data=_.data.slice(0,128),c.data=_.data):c.data="",typeof _.statusText=="string"&&(S.statusText=_.statusText.slice(0,128),c.data+=`,${_.statusText}`),typeof _.status=="string"&&(S.status=_.status.slice(0,128),c.data+=`,${_.status}`),typeof _.status=="number"&&(S.status=_.status,c.data+=`,${_.status}`),c.notes.push(S)}}catch(_){c.status="error";const S=i.sdk.WalletError.fromUnknown(_);c.notes.push({...b(),what:"postRawTxCatch",code:S.code,description:S.description}),c.serviceError=!0,c.data=`${S.code} ${S.description}`}return c}return c.status="error",c.serviceError=!0,c.notes.push({...b(),what:"postRawTxRetryLimit",retryLimit:w}),c}async getMerklePath(f,n){const c={name:"WoCTsc",notes:[]},y={method:"GET",headers:this.getHttpHeaders()};for(let p=0;p<2;p++){try{const g=await this.httpClient.request(`${this.URL}/tx/${f}/proof/tsc`,y);if(g.statusText==="Too Many Requests"&&p<2){c.notes.push({what:"getMerklePathRetry",name:c.name,status:g.status,statusText:g.statusText}),await(0,i.wait)(2e3);continue}if(g.status===404&&g.statusText==="Not Found")return c.notes.push({what:"getMerklePathNotFound",name:c.name,status:g.status,statusText:g.statusText}),c;if(!g.ok||g.status!==200)throw c.notes.push({what:"getMerklePathBadStatus",name:c.name,status:g.status,statusText:g.statusText}),new i.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${f}' response ${g.statusText}`);if(!g.data)return c.notes.push({what:"getMerklePathNoData",name:c.name,status:g.status,statusText:g.statusText}),c;if(Array.isArray(g.data)||(g.data=[g.data]),g.data.length!=1)return c;const b=g.data[0],w=await n.hashToHeader(b.target);if(w){const v={index:b.index,nodes:b.nodes,height:w.height};c.merklePath=(0,r.convertProofToMerklePath)(f,v),c.header=w,c.notes.push({what:"getMerklePathSuccess",name:c.name,status:g.status,statusText:g.statusText})}else throw c.notes.push({what:"getMerklePathNoHeader",target:b.target,name:c.name,status:g.status,statusText:g.statusText}),new i.sdk.WERR_INVALID_PARAMETER("blockhash","a valid on-chain block hash")}catch(g){const b=i.sdk.WalletError.fromUnknown(g);c.notes.push({what:"getMerklePathError",name:c.name,code:b.code,description:b.description}),c.error=b}return c}throw c.notes.push({what:"getMerklePathInternal",name:c.name}),new i.sdk.WERR_INTERNAL}async updateBsvExchangeRate(f,n){if(f&&(n||(n=1e3*60*15),new Date(Date.now()-n)<f.timestamp))return f;const c={method:"GET",headers:this.getHttpHeaders()};for(let d=0;d<2;d++){const y=await this.httpClient.request(`${this.URL}/exchangerate`,c);if(y.statusText==="Too Many Requests"&&d<2){await(0,i.wait)(2e3);continue}if(!y.data||!y.ok||y.status!==200)throw new i.sdk.WERR_INVALID_OPERATION(`WoC exchangerate response ${y.statusText}`);const p=y.data;return p.currency!=="USD"&&(p.rate=NaN),{timestamp:new Date,base:"USD",rate:p.rate}}throw new i.sdk.WERR_INTERNAL}async getUtxoStatus(f,n,c){const d={name:"WoC",status:"error",error:new i.sdk.WERR_INTERNAL,details:[]};for(let y=0;;y++){let p="";try{const g=(0,i.validateScriptHash)(f,n),b={method:"GET",headers:this.getHttpHeaders()},w=await this.httpClient.request(`${this.URL}/script/${g}/unspent/all`,b);if(w.statusText==="Too Many Requests"&&y<2){await(0,i.wait)(2e3);continue}if(!w.data||!w.ok||w.status!==200)throw new i.sdk.WERR_INVALID_OPERATION(`WoC getUtxoStatus response ${w.statusText}`);const v=w.data;if(v.script!==g||!Array.isArray(v.result))throw new i.sdk.WERR_INTERNAL("data. is not an array");if(v.result.length===0)d.status="success",d.error=void 0,d.isUtxo=!1;else{d.status="success",d.error=void 0;for(const _ of v.result)d.details.push({txid:_.tx_hash,satoshis:_.value,height:_.height,index:_.tx_pos});if(c){const{txid:_,vout:S}=(0,o.parseWalletOutpoint)(c);d.isUtxo=d.details.find(T=>T.txid===_&&T.index===S)!==void 0}else d.isUtxo=d.details.length>0}return d}catch(g){if(i.sdk.WalletError.fromUnknown(g).code!=="ECONNRESET"||y>2)return d.error=new i.sdk.WERR_INTERNAL(`service failure: ${p}, error: ${JSON.stringify(i.sdk.WalletError.fromUnknown(g))}`),d}}}async getScriptHashConfirmedHistory(f){const n={name:"WoC",status:"error",error:void 0,history:[]};f=t.Utils.toHex(t.Utils.toArray(f,"hex").reverse());const c=`${this.URL}/script/${f}/confirmed/history`;for(let d=0;;d++)try{const y={method:"GET",headers:this.getHttpHeaders()},p=await this.httpClient.request(c,y);if(p.statusText==="Too Many Requests"&&d<2){await(0,i.wait)(2e3);continue}return!p.ok&&p.status===404?(n.status="success",n):!p.data||!p.ok||p.status!==200?(n.error=new i.sdk.WERR_BAD_REQUEST(`WoC getScriptHashConfirmedHistory response ${p.ok} ${p.status} ${p.statusText}`),n):p.data.error?(n.error=new i.sdk.WERR_BAD_REQUEST(`WoC getScriptHashConfirmedHistory error ${p.data.error}`),n):(n.history=p.data.result.map(g=>({txid:g.tx_hash,height:g.height})),n.status="success",n)}catch(y){if(i.sdk.WalletError.fromUnknown(y).code!=="ECONNRESET"||d>2)return n.error=new i.sdk.WERR_INTERNAL(`WoC getScriptHashConfirmedHistory service failure: ${c}, error: ${JSON.stringify(i.sdk.WalletError.fromUnknown(y))}`),n}return n}async getScriptHashUnconfirmedHistory(f){const n={name:"WoC",status:"error",error:void 0,history:[]};f=t.Utils.toHex(t.Utils.toArray(f,"hex").reverse());const c=`${this.URL}/script/${f}/unconfirmed/history`;for(let d=0;;d++)try{const y={method:"GET",headers:this.getHttpHeaders()},p=await this.httpClient.request(c,y);if(p.statusText==="Too Many Requests"&&d<2){await(0,i.wait)(2e3);continue}return!p.ok&&p.status===404?(n.status="success",n):!p.data||!p.ok||p.status!==200?(n.error=new i.sdk.WERR_BAD_REQUEST(`WoC getScriptHashUnconfirmedHistory response ${p.ok} ${p.status} ${p.statusText}`),n):p.data.error?(n.error=new i.sdk.WERR_BAD_REQUEST(`WoC getScriptHashUnconfirmedHistory error ${p.data.error}`),n):(n.history=p.data.result.map(g=>({txid:g.tx_hash,height:g.height})),n.status="success",n)}catch(y){if(i.sdk.WalletError.fromUnknown(y).code!=="ECONNRESET"||d>2)return n.error=new i.sdk.WERR_INTERNAL(`WoC getScriptHashUnconfirmedHistory service failure: ${c}, error: ${JSON.stringify(i.sdk.WalletError.fromUnknown(y))}`),n}return n}async getScriptHashHistory(f){const n=await this.getScriptHashConfirmedHistory(f);if(n.error||n.status!=="success")return n;const c=await this.getScriptHashUnconfirmedHistory(f);return c.error||c.status!=="success"?c:(n.history=n.history.concat(c.history),n)}};return ao.WhatsOnChain=a,ao}var Kc={},g6;function NB(){if(g6)return Kc;g6=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.updateChaintracksFiatExchangeRates=t,Kc.updateExchangeratesapi=i,Kc.getExchangeRatesIo=r;const s=se();async function t(e,o){const a=o.chaintracksFiatExchangeRatesUrl;if(!a)throw new s.sdk.WERR_MISSING_PARAMETER("options.chaintracksFiatExchangeRatesUrl");const l=await fetch(a),f=await l.json(),n={status:l.status,data:f};if(n.status!==200||!n.data||n.data.status!="success")throw new s.sdk.WERR_BAD_REQUEST(`${a} returned status ${n.status}`);const c=n.data.value;return c.timestamp=new Date(c.timestamp),c}async function i(e,o){if(!o.exchangeratesapiKey)throw new s.sdk.WERR_MISSING_PARAMETER("options.exchangeratesapiKey");const a=await r(o.exchangeratesapiKey);if(!a.success)throw new s.sdk.WERR_BAD_REQUEST(`getExchangeRatesIo returned success ${a.success}`);if(!a.rates.USD||!a.rates[a.base])throw new s.sdk.WERR_BAD_REQUEST("getExchangeRatesIo missing rates for 'USD' or base");const l={timestamp:new Date(a.timestamp*1e3),base:"USD",rates:{}},f=a.rates[a.base]/a.rates.USD;let n=0;for(const[c,d]of Object.entries(a.rates))e.indexOf(c)>-1&&(l.rates[c]=d*f,n++);if(n!==e.length)throw new s.sdk.WERR_BAD_REQUEST("getExchangeRatesIo failed to update all target currencies");return l}async function r(e){const o=`http://api.exchangeratesapi.io/v1/latest?access_key=${e}`,a=await fetch(o),l=await a.json(),f={status:a.status,data:l};if(f.status!==200||!f.data)throw new s.sdk.WERR_BAD_REQUEST(`getExchangeRatesIo returned status ${f.status}`);return f.data}return Kc}var wd={},m6;function CB(){if(m6)return wd;m6=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.ARC=void 0;const s=ge(),t=se();function i(){return`ts-sdk-${s.Utils.toHex((0,s.Random)(16))}`}let r=class{constructor(o,a){if(this.URL=o,typeof a=="string")this.apiKey=a,this.httpClient=(0,s.defaultHttpClient)(),this.deploymentId=i(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const l=a??{},{apiKey:f,deploymentId:n,httpClient:c,callbackToken:d,callbackUrl:y,headers:p}=l;this.apiKey=f,this.httpClient=c??(0,s.defaultHttpClient)(),this.deploymentId=n??i(),this.callbackToken=d,this.callbackUrl=y,this.headers=p}}requestHeaders(){const o={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(o.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(o["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(o["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const a in this.headers)o[a]=this.headers[a];return o}async postRawTx(o,a){let l=s.Utils.toHex((0,t.doubleSha256BE)(s.Utils.toArray(o,"hex")));a?l=a.slice(-1)[0]:a=[l];const f={method:"POST",headers:this.requestHeaders(),data:{rawTx:o}},n={txid:l,status:"success",notes:[]},c=`${this.URL}/v1/tx`,d=()=>({name:"ARCv1tx",when:new Date().toISOString()}),y=()=>({...d(),rawTx:o,txids:a.join(","),url:c});try{const p=await this.httpClient.request(c,f),{txid:g,extraInfo:b,txStatus:w,competingTxs:v}=p.data,_=()=>({txid:g,extraInfo:b,txStatus:w,competingTxs:v==null?void 0:v.join(",")});if(p.ok)n.data=`${w} ${b}`,n.txid!==g&&(n.data+=` txid altered from ${n.txid} to ${g}`),n.txid=g,w==="DOUBLE_SPEND_ATTEMPTED"||w==="SEEN_IN_ORPHAN_MEMPOOL"?(n.status="error",n.doubleSpend=!0,n.competingTxs=v,n.notes.push({...y(),..._(),what:"postRawTxDoubleSpend"})):n.notes.push({...d(),..._(),what:"postRawTxSuccess"});else if(typeof p=="string")n.notes.push({...y(),what:"postRawTxString",response:p}),n.status="error",n.serviceError=!0;else{n.status="error",n.serviceError=!0;const S={...d(),...y(),..._(),what:"postRawTxError"},T={};n.data=T;const I=typeof p.status;I==="number"||I==="string"?(S.status=p.status,T.status=p.status.toString()):(S.status=I,T.status="ERR_UNKNOWN");let k=p.data;if(k&&typeof k=="string"){S.data=p.data.slice(0,128);try{k=JSON.parse(k)}catch{}}else k&&typeof k=="object"&&(T.more=k,T.detail=k.detail,typeof T.detail!="string"&&(T.detail=void 0),T.detail&&(S.detail=T.detail));n.notes.push(S)}}catch(p){const g=t.sdk.WalletError.fromUnknown(p);n.status="error",n.serviceError=!0,n.data=`${g.code} ${g.message}`,n.notes.push({...y(),what:"postRawTxCatch",code:g.code,description:g.description})}return n}async postBeef(o,a){const l={name:"ARC",status:"success",txidResults:[],notes:[]},f=()=>({name:"ARCpostBeef",when:new Date().toISOString()});o.version===s.BEEF_V2&&o.txs.every(d=>!d.isTxidOnly)&&(o.version=s.BEEF_V1,l.notes.push({...f(),what:"postBeefV2ToV1"}));const n=o.toHex(),c=await this.postRawTx(n,a);l.status=c.status,l.txidResults=[c];for(const d of a){if(c.txid===d)continue;const y={txid:d,status:"success",notes:[]},p=await this.getTxData(d);p.txid!==d?(y.status="error",y.data="internal error",y.notes.push({...f(),what:"postBeefGetTxDataInternal",txid:d,returnedTxid:p.txid})):p.txStatus==="SEEN_ON_NETWORK"||p.txStatus==="STORED"?(y.data=p.txStatus,y.notes.push({...f(),what:"postBeefGetTxDataSuccess",txid:d,txStatus:p.txStatus})):(y.status="error",y.data=p,y.notes.push({...f(),what:"postBeefGetTxDataError",txid:d,txStatus:p.txStatus})),l.txidResults.push(y),l.status==="success"&&y.status==="error"&&(l.status="error")}return l}async getTxData(o){const a={method:"GET",headers:this.requestHeaders()};return(await this.httpClient.request(`${this.URL}/v1/tx/${o}`,a)).data}};return wd.ARC=r,wd}var vd={},b6;function DB(){if(b6)return vd;b6=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.Bitails=void 0;const s=ge(),t=se();let i=class{constructor(e="main",o={}){const{apiKey:a,httpClient:l}=o;this.chain=e,this.URL=e==="main"?"https://api.bitails.io/":"https://test-api.bitails.io/",this.httpClient=l??(0,s.defaultHttpClient)(),this.apiKey=a??""}getHttpHeaders(){const e={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(e.Authorization=this.apiKey),e}async postBeef(e,o){const a=()=>({name:"BitailsPostBeef",when:new Date().toISOString()}),l=()=>({...a(),beef:e.toHex(),txids:o.join(",")}),f={...a(),what:"postBeef"},n=[];for(const d of o){const y=s.Utils.toHex(e.findTxid(d).rawTx);n.push(y)}const c=await this.postRaws(n,o);return c.notes.unshift(f),c.status!=="success"?c.notes.push({...l(),what:"postBeefError"}):c.notes.push({...a(),what:"postBeefSuccess"}),c}async postRaws(e,o){const a={name:"BitailsPostRaws",status:"success",txidResults:[],notes:[]},l=[];for(const g of e){const b=s.Utils.toHex((0,t.doubleSha256BE)(s.Utils.toArray(g,"hex")));l.push(b),(!o||o.indexOf(b)>=0)&&a.txidResults.push({txid:b,status:"success",notes:[]})}const f=this.getHttpHeaders();f["Content-Type"]="application/json";const c={method:"POST",headers:f,data:{raws:e}},d=`${this.URL}tx/broadcast/multi`,y=()=>({name:"BitailsPostRawTx",when:new Date().toISOString()}),p=()=>({...y(),raws:e.join(","),txids:a.txidResults.map(g=>g.txid).join(","),url:d});try{const g=await this.httpClient.request(d,c);if(g.ok){const b=g.data;if(b.length!==e.length)a.status="error",a.notes.push({...p(),what:"postRawsErrorResultsCount"});else{let w=-1;for(const v of b)w++,v.txid?v.txid!==l[w]&&(a.status="error",a.notes.push({...y(),what:"postRawsResultTxids",i:w,txid:v.txid,rawsTxid:l[w]})):(v.txid=l[w],a.notes.push({...y(),what:"postRawsResultMissingTxids",i:w,rawsTxid:l[w]}));if(a.status==="success")for(const v of a.txidResults){const _=b.find(T=>T.txid===v.txid),S=v.txid;if(_.error){const{code:T,message:I}=_.error;T===-27?v.notes.push({...p(),what:"postRawsSuccessAlreadyInMempool"}):(v.status="error",T===-25?(v.doubleSpend=!0,v.competingTxs=void 0,v.notes.push({...p(),what:"postRawsErrorMissingInputs"})):_.code==="ECONNRESET"?v.notes.push({...p(),what:"postRawsErrorECONNRESET",txid:S,message:I}):v.notes.push({...p(),what:"postRawsError",txid:S,code:T,message:I}))}else v.notes.push({...y(),what:"postRawsSuccess"});v.status!=="success"&&a.status==="success"&&(a.status="error")}}}else{a.status="error";const b={...p(),what:"postRawsError"};a.notes.push(b)}}catch(g){a.status="error";const b=t.sdk.WalletError.fromUnknown(g),{code:w,description:v}=b;a.notes.push({...p(),what:"postRawsCatch",code:w,description:v})}return a}async getMerklePath(e,o){const a={name:"BitailsTsc",notes:[]},l=`${this.URL}tx/${e}/proof/tsc`,f=()=>({name:"BitailsProofTsc",when:new Date().toISOString(),txid:e,url:l}),c={method:"GET",headers:this.getHttpHeaders()};try{const d=await this.httpClient.request(l,c),y=()=>({...f(),txid:e,url:l,status:d.status,statusText:d.statusText});if(d.status===404&&d.statusText==="Not Found")a.notes.push({...f(),what:"getMerklePathNotFound"});else if(!d.ok||d.status!==200||d.statusText!=="OK")a.notes.push({...y(),what:"getMerklePathBadStatus"});else if(!d.data)a.notes.push({...y(),what:"getMerklePathNoData"});else{const p=d.data,g=await o.hashToHeader(p.target);if(g){const b={index:p.index,nodes:p.nodes,height:g.height};a.merklePath=(0,t.convertProofToMerklePath)(e,b),a.header=g,a.notes.push({...y(),what:"getMerklePathSuccess"})}else a.notes.push({...y(),what:"getMerklePathNoHeader",target:p.target})}}catch(d){const y=t.sdk.WalletError.fromUnknown(d),{code:p,description:g}=y;a.notes.push({...f(),what:"getMerklePathCatch",code:p,description:g}),a.error=y}return a}};return vd.Bitails=i,vd}var gp={},w6;function BB(){if(w6)return gp;w6=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.getBeefForTxid=t;const s=x1();async function t(r,e){return await new i(r).getBeefForTxid(e)}class i extends s.StorageProvider{constructor(e){const o=s.StorageProvider.createStorageBaseOptions(e.chain);super(o),this.nip=new Error("Method not implemented."),this.setServices(e),this.gbo={ignoreServices:!1,ignoreStorage:!0,ignoreNewProven:!0}}async getBeefForTxid(e){return await this.getBeefForTransaction(e,this.gbo)}reviewStatus(e){throw this.nip}purgeData(e,o){throw this.nip}allocateChangeInput(e,o,a,l,f,n){throw this.nip}getProvenOrRawTx(e,o){throw this.nip}getRawTxOfKnownValidTransaction(e,o,a,l){throw this.nip}getLabelsForTransactionId(e,o){throw this.nip}getTagsForOutputId(e,o){throw this.nip}listActions(e,o){throw this.nip}listOutputs(e,o){throw this.nip}countChangeInputs(e,o,a){throw this.nip}findCertificatesAuth(e,o){throw this.nip}findOutputBasketsAuth(e,o){throw this.nip}findOutputsAuth(e,o){throw this.nip}insertCertificateAuth(e,o){throw this.nip}dropAllData(){throw this.nip}migrate(e,o){throw this.nip}findOutputTagMaps(e){throw this.nip}findProvenTxReqs(e){throw this.nip}findProvenTxs(e){throw this.nip}findTxLabelMaps(e){throw this.nip}countOutputTagMaps(e){throw this.nip}countProvenTxReqs(e){throw this.nip}countProvenTxs(e){throw this.nip}countTxLabelMaps(e){throw this.nip}insertCertificate(e,o){throw this.nip}insertCertificateField(e,o){throw this.nip}insertCommission(e,o){throw this.nip}insertMonitorEvent(e,o){throw this.nip}insertOutput(e,o){throw this.nip}insertOutputBasket(e,o){throw this.nip}insertOutputTag(e,o){throw this.nip}insertOutputTagMap(e,o){throw this.nip}insertProvenTx(e,o){throw this.nip}insertProvenTxReq(e,o){throw this.nip}insertSyncState(e,o){throw this.nip}insertTransaction(e,o){throw this.nip}insertTxLabel(e,o){throw this.nip}insertTxLabelMap(e,o){throw this.nip}insertUser(e,o){throw this.nip}updateCertificate(e,o,a){throw this.nip}updateCertificateField(e,o,a,l){throw this.nip}updateCommission(e,o,a){throw this.nip}updateMonitorEvent(e,o,a){throw this.nip}updateOutput(e,o,a){throw this.nip}updateOutputBasket(e,o,a){throw this.nip}updateOutputTag(e,o,a){throw this.nip}updateOutputTagMap(e,o,a,l){throw this.nip}updateProvenTx(e,o,a){throw this.nip}updateProvenTxReq(e,o,a){throw this.nip}updateSyncState(e,o,a){throw this.nip}updateTransaction(e,o,a){throw this.nip}updateTxLabel(e,o,a){throw this.nip}updateTxLabelMap(e,o,a,l){throw this.nip}updateUser(e,o,a){throw this.nip}destroy(){throw this.nip}transaction(e,o){throw this.nip}readSettings(e){throw this.nip}findCertificateFields(e){throw this.nip}findCertificates(e){throw this.nip}findCommissions(e){throw this.nip}findMonitorEvents(e){throw this.nip}findOutputBaskets(e){throw this.nip}findOutputs(e){throw this.nip}findOutputTags(e){throw this.nip}findSyncStates(e){throw this.nip}findTransactions(e){throw this.nip}findTxLabels(e){throw this.nip}findUsers(e){throw this.nip}countCertificateFields(e){throw this.nip}countCertificates(e){throw this.nip}countCommissions(e){throw this.nip}countMonitorEvents(e){throw this.nip}countOutputBaskets(e){throw this.nip}countOutputs(e){throw this.nip}countOutputTags(e){throw this.nip}countSyncStates(e){throw this.nip}countTransactions(e){throw this.nip}countTxLabels(e){throw this.nip}countUsers(e){throw this.nip}getProvenTxsForUser(e){throw this.nip}getProvenTxReqsForUser(e){throw this.nip}getTxLabelMapsForUser(e){throw this.nip}getOutputTagMapsForUser(e){throw this.nip}adminStats(e){throw this.nip}}return gp}var v6;function uk(){if(v6)return eo;v6=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.Services=void 0,eo.validateScriptHash=d,eo.toBinaryBaseBlockHeader=y;const s=ge(),t=se(),i=kB(),r=PB(),e=ok(),o=MB(),a=NB(),l=CB(),f=DB(),n=BB();let c=class ck{static createDefaultOptions(g){return(0,r.createDefaultWalletServicesOptions)(g)}constructor(g){this.postBeefCount=0,this.targetCurrencies=["USD","GBP","EUR"],this.chain=typeof g=="string"?g:g.chain,this.options=typeof g=="string"?ck.createDefaultOptions(this.chain):g,this.whatsonchain=new o.WhatsOnChain(this.chain,{apiKey:this.options.whatsOnChainApiKey},this),this.arc=new l.ARC(this.options.arcUrl,this.options.arcConfig),this.bitails=new f.Bitails(this.chain),this.getMerklePathServices=new i.ServiceCollection().add({name:"WhatsOnChain",service:this.whatsonchain.getMerklePath.bind(this.whatsonchain)}).add({name:"Bitails",service:this.bitails.getMerklePath.bind(this.bitails)}),this.getRawTxServices=new i.ServiceCollection().add({name:"WhatsOnChain",service:this.whatsonchain.getRawTxResult.bind(this.whatsonchain)}),this.postBeefServices=new i.ServiceCollection().add({name:"TaalArcBeef",service:this.arc.postBeef.bind(this.arc)}).add({name:"WhatsOnChain",service:this.whatsonchain.postBeef.bind(this.whatsonchain)}).add({name:"Bitails",service:this.bitails.postBeef.bind(this.bitails)}),this.getUtxoStatusServices=new i.ServiceCollection().add({name:"WhatsOnChain",service:this.whatsonchain.getUtxoStatus.bind(this.whatsonchain)}),this.getStatusForTxidsServices=new i.ServiceCollection().add({name:"WhatsOnChain",service:this.whatsonchain.getStatusForTxids.bind(this.whatsonchain)}),this.getScriptHashHistoryServices=new i.ServiceCollection().add({name:"WhatsOnChain",service:this.whatsonchain.getScriptHashHistory.bind(this.whatsonchain)}),this.updateFiatExchangeRateServices=new i.ServiceCollection().add({name:"ChaintracksService",service:a.updateChaintracksFiatExchangeRates}).add({name:"exchangeratesapi",service:a.updateExchangeratesapi})}async getChainTracker(){if(!this.options.chaintracks)throw new t.sdk.WERR_INVALID_PARAMETER("options.chaintracks","valid to enable 'getChainTracker' service.");return new e.ChaintracksChainTracker(this.chain,this.options.chaintracks)}async getBsvExchangeRate(){return this.options.bsvExchangeRate=await this.whatsonchain.updateBsvExchangeRate(this.options.bsvExchangeRate,this.options.bsvUpdateMsecs),this.options.bsvExchangeRate.rate}async getFiatExchangeRate(g,b){const w=await this.updateFiatExchangeRates(this.options.fiatExchangeRates,this.options.fiatUpdateMsecs);return this.options.fiatExchangeRates=w,b||(b="USD"),w.rates[g]/w.rates[b]}get getProofsCount(){return this.getMerklePathServices.count}get getRawTxsCount(){return this.getRawTxServices.count}get postBeefServicesCount(){return this.postBeefServices.count}get getUtxoStatsCount(){return this.getUtxoStatusServices.count}async getStatusForTxids(g,b){const w=this.getStatusForTxidsServices;b&&w.next();let v={name:"<noservices>",status:"error",error:new t.sdk.WERR_INTERNAL("No services available."),results:[]};for(let _=0;_<w.count;_++){const S=w.service,T=await S(g);if(T.status==="success"){v=T;break}w.next()}return v}hashOutputScript(g){return s.Utils.toHex((0,t.sha256Hash)(s.Utils.toArray(g,"hex")))}async isUtxo(g){if(!g.lockingScript)throw new t.sdk.WERR_INVALID_PARAMETER("output.lockingScript","validated by storage provider validateOutputScript.");const b=this.hashOutputScript(s.Utils.toHex(g.lockingScript));return(await this.getUtxoStatus(b,void 0,`${g.txid}.${g.vout}`)).isUtxo===!0}async getUtxoStatus(g,b,w,v){const _=this.getUtxoStatusServices;v&&_.next();let S={name:"<noservices>",status:"error",error:new t.sdk.WERR_INTERNAL("No services available."),details:[]};for(let T=0;T<2;T++){for(let I=0;I<_.count;I++){const k=_.service,O=await k(g,b,w);if(O.status==="success"){S=O;break}_.next()}if(S.status==="success")break;await(0,t.wait)(2e3)}return S}async getScriptHashHistory(g,b){const w=this.getScriptHashHistoryServices;b&&w.next();let v={name:"<noservices>",status:"error",error:new t.sdk.WERR_INTERNAL("No services available."),history:[]};for(let _=0;_<w.count;_++){const S=w.service,T=await S(g);if(T.status==="success"){v=T;break}w.next()}return v}async postBeef(g,b){this.postBeefCount++;const w=[...this.postBeefServices.allServices];for(let _=this.postBeefCount%w.length;_>0;_--)w.unshift(w.pop());return await Promise.all(w.map(async _=>await _(g,b)))}async getRawTx(g,b){b&&this.getRawTxServices.next();const w={txid:g};for(let v=0;v<this.getRawTxServices.count;v++){const _=this.getRawTxServices.service,S=await _(g,this.chain);if(S.rawTx){const T=(0,t.asString)((0,t.doubleSha256BE)(S.rawTx));if(T===(0,t.asString)(g)){w.rawTx=S.rawTx,w.name=S.name,w.error=void 0;break}S.error=new t.sdk.WERR_INTERNAL(`computed txid ${T} doesn't match requested value ${g}`),S.rawTx=void 0}S.error&&!w.error&&!w.rawTx&&(w.error=S.error),this.getRawTxServices.next()}return w}async invokeChaintracksWithRetry(g){if(!this.options.chaintracks)throw new t.sdk.WERR_INVALID_PARAMETER("options.chaintracks","valid for this service operation.");for(let b=0;b<3;b++)try{return await g()}catch(w){if(t.sdk.WalletError.fromUnknown(w).code!="ECONNRESET")throw w}throw new t.sdk.WERR_INVALID_OPERATION("hashToHeader service unavailable")}async getHeaderForHeight(g){const b=async()=>{const w=await this.options.chaintracks.findHeaderForHeight(g);if(!w)throw new t.sdk.WERR_INVALID_PARAMETER("hash",`valid height '${g}' on mined chain ${this.chain}`);return y(w)};return this.invokeChaintracksWithRetry(b)}async getHeight(){const g=async()=>await this.options.chaintracks.currentHeight();return this.invokeChaintracksWithRetry(g)}async hashToHeader(g){const b=async()=>{const w=await this.options.chaintracks.findHeaderForBlockHash(g);if(!w)throw new t.sdk.WERR_INVALID_PARAMETER("hash",`valid blockhash '${g}' on mined chain ${this.chain}`);return w};return this.invokeChaintracksWithRetry(b)}async getMerklePath(g,b){b&&this.getMerklePathServices.next();const w={notes:[]};for(let v=0;v<this.getMerklePathServices.count;v++){const _=this.getMerklePathServices.service,S=await _(g,this);if(S.notes&&w.notes.push(...S.notes),w.name||(w.name=S.name),S.merklePath){w.merklePath=S.merklePath,w.header=S.header,w.name=S.name,w.error=void 0;break}else S.error&&!w.error&&(w.error=S.error);this.getMerklePathServices.next()}return w}async updateFiatExchangeRates(g,b){b||(b=1e3*60*15);const w=new Date(Date.now()-b);if(g&&(b||(b=1e3*60*15),g.timestamp>w))return g;const v=this.updateFiatExchangeRateServices.clone();let _;for(let S=0;S<v.count;S++){const T=v.service;try{const I=await T(this.targetCurrencies,this.options);if(this.targetCurrencies.every(k=>typeof I.rates[k]=="number")){_=I;break}}catch(I){const k=t.sdk.WalletError.fromUnknown(I);console.error(`updateFiatExchangeRates servcice name ${T.name} error ${k.message}`)}v.next()}if(!_){if(console.error("Failed to update fiat exchange rates."),!g)throw new t.sdk.WERR_INTERNAL;return g}return _}async nLockTimeIsFinal(g){let v;if(typeof g=="number")v=g;else if(typeof g=="string"?g=s.Transaction.fromHex(g):Array.isArray(g)&&(g=s.Transaction.fromBinary(g)),g instanceof s.Transaction){if(g.inputs.every(S=>S.sequence===4294967295))return!0;v=g.lockTime}else throw new t.sdk.WERR_INTERNAL("Should be either @bsv/sdk Transaction or babbage-bsv Transaction");if(v>=5e8){const S=Math.floor(Date.now()/1e3);return v<S}const _=await this.getHeight();return v<_}async getBeefForTxid(g){return await(0,n.getBeefForTxid)(this,g)}};eo.Services=c;function d(p,g){let b=(0,t.asArray)(p);switch(g||(b.length===32?g="hashLE":g="script"),g){case"hashBE":break;case"hashLE":b=b.reverse();break;case"script":b=(0,t.sha256Hash)(b).reverse();break;default:throw new t.sdk.WERR_INVALID_PARAMETER("outputFormat",`not be ${g}`)}return(0,t.asString)(b)}function y(p){const g=new s.Utils.Writer;return g.writeUInt32BE(p.version),g.writeReverse((0,t.asArray)(p.previousHash)),g.writeReverse((0,t.asArray)(p.merkleRoot)),g.writeUInt32BE(p.time),g.writeUInt32BE(p.bits),g.writeUInt32BE(p.nonce),g.toArray()}return eo}var xd={},x6;function FB(){if(x6)return xd;x6=1,Object.defineProperty(xd,"__esModule",{value:!0}),xd.SimpleWalletManager=void 0;const s=ge();let t=class{constructor(r,e,o){this.authenticated=!1,this.adminOriginator=r,this.walletBuilder=e,o&&this.loadSnapshot(o)}async providePrimaryKey(r){this.primaryKey=r,await this.tryBuildUnderlying()}async providePrivilegedKeyManager(r){this.underlyingPrivilegedKeyManager=r,await this.tryBuildUnderlying()}async tryBuildUnderlying(){if(this.authenticated)throw new Error("The user is already authenticated.");!this.primaryKey||!this.underlyingPrivilegedKeyManager||(this.underlying=await this.walletBuilder(this.primaryKey,this.underlyingPrivilegedKeyManager),this.authenticated=!0)}destroy(){this.underlying=void 0,this.underlyingPrivilegedKeyManager=void 0,this.authenticated=!1,this.primaryKey=void 0}saveSnapshot(){if(!this.primaryKey)throw new Error("No primary key is set; cannot save snapshot.");const r=(0,s.Random)(32),e=new s.Utils.Writer;e.writeUInt8(1),e.writeVarIntNum(this.primaryKey.length),e.write(this.primaryKey);const o=e.toArray(),a=new s.SymmetricKey(r).encrypt(o),l=new s.Utils.Writer;return l.write(r),l.write(a),l.toArray()}async loadSnapshot(r){try{const e=new s.Utils.Reader(r),o=e.read(32),a=e.read(),l=new s.SymmetricKey(o).decrypt(a),f=new s.Utils.Reader(l),n=f.readUInt8();if(n!==1)throw new Error(`Unsupported snapshot version: ${n}`);const c=f.readVarIntNum(),d=f.read(c);this.primaryKey=d,await this.tryBuildUnderlying()}catch(e){throw new Error(`Failed to load snapshot: ${e.message}`)}}async isAuthenticated(r,e){return this.ensureCanCall(e),{authenticated:!0}}async waitForAuthentication(r,e){if(e===this.adminOriginator)throw new Error("External applications cannot use the admin originator.");for(;!this.authenticated;)await new Promise(o=>setTimeout(o,100));return{authenticated:!0}}async getPublicKey(r,e){return this.ensureCanCall(e),this.underlying.getPublicKey(r,e)}async revealCounterpartyKeyLinkage(r,e){return this.ensureCanCall(e),this.underlying.revealCounterpartyKeyLinkage(r,e)}async revealSpecificKeyLinkage(r,e){return this.ensureCanCall(e),this.underlying.revealSpecificKeyLinkage(r,e)}async encrypt(r,e){return this.ensureCanCall(e),this.underlying.encrypt(r,e)}async decrypt(r,e){return this.ensureCanCall(e),this.underlying.decrypt(r,e)}async createHmac(r,e){return this.ensureCanCall(e),this.underlying.createHmac(r,e)}async verifyHmac(r,e){return this.ensureCanCall(e),this.underlying.verifyHmac(r,e)}async createSignature(r,e){return this.ensureCanCall(e),this.underlying.createSignature(r,e)}async verifySignature(r,e){return this.ensureCanCall(e),this.underlying.verifySignature(r,e)}async createAction(r,e){return this.ensureCanCall(e),this.underlying.createAction(r,e)}async signAction(r,e){return this.ensureCanCall(e),this.underlying.signAction(r,e)}async abortAction(r,e){return this.ensureCanCall(e),this.underlying.abortAction(r,e)}async listActions(r,e){return this.ensureCanCall(e),this.underlying.listActions(r,e)}async internalizeAction(r,e){return this.ensureCanCall(e),this.underlying.internalizeAction(r,e)}async listOutputs(r,e){return this.ensureCanCall(e),this.underlying.listOutputs(r,e)}async relinquishOutput(r,e){return this.ensureCanCall(e),this.underlying.relinquishOutput(r,e)}async acquireCertificate(r,e){return this.ensureCanCall(e),this.underlying.acquireCertificate(r,e)}async listCertificates(r,e){return this.ensureCanCall(e),this.underlying.listCertificates(r,e)}async proveCertificate(r,e){return this.ensureCanCall(e),this.underlying.proveCertificate(r,e)}async relinquishCertificate(r,e){return this.ensureCanCall(e),this.underlying.relinquishCertificate(r,e)}async discoverByIdentityKey(r,e){return this.ensureCanCall(e),this.underlying.discoverByIdentityKey(r,e)}async discoverByAttributes(r,e){return this.ensureCanCall(e),this.underlying.discoverByAttributes(r,e)}async getHeight(r,e){return this.ensureCanCall(e),this.underlying.getHeight({},e)}async getHeaderForHeight(r,e){return this.ensureCanCall(e),this.underlying.getHeaderForHeight(r,e)}async getNetwork(r,e){return this.ensureCanCall(e),this.underlying.getNetwork({},e)}async getVersion(r,e){return this.ensureCanCall(e),this.underlying.getVersion({},e)}ensureCanCall(r){if(r===this.adminOriginator)throw new Error("External applications cannot use the admin originator.");if(!this.authenticated)throw new Error("User is not authenticated.")}};return xd.SimpleWalletManager=t,xd}var so={},nr={},_6;function LB(){if(_6)return nr;_6=1;var s=nr&&nr.__createBinding||(Object.create?function(f,n,c,d){d===void 0&&(d=c);var y=Object.getOwnPropertyDescriptor(n,c);(!y||("get"in y?!n.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return n[c]}}),Object.defineProperty(f,d,y)}:function(f,n,c,d){d===void 0&&(d=c),f[d]=n[c]}),t=nr&&nr.__setModuleDefault||(Object.create?function(f,n){Object.defineProperty(f,"default",{enumerable:!0,value:n})}:function(f,n){f.default=n}),i=nr&&nr.__importStar||function(){var f=function(n){return f=Object.getOwnPropertyNames||function(c){var d=[];for(var y in c)Object.prototype.hasOwnProperty.call(c,y)&&(d[d.length]=y);return d},f(n)};return function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var d=f(n),y=0;y<d.length;y++)d[y]!=="default"&&s(c,n,d[y]);return t(c,n),c}}();Object.defineProperty(nr,"__esModule",{value:!0}),nr.WalletStorageManager=void 0;const r=gi(),e=i(Rr()),o=vu();class a{constructor(n){this.storage=n,this.isStorageProvider=n.isStorageProvider(),this.isAvailable=!1}}let l=class{constructor(n,c,d){this._stores=[],this._isAvailable=!1,this._readerCount=0,this._writerCount=0,this._isSingleWriter=!0,this._syncLocked=!1,this._storageProviderLocked=!1;const y=[...d||[]];c&&y.unshift(c),this._stores=y.map(p=>new a(p)),this._authId={identityKey:n}}isStorageProvider(){return!1}isAvailable(){return this._isAvailable}get isActiveEnabled(){return this._active!==void 0&&this._active.settings.storageIdentityKey===this._active.user.activeStorage&&this._conflictingActives!==void 0&&this._conflictingActives.length===0}canMakeAvailable(){return this._stores.length>0}async makeAvailable(){var n;if(this._isAvailable)return this._active.settings;if(this._active=void 0,this._backups=[],this._conflictingActives=[],this._stores.length<1)throw new e.WERR_INVALID_PARAMETER("active","valid. Must add active storage provider to wallet.");const c=[];for(const y of this._stores){if(!y.isAvailable||!y.settings||!y.user){y.settings=await y.storage.makeAvailable();const p=await y.storage.findOrInsertUser(this._authId.identityKey);y.user=p.user,y.isAvailable=!0}if(!this._active)this._active=y;else{const p=y.user.activeStorage,g=y.settings.storageIdentityKey;p===g&&!this.isActiveEnabled?(c.push(this._active),this._active=y):c.push(y)}}const d=(n=this._active.settings)===null||n===void 0?void 0:n.storageIdentityKey;for(const y of c)y.user.activeStorage!==d?this._conflictingActives.push(y):this._backups.push(y);return this._isAvailable=!0,this._authId.userId=this._active.user.userId,this._authId.isActive=this.isActiveEnabled,this._active.settings}verifyActive(){if(!this._active||!this._isAvailable)throw new e.WERR_INVALID_OPERATION("An active WalletStorageProvider must be added to this WalletStorageManager and makeAvailable must be called.");return this._active}async getAuth(n){if(this.isAvailable()||await this.makeAvailable(),n&&!this._authId.isActive)throw new e.WERR_NOT_ACTIVE;return this._authId}async getUserId(){return(await this.getAuth()).userId}getActive(){return this.verifyActive().storage}getActiveSettings(){return this.verifyActive().settings}getActiveUser(){return this.verifyActive().user}getActiveStore(){return this.verifyActive().settings.storageIdentityKey}getActiveStoreName(){return this.verifyActive().settings.storageName}getBackupStores(){return this.verifyActive(),this._backups.map(n=>n.settings.storageIdentityKey)}getConflictingStores(){return this.verifyActive(),this._conflictingActives.map(n=>n.settings.storageIdentityKey)}getAllStores(){return this.verifyActive(),this._stores.map(n=>n.settings.storageIdentityKey)}async getActiveForWriter(){for(this.isAvailable()||await this.makeAvailable();this._storageProviderLocked||this._syncLocked||this._isSingleWriter&&this._writerCount>0||this._readerCount>0;)await(0,o.wait)(100);return this._writerCount++,this.getActive()}async getActiveForReader(){for(this.isAvailable()||await this.makeAvailable();this._storageProviderLocked||this._syncLocked||this._isSingleWriter&&this._writerCount>0;)await(0,o.wait)(100);return this._readerCount++,this.getActive()}async getActiveForSync(){for(this.isAvailable()||await this.makeAvailable();this._syncLocked;)await(0,o.wait)(100);for(this._syncLocked=!0;this._storageProviderLocked||this._readerCount>0||this._writerCount>0;)await(0,o.wait)(100);return this.getActive()}async getActiveForStorageProvider(){for(this.isAvailable()||await this.makeAvailable();this._storageProviderLocked;)await(0,o.wait)(100);for(this._storageProviderLocked=!0;this._syncLocked||this._readerCount>0||this._writerCount>0;)await(0,o.wait)(100);if(!this.getActive().isStorageProvider())throw new e.WERR_INVALID_OPERATION('Active "WalletStorageProvider" does not support "StorageProvider" interface.');return this.getActive()}async runAsWriter(n){try{const c=await this.getActiveForWriter();return await n(c)}finally{this._writerCount--}}async runAsReader(n){try{const c=await this.getActiveForReader();return await n(c)}finally{this._readerCount--}}async runAsSync(n,c){try{const d=c||await this.getActiveForSync();return await n(d)}finally{c||(this._syncLocked=!1)}}async runAsStorageProvider(n){try{const c=await this.getActiveForStorageProvider();return await n(c)}finally{this._storageProviderLocked=!1}}isActiveStorageProvider(){return this.getActive().isStorageProvider()}async addWalletStorageProvider(n){await n.makeAvailable(),this._services&&n.setServices(this._services),this._stores.push(new a(n)),this._isAvailable=!1,await this.makeAvailable()}setServices(n){this._services=n;for(const c of this._stores)c.storage.setServices(n)}getServices(){if(!this._services)throw new e.WERR_INVALID_OPERATION("Must setServices first.");return this._services}getSettings(){return this.getActive().getSettings()}async migrate(n,c){return await this.runAsWriter(async d=>d.migrate(n,c))}async destroy(){if(!(this._stores.length<1))return await this.runAsWriter(async n=>{for(const c of this._stores)await c.storage.destroy()})}async findOrInsertUser(n){const c=await this.getAuth();if(n!=c.identityKey)throw new e.WERR_UNAUTHORIZED;return await this.runAsWriter(async d=>{const y=await d.findOrInsertUser(n);if(c.userId&&c.userId!==y.user.userId)throw new e.WERR_INTERNAL("userId may not change for given identityKey");return this._authId.userId=y.user.userId,y})}async abortAction(n){return e.validateAbortActionArgs(n),await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.abortAction(d,n)})}async createAction(n){return await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.createAction(d,n)})}async internalizeAction(n){return e.validateInternalizeActionArgs(n),await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.internalizeAction(d,n)})}async relinquishCertificate(n){return e.validateRelinquishCertificateArgs(n),await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.relinquishCertificate(d,n)})}async relinquishOutput(n){return e.validateRelinquishOutputArgs(n),await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.relinquishOutput(d,n)})}async processAction(n){return await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.processAction(d,n)})}async insertCertificate(n){return await this.runAsWriter(async c=>{const d=await this.getAuth(!0);return await c.insertCertificateAuth(d,n)})}async listActions(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.listActions(c,n))}async listCertificates(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.listCertificates(c,n))}async listOutputs(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.listOutputs(c,n))}async findCertificates(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.findCertificatesAuth(c,n))}async findOutputBaskets(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.findOutputBasketsAuth(c,n))}async findOutputs(n){const c=await this.getAuth();return await this.runAsReader(async d=>await d.findOutputsAuth(c,n))}async findProvenTxReqs(n){return await this.runAsReader(async c=>await c.findProvenTxReqs(n))}async syncFromReader(n,c,d,y=""){const p=await this.getAuth();if(n!==p.identityKey)throw new e.WERR_UNAUTHORIZED;const g=await c.makeAvailable();let b=0,w=0;return y=await this.runAsSync(async v=>{const _=v,S=this.getSettings();y+=`syncFromReader from ${g.storageName} to ${S.storageName}
`;let T=-1;for(;;){T++;const k=(await r.EntitySyncState.fromStorage(_,n,g)).makeRequestSyncChunkArgs(n,S.storageIdentityKey),O=await c.getSyncChunk(k);O.user&&(O.user.activeStorage=this._active.user.activeStorage);const A=await _.processSyncChunk(k,O);if(b+=A.inserts,w+=A.updates,y+=`chunk ${T} inserted ${A.inserts} updated ${A.updates} ${A.maxUpdated_at}
`,A.done)break}return y+=`syncFromReader complete: ${b} inserts, ${w} updates
`,y},d),{inserts:b,updates:w,log:y}}async syncToWriter(n,c,d,y="",p){p||(p=_=>_);const g=n.identityKey,b=await c.makeAvailable();let w=0,v=0;return y=await this.runAsSync(async _=>{const S=_,T=S.getSettings();y+=p(`syncToWriter from ${T.storageName} to ${b.storageName}
`);let I=-1;for(;;){I++;const O=(await r.EntitySyncState.fromStorage(c,g,T)).makeRequestSyncChunkArgs(g,b.storageIdentityKey),A=await S.getSyncChunk(O);y+=r.EntitySyncState.syncChunkSummary(A);const R=await c.processSyncChunk(O,A);if(w+=R.inserts,v+=R.updates,y+=p(`chunk ${I} inserted ${R.inserts} updated ${R.updates} ${R.maxUpdated_at}
`),R.done)break}return y+=p(`syncToWriter complete: ${w} inserts, ${v} updates
`),y},d),{inserts:w,updates:v,log:y}}async updateBackups(n,c){c||(c=y=>y);const d=await this.getAuth(!0);return await this.runAsSync(async y=>{let p=c(`BACKUP CURRENT ACTIVE TO ${this._backups.length} STORES
`);for(const g of this._backups){const b=await this.syncToWriter(d,g.storage,y,void 0,c);p+=b.log}return p},n)}async setActive(n,c){c||(c=b=>b),this.isAvailable()||await this.makeAvailable();const d=this._stores.findIndex(b=>b.settings.storageIdentityKey===n);if(d<0)throw new e.WERR_INVALID_PARAMETER("storageIdentityKey",`registered with this "WalletStorageManager". ${n} does not match any managed store.`);const y=(await this.getAuth()).identityKey,p=this._stores[d];let g=c(`setActive to ${p.settings.storageName}`);return n===this.getActiveStore()&&this.isActiveEnabled?g+c(` unchanged
`):(g+=c(`
`),g+=await this.runAsSync(async b=>{let w="";if(this._conflictingActives.length>0){this._conflictingActives.push(this._active),this._conflictingActives=this._conflictingActives.filter(_=>!(_.settings.storageIdentityKey===n));for(const _ of this._conflictingActives){w+=c(`MERGING STATE FROM CONFLICTING ACTIVES:
`);const S=await this.syncToWriter({identityKey:y,userId:p.user.userId,isActive:!1},p.storage,_.storage,void 0,c);w+=S.log}w+=c(`PROPAGATE MERGED ACTIVE STATE TO NON-ACTIVES
`)}else w+=c(`BACKUP CURRENT ACTIVE STATE THEN SET NEW ACTIVE
`);const v=this._conflictingActives.length>0?p:this._active;await v.storage.setActive({identityKey:y,userId:v.user.userId},n);for(const _ of this._stores)if(_.user.activeStorage=n,_.settings.storageIdentityKey!==v.settings.storageIdentityKey){const S=await this.syncToWriter({identityKey:y,userId:_.user.userId,isActive:!1},_.storage,v.storage,void 0,c);w+=S.log}return this._isAvailable=!1,await this.makeAvailable(),w}),g)}getStoreEndpointURL(n){if(n.storage.constructor.name==="StorageClient")return n.storage.endpointUrl}getStores(){const n=[];this._active&&n.push({isActive:!0,isEnabled:this.isActiveEnabled,isBackup:!1,isConflicting:!1,userId:this._active.user.userId,storageIdentityKey:this._active.settings.storageIdentityKey,storageName:this._active.settings.storageName,storageClass:this._active.storage.constructor.name,endpointURL:this.getStoreEndpointURL(this._active)});for(const c of this._conflictingActives||[])n.push({isActive:!0,isEnabled:!1,isBackup:!1,isConflicting:!0,userId:c.user.userId,storageIdentityKey:c.settings.storageIdentityKey,storageName:c.settings.storageName,storageClass:c.storage.constructor.name,endpointURL:this.getStoreEndpointURL(c)});for(const c of this._backups||[])n.push({isActive:!1,isEnabled:!1,isBackup:!0,isConflicting:!1,userId:c.user.userId,storageIdentityKey:c.settings.storageIdentityKey,storageName:c.settings.storageName,storageClass:c.storage.constructor.name,endpointURL:this.getStoreEndpointURL(c)});return n}};return nr.WalletStorageManager=l,nr}var _d={},S6;function UB(){if(S6)return _d;S6=1,Object.defineProperty(_d,"__esModule",{value:!0}),_d.StorageSyncReader=void 0;const s=se();let t=class{constructor(r,e){this.auth=r,this.storage=e}async makeAvailable(){if(await this.storage.makeAvailable(),this.auth.userId===void 0){const r=await this.storage.findUserByIdentityKey(this.auth.identityKey);if(!r)throw new s.sdk.WERR_UNAUTHORIZED;this.auth.userId=r.userId}return this.storage.getSettings()}destroy(){return this.storage.destroy()}async getSyncChunk(r){if(this.auth.userId||await this.makeAvailable(),r.identityKey!==this.auth.identityKey)throw new s.sdk.WERR_UNAUTHORIZED;return await this.storage.getSyncChunk(r)}};return _d.StorageSyncReader=t,_d}var oo={},Om={},T6;function qB(){return T6||(T6=1,Object.defineProperty(Om,"__esModule",{value:!0})),Om}var Am={},I6;function jB(){return I6||(I6=1,Object.defineProperty(Am,"__esModule",{value:!0})),Am}var Pm={},k6;function HB(){return k6||(k6=1,Object.defineProperty(Pm,"__esModule",{value:!0})),Pm}var Rm={},E6;function KB(){return E6||(E6=1,Object.defineProperty(Rm,"__esModule",{value:!0})),Rm}var Mm={},O6;function VB(){return O6||(O6=1,Object.defineProperty(Mm,"__esModule",{value:!0})),Mm}var Nm={},A6;function WB(){return A6||(A6=1,Object.defineProperty(Nm,"__esModule",{value:!0})),Nm}var Cm={},P6;function $B(){return P6||(P6=1,Object.defineProperty(Cm,"__esModule",{value:!0})),Cm}var Sd={},R6;function zB(){return R6||(R6=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.transactionColumnsWithoutRawTx=void 0,Sd.transactionColumnsWithoutRawTx=["created_at","updated_at","transactionId","userId","provenTxId","status","reference","isOutgoing","satoshis","version","lockTime","description","txid"]),Sd}var Dm={},M6;function XB(){return M6||(M6=1,Object.defineProperty(Dm,"__esModule",{value:!0})),Dm}var Td={},N6;function GB(){return N6||(N6=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.outputColumnsWithoutLockingScript=void 0,Td.outputColumnsWithoutLockingScript=["created_at","updated_at","outputId","userId","transactionId","basketId","spendable","change","vout","satoshis","providedBy","purpose","type","outputDescription","txid","senderIdentityKey","derivationPrefix","derivationSuffix","customInstructions","spentBy","sequenceNumber","spendingDescription","scriptLength","scriptOffset"]),Td}var Bm={},C6;function YB(){return C6||(C6=1,Object.defineProperty(Bm,"__esModule",{value:!0})),Bm}var Fm={},D6;function QB(){return D6||(D6=1,Object.defineProperty(Fm,"__esModule",{value:!0})),Fm}var Lm={},B6;function ZB(){return B6||(B6=1,Object.defineProperty(Lm,"__esModule",{value:!0})),Lm}var Um={},F6;function JB(){return F6||(F6=1,Object.defineProperty(Um,"__esModule",{value:!0})),Um}var qm={},L6;function tF(){return L6||(L6=1,Object.defineProperty(qm,"__esModule",{value:!0})),qm}var jm={},U6;function eF(){return U6||(U6=1,Object.defineProperty(jm,"__esModule",{value:!0})),jm}var q6;function iF(){return q6||(q6=1,function(s){var t=oo&&oo.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=oo&&oo.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(qB(),s),i(jB(),s),i(HB(),s),i(KB(),s),i(VB(),s),i(WB(),s),i($B(),s),i(zB(),s),i(XB(),s),i(GB(),s),i(YB(),s),i(QB(),s),i(ZB(),s),i(JB(),s),i(tF(),s),i(eF(),s)}(oo)),oo}var Id={},j6;function nF(){if(j6)return Id;j6=1,Object.defineProperty(Id,"__esModule",{value:!0}),Id.StorageClient=void 0;const s=ge(),t=se();let i=class{constructor(e,o){this.nextId=1,this.authClient=new s.AuthFetch(e),this.endpointUrl=o}isStorageProvider(){return!1}async rpcCall(e,o){try{const a=this.nextId++,l={jsonrpc:"2.0",method:e,params:o,id:a};let f;try{f=await this.authClient.fetch(this.endpointUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})}catch(c){throw c}if(!f.ok)throw new Error(`WalletStorageClient rpcCall: network error ${f.status} ${f.statusText}`);const n=await f.json();if(n.error){const{code:c,message:d,data:y}=n.error,p=new Error(`RPC Error: ${d}`);throw p.code=c,p.data=y,p}return n.result}catch(a){throw a}}isAvailable(){return!!this.settings}getSettings(){if(!this.settings)throw new t.sdk.WERR_INVALID_OPERATION("call makeAvailable at least once before getSettings");return this.settings}async makeAvailable(){return this.settings||(this.settings=await this.rpcCall("makeAvailable",[])),this.settings}async destroy(){return this.rpcCall("destroy",[])}async migrate(e,o){return this.rpcCall("migrate",[e])}getServices(){throw new t.sdk.WERR_INVALID_OPERATION("getServices() not implemented in remote client. This method typically is not used remotely.")}setServices(e){}async internalizeAction(e,o){return this.rpcCall("internalizeAction",[e,o])}async createAction(e,o){return this.rpcCall("createAction",[e,o])}async processAction(e,o){return this.rpcCall("processAction",[e,o])}async abortAction(e,o){return this.rpcCall("abortAction",[e,o])}async findOrInsertUser(e){return this.rpcCall("findOrInsertUser",[e])}async findOrInsertSyncStateAuth(e,o,a){const l=await this.rpcCall("findOrInsertSyncStateAuth",[e,o,a]);return l.syncState=this.validateEntity(l.syncState,["when"]),l}async insertCertificateAuth(e,o){return await this.rpcCall("insertCertificateAuth",[e,o])}async listActions(e,o){return await this.rpcCall("listActions",[e,o])}async listOutputs(e,o){return await this.rpcCall("listOutputs",[e,o])}async listCertificates(e,o){return await this.rpcCall("listCertificates",[e,o])}async findCertificatesAuth(e,o){const a=await this.rpcCall("findCertificatesAuth",[e,o]);if(this.validateEntities(a),o.includeFields)for(const l of a)l.fields&&this.validateEntities(l.fields);return a}async findOutputBasketsAuth(e,o){const a=await this.rpcCall("findOutputBaskets",[e,o]);return this.validateEntities(a),a}async findOutputsAuth(e,o){const a=await this.rpcCall("findOutputsAuth",[e,o]);return this.validateEntities(a),a}async findProvenTxReqs(e){const o=await this.rpcCall("findProvenTxReqs",[e]);return this.validateEntities(o),o}async relinquishCertificate(e,o){return this.rpcCall("relinquishCertificate",[e,o])}async relinquishOutput(e,o){return this.rpcCall("relinquishOutput",[e,o])}async processSyncChunk(e,o){return await this.rpcCall("processSyncChunk",[e,o])}async getSyncChunk(e){const o=await this.rpcCall("getSyncChunk",[e]);return o.certificateFields&&(o.certificateFields=this.validateEntities(o.certificateFields)),o.certificates&&(o.certificates=this.validateEntities(o.certificates)),o.commissions&&(o.commissions=this.validateEntities(o.commissions)),o.outputBaskets&&(o.outputBaskets=this.validateEntities(o.outputBaskets)),o.outputTagMaps&&(o.outputTagMaps=this.validateEntities(o.outputTagMaps)),o.outputTags&&(o.outputTags=this.validateEntities(o.outputTags)),o.outputs&&(o.outputs=this.validateEntities(o.outputs)),o.provenTxReqs&&(o.provenTxReqs=this.validateEntities(o.provenTxReqs)),o.provenTxs&&(o.provenTxs=this.validateEntities(o.provenTxs)),o.transactions&&(o.transactions=this.validateEntities(o.transactions)),o.txLabelMaps&&(o.txLabelMaps=this.validateEntities(o.txLabelMaps)),o.txLabels&&(o.txLabels=this.validateEntities(o.txLabels)),o.user&&(o.user=this.validateEntity(o.user)),o}async updateProvenTxReqWithNewProvenTx(e){return await this.rpcCall("updateProvenTxReqWithNewProvenTx",[e])}async setActive(e,o){return this.rpcCall("setActive",[e,o])}validateDate(e){let o;return e instanceof Date?o=e:o=new Date(e),o}validateEntity(e,o){if(e.created_at=this.validateDate(e.created_at),e.updated_at=this.validateDate(e.updated_at),o)for(const a of o)e[a]&&(e[a]=this.validateDate(e[a]));for(const a of Object.keys(e)){const l=e[a];l===null?e[a]=void 0:l instanceof Uint8Array&&(e[a]=Array.from(l))}return e}validateEntities(e,o){for(let a=0;a<e.length;a++)e[a]=this.validateEntity(e[a],o);return e}};return Id.StorageClient=i,Id}var H6;function lk(){return H6||(H6=1,function(s){var t=so&&so.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=so&&so.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(LB(),s),i(ik(),s),i(x1(),s),i(UB(),s),i(iF(),s),i(gi(),s),i(nF(),s)}(so)),so}var rr={},mp={},K6;function rF(){if(K6)return mp;K6=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.acquireDirectCertificate=s;async function s(t,i,r){var e;const o=new Date,a={certificateId:0,created_at:o,updated_at:o,userId:i.userId,type:r.type,subject:r.subject,verifier:r.keyringRevealer==="certifier"?r.certifier:r.keyringRevealer,serialNumber:r.serialNumber,certifier:r.certifier,revocationOutpoint:r.revocationOutpoint,signature:r.signature,fields:[],isDeleted:!1};for(const[f,n]of Object.entries(r.fields))(e=a.fields)===null||e===void 0||e.push({certificateId:0,created_at:o,updated_at:o,userId:i.userId,fieldName:f,fieldValue:n,masterKey:r.keyringForSubject[f]||""});return await t.storage.insertCertificate(a),{type:r.type,subject:r.subject,serialNumber:r.serialNumber,certifier:r.certifier,revocationOutpoint:r.revocationOutpoint,signature:r.signature,fields:r.fields}}return mp}var bp={},V6;function aF(){if(V6)return bp;V6=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.proveCertificate=i;const s=ge(),t=se();async function i(r,e,o){const a={partial:{type:o.type,serialNumber:o.serialNumber,certifier:o.certifier,subject:o.subject,revocationOutpoint:o.revocationOutpoint,signature:o.signature},certifiers:[],types:[],limit:2,offset:0,privileged:!1},l=await r.storage.listCertificates(a);if(l.certificates.length!=1)throw new t.sdk.WERR_INVALID_PARAMETER("args","a unique certificate match");const f=l.certificates[0];return{keyringForVerifier:await s.MasterCertificate.createKeyringForVerifier(r,f.certifier,o.verifier,f.fields,o.fieldsToReveal,f.keyring,f.serialNumber,o.privileged,o.privilegedReason)}}return bp}var co={},wp={},W6;function sF(){if(W6)return wp;W6=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.buildSignableTransaction=r;const s=ge(),t=se(),i=S1();function r(e,o,a){var l;const f=a.getClientChangeKeyPair(),n=o.inputBEEF?s.Beef.fromBinary(o.inputBEEF):void 0,{inputs:c,outputs:d}=e,y=new s.Transaction(o.version,[],[],o.lockTime),p=Array(d.length);for(let S=0;S<d.length;S++){const T=d.findIndex(I=>I.vout===S);if(T<0)throw new t.sdk.WERR_INVALID_PARAMETER("output.vout",`sequential. ${S} is missing`);p[S]=T}for(let S=0;S<d.length;S++){const T=p[S],I=d[T];if(S!==I.vout)throw new t.sdk.WERR_INVALID_PARAMETER("output.vout",`equal to array index. ${I.vout} !== ${S}`);const k=I.providedBy==="storage"&&I.purpose==="change",O=k?(0,i.makeChangeLock)(I,e,o,f,a):(0,t.asBsvSdkScript)(I.lockingScript),A={satoshis:I.satoshis,lockingScript:O,change:k};y.addOutput(A)}if(d.length===0){const S={satoshis:0,lockingScript:s.Script.fromASM("OP_FALSE OP_RETURN 42"),change:!1};y.addOutput(S)}const g=[];for(const S of c){const T=S.vin!==void 0&&S.vin<o.inputs.length?o.inputs[S.vin]:void 0;g.push({argsInput:T,storageInput:S})}g.sort((S,T)=>S.storageInput.vin<T.storageInput.vin?-1:S.storageInput.vin===T.storageInput.vin?0:1);const b=[];let w=0;for(const{storageInput:S,argsInput:T}of g)if(T){const k=typeof T.unlockingScript=="string"?(0,t.asBsvSdkScript)(T.unlockingScript):new s.Script,O=o.isSignAction?(l=n==null?void 0:n.findTxid(T.outpoint.txid))===null||l===void 0?void 0:l.tx:void 0,A={sourceTXID:T.outpoint.txid,sourceOutputIndex:T.outpoint.vout,sourceTransaction:O,unlockingScript:k,sequence:T.sequenceNumber};y.addInput(A)}else{if(S.type!=="P2PKH")throw new t.sdk.WERR_INVALID_PARAMETER("type",`vin ${S.vin}, "${S.type}" is not a supported unlocking script type.`);b.push({vin:y.inputs.length,derivationPrefix:(0,t.verifyTruthy)(S.derivationPrefix),derivationSuffix:(0,t.verifyTruthy)(S.derivationSuffix),unlockerPubKey:S.senderIdentityKey,sourceSatoshis:S.sourceSatoshis,lockingScript:S.sourceLockingScript});const I={sourceTXID:S.sourceTxid,sourceOutputIndex:S.sourceVout,sourceTransaction:S.sourceTransaction?s.Transaction.fromBinary(S.sourceTransaction):void 0,unlockingScript:new s.Script,sequence:4294967295};y.addInput(I),w+=(0,t.verifyTruthy)(S.sourceSatoshis)}const v=d.filter(S=>S.purpose==="change").reduce((S,T)=>S+T.satoshis,0),_=w-v;return{tx:y,amount:_,pdi:b,log:""}}return wp}var $6;function S1(){if($6)return co;$6=1,Object.defineProperty(co,"__esModule",{value:!0}),co.createAction=r,co.makeChangeLock=l,co.completeSignedTransaction=f,co.processAction=c;const s=ge();ge();const t=se(),i=sF();async function r(d,y,p){var g;const b={};let w;if(p.isNewTx){if(w=await e(d,p),p.isSignAction)return o(w,d,p);w.tx=await f(w,{},d),b.txid=w.tx.id("hex"),b.noSendChange=(g=w.dcr.noSendChangeOutputVouts)===null||g===void 0?void 0:g.map(S=>`${b.txid}.${S}`),p.options.returnTXIDOnly||(b.tx=(0,t.makeAtomicBeef)(w.tx,w.dcr.inputBeef))}const{sendWithResults:v,notDelayedResults:_}=await c(w,d,y,p);return b.sendWithResults=v,b.notDelayedResults=_,b}async function e(d,y){const p=n(y),g=await d.storage.createAction(p),b=g.reference,{tx:w,amount:v,pdi:_}=(0,i.buildSignableTransaction)(g,y,d);return{reference:b,dcr:g,args:y,amount:v,tx:w,pdi:_}}function o(d,y,p){var g;if(!d.dcr.inputBeef)throw new t.sdk.WERR_INTERNAL("prior.dcr.inputBeef must be valid");const b=d.tx.id("hex"),w={noSendChange:p.isNoSend?(g=d.dcr.noSendChangeOutputVouts)===null||g===void 0?void 0:g.map(v=>`${b}.${v}`):void 0,signableTransaction:{reference:d.dcr.reference,tx:a(d.tx,d.dcr.inputBeef)}};return y.pendingSignActions[w.signableTransaction.reference]=d,w}function a(d,y){const p=new s.Beef;for(const g of d.inputs){if(!g.sourceTransaction)throw new t.sdk.WERR_INTERNAL("Every signableTransaction input must have a sourceTransaction");p.mergeRawTx(g.sourceTransaction.toBinary())}return p.mergeRawTx(d.toBinary()),p.toBinaryAtomic(d.id("hex"))}function l(d,y,p,g,b){const w=y.derivationPrefix,v=(0,t.verifyTruthy)(d.derivationSuffix);return new t.ScriptTemplateBRC29({derivationPrefix:w,derivationSuffix:v,keyDeriver:b.keyDeriver}).lock(g.privateKey,g.publicKey)}async function f(d,y,p){for(const[g,b]of Object.entries(y)){const w=Number(g),v=d.args.inputs[w],_=d.tx.inputs[w];if(!v||!_||v.unlockingScript||!Number.isInteger(v.unlockingScriptLength))throw new t.sdk.WERR_INVALID_PARAMETER("args","spend does not correspond to prior input with valid unlockingScriptLength.");if(b.unlockingScript.length/2>v.unlockingScriptLength)throw new t.sdk.WERR_INVALID_PARAMETER("args",`spend unlockingScript length ${b.unlockingScript.length} exceeds expected length ${v.unlockingScriptLength}`);_.unlockingScript=(0,t.asBsvSdkScript)(b.unlockingScript),b.sequenceNumber!==void 0&&(_.sequence=b.sequenceNumber)}for(const g of d.pdi){const b=new t.ScriptTemplateBRC29({derivationPrefix:g.derivationPrefix,derivationSuffix:g.derivationSuffix,keyDeriver:p.keyDeriver}),w=p.getClientChangeKeyPair(),v=w.privateKey,_=g.unlockerPubKey||w.publicKey,S=g.sourceSatoshis,T=(0,t.asBsvSdkScript)(g.lockingScript),I=b.unlock(v,_,S,T),k=d.tx.inputs[g.vin];k.unlockingScriptTemplate=I}return await d.tx.sign(),d.tx}function n(d){let y=d;if(!y.inputs.every(p=>p.unlockingScript===void 0)){y={...d,inputs:[]};for(const p of d.inputs){const g={...p,unlockingScriptLength:p.unlockingScript!==void 0?p.unlockingScript.length:p.unlockingScriptLength};delete g.unlockingScript,y.inputs.push(g)}}return y}async function c(d,y,p,g){const b={isNewTx:g.isNewTx,isSendWith:g.isSendWith,isNoSend:g.isNoSend,isDelayed:g.isDelayed,reference:d?d.reference:void 0,txid:d?d.tx.id("hex"):void 0,rawTx:d?d.tx.toBinary():void 0,sendWith:g.isSendWith?g.options.sendWith:[]};return await y.storage.processAction(b)}return co}var Vc={},z6;function oF(){if(z6)return Vc;z6=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.signAction=e,Vc.makeAtomicBeef=o,Vc.completeSignedTransaction=a;const s=ge(),t=se(),i=S1(),r=Rr();async function e(f,n,c){const d=f.pendingSignActions[c.reference];if(!d)throw new t.sdk.WERR_NOT_IMPLEMENTED("recovery of out-of-session signAction reference data is not yet implemented.");if(!d.dcr.inputBeef)throw new t.sdk.WERR_INTERNAL("prior.dcr.inputBeef must be valid");const y=l(d.args,c);d.tx=await a(d,y.spends,f);const{sendWithResults:p,notDelayedResults:g}=await(0,i.processAction)(d,f,n,y);return{txid:d.tx.id("hex"),tx:y.options.returnTXIDOnly?void 0:o(d.tx,d.dcr.inputBeef),sendWithResults:p,notDelayedResults:g}}function o(f,n){return Array.isArray(n)&&(n=s.Beef.fromBinary(n)),n.mergeTransaction(f),n.toBinaryAtomic(f.id("hex"))}async function a(f,n,c){for(const[d,y]of Object.entries(n)){const p=Number(d),g=f.args.inputs[p],b=f.tx.inputs[p];if(!g||!b||g.unlockingScript||!Number.isInteger(g.unlockingScriptLength))throw new t.sdk.WERR_INVALID_PARAMETER("args","spend does not correspond to prior input with valid unlockingScriptLength.");if(y.unlockingScript.length/2>g.unlockingScriptLength)throw new t.sdk.WERR_INVALID_PARAMETER("args",`spend unlockingScript length ${y.unlockingScript.length} exceeds expected length ${g.unlockingScriptLength}`);b.unlockingScript=(0,t.asBsvSdkScript)(y.unlockingScript),y.sequenceNumber!==void 0&&(b.sequence=y.sequenceNumber)}for(const d of f.pdi){const y=new t.ScriptTemplateBRC29({derivationPrefix:d.derivationPrefix,derivationSuffix:d.derivationSuffix,keyDeriver:c.keyDeriver}),p=c.getClientChangeKeyPair(),g=p.privateKey,b=d.unlockerPubKey||p.publicKey,w=d.sourceSatoshis,v=(0,t.asBsvSdkScript)(d.lockingScript),_=y.unlock(g,b,w,v),S=f.tx.inputs[d.vin];S.unlockingScriptTemplate=_}return await f.tx.sign(),f.tx}function l(f,n){const c=n.options||(n.options={});return c.acceptDelayedBroadcast===void 0&&(c.acceptDelayedBroadcast=f.options.acceptDelayedBroadcast),c.returnTXIDOnly===void 0&&(c.returnTXIDOnly=f.options.returnTXIDOnly),c.noSend===void 0&&(c.noSend=f.options.noSend),c.sendWith===void 0&&(c.sendWith=f.options.sendWith),(0,r.validateSignActionArgs)(n)}return Vc}var vp={},X6;function cF(){if(X6)return vp;X6=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.internalizeAction=i;const s=ge(),t=se();async function i(r,e,o){const a=t.sdk.validateInternalizeActionArgs(o),{ab:l,tx:f,txid:n}=await p(),c=[2,"3241645161d8"];for(const g of a.outputs){if(g.outputIndex<0||g.outputIndex>=f.outputs.length)throw new t.sdk.WERR_INVALID_PARAMETER("outputIndex",`a valid output index in range 0 to ${f.outputs.length-1}`);switch(g.protocol){case"basket insertion":break;case"wallet payment":y(g);break;default:throw new t.sdk.WERR_INTERNAL(`unexpected protocol ${g.protocol}`)}}return await r.storage.internalizeAction(o);function y(g,b){const w=g.paymentRemittance,v=f.outputs[g.outputIndex];if(!w)throw new t.sdk.WERR_INVALID_PARAMETER("paymentRemitance",`valid for protocol ${g.protocol}`);const _=`${w.derivationPrefix} ${w.derivationSuffix}`,S=r.keyDeriver.derivePrivateKey(c,_,w.senderIdentityKey),T=new s.P2PKH().lock(S.toAddress());if(v.lockingScript.toHex()!==T.toHex())throw new t.sdk.WERR_INVALID_PARAMETER("paymentRemitance","locked by script conforming to BRC-29")}async function p(){const g=s.Beef.fromBinary(a.tx);if(!await g.verify(await r.getServices().getChainTracker(),!1)||!g.atomicTxid)throw new t.sdk.WERR_INVALID_PARAMETER("tx","valid AtomicBEEF");const w=g.atomicTxid,v=g.findTxid(w);if(!v)throw new t.sdk.WERR_INVALID_PARAMETER("tx",`valid AtomicBEEF with newest txid of ${w}`);const _=v.tx;return{ab:g,tx:_,txid:w}}}return vp}var Hm={},G6;function uF(){return G6||(G6=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.WalletSettingsManager=s.TESTNET_DEFAULT_SETTINGS=s.DEFAULT_SETTINGS=void 0;const t=ge(),i="wallet settings";s.DEFAULT_SETTINGS={trustSettings:{trustLevel:2,trustedCertifiers:[{name:"Metanet Trust Services",description:"Registry for protocols, baskets, and certificates types",iconUrl:"https://bsvblockchain.org/favicon.ico",identityKey:"03daf815fe38f83da0ad83b5bedc520aa488aef5cbc93a93c67a7fe60406cbffe8",trust:4},{name:"SocialCert",description:"Certifies social media handles, phone numbers and emails",iconUrl:"https://socialcert.net/favicon.ico",trust:3,identityKey:"02cf6cdf466951d8dfc9e7c9367511d0007ed6fba35ed42d425cc412fd6cfd4a17"}]},theme:{mode:"dark"}};const r={"Babbage Trust Services":"03d0b36b5c98b000ec9ffed9a2cf005e279244edf6a19cf90545cdebe873162761",IdentiCert:"036dc48522aba1705afbb43df3c04dbd1da373b6154341a875bceaa2a3e7f21528",SocialCert:"02cf6cdf466951d8dfc9e7c9367511d0007ed6fba35ed42d425cc412fd6cfd4a17"};s.TESTNET_DEFAULT_SETTINGS={...s.DEFAULT_SETTINGS,trustSettings:{...s.DEFAULT_SETTINGS.trustSettings,trustedCertifiers:s.DEFAULT_SETTINGS.trustSettings.trustedCertifiers.map(o=>({...o,identityKey:r[o.name]||o.identityKey}))}};class e{constructor(a,l={defaultSettings:s.DEFAULT_SETTINGS}){this.wallet=a,this.config=l,this.kv=new t.LocalKVStore(a,i,!0)}async get(){return JSON.parse(await this.kv.get("settings",JSON.stringify(this.config.defaultSettings)))}async set(a){await this.kv.set("settings",JSON.stringify(a))}async delete(){await this.kv.remove("settings")}}s.WalletSettingsManager=e}(Hm)),Hm}var Km={},Y6;function lF(){return Y6||(Y6=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.parseResults=s.queryOverlay=s.transformVerifiableCertificatesWithTrust=void 0;const t=ge(),i=(o,a)=>{const l={},f={};a.forEach(c=>{const{subject:d,certifier:y}=c;if(!d||!y)return;if(!f[y]){const b=o.trustedCertifiers.find(w=>w.identityKey===y);if(!b)return;f[y]=b}const p={name:f[y].name,iconUrl:f[y].iconUrl||"",description:f[y].description,trust:f[y].trust},g={...c,signature:c.signature,decryptedFields:c.decryptedFields,publiclyRevealedKeyring:c.keyring,certifierInfo:p};l[d]||(l[d]={totalTrust:0,members:[]}),l[d].totalTrust+=p.trust,l[d].members.push(g)});const n=[];return Object.values(l).forEach(c=>{c.totalTrust>=o.trustLevel&&n.push(...c.members)}),n.sort((c,d)=>d.certifierInfo.trust-c.certifierInfo.trust),{totalCertificates:n.length,certificates:n}};s.transformVerifiableCertificatesWithTrust=i;const r=async(o,a)=>{const l=await a.query({service:"ls_identity",query:o});return await(0,s.parseResults)(l)};s.queryOverlay=r;const e=async o=>{if(o.type==="output-list"){const a=[];for(const l of o.outputs)try{const f=t.Transaction.fromBEEF(l.beef),n=t.PushDrop.decode(f.outputs[l.outputIndex].lockingScript),c=JSON.parse(t.Utils.toUTF8(n.fields[0])),d=new t.VerifiableCertificate(c.type,c.serialNumber,c.subject,c.certifier,c.revocationOutpoint,c.fields,c.keyring,c.signature),y=await d.decryptFields(new t.ProtoWallet("anyone"));await d.verify(),d.decryptedFields=y,a.push(d)}catch(f){console.error(f)}return a}return[]};s.parseResults=e}(Km)),Km}var Q6;function dF(){if(Q6)return rr;Q6=1;var s=rr&&rr.__createBinding||(Object.create?function(I,k,O,A){A===void 0&&(A=O);var R=Object.getOwnPropertyDescriptor(k,O);(!R||("get"in R?!k.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return k[O]}}),Object.defineProperty(I,A,R)}:function(I,k,O,A){A===void 0&&(A=O),I[A]=k[O]}),t=rr&&rr.__setModuleDefault||(Object.create?function(I,k){Object.defineProperty(I,"default",{enumerable:!0,value:k})}:function(I,k){I.default=k}),i=rr&&rr.__importStar||function(){var I=function(k){return I=Object.getOwnPropertyNames||function(O){var A=[];for(var R in O)Object.prototype.hasOwnProperty.call(O,R)&&(A[A.length]=R);return A},I(k)};return function(k){if(k&&k.__esModule)return k;var O={};if(k!=null)for(var A=I(k),R=0;R<A.length;R++)A[R]!=="default"&&s(O,k,A[R]);return t(O,k),O}}();Object.defineProperty(rr,"__esModule",{value:!0}),rr.Wallet=void 0;const r=ge(),e=i(Rr()),o=rF(),a=aF(),l=S1(),f=oF(),n=cF(),c=uF(),d=lF(),y=KI(),p=Rr(),g=vu(),b=FI();function w(I){return I.isWalletSigner}let v=class{constructor(k,O,A,R){this.includeAllSourceTransactions=!0,this.autoKnownTxids=!1,this.returnTxidOnly=!1,this.randomVals=void 0;const P=w(k)?{chain:k.chain,keyDeriver:k.keyDeriver,storage:k.storage,services:O,monitor:A,privilegedKeyManager:R}:k;if(P.storage._authId.identityKey!=P.keyDeriver.identityKey)throw new e.WERR_INVALID_PARAMETER("storage",`authenticated as the same identityKey (${P.storage._authId.identityKey}) as the keyDeriver (${P.keyDeriver.identityKey}).`);this.settingsManager=P.settingsManager||new c.WalletSettingsManager(this),this.chain=P.chain,this.lookupResolver=P.lookupResolver||new r.LookupResolver({networkPreset:(0,g.toWalletNetwork)(this.chain)}),this.keyDeriver=P.keyDeriver,this.storage=P.storage,this.proto=new r.ProtoWallet(P.keyDeriver),this.services=P.services,this.monitor=P.monitor,this.privilegedKeyManager=P.privilegedKeyManager,this.identityKey=this.keyDeriver.identityKey,this.pendingSignActions={},this.userParty=`user ${this.getClientChangeKeyPair().publicKey}`,this.beef=new r.BeefParty([this.userParty]),this.trustSelf="known",this.services&&this.storage.setServices(this.services)}async destroy(){await this.storage.destroy(),this.privilegedKeyManager&&await this.privilegedKeyManager.destroyKey()}getClientChangeKeyPair(){return{privateKey:this.keyDeriver.rootKey.toString(),publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}async getIdentityKey(){return(await this.getPublicKey({identityKey:!0})).publicKey}getPublicKey(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.getPublicKey(k)}return this.proto.getPublicKey(k)}revealCounterpartyKeyLinkage(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.revealCounterpartyKeyLinkage(k)}return this.proto.revealCounterpartyKeyLinkage(k)}revealSpecificKeyLinkage(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.revealSpecificKeyLinkage(k)}return this.proto.revealSpecificKeyLinkage(k)}encrypt(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.encrypt(k)}return this.proto.encrypt(k)}decrypt(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.decrypt(k)}return this.proto.decrypt(k)}createHmac(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.createHmac(k)}return this.proto.createHmac(k)}verifyHmac(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.verifyHmac(k)}return this.proto.verifyHmac(k)}createSignature(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.createSignature(k)}return this.proto.createSignature(k)}verifySignature(k,O){if(k.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.verifySignature(k)}return this.proto.verifySignature(k)}getServices(){if(!this.services)throw new e.WERR_INVALID_PARAMETER("services","valid in constructor arguments to be retreived here.");return this.services}getKnownTxids(k){if(k)for(const R of k)this.beef.mergeTxidOnly(R);return this.beef.sortTxs().valid}getStorageIdentity(){const k=this.storage.getSettings();return{storageIdentityKey:k.storageIdentityKey,storageName:k.storageName}}validateAuthAndArgs(k,O){const A=O(k),R={identityKey:this.identityKey};return{vargs:A,auth:R}}async listActions(k,O){e.validateOriginator(O);const{vargs:A}=this.validateAuthAndArgs(k,e.validateListActionsArgs);return await this.storage.listActions(A)}get storageParty(){return`storage ${this.getStorageIdentity().storageIdentityKey}`}async listOutputs(k,O){e.validateOriginator(O);const{vargs:A}=this.validateAuthAndArgs(k,e.validateListOutputsArgs);this.autoKnownTxids&&!A.knownTxids&&(A.knownTxids=this.getKnownTxids());const R=await this.storage.listOutputs(A);return R.BEEF&&(this.beef.mergeBeefFromParty(this.storageParty,R.BEEF),R.BEEF=this.verifyReturnedTxidOnlyBEEF(R.BEEF)),R}async listCertificates(k,O){e.validateOriginator(O);const{vargs:A}=this.validateAuthAndArgs(k,e.validateListCertificatesArgs);return await this.storage.listCertificates(A)}async acquireCertificate(k,O){if(e.validateOriginator(O),k.acquisitionProtocol==="direct"){const{auth:A,vargs:R}=this.validateAuthAndArgs(k,e.validateAcquireDirectCertificateArgs);R.subject=(await this.getPublicKey({identityKey:!0,privileged:k.privileged,privilegedReason:k.privilegedReason})).publicKey;try{await new r.MasterCertificate(R.type,R.serialNumber,R.subject,R.certifier,R.revocationOutpoint,R.fields,R.keyringForSubject,R.signature).verify(),await r.MasterCertificate.decryptFields(this,R.keyringForSubject,R.fields,R.certifier,R.privileged,R.privilegedReason)}catch(C){const N=e.WalletError.fromUnknown(C);throw new e.WERR_INVALID_PARAMETER("args",`valid encrypted and signed certificate and keyring from revealer. ${N.name}: ${N.message}`)}return await(0,o.acquireDirectCertificate)(this,A,R)}if(k.acquisitionProtocol==="issuance"){const{auth:A,vargs:R}=this.validateAuthAndArgs(k,e.validateAcquireIssuanceCertificateArgs),P=await(0,r.createNonce)(this,R.certifier),C=new r.AuthFetch(this),{certificateFields:N,masterKeyring:D}=await r.MasterCertificate.createCertificateFields(this,R.certifier,R.fields),U=await C.fetch(`${R.certifierUrl}/signCertificate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientNonce:P,type:R.type,fields:N,masterKeyring:D})});if(U.headers.get("x-bsv-auth-identity-key")!==R.certifier)throw new Error(`Invalid certifier! Expected: ${R.certifier}, Received: ${U.headers.get("x-bsv-auth-identity-key")}`);const{certificate:F,serverNonce:L}=await U.json();if(!F)throw new Error("No certificate received from certifier!");if(!L)throw new Error("No serverNonce received from certifier!");const j=new r.Certificate(F.type,F.serialNumber,F.subject,F.certifier,F.revocationOutpoint,F.fields,F.signature);await(0,r.verifyNonce)(L,this,R.certifier);const{valid:V}=await this.verifyHmac({hmac:r.Utils.toArray(j.serialNumber,"base64"),data:r.Utils.toArray(P+L,"base64"),protocolID:[2,"certificate issuance"],keyID:L+P,counterparty:R.certifier});if(!V)throw new Error("Invalid serialNumber");if(j.type!==R.type)throw new Error(`Invalid certificate type! Expected: ${R.type}, Received: ${j.type}`);if(j.subject!==this.identityKey)throw new Error(`Invalid certificate subject! Expected: ${this.identityKey}, Received: ${j.subject}`);if(j.certifier!==R.certifier)throw new Error(`Invalid certifier! Expected: ${R.certifier}, Received: ${j.certifier}`);if(!j.revocationOutpoint)throw new Error("Invalid revocationOutpoint!");if(Object.keys(j.fields).length!==Object.keys(N).length)throw new Error("Fields mismatch! Objects have different numbers of keys.");for(const W of Object.keys(N)){if(!(W in j.fields))throw new Error(`Missing field: ${W} in certificate.fields`);if(j.fields[W]!==N[W])throw new Error(`Invalid field! Expected: ${N[W]}, Received: ${j.fields[W]}`)}return await j.verify(),await r.MasterCertificate.decryptFields(this,D,F.fields,R.certifier),await(0,o.acquireDirectCertificate)(this,A,{...F,keyringRevealer:"certifier",keyringForSubject:D,privileged:R.privileged})}throw new e.WERR_INVALID_PARAMETER("acquisitionProtocol",`valid.${k.acquisitionProtocol} is unrecognized.`)}async relinquishCertificate(k,O){return e.validateOriginator(O),this.validateAuthAndArgs(k,e.validateRelinquishCertificateArgs),await this.storage.relinquishCertificate(k),{relinquished:!0}}async proveCertificate(k,O){O=e.validateOriginator(O);const{auth:A,vargs:R}=this.validateAuthAndArgs(k,e.validateProveCertificateArgs);return await(0,a.proveCertificate)(this,A,R)}async discoverByIdentityKey(k,O){e.validateOriginator(O),this.validateAuthAndArgs(k,e.validateDiscoverByIdentityKeyArgs);const A=(await this.settingsManager.get()).trustSettings,R=await(0,d.queryOverlay)({identityKey:k.identityKey,certifiers:A.trustedCertifiers.map(P=>P.identityKey)},this.lookupResolver);return R?(0,d.transformVerifiableCertificatesWithTrust)(A,R):{totalCertificates:0,certificates:[]}}async discoverByAttributes(k,O){e.validateOriginator(O),this.validateAuthAndArgs(k,e.validateDiscoverByAttributesArgs);const A=(await this.settingsManager.get()).trustSettings,R=await(0,d.queryOverlay)({attributes:k.attributes,certifiers:A.trustedCertifiers.map(P=>P.identityKey)},this.lookupResolver);return R?(0,d.transformVerifiableCertificatesWithTrust)(A,R):{totalCertificates:0,certificates:[]}}verifyReturnedTxidOnly(k,O){if(this.returnTxidOnly)return k;const A=k.txs.filter(R=>R.isTxidOnly).map(R=>R.txid);for(const R of A){if(O&&O.indexOf(R)>=0)continue;k.findTxid(R);const P=this.beef.findAtomicTransaction(R);if(!P)throw new e.WERR_INTERNAL(`unable to merge txid ${R} into beef`);k.mergeTransaction(P)}for(const R of k.txs)if(!(O&&O.indexOf(R.txid)>=0)&&R.isTxidOnly)throw new e.WERR_INTERNAL(`remaining txidOnly ${R.txid} is not known`);return k}verifyReturnedTxidOnlyAtomicBEEF(k,O){if(this.returnTxidOnly)return k;const A=r.Beef.fromBinary(k);if(!A.atomicTxid)throw new e.WERR_INTERNAL;return this.verifyReturnedTxidOnly(A,O).toBinaryAtomic(A.atomicTxid)}verifyReturnedTxidOnlyBEEF(k){if(this.returnTxidOnly)return k;const O=r.Beef.fromBinary(k);return this.verifyReturnedTxidOnly(O).toBinary()}async createAction(k,O){var A,R;e.validateOriginator(O),k.options||(k.options={}),(R=k.options).trustSelf||(R.trustSelf=this.trustSelf),this.autoKnownTxids&&!k.options.knownTxids&&(k.options.knownTxids=this.getKnownTxids(k.options.knownTxids));const{auth:P,vargs:C}=this.validateAuthAndArgs(k,e.validateCreateActionArgs);C.labels.indexOf(p.specOpThrowReviewActions)>=0&&T(),C.includeAllSourceTransactions=this.includeAllSourceTransactions,this.randomVals&&this.randomVals.length>1&&(C.randomVals=[...this.randomVals]);const N=await(0,l.createAction)(this,P,C);return N.tx&&this.beef.mergeBeefFromParty(this.storageParty,N.tx),N.tx&&(N.tx=this.verifyReturnedTxidOnlyAtomicBEEF(N.tx,(A=k.options)===null||A===void 0?void 0:A.knownTxids)),C.isDelayed||_(N),N}async signAction(k,O){var A;e.validateOriginator(O);const{auth:R,vargs:P}=this.validateAuthAndArgs(k,e.validateSignActionArgs),C=await(0,f.signAction)(this,R,k);P.isDelayed||S(C);const N=this.pendingSignActions[k.reference];return C.tx&&(C.tx=this.verifyReturnedTxidOnlyAtomicBEEF(C.tx,(A=N.args.options)===null||A===void 0?void 0:A.knownTxids)),C}async abortAction(k,O){e.validateOriginator(O);const{auth:A}=this.validateAuthAndArgs(k,e.validateAbortActionArgs);return await this.storage.abortAction(k)}async internalizeAction(k,O){e.validateOriginator(O);const{auth:A,vargs:R}=this.validateAuthAndArgs(k,e.validateInternalizeActionArgs);return await(0,n.internalizeAction)(this,A,k)}async relinquishOutput(k,O){e.validateOriginator(O);const{vargs:A}=this.validateAuthAndArgs(k,e.validateRelinquishOutputArgs);return await this.storage.relinquishOutput(k),{relinquished:!0}}async isAuthenticated(k,O){return e.validateOriginator(O),{authenticated:!0}}async waitForAuthentication(k,O){return e.validateOriginator(O),{authenticated:!0}}async getHeight(k,O){return e.validateOriginator(O),{height:await this.getServices().getHeight()}}async getHeaderForHeight(k,O){e.validateOriginator(O);const A=await this.getServices().getHeaderForHeight(k.height);return{header:r.Utils.toHex(A)}}async getNetwork(k,O){return e.validateOriginator(O),{network:(0,g.toWalletNetwork)(this.chain)}}async getVersion(k,O){return e.validateOriginator(O),{version:"wallet-brc100-1.0.0"}}async sweepTo(k){const O=(0,g.randomBytesBase64)(8),A=(0,g.randomBytesBase64)(8),R=this.keyDeriver,P=new b.ScriptTemplateBRC29({derivationPrefix:O,derivationSuffix:A,keyDeriver:R}),C="sweep",N=y.maxPossibleSatoshis,D=await this.createAction({outputs:[{lockingScript:P.lock(R.rootKey.toString(),k.identityKey).toHex(),satoshis:N,outputDescription:C,tags:["relinquish"],customInstructions:JSON.stringify({derivationPrefix:O,derivationSuffix:A,type:"BRC29"})}],options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1},labels:[C],description:C});await k.internalizeAction({tx:D.tx,outputs:[{outputIndex:0,protocol:"wallet payment",paymentRemittance:{derivationPrefix:O,derivationSuffix:A,senderIdentityKey:this.identityKey}}],description:C,labels:[C]})}async balanceAndUtxos(k="default"){const O={total:0,utxos:[]};let A=0;for(;;){const R=await this.listOutputs({basket:k,limit:1e3,offset:A});if(R.totalOutputs===0)break;for(const P of R.outputs)O.total+=P.satoshis,O.utxos.push({satoshis:P.satoshis,outpoint:P.outpoint});A+=R.outputs.length}return O}async balance(){const k={basket:p.specOpWalletBalance};return(await this.listOutputs(k)).totalOutputs}async reviewSpendableOutputs(k=!1,O=!1,A){const R={...A||{},basket:p.specOpInvalidChange};return R.tags||(R.tags=[]),k&&R.tags.push("all"),O&&R.tags.push("release"),await this.listOutputs(R)}async setWalletChangeParams(k,O){const A={basket:p.specOpSetWalletChangeParams,tags:[k.toString(),O.toString()]};await this.listOutputs(A)}async listNoSendActions(k,O=!1){const{vargs:A}=this.validateAuthAndArgs(k,e.validateListActionsArgs);return A.labels.push(p.specOpNoSendActions),O&&A.labels.push("abort"),await this.storage.listActions(A)}async listFailedActions(k,O=!1){const{vargs:A}=this.validateAuthAndArgs(k,e.validateListActionsArgs);return A.labels.push(p.specOpFailedActions),O&&A.labels.push("unfail"),await this.storage.listActions(A)}};rr.Wallet=v;function _(I){const k=I.notDelayedResults,O=I.sendWithResults;if(!(!k||!O||O.every(A=>A.status==="unproven")))throw new e.WERR_REVIEW_ACTIONS(k,O,I.txid,I.tx,I.noSendChange)}function S(I){const k=I.notDelayedResults,O=I.sendWithResults;if(!(!k||!O||O.every(A=>A.status==="unproven")))throw new e.WERR_REVIEW_ACTIONS(k,O,I.txid,I.tx)}function T(){const k=r.Beef.fromBinary(r.Utils.fromBase58("gno9MC7VXii1KoCkc2nsVyYJpqzN3dhBzYATETJcys62emMKfpBof4R7GozwYEaSapUtnNvqQ57aaYYjm3U2dv9eUJ1sV46boHkQgppYmAz9YH8FdZduV8aJayPViaKcyPmbDhEw6UW8TM5iFZLXNs7HBnJHUKCeTdNK4FUEL7vAugxAV9WUUZ43BZjJk2SmSeps9TCXjt1Ci9fKWp3d9QSoYvTpxwzyUFHjRKtbUgwq55ZfkBp5bV2Bpz9qSuKywKewW7Hh4S1nCUScwwzpKDozb3zic1V9p2k8rQxoPsRxjUJ8bjhNDdsN8d7KukFuc3n47fXzdWttvnxwsujLJRGnQbgJuknQqx3KLf5kJXHzwjG6TzigZk2t24qeB6d3hbYiaDr2fFkUJBL3tukTHhfNkQYRXuz3kucVDzvejHyqJaF51mXG8BjMN5aQj91ZJXCaPVqkMWCzmvyaqmXMdRiJdSAynhXbQK91xf6RwdNhz1tg5f9B6oJJMhsi9UYSVymmax8VLKD9AKzBCBDcfyD83m3jyS1VgKGZn3SkQmr6bsoWq88L3GsMnnmYUGogvdAYarTqg3pzkjCMxHzmJBMN6ofnUk8c1sRTXQue7BbyUaN5uZu3KW6CmFsEfpuqVvnqFW93TU1jrPP2S8yz8AexAnARPCKE8Yz7RfVaT6RCavwQKL3u5iookwRWEZXW1QWmM37yJWHD87SjVynyg327a1CLwcBxmE2CB48QeNVGyQki4CTQMqw2o8TMhDPJej1g68oniAjBcxBLSCs7KGvK3k7AfrHbCMULX9CTibYhCjdFjbsbBoocqJpxxcvkMo1fEEiAzZuiBVZQDYktDdTVbhKHvYkW25HcYX75NJrpNAhm7AjFeKLzEVxqAQkMfvTufpESNRZF4kQqg2Rg8h2ajcKTd5cpEPwXCrZLHm4EaZEmZVbg3QNfGhn7BJu1bHMtLqPD4y8eJxm2uGrW6saf6qKYmmu64F8A667NbD4yskPRQ1S863VzwGpxxmgLc1Ta3R46jEqsAoRDoZVUaCgBBZG3Yg1CTgi1EVBMXU7qvY4n3h8o2FLCEMWY4KadnV3iD4FbcdCmg4yxBosNAZgbPjhgGjCimjh4YsLd9zymGLmivmz2ZBg5m3xaiXT9NN81X9C1JUujd")),A=k.txs.slice(-1)[0].txid;debugger;throw new e.WERR_REVIEW_ACTIONS([{txid:A,status:"doubleSpend",competingTxs:[A],competingBeef:k.toBinary()}],[{txid:A,status:"failed"}],A,k.toBinaryAtomic(A),[`${A}.0`])}return rr}var ar={},uo={},Z6;function fF(){return Z6||(Z6=1,function(s){var t=uo&&uo.__createBinding||(Object.create?function(r,e,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(e,o);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,a,l)}:function(r,e,o,a){a===void 0&&(a=o),r[a]=e[o]}),i=uo&&uo.__exportStar||function(r,e){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(e,o)&&t(e,r,o)};Object.defineProperty(s,"__esModule",{value:!0}),i(uk(),s)}(uo)),uo}var kd={},Ed={},J6;function Dr(){if(J6)return Ed;J6=1,Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.WalletMonitorTask=void 0;let s=class{constructor(i,r){this.monitor=i,this.name=r,this.lastRunMsecsSinceEpoch=0,this.storage=i.storage}async asyncSetup(){}};return Ed.WalletMonitorTask=s,Ed}var t8;function hF(){if(t8)return kd;t8=1,Object.defineProperty(kd,"__esModule",{value:!0}),kd.TaskPurge=void 0;const s=Dr();let t=class Pp extends s.WalletMonitorTask{constructor(r,e,o=0){super(r,Pp.taskName),this.params=e,this.triggerMsecs=o}trigger(r){return{run:Pp.checkNow||this.triggerMsecs>0&&r-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let r="";Pp.checkNow=!1;const e=await this.storage.runAsStorageProvider(async o=>await o.purgeData(this.params));return e.count>0&&(r=`${e.count} records updated or deleted.
${e.log}`),r}};return kd.TaskPurge=t,t.taskName="Purge",t.checkNow=!1,kd}var Od={},e8;function pF(){if(e8)return Od;e8=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.TaskReviewStatus=void 0;const s=Dr();let t=class dk extends s.WalletMonitorTask{constructor(r,e=1e3*60*15,o=1e3*60*5){super(r,dk.taskName),this.triggerMsecs=e,this.agedMsecs=o}trigger(r){return{run:this.triggerMsecs>0&&r-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let r="";const e=new Date(Date.now()-this.agedMsecs),o=await this.storage.runAsStorageProvider(async a=>await a.reviewStatus({agedLimit:e}));return o.log.length>0&&(r+=`${o.log}`),r}};return Od.TaskReviewStatus=t,t.taskName="ReviewStatus",t.checkNow=!1,Od}var Ad={},i8;function yF(){if(i8)return Ad;i8=1,Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.TaskSyncWhenIdle=void 0;const s=Dr();let t=class fk extends s.WalletMonitorTask{constructor(r,e=1e3*60*1){super(r,fk.taskName),this.triggerMsecs=e}trigger(r){return this.storage,{run:!1}}async runTask(){return""}};return Ad.TaskSyncWhenIdle=t,t.taskName="SyncWhenIdle",Ad}var Pd={},n8;function gF(){if(n8)return Pd;n8=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.TaskFailAbandoned=void 0;const s=Dr();let t=class hk extends s.WalletMonitorTask{constructor(r,e=1e3*60*5){super(r,hk.taskName),this.triggerMsecs=e}trigger(r){return{run:r>this.lastRunMsecsSinceEpoch+this.triggerMsecs}}async runTask(){let r="",o=0;for(;;){const a=new Date,l=new Date(a.getTime()-this.monitor.options.abandonedMsecs);if(await this.storage.runAsStorageProvider(async n=>{const d=(await n.findTransactions({partial:{},status:["unprocessed","unsigned"],paged:{limit:100,offset:o}})).filter(y=>y.updated_at&&y.updated_at<l);for(const y of d)await n.updateTransactionStatus("failed",y.transactionId),r+=`updated tx ${y.transactionId} status to 'failed'
`;return d.length<100}))break;o+=100}return r}};return Pd.TaskFailAbandoned=t,t.taskName="FailAbandoned",Pd}var Wc={},r8;function pk(){if(r8)return Wc;r8=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.TaskCheckForProofs=void 0,Wc.getProofs=o;const s=gi(),t=vu(),i=UI(),r=Dr();let e=class Vd extends r.WalletMonitorTask{constructor(l,f=0){super(l,Vd.taskName),this.triggerMsecs=f}trigger(l){return{run:Vd.checkNow||this.triggerMsecs>0&&l-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let l="";const f=Vd.checkNow;Vd.checkNow=!1;const n=100;let c=0;for(;;){const d=await this.storage.findProvenTxReqs({partial:{},status:["callback","unmined","sending","unknown","unconfirmed"],paged:{limit:n,offset:c}});if(d.length===0)break;l+=`${d.length} reqs with status 'callback', 'unmined', 'sending', 'unknown', or 'unconfirmed'
`;const y=await o(this,d,2,f);if(l+=`${y.log}
`,d.length<n)break;c+=n}return l}};Wc.TaskCheckForProofs=e,e.taskName="CheckForProofs",e.checkNow=!1;async function o(a,l,f=0,n=!1,c=!1){const d=[],y=[];let p="";for(const g of l){if(p+=" ".repeat(f),p+=`reqId ${g.provenTxReqId} txid ${g.txid}: `,!c&&g.status!=="callback"&&g.status!=="unmined"&&g.status!=="unknown"&&g.status!=="unconfirmed"&&g.status!=="nosend"&&g.status!=="sending"){p+=`status of '${g.status}' is not ready to be proven.
`;continue}const b=new s.EntityProvenTxReq(g);if(Number.isInteger(b.provenTxId)){p+=`Already linked to provenTxId ${b.provenTxId}.
`,b.notified=!1,b.status="completed",await b.updateStorageDynamicProperties(a.storage),d.push(g);continue}p+=`
`;let w=!1;if(b.rawTx&&(0,i.asString)((0,t.doubleSha256BE)(b.rawTx))===b.txid&&(w=!0),!w){p+=` rawTx doesn't hash to txid. status => invalid.
`,b.notified=!1,b.status="invalid",await b.updateStorageDynamicProperties(a.storage),y.push(g);continue}const v=a.monitor.chain==="main"?a.monitor.options.unprovenAttemptsLimitMain:a.monitor.options.unprovenAttemptsLimitTest;if(!c&&b.attempts>v){p+=` too many failed attempts ${b.attempts}
`,b.notified=!1,b.status="invalid",await b.updateStorageDynamicProperties(a.storage),y.push(g);continue}const _=new Date;let S,T;if(S=await a.monitor.services.getMerklePath(b.txid),T=await s.EntityProvenTx.fromReq(b,S,n&&b.status!=="nosend"),T){await b.updateStorageDynamicProperties(a.storage),await b.refreshFromStorage(a.storage);const{provenTxReqId:I,status:k,txid:O,attempts:A,history:R}=b.toApi(),{index:P,height:C,blockHash:N,merklePath:D,merkleRoot:U}=T.toApi(),F=await a.storage.runAsStorageProvider(async L=>await L.updateProvenTxReqWithNewProvenTx({provenTxReqId:I,status:k,txid:O,attempts:A,history:R,index:P,height:C,blockHash:N,merklePath:D,merkleRoot:U}));b.status=F.status,b.apiHistory=F.history,b.provenTxId=F.provenTxId,b.notified=!0}else n&&b.status!=="nosend"&&b.attempts++;await b.updateStorageDynamicProperties(a.storage),await b.refreshFromStorage(a.storage),p+=b.historyPretty(_,f+2)+`
`,b.status==="completed"&&d.push(b.api),b.status==="invalid"&&y.push(b.api)}return{proven:d,invalid:y,log:p}}return Wc}var Rd={},a8;function mF(){if(a8)return Rd;a8=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.TaskClock=void 0;const s=Dr();let t=class yk extends s.WalletMonitorTask{constructor(r,e=1*r.oneSecond){super(r,yk.taskName),this.triggerMsecs=e,this.nextMinute=this.getNextMinute()}trigger(r){return this.storage,{run:Date.now()>this.nextMinute}}async runTask(){const r=`${new Date(this.nextMinute).toISOString()}`;return this.nextMinute=this.getNextMinute(),r}getNextMinute(){return Math.ceil(Date.now()/this.monitor.oneMinute)*this.monitor.oneMinute}};return Rd.TaskClock=t,t.taskName="Clock",Rd}var Md={},s8;function bF(){if(s8)return Md;s8=1,Object.defineProperty(Md,"__esModule",{value:!0}),Md.TaskNewHeader=void 0;const s=Dr();let t=class gk extends s.WalletMonitorTask{constructor(r,e=1*r.oneMinute){super(r,gk.taskName),this.triggerMsecs=e}async getHeader(){return await this.monitor.chaintracks.findChainTipHeader()}trigger(r){return{run:!0}}async runTask(){let r="";const e=this.header;this.header=await this.getHeader();let o=!0;if(!e)r=`first header: ${this.header.height} ${this.header.hash}`;else if(e.height<this.header.height){const a=this.header.height-e.height-1,l=a>0?` SKIPPED ${a}`:"";r=`new header: ${this.header.height} ${this.header.hash}${l}`}else e.height===this.header.height&&e.hash!=this.header.hash?r=`reorg header: ${this.header.height} ${this.header.hash}`:o=!1;return o&&this.monitor.processNewBlockHeader(this.header),r}};return Md.TaskNewHeader=t,t.taskName="NewHeader",Md}var Nd={},o8;function wF(){if(o8)return Nd;o8=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.TaskSendWaiting=void 0;const s=lk(),t=v1(),i=Dr(),r=HI();let e=class mk extends i.WalletMonitorTask{constructor(a,l=a.oneSecond*8,f=a.oneSecond*7,n=a.oneMinute*5){super(a,mk.taskName),this.triggerMsecs=l,this.agedMsecs=f,this.sendingMsecs=n,this.includeSending=!0}trigger(a){return this.includeSending=!this.lastSendingRunMsecsSinceEpoch||a>this.lastSendingRunMsecsSinceEpoch+this.sendingMsecs,this.includeSending&&(this.lastSendingRunMsecsSinceEpoch=a),{run:a>this.lastRunMsecsSinceEpoch+this.triggerMsecs}}async runTask(){let a="",f=0;const n=new Date(Date.now()-this.agedMsecs),c=this.includeSending?["unsent","sending"]:["unsent"];for(;;){let d=await this.storage.findProvenTxReqs({partial:{},status:c,paged:{limit:100,offset:f}});const y=d.length;if(d.length===0)break;a+=`${d.length} reqs with status ${c.join(" or ")}
`;const p=d.filter(g=>(0,t.verifyTruthy)(g.updated_at)<n);if(a+=`  Of those reqs, ${p.length} where last updated before ${n.toISOString()}.
`,a+=await this.processUnsent(p,2),y<100)break;f+=100}return a}async processUnsent(a,l=0){let f="";for(let n=0;n<a.length;n++){const c=a[n];if(f+=" ".repeat(l),f+=`${n} reqId=${c.provenTxReqId} attempts=${c.attempts} txid=${c.txid}: 
`,c.status!=="unsent"&&c.status!=="sending"){f+=`  status now ${c.status}
`;continue}const d=new s.EntityProvenTxReq(c),y=[];if(d.batch){const g=await this.storage.findProvenTxReqs({partial:{batch:d.batch,status:"unsent"}});for(const b of g){const w=a.findIndex(v=>v.provenTxReqId===b.provenTxReqId);w>-1&&a.slice(w,w+1),y.push(new s.EntityProvenTxReq(b))}}else y.push(d);const p=await this.storage.runAsStorageProvider(async g=>(0,r.attemptToPostReqsToNetwork)(g,y));f+=p.log}return f}};return Nd.TaskSendWaiting=e,e.taskName="SendWaiting",Nd}var Cd={},c8;function vF(){if(c8)return Cd;c8=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.TaskCheckNoSends=void 0;const s=pk(),t=Dr();let i=class Wd extends t.WalletMonitorTask{constructor(e,o=e.oneDay*1){super(e,Wd.taskName),this.triggerMsecs=o}trigger(e){return{run:Wd.checkNow||this.triggerMsecs>0&&e-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let e="";const o=Wd.checkNow;Wd.checkNow=!1;const a=100;let l=0;for(;;){const f=await this.storage.findProvenTxReqs({partial:{},status:["nosend"],paged:{limit:a,offset:l}});if(f.length===0)break;e+=`${f.length} reqs with status 'nosend'
`;const n=await(0,s.getProofs)(this,f,2,o);if(e+=`${n.log}
`,f.length<a)break;l+=a}return e}};return Cd.TaskCheckNoSends=i,i.taskName="CheckNoSends",i.checkNow=!1,Cd}var Dd={},u8;function xF(){if(u8)return Dd;u8=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.TaskUnFail=void 0;const s=ge(),t=Dr(),i=gi();let r=class Rp extends t.WalletMonitorTask{constructor(o,a=o.oneMinute*10){super(o,Rp.taskName),this.triggerMsecs=a}trigger(o){return{run:Rp.checkNow||this.triggerMsecs>0&&o-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let o="";Rp.checkNow=!1;const a=100;let l=0;for(;;){const f=await this.storage.findProvenTxReqs({partial:{},status:["unfail"],paged:{limit:a,offset:l}});if(f.length===0)break;o+=`${f.length} reqs with status 'unfail'
`;const n=await this.unfail(f,2);if(o+=`${n.log}
`,f.length<a)break;l+=a}return o}async unfail(o,a=0){let l="";for(const f of o){const n=new i.EntityProvenTxReq(f);l+=" ".repeat(a),l+=`reqId ${f.provenTxReqId} txid ${f.txid}: `,(await this.monitor.services.getMerklePath(n.txid)).merklePath?(n.status="unmined",n.attempts=0,l+=`unfailed. status is now 'unmined'
`,l+=await this.unfailReq(n,a+2)):(n.status="invalid",l+=`returned to status 'invalid'
`),await n.updateStorageDynamicProperties(this.storage)}return{log:l}}async unfailReq(o,a){let l="";this.storage;const f=this.monitor.services,n=o.notify.transactionIds||[];for(const c of n){const d=s.Transaction.fromBinary(o.rawTx);await this.storage.runAsStorageProvider(async y=>{const p=y,g=await y.findTransactionById(c,void 0,!0);if(!g){l+=" ".repeat(a)+`transaction ${c} was not found
`;return}await y.updateTransaction(g.transactionId,{status:"unproven"}),g.status="unproven",l+=" ".repeat(a)+`transaction ${c} status is now 'unproven'
`;let b=-1;for(const v of d.inputs){b++;const _=await y.findOutputs({partial:{userId:g.userId,txid:v.sourceTXID,vout:v.sourceOutputIndex}});if(_.length!==1)l+=" ".repeat(a+2)+`input ${b} not matched to user's outputs
`;else{const S=_[0];l+=" ".repeat(a+2)+`input ${b} matched to output ${S.outputId} updated spentBy ${g.transactionId}
`,await y.updateOutput(S.outputId,{spendable:!1,spentBy:g.transactionId})}}const w=await y.findOutputs({partial:{userId:g.userId,transactionId:g.transactionId}});for(const v of w)if(await p.validateOutputScript(v),!v.lockingScript)l+=" ".repeat(a+2)+`output ${v.outputId} does not have a valid locking script
`;else{const _=await f.isUtxo(v);_!==v.spendable?(l+=" ".repeat(a+2)+`output ${v.outputId} set to ${_?"spendable":"spent"}
`,await y.updateOutput(v.outputId,{spendable:_})):l+=" ".repeat(a+2)+`output ${v.outputId} unchanged
`}})}return l}};return Dd.TaskUnFail=r,r.taskName="UnFail",r.checkNow=!1,Dd}var l8;function _F(){if(l8)return ar;l8=1;var s=ar&&ar.__createBinding||(Object.create?function(v,_,S,T){T===void 0&&(T=S);var I=Object.getOwnPropertyDescriptor(_,S);(!I||("get"in I?!_.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return _[S]}}),Object.defineProperty(v,T,I)}:function(v,_,S,T){T===void 0&&(T=S),v[T]=_[S]}),t=ar&&ar.__setModuleDefault||(Object.create?function(v,_){Object.defineProperty(v,"default",{enumerable:!0,value:_})}:function(v,_){v.default=_}),i=ar&&ar.__importStar||function(){var v=function(_){return v=Object.getOwnPropertyNames||function(S){var T=[];for(var I in S)Object.prototype.hasOwnProperty.call(S,I)&&(T[T.length]=I);return T},v(_)};return function(_){if(_&&_.__esModule)return _;var S={};if(_!=null)for(var T=v(_),I=0;I<T.length;I++)T[I]!=="default"&&s(S,_,T[I]);return t(S,_),S}}();Object.defineProperty(ar,"__esModule",{value:!0}),ar.Monitor=void 0;const r=i(Rr()),e=fF(),o=vu(),a=hF(),l=pF(),f=yF(),n=gF(),c=pk(),d=mF(),y=bF(),p=wF(),g=vF(),b=xF();let w=class{static createDefaultWalletMonitorOptions(_,S,T){if(T||(T=new e.Services(_)),!T.options.chaintracks)throw new r.WERR_INVALID_PARAMETER("services.options.chaintracks","valid");return{chain:_,services:T,storage:S,msecsWaitPerMerkleProofServiceReq:500,taskRunWaitMsecs:5e3,abandonedMsecs:1e3*60*5,unprovenAttemptsLimitTest:10,unprovenAttemptsLimitMain:144,chaintracks:T.options.chaintracks}}constructor(_){this.oneSecond=1e3,this.oneMinute=60*this.oneSecond,this.oneHour=60*this.oneMinute,this.oneDay=24*this.oneHour,this.oneWeek=7*this.oneDay,this._tasks=[],this._otherTasks=[],this._tasksRunning=!1,this.defaultPurgeParams={purgeSpent:!1,purgeCompleted:!1,purgeFailed:!0,purgeSpentAge:2*this.oneWeek,purgeCompletedAge:2*this.oneWeek,purgeFailedAge:5*this.oneDay},this._runAsyncSetup=!0,this.options={..._},this.services=_.services,this.chain=this.services.chain,this.storage=_.storage,this.chaintracks=_.chaintracks}addAllTasksToOther(){this._otherTasks.push(new d.TaskClock(this)),this._otherTasks.push(new y.TaskNewHeader(this)),this._otherTasks.push(new a.TaskPurge(this,this.defaultPurgeParams)),this._otherTasks.push(new l.TaskReviewStatus(this)),this._otherTasks.push(new p.TaskSendWaiting(this)),this._otherTasks.push(new c.TaskCheckForProofs(this)),this._otherTasks.push(new g.TaskCheckNoSends(this)),this._otherTasks.push(new b.TaskUnFail(this)),this._otherTasks.push(new n.TaskFailAbandoned(this)),this._otherTasks.push(new f.TaskSyncWhenIdle(this))}addDefaultTasks(){this._tasks.push(new d.TaskClock(this)),this._tasks.push(new y.TaskNewHeader(this)),this._tasks.push(new p.TaskSendWaiting(this,8*this.oneSecond,7*this.oneSecond)),this._tasks.push(new c.TaskCheckForProofs(this,2*this.oneHour)),this._tasks.push(new g.TaskCheckNoSends(this)),this._tasks.push(new n.TaskFailAbandoned(this,8*this.oneMinute)),this._tasks.push(new b.TaskUnFail(this)),this._tasks.push(new l.TaskReviewStatus(this))}addMultiUserTasks(){this._tasks.push(new d.TaskClock(this)),this._tasks.push(new y.TaskNewHeader(this)),this._tasks.push(new p.TaskSendWaiting(this,8*this.oneSecond,7*this.oneSecond)),this._tasks.push(new c.TaskCheckForProofs(this,2*this.oneHour)),this._tasks.push(new g.TaskCheckNoSends(this)),this._tasks.push(new n.TaskFailAbandoned(this,8*this.oneMinute)),this._tasks.push(new b.TaskUnFail(this)),this._tasks.push(new l.TaskReviewStatus(this))}addTask(_){if(this._tasks.some(S=>S.name===_.name))throw new r.WERR_BAD_REQUEST(`task ${_.name} has already been added.`);this._tasks.push(_)}removeTask(_){this._tasks=this._tasks.filter(S=>S.name!==_)}async setupChaintracksListeners(){}async runTask(_){let S=this._tasks.find(I=>I.name===_),T="";return S||(S=this._otherTasks.find(I=>I.name===_)),S&&(await S.asyncSetup(),T=await S.runTask()),T}async runOnce(){if(this._runAsyncSetup){for(const _ of this._tasks){try{await _.asyncSetup()}catch(S){const T=r.WalletError.fromUnknown(S),I=`monitor task ${_.name} asyncSetup error ${T.code} ${T.description}`;console.log(I),await this.logEvent("error0",I)}if(!this._tasksRunning)break}this._runAsyncSetup=!1}if(this.storage.getActive().isStorageProvider()){const _=[],S=new Date().getTime();for(const T of this._tasks)try{T.trigger(S).run&&_.push(T)}catch(I){const k=r.WalletError.fromUnknown(I),O=`monitor task ${T.name} trigger error ${k.code} ${k.description}`;console.log(O),await this.logEvent("error0",O)}for(const T of _)try{if(this.storage.getActive().isStorageProvider()){const I=await T.runTask();I&&I.length>0&&(console.log(`Task${T.name} ${I}`),await this.logEvent(T.name,I))}}catch(I){const k=r.WalletError.fromUnknown(I),O=`monitor task ${T.name} runTask error ${k.code} ${k.description}
${k.stack}`;console.log(O),await this.logEvent("error1",O)}finally{T.lastRunMsecsSinceEpoch=new Date().getTime()}}}async startTasks(){if(this._tasksRunning)throw new r.WERR_BAD_REQUEST("monitor tasks are already runnining.");for(this._tasksRunning=!0;this._tasksRunning;)await this.runOnce(),await(0,o.wait)(this.options.taskRunWaitMsecs)}async logEvent(_,S){await this.storage.runAsStorageProvider(async T=>{await T.insertMonitorEvent({created_at:new Date,updated_at:new Date,id:0,event:_,details:S})})}stopTasks(){this._tasksRunning=!1}processNewBlockHeader(_){const S=_;this.lastNewHeader=S,this.lastNewHeaderWhen=new Date,console.log(`WalletMonitor notified of new block header ${S.height}`),c.TaskCheckForProofs.checkNow=!0}processReorg(_,S,T){}};return ar.Monitor=w,ar}var d8;function se(){return d8||(d8=1,function(s){var t=Yn&&Yn.__createBinding||(Object.create?function(o,a,l,f){f===void 0&&(f=l);var n=Object.getOwnPropertyDescriptor(a,l);(!n||("get"in n?!a.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(o,f,n)}:function(o,a,l,f){f===void 0&&(f=l),o[f]=a[l]}),i=Yn&&Yn.__setModuleDefault||(Object.create?function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}:function(o,a){o.default=a}),r=Yn&&Yn.__importStar||function(){var o=function(a){return o=Object.getOwnPropertyNames||function(l){var f=[];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(f[f.length]=n);return f},o(a)};return function(a){if(a&&a.__esModule)return a;var l={};if(a!=null)for(var f=o(a),n=0;n<f.length;n++)f[n]!=="default"&&t(l,a,f[n]);return i(l,a),l}}(),e=Yn&&Yn.__exportStar||function(o,a){for(var l in o)l!=="default"&&!Object.prototype.hasOwnProperty.call(a,l)&&t(a,o,l)};Object.defineProperty(s,"__esModule",{value:!0}),s.sdk=void 0,s.sdk=r(Rr()),e(v1(),s),e(bB(),s),e(wB(),s),e(vB(),s),e(xB(),s),e(nk(),s),e(_B(),s),e(SB(),s),e(TB(),s),e(IB(),s),e(_1(),s),e(uk(),s),e(w1(),s),e(FB(),s),e(lk(),s),e(dF(),s),e(_F(),s)}(Yn)),Yn}var xp=se();const bk="8e89c83f7d7a4a3c4405c8f28d37e97823fcff024f289faf2941cb9bf448b7bd",wk="28476d98e1e742828967e4f51a3bb5050bdbf1df94c61613e74f9bd6e0e50cc7",vk="9b4cefabf5b8f918dd8bdb77f6748b65de9e6da1941fdcf9441fcec6dadf6e38",SF="https://storage.babbage.systems",TF=Or.fromHex(bk).toPublicKey().toString(),Eb=Or.fromHex(wk).toPublicKey().toString(),xk=Or.fromHex(vk).toPublicKey().toString(),IF=async()=>{const s=Or.fromHex(bk),t=new VT(s),i=new xp.WalletStorageManager(t.identityKey),r="main",e=new xp.Services(r),o=new xp.Wallet({chain:r,keyDeriver:t,storage:i,services:e}),a=new xp.StorageClient(o,SF);return await i.addWalletStorageProvider(a),await i.makeAvailable(),new xC(o)},_k=s=>{let t;if(s==="patient")t=Or.fromHex(wk);else if(s==="pharmacy")t=Or.fromHex(vk);else throw new Error("Unknown wallet owner");return new WT(t)},Sk=IF(),Tk=_k("patient"),kF=_k("pharmacy"),EF="gas-chain-db",OF=1,Mr="submissions",C0=()=>new Promise((s,t)=>{const i=indexedDB.open(EF,OF);i.onupgradeneeded=r=>{const e=r.target.result;if(!e.objectStoreNames.contains(Mr)){const o=e.createObjectStore(Mr,{keyPath:"txid"});o.createIndex("step","step",{unique:!1}),o.createIndex("timestamp","data.timestamp",{unique:!1})}},i.onsuccess=r=>{const e=r.target.result;s(e)},i.onerror=r=>{var e;console.error("IndexedDB error:",r.target.error),t(new Error(`IndexedDB error: ${((e=r.target.error)==null?void 0:e.message)??"Unknown error"}`))}}),D0=async s=>{try{const t=await C0(),i=t.transaction([Mr],"readwrite"),r=i.objectStore(Mr);return new Promise((e,o)=>{const a=r.put(s);a.onsuccess=()=>{e()},a.onerror=l=>{var f;console.error("Error saving submission:",l.target.error),o(new Error(`Error saving submission: ${((f=l.target.error)==null?void 0:f.message)??"Unknown error"}`))},i.oncomplete=()=>{t.close()}})}catch(t){throw console.error("Failed to save submission:",t),t}},f8=async()=>{try{const s=await C0(),t=s.transaction([Mr],"readonly"),i=t.objectStore(Mr);return new Promise((r,e)=>{const o=i.getAll();o.onsuccess=a=>{r(a.target.result)},o.onerror=a=>{var l;console.error("Error getting submissions:",a.target.error),e(new Error(`Error getting submissions: ${((l=a.target.error)==null?void 0:l.message)??"Unknown error"}`))},t.oncomplete=()=>{s.close()}})}catch(s){return console.error("Failed to get submissions:",s),[]}},T1=async s=>{try{const t=await C0(),i=t.transaction([Mr],"readwrite"),r=i.objectStore(Mr),e=r.get(s);return new Promise((o,a)=>{e.onsuccess=l=>{const f=l.target.result;if(f){f.spent=!0;const n=r.put(f);n.onsuccess=()=>{o()},n.onerror=c=>{var d;console.error("Error updating submission:",c.target.error),a(new Error(`Error updating submission: ${((d=c.target.error)==null?void 0:d.message)??"Unknown error"}`))}}else a(new Error(`Submission with txid ${s} not found`))},e.onerror=l=>{var f;console.error("Error getting submission:",l.target.error),a(new Error(`Error getting submission: ${((f=l.target.error)==null?void 0:f.message)??"Unknown error"}`))},i.oncomplete=()=>{t.close()},i.onerror=l=>{var f;console.error("Transaction error:",l.target.error),a(new Error(`Transaction error: ${((f=l.target.error)==null?void 0:f.message)??"Unknown error"}`))}})}catch(t){throw console.error("Error in setSpent:",t),t}},AF=async()=>{try{const s=await C0(),t=s.transaction([Mr],"readwrite"),i=t.objectStore(Mr);return new Promise((r,e)=>{const o=i.clear();o.onsuccess=()=>{r()},o.onerror=a=>{var l;console.error("Error clearing submissions:",a.target.error),e(new Error(`Error clearing submissions: ${((l=a.target.error)==null?void 0:l.message)??"Unknown error"}`))},t.oncomplete=()=>{s.close()}})}catch(s){throw console.error("Failed to clear submissions:",s),s}},h8=[{paciente:{idPaciente:"P12345678",nombre:"Juan Pérez",fechaNacimiento:"1985-06-12"},prescriptor:{npiPrescriptor:"1234567890",nombre:"Dra. Sofía Rodríguez",clinica:"Centro Médico Buenos Aires"},medicamento:{nombreMedicamento:"Lisinopril",ndc:"12345-6789-01",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido por vía oral diariamente",fechaVencimiento:"2024-12-31"}},{paciente:{idPaciente:"P87654321",nombre:"Emilia Martínez",fechaNacimiento:"1992-03-25"},prescriptor:{npiPrescriptor:"0987654321",nombre:"Dr. Miguel Fernández",clinica:"Consultorios Médicos Palermo"},medicamento:{nombreMedicamento:"Atorvastatina",ndc:"98765-4321-02",dosis:"20mg",cantidad:90,recargas:3,instrucciones:"Tomar un comprimido por vía oral antes de acostarse",fechaVencimiento:"2025-01-15"}},{paciente:{idPaciente:"P24681357",nombre:"Roberto González",fechaNacimiento:"1978-11-30"},prescriptor:{npiPrescriptor:"2468135790",nombre:"Dra. Lucía Gómez",clinica:"Instituto Médico Recoleta"},medicamento:{nombreMedicamento:"Metformina",ndc:"24680-1357-03",dosis:"500mg",cantidad:60,recargas:5,instrucciones:"Tomar un comprimido dos veces al día con las comidas",fechaVencimiento:"2024-10-15"}},{paciente:{idPaciente:"P13579246",nombre:"Sara Torres",fechaNacimiento:"1985-07-12"},prescriptor:{npiPrescriptor:"1357924680",nombre:"Dr. Javier Sánchez",clinica:"Centro Médico San Telmo"},medicamento:{nombreMedicamento:"Lisinopril",ndc:"13579-2468-01",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido diariamente por la mañana",fechaVencimiento:"2024-12-20"}},{paciente:{idPaciente:"P97531086",nombre:"Diego López",fechaNacimiento:"1973-04-18"},prescriptor:{npiPrescriptor:"9753108642",nombre:"Dra. Jimena Castro",clinica:"Grupo Médico Belgrano"},medicamento:{nombreMedicamento:"Sertralina",ndc:"97531-0864-04",dosis:"50mg",cantidad:30,recargas:5,instrucciones:"Tomar un comprimido diariamente con o sin alimentos",fechaVencimiento:"2025-03-10"}},{paciente:{idPaciente:"P36925814",nombre:"Jessica Moreno",fechaNacimiento:"1990-09-05"},prescriptor:{npiPrescriptor:"3692581470",nombre:"Dr. Roberto Acosta",clinica:"Asociación Médica Caballito"},medicamento:{nombreMedicamento:"Levotiroxina",ndc:"36925-8147-02",dosis:"75mcg",cantidad:90,recargas:3,instrucciones:"Tomar un comprimido diariamente con el estómago vacío",fechaVencimiento:"2025-02-28"}},{paciente:{idPaciente:"P80246913",nombre:"Miguel Romero",fechaNacimiento:"1968-12-03"},prescriptor:{npiPrescriptor:"8024691357",nombre:"Dra. Sofía Rodríguez",clinica:"Clínica Valle Norte"},medicamento:{nombreMedicamento:"Amlodipina",ndc:"80246-9135-01",dosis:"5mg",cantidad:30,recargas:6,instrucciones:"Tomar un comprimido diariamente por la tarde",fechaVencimiento:"2024-11-15"}},{paciente:{idPaciente:"P15948732",nombre:"Ana Díaz",fechaNacimiento:"1982-05-20"},prescriptor:{npiPrescriptor:"1594873260",nombre:"Dr. Tomás Varela",clinica:"Centro Médico Puerto Madero"},medicamento:{nombreMedicamento:"Escitalopram",ndc:"15948-7326-03",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido diariamente a la misma hora cada día",fechaVencimiento:"2025-04-10"}}],Ik=et.createContext({queue:[],addToQueue:()=>{},removeFromQueue:()=>{},clearQueue:()=>{},prescription:null,setPrescription:()=>{},presentation:null,setPresentation:()=>{},dispensation:null,setDispensation:()=>{},acknowledgement:null,setAcknowledgement:()=>{},isSubmitting:!1,setIsSubmitting:()=>{},isProcessing:""}),xu=()=>et.useContext(Ik),PF=async s=>{try{const t=s.toBEEF(),i=await fetch("https://arc.taal.com/v1/tx",{method:"POST",headers:{"Content-Type":"application/octet-stream",Accept:"application/json"},body:new Blob([new Uint8Array(t)])});if(!i.ok)throw new Error("Failed to broadcast transaction");return await i.json()}catch(t){throw console.error("Error broadcasting transaction:",t),t}},RF=({children:s})=>{const[t,i]=et.useState([]),[r,e]=et.useState(""),[o,a]=et.useState(null),[l,f]=et.useState(null),[n,c]=et.useState(null),[d,y]=et.useState(null),[p,g]=et.useState(!1),b=S=>{i(T=>[...T,S])},w=et.useCallback(async()=>{if(!(t.length===0||r))try{const S=t[0];e(S.txid);const T=Ar.fromBEEF(S.tx),I=await PF(T);if(console.log({response:I}),I.status===200){const k=await Sk;await Promise.allSettled(T.inputs.map(async O=>{await k.relinquishOutput({basket:"default",output:S.txid+"."+O.sourceOutputIndex})}))}i(k=>k.slice(1))}catch(S){console.error("Error processing queue item:",S),i(T=>T.slice(1))}finally{e("")}},[t,r]);et.useEffect(()=>{t.length>0&&!r&&w()},[t,r,w]);const v=S=>{i(T=>T.filter(I=>I.txid!==S))},_=()=>{i([])};return it.jsx(Ik.Provider,{value:{queue:t,addToQueue:b,removeFromQueue:v,clearQueue:_,prescription:o,setPrescription:a,presentation:l,setPresentation:f,dispensation:n,setDispensation:c,acknowledgement:d,setAcknowledgement:y,isSubmitting:p,setIsSubmitting:g,isProcessing:r},children:s})},MF=()=>{const{prescription:s,presentation:t,dispensation:i,acknowledgement:r,setPrescription:e,setIsSubmitting:o,addToQueue:a,isSubmitting:l}=xu(),f=s??t??i??r;function n(){const y=h8[Math.floor(Math.random()*h8.length)];return y.timestamp=new Date().toISOString(),y.id=us(ds(8)),y}async function c(){try{if(l)return;const y=await Sk;o(!0);const p=new _0(y,"https://prescription-tokens.vercel.app"),g=n(),b=Pt(JSON.stringify(g),"utf8"),w=Vn(b),v=await p.lock([w],[0,"medical prescription"],g.id,Eb,!1,!0,"after"),_=await y.createAction({outputs:[{lockingScript:v.toHex(),satoshis:3,outputDescription:"medical prescription issuance"}],description:"Create prescription",options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1,noSend:!0}});console.log({action:_});const S={data:{...g,estado:"creado"},txid:_.txid,tx:_.tx,status:"created",spent:!1};e(S),a(S),await D0(S)}catch(y){console.error("Error creating prescription:",y)}finally{o(!1)}}const d=f?w0:b0;return it.jsx(h0,{sx:d,children:it.jsxs(p0,{disabled:!!f,onClick:c,children:[it.jsx(g0,{component:"img",image:"/prescription.png",alt:"Create Prescription",sx:m0}),it.jsxs(y0,{children:[it.jsx(ni,{gutterBottom:!0,variant:"h5",component:"div",sx:{...v0,color:"#2c6e8e"},children:"Emisión de Receta Médica"}),it.jsx(ni,{variant:"body1",color:"text.secondary",sx:x0,children:"El médico crea y firma la receta digital."})]})]})})},NF=()=>{const{addToQueue:s,prescription:t,setPrescription:i,setPresentation:r,setIsSubmitting:e,isSubmitting:o}=xu();async function a(){try{if(o)return;const f=Ar.fromBEEF(t.tx);e(!0);const n=new _0(Tk,"https://prescription-tokens.vercel.app"),c=t==null?void 0:t.data,d=Pt(JSON.stringify(c),"utf8"),y=Vn(d),p=new Ar,g=n.unlock([0,"medical prescription"],c.id,TF,"all",!1);p.addInput({sourceTransaction:f,sourceOutputIndex:0,unlockingScriptTemplate:g});const b=new Date().toISOString(),w=await n.lock([Pt("presentar "+b,"utf8"),y],[0,"medical prescription"],c.id,xk,!1,!0,"after");p.addOutput({lockingScript:w,satoshis:2}),await p.sign();const v={data:{id:c.id,timestamp:b,status:"presentada"},txid:p.id("hex"),tx:p.toBEEF(),status:"presented",spent:!1};i(null),r(v),s(v),await D0(v),await T1(t.txid)}catch(f){console.error("Error creating prescription:",f)}finally{e(!1)}}const l=t?b0:w0;return it.jsx(h0,{sx:l,children:it.jsxs(p0,{disabled:!t,onClick:a,children:[it.jsx(g0,{component:"img",image:"/present.png",alt:"Present Prescription",sx:m0}),it.jsxs(y0,{children:[it.jsx(ni,{gutterBottom:!0,variant:"h5",component:"div",sx:{...v0,color:"#2c6e8e"},children:"Presentación de la Receta"}),it.jsx(ni,{variant:"body1",color:"text.secondary",sx:x0,children:"El paciente presenta la receta al farmacéutico."})]})]})})},CF=()=>{const{addToQueue:s,presentation:t,setPresentation:i,setDispensation:r,setIsSubmitting:e,isSubmitting:o}=xu();async function a(){try{if(o)return;const f=Ar.fromBEEF(t.tx);e(!0);const n=new _0(kF,"https://prescription-tokens.vercel.app"),c=t.data.id,d=Pt(c,"base64"),y=new Ar,p=n.unlock([0,"medical prescription"],c,Eb,"all",!1);y.addInput({sourceTransaction:f,sourceOutputIndex:0,unlockingScriptTemplate:p});const g=new Date().toISOString(),b=await n.lock([Pt("dispensar "+g,"utf8"),d],[0,"medical prescription"],c,Eb,!1,!0,"after");y.addOutput({lockingScript:b,satoshis:1}),await y.sign();const w={data:{id:c,timestamp:g,status:"dispensar"},txid:y.id("hex"),tx:y.toBEEF(),status:"dispensed",spent:!1};i(null),r(w),s(w),await D0(w),await T1(t.txid)}catch(f){console.error("Error creating prescription:",f)}finally{e(!1)}}const l=t?b0:w0;return it.jsx(h0,{sx:l,children:it.jsxs(p0,{onClick:a,disabled:!t,children:[it.jsx(g0,{component:"img",image:"/dispense.png",alt:"Dispense Prescription",sx:m0}),it.jsxs(y0,{children:[it.jsx(ni,{gutterBottom:!0,variant:"h5",component:"div",sx:{...v0,color:"#2c6e8e"},children:"Dispensación del Medicamento"}),it.jsx(ni,{variant:"body1",color:"text.secondary",sx:x0,children:"El farmacéutico certifica que el medicamento fue entregado."})]})]})})},DF=()=>{const{addToQueue:s,dispensation:t,setDispensation:i,setAcknowledgement:r,setIsSubmitting:e,isSubmitting:o}=xu();async function a(){try{if(o)return;const f=Ar.fromBEEF(t.tx);e(!0);const n=new _0(Tk,"https://prescription-tokens.vercel.app"),c=t.data.id,d=Pt(c,"base64"),y=new Ar,p=n.unlock([0,"medical prescription"],c,xk,"all",!1);y.addInput({sourceTransaction:f,sourceOutputIndex:0,unlockingScriptTemplate:p});const g=new Date().toISOString(),b=new va;b.writeOpCode(X.OP_FALSE),b.writeOpCode(X.OP_RETURN),b.writeBin(Pt("recibido","utf8")),b.writeBin(d),y.addOutput({lockingScript:b,satoshis:0}),await y.sign();const w={data:{id:c,timestamp:g,status:"recibido"},txid:y.id("hex"),tx:y.toBEEF(),status:"acknowledged",spent:!0};i(null),r(w),s(w),await T1(t.txid),await D0(w),console.log({tx:y.toHexBEEF()})}catch(f){console.error("Error creating prescription:",f)}finally{e(!1)}}const l=t?b0:w0;return it.jsx(h0,{sx:l,children:it.jsxs(p0,{disabled:!t,onClick:a,children:[it.jsx(g0,{component:"img",image:"/acknowledge.png",alt:"Acknowledge Receipt",sx:m0}),it.jsxs(y0,{children:[it.jsx(ni,{gutterBottom:!0,variant:"h5",component:"div",sx:{...v0,color:"#2c6e8e"},children:"Confirmación de Recepción"}),it.jsx(ni,{variant:"body1",color:"text.secondary",sx:x0,children:"El paciente confirma que recibió el medicamento."})]})]})})},kk=Ia(it.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),BF=Ia(it.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),Ek=Ia(it.jsx("path",{d:"M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4z"})),Ok=Ia(it.jsx("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"})),FF=Ia(it.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),_p=({entry:s})=>{const[t,i]=et.useState(null),[r,e]=et.useState(null),o=fs(),a=async()=>{if(!(s!=null&&s.txid))return;const c=await(await fetch("https://arc.taal.com/v1/tx/"+s.txid)).json();i(c)},l=(c,d)=>{navigator.clipboard.writeText(c),e(d),setTimeout(()=>e(null),2e3)},f=(c,d="")=>{const y={};for(const p in c)typeof c[p]=="object"&&c[p]!==null?Object.assign(y,f(c[p],d+(d?".":"")+p)):y[d+(d?".":"")+p]=c[p];return y},n=s?f(s.data):null;return s?it.jsxs(ff,{elevation:3,onClick:a,sx:{flex:1,overflow:"hidden",position:"relative",borderRadius:3,p:3,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",borderLeft:`4px solid ${s!=null&&s.txid?o.palette.primary.main:o.palette.grey[400]}`,transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(0,0,0,0.08)"}},children:[it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",mb:2},children:[it.jsx(Ek,{sx:{mr:1.5,color:o.palette.primary.main}}),it.jsx(ni,{variant:"h6",sx:{color:o.palette.primary.main,fontWeight:600},children:"Registro de Receta"}),it.jsx(Ie,{sx:{flexGrow:1}}),it.jsx(wo,{title:"Actualizar estado",children:it.jsx(eu,{size:"small",onClick:c=>{c.stopPropagation(),a()},"aria-label":"refresh",sx:{color:o.palette.primary.light,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:it.jsx(BF,{fontSize:"small"})})})]}),it.jsx(jp,{sx:{mb:2}}),n&&it.jsxs(Ie,{sx:{display:"flex",flexDirection:"column"},children:[Object.keys(n).map(c=>it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:1,"&:hover":{backgroundColor:"rgba(248, 251, 253, 0.8)"}},children:[it.jsx(ni,{variant:"subtitle2",sx:{color:o.palette.primary.main,fontWeight:600,mr:2,fontSize:"0.85rem"},children:c}),it.jsx(Ie,{sx:{display:"flex",alignItems:"center"},children:it.jsx(ni,{variant:"body2",sx:{color:o.palette.text.primary,fontSize:"0.85rem"},children:n[c]})})]},c)),s.txid&&it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,mt:1,borderRadius:1,backgroundColor:"rgba(44, 110, 142, 0.05)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.1)"}},children:[it.jsx(ni,{variant:"subtitle2",sx:{color:o.palette.primary.main,fontWeight:600,fontSize:"0.85rem"},children:"txid"}),it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",maxWidth:"70%"},children:[it.jsx(ni,{variant:"body2",sx:{color:o.palette.text.primary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:s.txid}),it.jsx(wo,{title:r==="txid"?"¡Copiado!":"Copiar al portapapeles",children:it.jsx(eu,{size:"small",onClick:c=>{c.stopPropagation(),l(s.txid||"","txid")},sx:{ml:1,color:r==="txid"?o.palette.success.main:o.palette.grey[400],padding:"2px"},children:r==="txid"?it.jsx(Ok,{fontSize:"small"}):it.jsx(FF,{fontSize:"small"})})})]})]})]}),t&&it.jsxs(Ie,{sx:{mt:3},children:[it.jsx(jp,{sx:{mb:2}}),it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[it.jsx(ni,{variant:"subtitle2",sx:{color:o.palette.primary.main,fontWeight:600},children:"Verificación en Blockchain"}),it.jsx(ob,{label:t!=null&&t.txStatus?t==null?void 0:t.txStatus:"Pendiente",size:"small",color:t!=null&&t.txStatus?"success":"warning",variant:"outlined",sx:{fontWeight:500}})]})]}),(s==null?void 0:s.txid)&&it.jsx(Ie,{sx:{display:"flex",justifyContent:"flex-end",mt:2,pt:2,borderTop:`1px dashed ${o.palette.divider}`},children:it.jsx(wo,{title:"Ver en Whatsonchain",children:it.jsx(eu,{onClick:c=>{c.stopPropagation(),window.open(`https://whatsonchain.com/tx/${s.txid}`,"_blank")},sx:{color:o.palette.primary.light,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:it.jsx(kk,{})})})})]}):it.jsx(Ie,{sx:{flex:1,height:200,border:"1px dashed rgba(44, 110, 142, 0.25)",borderRadius:3,p:3,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(248, 251, 253, 0.6)",backdropFilter:"blur(4px)",transition:"all 0.3s ease"},children:it.jsx(ni,{variant:"body1",color:"text.secondary",sx:{fontStyle:"italic"},children:"Aún no hay datos para mostrar"})})},LF=Ia(it.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),UF=Ia(it.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),qF=Ia(it.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),jF=()=>{const{isSubmitting:s,setPrescription:t,setPresentation:i,setDispensation:r,setAcknowledgement:e}=xu(),[o,a]=et.useState([]),[l,f]=et.useState(!1),n=fs();et.useEffect(()=>{s||f8().then(p=>{a(p),p.forEach(g=>{if(!g.spent)switch(g.status){case"created":t(g);break;case"presented":i(g);break;case"dispensed":r(g);break;case"acknowledged":e(g);break;default:console.log({unknownToken:g})}})})},[s,f8]);const c=async()=>{await AF(),window.location.reload()};if(!o||o.length===0)return null;const d=p=>{switch(p){case"created":return n.palette.info.main;case"presented":return n.palette.warning.main;case"dispensed":return n.palette.success.main;case"acknowledged":return n.palette.primary.dark;default:return n.palette.grey[500]}},y=p=>{switch(p){case"created":return"Creada";case"presented":return"Presentada";case"dispensed":return"Dispensada";case"acknowledged":return"Confirmada";default:return p.charAt(0).toUpperCase()+p.slice(1)}};return it.jsxs(fN,{anchor:"bottom",open:!0,variant:"persistent",sx:{"& .MuiDrawer-paper":{height:l?"64px":"auto",maxHeight:l?"64px":"35vh",overflowY:"auto",backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderTop:`3px solid ${n.palette.primary.main}`,boxShadow:"0px -4px 20px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease"}},children:[it.jsx(Ie,{sx:{position:"sticky",top:0,backgroundColor:"rgba(255, 255, 255, 0.97)",backdropFilter:"blur(10px)",zIndex:1,borderBottom:l?"none":`1px solid ${n.palette.divider}`},children:it.jsxs(Ie,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2},children:[it.jsxs(Ie,{sx:{display:"flex",alignItems:"center"},children:[it.jsx(Ek,{sx:{mr:1.5,color:n.palette.primary.main}}),it.jsx(ni,{variant:"h6",sx:{color:n.palette.primary.main,fontWeight:600},children:"Registros de Recetas en Blockchain"})]}),it.jsxs(Ie,{sx:{display:"flex",gap:3},children:[!l&&it.jsx(wo,{title:"Borrar todos los registros",children:it.jsx(eu,{onClick:c,sx:{color:"white",backgroundColor:n.palette.secondary.main,borderRadius:"50%","&:hover":{backgroundColor:n.palette.secondary.dark,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},transition:"all 0.2s ease"},children:it.jsx(qF,{})})}),it.jsx(wo,{title:l?"Expandir":"Minimizar",children:it.jsx(eu,{onClick:()=>f(!l),sx:{color:n.palette.primary.main,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:l?it.jsx(LF,{}):it.jsx(UF,{})})})]})]})}),!l&&it.jsxs(ff,{sx:{p:{xs:2,md:3},mx:{xs:1,md:2},my:2,maxHeight:"calc(35vh - 70px)",overflowY:"auto",boxShadow:"none",backgroundColor:"transparent","::-webkit-scrollbar":{width:"8px"},"::-webkit-scrollbar-track":{background:"rgba(0, 0, 0, 0.05)",borderRadius:"8px"},"::-webkit-scrollbar-thumb":{background:"rgba(44, 110, 142, 0.2)",borderRadius:"8px"},"::-webkit-scrollbar-thumb:hover":{background:"rgba(44, 110, 142, 0.4)"}},children:[it.jsx(Ie,{sx:{mb:2},children:it.jsx(ni,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic",mb:2},children:"Historial completo de transacciones registradas en el blockchain"})}),o.slice().sort((p,g)=>new Date(g.data.timestamp||0).getTime()-new Date(p.data.timestamp||0).getTime()).map(p=>{var b,w;const g=(p==null?void 0:p.status)??((b=p==null?void 0:p.data)==null?void 0:b.status);return it.jsxs(vN,{sx:{py:1.5,px:2,mb:1.5,borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.7)",border:"1px solid rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(248, 251, 253, 1)",transform:"translateY(-1px)",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"}},direction:"row",spacing:2,alignItems:"center",className:"log-entry",children:[((w=p.data)==null?void 0:w.timestamp)&&it.jsx(Ie,{sx:{minWidth:"110px"},children:it.jsx(ni,{variant:"caption",sx:{color:n.palette.text.secondary,fontSize:"0.75rem",whiteSpace:"nowrap"},children:new Date(p.data.timestamp).toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})})}),it.jsxs(Ie,{sx:{display:"flex",gap:1,minWidth:"100px"},children:[it.jsx(ob,{label:y(g),size:"small",sx:{backgroundColor:`${d(g)}20`,color:d(g),fontWeight:600,borderRadius:"4px"}}),(p==null?void 0:p.spent)&&it.jsx(ob,{label:"Gastada",size:"small",sx:{backgroundColor:`${n.palette.info.main}20`,color:n.palette.info.main,fontWeight:600,borderRadius:"4px"}})]}),it.jsx(Ie,{sx:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},children:it.jsx(ni,{variant:"body2",sx:{fontSize:"0.8rem"},noWrap:!0,children:p.data.id})}),p.txid&&it.jsxs(Ie,{sx:{display:"flex",alignItems:"center"},children:[it.jsx(Ie,{sx:{maxWidth:{xs:"80px",sm:"120px",md:"200px"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:it.jsx(ni,{variant:"caption",sx:{color:n.palette.text.secondary,fontSize:"0.7rem"},children:p.txid})}),it.jsx(wo,{title:"Ver en whatsonchain",children:it.jsx(eu,{href:`https://whatsonchain.com/tx/${p.txid}`,target:"_blank",rel:"noopener noreferrer","aria-label":"open in whatsonchain",size:"small",sx:{ml:1,color:n.palette.primary.light,"&:hover":{color:n.palette.primary.main}},children:it.jsx(kk,{fontSize:"small"})})}),p.status==="acknowledged"&&!p.spent&&it.jsx(wo,{title:"Verificado",children:it.jsx(Ok,{fontSize:"small",sx:{ml:1,color:n.palette.success.main}})})]})]},p.txid)})]})]})},HF=()=>{const{prescription:s,presentation:t,dispensation:i,acknowledgement:r}=xu(),e={display:"flex",gap:{xs:3,md:4},alignItems:{xs:"flex-start",md:"center"},flexDirection:{xs:"column",md:"row"},mb:4},o={width:{xs:"100%",md:"50%",lg:"40%"},minWidth:{md:"350px"},flexShrink:0,transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(0,0,0,0.1)"}};return it.jsxs(Ie,{sx:{minHeight:"100vh",pt:10,pb:40,backgroundImage:`url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%232c6e8e' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E")`,backgroundAttachment:"fixed",display:"flex",flexDirection:"column"},children:[it.jsxs(kM,{maxWidth:"lg",sx:{display:"flex",flexDirection:"column",position:"relative",zIndex:1},children:[it.jsxs(ff,{elevation:0,sx:{textAlign:"center",p:{xs:3,md:4},my:4,background:"linear-gradient(135deg, rgba(44, 110, 142, 0.08) 0%, rgba(255, 255, 255, 0.9) 100%)",borderRadius:3,border:"1px solid rgba(44, 110, 142, 0.1)",backdropFilter:"blur(4px)"},children:[it.jsx(ni,{variant:"h4",color:"primary.main",gutterBottom:!0,sx:{fontWeight:700,textShadow:"0 1px 2px rgba(0,0,0,0.05)",fontSize:{xs:"1.7rem",sm:"2rem",md:"2.125rem"}},children:"Demostración de Recetas Médicas en Blockchain"}),it.jsx(ni,{variant:"subtitle1",color:"text.secondary",sx:{maxWidth:"800px",mx:"auto",mt:1},children:"Sistema seguro de gestión de recetas médicas utilizando tecnología blockchain"})]}),it.jsxs(Ie,{sx:{display:"flex",flexDirection:"column",gap:4},children:[it.jsxs(Ie,{sx:e,children:[it.jsx(Ie,{sx:o,children:it.jsx(MF,{})}),it.jsx(_p,{entry:s})]}),it.jsxs(Ie,{sx:e,children:[it.jsx(Ie,{sx:o,children:it.jsx(NF,{})}),it.jsx(_p,{entry:t})]}),it.jsxs(Ie,{sx:e,children:[it.jsx(Ie,{sx:o,children:it.jsx(CF,{})}),it.jsx(_p,{entry:i})]}),it.jsxs(Ie,{sx:e,children:[it.jsx(Ie,{sx:o,children:it.jsx(DF,{})}),it.jsx(_p,{entry:r})]})]}),it.jsx(Ie,{sx:{mb:50}})]}),it.jsx(jF,{})]})},KF={primary:{main:"#2c6e8e",light:"#4b9aaa",dark:"#1c4d64",contrastText:"#ffffff"},secondary:{main:"#8e0e2c",light:"#b23d54",dark:"#6a0921",contrastText:"#ffffff"},background:{default:"#f8fbfd",paper:"#ffffff"},text:{primary:"#2c353d",secondary:"#607d8b"},divider:"rgba(0, 0, 0, 0.08)",success:{main:"#4caf50",light:"#81c784",dark:"#388e3c"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f"},warning:{main:"#ff9800",light:"#ffb74d",dark:"#f57c00"},info:{main:"#2196f3",light:"#64b5f6",dark:"#1976d2"}};let Ob=d0({palette:KF,typography:{fontFamily:"var(--font-geist-sans)",h1:{fontWeight:700},h2:{fontWeight:700},h3:{fontWeight:600},h4:{fontWeight:600},h5:{fontWeight:600},h6:{fontWeight:600},subtitle1:{fontWeight:500},subtitle2:{fontWeight:500}},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",fontWeight:600,borderRadius:8,boxShadow:"none","&:hover":{boxShadow:"0px 3px 6px rgba(0, 0, 0, 0.1)"}},contained:{padding:"8px 24px"},outlined:{padding:"8px 24px"}}},MuiCard:{styleOverrides:{root:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)",borderRadius:12}}},MuiCardContent:{styleOverrides:{root:{padding:24,"&:last-child":{paddingBottom:24}}}},MuiPaper:{styleOverrides:{root:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)",borderRadius:12},elevation1:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)"}}},MuiDrawer:{styleOverrides:{paper:{borderTopLeftRadius:16,borderTopRightRadius:16}}},MuiBackdrop:{styleOverrides:{root:{backgroundColor:"rgba(0, 0, 0, 0.6)"}}},MuiIconButton:{styleOverrides:{root:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}}},MuiDivider:{styleOverrides:{root:{margin:"16px 0"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8}}}}}});Ob=B7(Ob);const VF=Ob;XE.createRoot(document.getElementById("root")).render(it.jsx(et.StrictMode,{children:it.jsx(q7,{theme:VF,children:it.jsxs(RF,{children:[it.jsx(RM,{}),it.jsx(HF,{})]})})}));
