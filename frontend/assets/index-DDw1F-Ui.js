var l5=Object.defineProperty;var d5=(i,e,n)=>e in i?l5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var te=(i,e,n)=>d5(i,typeof e!="symbol"?e+"":e,n);function f5(i,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const t in r)if(t!=="default"&&!(t in i)){const s=Object.getOwnPropertyDescriptor(r,t);s&&Object.defineProperty(i,t,s.get?s:{enumerable:!0,get:()=>r[t]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();function F8(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function U8(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var t=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,t.get?t:{enumerable:!0,get:function(){return i[r]}})}),n}var Yg={exports:{}},wl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m_;function h5(){if(m_)return wl;m_=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,t,s){var a=null;if(s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),"key"in t){s={};for(var c in t)c!=="key"&&(s[c]=t[c])}else s=t;return t=s.ref,{$$typeof:i,type:r,key:a,ref:t!==void 0?t:null,props:s}}return wl.Fragment=e,wl.jsx=n,wl.jsxs=n,wl}var w_;function p5(){return w_||(w_=1,Yg.exports=h5()),Yg.exports}var J=p5(),Qg={exports:{}},Qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v_;function y5(){if(v_)return Qe;v_=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),t=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function m(U){return U===null||typeof U!="object"?null:(U=f&&U[f]||U["@@iterator"],typeof U=="function"?U:null)}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function g(U,z,G){this.props=U,this.context=z,this.refs=b,this.updater=G||d}g.prototype.isReactComponent={},g.prototype.setState=function(U,z){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,z,"setState")},g.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function v(){}v.prototype=g.prototype;function _(U,z,G){this.props=U,this.context=z,this.refs=b,this.updater=G||d}var S=_.prototype=new v;S.constructor=_,y(S,g.prototype),S.isPureReactComponent=!0;var I=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function E(U,z,G,ne,ce,Se){return G=Se.ref,{$$typeof:i,type:U,key:z,ref:G!==void 0?G:null,props:Se}}function k(U,z){return E(U.type,z,void 0,void 0,void 0,U.props)}function P(U){return typeof U=="object"&&U!==null&&U.$$typeof===i}function T(U){var z={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(G){return z[G]})}var M=/\/+/g;function C(U,z){return typeof U=="object"&&U!==null&&U.key!=null?T(""+U.key):z.toString(36)}function D(){}function F(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(D,D):(U.status="pending",U.then(function(z){U.status==="pending"&&(U.status="fulfilled",U.value=z)},function(z){U.status==="pending"&&(U.status="rejected",U.reason=z)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function B(U,z,G,ne,ce){var Se=typeof U;(Se==="undefined"||Se==="boolean")&&(U=null);var Ie=!1;if(U===null)Ie=!0;else switch(Se){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(U.$$typeof){case i:case e:Ie=!0;break;case h:return Ie=U._init,B(Ie(U._payload),z,G,ne,ce)}}if(Ie)return ce=ce(U),Ie=ne===""?"."+C(U,0):ne,I(ce)?(G="",Ie!=null&&(G=Ie.replace(M,"$&/")+"/"),B(ce,z,G,"",function(ke){return ke})):ce!=null&&(P(ce)&&(ce=k(ce,G+(ce.key==null||U&&U.key===ce.key?"":(""+ce.key).replace(M,"$&/")+"/")+Ie)),z.push(ce)),1;Ie=0;var me=ne===""?".":ne+":";if(I(U))for(var xe=0;xe<U.length;xe++)ne=U[xe],Se=me+C(ne,xe),Ie+=B(ne,z,G,Se,ce);else if(xe=m(U),typeof xe=="function")for(U=xe.call(U),xe=0;!(ne=U.next()).done;)ne=ne.value,Se=me+C(ne,xe++),Ie+=B(ne,z,G,Se,ce);else if(Se==="object"){if(typeof U.then=="function")return B(F(U),z,G,ne,ce);throw z=String(U),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function L(U,z,G){if(U==null)return U;var ne=[],ce=0;return B(U,ne,"","",function(Se){return z.call(G,Se,ce++)}),ne}function q(U){if(U._status===-1){var z=U._result;z=z(),z.then(function(G){(U._status===0||U._status===-1)&&(U._status=1,U._result=G)},function(G){(U._status===0||U._status===-1)&&(U._status=2,U._result=G)}),U._status===-1&&(U._status=0,U._result=z)}if(U._status===1)return U._result.default;throw U._result}var K=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function $(){}return Qe.Children={map:L,forEach:function(U,z,G){L(U,function(){z.apply(this,arguments)},G)},count:function(U){var z=0;return L(U,function(){z++}),z},toArray:function(U){return L(U,function(z){return z})||[]},only:function(U){if(!P(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Qe.Component=g,Qe.Fragment=n,Qe.Profiler=t,Qe.PureComponent=_,Qe.StrictMode=r,Qe.Suspense=u,Qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Qe.__COMPILER_RUNTIME={__proto__:null,c:function(U){return A.H.useMemoCache(U)}},Qe.cache=function(U){return function(){return U.apply(null,arguments)}},Qe.cloneElement=function(U,z,G){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var ne=y({},U.props),ce=U.key,Se=void 0;if(z!=null)for(Ie in z.ref!==void 0&&(Se=void 0),z.key!==void 0&&(ce=""+z.key),z)!R.call(z,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&z.ref===void 0||(ne[Ie]=z[Ie]);var Ie=arguments.length-2;if(Ie===1)ne.children=G;else if(1<Ie){for(var me=Array(Ie),xe=0;xe<Ie;xe++)me[xe]=arguments[xe+2];ne.children=me}return E(U.type,ce,void 0,void 0,Se,ne)},Qe.createContext=function(U){return U={$$typeof:a,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:s,_context:U},U},Qe.createElement=function(U,z,G){var ne,ce={},Se=null;if(z!=null)for(ne in z.key!==void 0&&(Se=""+z.key),z)R.call(z,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ce[ne]=z[ne]);var Ie=arguments.length-2;if(Ie===1)ce.children=G;else if(1<Ie){for(var me=Array(Ie),xe=0;xe<Ie;xe++)me[xe]=arguments[xe+2];ce.children=me}if(U&&U.defaultProps)for(ne in Ie=U.defaultProps,Ie)ce[ne]===void 0&&(ce[ne]=Ie[ne]);return E(U,Se,void 0,void 0,null,ce)},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(U){return{$$typeof:c,render:U}},Qe.isValidElement=P,Qe.lazy=function(U){return{$$typeof:h,_payload:{_status:-1,_result:U},_init:q}},Qe.memo=function(U,z){return{$$typeof:l,type:U,compare:z===void 0?null:z}},Qe.startTransition=function(U){var z=A.T,G={};A.T=G;try{var ne=U(),ce=A.S;ce!==null&&ce(G,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then($,K)}catch(Se){K(Se)}finally{A.T=z}},Qe.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Qe.use=function(U){return A.H.use(U)},Qe.useActionState=function(U,z,G){return A.H.useActionState(U,z,G)},Qe.useCallback=function(U,z){return A.H.useCallback(U,z)},Qe.useContext=function(U){return A.H.useContext(U)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(U,z){return A.H.useDeferredValue(U,z)},Qe.useEffect=function(U,z,G){var ne=A.H;if(typeof G=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(U,z)},Qe.useId=function(){return A.H.useId()},Qe.useImperativeHandle=function(U,z,G){return A.H.useImperativeHandle(U,z,G)},Qe.useInsertionEffect=function(U,z){return A.H.useInsertionEffect(U,z)},Qe.useLayoutEffect=function(U,z){return A.H.useLayoutEffect(U,z)},Qe.useMemo=function(U,z){return A.H.useMemo(U,z)},Qe.useOptimistic=function(U,z){return A.H.useOptimistic(U,z)},Qe.useReducer=function(U,z,G){return A.H.useReducer(U,z,G)},Qe.useRef=function(U){return A.H.useRef(U)},Qe.useState=function(U){return A.H.useState(U)},Qe.useSyncExternalStore=function(U,z,G){return A.H.useSyncExternalStore(U,z,G)},Qe.useTransition=function(){return A.H.useTransition()},Qe.version="19.1.0",Qe}var x_;function Fm(){return x_||(x_=1,Qg.exports=y5()),Qg.exports}var Z=Fm();const Nr=F8(Z),Jb=f5({__proto__:null,default:Nr},[Z]);var Zg={exports:{}},vl={},Jg={exports:{}},eb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __;function g5(){return __||(__=1,function(i){function e(L,q){var K=L.length;L.push(q);e:for(;0<K;){var $=K-1>>>1,U=L[$];if(0<t(U,q))L[$]=q,L[K]=U,K=$;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var q=L[0],K=L.pop();if(K!==q){L[0]=K;e:for(var $=0,U=L.length,z=U>>>1;$<z;){var G=2*($+1)-1,ne=L[G],ce=G+1,Se=L[ce];if(0>t(ne,K))ce<U&&0>t(Se,ne)?(L[$]=Se,L[ce]=K,$=ce):(L[$]=ne,L[G]=K,$=G);else if(ce<U&&0>t(Se,K))L[$]=Se,L[ce]=K,$=ce;else break e}}return q}function t(L,q){var K=L.sortIndex-q.sortIndex;return K!==0?K:L.id-q.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();i.unstable_now=function(){return a.now()-c}}var u=[],l=[],h=1,f=null,m=3,d=!1,y=!1,b=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function I(L){for(var q=n(l);q!==null;){if(q.callback===null)r(l);else if(q.startTime<=L)r(l),q.sortIndex=q.expirationTime,e(u,q);else break;q=n(l)}}function A(L){if(b=!1,I(L),!y)if(n(u)!==null)y=!0,R||(R=!0,C());else{var q=n(l);q!==null&&B(A,q.startTime-L)}}var R=!1,E=-1,k=5,P=-1;function T(){return g?!0:!(i.unstable_now()-P<k)}function M(){if(g=!1,R){var L=i.unstable_now();P=L;var q=!0;try{e:{y=!1,b&&(b=!1,_(E),E=-1),d=!0;var K=m;try{t:{for(I(L),f=n(u);f!==null&&!(f.expirationTime>L&&T());){var $=f.callback;if(typeof $=="function"){f.callback=null,m=f.priorityLevel;var U=$(f.expirationTime<=L);if(L=i.unstable_now(),typeof U=="function"){f.callback=U,I(L),q=!0;break t}f===n(u)&&r(u),I(L)}else r(u);f=n(u)}if(f!==null)q=!0;else{var z=n(l);z!==null&&B(A,z.startTime-L),q=!1}}break e}finally{f=null,m=K,d=!1}q=void 0}}finally{q?C():R=!1}}}var C;if(typeof S=="function")C=function(){S(M)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=M,C=function(){F.postMessage(null)}}else C=function(){v(M,0)};function B(L,q){E=v(function(){L(i.unstable_now())},q)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(L){L.callback=null},i.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<L?Math.floor(1e3/L):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_next=function(L){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var K=m;m=q;try{return L()}finally{m=K}},i.unstable_requestPaint=function(){g=!0},i.unstable_runWithPriority=function(L,q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var K=m;m=L;try{return q()}finally{m=K}},i.unstable_scheduleCallback=function(L,q,K){var $=i.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?$+K:$):K=$,L){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=K+U,L={id:h++,callback:q,priorityLevel:L,startTime:K,expirationTime:U,sortIndex:-1},K>$?(L.sortIndex=K,e(l,L),n(u)===null&&L===n(l)&&(b?(_(E),E=-1):b=!0,B(A,K-$))):(L.sortIndex=U,e(u,L),y||d||(y=!0,R||(R=!0,C()))),L},i.unstable_shouldYield=T,i.unstable_wrapCallback=function(L){var q=m;return function(){var K=m;m=q;try{return L.apply(this,arguments)}finally{m=K}}}}(eb)),eb}var S_;function b5(){return S_||(S_=1,Jg.exports=g5()),Jg.exports}var tb={exports:{}},Bn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function m5(){if(I_)return Bn;I_=1;var i=Fm();function e(u){var l="https://react.dev/errors/"+u;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},t=Symbol.for("react.portal");function s(u,l,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:t,key:f==null?null:""+f,children:u,containerInfo:l,implementation:h}}var a=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,l){if(u==="font")return"";if(typeof l=="string")return l==="use-credentials"?l:""}return Bn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Bn.createPortal=function(u,l){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)throw Error(e(299));return s(u,l,null,h)},Bn.flushSync=function(u){var l=a.T,h=r.p;try{if(a.T=null,r.p=2,u)return u()}finally{a.T=l,r.p=h,r.d.f()}},Bn.preconnect=function(u,l){typeof u=="string"&&(l?(l=l.crossOrigin,l=typeof l=="string"?l==="use-credentials"?l:"":void 0):l=null,r.d.C(u,l))},Bn.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Bn.preinit=function(u,l){if(typeof u=="string"&&l&&typeof l.as=="string"){var h=l.as,f=c(h,l.crossOrigin),m=typeof l.integrity=="string"?l.integrity:void 0,d=typeof l.fetchPriority=="string"?l.fetchPriority:void 0;h==="style"?r.d.S(u,typeof l.precedence=="string"?l.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:d}):h==="script"&&r.d.X(u,{crossOrigin:f,integrity:m,fetchPriority:d,nonce:typeof l.nonce=="string"?l.nonce:void 0})}},Bn.preinitModule=function(u,l){if(typeof u=="string")if(typeof l=="object"&&l!==null){if(l.as==null||l.as==="script"){var h=c(l.as,l.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof l.integrity=="string"?l.integrity:void 0,nonce:typeof l.nonce=="string"?l.nonce:void 0})}}else l==null&&r.d.M(u)},Bn.preload=function(u,l){if(typeof u=="string"&&typeof l=="object"&&l!==null&&typeof l.as=="string"){var h=l.as,f=c(h,l.crossOrigin);r.d.L(u,h,{crossOrigin:f,integrity:typeof l.integrity=="string"?l.integrity:void 0,nonce:typeof l.nonce=="string"?l.nonce:void 0,type:typeof l.type=="string"?l.type:void 0,fetchPriority:typeof l.fetchPriority=="string"?l.fetchPriority:void 0,referrerPolicy:typeof l.referrerPolicy=="string"?l.referrerPolicy:void 0,imageSrcSet:typeof l.imageSrcSet=="string"?l.imageSrcSet:void 0,imageSizes:typeof l.imageSizes=="string"?l.imageSizes:void 0,media:typeof l.media=="string"?l.media:void 0})}},Bn.preloadModule=function(u,l){if(typeof u=="string")if(l){var h=c(l.as,l.crossOrigin);r.d.m(u,{as:typeof l.as=="string"&&l.as!=="script"?l.as:void 0,crossOrigin:h,integrity:typeof l.integrity=="string"?l.integrity:void 0})}else r.d.m(u)},Bn.requestFormReset=function(u){r.d.r(u)},Bn.unstable_batchedUpdates=function(u,l){return u(l)},Bn.useFormState=function(u,l,h){return a.H.useFormState(u,l,h)},Bn.useFormStatus=function(){return a.H.useHostTransitionStatus()},Bn.version="19.1.0",Bn}var T_;function H8(){if(T_)return tb.exports;T_=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),tb.exports=m5(),tb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k_;function w5(){if(k_)return vl;k_=1;var i=b5(),e=Fm(),n=H8();function r(o){var p="https://react.dev/errors/"+o;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)p+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+o+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var p=o,w=o;if(o.alternate)for(;p.return;)p=p.return;else{o=p;do p=o,(p.flags&4098)!==0&&(w=p.return),o=p.return;while(o)}return p.tag===3?w:null}function a(o){if(o.tag===13){var p=o.memoizedState;if(p===null&&(o=o.alternate,o!==null&&(p=o.memoizedState)),p!==null)return p.dehydrated}return null}function c(o){if(s(o)!==o)throw Error(r(188))}function u(o){var p=o.alternate;if(!p){if(p=s(o),p===null)throw Error(r(188));return p!==o?null:o}for(var w=o,x=p;;){var O=w.return;if(O===null)break;var N=O.alternate;if(N===null){if(x=O.return,x!==null){w=x;continue}break}if(O.child===N.child){for(N=O.child;N;){if(N===w)return c(O),o;if(N===x)return c(O),p;N=N.sibling}throw Error(r(188))}if(w.return!==x.return)w=O,x=N;else{for(var H=!1,V=O.child;V;){if(V===w){H=!0,w=O,x=N;break}if(V===x){H=!0,x=O,w=N;break}V=V.sibling}if(!H){for(V=N.child;V;){if(V===w){H=!0,w=N,x=O;break}if(V===x){H=!0,x=N,w=O;break}V=V.sibling}if(!H)throw Error(r(189))}}if(w.alternate!==x)throw Error(r(190))}if(w.tag!==3)throw Error(r(188));return w.stateNode.current===w?o:p}function l(o){var p=o.tag;if(p===5||p===26||p===27||p===6)return o;for(o=o.child;o!==null;){if(p=l(o),p!==null)return p;o=o.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),S=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),T=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function C(o){return o===null||typeof o!="object"?null:(o=M&&o[M]||o["@@iterator"],typeof o=="function"?o:null)}var D=Symbol.for("react.client.reference");function F(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===D?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case y:return"Fragment";case g:return"Profiler";case b:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList";case P:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case d:return"Portal";case S:return(o.displayName||"Context")+".Provider";case _:return(o._context.displayName||"Context")+".Consumer";case I:var p=o.render;return o=o.displayName,o||(o=p.displayName||p.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case E:return p=o.displayName||null,p!==null?p:F(o.type)||"Memo";case k:p=o._payload,o=o._init;try{return F(o(p))}catch{}}return null}var B=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},$=[],U=-1;function z(o){return{current:o}}function G(o){0>U||(o.current=$[U],$[U]=null,U--)}function ne(o,p){U++,$[U]=o.current,o.current=p}var ce=z(null),Se=z(null),Ie=z(null),me=z(null);function xe(o,p){switch(ne(Ie,p),ne(Se,o),ne(ce,null),p.nodeType){case 9:case 11:o=(o=p.documentElement)&&(o=o.namespaceURI)?$x(o):0;break;default:if(o=p.tagName,p=p.namespaceURI)p=$x(p),o=zx(p,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}G(ce),ne(ce,o)}function ke(){G(ce),G(Se),G(Ie)}function Re(o){o.memoizedState!==null&&ne(me,o);var p=ce.current,w=zx(p,o.type);p!==w&&(ne(Se,o),ne(ce,w))}function Ce(o){Se.current===o&&(G(ce),G(Se)),me.current===o&&(G(me),pl._currentValue=K)}var Ne=Object.prototype.hasOwnProperty,We=i.unstable_scheduleCallback,dt=i.unstable_cancelCallback,Ut=i.unstable_shouldYield,Ht=i.unstable_requestPaint,Je=i.unstable_now,At=i.unstable_getCurrentPriorityLevel,Te=i.unstable_ImmediatePriority,j=i.unstable_UserBlockingPriority,he=i.unstable_NormalPriority,de=i.unstable_LowPriority,Me=i.unstable_IdlePriority,ct=i.log,Hn=i.unstable_setDisableYieldValue,wn=null,Dt=null;function vn(o){if(typeof ct=="function"&&Hn(o),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(wn,o)}catch{}}var qt=Math.clz32?Math.clz32:An,Wt=Math.log,rt=Math.LN2;function An(o){return o>>>=0,o===0?32:31-(Wt(o)/rt|0)|0}var Lt=256,Y=4194304;function X(o){var p=o&42;if(p!==0)return p;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function re(o,p,w){var x=o.pendingLanes;if(x===0)return 0;var O=0,N=o.suspendedLanes,H=o.pingedLanes;o=o.warmLanes;var V=x&134217727;return V!==0?(x=V&~N,x!==0?O=X(x):(H&=V,H!==0?O=X(H):w||(w=V&~o,w!==0&&(O=X(w))))):(V=x&~N,V!==0?O=X(V):H!==0?O=X(H):w||(w=x&~o,w!==0&&(O=X(w)))),O===0?0:p!==0&&p!==O&&(p&N)===0&&(N=O&-O,w=p&-p,N>=w||N===32&&(w&4194048)!==0)?p:O}function le(o,p){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&p)===0}function se(o,p){switch(o){case 1:case 2:case 4:case 8:case 64:return p+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ye(){var o=Lt;return Lt<<=1,(Lt&4194048)===0&&(Lt=256),o}function Oe(){var o=Y;return Y<<=1,(Y&62914560)===0&&(Y=4194304),o}function Fe(o){for(var p=[],w=0;31>w;w++)p.push(o);return p}function Ve(o,p){o.pendingLanes|=p,p!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function $e(o,p,w,x,O,N){var H=o.pendingLanes;o.pendingLanes=w,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=w,o.entangledLanes&=w,o.errorRecoveryDisabledLanes&=w,o.shellSuspendCounter=0;var V=o.entanglements,Q=o.expirationTimes,ue=o.hiddenUpdates;for(w=H&~w;0<w;){var be=31-qt(w),ve=1<<be;V[be]=0,Q[be]=-1;var fe=ue[be];if(fe!==null)for(ue[be]=null,be=0;be<fe.length;be++){var pe=fe[be];pe!==null&&(pe.lane&=-536870913)}w&=~ve}x!==0&&et(o,x,0),N!==0&&O===0&&o.tag!==0&&(o.suspendedLanes|=N&~(H&~p))}function et(o,p,w){o.pendingLanes|=p,o.suspendedLanes&=~p;var x=31-qt(p);o.entangledLanes|=p,o.entanglements[x]=o.entanglements[x]|1073741824|w&4194090}function ze(o,p){var w=o.entangledLanes|=p;for(o=o.entanglements;w;){var x=31-qt(w),O=1<<x;O&p|o[x]&p&&(o[x]|=p),w&=~O}}function mt(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Ae(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function nt(){var o=q.p;return o!==0?o:(o=window.event,o===void 0?32:f_(o.type))}function gr(o,p){var w=q.p;try{return q.p=o,p()}finally{q.p=w}}var qn=Math.random().toString(36).slice(2),Zt="__reactFiber$"+qn,xn="__reactProps$"+qn,br="__reactContainer$"+qn,mr="__reactEvents$"+qn,ws="__reactListeners$"+qn,vs="__reactHandles$"+qn,Ba="__reactResources$"+qn,zi="__reactMarker$"+qn;function Po(o){delete o[Zt],delete o[xn],delete o[mr],delete o[ws],delete o[vs]}function Vr(o){var p=o[Zt];if(p)return p;for(var w=o.parentNode;w;){if(p=w[br]||w[Zt]){if(w=p.alternate,p.child!==null||w!==null&&w.child!==null)for(o=Qx(o);o!==null;){if(w=o[Zt])return w;o=Qx(o)}return p}o=w,w=o.parentNode}return null}function Kr(o){if(o=o[Zt]||o[br]){var p=o.tag;if(p===5||p===6||p===13||p===26||p===27||p===3)return o}return null}function Da(o){var p=o.tag;if(p===5||p===26||p===27||p===6)return o.stateNode;throw Error(r(33))}function Wr(o){var p=o[Ba];return p||(p=o[Ba]={hoistableStyles:new Map,hoistableScripts:new Map}),p}function Jt(o){o[zi]=!0}var xs=new Set,_s={};function wr(o,p){$r(o,p),$r(o+"Capture",p)}function $r(o,p){for(_s[o]=p,o=0;o<p.length;o++)xs.add(p[o])}var nE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lw={},Fw={};function iE(o){return Ne.call(Fw,o)?!0:Ne.call(Lw,o)?!1:nE.test(o)?Fw[o]=!0:(Lw[o]=!0,!1)}function Mf(o,p,w){if(iE(p))if(w===null)o.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":o.removeAttribute(p);return;case"boolean":var x=p.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){o.removeAttribute(p);return}}o.setAttribute(p,""+w)}}function Bf(o,p,w){if(w===null)o.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(p);return}o.setAttribute(p,""+w)}}function zr(o,p,w,x){if(x===null)o.removeAttribute(w);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(w);return}o.setAttributeNS(p,w,""+x)}}var K0,Uw;function Ro(o){if(K0===void 0)try{throw Error()}catch(w){var p=w.stack.trim().match(/\n( *(at )?)/);K0=p&&p[1]||"",Uw=-1<w.stack.indexOf(`
    at`)?" (<anonymous>)":-1<w.stack.indexOf("@")?"@unknown:0:0":""}return`
`+K0+o+Uw}var W0=!1;function $0(o,p){if(!o||W0)return"";W0=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(p){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(pe){var fe=pe}Reflect.construct(o,[],ve)}else{try{ve.call()}catch(pe){fe=pe}o.call(ve.prototype)}}else{try{throw Error()}catch(pe){fe=pe}(ve=o())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(pe){if(pe&&fe&&typeof pe.stack=="string")return[pe.stack,fe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=x.DetermineComponentFrameRoot(),H=N[0],V=N[1];if(H&&V){var Q=H.split(`
`),ue=V.split(`
`);for(O=x=0;x<Q.length&&!Q[x].includes("DetermineComponentFrameRoot");)x++;for(;O<ue.length&&!ue[O].includes("DetermineComponentFrameRoot");)O++;if(x===Q.length||O===ue.length)for(x=Q.length-1,O=ue.length-1;1<=x&&0<=O&&Q[x]!==ue[O];)O--;for(;1<=x&&0<=O;x--,O--)if(Q[x]!==ue[O]){if(x!==1||O!==1)do if(x--,O--,0>O||Q[x]!==ue[O]){var be=`
`+Q[x].replace(" at new "," at ");return o.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",o.displayName)),be}while(1<=x&&0<=O);break}}}finally{W0=!1,Error.prepareStackTrace=w}return(w=o?o.displayName||o.name:"")?Ro(w):""}function rE(o){switch(o.tag){case 26:case 27:case 5:return Ro(o.type);case 16:return Ro("Lazy");case 13:return Ro("Suspense");case 19:return Ro("SuspenseList");case 0:case 15:return $0(o.type,!1);case 11:return $0(o.type.render,!1);case 1:return $0(o.type,!0);case 31:return Ro("Activity");default:return""}}function Hw(o){try{var p="";do p+=rE(o),o=o.return;while(o);return p}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}function gi(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function qw(o){var p=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function aE(o){var p=qw(o)?"checked":"value",w=Object.getOwnPropertyDescriptor(o.constructor.prototype,p),x=""+o[p];if(!o.hasOwnProperty(p)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var O=w.get,N=w.set;return Object.defineProperty(o,p,{configurable:!0,get:function(){return O.call(this)},set:function(H){x=""+H,N.call(this,H)}}),Object.defineProperty(o,p,{enumerable:w.enumerable}),{getValue:function(){return x},setValue:function(H){x=""+H},stopTracking:function(){o._valueTracker=null,delete o[p]}}}}function Df(o){o._valueTracker||(o._valueTracker=aE(o))}function jw(o){if(!o)return!1;var p=o._valueTracker;if(!p)return!0;var w=p.getValue(),x="";return o&&(x=qw(o)?o.checked?"true":"false":o.value),o=x,o!==w?(p.setValue(o),!0):!1}function Lf(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var sE=/[\n"\\]/g;function bi(o){return o.replace(sE,function(p){return"\\"+p.charCodeAt(0).toString(16)+" "})}function z0(o,p,w,x,O,N,H,V){o.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?o.type=H:o.removeAttribute("type"),p!=null?H==="number"?(p===0&&o.value===""||o.value!=p)&&(o.value=""+gi(p)):o.value!==""+gi(p)&&(o.value=""+gi(p)):H!=="submit"&&H!=="reset"||o.removeAttribute("value"),p!=null?G0(o,H,gi(p)):w!=null?G0(o,H,gi(w)):x!=null&&o.removeAttribute("value"),O==null&&N!=null&&(o.defaultChecked=!!N),O!=null&&(o.checked=O&&typeof O!="function"&&typeof O!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?o.name=""+gi(V):o.removeAttribute("name")}function Vw(o,p,w,x,O,N,H,V){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(o.type=N),p!=null||w!=null){if(!(N!=="submit"&&N!=="reset"||p!=null))return;w=w!=null?""+gi(w):"",p=p!=null?""+gi(p):w,V||p===o.value||(o.value=p),o.defaultValue=p}x=x??O,x=typeof x!="function"&&typeof x!="symbol"&&!!x,o.checked=V?o.checked:!!x,o.defaultChecked=!!x,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(o.name=H)}function G0(o,p,w){p==="number"&&Lf(o.ownerDocument)===o||o.defaultValue===""+w||(o.defaultValue=""+w)}function No(o,p,w,x){if(o=o.options,p){p={};for(var O=0;O<w.length;O++)p["$"+w[O]]=!0;for(w=0;w<o.length;w++)O=p.hasOwnProperty("$"+o[w].value),o[w].selected!==O&&(o[w].selected=O),O&&x&&(o[w].defaultSelected=!0)}else{for(w=""+gi(w),p=null,O=0;O<o.length;O++){if(o[O].value===w){o[O].selected=!0,x&&(o[O].defaultSelected=!0);return}p!==null||o[O].disabled||(p=o[O])}p!==null&&(p.selected=!0)}}function Kw(o,p,w){if(p!=null&&(p=""+gi(p),p!==o.value&&(o.value=p),w==null)){o.defaultValue!==p&&(o.defaultValue=p);return}o.defaultValue=w!=null?""+gi(w):""}function Ww(o,p,w,x){if(p==null){if(x!=null){if(w!=null)throw Error(r(92));if(B(x)){if(1<x.length)throw Error(r(93));x=x[0]}w=x}w==null&&(w=""),p=w}w=gi(p),o.defaultValue=w,x=o.textContent,x===w&&x!==""&&x!==null&&(o.value=x)}function Co(o,p){if(p){var w=o.firstChild;if(w&&w===o.lastChild&&w.nodeType===3){w.nodeValue=p;return}}o.textContent=p}var oE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $w(o,p,w){var x=p.indexOf("--")===0;w==null||typeof w=="boolean"||w===""?x?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="":x?o.setProperty(p,w):typeof w!="number"||w===0||oE.has(p)?p==="float"?o.cssFloat=w:o[p]=(""+w).trim():o[p]=w+"px"}function zw(o,p,w){if(p!=null&&typeof p!="object")throw Error(r(62));if(o=o.style,w!=null){for(var x in w)!w.hasOwnProperty(x)||p!=null&&p.hasOwnProperty(x)||(x.indexOf("--")===0?o.setProperty(x,""):x==="float"?o.cssFloat="":o[x]="");for(var O in p)x=p[O],p.hasOwnProperty(O)&&w[O]!==x&&$w(o,O,x)}else for(var N in p)p.hasOwnProperty(N)&&$w(o,N,p[N])}function X0(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),uE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ff(o){return uE.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Y0=null;function Q0(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Mo=null,Bo=null;function Gw(o){var p=Kr(o);if(p&&(o=p.stateNode)){var w=o[xn]||null;e:switch(o=p.stateNode,p.type){case"input":if(z0(o,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name),p=w.name,w.type==="radio"&&p!=null){for(w=o;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll('input[name="'+bi(""+p)+'"][type="radio"]'),p=0;p<w.length;p++){var x=w[p];if(x!==o&&x.form===o.form){var O=x[xn]||null;if(!O)throw Error(r(90));z0(x,O.value,O.defaultValue,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name)}}for(p=0;p<w.length;p++)x=w[p],x.form===o.form&&jw(x)}break e;case"textarea":Kw(o,w.value,w.defaultValue);break e;case"select":p=w.value,p!=null&&No(o,!!w.multiple,p,!1)}}}var Z0=!1;function Xw(o,p,w){if(Z0)return o(p,w);Z0=!0;try{var x=o(p);return x}finally{if(Z0=!1,(Mo!==null||Bo!==null)&&(Sh(),Mo&&(p=Mo,o=Bo,Bo=Mo=null,Gw(p),o)))for(p=0;p<o.length;p++)Gw(o[p])}}function Eu(o,p){var w=o.stateNode;if(w===null)return null;var x=w[xn]||null;if(x===null)return null;w=x[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(o=o.type,x=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!x;break e;default:o=!1}if(o)return null;if(w&&typeof w!="function")throw Error(r(231,p,typeof w));return w}var Gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J0=!1;if(Gr)try{var Ou={};Object.defineProperty(Ou,"passive",{get:function(){J0=!0}}),window.addEventListener("test",Ou,Ou),window.removeEventListener("test",Ou,Ou)}catch{J0=!1}var La=null,ey=null,Uf=null;function Yw(){if(Uf)return Uf;var o,p=ey,w=p.length,x,O="value"in La?La.value:La.textContent,N=O.length;for(o=0;o<w&&p[o]===O[o];o++);var H=w-o;for(x=1;x<=H&&p[w-x]===O[N-x];x++);return Uf=O.slice(o,1<x?1-x:void 0)}function Hf(o){var p=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&p===13&&(o=13)):o=p,o===10&&(o=13),32<=o||o===13?o:0}function qf(){return!0}function Qw(){return!1}function jn(o){function p(w,x,O,N,H){this._reactName=w,this._targetInst=O,this.type=x,this.nativeEvent=N,this.target=H,this.currentTarget=null;for(var V in o)o.hasOwnProperty(V)&&(w=o[V],this[V]=w?w(N):N[V]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?qf:Qw,this.isPropagationStopped=Qw,this}return h(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=qf)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=qf)},persist:function(){},isPersistent:qf}),p}var Ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jf=jn(Ss),Au=h({},Ss,{view:0,detail:0}),lE=jn(Au),ty,ny,Pu,Vf=h({},Au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ry,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Pu&&(Pu&&o.type==="mousemove"?(ty=o.screenX-Pu.screenX,ny=o.screenY-Pu.screenY):ny=ty=0,Pu=o),ty)},movementY:function(o){return"movementY"in o?o.movementY:ny}}),Zw=jn(Vf),dE=h({},Vf,{dataTransfer:0}),fE=jn(dE),hE=h({},Au,{relatedTarget:0}),iy=jn(hE),pE=h({},Ss,{animationName:0,elapsedTime:0,pseudoElement:0}),yE=jn(pE),gE=h({},Ss,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),bE=jn(gE),mE=h({},Ss,{data:0}),Jw=jn(mE),wE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _E(o){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(o):(o=xE[o])?!!p[o]:!1}function ry(){return _E}var SE=h({},Au,{key:function(o){if(o.key){var p=wE[o.key]||o.key;if(p!=="Unidentified")return p}return o.type==="keypress"?(o=Hf(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?vE[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ry,charCode:function(o){return o.type==="keypress"?Hf(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Hf(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),IE=jn(SE),TE=h({},Vf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ev=jn(TE),kE=h({},Au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ry}),EE=jn(kE),OE=h({},Ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),AE=jn(OE),PE=h({},Vf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),RE=jn(PE),NE=h({},Ss,{newState:0,oldState:0}),CE=jn(NE),ME=[9,13,27,32],ay=Gr&&"CompositionEvent"in window,Ru=null;Gr&&"documentMode"in document&&(Ru=document.documentMode);var BE=Gr&&"TextEvent"in window&&!Ru,tv=Gr&&(!ay||Ru&&8<Ru&&11>=Ru),nv=" ",iv=!1;function rv(o,p){switch(o){case"keyup":return ME.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function av(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Do=!1;function DE(o,p){switch(o){case"compositionend":return av(p);case"keypress":return p.which!==32?null:(iv=!0,nv);case"textInput":return o=p.data,o===nv&&iv?null:o;default:return null}}function LE(o,p){if(Do)return o==="compositionend"||!ay&&rv(o,p)?(o=Yw(),Uf=ey=La=null,Do=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return tv&&p.locale!=="ko"?null:p.data;default:return null}}var FE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sv(o){var p=o&&o.nodeName&&o.nodeName.toLowerCase();return p==="input"?!!FE[o.type]:p==="textarea"}function ov(o,p,w,x){Mo?Bo?Bo.push(x):Bo=[x]:Mo=x,p=Ah(p,"onChange"),0<p.length&&(w=new jf("onChange","change",null,w,x),o.push({event:w,listeners:p}))}var Nu=null,Cu=null;function UE(o){qx(o,0)}function Kf(o){var p=Da(o);if(jw(p))return o}function cv(o,p){if(o==="change")return p}var uv=!1;if(Gr){var sy;if(Gr){var oy="oninput"in document;if(!oy){var lv=document.createElement("div");lv.setAttribute("oninput","return;"),oy=typeof lv.oninput=="function"}sy=oy}else sy=!1;uv=sy&&(!document.documentMode||9<document.documentMode)}function dv(){Nu&&(Nu.detachEvent("onpropertychange",fv),Cu=Nu=null)}function fv(o){if(o.propertyName==="value"&&Kf(Cu)){var p=[];ov(p,Cu,o,Q0(o)),Xw(UE,p)}}function HE(o,p,w){o==="focusin"?(dv(),Nu=p,Cu=w,Nu.attachEvent("onpropertychange",fv)):o==="focusout"&&dv()}function qE(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Kf(Cu)}function jE(o,p){if(o==="click")return Kf(p)}function VE(o,p){if(o==="input"||o==="change")return Kf(p)}function KE(o,p){return o===p&&(o!==0||1/o===1/p)||o!==o&&p!==p}var ei=typeof Object.is=="function"?Object.is:KE;function Mu(o,p){if(ei(o,p))return!0;if(typeof o!="object"||o===null||typeof p!="object"||p===null)return!1;var w=Object.keys(o),x=Object.keys(p);if(w.length!==x.length)return!1;for(x=0;x<w.length;x++){var O=w[x];if(!Ne.call(p,O)||!ei(o[O],p[O]))return!1}return!0}function hv(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function pv(o,p){var w=hv(o);o=0;for(var x;w;){if(w.nodeType===3){if(x=o+w.textContent.length,o<=p&&x>=p)return{node:w,offset:p-o};o=x}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=hv(w)}}function yv(o,p){return o&&p?o===p?!0:o&&o.nodeType===3?!1:p&&p.nodeType===3?yv(o,p.parentNode):"contains"in o?o.contains(p):o.compareDocumentPosition?!!(o.compareDocumentPosition(p)&16):!1:!1}function gv(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var p=Lf(o.document);p instanceof o.HTMLIFrameElement;){try{var w=typeof p.contentWindow.location.href=="string"}catch{w=!1}if(w)o=p.contentWindow;else break;p=Lf(o.document)}return p}function cy(o){var p=o&&o.nodeName&&o.nodeName.toLowerCase();return p&&(p==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||p==="textarea"||o.contentEditable==="true")}var WE=Gr&&"documentMode"in document&&11>=document.documentMode,Lo=null,uy=null,Bu=null,ly=!1;function bv(o,p,w){var x=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;ly||Lo==null||Lo!==Lf(x)||(x=Lo,"selectionStart"in x&&cy(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Bu&&Mu(Bu,x)||(Bu=x,x=Ah(uy,"onSelect"),0<x.length&&(p=new jf("onSelect","select",null,p,w),o.push({event:p,listeners:x}),p.target=Lo)))}function Is(o,p){var w={};return w[o.toLowerCase()]=p.toLowerCase(),w["Webkit"+o]="webkit"+p,w["Moz"+o]="moz"+p,w}var Fo={animationend:Is("Animation","AnimationEnd"),animationiteration:Is("Animation","AnimationIteration"),animationstart:Is("Animation","AnimationStart"),transitionrun:Is("Transition","TransitionRun"),transitionstart:Is("Transition","TransitionStart"),transitioncancel:Is("Transition","TransitionCancel"),transitionend:Is("Transition","TransitionEnd")},dy={},mv={};Gr&&(mv=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function Ts(o){if(dy[o])return dy[o];if(!Fo[o])return o;var p=Fo[o],w;for(w in p)if(p.hasOwnProperty(w)&&w in mv)return dy[o]=p[w];return o}var wv=Ts("animationend"),vv=Ts("animationiteration"),xv=Ts("animationstart"),$E=Ts("transitionrun"),zE=Ts("transitionstart"),GE=Ts("transitioncancel"),_v=Ts("transitionend"),Sv=new Map,fy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fy.push("scrollEnd");function Gi(o,p){Sv.set(o,p),wr(p,[o])}var Iv=new WeakMap;function mi(o,p){if(typeof o=="object"&&o!==null){var w=Iv.get(o);return w!==void 0?w:(p={value:o,source:p,stack:Hw(p)},Iv.set(o,p),p)}return{value:o,source:p,stack:Hw(p)}}var wi=[],Uo=0,hy=0;function Wf(){for(var o=Uo,p=hy=Uo=0;p<o;){var w=wi[p];wi[p++]=null;var x=wi[p];wi[p++]=null;var O=wi[p];wi[p++]=null;var N=wi[p];if(wi[p++]=null,x!==null&&O!==null){var H=x.pending;H===null?O.next=O:(O.next=H.next,H.next=O),x.pending=O}N!==0&&Tv(w,O,N)}}function $f(o,p,w,x){wi[Uo++]=o,wi[Uo++]=p,wi[Uo++]=w,wi[Uo++]=x,hy|=x,o.lanes|=x,o=o.alternate,o!==null&&(o.lanes|=x)}function py(o,p,w,x){return $f(o,p,w,x),zf(o)}function Ho(o,p){return $f(o,null,null,p),zf(o)}function Tv(o,p,w){o.lanes|=w;var x=o.alternate;x!==null&&(x.lanes|=w);for(var O=!1,N=o.return;N!==null;)N.childLanes|=w,x=N.alternate,x!==null&&(x.childLanes|=w),N.tag===22&&(o=N.stateNode,o===null||o._visibility&1||(O=!0)),o=N,N=N.return;return o.tag===3?(N=o.stateNode,O&&p!==null&&(O=31-qt(w),o=N.hiddenUpdates,x=o[O],x===null?o[O]=[p]:x.push(p),p.lane=w|536870912),N):null}function zf(o){if(50<sl)throw sl=0,vg=null,Error(r(185));for(var p=o.return;p!==null;)o=p,p=o.return;return o.tag===3?o.stateNode:null}var qo={};function XE(o,p,w,x){this.tag=o,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(o,p,w,x){return new XE(o,p,w,x)}function yy(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Xr(o,p){var w=o.alternate;return w===null?(w=ti(o.tag,p,o.key,o.mode),w.elementType=o.elementType,w.type=o.type,w.stateNode=o.stateNode,w.alternate=o,o.alternate=w):(w.pendingProps=p,w.type=o.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=o.flags&65011712,w.childLanes=o.childLanes,w.lanes=o.lanes,w.child=o.child,w.memoizedProps=o.memoizedProps,w.memoizedState=o.memoizedState,w.updateQueue=o.updateQueue,p=o.dependencies,w.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},w.sibling=o.sibling,w.index=o.index,w.ref=o.ref,w.refCleanup=o.refCleanup,w}function kv(o,p){o.flags&=65011714;var w=o.alternate;return w===null?(o.childLanes=0,o.lanes=p,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=w.childLanes,o.lanes=w.lanes,o.child=w.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=w.memoizedProps,o.memoizedState=w.memoizedState,o.updateQueue=w.updateQueue,o.type=w.type,p=w.dependencies,o.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),o}function Gf(o,p,w,x,O,N){var H=0;if(x=o,typeof o=="function")yy(o)&&(H=1);else if(typeof o=="string")H=QO(o,w,ce.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case P:return o=ti(31,w,p,O),o.elementType=P,o.lanes=N,o;case y:return ks(w.children,O,N,p);case b:H=8,O|=24;break;case g:return o=ti(12,w,p,O|2),o.elementType=g,o.lanes=N,o;case A:return o=ti(13,w,p,O),o.elementType=A,o.lanes=N,o;case R:return o=ti(19,w,p,O),o.elementType=R,o.lanes=N,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case v:case S:H=10;break e;case _:H=9;break e;case I:H=11;break e;case E:H=14;break e;case k:H=16,x=null;break e}H=29,w=Error(r(130,o===null?"null":typeof o,"")),x=null}return p=ti(H,w,p,O),p.elementType=o,p.type=x,p.lanes=N,p}function ks(o,p,w,x){return o=ti(7,o,x,p),o.lanes=w,o}function gy(o,p,w){return o=ti(6,o,null,p),o.lanes=w,o}function by(o,p,w){return p=ti(4,o.children!==null?o.children:[],o.key,p),p.lanes=w,p.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},p}var jo=[],Vo=0,Xf=null,Yf=0,vi=[],xi=0,Es=null,Yr=1,Qr="";function Os(o,p){jo[Vo++]=Yf,jo[Vo++]=Xf,Xf=o,Yf=p}function Ev(o,p,w){vi[xi++]=Yr,vi[xi++]=Qr,vi[xi++]=Es,Es=o;var x=Yr;o=Qr;var O=32-qt(x)-1;x&=~(1<<O),w+=1;var N=32-qt(p)+O;if(30<N){var H=O-O%5;N=(x&(1<<H)-1).toString(32),x>>=H,O-=H,Yr=1<<32-qt(p)+O|w<<O|x,Qr=N+o}else Yr=1<<N|w<<O|x,Qr=o}function my(o){o.return!==null&&(Os(o,1),Ev(o,1,0))}function wy(o){for(;o===Xf;)Xf=jo[--Vo],jo[Vo]=null,Yf=jo[--Vo],jo[Vo]=null;for(;o===Es;)Es=vi[--xi],vi[xi]=null,Qr=vi[--xi],vi[xi]=null,Yr=vi[--xi],vi[xi]=null}var Fn=null,$t=null,yt=!1,As=null,vr=!1,vy=Error(r(519));function Ps(o){var p=Error(r(418,""));throw Fu(mi(p,o)),vy}function Ov(o){var p=o.stateNode,w=o.type,x=o.memoizedProps;switch(p[Zt]=o,p[xn]=x,w){case"dialog":st("cancel",p),st("close",p);break;case"iframe":case"object":case"embed":st("load",p);break;case"video":case"audio":for(w=0;w<cl.length;w++)st(cl[w],p);break;case"source":st("error",p);break;case"img":case"image":case"link":st("error",p),st("load",p);break;case"details":st("toggle",p);break;case"input":st("invalid",p),Vw(p,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Df(p);break;case"select":st("invalid",p);break;case"textarea":st("invalid",p),Ww(p,x.value,x.defaultValue,x.children),Df(p)}w=x.children,typeof w!="string"&&typeof w!="number"&&typeof w!="bigint"||p.textContent===""+w||x.suppressHydrationWarning===!0||Wx(p.textContent,w)?(x.popover!=null&&(st("beforetoggle",p),st("toggle",p)),x.onScroll!=null&&st("scroll",p),x.onScrollEnd!=null&&st("scrollend",p),x.onClick!=null&&(p.onclick=Ph),p=!0):p=!1,p||Ps(o)}function Av(o){for(Fn=o.return;Fn;)switch(Fn.tag){case 5:case 13:vr=!1;return;case 27:case 3:vr=!0;return;default:Fn=Fn.return}}function Du(o){if(o!==Fn)return!1;if(!yt)return Av(o),yt=!0,!1;var p=o.tag,w;if((w=p!==3&&p!==27)&&((w=p===5)&&(w=o.type,w=!(w!=="form"&&w!=="button")||Dg(o.type,o.memoizedProps)),w=!w),w&&$t&&Ps(o),Av(o),p===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,p=0;o;){if(o.nodeType===8)if(w=o.data,w==="/$"){if(p===0){$t=Yi(o.nextSibling);break e}p--}else w!=="$"&&w!=="$!"&&w!=="$?"||p++;o=o.nextSibling}$t=null}}else p===27?(p=$t,Ja(o.type)?(o=Hg,Hg=null,$t=o):$t=p):$t=Fn?Yi(o.stateNode.nextSibling):null;return!0}function Lu(){$t=Fn=null,yt=!1}function Pv(){var o=As;return o!==null&&(Wn===null?Wn=o:Wn.push.apply(Wn,o),As=null),o}function Fu(o){As===null?As=[o]:As.push(o)}var xy=z(null),Rs=null,Zr=null;function Fa(o,p,w){ne(xy,p._currentValue),p._currentValue=w}function Jr(o){o._currentValue=xy.current,G(xy)}function _y(o,p,w){for(;o!==null;){var x=o.alternate;if((o.childLanes&p)!==p?(o.childLanes|=p,x!==null&&(x.childLanes|=p)):x!==null&&(x.childLanes&p)!==p&&(x.childLanes|=p),o===w)break;o=o.return}}function Sy(o,p,w,x){var O=o.child;for(O!==null&&(O.return=o);O!==null;){var N=O.dependencies;if(N!==null){var H=O.child;N=N.firstContext;e:for(;N!==null;){var V=N;N=O;for(var Q=0;Q<p.length;Q++)if(V.context===p[Q]){N.lanes|=w,V=N.alternate,V!==null&&(V.lanes|=w),_y(N.return,w,o),x||(H=null);break e}N=V.next}}else if(O.tag===18){if(H=O.return,H===null)throw Error(r(341));H.lanes|=w,N=H.alternate,N!==null&&(N.lanes|=w),_y(H,w,o),H=null}else H=O.child;if(H!==null)H.return=O;else for(H=O;H!==null;){if(H===o){H=null;break}if(O=H.sibling,O!==null){O.return=H.return,H=O;break}H=H.return}O=H}}function Uu(o,p,w,x){o=null;for(var O=p,N=!1;O!==null;){if(!N){if((O.flags&524288)!==0)N=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var H=O.alternate;if(H===null)throw Error(r(387));if(H=H.memoizedProps,H!==null){var V=O.type;ei(O.pendingProps.value,H.value)||(o!==null?o.push(V):o=[V])}}else if(O===me.current){if(H=O.alternate,H===null)throw Error(r(387));H.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(o!==null?o.push(pl):o=[pl])}O=O.return}o!==null&&Sy(p,o,w,x),p.flags|=262144}function Qf(o){for(o=o.firstContext;o!==null;){if(!ei(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Ns(o){Rs=o,Zr=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Mn(o){return Rv(Rs,o)}function Zf(o,p){return Rs===null&&Ns(o),Rv(o,p)}function Rv(o,p){var w=p._currentValue;if(p={context:p,memoizedValue:w,next:null},Zr===null){if(o===null)throw Error(r(308));Zr=p,o.dependencies={lanes:0,firstContext:p},o.flags|=524288}else Zr=Zr.next=p;return w}var YE=typeof AbortController<"u"?AbortController:function(){var o=[],p=this.signal={aborted:!1,addEventListener:function(w,x){o.push(x)}};this.abort=function(){p.aborted=!0,o.forEach(function(w){return w()})}},QE=i.unstable_scheduleCallback,ZE=i.unstable_NormalPriority,hn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Iy(){return{controller:new YE,data:new Map,refCount:0}}function Hu(o){o.refCount--,o.refCount===0&&QE(ZE,function(){o.controller.abort()})}var qu=null,Ty=0,Ko=0,Wo=null;function JE(o,p){if(qu===null){var w=qu=[];Ty=0,Ko=Eg(),Wo={status:"pending",value:void 0,then:function(x){w.push(x)}}}return Ty++,p.then(Nv,Nv),p}function Nv(){if(--Ty===0&&qu!==null){Wo!==null&&(Wo.status="fulfilled");var o=qu;qu=null,Ko=0,Wo=null;for(var p=0;p<o.length;p++)(0,o[p])()}}function eO(o,p){var w=[],x={status:"pending",value:null,reason:null,then:function(O){w.push(O)}};return o.then(function(){x.status="fulfilled",x.value=p;for(var O=0;O<w.length;O++)(0,w[O])(p)},function(O){for(x.status="rejected",x.reason=O,O=0;O<w.length;O++)(0,w[O])(void 0)}),x}var Cv=L.S;L.S=function(o,p){typeof p=="object"&&p!==null&&typeof p.then=="function"&&JE(o,p),Cv!==null&&Cv(o,p)};var Cs=z(null);function ky(){var o=Cs.current;return o!==null?o:Bt.pooledCache}function Jf(o,p){p===null?ne(Cs,Cs.current):ne(Cs,p.pool)}function Mv(){var o=ky();return o===null?null:{parent:hn._currentValue,pool:o}}var ju=Error(r(460)),Bv=Error(r(474)),eh=Error(r(542)),Ey={then:function(){}};function Dv(o){return o=o.status,o==="fulfilled"||o==="rejected"}function th(){}function Lv(o,p,w){switch(w=o[w],w===void 0?o.push(p):w!==p&&(p.then(th,th),p=w),p.status){case"fulfilled":return p.value;case"rejected":throw o=p.reason,Uv(o),o;default:if(typeof p.status=="string")p.then(th,th);else{if(o=Bt,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=p,o.status="pending",o.then(function(x){if(p.status==="pending"){var O=p;O.status="fulfilled",O.value=x}},function(x){if(p.status==="pending"){var O=p;O.status="rejected",O.reason=x}})}switch(p.status){case"fulfilled":return p.value;case"rejected":throw o=p.reason,Uv(o),o}throw Vu=p,ju}}var Vu=null;function Fv(){if(Vu===null)throw Error(r(459));var o=Vu;return Vu=null,o}function Uv(o){if(o===ju||o===eh)throw Error(r(483))}var Ua=!1;function Oy(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ay(o,p){o=o.updateQueue,p.updateQueue===o&&(p.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Ha(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function qa(o,p,w){var x=o.updateQueue;if(x===null)return null;if(x=x.shared,(vt&2)!==0){var O=x.pending;return O===null?p.next=p:(p.next=O.next,O.next=p),x.pending=p,p=zf(o),Tv(o,null,w),p}return $f(o,x,p,w),zf(o)}function Ku(o,p,w){if(p=p.updateQueue,p!==null&&(p=p.shared,(w&4194048)!==0)){var x=p.lanes;x&=o.pendingLanes,w|=x,p.lanes=w,ze(o,w)}}function Py(o,p){var w=o.updateQueue,x=o.alternate;if(x!==null&&(x=x.updateQueue,w===x)){var O=null,N=null;if(w=w.firstBaseUpdate,w!==null){do{var H={lane:w.lane,tag:w.tag,payload:w.payload,callback:null,next:null};N===null?O=N=H:N=N.next=H,w=w.next}while(w!==null);N===null?O=N=p:N=N.next=p}else O=N=p;w={baseState:x.baseState,firstBaseUpdate:O,lastBaseUpdate:N,shared:x.shared,callbacks:x.callbacks},o.updateQueue=w;return}o=w.lastBaseUpdate,o===null?w.firstBaseUpdate=p:o.next=p,w.lastBaseUpdate=p}var Ry=!1;function Wu(){if(Ry){var o=Wo;if(o!==null)throw o}}function $u(o,p,w,x){Ry=!1;var O=o.updateQueue;Ua=!1;var N=O.firstBaseUpdate,H=O.lastBaseUpdate,V=O.shared.pending;if(V!==null){O.shared.pending=null;var Q=V,ue=Q.next;Q.next=null,H===null?N=ue:H.next=ue,H=Q;var be=o.alternate;be!==null&&(be=be.updateQueue,V=be.lastBaseUpdate,V!==H&&(V===null?be.firstBaseUpdate=ue:V.next=ue,be.lastBaseUpdate=Q))}if(N!==null){var ve=O.baseState;H=0,be=ue=Q=null,V=N;do{var fe=V.lane&-536870913,pe=fe!==V.lane;if(pe?(lt&fe)===fe:(x&fe)===fe){fe!==0&&fe===Ko&&(Ry=!0),be!==null&&(be=be.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var je=o,He=V;fe=p;var Et=w;switch(He.tag){case 1:if(je=He.payload,typeof je=="function"){ve=je.call(Et,ve,fe);break e}ve=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=He.payload,fe=typeof je=="function"?je.call(Et,ve,fe):je,fe==null)break e;ve=h({},ve,fe);break e;case 2:Ua=!0}}fe=V.callback,fe!==null&&(o.flags|=64,pe&&(o.flags|=8192),pe=O.callbacks,pe===null?O.callbacks=[fe]:pe.push(fe))}else pe={lane:fe,tag:V.tag,payload:V.payload,callback:V.callback,next:null},be===null?(ue=be=pe,Q=ve):be=be.next=pe,H|=fe;if(V=V.next,V===null){if(V=O.shared.pending,V===null)break;pe=V,V=pe.next,pe.next=null,O.lastBaseUpdate=pe,O.shared.pending=null}}while(!0);be===null&&(Q=ve),O.baseState=Q,O.firstBaseUpdate=ue,O.lastBaseUpdate=be,N===null&&(O.shared.lanes=0),Xa|=H,o.lanes=H,o.memoizedState=ve}}function Hv(o,p){if(typeof o!="function")throw Error(r(191,o));o.call(p)}function qv(o,p){var w=o.callbacks;if(w!==null)for(o.callbacks=null,o=0;o<w.length;o++)Hv(w[o],p)}var $o=z(null),nh=z(0);function jv(o,p){o=sa,ne(nh,o),ne($o,p),sa=o|p.baseLanes}function Ny(){ne(nh,sa),ne($o,$o.current)}function Cy(){sa=nh.current,G($o),G(nh)}var ja=0,tt=null,Tt=null,on=null,ih=!1,zo=!1,Ms=!1,rh=0,zu=0,Go=null,tO=0;function en(){throw Error(r(321))}function My(o,p){if(p===null)return!1;for(var w=0;w<p.length&&w<o.length;w++)if(!ei(o[w],p[w]))return!1;return!0}function By(o,p,w,x,O,N){return ja=N,tt=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,L.H=o===null||o.memoizedState===null?T1:k1,Ms=!1,N=w(x,O),Ms=!1,zo&&(N=Kv(p,w,x,O)),Vv(o),N}function Vv(o){L.H=lh;var p=Tt!==null&&Tt.next!==null;if(ja=0,on=Tt=tt=null,ih=!1,zu=0,Go=null,p)throw Error(r(300));o===null||_n||(o=o.dependencies,o!==null&&Qf(o)&&(_n=!0))}function Kv(o,p,w,x){tt=o;var O=0;do{if(zo&&(Go=null),zu=0,zo=!1,25<=O)throw Error(r(301));if(O+=1,on=Tt=null,o.updateQueue!=null){var N=o.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}L.H=cO,N=p(w,x)}while(zo);return N}function nO(){var o=L.H,p=o.useState()[0];return p=typeof p.then=="function"?Gu(p):p,o=o.useState()[0],(Tt!==null?Tt.memoizedState:null)!==o&&(tt.flags|=1024),p}function Dy(){var o=rh!==0;return rh=0,o}function Ly(o,p,w){p.updateQueue=o.updateQueue,p.flags&=-2053,o.lanes&=~w}function Fy(o){if(ih){for(o=o.memoizedState;o!==null;){var p=o.queue;p!==null&&(p.pending=null),o=o.next}ih=!1}ja=0,on=Tt=tt=null,zo=!1,zu=rh=0,Go=null}function Vn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?tt.memoizedState=on=o:on=on.next=o,on}function cn(){if(Tt===null){var o=tt.alternate;o=o!==null?o.memoizedState:null}else o=Tt.next;var p=on===null?tt.memoizedState:on.next;if(p!==null)on=p,Tt=o;else{if(o===null)throw tt.alternate===null?Error(r(467)):Error(r(310));Tt=o,o={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},on===null?tt.memoizedState=on=o:on=on.next=o}return on}function Uy(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gu(o){var p=zu;return zu+=1,Go===null&&(Go=[]),o=Lv(Go,o,p),p=tt,(on===null?p.memoizedState:on.next)===null&&(p=p.alternate,L.H=p===null||p.memoizedState===null?T1:k1),o}function ah(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Gu(o);if(o.$$typeof===S)return Mn(o)}throw Error(r(438,String(o)))}function Hy(o){var p=null,w=tt.updateQueue;if(w!==null&&(p=w.memoCache),p==null){var x=tt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(p={data:x.data.map(function(O){return O.slice()}),index:0})))}if(p==null&&(p={data:[],index:0}),w===null&&(w=Uy(),tt.updateQueue=w),w.memoCache=p,w=p.data[p.index],w===void 0)for(w=p.data[p.index]=Array(o),x=0;x<o;x++)w[x]=T;return p.index++,w}function ea(o,p){return typeof p=="function"?p(o):p}function sh(o){var p=cn();return qy(p,Tt,o)}function qy(o,p,w){var x=o.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=w;var O=o.baseQueue,N=x.pending;if(N!==null){if(O!==null){var H=O.next;O.next=N.next,N.next=H}p.baseQueue=O=N,x.pending=null}if(N=o.baseState,O===null)o.memoizedState=N;else{p=O.next;var V=H=null,Q=null,ue=p,be=!1;do{var ve=ue.lane&-536870913;if(ve!==ue.lane?(lt&ve)===ve:(ja&ve)===ve){var fe=ue.revertLane;if(fe===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ve===Ko&&(be=!0);else if((ja&fe)===fe){ue=ue.next,fe===Ko&&(be=!0);continue}else ve={lane:0,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Q===null?(V=Q=ve,H=N):Q=Q.next=ve,tt.lanes|=fe,Xa|=fe;ve=ue.action,Ms&&w(N,ve),N=ue.hasEagerState?ue.eagerState:w(N,ve)}else fe={lane:ve,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Q===null?(V=Q=fe,H=N):Q=Q.next=fe,tt.lanes|=ve,Xa|=ve;ue=ue.next}while(ue!==null&&ue!==p);if(Q===null?H=N:Q.next=V,!ei(N,o.memoizedState)&&(_n=!0,be&&(w=Wo,w!==null)))throw w;o.memoizedState=N,o.baseState=H,o.baseQueue=Q,x.lastRenderedState=N}return O===null&&(x.lanes=0),[o.memoizedState,x.dispatch]}function jy(o){var p=cn(),w=p.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=o;var x=w.dispatch,O=w.pending,N=p.memoizedState;if(O!==null){w.pending=null;var H=O=O.next;do N=o(N,H.action),H=H.next;while(H!==O);ei(N,p.memoizedState)||(_n=!0),p.memoizedState=N,p.baseQueue===null&&(p.baseState=N),w.lastRenderedState=N}return[N,x]}function Wv(o,p,w){var x=tt,O=cn(),N=yt;if(N){if(w===void 0)throw Error(r(407));w=w()}else w=p();var H=!ei((Tt||O).memoizedState,w);H&&(O.memoizedState=w,_n=!0),O=O.queue;var V=Gv.bind(null,x,O,o);if(Xu(2048,8,V,[o]),O.getSnapshot!==p||H||on!==null&&on.memoizedState.tag&1){if(x.flags|=2048,Xo(9,oh(),zv.bind(null,x,O,w,p),null),Bt===null)throw Error(r(349));N||(ja&124)!==0||$v(x,p,w)}return w}function $v(o,p,w){o.flags|=16384,o={getSnapshot:p,value:w},p=tt.updateQueue,p===null?(p=Uy(),tt.updateQueue=p,p.stores=[o]):(w=p.stores,w===null?p.stores=[o]:w.push(o))}function zv(o,p,w,x){p.value=w,p.getSnapshot=x,Xv(p)&&Yv(o)}function Gv(o,p,w){return w(function(){Xv(p)&&Yv(o)})}function Xv(o){var p=o.getSnapshot;o=o.value;try{var w=p();return!ei(o,w)}catch{return!0}}function Yv(o){var p=Ho(o,2);p!==null&&si(p,o,2)}function Vy(o){var p=Vn();if(typeof o=="function"){var w=o;if(o=w(),Ms){vn(!0);try{w()}finally{vn(!1)}}}return p.memoizedState=p.baseState=o,p.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:o},p}function Qv(o,p,w,x){return o.baseState=w,qy(o,Tt,typeof x=="function"?x:ea)}function iO(o,p,w,x,O){if(uh(o))throw Error(r(485));if(o=p.action,o!==null){var N={payload:O,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){N.listeners.push(H)}};L.T!==null?w(!0):N.isTransition=!1,x(N),w=p.pending,w===null?(N.next=p.pending=N,Zv(p,N)):(N.next=w.next,p.pending=w.next=N)}}function Zv(o,p){var w=p.action,x=p.payload,O=o.state;if(p.isTransition){var N=L.T,H={};L.T=H;try{var V=w(O,x),Q=L.S;Q!==null&&Q(H,V),Jv(o,p,V)}catch(ue){Ky(o,p,ue)}finally{L.T=N}}else try{N=w(O,x),Jv(o,p,N)}catch(ue){Ky(o,p,ue)}}function Jv(o,p,w){w!==null&&typeof w=="object"&&typeof w.then=="function"?w.then(function(x){e1(o,p,x)},function(x){return Ky(o,p,x)}):e1(o,p,w)}function e1(o,p,w){p.status="fulfilled",p.value=w,t1(p),o.state=w,p=o.pending,p!==null&&(w=p.next,w===p?o.pending=null:(w=w.next,p.next=w,Zv(o,w)))}function Ky(o,p,w){var x=o.pending;if(o.pending=null,x!==null){x=x.next;do p.status="rejected",p.reason=w,t1(p),p=p.next;while(p!==x)}o.action=null}function t1(o){o=o.listeners;for(var p=0;p<o.length;p++)(0,o[p])()}function n1(o,p){return p}function i1(o,p){if(yt){var w=Bt.formState;if(w!==null){e:{var x=tt;if(yt){if($t){t:{for(var O=$t,N=vr;O.nodeType!==8;){if(!N){O=null;break t}if(O=Yi(O.nextSibling),O===null){O=null;break t}}N=O.data,O=N==="F!"||N==="F"?O:null}if(O){$t=Yi(O.nextSibling),x=O.data==="F!";break e}}Ps(x)}x=!1}x&&(p=w[0])}}return w=Vn(),w.memoizedState=w.baseState=p,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n1,lastRenderedState:p},w.queue=x,w=_1.bind(null,tt,x),x.dispatch=w,x=Vy(!1),N=Xy.bind(null,tt,!1,x.queue),x=Vn(),O={state:p,dispatch:null,action:o,pending:null},x.queue=O,w=iO.bind(null,tt,O,N,w),O.dispatch=w,x.memoizedState=o,[p,w,!1]}function r1(o){var p=cn();return a1(p,Tt,o)}function a1(o,p,w){if(p=qy(o,p,n1)[0],o=sh(ea)[0],typeof p=="object"&&p!==null&&typeof p.then=="function")try{var x=Gu(p)}catch(H){throw H===ju?eh:H}else x=p;p=cn();var O=p.queue,N=O.dispatch;return w!==p.memoizedState&&(tt.flags|=2048,Xo(9,oh(),rO.bind(null,O,w),null)),[x,N,o]}function rO(o,p){o.action=p}function s1(o){var p=cn(),w=Tt;if(w!==null)return a1(p,w,o);cn(),p=p.memoizedState,w=cn();var x=w.queue.dispatch;return w.memoizedState=o,[p,x,!1]}function Xo(o,p,w,x){return o={tag:o,create:w,deps:x,inst:p,next:null},p=tt.updateQueue,p===null&&(p=Uy(),tt.updateQueue=p),w=p.lastEffect,w===null?p.lastEffect=o.next=o:(x=w.next,w.next=o,o.next=x,p.lastEffect=o),o}function oh(){return{destroy:void 0,resource:void 0}}function o1(){return cn().memoizedState}function ch(o,p,w,x){var O=Vn();x=x===void 0?null:x,tt.flags|=o,O.memoizedState=Xo(1|p,oh(),w,x)}function Xu(o,p,w,x){var O=cn();x=x===void 0?null:x;var N=O.memoizedState.inst;Tt!==null&&x!==null&&My(x,Tt.memoizedState.deps)?O.memoizedState=Xo(p,N,w,x):(tt.flags|=o,O.memoizedState=Xo(1|p,N,w,x))}function c1(o,p){ch(8390656,8,o,p)}function u1(o,p){Xu(2048,8,o,p)}function l1(o,p){return Xu(4,2,o,p)}function d1(o,p){return Xu(4,4,o,p)}function f1(o,p){if(typeof p=="function"){o=o();var w=p(o);return function(){typeof w=="function"?w():p(null)}}if(p!=null)return o=o(),p.current=o,function(){p.current=null}}function h1(o,p,w){w=w!=null?w.concat([o]):null,Xu(4,4,f1.bind(null,p,o),w)}function Wy(){}function p1(o,p){var w=cn();p=p===void 0?null:p;var x=w.memoizedState;return p!==null&&My(p,x[1])?x[0]:(w.memoizedState=[o,p],o)}function y1(o,p){var w=cn();p=p===void 0?null:p;var x=w.memoizedState;if(p!==null&&My(p,x[1]))return x[0];if(x=o(),Ms){vn(!0);try{o()}finally{vn(!1)}}return w.memoizedState=[x,p],x}function $y(o,p,w){return w===void 0||(ja&1073741824)!==0?o.memoizedState=p:(o.memoizedState=w,o=mx(),tt.lanes|=o,Xa|=o,w)}function g1(o,p,w,x){return ei(w,p)?w:$o.current!==null?(o=$y(o,w,x),ei(o,p)||(_n=!0),o):(ja&42)===0?(_n=!0,o.memoizedState=w):(o=mx(),tt.lanes|=o,Xa|=o,p)}function b1(o,p,w,x,O){var N=q.p;q.p=N!==0&&8>N?N:8;var H=L.T,V={};L.T=V,Xy(o,!1,p,w);try{var Q=O(),ue=L.S;if(ue!==null&&ue(V,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var be=eO(Q,x);Yu(o,p,be,ai(o))}else Yu(o,p,x,ai(o))}catch(ve){Yu(o,p,{then:function(){},status:"rejected",reason:ve},ai())}finally{q.p=N,L.T=H}}function aO(){}function zy(o,p,w,x){if(o.tag!==5)throw Error(r(476));var O=m1(o).queue;b1(o,O,p,K,w===null?aO:function(){return w1(o),w(x)})}function m1(o){var p=o.memoizedState;if(p!==null)return p;p={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:K},next:null};var w={};return p.next={memoizedState:w,baseState:w,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:w},next:null},o.memoizedState=p,o=o.alternate,o!==null&&(o.memoizedState=p),p}function w1(o){var p=m1(o).next.queue;Yu(o,p,{},ai())}function Gy(){return Mn(pl)}function v1(){return cn().memoizedState}function x1(){return cn().memoizedState}function sO(o){for(var p=o.return;p!==null;){switch(p.tag){case 24:case 3:var w=ai();o=Ha(w);var x=qa(p,o,w);x!==null&&(si(x,p,w),Ku(x,p,w)),p={cache:Iy()},o.payload=p;return}p=p.return}}function oO(o,p,w){var x=ai();w={lane:x,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null},uh(o)?S1(p,w):(w=py(o,p,w,x),w!==null&&(si(w,o,x),I1(w,p,x)))}function _1(o,p,w){var x=ai();Yu(o,p,w,x)}function Yu(o,p,w,x){var O={lane:x,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null};if(uh(o))S1(p,O);else{var N=o.alternate;if(o.lanes===0&&(N===null||N.lanes===0)&&(N=p.lastRenderedReducer,N!==null))try{var H=p.lastRenderedState,V=N(H,w);if(O.hasEagerState=!0,O.eagerState=V,ei(V,H))return $f(o,p,O,0),Bt===null&&Wf(),!1}catch{}finally{}if(w=py(o,p,O,x),w!==null)return si(w,o,x),I1(w,p,x),!0}return!1}function Xy(o,p,w,x){if(x={lane:2,revertLane:Eg(),action:x,hasEagerState:!1,eagerState:null,next:null},uh(o)){if(p)throw Error(r(479))}else p=py(o,w,x,2),p!==null&&si(p,o,2)}function uh(o){var p=o.alternate;return o===tt||p!==null&&p===tt}function S1(o,p){zo=ih=!0;var w=o.pending;w===null?p.next=p:(p.next=w.next,w.next=p),o.pending=p}function I1(o,p,w){if((w&4194048)!==0){var x=p.lanes;x&=o.pendingLanes,w|=x,p.lanes=w,ze(o,w)}}var lh={readContext:Mn,use:ah,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en},T1={readContext:Mn,use:ah,useCallback:function(o,p){return Vn().memoizedState=[o,p===void 0?null:p],o},useContext:Mn,useEffect:c1,useImperativeHandle:function(o,p,w){w=w!=null?w.concat([o]):null,ch(4194308,4,f1.bind(null,p,o),w)},useLayoutEffect:function(o,p){return ch(4194308,4,o,p)},useInsertionEffect:function(o,p){ch(4,2,o,p)},useMemo:function(o,p){var w=Vn();p=p===void 0?null:p;var x=o();if(Ms){vn(!0);try{o()}finally{vn(!1)}}return w.memoizedState=[x,p],x},useReducer:function(o,p,w){var x=Vn();if(w!==void 0){var O=w(p);if(Ms){vn(!0);try{w(p)}finally{vn(!1)}}}else O=p;return x.memoizedState=x.baseState=O,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:O},x.queue=o,o=o.dispatch=oO.bind(null,tt,o),[x.memoizedState,o]},useRef:function(o){var p=Vn();return o={current:o},p.memoizedState=o},useState:function(o){o=Vy(o);var p=o.queue,w=_1.bind(null,tt,p);return p.dispatch=w,[o.memoizedState,w]},useDebugValue:Wy,useDeferredValue:function(o,p){var w=Vn();return $y(w,o,p)},useTransition:function(){var o=Vy(!1);return o=b1.bind(null,tt,o.queue,!0,!1),Vn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,p,w){var x=tt,O=Vn();if(yt){if(w===void 0)throw Error(r(407));w=w()}else{if(w=p(),Bt===null)throw Error(r(349));(lt&124)!==0||$v(x,p,w)}O.memoizedState=w;var N={value:w,getSnapshot:p};return O.queue=N,c1(Gv.bind(null,x,N,o),[o]),x.flags|=2048,Xo(9,oh(),zv.bind(null,x,N,w,p),null),w},useId:function(){var o=Vn(),p=Bt.identifierPrefix;if(yt){var w=Qr,x=Yr;w=(x&~(1<<32-qt(x)-1)).toString(32)+w,p="«"+p+"R"+w,w=rh++,0<w&&(p+="H"+w.toString(32)),p+="»"}else w=tO++,p="«"+p+"r"+w.toString(32)+"»";return o.memoizedState=p},useHostTransitionStatus:Gy,useFormState:i1,useActionState:i1,useOptimistic:function(o){var p=Vn();p.memoizedState=p.baseState=o;var w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return p.queue=w,p=Xy.bind(null,tt,!0,w),w.dispatch=p,[o,p]},useMemoCache:Hy,useCacheRefresh:function(){return Vn().memoizedState=sO.bind(null,tt)}},k1={readContext:Mn,use:ah,useCallback:p1,useContext:Mn,useEffect:u1,useImperativeHandle:h1,useInsertionEffect:l1,useLayoutEffect:d1,useMemo:y1,useReducer:sh,useRef:o1,useState:function(){return sh(ea)},useDebugValue:Wy,useDeferredValue:function(o,p){var w=cn();return g1(w,Tt.memoizedState,o,p)},useTransition:function(){var o=sh(ea)[0],p=cn().memoizedState;return[typeof o=="boolean"?o:Gu(o),p]},useSyncExternalStore:Wv,useId:v1,useHostTransitionStatus:Gy,useFormState:r1,useActionState:r1,useOptimistic:function(o,p){var w=cn();return Qv(w,Tt,o,p)},useMemoCache:Hy,useCacheRefresh:x1},cO={readContext:Mn,use:ah,useCallback:p1,useContext:Mn,useEffect:u1,useImperativeHandle:h1,useInsertionEffect:l1,useLayoutEffect:d1,useMemo:y1,useReducer:jy,useRef:o1,useState:function(){return jy(ea)},useDebugValue:Wy,useDeferredValue:function(o,p){var w=cn();return Tt===null?$y(w,o,p):g1(w,Tt.memoizedState,o,p)},useTransition:function(){var o=jy(ea)[0],p=cn().memoizedState;return[typeof o=="boolean"?o:Gu(o),p]},useSyncExternalStore:Wv,useId:v1,useHostTransitionStatus:Gy,useFormState:s1,useActionState:s1,useOptimistic:function(o,p){var w=cn();return Tt!==null?Qv(w,Tt,o,p):(w.baseState=o,[o,w.queue.dispatch])},useMemoCache:Hy,useCacheRefresh:x1},Yo=null,Qu=0;function dh(o){var p=Qu;return Qu+=1,Yo===null&&(Yo=[]),Lv(Yo,o,p)}function Zu(o,p){p=p.props.ref,o.ref=p!==void 0?p:null}function fh(o,p){throw p.$$typeof===f?Error(r(525)):(o=Object.prototype.toString.call(p),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":o)))}function E1(o){var p=o._init;return p(o._payload)}function O1(o){function p(ae,ee){if(o){var oe=ae.deletions;oe===null?(ae.deletions=[ee],ae.flags|=16):oe.push(ee)}}function w(ae,ee){if(!o)return null;for(;ee!==null;)p(ae,ee),ee=ee.sibling;return null}function x(ae){for(var ee=new Map;ae!==null;)ae.key!==null?ee.set(ae.key,ae):ee.set(ae.index,ae),ae=ae.sibling;return ee}function O(ae,ee){return ae=Xr(ae,ee),ae.index=0,ae.sibling=null,ae}function N(ae,ee,oe){return ae.index=oe,o?(oe=ae.alternate,oe!==null?(oe=oe.index,oe<ee?(ae.flags|=67108866,ee):oe):(ae.flags|=67108866,ee)):(ae.flags|=1048576,ee)}function H(ae){return o&&ae.alternate===null&&(ae.flags|=67108866),ae}function V(ae,ee,oe,we){return ee===null||ee.tag!==6?(ee=gy(oe,ae.mode,we),ee.return=ae,ee):(ee=O(ee,oe),ee.return=ae,ee)}function Q(ae,ee,oe,we){var Pe=oe.type;return Pe===y?be(ae,ee,oe.props.children,we,oe.key):ee!==null&&(ee.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===k&&E1(Pe)===ee.type)?(ee=O(ee,oe.props),Zu(ee,oe),ee.return=ae,ee):(ee=Gf(oe.type,oe.key,oe.props,null,ae.mode,we),Zu(ee,oe),ee.return=ae,ee)}function ue(ae,ee,oe,we){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=by(oe,ae.mode,we),ee.return=ae,ee):(ee=O(ee,oe.children||[]),ee.return=ae,ee)}function be(ae,ee,oe,we,Pe){return ee===null||ee.tag!==7?(ee=ks(oe,ae.mode,we,Pe),ee.return=ae,ee):(ee=O(ee,oe),ee.return=ae,ee)}function ve(ae,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=gy(""+ee,ae.mode,oe),ee.return=ae,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case m:return oe=Gf(ee.type,ee.key,ee.props,null,ae.mode,oe),Zu(oe,ee),oe.return=ae,oe;case d:return ee=by(ee,ae.mode,oe),ee.return=ae,ee;case k:var we=ee._init;return ee=we(ee._payload),ve(ae,ee,oe)}if(B(ee)||C(ee))return ee=ks(ee,ae.mode,oe,null),ee.return=ae,ee;if(typeof ee.then=="function")return ve(ae,dh(ee),oe);if(ee.$$typeof===S)return ve(ae,Zf(ae,ee),oe);fh(ae,ee)}return null}function fe(ae,ee,oe,we){var Pe=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Pe!==null?null:V(ae,ee,""+oe,we);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case m:return oe.key===Pe?Q(ae,ee,oe,we):null;case d:return oe.key===Pe?ue(ae,ee,oe,we):null;case k:return Pe=oe._init,oe=Pe(oe._payload),fe(ae,ee,oe,we)}if(B(oe)||C(oe))return Pe!==null?null:be(ae,ee,oe,we,null);if(typeof oe.then=="function")return fe(ae,ee,dh(oe),we);if(oe.$$typeof===S)return fe(ae,ee,Zf(ae,oe),we);fh(ae,oe)}return null}function pe(ae,ee,oe,we,Pe){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return ae=ae.get(oe)||null,V(ee,ae,""+we,Pe);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case m:return ae=ae.get(we.key===null?oe:we.key)||null,Q(ee,ae,we,Pe);case d:return ae=ae.get(we.key===null?oe:we.key)||null,ue(ee,ae,we,Pe);case k:var it=we._init;return we=it(we._payload),pe(ae,ee,oe,we,Pe)}if(B(we)||C(we))return ae=ae.get(oe)||null,be(ee,ae,we,Pe,null);if(typeof we.then=="function")return pe(ae,ee,oe,dh(we),Pe);if(we.$$typeof===S)return pe(ae,ee,oe,Zf(ee,we),Pe);fh(ee,we)}return null}function je(ae,ee,oe,we){for(var Pe=null,it=null,Be=ee,qe=ee=0,In=null;Be!==null&&qe<oe.length;qe++){Be.index>qe?(In=Be,Be=null):In=Be.sibling;var ft=fe(ae,Be,oe[qe],we);if(ft===null){Be===null&&(Be=In);break}o&&Be&&ft.alternate===null&&p(ae,Be),ee=N(ft,ee,qe),it===null?Pe=ft:it.sibling=ft,it=ft,Be=In}if(qe===oe.length)return w(ae,Be),yt&&Os(ae,qe),Pe;if(Be===null){for(;qe<oe.length;qe++)Be=ve(ae,oe[qe],we),Be!==null&&(ee=N(Be,ee,qe),it===null?Pe=Be:it.sibling=Be,it=Be);return yt&&Os(ae,qe),Pe}for(Be=x(Be);qe<oe.length;qe++)In=pe(Be,ae,qe,oe[qe],we),In!==null&&(o&&In.alternate!==null&&Be.delete(In.key===null?qe:In.key),ee=N(In,ee,qe),it===null?Pe=In:it.sibling=In,it=In);return o&&Be.forEach(function(rs){return p(ae,rs)}),yt&&Os(ae,qe),Pe}function He(ae,ee,oe,we){if(oe==null)throw Error(r(151));for(var Pe=null,it=null,Be=ee,qe=ee=0,In=null,ft=oe.next();Be!==null&&!ft.done;qe++,ft=oe.next()){Be.index>qe?(In=Be,Be=null):In=Be.sibling;var rs=fe(ae,Be,ft.value,we);if(rs===null){Be===null&&(Be=In);break}o&&Be&&rs.alternate===null&&p(ae,Be),ee=N(rs,ee,qe),it===null?Pe=rs:it.sibling=rs,it=rs,Be=In}if(ft.done)return w(ae,Be),yt&&Os(ae,qe),Pe;if(Be===null){for(;!ft.done;qe++,ft=oe.next())ft=ve(ae,ft.value,we),ft!==null&&(ee=N(ft,ee,qe),it===null?Pe=ft:it.sibling=ft,it=ft);return yt&&Os(ae,qe),Pe}for(Be=x(Be);!ft.done;qe++,ft=oe.next())ft=pe(Be,ae,qe,ft.value,we),ft!==null&&(o&&ft.alternate!==null&&Be.delete(ft.key===null?qe:ft.key),ee=N(ft,ee,qe),it===null?Pe=ft:it.sibling=ft,it=ft);return o&&Be.forEach(function(u5){return p(ae,u5)}),yt&&Os(ae,qe),Pe}function Et(ae,ee,oe,we){if(typeof oe=="object"&&oe!==null&&oe.type===y&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case m:e:{for(var Pe=oe.key;ee!==null;){if(ee.key===Pe){if(Pe=oe.type,Pe===y){if(ee.tag===7){w(ae,ee.sibling),we=O(ee,oe.props.children),we.return=ae,ae=we;break e}}else if(ee.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===k&&E1(Pe)===ee.type){w(ae,ee.sibling),we=O(ee,oe.props),Zu(we,oe),we.return=ae,ae=we;break e}w(ae,ee);break}else p(ae,ee);ee=ee.sibling}oe.type===y?(we=ks(oe.props.children,ae.mode,we,oe.key),we.return=ae,ae=we):(we=Gf(oe.type,oe.key,oe.props,null,ae.mode,we),Zu(we,oe),we.return=ae,ae=we)}return H(ae);case d:e:{for(Pe=oe.key;ee!==null;){if(ee.key===Pe)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){w(ae,ee.sibling),we=O(ee,oe.children||[]),we.return=ae,ae=we;break e}else{w(ae,ee);break}else p(ae,ee);ee=ee.sibling}we=by(oe,ae.mode,we),we.return=ae,ae=we}return H(ae);case k:return Pe=oe._init,oe=Pe(oe._payload),Et(ae,ee,oe,we)}if(B(oe))return je(ae,ee,oe,we);if(C(oe)){if(Pe=C(oe),typeof Pe!="function")throw Error(r(150));return oe=Pe.call(oe),He(ae,ee,oe,we)}if(typeof oe.then=="function")return Et(ae,ee,dh(oe),we);if(oe.$$typeof===S)return Et(ae,ee,Zf(ae,oe),we);fh(ae,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ee!==null&&ee.tag===6?(w(ae,ee.sibling),we=O(ee,oe),we.return=ae,ae=we):(w(ae,ee),we=gy(oe,ae.mode,we),we.return=ae,ae=we),H(ae)):w(ae,ee)}return function(ae,ee,oe,we){try{Qu=0;var Pe=Et(ae,ee,oe,we);return Yo=null,Pe}catch(Be){if(Be===ju||Be===eh)throw Be;var it=ti(29,Be,null,ae.mode);return it.lanes=we,it.return=ae,it}finally{}}}var Qo=O1(!0),A1=O1(!1),_i=z(null),xr=null;function Va(o){var p=o.alternate;ne(pn,pn.current&1),ne(_i,o),xr===null&&(p===null||$o.current!==null||p.memoizedState!==null)&&(xr=o)}function P1(o){if(o.tag===22){if(ne(pn,pn.current),ne(_i,o),xr===null){var p=o.alternate;p!==null&&p.memoizedState!==null&&(xr=o)}}else Ka()}function Ka(){ne(pn,pn.current),ne(_i,_i.current)}function ta(o){G(_i),xr===o&&(xr=null),G(pn)}var pn=z(0);function hh(o){for(var p=o;p!==null;){if(p.tag===13){var w=p.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||Ug(w)))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break;for(;p.sibling===null;){if(p.return===null||p.return===o)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}function Yy(o,p,w,x){p=o.memoizedState,w=w(x,p),w=w==null?p:h({},p,w),o.memoizedState=w,o.lanes===0&&(o.updateQueue.baseState=w)}var Qy={enqueueSetState:function(o,p,w){o=o._reactInternals;var x=ai(),O=Ha(x);O.payload=p,w!=null&&(O.callback=w),p=qa(o,O,x),p!==null&&(si(p,o,x),Ku(p,o,x))},enqueueReplaceState:function(o,p,w){o=o._reactInternals;var x=ai(),O=Ha(x);O.tag=1,O.payload=p,w!=null&&(O.callback=w),p=qa(o,O,x),p!==null&&(si(p,o,x),Ku(p,o,x))},enqueueForceUpdate:function(o,p){o=o._reactInternals;var w=ai(),x=Ha(w);x.tag=2,p!=null&&(x.callback=p),p=qa(o,x,w),p!==null&&(si(p,o,w),Ku(p,o,w))}};function R1(o,p,w,x,O,N,H){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(x,N,H):p.prototype&&p.prototype.isPureReactComponent?!Mu(w,x)||!Mu(O,N):!0}function N1(o,p,w,x){o=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(w,x),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(w,x),p.state!==o&&Qy.enqueueReplaceState(p,p.state,null)}function Bs(o,p){var w=p;if("ref"in p){w={};for(var x in p)x!=="ref"&&(w[x]=p[x])}if(o=o.defaultProps){w===p&&(w=h({},w));for(var O in o)w[O]===void 0&&(w[O]=o[O])}return w}var ph=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var p=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(p))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function C1(o){ph(o)}function M1(o){console.error(o)}function B1(o){ph(o)}function yh(o,p){try{var w=o.onUncaughtError;w(p.value,{componentStack:p.stack})}catch(x){setTimeout(function(){throw x})}}function D1(o,p,w){try{var x=o.onCaughtError;x(w.value,{componentStack:w.stack,errorBoundary:p.tag===1?p.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function Zy(o,p,w){return w=Ha(w),w.tag=3,w.payload={element:null},w.callback=function(){yh(o,p)},w}function L1(o){return o=Ha(o),o.tag=3,o}function F1(o,p,w,x){var O=w.type.getDerivedStateFromError;if(typeof O=="function"){var N=x.value;o.payload=function(){return O(N)},o.callback=function(){D1(p,w,x)}}var H=w.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(o.callback=function(){D1(p,w,x),typeof O!="function"&&(Ya===null?Ya=new Set([this]):Ya.add(this));var V=x.stack;this.componentDidCatch(x.value,{componentStack:V!==null?V:""})})}function uO(o,p,w,x,O){if(w.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(p=w.alternate,p!==null&&Uu(p,w,O,!0),w=_i.current,w!==null){switch(w.tag){case 13:return xr===null?_g():w.alternate===null&&zt===0&&(zt=3),w.flags&=-257,w.flags|=65536,w.lanes=O,x===Ey?w.flags|=16384:(p=w.updateQueue,p===null?w.updateQueue=new Set([x]):p.add(x),Ig(o,x,O)),!1;case 22:return w.flags|=65536,x===Ey?w.flags|=16384:(p=w.updateQueue,p===null?(p={transitions:null,markerInstances:null,retryQueue:new Set([x])},w.updateQueue=p):(w=p.retryQueue,w===null?p.retryQueue=new Set([x]):w.add(x)),Ig(o,x,O)),!1}throw Error(r(435,w.tag))}return Ig(o,x,O),_g(),!1}if(yt)return p=_i.current,p!==null?((p.flags&65536)===0&&(p.flags|=256),p.flags|=65536,p.lanes=O,x!==vy&&(o=Error(r(422),{cause:x}),Fu(mi(o,w)))):(x!==vy&&(p=Error(r(423),{cause:x}),Fu(mi(p,w))),o=o.current.alternate,o.flags|=65536,O&=-O,o.lanes|=O,x=mi(x,w),O=Zy(o.stateNode,x,O),Py(o,O),zt!==4&&(zt=2)),!1;var N=Error(r(520),{cause:x});if(N=mi(N,w),al===null?al=[N]:al.push(N),zt!==4&&(zt=2),p===null)return!0;x=mi(x,w),w=p;do{switch(w.tag){case 3:return w.flags|=65536,o=O&-O,w.lanes|=o,o=Zy(w.stateNode,x,o),Py(w,o),!1;case 1:if(p=w.type,N=w.stateNode,(w.flags&128)===0&&(typeof p.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Ya===null||!Ya.has(N))))return w.flags|=65536,O&=-O,w.lanes|=O,O=L1(O),F1(O,o,w,x),Py(w,O),!1}w=w.return}while(w!==null);return!1}var U1=Error(r(461)),_n=!1;function Pn(o,p,w,x){p.child=o===null?A1(p,null,w,x):Qo(p,o.child,w,x)}function H1(o,p,w,x,O){w=w.render;var N=p.ref;if("ref"in x){var H={};for(var V in x)V!=="ref"&&(H[V]=x[V])}else H=x;return Ns(p),x=By(o,p,w,H,N,O),V=Dy(),o!==null&&!_n?(Ly(o,p,O),na(o,p,O)):(yt&&V&&my(p),p.flags|=1,Pn(o,p,x,O),p.child)}function q1(o,p,w,x,O){if(o===null){var N=w.type;return typeof N=="function"&&!yy(N)&&N.defaultProps===void 0&&w.compare===null?(p.tag=15,p.type=N,j1(o,p,N,x,O)):(o=Gf(w.type,null,x,p,p.mode,O),o.ref=p.ref,o.return=p,p.child=o)}if(N=o.child,!sg(o,O)){var H=N.memoizedProps;if(w=w.compare,w=w!==null?w:Mu,w(H,x)&&o.ref===p.ref)return na(o,p,O)}return p.flags|=1,o=Xr(N,x),o.ref=p.ref,o.return=p,p.child=o}function j1(o,p,w,x,O){if(o!==null){var N=o.memoizedProps;if(Mu(N,x)&&o.ref===p.ref)if(_n=!1,p.pendingProps=x=N,sg(o,O))(o.flags&131072)!==0&&(_n=!0);else return p.lanes=o.lanes,na(o,p,O)}return Jy(o,p,w,x,O)}function V1(o,p,w){var x=p.pendingProps,O=x.children,N=o!==null?o.memoizedState:null;if(x.mode==="hidden"){if((p.flags&128)!==0){if(x=N!==null?N.baseLanes|w:w,o!==null){for(O=p.child=o.child,N=0;O!==null;)N=N|O.lanes|O.childLanes,O=O.sibling;p.childLanes=N&~x}else p.childLanes=0,p.child=null;return K1(o,p,x,w)}if((w&536870912)!==0)p.memoizedState={baseLanes:0,cachePool:null},o!==null&&Jf(p,N!==null?N.cachePool:null),N!==null?jv(p,N):Ny(),P1(p);else return p.lanes=p.childLanes=536870912,K1(o,p,N!==null?N.baseLanes|w:w,w)}else N!==null?(Jf(p,N.cachePool),jv(p,N),Ka(),p.memoizedState=null):(o!==null&&Jf(p,null),Ny(),Ka());return Pn(o,p,O,w),p.child}function K1(o,p,w,x){var O=ky();return O=O===null?null:{parent:hn._currentValue,pool:O},p.memoizedState={baseLanes:w,cachePool:O},o!==null&&Jf(p,null),Ny(),P1(p),o!==null&&Uu(o,p,x,!0),null}function gh(o,p){var w=p.ref;if(w===null)o!==null&&o.ref!==null&&(p.flags|=4194816);else{if(typeof w!="function"&&typeof w!="object")throw Error(r(284));(o===null||o.ref!==w)&&(p.flags|=4194816)}}function Jy(o,p,w,x,O){return Ns(p),w=By(o,p,w,x,void 0,O),x=Dy(),o!==null&&!_n?(Ly(o,p,O),na(o,p,O)):(yt&&x&&my(p),p.flags|=1,Pn(o,p,w,O),p.child)}function W1(o,p,w,x,O,N){return Ns(p),p.updateQueue=null,w=Kv(p,x,w,O),Vv(o),x=Dy(),o!==null&&!_n?(Ly(o,p,N),na(o,p,N)):(yt&&x&&my(p),p.flags|=1,Pn(o,p,w,N),p.child)}function $1(o,p,w,x,O){if(Ns(p),p.stateNode===null){var N=qo,H=w.contextType;typeof H=="object"&&H!==null&&(N=Mn(H)),N=new w(x,N),p.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=Qy,p.stateNode=N,N._reactInternals=p,N=p.stateNode,N.props=x,N.state=p.memoizedState,N.refs={},Oy(p),H=w.contextType,N.context=typeof H=="object"&&H!==null?Mn(H):qo,N.state=p.memoizedState,H=w.getDerivedStateFromProps,typeof H=="function"&&(Yy(p,w,H,x),N.state=p.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(H=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),H!==N.state&&Qy.enqueueReplaceState(N,N.state,null),$u(p,x,N,O),Wu(),N.state=p.memoizedState),typeof N.componentDidMount=="function"&&(p.flags|=4194308),x=!0}else if(o===null){N=p.stateNode;var V=p.memoizedProps,Q=Bs(w,V);N.props=Q;var ue=N.context,be=w.contextType;H=qo,typeof be=="object"&&be!==null&&(H=Mn(be));var ve=w.getDerivedStateFromProps;be=typeof ve=="function"||typeof N.getSnapshotBeforeUpdate=="function",V=p.pendingProps!==V,be||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(V||ue!==H)&&N1(p,N,x,H),Ua=!1;var fe=p.memoizedState;N.state=fe,$u(p,x,N,O),Wu(),ue=p.memoizedState,V||fe!==ue||Ua?(typeof ve=="function"&&(Yy(p,w,ve,x),ue=p.memoizedState),(Q=Ua||R1(p,w,Q,x,fe,ue,H))?(be||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(p.flags|=4194308)):(typeof N.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=x,p.memoizedState=ue),N.props=x,N.state=ue,N.context=H,x=Q):(typeof N.componentDidMount=="function"&&(p.flags|=4194308),x=!1)}else{N=p.stateNode,Ay(o,p),H=p.memoizedProps,be=Bs(w,H),N.props=be,ve=p.pendingProps,fe=N.context,ue=w.contextType,Q=qo,typeof ue=="object"&&ue!==null&&(Q=Mn(ue)),V=w.getDerivedStateFromProps,(ue=typeof V=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(H!==ve||fe!==Q)&&N1(p,N,x,Q),Ua=!1,fe=p.memoizedState,N.state=fe,$u(p,x,N,O),Wu();var pe=p.memoizedState;H!==ve||fe!==pe||Ua||o!==null&&o.dependencies!==null&&Qf(o.dependencies)?(typeof V=="function"&&(Yy(p,w,V,x),pe=p.memoizedState),(be=Ua||R1(p,w,be,x,fe,pe,Q)||o!==null&&o.dependencies!==null&&Qf(o.dependencies))?(ue||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(x,pe,Q),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(x,pe,Q)),typeof N.componentDidUpdate=="function"&&(p.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof N.componentDidUpdate!="function"||H===o.memoizedProps&&fe===o.memoizedState||(p.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&fe===o.memoizedState||(p.flags|=1024),p.memoizedProps=x,p.memoizedState=pe),N.props=x,N.state=pe,N.context=Q,x=be):(typeof N.componentDidUpdate!="function"||H===o.memoizedProps&&fe===o.memoizedState||(p.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&fe===o.memoizedState||(p.flags|=1024),x=!1)}return N=x,gh(o,p),x=(p.flags&128)!==0,N||x?(N=p.stateNode,w=x&&typeof w.getDerivedStateFromError!="function"?null:N.render(),p.flags|=1,o!==null&&x?(p.child=Qo(p,o.child,null,O),p.child=Qo(p,null,w,O)):Pn(o,p,w,O),p.memoizedState=N.state,o=p.child):o=na(o,p,O),o}function z1(o,p,w,x){return Lu(),p.flags|=256,Pn(o,p,w,x),p.child}var eg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tg(o){return{baseLanes:o,cachePool:Mv()}}function ng(o,p,w){return o=o!==null?o.childLanes&~w:0,p&&(o|=Si),o}function G1(o,p,w){var x=p.pendingProps,O=!1,N=(p.flags&128)!==0,H;if((H=N)||(H=o!==null&&o.memoizedState===null?!1:(pn.current&2)!==0),H&&(O=!0,p.flags&=-129),H=(p.flags&32)!==0,p.flags&=-33,o===null){if(yt){if(O?Va(p):Ka(),yt){var V=$t,Q;if(Q=V){e:{for(Q=V,V=vr;Q.nodeType!==8;){if(!V){V=null;break e}if(Q=Yi(Q.nextSibling),Q===null){V=null;break e}}V=Q}V!==null?(p.memoizedState={dehydrated:V,treeContext:Es!==null?{id:Yr,overflow:Qr}:null,retryLane:536870912,hydrationErrors:null},Q=ti(18,null,null,0),Q.stateNode=V,Q.return=p,p.child=Q,Fn=p,$t=null,Q=!0):Q=!1}Q||Ps(p)}if(V=p.memoizedState,V!==null&&(V=V.dehydrated,V!==null))return Ug(V)?p.lanes=32:p.lanes=536870912,null;ta(p)}return V=x.children,x=x.fallback,O?(Ka(),O=p.mode,V=bh({mode:"hidden",children:V},O),x=ks(x,O,w,null),V.return=p,x.return=p,V.sibling=x,p.child=V,O=p.child,O.memoizedState=tg(w),O.childLanes=ng(o,H,w),p.memoizedState=eg,x):(Va(p),ig(p,V))}if(Q=o.memoizedState,Q!==null&&(V=Q.dehydrated,V!==null)){if(N)p.flags&256?(Va(p),p.flags&=-257,p=rg(o,p,w)):p.memoizedState!==null?(Ka(),p.child=o.child,p.flags|=128,p=null):(Ka(),O=x.fallback,V=p.mode,x=bh({mode:"visible",children:x.children},V),O=ks(O,V,w,null),O.flags|=2,x.return=p,O.return=p,x.sibling=O,p.child=x,Qo(p,o.child,null,w),x=p.child,x.memoizedState=tg(w),x.childLanes=ng(o,H,w),p.memoizedState=eg,p=O);else if(Va(p),Ug(V)){if(H=V.nextSibling&&V.nextSibling.dataset,H)var ue=H.dgst;H=ue,x=Error(r(419)),x.stack="",x.digest=H,Fu({value:x,source:null,stack:null}),p=rg(o,p,w)}else if(_n||Uu(o,p,w,!1),H=(w&o.childLanes)!==0,_n||H){if(H=Bt,H!==null&&(x=w&-w,x=(x&42)!==0?1:mt(x),x=(x&(H.suspendedLanes|w))!==0?0:x,x!==0&&x!==Q.retryLane))throw Q.retryLane=x,Ho(o,x),si(H,o,x),U1;V.data==="$?"||_g(),p=rg(o,p,w)}else V.data==="$?"?(p.flags|=192,p.child=o.child,p=null):(o=Q.treeContext,$t=Yi(V.nextSibling),Fn=p,yt=!0,As=null,vr=!1,o!==null&&(vi[xi++]=Yr,vi[xi++]=Qr,vi[xi++]=Es,Yr=o.id,Qr=o.overflow,Es=p),p=ig(p,x.children),p.flags|=4096);return p}return O?(Ka(),O=x.fallback,V=p.mode,Q=o.child,ue=Q.sibling,x=Xr(Q,{mode:"hidden",children:x.children}),x.subtreeFlags=Q.subtreeFlags&65011712,ue!==null?O=Xr(ue,O):(O=ks(O,V,w,null),O.flags|=2),O.return=p,x.return=p,x.sibling=O,p.child=x,x=O,O=p.child,V=o.child.memoizedState,V===null?V=tg(w):(Q=V.cachePool,Q!==null?(ue=hn._currentValue,Q=Q.parent!==ue?{parent:ue,pool:ue}:Q):Q=Mv(),V={baseLanes:V.baseLanes|w,cachePool:Q}),O.memoizedState=V,O.childLanes=ng(o,H,w),p.memoizedState=eg,x):(Va(p),w=o.child,o=w.sibling,w=Xr(w,{mode:"visible",children:x.children}),w.return=p,w.sibling=null,o!==null&&(H=p.deletions,H===null?(p.deletions=[o],p.flags|=16):H.push(o)),p.child=w,p.memoizedState=null,w)}function ig(o,p){return p=bh({mode:"visible",children:p},o.mode),p.return=o,o.child=p}function bh(o,p){return o=ti(22,o,null,p),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function rg(o,p,w){return Qo(p,o.child,null,w),o=ig(p,p.pendingProps.children),o.flags|=2,p.memoizedState=null,o}function X1(o,p,w){o.lanes|=p;var x=o.alternate;x!==null&&(x.lanes|=p),_y(o.return,p,w)}function ag(o,p,w,x,O){var N=o.memoizedState;N===null?o.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:x,tail:w,tailMode:O}:(N.isBackwards=p,N.rendering=null,N.renderingStartTime=0,N.last=x,N.tail=w,N.tailMode=O)}function Y1(o,p,w){var x=p.pendingProps,O=x.revealOrder,N=x.tail;if(Pn(o,p,x.children,w),x=pn.current,(x&2)!==0)x=x&1|2,p.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=p.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&X1(o,w,p);else if(o.tag===19)X1(o,w,p);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===p)break e;for(;o.sibling===null;){if(o.return===null||o.return===p)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}x&=1}switch(ne(pn,x),O){case"forwards":for(w=p.child,O=null;w!==null;)o=w.alternate,o!==null&&hh(o)===null&&(O=w),w=w.sibling;w=O,w===null?(O=p.child,p.child=null):(O=w.sibling,w.sibling=null),ag(p,!1,O,w,N);break;case"backwards":for(w=null,O=p.child,p.child=null;O!==null;){if(o=O.alternate,o!==null&&hh(o)===null){p.child=O;break}o=O.sibling,O.sibling=w,w=O,O=o}ag(p,!0,w,null,N);break;case"together":ag(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function na(o,p,w){if(o!==null&&(p.dependencies=o.dependencies),Xa|=p.lanes,(w&p.childLanes)===0)if(o!==null){if(Uu(o,p,w,!1),(w&p.childLanes)===0)return null}else return null;if(o!==null&&p.child!==o.child)throw Error(r(153));if(p.child!==null){for(o=p.child,w=Xr(o,o.pendingProps),p.child=w,w.return=p;o.sibling!==null;)o=o.sibling,w=w.sibling=Xr(o,o.pendingProps),w.return=p;w.sibling=null}return p.child}function sg(o,p){return(o.lanes&p)!==0?!0:(o=o.dependencies,!!(o!==null&&Qf(o)))}function lO(o,p,w){switch(p.tag){case 3:xe(p,p.stateNode.containerInfo),Fa(p,hn,o.memoizedState.cache),Lu();break;case 27:case 5:Re(p);break;case 4:xe(p,p.stateNode.containerInfo);break;case 10:Fa(p,p.type,p.memoizedProps.value);break;case 13:var x=p.memoizedState;if(x!==null)return x.dehydrated!==null?(Va(p),p.flags|=128,null):(w&p.child.childLanes)!==0?G1(o,p,w):(Va(p),o=na(o,p,w),o!==null?o.sibling:null);Va(p);break;case 19:var O=(o.flags&128)!==0;if(x=(w&p.childLanes)!==0,x||(Uu(o,p,w,!1),x=(w&p.childLanes)!==0),O){if(x)return Y1(o,p,w);p.flags|=128}if(O=p.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),ne(pn,pn.current),x)break;return null;case 22:case 23:return p.lanes=0,V1(o,p,w);case 24:Fa(p,hn,o.memoizedState.cache)}return na(o,p,w)}function Q1(o,p,w){if(o!==null)if(o.memoizedProps!==p.pendingProps)_n=!0;else{if(!sg(o,w)&&(p.flags&128)===0)return _n=!1,lO(o,p,w);_n=(o.flags&131072)!==0}else _n=!1,yt&&(p.flags&1048576)!==0&&Ev(p,Yf,p.index);switch(p.lanes=0,p.tag){case 16:e:{o=p.pendingProps;var x=p.elementType,O=x._init;if(x=O(x._payload),p.type=x,typeof x=="function")yy(x)?(o=Bs(x,o),p.tag=1,p=$1(null,p,x,o,w)):(p.tag=0,p=Jy(null,p,x,o,w));else{if(x!=null){if(O=x.$$typeof,O===I){p.tag=11,p=H1(null,p,x,o,w);break e}else if(O===E){p.tag=14,p=q1(null,p,x,o,w);break e}}throw p=F(x)||x,Error(r(306,p,""))}}return p;case 0:return Jy(o,p,p.type,p.pendingProps,w);case 1:return x=p.type,O=Bs(x,p.pendingProps),$1(o,p,x,O,w);case 3:e:{if(xe(p,p.stateNode.containerInfo),o===null)throw Error(r(387));x=p.pendingProps;var N=p.memoizedState;O=N.element,Ay(o,p),$u(p,x,null,w);var H=p.memoizedState;if(x=H.cache,Fa(p,hn,x),x!==N.cache&&Sy(p,[hn],w,!0),Wu(),x=H.element,N.isDehydrated)if(N={element:x,isDehydrated:!1,cache:H.cache},p.updateQueue.baseState=N,p.memoizedState=N,p.flags&256){p=z1(o,p,x,w);break e}else if(x!==O){O=mi(Error(r(424)),p),Fu(O),p=z1(o,p,x,w);break e}else{switch(o=p.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for($t=Yi(o.firstChild),Fn=p,yt=!0,As=null,vr=!0,w=A1(p,null,x,w),p.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling}else{if(Lu(),x===O){p=na(o,p,w);break e}Pn(o,p,x,w)}p=p.child}return p;case 26:return gh(o,p),o===null?(w=t_(p.type,null,p.pendingProps,null))?p.memoizedState=w:yt||(w=p.type,o=p.pendingProps,x=Rh(Ie.current).createElement(w),x[Zt]=p,x[xn]=o,Nn(x,w,o),Jt(x),p.stateNode=x):p.memoizedState=t_(p.type,o.memoizedProps,p.pendingProps,o.memoizedState),null;case 27:return Re(p),o===null&&yt&&(x=p.stateNode=Zx(p.type,p.pendingProps,Ie.current),Fn=p,vr=!0,O=$t,Ja(p.type)?(Hg=O,$t=Yi(x.firstChild)):$t=O),Pn(o,p,p.pendingProps.children,w),gh(o,p),o===null&&(p.flags|=4194304),p.child;case 5:return o===null&&yt&&((O=x=$t)&&(x=FO(x,p.type,p.pendingProps,vr),x!==null?(p.stateNode=x,Fn=p,$t=Yi(x.firstChild),vr=!1,O=!0):O=!1),O||Ps(p)),Re(p),O=p.type,N=p.pendingProps,H=o!==null?o.memoizedProps:null,x=N.children,Dg(O,N)?x=null:H!==null&&Dg(O,H)&&(p.flags|=32),p.memoizedState!==null&&(O=By(o,p,nO,null,null,w),pl._currentValue=O),gh(o,p),Pn(o,p,x,w),p.child;case 6:return o===null&&yt&&((o=w=$t)&&(w=UO(w,p.pendingProps,vr),w!==null?(p.stateNode=w,Fn=p,$t=null,o=!0):o=!1),o||Ps(p)),null;case 13:return G1(o,p,w);case 4:return xe(p,p.stateNode.containerInfo),x=p.pendingProps,o===null?p.child=Qo(p,null,x,w):Pn(o,p,x,w),p.child;case 11:return H1(o,p,p.type,p.pendingProps,w);case 7:return Pn(o,p,p.pendingProps,w),p.child;case 8:return Pn(o,p,p.pendingProps.children,w),p.child;case 12:return Pn(o,p,p.pendingProps.children,w),p.child;case 10:return x=p.pendingProps,Fa(p,p.type,x.value),Pn(o,p,x.children,w),p.child;case 9:return O=p.type._context,x=p.pendingProps.children,Ns(p),O=Mn(O),x=x(O),p.flags|=1,Pn(o,p,x,w),p.child;case 14:return q1(o,p,p.type,p.pendingProps,w);case 15:return j1(o,p,p.type,p.pendingProps,w);case 19:return Y1(o,p,w);case 31:return x=p.pendingProps,w=p.mode,x={mode:x.mode,children:x.children},o===null?(w=bh(x,w),w.ref=p.ref,p.child=w,w.return=p,p=w):(w=Xr(o.child,x),w.ref=p.ref,p.child=w,w.return=p,p=w),p;case 22:return V1(o,p,w);case 24:return Ns(p),x=Mn(hn),o===null?(O=ky(),O===null&&(O=Bt,N=Iy(),O.pooledCache=N,N.refCount++,N!==null&&(O.pooledCacheLanes|=w),O=N),p.memoizedState={parent:x,cache:O},Oy(p),Fa(p,hn,O)):((o.lanes&w)!==0&&(Ay(o,p),$u(p,null,null,w),Wu()),O=o.memoizedState,N=p.memoizedState,O.parent!==x?(O={parent:x,cache:x},p.memoizedState=O,p.lanes===0&&(p.memoizedState=p.updateQueue.baseState=O),Fa(p,hn,x)):(x=N.cache,Fa(p,hn,x),x!==O.cache&&Sy(p,[hn],w,!0))),Pn(o,p,p.pendingProps.children,w),p.child;case 29:throw p.pendingProps}throw Error(r(156,p.tag))}function ia(o){o.flags|=4}function Z1(o,p){if(p.type!=="stylesheet"||(p.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!s_(p)){if(p=_i.current,p!==null&&((lt&4194048)===lt?xr!==null:(lt&62914560)!==lt&&(lt&536870912)===0||p!==xr))throw Vu=Ey,Bv;o.flags|=8192}}function mh(o,p){p!==null&&(o.flags|=4),o.flags&16384&&(p=o.tag!==22?Oe():536870912,o.lanes|=p,tc|=p)}function Ju(o,p){if(!yt)switch(o.tailMode){case"hidden":p=o.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?o.tail=null:w.sibling=null;break;case"collapsed":w=o.tail;for(var x=null;w!==null;)w.alternate!==null&&(x=w),w=w.sibling;x===null?p||o.tail===null?o.tail=null:o.tail.sibling=null:x.sibling=null}}function Kt(o){var p=o.alternate!==null&&o.alternate.child===o.child,w=0,x=0;if(p)for(var O=o.child;O!==null;)w|=O.lanes|O.childLanes,x|=O.subtreeFlags&65011712,x|=O.flags&65011712,O.return=o,O=O.sibling;else for(O=o.child;O!==null;)w|=O.lanes|O.childLanes,x|=O.subtreeFlags,x|=O.flags,O.return=o,O=O.sibling;return o.subtreeFlags|=x,o.childLanes=w,p}function dO(o,p,w){var x=p.pendingProps;switch(wy(p),p.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(p),null;case 1:return Kt(p),null;case 3:return w=p.stateNode,x=null,o!==null&&(x=o.memoizedState.cache),p.memoizedState.cache!==x&&(p.flags|=2048),Jr(hn),ke(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(o===null||o.child===null)&&(Du(p)?ia(p):o===null||o.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Pv())),Kt(p),null;case 26:return w=p.memoizedState,o===null?(ia(p),w!==null?(Kt(p),Z1(p,w)):(Kt(p),p.flags&=-16777217)):w?w!==o.memoizedState?(ia(p),Kt(p),Z1(p,w)):(Kt(p),p.flags&=-16777217):(o.memoizedProps!==x&&ia(p),Kt(p),p.flags&=-16777217),null;case 27:Ce(p),w=Ie.current;var O=p.type;if(o!==null&&p.stateNode!=null)o.memoizedProps!==x&&ia(p);else{if(!x){if(p.stateNode===null)throw Error(r(166));return Kt(p),null}o=ce.current,Du(p)?Ov(p):(o=Zx(O,x,w),p.stateNode=o,ia(p))}return Kt(p),null;case 5:if(Ce(p),w=p.type,o!==null&&p.stateNode!=null)o.memoizedProps!==x&&ia(p);else{if(!x){if(p.stateNode===null)throw Error(r(166));return Kt(p),null}if(o=ce.current,Du(p))Ov(p);else{switch(O=Rh(Ie.current),o){case 1:o=O.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:o=O.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":o=O.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":o=O.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":o=O.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof x.is=="string"?O.createElement("select",{is:x.is}):O.createElement("select"),x.multiple?o.multiple=!0:x.size&&(o.size=x.size);break;default:o=typeof x.is=="string"?O.createElement(w,{is:x.is}):O.createElement(w)}}o[Zt]=p,o[xn]=x;e:for(O=p.child;O!==null;){if(O.tag===5||O.tag===6)o.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===p)break e;for(;O.sibling===null;){if(O.return===null||O.return===p)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}p.stateNode=o;e:switch(Nn(o,w,x),w){case"button":case"input":case"select":case"textarea":o=!!x.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&ia(p)}}return Kt(p),p.flags&=-16777217,null;case 6:if(o&&p.stateNode!=null)o.memoizedProps!==x&&ia(p);else{if(typeof x!="string"&&p.stateNode===null)throw Error(r(166));if(o=Ie.current,Du(p)){if(o=p.stateNode,w=p.memoizedProps,x=null,O=Fn,O!==null)switch(O.tag){case 27:case 5:x=O.memoizedProps}o[Zt]=p,o=!!(o.nodeValue===w||x!==null&&x.suppressHydrationWarning===!0||Wx(o.nodeValue,w)),o||Ps(p)}else o=Rh(o).createTextNode(x),o[Zt]=p,p.stateNode=o}return Kt(p),null;case 13:if(x=p.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(O=Du(p),x!==null&&x.dehydrated!==null){if(o===null){if(!O)throw Error(r(318));if(O=p.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[Zt]=p}else Lu(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Kt(p),O=!1}else O=Pv(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=O),O=!0;if(!O)return p.flags&256?(ta(p),p):(ta(p),null)}if(ta(p),(p.flags&128)!==0)return p.lanes=w,p;if(w=x!==null,o=o!==null&&o.memoizedState!==null,w){x=p.child,O=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(O=x.alternate.memoizedState.cachePool.pool);var N=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(N=x.memoizedState.cachePool.pool),N!==O&&(x.flags|=2048)}return w!==o&&w&&(p.child.flags|=8192),mh(p,p.updateQueue),Kt(p),null;case 4:return ke(),o===null&&Rg(p.stateNode.containerInfo),Kt(p),null;case 10:return Jr(p.type),Kt(p),null;case 19:if(G(pn),O=p.memoizedState,O===null)return Kt(p),null;if(x=(p.flags&128)!==0,N=O.rendering,N===null)if(x)Ju(O,!1);else{if(zt!==0||o!==null&&(o.flags&128)!==0)for(o=p.child;o!==null;){if(N=hh(o),N!==null){for(p.flags|=128,Ju(O,!1),o=N.updateQueue,p.updateQueue=o,mh(p,o),p.subtreeFlags=0,o=w,w=p.child;w!==null;)kv(w,o),w=w.sibling;return ne(pn,pn.current&1|2),p.child}o=o.sibling}O.tail!==null&&Je()>xh&&(p.flags|=128,x=!0,Ju(O,!1),p.lanes=4194304)}else{if(!x)if(o=hh(N),o!==null){if(p.flags|=128,x=!0,o=o.updateQueue,p.updateQueue=o,mh(p,o),Ju(O,!0),O.tail===null&&O.tailMode==="hidden"&&!N.alternate&&!yt)return Kt(p),null}else 2*Je()-O.renderingStartTime>xh&&w!==536870912&&(p.flags|=128,x=!0,Ju(O,!1),p.lanes=4194304);O.isBackwards?(N.sibling=p.child,p.child=N):(o=O.last,o!==null?o.sibling=N:p.child=N,O.last=N)}return O.tail!==null?(p=O.tail,O.rendering=p,O.tail=p.sibling,O.renderingStartTime=Je(),p.sibling=null,o=pn.current,ne(pn,x?o&1|2:o&1),p):(Kt(p),null);case 22:case 23:return ta(p),Cy(),x=p.memoizedState!==null,o!==null?o.memoizedState!==null!==x&&(p.flags|=8192):x&&(p.flags|=8192),x?(w&536870912)!==0&&(p.flags&128)===0&&(Kt(p),p.subtreeFlags&6&&(p.flags|=8192)):Kt(p),w=p.updateQueue,w!==null&&mh(p,w.retryQueue),w=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(w=o.memoizedState.cachePool.pool),x=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),x!==w&&(p.flags|=2048),o!==null&&G(Cs),null;case 24:return w=null,o!==null&&(w=o.memoizedState.cache),p.memoizedState.cache!==w&&(p.flags|=2048),Jr(hn),Kt(p),null;case 25:return null;case 30:return null}throw Error(r(156,p.tag))}function fO(o,p){switch(wy(p),p.tag){case 1:return o=p.flags,o&65536?(p.flags=o&-65537|128,p):null;case 3:return Jr(hn),ke(),o=p.flags,(o&65536)!==0&&(o&128)===0?(p.flags=o&-65537|128,p):null;case 26:case 27:case 5:return Ce(p),null;case 13:if(ta(p),o=p.memoizedState,o!==null&&o.dehydrated!==null){if(p.alternate===null)throw Error(r(340));Lu()}return o=p.flags,o&65536?(p.flags=o&-65537|128,p):null;case 19:return G(pn),null;case 4:return ke(),null;case 10:return Jr(p.type),null;case 22:case 23:return ta(p),Cy(),o!==null&&G(Cs),o=p.flags,o&65536?(p.flags=o&-65537|128,p):null;case 24:return Jr(hn),null;case 25:return null;default:return null}}function J1(o,p){switch(wy(p),p.tag){case 3:Jr(hn),ke();break;case 26:case 27:case 5:Ce(p);break;case 4:ke();break;case 13:ta(p);break;case 19:G(pn);break;case 10:Jr(p.type);break;case 22:case 23:ta(p),Cy(),o!==null&&G(Cs);break;case 24:Jr(hn)}}function el(o,p){try{var w=p.updateQueue,x=w!==null?w.lastEffect:null;if(x!==null){var O=x.next;w=O;do{if((w.tag&o)===o){x=void 0;var N=w.create,H=w.inst;x=N(),H.destroy=x}w=w.next}while(w!==O)}}catch(V){Pt(p,p.return,V)}}function Wa(o,p,w){try{var x=p.updateQueue,O=x!==null?x.lastEffect:null;if(O!==null){var N=O.next;x=N;do{if((x.tag&o)===o){var H=x.inst,V=H.destroy;if(V!==void 0){H.destroy=void 0,O=p;var Q=w,ue=V;try{ue()}catch(be){Pt(O,Q,be)}}}x=x.next}while(x!==N)}}catch(be){Pt(p,p.return,be)}}function ex(o){var p=o.updateQueue;if(p!==null){var w=o.stateNode;try{qv(p,w)}catch(x){Pt(o,o.return,x)}}}function tx(o,p,w){w.props=Bs(o.type,o.memoizedProps),w.state=o.memoizedState;try{w.componentWillUnmount()}catch(x){Pt(o,p,x)}}function tl(o,p){try{var w=o.ref;if(w!==null){switch(o.tag){case 26:case 27:case 5:var x=o.stateNode;break;case 30:x=o.stateNode;break;default:x=o.stateNode}typeof w=="function"?o.refCleanup=w(x):w.current=x}}catch(O){Pt(o,p,O)}}function _r(o,p){var w=o.ref,x=o.refCleanup;if(w!==null)if(typeof x=="function")try{x()}catch(O){Pt(o,p,O)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof w=="function")try{w(null)}catch(O){Pt(o,p,O)}else w.current=null}function nx(o){var p=o.type,w=o.memoizedProps,x=o.stateNode;try{e:switch(p){case"button":case"input":case"select":case"textarea":w.autoFocus&&x.focus();break e;case"img":w.src?x.src=w.src:w.srcSet&&(x.srcset=w.srcSet)}}catch(O){Pt(o,o.return,O)}}function og(o,p,w){try{var x=o.stateNode;CO(x,o.type,w,p),x[xn]=p}catch(O){Pt(o,o.return,O)}}function ix(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Ja(o.type)||o.tag===4}function cg(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||ix(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Ja(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function ug(o,p,w){var x=o.tag;if(x===5||x===6)o=o.stateNode,p?(w.nodeType===9?w.body:w.nodeName==="HTML"?w.ownerDocument.body:w).insertBefore(o,p):(p=w.nodeType===9?w.body:w.nodeName==="HTML"?w.ownerDocument.body:w,p.appendChild(o),w=w._reactRootContainer,w!=null||p.onclick!==null||(p.onclick=Ph));else if(x!==4&&(x===27&&Ja(o.type)&&(w=o.stateNode,p=null),o=o.child,o!==null))for(ug(o,p,w),o=o.sibling;o!==null;)ug(o,p,w),o=o.sibling}function wh(o,p,w){var x=o.tag;if(x===5||x===6)o=o.stateNode,p?w.insertBefore(o,p):w.appendChild(o);else if(x!==4&&(x===27&&Ja(o.type)&&(w=o.stateNode),o=o.child,o!==null))for(wh(o,p,w),o=o.sibling;o!==null;)wh(o,p,w),o=o.sibling}function rx(o){var p=o.stateNode,w=o.memoizedProps;try{for(var x=o.type,O=p.attributes;O.length;)p.removeAttributeNode(O[0]);Nn(p,x,w),p[Zt]=o,p[xn]=w}catch(N){Pt(o,o.return,N)}}var ra=!1,tn=!1,lg=!1,ax=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function hO(o,p){if(o=o.containerInfo,Mg=Lh,o=gv(o),cy(o)){if("selectionStart"in o)var w={start:o.selectionStart,end:o.selectionEnd};else e:{w=(w=o.ownerDocument)&&w.defaultView||window;var x=w.getSelection&&w.getSelection();if(x&&x.rangeCount!==0){w=x.anchorNode;var O=x.anchorOffset,N=x.focusNode;x=x.focusOffset;try{w.nodeType,N.nodeType}catch{w=null;break e}var H=0,V=-1,Q=-1,ue=0,be=0,ve=o,fe=null;t:for(;;){for(var pe;ve!==w||O!==0&&ve.nodeType!==3||(V=H+O),ve!==N||x!==0&&ve.nodeType!==3||(Q=H+x),ve.nodeType===3&&(H+=ve.nodeValue.length),(pe=ve.firstChild)!==null;)fe=ve,ve=pe;for(;;){if(ve===o)break t;if(fe===w&&++ue===O&&(V=H),fe===N&&++be===x&&(Q=H),(pe=ve.nextSibling)!==null)break;ve=fe,fe=ve.parentNode}ve=pe}w=V===-1||Q===-1?null:{start:V,end:Q}}else w=null}w=w||{start:0,end:0}}else w=null;for(Bg={focusedElem:o,selectionRange:w},Lh=!1,Sn=p;Sn!==null;)if(p=Sn,o=p.child,(p.subtreeFlags&1024)!==0&&o!==null)o.return=p,Sn=o;else for(;Sn!==null;){switch(p=Sn,N=p.alternate,o=p.flags,p.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&N!==null){o=void 0,w=p,O=N.memoizedProps,N=N.memoizedState,x=w.stateNode;try{var je=Bs(w.type,O,w.elementType===w.type);o=x.getSnapshotBeforeUpdate(je,N),x.__reactInternalSnapshotBeforeUpdate=o}catch(He){Pt(w,w.return,He)}}break;case 3:if((o&1024)!==0){if(o=p.stateNode.containerInfo,w=o.nodeType,w===9)Fg(o);else if(w===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Fg(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=p.sibling,o!==null){o.return=p.return,Sn=o;break}Sn=p.return}}function sx(o,p,w){var x=w.flags;switch(w.tag){case 0:case 11:case 15:$a(o,w),x&4&&el(5,w);break;case 1:if($a(o,w),x&4)if(o=w.stateNode,p===null)try{o.componentDidMount()}catch(H){Pt(w,w.return,H)}else{var O=Bs(w.type,p.memoizedProps);p=p.memoizedState;try{o.componentDidUpdate(O,p,o.__reactInternalSnapshotBeforeUpdate)}catch(H){Pt(w,w.return,H)}}x&64&&ex(w),x&512&&tl(w,w.return);break;case 3:if($a(o,w),x&64&&(o=w.updateQueue,o!==null)){if(p=null,w.child!==null)switch(w.child.tag){case 27:case 5:p=w.child.stateNode;break;case 1:p=w.child.stateNode}try{qv(o,p)}catch(H){Pt(w,w.return,H)}}break;case 27:p===null&&x&4&&rx(w);case 26:case 5:$a(o,w),p===null&&x&4&&nx(w),x&512&&tl(w,w.return);break;case 12:$a(o,w);break;case 13:$a(o,w),x&4&&ux(o,w),x&64&&(o=w.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(w=_O.bind(null,w),HO(o,w))));break;case 22:if(x=w.memoizedState!==null||ra,!x){p=p!==null&&p.memoizedState!==null||tn,O=ra;var N=tn;ra=x,(tn=p)&&!N?za(o,w,(w.subtreeFlags&8772)!==0):$a(o,w),ra=O,tn=N}break;case 30:break;default:$a(o,w)}}function ox(o){var p=o.alternate;p!==null&&(o.alternate=null,ox(p)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(p=o.stateNode,p!==null&&Po(p)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var jt=null,Kn=!1;function aa(o,p,w){for(w=w.child;w!==null;)cx(o,p,w),w=w.sibling}function cx(o,p,w){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(wn,w)}catch{}switch(w.tag){case 26:tn||_r(w,p),aa(o,p,w),w.memoizedState?w.memoizedState.count--:w.stateNode&&(w=w.stateNode,w.parentNode.removeChild(w));break;case 27:tn||_r(w,p);var x=jt,O=Kn;Ja(w.type)&&(jt=w.stateNode,Kn=!1),aa(o,p,w),ll(w.stateNode),jt=x,Kn=O;break;case 5:tn||_r(w,p);case 6:if(x=jt,O=Kn,jt=null,aa(o,p,w),jt=x,Kn=O,jt!==null)if(Kn)try{(jt.nodeType===9?jt.body:jt.nodeName==="HTML"?jt.ownerDocument.body:jt).removeChild(w.stateNode)}catch(N){Pt(w,p,N)}else try{jt.removeChild(w.stateNode)}catch(N){Pt(w,p,N)}break;case 18:jt!==null&&(Kn?(o=jt,Yx(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,w.stateNode),ml(o)):Yx(jt,w.stateNode));break;case 4:x=jt,O=Kn,jt=w.stateNode.containerInfo,Kn=!0,aa(o,p,w),jt=x,Kn=O;break;case 0:case 11:case 14:case 15:tn||Wa(2,w,p),tn||Wa(4,w,p),aa(o,p,w);break;case 1:tn||(_r(w,p),x=w.stateNode,typeof x.componentWillUnmount=="function"&&tx(w,p,x)),aa(o,p,w);break;case 21:aa(o,p,w);break;case 22:tn=(x=tn)||w.memoizedState!==null,aa(o,p,w),tn=x;break;default:aa(o,p,w)}}function ux(o,p){if(p.memoizedState===null&&(o=p.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{ml(o)}catch(w){Pt(p,p.return,w)}}function pO(o){switch(o.tag){case 13:case 19:var p=o.stateNode;return p===null&&(p=o.stateNode=new ax),p;case 22:return o=o.stateNode,p=o._retryCache,p===null&&(p=o._retryCache=new ax),p;default:throw Error(r(435,o.tag))}}function dg(o,p){var w=pO(o);p.forEach(function(x){var O=SO.bind(null,o,x);w.has(x)||(w.add(x),x.then(O,O))})}function ni(o,p){var w=p.deletions;if(w!==null)for(var x=0;x<w.length;x++){var O=w[x],N=o,H=p,V=H;e:for(;V!==null;){switch(V.tag){case 27:if(Ja(V.type)){jt=V.stateNode,Kn=!1;break e}break;case 5:jt=V.stateNode,Kn=!1;break e;case 3:case 4:jt=V.stateNode.containerInfo,Kn=!0;break e}V=V.return}if(jt===null)throw Error(r(160));cx(N,H,O),jt=null,Kn=!1,N=O.alternate,N!==null&&(N.return=null),O.return=null}if(p.subtreeFlags&13878)for(p=p.child;p!==null;)lx(p,o),p=p.sibling}var Xi=null;function lx(o,p){var w=o.alternate,x=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:ni(p,o),ii(o),x&4&&(Wa(3,o,o.return),el(3,o),Wa(5,o,o.return));break;case 1:ni(p,o),ii(o),x&512&&(tn||w===null||_r(w,w.return)),x&64&&ra&&(o=o.updateQueue,o!==null&&(x=o.callbacks,x!==null&&(w=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=w===null?x:w.concat(x))));break;case 26:var O=Xi;if(ni(p,o),ii(o),x&512&&(tn||w===null||_r(w,w.return)),x&4){var N=w!==null?w.memoizedState:null;if(x=o.memoizedState,w===null)if(x===null)if(o.stateNode===null){e:{x=o.type,w=o.memoizedProps,O=O.ownerDocument||O;t:switch(x){case"title":N=O.getElementsByTagName("title")[0],(!N||N[zi]||N[Zt]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=O.createElement(x),O.head.insertBefore(N,O.querySelector("head > title"))),Nn(N,x,w),N[Zt]=o,Jt(N),x=N;break e;case"link":var H=r_("link","href",O).get(x+(w.href||""));if(H){for(var V=0;V<H.length;V++)if(N=H[V],N.getAttribute("href")===(w.href==null||w.href===""?null:w.href)&&N.getAttribute("rel")===(w.rel==null?null:w.rel)&&N.getAttribute("title")===(w.title==null?null:w.title)&&N.getAttribute("crossorigin")===(w.crossOrigin==null?null:w.crossOrigin)){H.splice(V,1);break t}}N=O.createElement(x),Nn(N,x,w),O.head.appendChild(N);break;case"meta":if(H=r_("meta","content",O).get(x+(w.content||""))){for(V=0;V<H.length;V++)if(N=H[V],N.getAttribute("content")===(w.content==null?null:""+w.content)&&N.getAttribute("name")===(w.name==null?null:w.name)&&N.getAttribute("property")===(w.property==null?null:w.property)&&N.getAttribute("http-equiv")===(w.httpEquiv==null?null:w.httpEquiv)&&N.getAttribute("charset")===(w.charSet==null?null:w.charSet)){H.splice(V,1);break t}}N=O.createElement(x),Nn(N,x,w),O.head.appendChild(N);break;default:throw Error(r(468,x))}N[Zt]=o,Jt(N),x=N}o.stateNode=x}else a_(O,o.type,o.stateNode);else o.stateNode=i_(O,x,o.memoizedProps);else N!==x?(N===null?w.stateNode!==null&&(w=w.stateNode,w.parentNode.removeChild(w)):N.count--,x===null?a_(O,o.type,o.stateNode):i_(O,x,o.memoizedProps)):x===null&&o.stateNode!==null&&og(o,o.memoizedProps,w.memoizedProps)}break;case 27:ni(p,o),ii(o),x&512&&(tn||w===null||_r(w,w.return)),w!==null&&x&4&&og(o,o.memoizedProps,w.memoizedProps);break;case 5:if(ni(p,o),ii(o),x&512&&(tn||w===null||_r(w,w.return)),o.flags&32){O=o.stateNode;try{Co(O,"")}catch(pe){Pt(o,o.return,pe)}}x&4&&o.stateNode!=null&&(O=o.memoizedProps,og(o,O,w!==null?w.memoizedProps:O)),x&1024&&(lg=!0);break;case 6:if(ni(p,o),ii(o),x&4){if(o.stateNode===null)throw Error(r(162));x=o.memoizedProps,w=o.stateNode;try{w.nodeValue=x}catch(pe){Pt(o,o.return,pe)}}break;case 3:if(Mh=null,O=Xi,Xi=Nh(p.containerInfo),ni(p,o),Xi=O,ii(o),x&4&&w!==null&&w.memoizedState.isDehydrated)try{ml(p.containerInfo)}catch(pe){Pt(o,o.return,pe)}lg&&(lg=!1,dx(o));break;case 4:x=Xi,Xi=Nh(o.stateNode.containerInfo),ni(p,o),ii(o),Xi=x;break;case 12:ni(p,o),ii(o);break;case 13:ni(p,o),ii(o),o.child.flags&8192&&o.memoizedState!==null!=(w!==null&&w.memoizedState!==null)&&(bg=Je()),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,dg(o,x)));break;case 22:O=o.memoizedState!==null;var Q=w!==null&&w.memoizedState!==null,ue=ra,be=tn;if(ra=ue||O,tn=be||Q,ni(p,o),tn=be,ra=ue,ii(o),x&8192)e:for(p=o.stateNode,p._visibility=O?p._visibility&-2:p._visibility|1,O&&(w===null||Q||ra||tn||Ds(o)),w=null,p=o;;){if(p.tag===5||p.tag===26){if(w===null){Q=w=p;try{if(N=Q.stateNode,O)H=N.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{V=Q.stateNode;var ve=Q.memoizedProps.style,fe=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;V.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(pe){Pt(Q,Q.return,pe)}}}else if(p.tag===6){if(w===null){Q=p;try{Q.stateNode.nodeValue=O?"":Q.memoizedProps}catch(pe){Pt(Q,Q.return,pe)}}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===o)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break e;for(;p.sibling===null;){if(p.return===null||p.return===o)break e;w===p&&(w=null),p=p.return}w===p&&(w=null),p.sibling.return=p.return,p=p.sibling}x&4&&(x=o.updateQueue,x!==null&&(w=x.retryQueue,w!==null&&(x.retryQueue=null,dg(o,w))));break;case 19:ni(p,o),ii(o),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,dg(o,x)));break;case 30:break;case 21:break;default:ni(p,o),ii(o)}}function ii(o){var p=o.flags;if(p&2){try{for(var w,x=o.return;x!==null;){if(ix(x)){w=x;break}x=x.return}if(w==null)throw Error(r(160));switch(w.tag){case 27:var O=w.stateNode,N=cg(o);wh(o,N,O);break;case 5:var H=w.stateNode;w.flags&32&&(Co(H,""),w.flags&=-33);var V=cg(o);wh(o,V,H);break;case 3:case 4:var Q=w.stateNode.containerInfo,ue=cg(o);ug(o,ue,Q);break;default:throw Error(r(161))}}catch(be){Pt(o,o.return,be)}o.flags&=-3}p&4096&&(o.flags&=-4097)}function dx(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var p=o;dx(p),p.tag===5&&p.flags&1024&&p.stateNode.reset(),o=o.sibling}}function $a(o,p){if(p.subtreeFlags&8772)for(p=p.child;p!==null;)sx(o,p.alternate,p),p=p.sibling}function Ds(o){for(o=o.child;o!==null;){var p=o;switch(p.tag){case 0:case 11:case 14:case 15:Wa(4,p,p.return),Ds(p);break;case 1:_r(p,p.return);var w=p.stateNode;typeof w.componentWillUnmount=="function"&&tx(p,p.return,w),Ds(p);break;case 27:ll(p.stateNode);case 26:case 5:_r(p,p.return),Ds(p);break;case 22:p.memoizedState===null&&Ds(p);break;case 30:Ds(p);break;default:Ds(p)}o=o.sibling}}function za(o,p,w){for(w=w&&(p.subtreeFlags&8772)!==0,p=p.child;p!==null;){var x=p.alternate,O=o,N=p,H=N.flags;switch(N.tag){case 0:case 11:case 15:za(O,N,w),el(4,N);break;case 1:if(za(O,N,w),x=N,O=x.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(ue){Pt(x,x.return,ue)}if(x=N,O=x.updateQueue,O!==null){var V=x.stateNode;try{var Q=O.shared.hiddenCallbacks;if(Q!==null)for(O.shared.hiddenCallbacks=null,O=0;O<Q.length;O++)Hv(Q[O],V)}catch(ue){Pt(x,x.return,ue)}}w&&H&64&&ex(N),tl(N,N.return);break;case 27:rx(N);case 26:case 5:za(O,N,w),w&&x===null&&H&4&&nx(N),tl(N,N.return);break;case 12:za(O,N,w);break;case 13:za(O,N,w),w&&H&4&&ux(O,N);break;case 22:N.memoizedState===null&&za(O,N,w),tl(N,N.return);break;case 30:break;default:za(O,N,w)}p=p.sibling}}function fg(o,p){var w=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(w=o.memoizedState.cachePool.pool),o=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(o=p.memoizedState.cachePool.pool),o!==w&&(o!=null&&o.refCount++,w!=null&&Hu(w))}function hg(o,p){o=null,p.alternate!==null&&(o=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==o&&(p.refCount++,o!=null&&Hu(o))}function Sr(o,p,w,x){if(p.subtreeFlags&10256)for(p=p.child;p!==null;)fx(o,p,w,x),p=p.sibling}function fx(o,p,w,x){var O=p.flags;switch(p.tag){case 0:case 11:case 15:Sr(o,p,w,x),O&2048&&el(9,p);break;case 1:Sr(o,p,w,x);break;case 3:Sr(o,p,w,x),O&2048&&(o=null,p.alternate!==null&&(o=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==o&&(p.refCount++,o!=null&&Hu(o)));break;case 12:if(O&2048){Sr(o,p,w,x),o=p.stateNode;try{var N=p.memoizedProps,H=N.id,V=N.onPostCommit;typeof V=="function"&&V(H,p.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Q){Pt(p,p.return,Q)}}else Sr(o,p,w,x);break;case 13:Sr(o,p,w,x);break;case 23:break;case 22:N=p.stateNode,H=p.alternate,p.memoizedState!==null?N._visibility&2?Sr(o,p,w,x):nl(o,p):N._visibility&2?Sr(o,p,w,x):(N._visibility|=2,Zo(o,p,w,x,(p.subtreeFlags&10256)!==0)),O&2048&&fg(H,p);break;case 24:Sr(o,p,w,x),O&2048&&hg(p.alternate,p);break;default:Sr(o,p,w,x)}}function Zo(o,p,w,x,O){for(O=O&&(p.subtreeFlags&10256)!==0,p=p.child;p!==null;){var N=o,H=p,V=w,Q=x,ue=H.flags;switch(H.tag){case 0:case 11:case 15:Zo(N,H,V,Q,O),el(8,H);break;case 23:break;case 22:var be=H.stateNode;H.memoizedState!==null?be._visibility&2?Zo(N,H,V,Q,O):nl(N,H):(be._visibility|=2,Zo(N,H,V,Q,O)),O&&ue&2048&&fg(H.alternate,H);break;case 24:Zo(N,H,V,Q,O),O&&ue&2048&&hg(H.alternate,H);break;default:Zo(N,H,V,Q,O)}p=p.sibling}}function nl(o,p){if(p.subtreeFlags&10256)for(p=p.child;p!==null;){var w=o,x=p,O=x.flags;switch(x.tag){case 22:nl(w,x),O&2048&&fg(x.alternate,x);break;case 24:nl(w,x),O&2048&&hg(x.alternate,x);break;default:nl(w,x)}p=p.sibling}}var il=8192;function Jo(o){if(o.subtreeFlags&il)for(o=o.child;o!==null;)hx(o),o=o.sibling}function hx(o){switch(o.tag){case 26:Jo(o),o.flags&il&&o.memoizedState!==null&&JO(Xi,o.memoizedState,o.memoizedProps);break;case 5:Jo(o);break;case 3:case 4:var p=Xi;Xi=Nh(o.stateNode.containerInfo),Jo(o),Xi=p;break;case 22:o.memoizedState===null&&(p=o.alternate,p!==null&&p.memoizedState!==null?(p=il,il=16777216,Jo(o),il=p):Jo(o));break;default:Jo(o)}}function px(o){var p=o.alternate;if(p!==null&&(o=p.child,o!==null)){p.child=null;do p=o.sibling,o.sibling=null,o=p;while(o!==null)}}function rl(o){var p=o.deletions;if((o.flags&16)!==0){if(p!==null)for(var w=0;w<p.length;w++){var x=p[w];Sn=x,gx(x,o)}px(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)yx(o),o=o.sibling}function yx(o){switch(o.tag){case 0:case 11:case 15:rl(o),o.flags&2048&&Wa(9,o,o.return);break;case 3:rl(o);break;case 12:rl(o);break;case 22:var p=o.stateNode;o.memoizedState!==null&&p._visibility&2&&(o.return===null||o.return.tag!==13)?(p._visibility&=-3,vh(o)):rl(o);break;default:rl(o)}}function vh(o){var p=o.deletions;if((o.flags&16)!==0){if(p!==null)for(var w=0;w<p.length;w++){var x=p[w];Sn=x,gx(x,o)}px(o)}for(o=o.child;o!==null;){switch(p=o,p.tag){case 0:case 11:case 15:Wa(8,p,p.return),vh(p);break;case 22:w=p.stateNode,w._visibility&2&&(w._visibility&=-3,vh(p));break;default:vh(p)}o=o.sibling}}function gx(o,p){for(;Sn!==null;){var w=Sn;switch(w.tag){case 0:case 11:case 15:Wa(8,w,p);break;case 23:case 22:if(w.memoizedState!==null&&w.memoizedState.cachePool!==null){var x=w.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Hu(w.memoizedState.cache)}if(x=w.child,x!==null)x.return=w,Sn=x;else e:for(w=o;Sn!==null;){x=Sn;var O=x.sibling,N=x.return;if(ox(x),x===w){Sn=null;break e}if(O!==null){O.return=N,Sn=O;break e}Sn=N}}}var yO={getCacheForType:function(o){var p=Mn(hn),w=p.data.get(o);return w===void 0&&(w=o(),p.data.set(o,w)),w}},gO=typeof WeakMap=="function"?WeakMap:Map,vt=0,Bt=null,at=null,lt=0,xt=0,ri=null,Ga=!1,ec=!1,pg=!1,sa=0,zt=0,Xa=0,Ls=0,yg=0,Si=0,tc=0,al=null,Wn=null,gg=!1,bg=0,xh=1/0,_h=null,Ya=null,Rn=0,Qa=null,nc=null,ic=0,mg=0,wg=null,bx=null,sl=0,vg=null;function ai(){if((vt&2)!==0&&lt!==0)return lt&-lt;if(L.T!==null){var o=Ko;return o!==0?o:Eg()}return nt()}function mx(){Si===0&&(Si=(lt&536870912)===0||yt?ye():536870912);var o=_i.current;return o!==null&&(o.flags|=32),Si}function si(o,p,w){(o===Bt&&(xt===2||xt===9)||o.cancelPendingCommit!==null)&&(rc(o,0),Za(o,lt,Si,!1)),Ve(o,w),((vt&2)===0||o!==Bt)&&(o===Bt&&((vt&2)===0&&(Ls|=w),zt===4&&Za(o,lt,Si,!1)),Ir(o))}function wx(o,p,w){if((vt&6)!==0)throw Error(r(327));var x=!w&&(p&124)===0&&(p&o.expiredLanes)===0||le(o,p),O=x?wO(o,p):Sg(o,p,!0),N=x;do{if(O===0){ec&&!x&&Za(o,p,0,!1);break}else{if(w=o.current.alternate,N&&!bO(w)){O=Sg(o,p,!1),N=!1;continue}if(O===2){if(N=p,o.errorRecoveryDisabledLanes&N)var H=0;else H=o.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){p=H;e:{var V=o;O=al;var Q=V.current.memoizedState.isDehydrated;if(Q&&(rc(V,H).flags|=256),H=Sg(V,H,!1),H!==2){if(pg&&!Q){V.errorRecoveryDisabledLanes|=N,Ls|=N,O=4;break e}N=Wn,Wn=O,N!==null&&(Wn===null?Wn=N:Wn.push.apply(Wn,N))}O=H}if(N=!1,O!==2)continue}}if(O===1){rc(o,0),Za(o,p,0,!0);break}e:{switch(x=o,N=O,N){case 0:case 1:throw Error(r(345));case 4:if((p&4194048)!==p)break;case 6:Za(x,p,Si,!Ga);break e;case 2:Wn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((p&62914560)===p&&(O=bg+300-Je(),10<O)){if(Za(x,p,Si,!Ga),re(x,0,!0)!==0)break e;x.timeoutHandle=Gx(vx.bind(null,x,w,Wn,_h,gg,p,Si,Ls,tc,Ga,N,2,-0,0),O);break e}vx(x,w,Wn,_h,gg,p,Si,Ls,tc,Ga,N,0,-0,0)}}break}while(!0);Ir(o)}function vx(o,p,w,x,O,N,H,V,Q,ue,be,ve,fe,pe){if(o.timeoutHandle=-1,ve=p.subtreeFlags,(ve&8192||(ve&16785408)===16785408)&&(hl={stylesheets:null,count:0,unsuspend:ZO},hx(p),ve=e5(),ve!==null)){o.cancelPendingCommit=ve(Ex.bind(null,o,p,N,w,x,O,H,V,Q,be,1,fe,pe)),Za(o,N,H,!ue);return}Ex(o,p,N,w,x,O,H,V,Q)}function bO(o){for(var p=o;;){var w=p.tag;if((w===0||w===11||w===15)&&p.flags&16384&&(w=p.updateQueue,w!==null&&(w=w.stores,w!==null)))for(var x=0;x<w.length;x++){var O=w[x],N=O.getSnapshot;O=O.value;try{if(!ei(N(),O))return!1}catch{return!1}}if(w=p.child,p.subtreeFlags&16384&&w!==null)w.return=p,p=w;else{if(p===o)break;for(;p.sibling===null;){if(p.return===null||p.return===o)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Za(o,p,w,x){p&=~yg,p&=~Ls,o.suspendedLanes|=p,o.pingedLanes&=~p,x&&(o.warmLanes|=p),x=o.expirationTimes;for(var O=p;0<O;){var N=31-qt(O),H=1<<N;x[N]=-1,O&=~H}w!==0&&et(o,w,p)}function Sh(){return(vt&6)===0?(ol(0),!1):!0}function xg(){if(at!==null){if(xt===0)var o=at.return;else o=at,Zr=Rs=null,Fy(o),Yo=null,Qu=0,o=at;for(;o!==null;)J1(o.alternate,o),o=o.return;at=null}}function rc(o,p){var w=o.timeoutHandle;w!==-1&&(o.timeoutHandle=-1,BO(w)),w=o.cancelPendingCommit,w!==null&&(o.cancelPendingCommit=null,w()),xg(),Bt=o,at=w=Xr(o.current,null),lt=p,xt=0,ri=null,Ga=!1,ec=le(o,p),pg=!1,tc=Si=yg=Ls=Xa=zt=0,Wn=al=null,gg=!1,(p&8)!==0&&(p|=p&32);var x=o.entangledLanes;if(x!==0)for(o=o.entanglements,x&=p;0<x;){var O=31-qt(x),N=1<<O;p|=o[O],x&=~N}return sa=p,Wf(),w}function xx(o,p){tt=null,L.H=lh,p===ju||p===eh?(p=Fv(),xt=3):p===Bv?(p=Fv(),xt=4):xt=p===U1?8:p!==null&&typeof p=="object"&&typeof p.then=="function"?6:1,ri=p,at===null&&(zt=1,yh(o,mi(p,o.current)))}function _x(){var o=L.H;return L.H=lh,o===null?lh:o}function Sx(){var o=L.A;return L.A=yO,o}function _g(){zt=4,Ga||(lt&4194048)!==lt&&_i.current!==null||(ec=!0),(Xa&134217727)===0&&(Ls&134217727)===0||Bt===null||Za(Bt,lt,Si,!1)}function Sg(o,p,w){var x=vt;vt|=2;var O=_x(),N=Sx();(Bt!==o||lt!==p)&&(_h=null,rc(o,p)),p=!1;var H=zt;e:do try{if(xt!==0&&at!==null){var V=at,Q=ri;switch(xt){case 8:xg(),H=6;break e;case 3:case 2:case 9:case 6:_i.current===null&&(p=!0);var ue=xt;if(xt=0,ri=null,ac(o,V,Q,ue),w&&ec){H=0;break e}break;default:ue=xt,xt=0,ri=null,ac(o,V,Q,ue)}}mO(),H=zt;break}catch(be){xx(o,be)}while(!0);return p&&o.shellSuspendCounter++,Zr=Rs=null,vt=x,L.H=O,L.A=N,at===null&&(Bt=null,lt=0,Wf()),H}function mO(){for(;at!==null;)Ix(at)}function wO(o,p){var w=vt;vt|=2;var x=_x(),O=Sx();Bt!==o||lt!==p?(_h=null,xh=Je()+500,rc(o,p)):ec=le(o,p);e:do try{if(xt!==0&&at!==null){p=at;var N=ri;t:switch(xt){case 1:xt=0,ri=null,ac(o,p,N,1);break;case 2:case 9:if(Dv(N)){xt=0,ri=null,Tx(p);break}p=function(){xt!==2&&xt!==9||Bt!==o||(xt=7),Ir(o)},N.then(p,p);break e;case 3:xt=7;break e;case 4:xt=5;break e;case 7:Dv(N)?(xt=0,ri=null,Tx(p)):(xt=0,ri=null,ac(o,p,N,7));break;case 5:var H=null;switch(at.tag){case 26:H=at.memoizedState;case 5:case 27:var V=at;if(!H||s_(H)){xt=0,ri=null;var Q=V.sibling;if(Q!==null)at=Q;else{var ue=V.return;ue!==null?(at=ue,Ih(ue)):at=null}break t}}xt=0,ri=null,ac(o,p,N,5);break;case 6:xt=0,ri=null,ac(o,p,N,6);break;case 8:xg(),zt=6;break e;default:throw Error(r(462))}}vO();break}catch(be){xx(o,be)}while(!0);return Zr=Rs=null,L.H=x,L.A=O,vt=w,at!==null?0:(Bt=null,lt=0,Wf(),zt)}function vO(){for(;at!==null&&!Ut();)Ix(at)}function Ix(o){var p=Q1(o.alternate,o,sa);o.memoizedProps=o.pendingProps,p===null?Ih(o):at=p}function Tx(o){var p=o,w=p.alternate;switch(p.tag){case 15:case 0:p=W1(w,p,p.pendingProps,p.type,void 0,lt);break;case 11:p=W1(w,p,p.pendingProps,p.type.render,p.ref,lt);break;case 5:Fy(p);default:J1(w,p),p=at=kv(p,sa),p=Q1(w,p,sa)}o.memoizedProps=o.pendingProps,p===null?Ih(o):at=p}function ac(o,p,w,x){Zr=Rs=null,Fy(p),Yo=null,Qu=0;var O=p.return;try{if(uO(o,O,p,w,lt)){zt=1,yh(o,mi(w,o.current)),at=null;return}}catch(N){if(O!==null)throw at=O,N;zt=1,yh(o,mi(w,o.current)),at=null;return}p.flags&32768?(yt||x===1?o=!0:ec||(lt&536870912)!==0?o=!1:(Ga=o=!0,(x===2||x===9||x===3||x===6)&&(x=_i.current,x!==null&&x.tag===13&&(x.flags|=16384))),kx(p,o)):Ih(p)}function Ih(o){var p=o;do{if((p.flags&32768)!==0){kx(p,Ga);return}o=p.return;var w=dO(p.alternate,p,sa);if(w!==null){at=w;return}if(p=p.sibling,p!==null){at=p;return}at=p=o}while(p!==null);zt===0&&(zt=5)}function kx(o,p){do{var w=fO(o.alternate,o);if(w!==null){w.flags&=32767,at=w;return}if(w=o.return,w!==null&&(w.flags|=32768,w.subtreeFlags=0,w.deletions=null),!p&&(o=o.sibling,o!==null)){at=o;return}at=o=w}while(o!==null);zt=6,at=null}function Ex(o,p,w,x,O,N,H,V,Q){o.cancelPendingCommit=null;do Th();while(Rn!==0);if((vt&6)!==0)throw Error(r(327));if(p!==null){if(p===o.current)throw Error(r(177));if(N=p.lanes|p.childLanes,N|=hy,$e(o,w,N,H,V,Q),o===Bt&&(at=Bt=null,lt=0),nc=p,Qa=o,ic=w,mg=N,wg=O,bx=x,(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,IO(he,function(){return Nx(),null})):(o.callbackNode=null,o.callbackPriority=0),x=(p.flags&13878)!==0,(p.subtreeFlags&13878)!==0||x){x=L.T,L.T=null,O=q.p,q.p=2,H=vt,vt|=4;try{hO(o,p,w)}finally{vt=H,q.p=O,L.T=x}}Rn=1,Ox(),Ax(),Px()}}function Ox(){if(Rn===1){Rn=0;var o=Qa,p=nc,w=(p.flags&13878)!==0;if((p.subtreeFlags&13878)!==0||w){w=L.T,L.T=null;var x=q.p;q.p=2;var O=vt;vt|=4;try{lx(p,o);var N=Bg,H=gv(o.containerInfo),V=N.focusedElem,Q=N.selectionRange;if(H!==V&&V&&V.ownerDocument&&yv(V.ownerDocument.documentElement,V)){if(Q!==null&&cy(V)){var ue=Q.start,be=Q.end;if(be===void 0&&(be=ue),"selectionStart"in V)V.selectionStart=ue,V.selectionEnd=Math.min(be,V.value.length);else{var ve=V.ownerDocument||document,fe=ve&&ve.defaultView||window;if(fe.getSelection){var pe=fe.getSelection(),je=V.textContent.length,He=Math.min(Q.start,je),Et=Q.end===void 0?He:Math.min(Q.end,je);!pe.extend&&He>Et&&(H=Et,Et=He,He=H);var ae=pv(V,He),ee=pv(V,Et);if(ae&&ee&&(pe.rangeCount!==1||pe.anchorNode!==ae.node||pe.anchorOffset!==ae.offset||pe.focusNode!==ee.node||pe.focusOffset!==ee.offset)){var oe=ve.createRange();oe.setStart(ae.node,ae.offset),pe.removeAllRanges(),He>Et?(pe.addRange(oe),pe.extend(ee.node,ee.offset)):(oe.setEnd(ee.node,ee.offset),pe.addRange(oe))}}}}for(ve=[],pe=V;pe=pe.parentNode;)pe.nodeType===1&&ve.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<ve.length;V++){var we=ve[V];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}Lh=!!Mg,Bg=Mg=null}finally{vt=O,q.p=x,L.T=w}}o.current=p,Rn=2}}function Ax(){if(Rn===2){Rn=0;var o=Qa,p=nc,w=(p.flags&8772)!==0;if((p.subtreeFlags&8772)!==0||w){w=L.T,L.T=null;var x=q.p;q.p=2;var O=vt;vt|=4;try{sx(o,p.alternate,p)}finally{vt=O,q.p=x,L.T=w}}Rn=3}}function Px(){if(Rn===4||Rn===3){Rn=0,Ht();var o=Qa,p=nc,w=ic,x=bx;(p.subtreeFlags&10256)!==0||(p.flags&10256)!==0?Rn=5:(Rn=0,nc=Qa=null,Rx(o,o.pendingLanes));var O=o.pendingLanes;if(O===0&&(Ya=null),Ae(w),p=p.stateNode,Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(wn,p,void 0,(p.current.flags&128)===128)}catch{}if(x!==null){p=L.T,O=q.p,q.p=2,L.T=null;try{for(var N=o.onRecoverableError,H=0;H<x.length;H++){var V=x[H];N(V.value,{componentStack:V.stack})}}finally{L.T=p,q.p=O}}(ic&3)!==0&&Th(),Ir(o),O=o.pendingLanes,(w&4194090)!==0&&(O&42)!==0?o===vg?sl++:(sl=0,vg=o):sl=0,ol(0)}}function Rx(o,p){(o.pooledCacheLanes&=p)===0&&(p=o.pooledCache,p!=null&&(o.pooledCache=null,Hu(p)))}function Th(o){return Ox(),Ax(),Px(),Nx()}function Nx(){if(Rn!==5)return!1;var o=Qa,p=mg;mg=0;var w=Ae(ic),x=L.T,O=q.p;try{q.p=32>w?32:w,L.T=null,w=wg,wg=null;var N=Qa,H=ic;if(Rn=0,nc=Qa=null,ic=0,(vt&6)!==0)throw Error(r(331));var V=vt;if(vt|=4,yx(N.current),fx(N,N.current,H,w),vt=V,ol(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(wn,N)}catch{}return!0}finally{q.p=O,L.T=x,Rx(o,p)}}function Cx(o,p,w){p=mi(w,p),p=Zy(o.stateNode,p,2),o=qa(o,p,2),o!==null&&(Ve(o,2),Ir(o))}function Pt(o,p,w){if(o.tag===3)Cx(o,o,w);else for(;p!==null;){if(p.tag===3){Cx(p,o,w);break}else if(p.tag===1){var x=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ya===null||!Ya.has(x))){o=mi(w,o),w=L1(2),x=qa(p,w,2),x!==null&&(F1(w,x,p,o),Ve(x,2),Ir(x));break}}p=p.return}}function Ig(o,p,w){var x=o.pingCache;if(x===null){x=o.pingCache=new gO;var O=new Set;x.set(p,O)}else O=x.get(p),O===void 0&&(O=new Set,x.set(p,O));O.has(w)||(pg=!0,O.add(w),o=xO.bind(null,o,p,w),p.then(o,o))}function xO(o,p,w){var x=o.pingCache;x!==null&&x.delete(p),o.pingedLanes|=o.suspendedLanes&w,o.warmLanes&=~w,Bt===o&&(lt&w)===w&&(zt===4||zt===3&&(lt&62914560)===lt&&300>Je()-bg?(vt&2)===0&&rc(o,0):yg|=w,tc===lt&&(tc=0)),Ir(o)}function Mx(o,p){p===0&&(p=Oe()),o=Ho(o,p),o!==null&&(Ve(o,p),Ir(o))}function _O(o){var p=o.memoizedState,w=0;p!==null&&(w=p.retryLane),Mx(o,w)}function SO(o,p){var w=0;switch(o.tag){case 13:var x=o.stateNode,O=o.memoizedState;O!==null&&(w=O.retryLane);break;case 19:x=o.stateNode;break;case 22:x=o.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(p),Mx(o,w)}function IO(o,p){return We(o,p)}var kh=null,sc=null,Tg=!1,Eh=!1,kg=!1,Fs=0;function Ir(o){o!==sc&&o.next===null&&(sc===null?kh=sc=o:sc=sc.next=o),Eh=!0,Tg||(Tg=!0,kO())}function ol(o,p){if(!kg&&Eh){kg=!0;do for(var w=!1,x=kh;x!==null;){if(o!==0){var O=x.pendingLanes;if(O===0)var N=0;else{var H=x.suspendedLanes,V=x.pingedLanes;N=(1<<31-qt(42|o)+1)-1,N&=O&~(H&~V),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(w=!0,Fx(x,N))}else N=lt,N=re(x,x===Bt?N:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(N&3)===0||le(x,N)||(w=!0,Fx(x,N));x=x.next}while(w);kg=!1}}function TO(){Bx()}function Bx(){Eh=Tg=!1;var o=0;Fs!==0&&(MO()&&(o=Fs),Fs=0);for(var p=Je(),w=null,x=kh;x!==null;){var O=x.next,N=Dx(x,p);N===0?(x.next=null,w===null?kh=O:w.next=O,O===null&&(sc=w)):(w=x,(o!==0||(N&3)!==0)&&(Eh=!0)),x=O}ol(o)}function Dx(o,p){for(var w=o.suspendedLanes,x=o.pingedLanes,O=o.expirationTimes,N=o.pendingLanes&-62914561;0<N;){var H=31-qt(N),V=1<<H,Q=O[H];Q===-1?((V&w)===0||(V&x)!==0)&&(O[H]=se(V,p)):Q<=p&&(o.expiredLanes|=V),N&=~V}if(p=Bt,w=lt,w=re(o,o===p?w:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x=o.callbackNode,w===0||o===p&&(xt===2||xt===9)||o.cancelPendingCommit!==null)return x!==null&&x!==null&&dt(x),o.callbackNode=null,o.callbackPriority=0;if((w&3)===0||le(o,w)){if(p=w&-w,p===o.callbackPriority)return p;switch(x!==null&&dt(x),Ae(w)){case 2:case 8:w=j;break;case 32:w=he;break;case 268435456:w=Me;break;default:w=he}return x=Lx.bind(null,o),w=We(w,x),o.callbackPriority=p,o.callbackNode=w,p}return x!==null&&x!==null&&dt(x),o.callbackPriority=2,o.callbackNode=null,2}function Lx(o,p){if(Rn!==0&&Rn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var w=o.callbackNode;if(Th()&&o.callbackNode!==w)return null;var x=lt;return x=re(o,o===Bt?x:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x===0?null:(wx(o,x,p),Dx(o,Je()),o.callbackNode!=null&&o.callbackNode===w?Lx.bind(null,o):null)}function Fx(o,p){if(Th())return null;wx(o,p,!0)}function kO(){DO(function(){(vt&6)!==0?We(Te,TO):Bx()})}function Eg(){return Fs===0&&(Fs=ye()),Fs}function Ux(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Ff(""+o)}function Hx(o,p){var w=p.ownerDocument.createElement("input");return w.name=p.name,w.value=p.value,o.id&&w.setAttribute("form",o.id),p.parentNode.insertBefore(w,p),o=new FormData(o),w.parentNode.removeChild(w),o}function EO(o,p,w,x,O){if(p==="submit"&&w&&w.stateNode===O){var N=Ux((O[xn]||null).action),H=x.submitter;H&&(p=(p=H[xn]||null)?Ux(p.formAction):H.getAttribute("formAction"),p!==null&&(N=p,H=null));var V=new jf("action","action",null,x,O);o.push({event:V,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Fs!==0){var Q=H?Hx(O,H):new FormData(O);zy(w,{pending:!0,data:Q,method:O.method,action:N},null,Q)}}else typeof N=="function"&&(V.preventDefault(),Q=H?Hx(O,H):new FormData(O),zy(w,{pending:!0,data:Q,method:O.method,action:N},N,Q))},currentTarget:O}]})}}for(var Og=0;Og<fy.length;Og++){var Ag=fy[Og],OO=Ag.toLowerCase(),AO=Ag[0].toUpperCase()+Ag.slice(1);Gi(OO,"on"+AO)}Gi(wv,"onAnimationEnd"),Gi(vv,"onAnimationIteration"),Gi(xv,"onAnimationStart"),Gi("dblclick","onDoubleClick"),Gi("focusin","onFocus"),Gi("focusout","onBlur"),Gi($E,"onTransitionRun"),Gi(zE,"onTransitionStart"),Gi(GE,"onTransitionCancel"),Gi(_v,"onTransitionEnd"),$r("onMouseEnter",["mouseout","mouseover"]),$r("onMouseLeave",["mouseout","mouseover"]),$r("onPointerEnter",["pointerout","pointerover"]),$r("onPointerLeave",["pointerout","pointerover"]),wr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wr("onBeforeInput",["compositionend","keypress","textInput","paste"]),wr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cl));function qx(o,p){p=(p&4)!==0;for(var w=0;w<o.length;w++){var x=o[w],O=x.event;x=x.listeners;e:{var N=void 0;if(p)for(var H=x.length-1;0<=H;H--){var V=x[H],Q=V.instance,ue=V.currentTarget;if(V=V.listener,Q!==N&&O.isPropagationStopped())break e;N=V,O.currentTarget=ue;try{N(O)}catch(be){ph(be)}O.currentTarget=null,N=Q}else for(H=0;H<x.length;H++){if(V=x[H],Q=V.instance,ue=V.currentTarget,V=V.listener,Q!==N&&O.isPropagationStopped())break e;N=V,O.currentTarget=ue;try{N(O)}catch(be){ph(be)}O.currentTarget=null,N=Q}}}}function st(o,p){var w=p[mr];w===void 0&&(w=p[mr]=new Set);var x=o+"__bubble";w.has(x)||(jx(p,o,2,!1),w.add(x))}function Pg(o,p,w){var x=0;p&&(x|=4),jx(w,o,x,p)}var Oh="_reactListening"+Math.random().toString(36).slice(2);function Rg(o){if(!o[Oh]){o[Oh]=!0,xs.forEach(function(w){w!=="selectionchange"&&(PO.has(w)||Pg(w,!1,o),Pg(w,!0,o))});var p=o.nodeType===9?o:o.ownerDocument;p===null||p[Oh]||(p[Oh]=!0,Pg("selectionchange",!1,p))}}function jx(o,p,w,x){switch(f_(p)){case 2:var O=i5;break;case 8:O=r5;break;default:O=Wg}w=O.bind(null,p,w,o),O=void 0,!J0||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(O=!0),x?O!==void 0?o.addEventListener(p,w,{capture:!0,passive:O}):o.addEventListener(p,w,!0):O!==void 0?o.addEventListener(p,w,{passive:O}):o.addEventListener(p,w,!1)}function Ng(o,p,w,x,O){var N=x;if((p&1)===0&&(p&2)===0&&x!==null)e:for(;;){if(x===null)return;var H=x.tag;if(H===3||H===4){var V=x.stateNode.containerInfo;if(V===O)break;if(H===4)for(H=x.return;H!==null;){var Q=H.tag;if((Q===3||Q===4)&&H.stateNode.containerInfo===O)return;H=H.return}for(;V!==null;){if(H=Vr(V),H===null)return;if(Q=H.tag,Q===5||Q===6||Q===26||Q===27){x=N=H;continue e}V=V.parentNode}}x=x.return}Xw(function(){var ue=N,be=Q0(w),ve=[];e:{var fe=Sv.get(o);if(fe!==void 0){var pe=jf,je=o;switch(o){case"keypress":if(Hf(w)===0)break e;case"keydown":case"keyup":pe=IE;break;case"focusin":je="focus",pe=iy;break;case"focusout":je="blur",pe=iy;break;case"beforeblur":case"afterblur":pe=iy;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Zw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=fE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=EE;break;case wv:case vv:case xv:pe=yE;break;case _v:pe=AE;break;case"scroll":case"scrollend":pe=lE;break;case"wheel":pe=RE;break;case"copy":case"cut":case"paste":pe=bE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=ev;break;case"toggle":case"beforetoggle":pe=CE}var He=(p&4)!==0,Et=!He&&(o==="scroll"||o==="scrollend"),ae=He?fe!==null?fe+"Capture":null:fe;He=[];for(var ee=ue,oe;ee!==null;){var we=ee;if(oe=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||oe===null||ae===null||(we=Eu(ee,ae),we!=null&&He.push(ul(ee,we,oe))),Et)break;ee=ee.return}0<He.length&&(fe=new pe(fe,je,null,w,be),ve.push({event:fe,listeners:He}))}}if((p&7)===0){e:{if(fe=o==="mouseover"||o==="pointerover",pe=o==="mouseout"||o==="pointerout",fe&&w!==Y0&&(je=w.relatedTarget||w.fromElement)&&(Vr(je)||je[br]))break e;if((pe||fe)&&(fe=be.window===be?be:(fe=be.ownerDocument)?fe.defaultView||fe.parentWindow:window,pe?(je=w.relatedTarget||w.toElement,pe=ue,je=je?Vr(je):null,je!==null&&(Et=s(je),He=je.tag,je!==Et||He!==5&&He!==27&&He!==6)&&(je=null)):(pe=null,je=ue),pe!==je)){if(He=Zw,we="onMouseLeave",ae="onMouseEnter",ee="mouse",(o==="pointerout"||o==="pointerover")&&(He=ev,we="onPointerLeave",ae="onPointerEnter",ee="pointer"),Et=pe==null?fe:Da(pe),oe=je==null?fe:Da(je),fe=new He(we,ee+"leave",pe,w,be),fe.target=Et,fe.relatedTarget=oe,we=null,Vr(be)===ue&&(He=new He(ae,ee+"enter",je,w,be),He.target=oe,He.relatedTarget=Et,we=He),Et=we,pe&&je)t:{for(He=pe,ae=je,ee=0,oe=He;oe;oe=oc(oe))ee++;for(oe=0,we=ae;we;we=oc(we))oe++;for(;0<ee-oe;)He=oc(He),ee--;for(;0<oe-ee;)ae=oc(ae),oe--;for(;ee--;){if(He===ae||ae!==null&&He===ae.alternate)break t;He=oc(He),ae=oc(ae)}He=null}else He=null;pe!==null&&Vx(ve,fe,pe,He,!1),je!==null&&Et!==null&&Vx(ve,Et,je,He,!0)}}e:{if(fe=ue?Da(ue):window,pe=fe.nodeName&&fe.nodeName.toLowerCase(),pe==="select"||pe==="input"&&fe.type==="file")var Pe=cv;else if(sv(fe))if(uv)Pe=VE;else{Pe=qE;var it=HE}else pe=fe.nodeName,!pe||pe.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ue&&X0(ue.elementType)&&(Pe=cv):Pe=jE;if(Pe&&(Pe=Pe(o,ue))){ov(ve,Pe,w,be);break e}it&&it(o,fe,ue),o==="focusout"&&ue&&fe.type==="number"&&ue.memoizedProps.value!=null&&G0(fe,"number",fe.value)}switch(it=ue?Da(ue):window,o){case"focusin":(sv(it)||it.contentEditable==="true")&&(Lo=it,uy=ue,Bu=null);break;case"focusout":Bu=uy=Lo=null;break;case"mousedown":ly=!0;break;case"contextmenu":case"mouseup":case"dragend":ly=!1,bv(ve,w,be);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":bv(ve,w,be)}var Be;if(ay)e:{switch(o){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Do?rv(o,w)&&(qe="onCompositionEnd"):o==="keydown"&&w.keyCode===229&&(qe="onCompositionStart");qe&&(tv&&w.locale!=="ko"&&(Do||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Do&&(Be=Yw()):(La=be,ey="value"in La?La.value:La.textContent,Do=!0)),it=Ah(ue,qe),0<it.length&&(qe=new Jw(qe,o,null,w,be),ve.push({event:qe,listeners:it}),Be?qe.data=Be:(Be=av(w),Be!==null&&(qe.data=Be)))),(Be=BE?DE(o,w):LE(o,w))&&(qe=Ah(ue,"onBeforeInput"),0<qe.length&&(it=new Jw("onBeforeInput","beforeinput",null,w,be),ve.push({event:it,listeners:qe}),it.data=Be)),EO(ve,o,ue,w,be)}qx(ve,p)})}function ul(o,p,w){return{instance:o,listener:p,currentTarget:w}}function Ah(o,p){for(var w=p+"Capture",x=[];o!==null;){var O=o,N=O.stateNode;if(O=O.tag,O!==5&&O!==26&&O!==27||N===null||(O=Eu(o,w),O!=null&&x.unshift(ul(o,O,N)),O=Eu(o,p),O!=null&&x.push(ul(o,O,N))),o.tag===3)return x;o=o.return}return[]}function oc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Vx(o,p,w,x,O){for(var N=p._reactName,H=[];w!==null&&w!==x;){var V=w,Q=V.alternate,ue=V.stateNode;if(V=V.tag,Q!==null&&Q===x)break;V!==5&&V!==26&&V!==27||ue===null||(Q=ue,O?(ue=Eu(w,N),ue!=null&&H.unshift(ul(w,ue,Q))):O||(ue=Eu(w,N),ue!=null&&H.push(ul(w,ue,Q)))),w=w.return}H.length!==0&&o.push({event:p,listeners:H})}var RO=/\r\n?/g,NO=/\u0000|\uFFFD/g;function Kx(o){return(typeof o=="string"?o:""+o).replace(RO,`
`).replace(NO,"")}function Wx(o,p){return p=Kx(p),Kx(o)===p}function Ph(){}function kt(o,p,w,x,O,N){switch(w){case"children":typeof x=="string"?p==="body"||p==="textarea"&&x===""||Co(o,x):(typeof x=="number"||typeof x=="bigint")&&p!=="body"&&Co(o,""+x);break;case"className":Bf(o,"class",x);break;case"tabIndex":Bf(o,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Bf(o,w,x);break;case"style":zw(o,x,N);break;case"data":if(p!=="object"){Bf(o,"data",x);break}case"src":case"href":if(x===""&&(p!=="a"||w!=="href")){o.removeAttribute(w);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(w);break}x=Ff(""+x),o.setAttribute(w,x);break;case"action":case"formAction":if(typeof x=="function"){o.setAttribute(w,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(w==="formAction"?(p!=="input"&&kt(o,p,"name",O.name,O,null),kt(o,p,"formEncType",O.formEncType,O,null),kt(o,p,"formMethod",O.formMethod,O,null),kt(o,p,"formTarget",O.formTarget,O,null)):(kt(o,p,"encType",O.encType,O,null),kt(o,p,"method",O.method,O,null),kt(o,p,"target",O.target,O,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(w);break}x=Ff(""+x),o.setAttribute(w,x);break;case"onClick":x!=null&&(o.onclick=Ph);break;case"onScroll":x!=null&&st("scroll",o);break;case"onScrollEnd":x!=null&&st("scrollend",o);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(w=x.__html,w!=null){if(O.children!=null)throw Error(r(60));o.innerHTML=w}}break;case"multiple":o.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":o.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){o.removeAttribute("xlink:href");break}w=Ff(""+x),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",w);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(w,""+x):o.removeAttribute(w);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(w,""):o.removeAttribute(w);break;case"capture":case"download":x===!0?o.setAttribute(w,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(w,x):o.removeAttribute(w);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?o.setAttribute(w,x):o.removeAttribute(w);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?o.removeAttribute(w):o.setAttribute(w,x);break;case"popover":st("beforetoggle",o),st("toggle",o),Mf(o,"popover",x);break;case"xlinkActuate":zr(o,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":zr(o,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":zr(o,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":zr(o,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":zr(o,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":zr(o,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":zr(o,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":zr(o,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":zr(o,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Mf(o,"is",x);break;case"innerText":case"textContent":break;default:(!(2<w.length)||w[0]!=="o"&&w[0]!=="O"||w[1]!=="n"&&w[1]!=="N")&&(w=cE.get(w)||w,Mf(o,w,x))}}function Cg(o,p,w,x,O,N){switch(w){case"style":zw(o,x,N);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(w=x.__html,w!=null){if(O.children!=null)throw Error(r(60));o.innerHTML=w}}break;case"children":typeof x=="string"?Co(o,x):(typeof x=="number"||typeof x=="bigint")&&Co(o,""+x);break;case"onScroll":x!=null&&st("scroll",o);break;case"onScrollEnd":x!=null&&st("scrollend",o);break;case"onClick":x!=null&&(o.onclick=Ph);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_s.hasOwnProperty(w))e:{if(w[0]==="o"&&w[1]==="n"&&(O=w.endsWith("Capture"),p=w.slice(2,O?w.length-7:void 0),N=o[xn]||null,N=N!=null?N[w]:null,typeof N=="function"&&o.removeEventListener(p,N,O),typeof x=="function")){typeof N!="function"&&N!==null&&(w in o?o[w]=null:o.hasAttribute(w)&&o.removeAttribute(w)),o.addEventListener(p,x,O);break e}w in o?o[w]=x:x===!0?o.setAttribute(w,""):Mf(o,w,x)}}}function Nn(o,p,w){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":st("error",o),st("load",o);var x=!1,O=!1,N;for(N in w)if(w.hasOwnProperty(N)){var H=w[N];if(H!=null)switch(N){case"src":x=!0;break;case"srcSet":O=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,p));default:kt(o,p,N,H,w,null)}}O&&kt(o,p,"srcSet",w.srcSet,w,null),x&&kt(o,p,"src",w.src,w,null);return;case"input":st("invalid",o);var V=N=H=O=null,Q=null,ue=null;for(x in w)if(w.hasOwnProperty(x)){var be=w[x];if(be!=null)switch(x){case"name":O=be;break;case"type":H=be;break;case"checked":Q=be;break;case"defaultChecked":ue=be;break;case"value":N=be;break;case"defaultValue":V=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,p));break;default:kt(o,p,x,be,w,null)}}Vw(o,N,V,Q,ue,H,O,!1),Df(o);return;case"select":st("invalid",o),x=H=N=null;for(O in w)if(w.hasOwnProperty(O)&&(V=w[O],V!=null))switch(O){case"value":N=V;break;case"defaultValue":H=V;break;case"multiple":x=V;default:kt(o,p,O,V,w,null)}p=N,w=H,o.multiple=!!x,p!=null?No(o,!!x,p,!1):w!=null&&No(o,!!x,w,!0);return;case"textarea":st("invalid",o),N=O=x=null;for(H in w)if(w.hasOwnProperty(H)&&(V=w[H],V!=null))switch(H){case"value":x=V;break;case"defaultValue":O=V;break;case"children":N=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(r(91));break;default:kt(o,p,H,V,w,null)}Ww(o,x,O,N),Df(o);return;case"option":for(Q in w)if(w.hasOwnProperty(Q)&&(x=w[Q],x!=null))switch(Q){case"selected":o.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:kt(o,p,Q,x,w,null)}return;case"dialog":st("beforetoggle",o),st("toggle",o),st("cancel",o),st("close",o);break;case"iframe":case"object":st("load",o);break;case"video":case"audio":for(x=0;x<cl.length;x++)st(cl[x],o);break;case"image":st("error",o),st("load",o);break;case"details":st("toggle",o);break;case"embed":case"source":case"link":st("error",o),st("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in w)if(w.hasOwnProperty(ue)&&(x=w[ue],x!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,p));default:kt(o,p,ue,x,w,null)}return;default:if(X0(p)){for(be in w)w.hasOwnProperty(be)&&(x=w[be],x!==void 0&&Cg(o,p,be,x,w,void 0));return}}for(V in w)w.hasOwnProperty(V)&&(x=w[V],x!=null&&kt(o,p,V,x,w,null))}function CO(o,p,w,x){switch(p){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var O=null,N=null,H=null,V=null,Q=null,ue=null,be=null;for(pe in w){var ve=w[pe];if(w.hasOwnProperty(pe)&&ve!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":Q=ve;default:x.hasOwnProperty(pe)||kt(o,p,pe,null,x,ve)}}for(var fe in x){var pe=x[fe];if(ve=w[fe],x.hasOwnProperty(fe)&&(pe!=null||ve!=null))switch(fe){case"type":N=pe;break;case"name":O=pe;break;case"checked":ue=pe;break;case"defaultChecked":be=pe;break;case"value":H=pe;break;case"defaultValue":V=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,p));break;default:pe!==ve&&kt(o,p,fe,pe,x,ve)}}z0(o,H,V,Q,ue,be,N,O);return;case"select":pe=H=V=fe=null;for(N in w)if(Q=w[N],w.hasOwnProperty(N)&&Q!=null)switch(N){case"value":break;case"multiple":pe=Q;default:x.hasOwnProperty(N)||kt(o,p,N,null,x,Q)}for(O in x)if(N=x[O],Q=w[O],x.hasOwnProperty(O)&&(N!=null||Q!=null))switch(O){case"value":fe=N;break;case"defaultValue":V=N;break;case"multiple":H=N;default:N!==Q&&kt(o,p,O,N,x,Q)}p=V,w=H,x=pe,fe!=null?No(o,!!w,fe,!1):!!x!=!!w&&(p!=null?No(o,!!w,p,!0):No(o,!!w,w?[]:"",!1));return;case"textarea":pe=fe=null;for(V in w)if(O=w[V],w.hasOwnProperty(V)&&O!=null&&!x.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:kt(o,p,V,null,x,O)}for(H in x)if(O=x[H],N=w[H],x.hasOwnProperty(H)&&(O!=null||N!=null))switch(H){case"value":fe=O;break;case"defaultValue":pe=O;break;case"children":break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:O!==N&&kt(o,p,H,O,x,N)}Kw(o,fe,pe);return;case"option":for(var je in w)if(fe=w[je],w.hasOwnProperty(je)&&fe!=null&&!x.hasOwnProperty(je))switch(je){case"selected":o.selected=!1;break;default:kt(o,p,je,null,x,fe)}for(Q in x)if(fe=x[Q],pe=w[Q],x.hasOwnProperty(Q)&&fe!==pe&&(fe!=null||pe!=null))switch(Q){case"selected":o.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:kt(o,p,Q,fe,x,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var He in w)fe=w[He],w.hasOwnProperty(He)&&fe!=null&&!x.hasOwnProperty(He)&&kt(o,p,He,null,x,fe);for(ue in x)if(fe=x[ue],pe=w[ue],x.hasOwnProperty(ue)&&fe!==pe&&(fe!=null||pe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,p));break;default:kt(o,p,ue,fe,x,pe)}return;default:if(X0(p)){for(var Et in w)fe=w[Et],w.hasOwnProperty(Et)&&fe!==void 0&&!x.hasOwnProperty(Et)&&Cg(o,p,Et,void 0,x,fe);for(be in x)fe=x[be],pe=w[be],!x.hasOwnProperty(be)||fe===pe||fe===void 0&&pe===void 0||Cg(o,p,be,fe,x,pe);return}}for(var ae in w)fe=w[ae],w.hasOwnProperty(ae)&&fe!=null&&!x.hasOwnProperty(ae)&&kt(o,p,ae,null,x,fe);for(ve in x)fe=x[ve],pe=w[ve],!x.hasOwnProperty(ve)||fe===pe||fe==null&&pe==null||kt(o,p,ve,fe,x,pe)}var Mg=null,Bg=null;function Rh(o){return o.nodeType===9?o:o.ownerDocument}function $x(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function zx(o,p){if(o===0)switch(p){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&p==="foreignObject"?0:o}function Dg(o,p){return o==="textarea"||o==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.children=="bigint"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Lg=null;function MO(){var o=window.event;return o&&o.type==="popstate"?o===Lg?!1:(Lg=o,!0):(Lg=null,!1)}var Gx=typeof setTimeout=="function"?setTimeout:void 0,BO=typeof clearTimeout=="function"?clearTimeout:void 0,Xx=typeof Promise=="function"?Promise:void 0,DO=typeof queueMicrotask=="function"?queueMicrotask:typeof Xx<"u"?function(o){return Xx.resolve(null).then(o).catch(LO)}:Gx;function LO(o){setTimeout(function(){throw o})}function Ja(o){return o==="head"}function Yx(o,p){var w=p,x=0,O=0;do{var N=w.nextSibling;if(o.removeChild(w),N&&N.nodeType===8)if(w=N.data,w==="/$"){if(0<x&&8>x){w=x;var H=o.ownerDocument;if(w&1&&ll(H.documentElement),w&2&&ll(H.body),w&4)for(w=H.head,ll(w),H=w.firstChild;H;){var V=H.nextSibling,Q=H.nodeName;H[zi]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&H.rel.toLowerCase()==="stylesheet"||w.removeChild(H),H=V}}if(O===0){o.removeChild(N),ml(p);return}O--}else w==="$"||w==="$?"||w==="$!"?O++:x=w.charCodeAt(0)-48;else x=0;w=N}while(w);ml(p)}function Fg(o){var p=o.firstChild;for(p&&p.nodeType===10&&(p=p.nextSibling);p;){var w=p;switch(p=p.nextSibling,w.nodeName){case"HTML":case"HEAD":case"BODY":Fg(w),Po(w);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(w.rel.toLowerCase()==="stylesheet")continue}o.removeChild(w)}}function FO(o,p,w,x){for(;o.nodeType===1;){var O=w;if(o.nodeName.toLowerCase()!==p.toLowerCase()){if(!x&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(x){if(!o[zi])switch(p){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(N=o.getAttribute("rel"),N==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(N!==O.rel||o.getAttribute("href")!==(O.href==null||O.href===""?null:O.href)||o.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin)||o.getAttribute("title")!==(O.title==null?null:O.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(N=o.getAttribute("src"),(N!==(O.src==null?null:O.src)||o.getAttribute("type")!==(O.type==null?null:O.type)||o.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin))&&N&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(p==="input"&&o.type==="hidden"){var N=O.name==null?null:""+O.name;if(O.type==="hidden"&&o.getAttribute("name")===N)return o}else return o;if(o=Yi(o.nextSibling),o===null)break}return null}function UO(o,p,w){if(p==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!w||(o=Yi(o.nextSibling),o===null))return null;return o}function Ug(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function HO(o,p){var w=o.ownerDocument;if(o.data!=="$?"||w.readyState==="complete")p();else{var x=function(){p(),w.removeEventListener("DOMContentLoaded",x)};w.addEventListener("DOMContentLoaded",x),o._reactRetry=x}}function Yi(o){for(;o!=null;o=o.nextSibling){var p=o.nodeType;if(p===1||p===3)break;if(p===8){if(p=o.data,p==="$"||p==="$!"||p==="$?"||p==="F!"||p==="F")break;if(p==="/$")return null}}return o}var Hg=null;function Qx(o){o=o.previousSibling;for(var p=0;o;){if(o.nodeType===8){var w=o.data;if(w==="$"||w==="$!"||w==="$?"){if(p===0)return o;p--}else w==="/$"&&p++}o=o.previousSibling}return null}function Zx(o,p,w){switch(p=Rh(w),o){case"html":if(o=p.documentElement,!o)throw Error(r(452));return o;case"head":if(o=p.head,!o)throw Error(r(453));return o;case"body":if(o=p.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function ll(o){for(var p=o.attributes;p.length;)o.removeAttributeNode(p[0]);Po(o)}var Ii=new Map,Jx=new Set;function Nh(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var oa=q.d;q.d={f:qO,r:jO,D:VO,C:KO,L:WO,m:$O,X:GO,S:zO,M:XO};function qO(){var o=oa.f(),p=Sh();return o||p}function jO(o){var p=Kr(o);p!==null&&p.tag===5&&p.type==="form"?w1(p):oa.r(o)}var cc=typeof document>"u"?null:document;function e_(o,p,w){var x=cc;if(x&&typeof p=="string"&&p){var O=bi(p);O='link[rel="'+o+'"][href="'+O+'"]',typeof w=="string"&&(O+='[crossorigin="'+w+'"]'),Jx.has(O)||(Jx.add(O),o={rel:o,crossOrigin:w,href:p},x.querySelector(O)===null&&(p=x.createElement("link"),Nn(p,"link",o),Jt(p),x.head.appendChild(p)))}}function VO(o){oa.D(o),e_("dns-prefetch",o,null)}function KO(o,p){oa.C(o,p),e_("preconnect",o,p)}function WO(o,p,w){oa.L(o,p,w);var x=cc;if(x&&o&&p){var O='link[rel="preload"][as="'+bi(p)+'"]';p==="image"&&w&&w.imageSrcSet?(O+='[imagesrcset="'+bi(w.imageSrcSet)+'"]',typeof w.imageSizes=="string"&&(O+='[imagesizes="'+bi(w.imageSizes)+'"]')):O+='[href="'+bi(o)+'"]';var N=O;switch(p){case"style":N=uc(o);break;case"script":N=lc(o)}Ii.has(N)||(o=h({rel:"preload",href:p==="image"&&w&&w.imageSrcSet?void 0:o,as:p},w),Ii.set(N,o),x.querySelector(O)!==null||p==="style"&&x.querySelector(dl(N))||p==="script"&&x.querySelector(fl(N))||(p=x.createElement("link"),Nn(p,"link",o),Jt(p),x.head.appendChild(p)))}}function $O(o,p){oa.m(o,p);var w=cc;if(w&&o){var x=p&&typeof p.as=="string"?p.as:"script",O='link[rel="modulepreload"][as="'+bi(x)+'"][href="'+bi(o)+'"]',N=O;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=lc(o)}if(!Ii.has(N)&&(o=h({rel:"modulepreload",href:o},p),Ii.set(N,o),w.querySelector(O)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(w.querySelector(fl(N)))return}x=w.createElement("link"),Nn(x,"link",o),Jt(x),w.head.appendChild(x)}}}function zO(o,p,w){oa.S(o,p,w);var x=cc;if(x&&o){var O=Wr(x).hoistableStyles,N=uc(o);p=p||"default";var H=O.get(N);if(!H){var V={loading:0,preload:null};if(H=x.querySelector(dl(N)))V.loading=5;else{o=h({rel:"stylesheet",href:o,"data-precedence":p},w),(w=Ii.get(N))&&qg(o,w);var Q=H=x.createElement("link");Jt(Q),Nn(Q,"link",o),Q._p=new Promise(function(ue,be){Q.onload=ue,Q.onerror=be}),Q.addEventListener("load",function(){V.loading|=1}),Q.addEventListener("error",function(){V.loading|=2}),V.loading|=4,Ch(H,p,x)}H={type:"stylesheet",instance:H,count:1,state:V},O.set(N,H)}}}function GO(o,p){oa.X(o,p);var w=cc;if(w&&o){var x=Wr(w).hoistableScripts,O=lc(o),N=x.get(O);N||(N=w.querySelector(fl(O)),N||(o=h({src:o,async:!0},p),(p=Ii.get(O))&&jg(o,p),N=w.createElement("script"),Jt(N),Nn(N,"link",o),w.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(O,N))}}function XO(o,p){oa.M(o,p);var w=cc;if(w&&o){var x=Wr(w).hoistableScripts,O=lc(o),N=x.get(O);N||(N=w.querySelector(fl(O)),N||(o=h({src:o,async:!0,type:"module"},p),(p=Ii.get(O))&&jg(o,p),N=w.createElement("script"),Jt(N),Nn(N,"link",o),w.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(O,N))}}function t_(o,p,w,x){var O=(O=Ie.current)?Nh(O):null;if(!O)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof w.precedence=="string"&&typeof w.href=="string"?(p=uc(w.href),w=Wr(O).hoistableStyles,x=w.get(p),x||(x={type:"style",instance:null,count:0,state:null},w.set(p,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(w.rel==="stylesheet"&&typeof w.href=="string"&&typeof w.precedence=="string"){o=uc(w.href);var N=Wr(O).hoistableStyles,H=N.get(o);if(H||(O=O.ownerDocument||O,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(o,H),(N=O.querySelector(dl(o)))&&!N._p&&(H.instance=N,H.state.loading=5),Ii.has(o)||(w={rel:"preload",as:"style",href:w.href,crossOrigin:w.crossOrigin,integrity:w.integrity,media:w.media,hrefLang:w.hrefLang,referrerPolicy:w.referrerPolicy},Ii.set(o,w),N||YO(O,o,w,H.state))),p&&x===null)throw Error(r(528,""));return H}if(p&&x!==null)throw Error(r(529,""));return null;case"script":return p=w.async,w=w.src,typeof w=="string"&&p&&typeof p!="function"&&typeof p!="symbol"?(p=lc(w),w=Wr(O).hoistableScripts,x=w.get(p),x||(x={type:"script",instance:null,count:0,state:null},w.set(p,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function uc(o){return'href="'+bi(o)+'"'}function dl(o){return'link[rel="stylesheet"]['+o+"]"}function n_(o){return h({},o,{"data-precedence":o.precedence,precedence:null})}function YO(o,p,w,x){o.querySelector('link[rel="preload"][as="style"]['+p+"]")?x.loading=1:(p=o.createElement("link"),x.preload=p,p.addEventListener("load",function(){return x.loading|=1}),p.addEventListener("error",function(){return x.loading|=2}),Nn(p,"link",w),Jt(p),o.head.appendChild(p))}function lc(o){return'[src="'+bi(o)+'"]'}function fl(o){return"script[async]"+o}function i_(o,p,w){if(p.count++,p.instance===null)switch(p.type){case"style":var x=o.querySelector('style[data-href~="'+bi(w.href)+'"]');if(x)return p.instance=x,Jt(x),x;var O=h({},w,{"data-href":w.href,"data-precedence":w.precedence,href:null,precedence:null});return x=(o.ownerDocument||o).createElement("style"),Jt(x),Nn(x,"style",O),Ch(x,w.precedence,o),p.instance=x;case"stylesheet":O=uc(w.href);var N=o.querySelector(dl(O));if(N)return p.state.loading|=4,p.instance=N,Jt(N),N;x=n_(w),(O=Ii.get(O))&&qg(x,O),N=(o.ownerDocument||o).createElement("link"),Jt(N);var H=N;return H._p=new Promise(function(V,Q){H.onload=V,H.onerror=Q}),Nn(N,"link",x),p.state.loading|=4,Ch(N,w.precedence,o),p.instance=N;case"script":return N=lc(w.src),(O=o.querySelector(fl(N)))?(p.instance=O,Jt(O),O):(x=w,(O=Ii.get(N))&&(x=h({},w),jg(x,O)),o=o.ownerDocument||o,O=o.createElement("script"),Jt(O),Nn(O,"link",x),o.head.appendChild(O),p.instance=O);case"void":return null;default:throw Error(r(443,p.type))}else p.type==="stylesheet"&&(p.state.loading&4)===0&&(x=p.instance,p.state.loading|=4,Ch(x,w.precedence,o));return p.instance}function Ch(o,p,w){for(var x=w.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),O=x.length?x[x.length-1]:null,N=O,H=0;H<x.length;H++){var V=x[H];if(V.dataset.precedence===p)N=V;else if(N!==O)break}N?N.parentNode.insertBefore(o,N.nextSibling):(p=w.nodeType===9?w.head:w,p.insertBefore(o,p.firstChild))}function qg(o,p){o.crossOrigin==null&&(o.crossOrigin=p.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=p.referrerPolicy),o.title==null&&(o.title=p.title)}function jg(o,p){o.crossOrigin==null&&(o.crossOrigin=p.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=p.referrerPolicy),o.integrity==null&&(o.integrity=p.integrity)}var Mh=null;function r_(o,p,w){if(Mh===null){var x=new Map,O=Mh=new Map;O.set(w,x)}else O=Mh,x=O.get(w),x||(x=new Map,O.set(w,x));if(x.has(o))return x;for(x.set(o,null),w=w.getElementsByTagName(o),O=0;O<w.length;O++){var N=w[O];if(!(N[zi]||N[Zt]||o==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var H=N.getAttribute(p)||"";H=o+H;var V=x.get(H);V?V.push(N):x.set(H,[N])}}return x}function a_(o,p,w){o=o.ownerDocument||o,o.head.insertBefore(w,p==="title"?o.querySelector("head > title"):null)}function QO(o,p,w){if(w===1||p.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof p.precedence!="string"||typeof p.href!="string"||p.href==="")break;return!0;case"link":if(typeof p.rel!="string"||typeof p.href!="string"||p.href===""||p.onLoad||p.onError)break;switch(p.rel){case"stylesheet":return o=p.disabled,typeof p.precedence=="string"&&o==null;default:return!0}case"script":if(p.async&&typeof p.async!="function"&&typeof p.async!="symbol"&&!p.onLoad&&!p.onError&&p.src&&typeof p.src=="string")return!0}return!1}function s_(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var hl=null;function ZO(){}function JO(o,p,w){if(hl===null)throw Error(r(475));var x=hl;if(p.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var O=uc(w.href),N=o.querySelector(dl(O));if(N){o=N._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(x.count++,x=Bh.bind(x),o.then(x,x)),p.state.loading|=4,p.instance=N,Jt(N);return}N=o.ownerDocument||o,w=n_(w),(O=Ii.get(O))&&qg(w,O),N=N.createElement("link"),Jt(N);var H=N;H._p=new Promise(function(V,Q){H.onload=V,H.onerror=Q}),Nn(N,"link",w),p.instance=N}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(p,o),(o=p.state.preload)&&(p.state.loading&3)===0&&(x.count++,p=Bh.bind(x),o.addEventListener("load",p),o.addEventListener("error",p))}}function e5(){if(hl===null)throw Error(r(475));var o=hl;return o.stylesheets&&o.count===0&&Vg(o,o.stylesheets),0<o.count?function(p){var w=setTimeout(function(){if(o.stylesheets&&Vg(o,o.stylesheets),o.unsuspend){var x=o.unsuspend;o.unsuspend=null,x()}},6e4);return o.unsuspend=p,function(){o.unsuspend=null,clearTimeout(w)}}:null}function Bh(){if(this.count--,this.count===0){if(this.stylesheets)Vg(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Dh=null;function Vg(o,p){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Dh=new Map,p.forEach(t5,o),Dh=null,Bh.call(o))}function t5(o,p){if(!(p.state.loading&4)){var w=Dh.get(o);if(w)var x=w.get(null);else{w=new Map,Dh.set(o,w);for(var O=o.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<O.length;N++){var H=O[N];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(w.set(H.dataset.precedence,H),x=H)}x&&w.set(null,x)}O=p.instance,H=O.getAttribute("data-precedence"),N=w.get(H)||x,N===x&&w.set(null,O),w.set(H,O),this.count++,x=Bh.bind(this),O.addEventListener("load",x),O.addEventListener("error",x),N?N.parentNode.insertBefore(O,N.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(O,o.firstChild)),p.state.loading|=4}}var pl={$$typeof:S,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function n5(o,p,w,x,O,N,H,V){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fe(0),this.hiddenUpdates=Fe(null),this.identifierPrefix=x,this.onUncaughtError=O,this.onCaughtError=N,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function o_(o,p,w,x,O,N,H,V,Q,ue,be,ve){return o=new n5(o,p,w,H,V,Q,ue,ve),p=1,N===!0&&(p|=24),N=ti(3,null,null,p),o.current=N,N.stateNode=o,p=Iy(),p.refCount++,o.pooledCache=p,p.refCount++,N.memoizedState={element:x,isDehydrated:w,cache:p},Oy(N),o}function c_(o){return o?(o=qo,o):qo}function u_(o,p,w,x,O,N){O=c_(O),x.context===null?x.context=O:x.pendingContext=O,x=Ha(p),x.payload={element:w},N=N===void 0?null:N,N!==null&&(x.callback=N),w=qa(o,x,p),w!==null&&(si(w,o,p),Ku(w,o,p))}function l_(o,p){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var w=o.retryLane;o.retryLane=w!==0&&w<p?w:p}}function Kg(o,p){l_(o,p),(o=o.alternate)&&l_(o,p)}function d_(o){if(o.tag===13){var p=Ho(o,67108864);p!==null&&si(p,o,67108864),Kg(o,67108864)}}var Lh=!0;function i5(o,p,w,x){var O=L.T;L.T=null;var N=q.p;try{q.p=2,Wg(o,p,w,x)}finally{q.p=N,L.T=O}}function r5(o,p,w,x){var O=L.T;L.T=null;var N=q.p;try{q.p=8,Wg(o,p,w,x)}finally{q.p=N,L.T=O}}function Wg(o,p,w,x){if(Lh){var O=$g(x);if(O===null)Ng(o,p,x,Fh,w),h_(o,x);else if(s5(O,o,p,w,x))x.stopPropagation();else if(h_(o,x),p&4&&-1<a5.indexOf(o)){for(;O!==null;){var N=Kr(O);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var H=X(N.pendingLanes);if(H!==0){var V=N;for(V.pendingLanes|=2,V.entangledLanes|=2;H;){var Q=1<<31-qt(H);V.entanglements[1]|=Q,H&=~Q}Ir(N),(vt&6)===0&&(xh=Je()+500,ol(0))}}break;case 13:V=Ho(N,2),V!==null&&si(V,N,2),Sh(),Kg(N,2)}if(N=$g(x),N===null&&Ng(o,p,x,Fh,w),N===O)break;O=N}O!==null&&x.stopPropagation()}else Ng(o,p,x,null,w)}}function $g(o){return o=Q0(o),zg(o)}var Fh=null;function zg(o){if(Fh=null,o=Vr(o),o!==null){var p=s(o);if(p===null)o=null;else{var w=p.tag;if(w===13){if(o=a(p),o!==null)return o;o=null}else if(w===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;o=null}else p!==o&&(o=null)}}return Fh=o,null}function f_(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(At()){case Te:return 2;case j:return 8;case he:case de:return 32;case Me:return 268435456;default:return 32}default:return 32}}var Gg=!1,es=null,ts=null,ns=null,yl=new Map,gl=new Map,is=[],a5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function h_(o,p){switch(o){case"focusin":case"focusout":es=null;break;case"dragenter":case"dragleave":ts=null;break;case"mouseover":case"mouseout":ns=null;break;case"pointerover":case"pointerout":yl.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(p.pointerId)}}function bl(o,p,w,x,O,N){return o===null||o.nativeEvent!==N?(o={blockedOn:p,domEventName:w,eventSystemFlags:x,nativeEvent:N,targetContainers:[O]},p!==null&&(p=Kr(p),p!==null&&d_(p)),o):(o.eventSystemFlags|=x,p=o.targetContainers,O!==null&&p.indexOf(O)===-1&&p.push(O),o)}function s5(o,p,w,x,O){switch(p){case"focusin":return es=bl(es,o,p,w,x,O),!0;case"dragenter":return ts=bl(ts,o,p,w,x,O),!0;case"mouseover":return ns=bl(ns,o,p,w,x,O),!0;case"pointerover":var N=O.pointerId;return yl.set(N,bl(yl.get(N)||null,o,p,w,x,O)),!0;case"gotpointercapture":return N=O.pointerId,gl.set(N,bl(gl.get(N)||null,o,p,w,x,O)),!0}return!1}function p_(o){var p=Vr(o.target);if(p!==null){var w=s(p);if(w!==null){if(p=w.tag,p===13){if(p=a(w),p!==null){o.blockedOn=p,gr(o.priority,function(){if(w.tag===13){var x=ai();x=mt(x);var O=Ho(w,x);O!==null&&si(O,w,x),Kg(w,x)}});return}}else if(p===3&&w.stateNode.current.memoizedState.isDehydrated){o.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Uh(o){if(o.blockedOn!==null)return!1;for(var p=o.targetContainers;0<p.length;){var w=$g(o.nativeEvent);if(w===null){w=o.nativeEvent;var x=new w.constructor(w.type,w);Y0=x,w.target.dispatchEvent(x),Y0=null}else return p=Kr(w),p!==null&&d_(p),o.blockedOn=w,!1;p.shift()}return!0}function y_(o,p,w){Uh(o)&&w.delete(p)}function o5(){Gg=!1,es!==null&&Uh(es)&&(es=null),ts!==null&&Uh(ts)&&(ts=null),ns!==null&&Uh(ns)&&(ns=null),yl.forEach(y_),gl.forEach(y_)}function Hh(o,p){o.blockedOn===p&&(o.blockedOn=null,Gg||(Gg=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,o5)))}var qh=null;function g_(o){qh!==o&&(qh=o,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){qh===o&&(qh=null);for(var p=0;p<o.length;p+=3){var w=o[p],x=o[p+1],O=o[p+2];if(typeof x!="function"){if(zg(x||w)===null)continue;break}var N=Kr(w);N!==null&&(o.splice(p,3),p-=3,zy(N,{pending:!0,data:O,method:w.method,action:x},x,O))}}))}function ml(o){function p(Q){return Hh(Q,o)}es!==null&&Hh(es,o),ts!==null&&Hh(ts,o),ns!==null&&Hh(ns,o),yl.forEach(p),gl.forEach(p);for(var w=0;w<is.length;w++){var x=is[w];x.blockedOn===o&&(x.blockedOn=null)}for(;0<is.length&&(w=is[0],w.blockedOn===null);)p_(w),w.blockedOn===null&&is.shift();if(w=(o.ownerDocument||o).$$reactFormReplay,w!=null)for(x=0;x<w.length;x+=3){var O=w[x],N=w[x+1],H=O[xn]||null;if(typeof N=="function")H||g_(w);else if(H){var V=null;if(N&&N.hasAttribute("formAction")){if(O=N,H=N[xn]||null)V=H.formAction;else if(zg(O)!==null)continue}else V=H.action;typeof V=="function"?w[x+1]=V:(w.splice(x,3),x-=3),g_(w)}}}function Xg(o){this._internalRoot=o}jh.prototype.render=Xg.prototype.render=function(o){var p=this._internalRoot;if(p===null)throw Error(r(409));var w=p.current,x=ai();u_(w,x,o,p,null,null)},jh.prototype.unmount=Xg.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var p=o.containerInfo;u_(o.current,2,null,o,null,null),Sh(),p[br]=null}};function jh(o){this._internalRoot=o}jh.prototype.unstable_scheduleHydration=function(o){if(o){var p=nt();o={blockedOn:null,target:o,priority:p};for(var w=0;w<is.length&&p!==0&&p<is[w].priority;w++);is.splice(w,0,o),w===0&&p_(o)}};var b_=e.version;if(b_!=="19.1.0")throw Error(r(527,b_,"19.1.0"));q.findDOMNode=function(o){var p=o._reactInternals;if(p===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=u(p),o=o!==null?l(o):null,o=o===null?null:o.stateNode,o};var c5={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vh.isDisabled&&Vh.supportsFiber)try{wn=Vh.inject(c5),Dt=Vh}catch{}}return vl.createRoot=function(o,p){if(!t(o))throw Error(r(299));var w=!1,x="",O=C1,N=M1,H=B1,V=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(x=p.identifierPrefix),p.onUncaughtError!==void 0&&(O=p.onUncaughtError),p.onCaughtError!==void 0&&(N=p.onCaughtError),p.onRecoverableError!==void 0&&(H=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(V=p.unstable_transitionCallbacks)),p=o_(o,1,!1,null,null,w,x,O,N,H,V,null),o[br]=p.current,Rg(o),new Xg(p)},vl.hydrateRoot=function(o,p,w){if(!t(o))throw Error(r(299));var x=!1,O="",N=C1,H=M1,V=B1,Q=null,ue=null;return w!=null&&(w.unstable_strictMode===!0&&(x=!0),w.identifierPrefix!==void 0&&(O=w.identifierPrefix),w.onUncaughtError!==void 0&&(N=w.onUncaughtError),w.onCaughtError!==void 0&&(H=w.onCaughtError),w.onRecoverableError!==void 0&&(V=w.onRecoverableError),w.unstable_transitionCallbacks!==void 0&&(Q=w.unstable_transitionCallbacks),w.formState!==void 0&&(ue=w.formState)),p=o_(o,1,!0,p,w??null,x,O,N,H,V,Q,ue),p.context=c_(null),w=p.current,x=ai(),x=mt(x),O=Ha(x),O.callback=null,qa(w,O,x),w=x,p.current.lanes=w,Ve(p,w),Ir(p),o[br]=p.current,Rg(o),new jh(p)},vl.version="19.1.0",vl}var E_;function v5(){if(E_)return Zg.exports;E_=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Zg.exports=w5(),Zg.exports}var x5=v5();const of={black:"#000",white:"#fff"},dc={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},fc={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},hc={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},pc={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},yc={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},xl={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},_5={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function hs(i,...e){const n=new URL(`https://mui.com/production-error/?code=${i}`);return e.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${i}; visit ${n} for the full message.`}const Cr="$$material";function Kp(){return Kp=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Kp.apply(null,arguments)}function S5(i){if(i.sheet)return i.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===i)return document.styleSheets[e]}function I5(i){var e=document.createElement("style");return e.setAttribute("data-emotion",i.key),i.nonce!==void 0&&e.setAttribute("nonce",i.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var T5=function(){function i(n){var r=this;this._insertTag=function(t){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(t,s),r.tags.push(t)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=i.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(I5(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var s=S5(t);try{s.insertRule(r,s.cssRules.length)}catch{}}else t.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var t;return(t=r.parentNode)==null?void 0:t.removeChild(r)}),this.tags=[],this.ctr=0},i}(),Dn="-ms-",Wp="-moz-",gt="-webkit-",q8="comm",Um="rule",Hm="decl",k5="@import",j8="@keyframes",E5="@layer",O5=Math.abs,o0=String.fromCharCode,A5=Object.assign;function P5(i,e){return Cn(i,0)^45?(((e<<2^Cn(i,0))<<2^Cn(i,1))<<2^Cn(i,2))<<2^Cn(i,3):0}function V8(i){return i.trim()}function R5(i,e){return(i=e.exec(i))?i[0]:i}function bt(i,e,n){return i.replace(e,n)}function em(i,e){return i.indexOf(e)}function Cn(i,e){return i.charCodeAt(e)|0}function cf(i,e,n){return i.slice(e,n)}function Ar(i){return i.length}function qm(i){return i.length}function Kh(i,e){return e.push(i),i}function N5(i,e){return i.map(e).join("")}var c0=1,lu=1,K8=0,Qn=0,ln=0,wu="";function u0(i,e,n,r,t,s,a){return{value:i,root:e,parent:n,type:r,props:t,children:s,line:c0,column:lu,length:a,return:""}}function _l(i,e){return A5(u0("",null,null,"",null,null,0),i,{length:-i.length},e)}function C5(){return ln}function M5(){return ln=Qn>0?Cn(wu,--Qn):0,lu--,ln===10&&(lu=1,c0--),ln}function pi(){return ln=Qn<K8?Cn(wu,Qn++):0,lu++,ln===10&&(lu=1,c0++),ln}function Mr(){return Cn(wu,Qn)}function Bp(){return Qn}function gf(i,e){return cf(wu,i,e)}function uf(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function W8(i){return c0=lu=1,K8=Ar(wu=i),Qn=0,[]}function $8(i){return wu="",i}function Dp(i){return V8(gf(Qn-1,tm(i===91?i+2:i===40?i+1:i)))}function B5(i){for(;(ln=Mr())&&ln<33;)pi();return uf(i)>2||uf(ln)>3?"":" "}function D5(i,e){for(;--e&&pi()&&!(ln<48||ln>102||ln>57&&ln<65||ln>70&&ln<97););return gf(i,Bp()+(e<6&&Mr()==32&&pi()==32))}function tm(i){for(;pi();)switch(ln){case i:return Qn;case 34:case 39:i!==34&&i!==39&&tm(ln);break;case 40:i===41&&tm(i);break;case 92:pi();break}return Qn}function L5(i,e){for(;pi()&&i+ln!==57;)if(i+ln===84&&Mr()===47)break;return"/*"+gf(e,Qn-1)+"*"+o0(i===47?i:pi())}function F5(i){for(;!uf(Mr());)pi();return gf(i,Qn)}function U5(i){return $8(Lp("",null,null,null,[""],i=W8(i),0,[0],i))}function Lp(i,e,n,r,t,s,a,c,u){for(var l=0,h=0,f=a,m=0,d=0,y=0,b=1,g=1,v=1,_=0,S="",I=t,A=s,R=r,E=S;g;)switch(y=_,_=pi()){case 40:if(y!=108&&Cn(E,f-1)==58){em(E+=bt(Dp(_),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:E+=Dp(_);break;case 9:case 10:case 13:case 32:E+=B5(y);break;case 92:E+=D5(Bp()-1,7);continue;case 47:switch(Mr()){case 42:case 47:Kh(H5(L5(pi(),Bp()),e,n),u);break;default:E+="/"}break;case 123*b:c[l++]=Ar(E)*v;case 125*b:case 59:case 0:switch(_){case 0:case 125:g=0;case 59+h:v==-1&&(E=bt(E,/\f/g,"")),d>0&&Ar(E)-f&&Kh(d>32?A_(E+";",r,n,f-1):A_(bt(E," ","")+";",r,n,f-2),u);break;case 59:E+=";";default:if(Kh(R=O_(E,e,n,l,h,t,c,S,I=[],A=[],f),s),_===123)if(h===0)Lp(E,e,R,R,I,s,f,c,A);else switch(m===99&&Cn(E,3)===110?100:m){case 100:case 108:case 109:case 115:Lp(i,R,R,r&&Kh(O_(i,R,R,0,0,t,c,S,t,I=[],f),A),t,A,f,c,r?I:A);break;default:Lp(E,R,R,R,[""],A,0,c,A)}}l=h=d=0,b=v=1,S=E="",f=a;break;case 58:f=1+Ar(E),d=y;default:if(b<1){if(_==123)--b;else if(_==125&&b++==0&&M5()==125)continue}switch(E+=o0(_),_*b){case 38:v=h>0?1:(E+="\f",-1);break;case 44:c[l++]=(Ar(E)-1)*v,v=1;break;case 64:Mr()===45&&(E+=Dp(pi())),m=Mr(),h=f=Ar(S=E+=F5(Bp())),_++;break;case 45:y===45&&Ar(E)==2&&(b=0)}}return s}function O_(i,e,n,r,t,s,a,c,u,l,h){for(var f=t-1,m=t===0?s:[""],d=qm(m),y=0,b=0,g=0;y<r;++y)for(var v=0,_=cf(i,f+1,f=O5(b=a[y])),S=i;v<d;++v)(S=V8(b>0?m[v]+" "+_:bt(_,/&\f/g,m[v])))&&(u[g++]=S);return u0(i,e,n,t===0?Um:c,u,l,h)}function H5(i,e,n){return u0(i,e,n,q8,o0(C5()),cf(i,2,-2),0)}function A_(i,e,n,r){return u0(i,e,n,Hm,cf(i,0,r),cf(i,r+1,-1),r)}function au(i,e){for(var n="",r=qm(i),t=0;t<r;t++)n+=e(i[t],t,i,e)||"";return n}function q5(i,e,n,r){switch(i.type){case E5:if(i.children.length)break;case k5:case Hm:return i.return=i.return||i.value;case q8:return"";case j8:return i.return=i.value+"{"+au(i.children,r)+"}";case Um:i.value=i.props.join(",")}return Ar(n=au(i.children,r))?i.return=i.value+"{"+n+"}":""}function j5(i){var e=qm(i);return function(n,r,t,s){for(var a="",c=0;c<e;c++)a+=i[c](n,r,t,s)||"";return a}}function V5(i){return function(e){e.root||(e=e.return)&&i(e)}}function z8(i){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=i(n)),e[n]}}var K5=function(e,n,r){for(var t=0,s=0;t=s,s=Mr(),t===38&&s===12&&(n[r]=1),!uf(s);)pi();return gf(e,Qn)},W5=function(e,n){var r=-1,t=44;do switch(uf(t)){case 0:t===38&&Mr()===12&&(n[r]=1),e[r]+=K5(Qn-1,n,r);break;case 2:e[r]+=Dp(t);break;case 4:if(t===44){e[++r]=Mr()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=o0(t)}while(t=pi());return e},$5=function(e,n){return $8(W5(W8(e),n))},P_=new WeakMap,z5=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,t=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!P_.get(r))&&!t){P_.set(e,!0);for(var s=[],a=$5(n,s),c=r.props,u=0,l=0;u<a.length;u++)for(var h=0;h<c.length;h++,l++)e.props[l]=s[u]?a[u].replace(/&\f/g,c[h]):c[h]+" "+a[u]}}},G5=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function G8(i,e){switch(P5(i,e)){case 5103:return gt+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return gt+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return gt+i+Wp+i+Dn+i+i;case 6828:case 4268:return gt+i+Dn+i+i;case 6165:return gt+i+Dn+"flex-"+i+i;case 5187:return gt+i+bt(i,/(\w+).+(:[^]+)/,gt+"box-$1$2"+Dn+"flex-$1$2")+i;case 5443:return gt+i+Dn+"flex-item-"+bt(i,/flex-|-self/,"")+i;case 4675:return gt+i+Dn+"flex-line-pack"+bt(i,/align-content|flex-|-self/,"")+i;case 5548:return gt+i+Dn+bt(i,"shrink","negative")+i;case 5292:return gt+i+Dn+bt(i,"basis","preferred-size")+i;case 6060:return gt+"box-"+bt(i,"-grow","")+gt+i+Dn+bt(i,"grow","positive")+i;case 4554:return gt+bt(i,/([^-])(transform)/g,"$1"+gt+"$2")+i;case 6187:return bt(bt(bt(i,/(zoom-|grab)/,gt+"$1"),/(image-set)/,gt+"$1"),i,"")+i;case 5495:case 3959:return bt(i,/(image-set\([^]*)/,gt+"$1$`$1");case 4968:return bt(bt(i,/(.+:)(flex-)?(.*)/,gt+"box-pack:$3"+Dn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+gt+i+i;case 4095:case 3583:case 4068:case 2532:return bt(i,/(.+)-inline(.+)/,gt+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ar(i)-1-e>6)switch(Cn(i,e+1)){case 109:if(Cn(i,e+4)!==45)break;case 102:return bt(i,/(.+:)(.+)-([^]+)/,"$1"+gt+"$2-$3$1"+Wp+(Cn(i,e+3)==108?"$3":"$2-$3"))+i;case 115:return~em(i,"stretch")?G8(bt(i,"stretch","fill-available"),e)+i:i}break;case 4949:if(Cn(i,e+1)!==115)break;case 6444:switch(Cn(i,Ar(i)-3-(~em(i,"!important")&&10))){case 107:return bt(i,":",":"+gt)+i;case 101:return bt(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+gt+(Cn(i,14)===45?"inline-":"")+"box$3$1"+gt+"$2$3$1"+Dn+"$2box$3")+i}break;case 5936:switch(Cn(i,e+11)){case 114:return gt+i+Dn+bt(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return gt+i+Dn+bt(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return gt+i+Dn+bt(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return gt+i+Dn+i+i}return i}var X5=function(e,n,r,t){if(e.length>-1&&!e.return)switch(e.type){case Hm:e.return=G8(e.value,e.length);break;case j8:return au([_l(e,{value:bt(e.value,"@","@"+gt)})],t);case Um:if(e.length)return N5(e.props,function(s){switch(R5(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return au([_l(e,{props:[bt(s,/:(read-\w+)/,":"+Wp+"$1")]})],t);case"::placeholder":return au([_l(e,{props:[bt(s,/:(plac\w+)/,":"+gt+"input-$1")]}),_l(e,{props:[bt(s,/:(plac\w+)/,":"+Wp+"$1")]}),_l(e,{props:[bt(s,/:(plac\w+)/,Dn+"input-$1")]})],t)}return""})}},Y5=[X5],Q5=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(b){var g=b.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(b),b.setAttribute("data-s",""))})}var t=e.stylisPlugins||Y5,s={},a,c=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(b){for(var g=b.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)s[g[v]]=!0;c.push(b)});var u,l=[z5,G5];{var h,f=[q5,V5(function(b){h.insert(b)})],m=j5(l.concat(t,f)),d=function(g){return au(U5(g),m)};u=function(g,v,_,S){h=_,d(g?g+"{"+v.styles+"}":v.styles),S&&(y.inserted[v.name]=!0)}}var y={key:n,sheet:new T5({key:n,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:u};return y.sheet.hydrate(c),y},nb={exports:{}},wt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function Z5(){if(R_)return wt;R_=1;var i=typeof Symbol=="function"&&Symbol.for,e=i?Symbol.for("react.element"):60103,n=i?Symbol.for("react.portal"):60106,r=i?Symbol.for("react.fragment"):60107,t=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,a=i?Symbol.for("react.provider"):60109,c=i?Symbol.for("react.context"):60110,u=i?Symbol.for("react.async_mode"):60111,l=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,m=i?Symbol.for("react.suspense_list"):60120,d=i?Symbol.for("react.memo"):60115,y=i?Symbol.for("react.lazy"):60116,b=i?Symbol.for("react.block"):60121,g=i?Symbol.for("react.fundamental"):60117,v=i?Symbol.for("react.responder"):60118,_=i?Symbol.for("react.scope"):60119;function S(A){if(typeof A=="object"&&A!==null){var R=A.$$typeof;switch(R){case e:switch(A=A.type,A){case u:case l:case r:case s:case t:case f:return A;default:switch(A=A&&A.$$typeof,A){case c:case h:case y:case d:case a:return A;default:return R}}case n:return R}}}function I(A){return S(A)===l}return wt.AsyncMode=u,wt.ConcurrentMode=l,wt.ContextConsumer=c,wt.ContextProvider=a,wt.Element=e,wt.ForwardRef=h,wt.Fragment=r,wt.Lazy=y,wt.Memo=d,wt.Portal=n,wt.Profiler=s,wt.StrictMode=t,wt.Suspense=f,wt.isAsyncMode=function(A){return I(A)||S(A)===u},wt.isConcurrentMode=I,wt.isContextConsumer=function(A){return S(A)===c},wt.isContextProvider=function(A){return S(A)===a},wt.isElement=function(A){return typeof A=="object"&&A!==null&&A.$$typeof===e},wt.isForwardRef=function(A){return S(A)===h},wt.isFragment=function(A){return S(A)===r},wt.isLazy=function(A){return S(A)===y},wt.isMemo=function(A){return S(A)===d},wt.isPortal=function(A){return S(A)===n},wt.isProfiler=function(A){return S(A)===s},wt.isStrictMode=function(A){return S(A)===t},wt.isSuspense=function(A){return S(A)===f},wt.isValidElementType=function(A){return typeof A=="string"||typeof A=="function"||A===r||A===l||A===s||A===t||A===f||A===m||typeof A=="object"&&A!==null&&(A.$$typeof===y||A.$$typeof===d||A.$$typeof===a||A.$$typeof===c||A.$$typeof===h||A.$$typeof===g||A.$$typeof===v||A.$$typeof===_||A.$$typeof===b)},wt.typeOf=S,wt}var N_;function J5(){return N_||(N_=1,nb.exports=Z5()),nb.exports}var ib,C_;function eA(){if(C_)return ib;C_=1;var i=J5(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},t={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[i.ForwardRef]=r,s[i.Memo]=t;function a(y){return i.isMemo(y)?t:s[y.$$typeof]||e}var c=Object.defineProperty,u=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,m=Object.prototype;function d(y,b,g){if(typeof b!="string"){if(m){var v=f(b);v&&v!==m&&d(y,v,g)}var _=u(b);l&&(_=_.concat(l(b)));for(var S=a(y),I=a(b),A=0;A<_.length;++A){var R=_[A];if(!n[R]&&!(g&&g[R])&&!(I&&I[R])&&!(S&&S[R])){var E=h(b,R);try{c(y,R,E)}catch{}}}}return y}return ib=d,ib}eA();var tA=!0;function X8(i,e,n){var r="";return n.split(" ").forEach(function(t){i[t]!==void 0?e.push(i[t]+";"):t&&(r+=t+" ")}),r}var jm=function(e,n,r){var t=e.key+"-"+n.name;(r===!1||tA===!1)&&e.registered[t]===void 0&&(e.registered[t]=n.styles)},Vm=function(e,n,r){jm(e,n,r);var t=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var s=n;do e.insert(n===s?"."+t:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function nA(i){for(var e=0,n,r=0,t=i.length;t>=4;++r,t-=4)n=i.charCodeAt(r)&255|(i.charCodeAt(++r)&255)<<8|(i.charCodeAt(++r)&255)<<16|(i.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(t){case 3:e^=(i.charCodeAt(r+2)&255)<<16;case 2:e^=(i.charCodeAt(r+1)&255)<<8;case 1:e^=i.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var iA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},rA=/[A-Z]|^ms/g,aA=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Y8=function(e){return e.charCodeAt(1)===45},M_=function(e){return e!=null&&typeof e!="boolean"},rb=z8(function(i){return Y8(i)?i:i.replace(rA,"-$&").toLowerCase()}),B_=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(aA,function(r,t,s){return Pr={name:t,styles:s,next:Pr},t})}return iA[e]!==1&&!Y8(e)&&typeof n=="number"&&n!==0?n+"px":n};function lf(i,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var t=n;if(t.anim===1)return Pr={name:t.name,styles:t.styles,next:Pr},t.name;var s=n;if(s.styles!==void 0){var a=s.next;if(a!==void 0)for(;a!==void 0;)Pr={name:a.name,styles:a.styles,next:Pr},a=a.next;var c=s.styles+";";return c}return sA(i,e,n)}case"function":{if(i!==void 0){var u=Pr,l=n(i);return Pr=u,lf(i,e,l)}break}}var h=n;if(e==null)return h;var f=e[h];return f!==void 0?f:h}function sA(i,e,n){var r="";if(Array.isArray(n))for(var t=0;t<n.length;t++)r+=lf(i,e,n[t])+";";else for(var s in n){var a=n[s];if(typeof a!="object"){var c=a;e!=null&&e[c]!==void 0?r+=s+"{"+e[c]+"}":M_(c)&&(r+=rb(s)+":"+B_(s,c)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var u=0;u<a.length;u++)M_(a[u])&&(r+=rb(s)+":"+B_(s,a[u])+";");else{var l=lf(i,e,a);switch(s){case"animation":case"animationName":{r+=rb(s)+":"+l+";";break}default:r+=s+"{"+l+"}"}}}return r}var D_=/label:\s*([^\s;{]+)\s*(;|$)/g,Pr;function bf(i,e,n){if(i.length===1&&typeof i[0]=="object"&&i[0]!==null&&i[0].styles!==void 0)return i[0];var r=!0,t="";Pr=void 0;var s=i[0];if(s==null||s.raw===void 0)r=!1,t+=lf(n,e,s);else{var a=s;t+=a[0]}for(var c=1;c<i.length;c++)if(t+=lf(n,e,i[c]),r){var u=s;t+=u[c]}D_.lastIndex=0;for(var l="",h;(h=D_.exec(t))!==null;)l+="-"+h[1];var f=nA(t)+l;return{name:f,styles:t,next:Pr}}var oA=function(e){return e()},Q8=Jb.useInsertionEffect?Jb.useInsertionEffect:!1,Z8=Q8||oA,L_=Q8||Z.useLayoutEffect,J8=Z.createContext(typeof HTMLElement<"u"?Q5({key:"css"}):null);J8.Provider;var Km=function(e){return Z.forwardRef(function(n,r){var t=Z.useContext(J8);return e(n,t,r)})},mf=Z.createContext({}),Wm={}.hasOwnProperty,nm="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",cA=function(e,n){var r={};for(var t in n)Wm.call(n,t)&&(r[t]=n[t]);return r[nm]=e,r},uA=function(e){var n=e.cache,r=e.serialized,t=e.isStringTag;return jm(n,r,t),Z8(function(){return Vm(n,r,t)}),null},lA=Km(function(i,e,n){var r=i.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var t=i[nm],s=[r],a="";typeof i.className=="string"?a=X8(e.registered,s,i.className):i.className!=null&&(a=i.className+" ");var c=bf(s,void 0,Z.useContext(mf));a+=e.key+"-"+c.name;var u={};for(var l in i)Wm.call(i,l)&&l!=="css"&&l!==nm&&(u[l]=i[l]);return u.className=a,n&&(u.ref=n),Z.createElement(Z.Fragment,null,Z.createElement(uA,{cache:e,serialized:c,isStringTag:typeof t=="string"}),Z.createElement(t,u))}),dA=lA,F_=function(e,n){var r=arguments;if(n==null||!Wm.call(n,"css"))return Z.createElement.apply(void 0,r);var t=r.length,s=new Array(t);s[0]=dA,s[1]=cA(e,n);for(var a=2;a<t;a++)s[a]=r[a];return Z.createElement.apply(null,s)};(function(i){var e;e||(e=i.JSX||(i.JSX={}))})(F_||(F_={}));var fA=Km(function(i,e){var n=i.styles,r=bf([n],void 0,Z.useContext(mf)),t=Z.useRef();return L_(function(){var s=e.key+"-global",a=new e.sheet.constructor({key:s,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),c=!1,u=document.querySelector('style[data-emotion="'+s+" "+r.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),u!==null&&(c=!0,u.setAttribute("data-emotion",s),a.hydrate([u])),t.current=[a,c],function(){a.flush()}},[e]),L_(function(){var s=t.current,a=s[0],c=s[1];if(c){s[1]=!1;return}if(r.next!==void 0&&Vm(e,r.next,!0),a.tags.length){var u=a.tags[a.tags.length-1].nextElementSibling;a.before=u,a.flush()}e.insert("",r,a,!1)},[e,r.name]),null});function $m(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return bf(e)}function wf(){var i=$m.apply(void 0,arguments),e="animation-"+i.name;return{name:e,styles:"@keyframes "+e+"{"+i.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var hA=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,pA=z8(function(i){return hA.test(i)||i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)<91}),yA=pA,gA=function(e){return e!=="theme"},U_=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?yA:gA},H_=function(e,n,r){var t;if(n){var s=n.shouldForwardProp;t=e.__emotion_forwardProp&&s?function(a){return e.__emotion_forwardProp(a)&&s(a)}:s}return typeof t!="function"&&r&&(t=e.__emotion_forwardProp),t},bA=function(e){var n=e.cache,r=e.serialized,t=e.isStringTag;return jm(n,r,t),Z8(function(){return Vm(n,r,t)}),null},mA=function i(e,n){var r=e.__emotion_real===e,t=r&&e.__emotion_base||e,s,a;n!==void 0&&(s=n.label,a=n.target);var c=H_(e,n,r),u=c||U_(t),l=!u("as");return function(){var h=arguments,f=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&f.push("label:"+s+";"),h[0]==null||h[0].raw===void 0)f.push.apply(f,h);else{var m=h[0];f.push(m[0]);for(var d=h.length,y=1;y<d;y++)f.push(h[y],m[y])}var b=Km(function(g,v,_){var S=l&&g.as||t,I="",A=[],R=g;if(g.theme==null){R={};for(var E in g)R[E]=g[E];R.theme=Z.useContext(mf)}typeof g.className=="string"?I=X8(v.registered,A,g.className):g.className!=null&&(I=g.className+" ");var k=bf(f.concat(A),v.registered,R);I+=v.key+"-"+k.name,a!==void 0&&(I+=" "+a);var P=l&&c===void 0?U_(S):u,T={};for(var M in g)l&&M==="as"||P(M)&&(T[M]=g[M]);return T.className=I,_&&(T.ref=_),Z.createElement(Z.Fragment,null,Z.createElement(bA,{cache:v,serialized:k,isStringTag:typeof S=="string"}),Z.createElement(S,T))});return b.displayName=s!==void 0?s:"Styled("+(typeof t=="string"?t:t.displayName||t.name||"Component")+")",b.defaultProps=e.defaultProps,b.__emotion_real=b,b.__emotion_base=t,b.__emotion_styles=f,b.__emotion_forwardProp=c,Object.defineProperty(b,"toString",{value:function(){return"."+a}}),b.withComponent=function(g,v){var _=i(g,Kp({},n,v,{shouldForwardProp:H_(b,v,!0)}));return _.apply(void 0,f)},b}},wA=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],im=mA.bind(null);wA.forEach(function(i){im[i]=im(i)});function vA(i){return i==null||Object.keys(i).length===0}function e4(i){const{styles:e,defaultTheme:n={}}=i,r=typeof e=="function"?t=>e(vA(t)?n:t):e;return J.jsx(fA,{styles:r})}function t4(i,e){return im(i,e)}function xA(i,e){Array.isArray(i.__emotion_styles)&&(i.__emotion_styles=e(i.__emotion_styles))}const q_=[];function j_(i){return q_[0]=i,bf(q_)}var ab={exports:{}},Ot={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V_;function _A(){if(V_)return Ot;V_=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),t=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),d=Symbol.for("react.client.reference");function y(b){if(typeof b=="object"&&b!==null){var g=b.$$typeof;switch(g){case i:switch(b=b.type,b){case n:case t:case r:case u:case l:case m:return b;default:switch(b=b&&b.$$typeof,b){case a:case c:case f:case h:return b;case s:return b;default:return g}}case e:return g}}}return Ot.ContextConsumer=s,Ot.ContextProvider=a,Ot.Element=i,Ot.ForwardRef=c,Ot.Fragment=n,Ot.Lazy=f,Ot.Memo=h,Ot.Portal=e,Ot.Profiler=t,Ot.StrictMode=r,Ot.Suspense=u,Ot.SuspenseList=l,Ot.isContextConsumer=function(b){return y(b)===s},Ot.isContextProvider=function(b){return y(b)===a},Ot.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===i},Ot.isForwardRef=function(b){return y(b)===c},Ot.isFragment=function(b){return y(b)===n},Ot.isLazy=function(b){return y(b)===f},Ot.isMemo=function(b){return y(b)===h},Ot.isPortal=function(b){return y(b)===e},Ot.isProfiler=function(b){return y(b)===t},Ot.isStrictMode=function(b){return y(b)===r},Ot.isSuspense=function(b){return y(b)===u},Ot.isSuspenseList=function(b){return y(b)===l},Ot.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===n||b===t||b===r||b===u||b===l||typeof b=="object"&&b!==null&&(b.$$typeof===f||b.$$typeof===h||b.$$typeof===a||b.$$typeof===s||b.$$typeof===c||b.$$typeof===d||b.getModuleId!==void 0)},Ot.typeOf=y,Ot}var K_;function SA(){return K_||(K_=1,ab.exports=_A()),ab.exports}var n4=SA();function Rr(i){if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)}function i4(i){if(Z.isValidElement(i)||n4.isValidElementType(i)||!Rr(i))return i;const e={};return Object.keys(i).forEach(n=>{e[n]=i4(i[n])}),e}function Un(i,e,n={clone:!0}){const r=n.clone?{...i}:i;return Rr(i)&&Rr(e)&&Object.keys(e).forEach(t=>{Z.isValidElement(e[t])||n4.isValidElementType(e[t])?r[t]=e[t]:Rr(e[t])&&Object.prototype.hasOwnProperty.call(i,t)&&Rr(i[t])?r[t]=Un(i[t],e[t],n):n.clone?r[t]=Rr(e[t])?i4(e[t]):e[t]:r[t]=e[t]}),r}const IA=i=>{const e=Object.keys(i).map(n=>({key:n,val:i[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function TA(i){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...t}=i,s=IA(e),a=Object.keys(s);function c(m){return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${n})`}function u(m){return`@media (max-width:${(typeof e[m]=="number"?e[m]:m)-r/100}${n})`}function l(m,d){const y=a.indexOf(d);return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${n}) and (max-width:${(y!==-1&&typeof e[a[y]]=="number"?e[a[y]]:d)-r/100}${n})`}function h(m){return a.indexOf(m)+1<a.length?l(m,a[a.indexOf(m)+1]):c(m)}function f(m){const d=a.indexOf(m);return d===0?c(a[1]):d===a.length-1?u(a[d]):l(m,a[a.indexOf(m)+1]).replace("@media","@media not all and")}return{keys:a,values:s,up:c,down:u,between:l,only:h,not:f,unit:n,...t}}function kA(i,e){if(!i.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,t)=>{var a,c;const s=/min-width:\s*([0-9.]+)/;return+(((a=r.match(s))==null?void 0:a[1])||0)-+(((c=t.match(s))==null?void 0:c[1])||0)});return n.length?n.reduce((r,t)=>{const s=e[t];return delete r[t],r[t]=s,r},{...e}):e}function EA(i,e){return e==="@"||e.startsWith("@")&&(i.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function OA(i,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,t]=n,s=Number.isNaN(+r)?r||0:+r;return i.containerQueries(t).up(s)}function AA(i){const e=(s,a)=>s.replace("@media",a?`@container ${a}`:"@container");function n(s,a){s.up=(...c)=>e(i.breakpoints.up(...c),a),s.down=(...c)=>e(i.breakpoints.down(...c),a),s.between=(...c)=>e(i.breakpoints.between(...c),a),s.only=(...c)=>e(i.breakpoints.only(...c),a),s.not=(...c)=>{const u=e(i.breakpoints.not(...c),a);return u.includes("not all and")?u.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):u}}const r={},t=s=>(n(r,s),r);return n(t),{...i,containerQueries:t}}const PA={borderRadius:4};function nf(i,e){return e?Un(i,e,{clone:!1}):i}const l0={xs:0,sm:600,md:900,lg:1200,xl:1536},W_={keys:["xs","sm","md","lg","xl"],up:i=>`@media (min-width:${l0[i]}px)`},RA={containerQueries:i=>({up:e=>{let n=typeof e=="number"?e:l0[e]||e;return typeof n=="number"&&(n=`${n}px`),i?`@container ${i} (min-width:${n})`:`@container (min-width:${n})`}})};function hr(i,e,n){const r=i.theme||{};if(Array.isArray(e)){const s=r.breakpoints||W_;return e.reduce((a,c,u)=>(a[s.up(s.keys[u])]=n(e[u]),a),{})}if(typeof e=="object"){const s=r.breakpoints||W_;return Object.keys(e).reduce((a,c)=>{if(EA(s.keys,c)){const u=OA(r.containerQueries?r:RA,c);u&&(a[u]=n(e[c],c))}else if(Object.keys(s.values||l0).includes(c)){const u=s.up(c);a[u]=n(e[c],c)}else{const u=c;a[u]=e[u]}return a},{})}return n(e)}function r4(i={}){var n;return((n=i.keys)==null?void 0:n.reduce((r,t)=>{const s=i.up(t);return r[s]={},r},{}))||{}}function a4(i,e){return i.reduce((n,r)=>{const t=n[r];return(!t||Object.keys(t).length===0)&&delete n[r],n},e)}function NA(i,...e){const n=r4(i),r=[n,...e].reduce((t,s)=>Un(t,s),{});return a4(Object.keys(n),r)}function CA(i,e){if(typeof i!="object")return{};const n={},r=Object.keys(e);return Array.isArray(i)?r.forEach((t,s)=>{s<i.length&&(n[t]=!0)}):r.forEach(t=>{i[t]!=null&&(n[t]=!0)}),n}function sb({values:i,breakpoints:e,base:n}){const r=n||CA(i,e),t=Object.keys(r);if(t.length===0)return i;let s;return t.reduce((a,c,u)=>(Array.isArray(i)?(a[c]=i[u]!=null?i[u]:i[s],s=u):typeof i=="object"?(a[c]=i[c]!=null?i[c]:i[s],s=c):a[c]=i,a),{})}function Le(i){if(typeof i!="string")throw new Error(hs(7));return i.charAt(0).toUpperCase()+i.slice(1)}function d0(i,e,n=!0){if(!e||typeof e!="string")return null;if(i&&i.vars&&n){const r=`vars.${e}`.split(".").reduce((t,s)=>t&&t[s]?t[s]:null,i);if(r!=null)return r}return e.split(".").reduce((r,t)=>r&&r[t]!=null?r[t]:null,i)}function $p(i,e,n,r=n){let t;return typeof i=="function"?t=i(n):Array.isArray(i)?t=i[n]||r:t=d0(i,n)||r,e&&(t=e(t,r,i)),t}function nn(i){const{prop:e,cssProperty:n=i.prop,themeKey:r,transform:t}=i,s=a=>{if(a[e]==null)return null;const c=a[e],u=a.theme,l=d0(u,r)||{};return hr(a,c,f=>{let m=$p(l,t,f);return f===m&&typeof f=="string"&&(m=$p(l,t,`${e}${f==="default"?"":Le(f)}`,f)),n===!1?m:{[n]:m}})};return s.propTypes={},s.filterProps=[e],s}function MA(i){const e={};return n=>(e[n]===void 0&&(e[n]=i(n)),e[n])}const BA={m:"margin",p:"padding"},DA={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},$_={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},LA=MA(i=>{if(i.length>2)if($_[i])i=$_[i];else return[i];const[e,n]=i.split(""),r=BA[e],t=DA[n]||"";return Array.isArray(t)?t.map(s=>r+s):[r+t]}),zm=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Gm=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...zm,...Gm];function vf(i,e,n,r){const t=d0(i,e,!0)??n;return typeof t=="number"||typeof t=="string"?s=>typeof s=="string"?s:typeof t=="string"?t.startsWith("var(")&&s===0?0:t.startsWith("var(")&&s===1?t:`calc(${s} * ${t})`:t*s:Array.isArray(t)?s=>{if(typeof s=="string")return s;const a=Math.abs(s),c=t[a];return s>=0?c:typeof c=="number"?-c:typeof c=="string"&&c.startsWith("var(")?`calc(-1 * ${c})`:`-${c}`}:typeof t=="function"?t:()=>{}}function f0(i){return vf(i,"spacing",8)}function Oo(i,e){return typeof e=="string"||e==null?e:i(e)}function FA(i,e){return n=>i.reduce((r,t)=>(r[t]=Oo(e,n),r),{})}function UA(i,e,n,r){if(!e.includes(n))return null;const t=LA(n),s=FA(t,r),a=i[n];return hr(i,a,s)}function s4(i,e){const n=f0(i.theme);return Object.keys(i).map(r=>UA(i,e,r,n)).reduce(nf,{})}function Gt(i){return s4(i,zm)}Gt.propTypes={};Gt.filterProps=zm;function Xt(i){return s4(i,Gm)}Xt.propTypes={};Xt.filterProps=Gm;function o4(i=8,e=f0({spacing:i})){if(i.mui)return i;const n=(...r)=>(r.length===0?[1]:r).map(s=>{const a=e(s);return typeof a=="number"?`${a}px`:a}).join(" ");return n.mui=!0,n}function h0(...i){const e=i.reduce((r,t)=>(t.filterProps.forEach(s=>{r[s]=t}),r),{}),n=r=>Object.keys(r).reduce((t,s)=>e[s]?nf(t,e[s](r)):t,{});return n.propTypes={},n.filterProps=i.reduce((r,t)=>r.concat(t.filterProps),[]),n}function Ui(i){return typeof i!="number"?i:`${i}px solid`}function $i(i,e){return nn({prop:i,themeKey:"borders",transform:e})}const HA=$i("border",Ui),qA=$i("borderTop",Ui),jA=$i("borderRight",Ui),VA=$i("borderBottom",Ui),KA=$i("borderLeft",Ui),WA=$i("borderColor"),$A=$i("borderTopColor"),zA=$i("borderRightColor"),GA=$i("borderBottomColor"),XA=$i("borderLeftColor"),YA=$i("outline",Ui),QA=$i("outlineColor"),p0=i=>{if(i.borderRadius!==void 0&&i.borderRadius!==null){const e=vf(i.theme,"shape.borderRadius",4),n=r=>({borderRadius:Oo(e,r)});return hr(i,i.borderRadius,n)}return null};p0.propTypes={};p0.filterProps=["borderRadius"];h0(HA,qA,jA,VA,KA,WA,$A,zA,GA,XA,p0,YA,QA);const y0=i=>{if(i.gap!==void 0&&i.gap!==null){const e=vf(i.theme,"spacing",8),n=r=>({gap:Oo(e,r)});return hr(i,i.gap,n)}return null};y0.propTypes={};y0.filterProps=["gap"];const g0=i=>{if(i.columnGap!==void 0&&i.columnGap!==null){const e=vf(i.theme,"spacing",8),n=r=>({columnGap:Oo(e,r)});return hr(i,i.columnGap,n)}return null};g0.propTypes={};g0.filterProps=["columnGap"];const b0=i=>{if(i.rowGap!==void 0&&i.rowGap!==null){const e=vf(i.theme,"spacing",8),n=r=>({rowGap:Oo(e,r)});return hr(i,i.rowGap,n)}return null};b0.propTypes={};b0.filterProps=["rowGap"];const ZA=nn({prop:"gridColumn"}),JA=nn({prop:"gridRow"}),eP=nn({prop:"gridAutoFlow"}),tP=nn({prop:"gridAutoColumns"}),nP=nn({prop:"gridAutoRows"}),iP=nn({prop:"gridTemplateColumns"}),rP=nn({prop:"gridTemplateRows"}),aP=nn({prop:"gridTemplateAreas"}),sP=nn({prop:"gridArea"});h0(y0,g0,b0,ZA,JA,eP,tP,nP,iP,rP,aP,sP);function su(i,e){return e==="grey"?e:i}const oP=nn({prop:"color",themeKey:"palette",transform:su}),cP=nn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:su}),uP=nn({prop:"backgroundColor",themeKey:"palette",transform:su});h0(oP,cP,uP);function hi(i){return i<=1&&i!==0?`${i*100}%`:i}const lP=nn({prop:"width",transform:hi}),Xm=i=>{if(i.maxWidth!==void 0&&i.maxWidth!==null){const e=n=>{var t,s,a,c,u;const r=((a=(s=(t=i.theme)==null?void 0:t.breakpoints)==null?void 0:s.values)==null?void 0:a[n])||l0[n];return r?((u=(c=i.theme)==null?void 0:c.breakpoints)==null?void 0:u.unit)!=="px"?{maxWidth:`${r}${i.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:hi(n)}};return hr(i,i.maxWidth,e)}return null};Xm.filterProps=["maxWidth"];const dP=nn({prop:"minWidth",transform:hi}),fP=nn({prop:"height",transform:hi}),hP=nn({prop:"maxHeight",transform:hi}),pP=nn({prop:"minHeight",transform:hi});nn({prop:"size",cssProperty:"width",transform:hi});nn({prop:"size",cssProperty:"height",transform:hi});const yP=nn({prop:"boxSizing"});h0(lP,Xm,dP,fP,hP,pP,yP);const xf={border:{themeKey:"borders",transform:Ui},borderTop:{themeKey:"borders",transform:Ui},borderRight:{themeKey:"borders",transform:Ui},borderBottom:{themeKey:"borders",transform:Ui},borderLeft:{themeKey:"borders",transform:Ui},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ui},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:p0},color:{themeKey:"palette",transform:su},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:su},backgroundColor:{themeKey:"palette",transform:su},p:{style:Xt},pt:{style:Xt},pr:{style:Xt},pb:{style:Xt},pl:{style:Xt},px:{style:Xt},py:{style:Xt},padding:{style:Xt},paddingTop:{style:Xt},paddingRight:{style:Xt},paddingBottom:{style:Xt},paddingLeft:{style:Xt},paddingX:{style:Xt},paddingY:{style:Xt},paddingInline:{style:Xt},paddingInlineStart:{style:Xt},paddingInlineEnd:{style:Xt},paddingBlock:{style:Xt},paddingBlockStart:{style:Xt},paddingBlockEnd:{style:Xt},m:{style:Gt},mt:{style:Gt},mr:{style:Gt},mb:{style:Gt},ml:{style:Gt},mx:{style:Gt},my:{style:Gt},margin:{style:Gt},marginTop:{style:Gt},marginRight:{style:Gt},marginBottom:{style:Gt},marginLeft:{style:Gt},marginX:{style:Gt},marginY:{style:Gt},marginInline:{style:Gt},marginInlineStart:{style:Gt},marginInlineEnd:{style:Gt},marginBlock:{style:Gt},marginBlockStart:{style:Gt},marginBlockEnd:{style:Gt},displayPrint:{cssProperty:!1,transform:i=>({"@media print":{display:i}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:y0},rowGap:{style:b0},columnGap:{style:g0},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:hi},maxWidth:{style:Xm},minWidth:{transform:hi},height:{transform:hi},maxHeight:{transform:hi},minHeight:{transform:hi},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function gP(...i){const e=i.reduce((r,t)=>r.concat(Object.keys(t)),[]),n=new Set(e);return i.every(r=>n.size===Object.keys(r).length)}function bP(i,e){return typeof i=="function"?i(e):i}function mP(){function i(n,r,t,s){const a={[n]:r,theme:t},c=s[n];if(!c)return{[n]:r};const{cssProperty:u=n,themeKey:l,transform:h,style:f}=c;if(r==null)return null;if(l==="typography"&&r==="inherit")return{[n]:r};const m=d0(t,l)||{};return f?f(a):hr(a,r,y=>{let b=$p(m,h,y);return y===b&&typeof y=="string"&&(b=$p(m,h,`${n}${y==="default"?"":Le(y)}`,y)),u===!1?b:{[u]:b}})}function e(n){const{sx:r,theme:t={}}=n||{};if(!r)return null;const s=t.unstable_sxConfig??xf;function a(c){let u=c;if(typeof c=="function")u=c(t);else if(typeof c!="object")return c;if(!u)return null;const l=r4(t.breakpoints),h=Object.keys(l);let f=l;return Object.keys(u).forEach(m=>{const d=bP(u[m],t);if(d!=null)if(typeof d=="object")if(s[m])f=nf(f,i(m,d,t,s));else{const y=hr({theme:t},d,b=>({[m]:b}));gP(y,d)?f[m]=e({sx:d,theme:t}):f=nf(f,y)}else f=nf(f,i(m,d,t,s))}),kA(t,a4(h,f))}return Array.isArray(r)?r.map(a):a(r)}return e}const ps=mP();ps.filterProps=["sx"];function wP(i,e){var r;const n=this;if(n.vars){if(!((r=n.colorSchemes)!=null&&r[i])||typeof n.getColorSchemeSelector!="function")return{};let t=n.getColorSchemeSelector(i);return t==="&"?e:((t.includes("data-")||t.includes("."))&&(t=`*:where(${t.replace(/\s*&$/,"")}) &`),{[t]:e})}return n.palette.mode===i?e:{}}function _f(i={},...e){const{breakpoints:n={},palette:r={},spacing:t,shape:s={},...a}=i,c=TA(n),u=o4(t);let l=Un({breakpoints:c,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:u,shape:{...PA,...s}},a);return l=AA(l),l.applyStyles=wP,l=e.reduce((h,f)=>Un(h,f),l),l.unstable_sxConfig={...xf,...a==null?void 0:a.unstable_sxConfig},l.unstable_sx=function(f){return ps({sx:f,theme:this})},l}function vP(i){return Object.keys(i).length===0}function c4(i=null){const e=Z.useContext(mf);return!e||vP(e)?i:e}const xP=_f();function m0(i=xP){return c4(i)}function _P({styles:i,themeId:e,defaultTheme:n={}}){const r=m0(n),t=typeof i=="function"?i(e&&r[e]||r):i;return J.jsx(e4,{styles:t})}const SP=i=>{var r;const e={systemProps:{},otherProps:{}},n=((r=i==null?void 0:i.theme)==null?void 0:r.unstable_sxConfig)??xf;return Object.keys(i).forEach(t=>{n[t]?e.systemProps[t]=i[t]:e.otherProps[t]=i[t]}),e};function Ym(i){const{sx:e,...n}=i,{systemProps:r,otherProps:t}=SP(n);let s;return Array.isArray(e)?s=[r,...e]:typeof e=="function"?s=(...a)=>{const c=e(...a);return Rr(c)?{...r,...c}:r}:s={...r,...e},{...t,sx:s}}const z_=i=>i,IP=()=>{let i=z_;return{configure(e){i=e},generate(e){return i(e)},reset(){i=z_}}},u4=IP();function l4(i){var e,n,r="";if(typeof i=="string"||typeof i=="number")r+=i;else if(typeof i=="object")if(Array.isArray(i)){var t=i.length;for(e=0;e<t;e++)i[e]&&(n=l4(i[e]))&&(r&&(r+=" "),r+=n)}else for(n in i)i[n]&&(r&&(r+=" "),r+=n);return r}function Xe(){for(var i,e,n=0,r="",t=arguments.length;n<t;n++)(i=arguments[n])&&(e=l4(i))&&(r&&(r+=" "),r+=e);return r}function TP(i={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:t}=i,s=t4("div",{shouldForwardProp:c=>c!=="theme"&&c!=="sx"&&c!=="as"})(ps);return Z.forwardRef(function(u,l){const h=m0(n),{className:f,component:m="div",...d}=Ym(u);return J.jsx(s,{as:m,ref:l,className:Xe(f,t?t(r):r),theme:e&&h[e]||h,...d})})}const kP={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function dn(i,e,n="Mui"){const r=kP[e];return r?`${n}-${r}`:`${u4.generate(i)}-${e}`}function bn(i,e,n="Mui"){const r={};return e.forEach(t=>{r[t]=dn(i,t,n)}),r}function d4(i){const{variants:e,...n}=i,r={variants:e,style:j_(n),isProcessed:!0};return r.style===n||e&&e.forEach(t=>{typeof t.style!="function"&&(t.style=j_(t.style))}),r}const EP=_f();function ob(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}function OP(i){return i?(e,n)=>n[i]:null}function AP(i,e,n){i.theme=RP(i.theme)?n:i.theme[e]||i.theme}function Fp(i,e){const n=typeof e=="function"?e(i):e;if(Array.isArray(n))return n.flatMap(r=>Fp(i,r));if(Array.isArray(n==null?void 0:n.variants)){let r;if(n.isProcessed)r=n.style;else{const{variants:t,...s}=n;r=s}return f4(i,n.variants,[r])}return n!=null&&n.isProcessed?n.style:n}function f4(i,e,n=[]){var t;let r;e:for(let s=0;s<e.length;s+=1){const a=e[s];if(typeof a.props=="function"){if(r??(r={...i,...i.ownerState,ownerState:i.ownerState}),!a.props(r))continue}else for(const c in a.props)if(i[c]!==a.props[c]&&((t=i.ownerState)==null?void 0:t[c])!==a.props[c])continue e;typeof a.style=="function"?(r??(r={...i,...i.ownerState,ownerState:i.ownerState}),n.push(a.style(r))):n.push(a.style)}return n}function h4(i={}){const{themeId:e,defaultTheme:n=EP,rootShouldForwardProp:r=ob,slotShouldForwardProp:t=ob}=i;function s(c){AP(c,e,n)}return(c,u={})=>{xA(c,A=>A.filter(R=>R!==ps));const{name:l,slot:h,skipVariantsResolver:f,skipSx:m,overridesResolver:d=OP(CP(h)),...y}=u,b=f!==void 0?f:h&&h!=="Root"&&h!=="root"||!1,g=m||!1;let v=ob;h==="Root"||h==="root"?v=r:h?v=t:NP(c)&&(v=void 0);const _=t4(c,{shouldForwardProp:v,label:PP(),...y}),S=A=>{if(typeof A=="function"&&A.__emotion_real!==A)return function(E){return Fp(E,A)};if(Rr(A)){const R=d4(A);return R.variants?function(k){return Fp(k,R)}:R.style}return A},I=(...A)=>{const R=[],E=A.map(S),k=[];if(R.push(s),l&&d&&k.push(function(C){var L,q;const F=(q=(L=C.theme.components)==null?void 0:L[l])==null?void 0:q.styleOverrides;if(!F)return null;const B={};for(const K in F)B[K]=Fp(C,F[K]);return d(C,B)}),l&&!b&&k.push(function(C){var B,L;const D=C.theme,F=(L=(B=D==null?void 0:D.components)==null?void 0:B[l])==null?void 0:L.variants;return F?f4(C,F):null}),g||k.push(ps),Array.isArray(E[0])){const M=E.shift(),C=new Array(R.length).fill(""),D=new Array(k.length).fill("");let F;F=[...C,...M,...D],F.raw=[...C,...M.raw,...D],R.unshift(F)}const P=[...R,...E,...k],T=_(...P);return c.muiName&&(T.muiName=c.muiName),T};return _.withConfig&&(I.withConfig=_.withConfig),I}}function PP(i,e){return void 0}function RP(i){for(const e in i)return!1;return!0}function NP(i){return typeof i=="string"&&i.charCodeAt(0)>96}function CP(i){return i&&i.charAt(0).toLowerCase()+i.slice(1)}const p4=h4();function zp(i,e){const n={...e};for(const r in i)if(Object.prototype.hasOwnProperty.call(i,r)){const t=r;if(t==="components"||t==="slots")n[t]={...i[t],...n[t]};else if(t==="componentsProps"||t==="slotProps"){const s=i[t],a=e[t];if(!a)n[t]=s||{};else if(!s)n[t]=a;else{n[t]={...a};for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const u=c;n[t][u]=zp(s[u],a[u])}}}else n[t]===void 0&&(n[t]=i[t])}return n}function MP(i){const{theme:e,name:n,props:r}=i;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:zp(e.components[n].defaultProps,r)}function y4({props:i,name:e,defaultTheme:n,themeId:r}){let t=m0(n);return r&&(t=t[r]||t),MP({theme:t,name:e,props:i})}const du=typeof window<"u"?Z.useLayoutEffect:Z.useEffect;function BP(i,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(i,n))}function Qm(i,e=0,n=1){return BP(i,e,n)}function DP(i){i=i.slice(1);const e=new RegExp(`.{1,${i.length>=6?2:1}}`,"g");let n=i.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,t)=>t<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function ys(i){if(i.type)return i;if(i.charAt(0)==="#")return ys(DP(i));const e=i.indexOf("("),n=i.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(hs(9,i));let r=i.substring(e+1,i.length-1),t;if(n==="color"){if(r=r.split(" "),t=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(t))throw new Error(hs(10,t))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:n,values:r,colorSpace:t}}const LP=i=>{const e=ys(i);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},Kd=(i,e)=>{try{return LP(i)}catch{return i}};function w0(i){const{type:e,colorSpace:n}=i;let{values:r}=i;return e.includes("rgb")?r=r.map((t,s)=>s<3?parseInt(t,10):t):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function g4(i){i=ys(i);const{values:e}=i,n=e[0],r=e[1]/100,t=e[2]/100,s=r*Math.min(t,1-t),a=(l,h=(l+n/30)%12)=>t-s*Math.max(Math.min(h-3,9-h,1),-1);let c="rgb";const u=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return i.type==="hsla"&&(c+="a",u.push(e[3])),w0({type:c,values:u})}function rm(i){i=ys(i);let e=i.type==="hsl"||i.type==="hsla"?ys(g4(i)).values:i.values;return e=e.map(n=>(i.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function FP(i,e){const n=rm(i),r=rm(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function En(i,e){return i=ys(i),e=Qm(e),(i.type==="rgb"||i.type==="hsl")&&(i.type+="a"),i.type==="color"?i.values[3]=`/${e}`:i.values[3]=e,w0(i)}function Wh(i,e,n){try{return En(i,e)}catch{return i}}function Zm(i,e){if(i=ys(i),e=Qm(e),i.type.includes("hsl"))i.values[2]*=1-e;else if(i.type.includes("rgb")||i.type.includes("color"))for(let n=0;n<3;n+=1)i.values[n]*=1-e;return w0(i)}function Rt(i,e,n){try{return Zm(i,e)}catch{return i}}function Jm(i,e){if(i=ys(i),e=Qm(e),i.type.includes("hsl"))i.values[2]+=(100-i.values[2])*e;else if(i.type.includes("rgb"))for(let n=0;n<3;n+=1)i.values[n]+=(255-i.values[n])*e;else if(i.type.includes("color"))for(let n=0;n<3;n+=1)i.values[n]+=(1-i.values[n])*e;return w0(i)}function Nt(i,e,n){try{return Jm(i,e)}catch{return i}}function UP(i,e=.15){return rm(i)>.5?Zm(i,e):Jm(i,e)}function $h(i,e,n){try{return UP(i,e)}catch{return i}}function G_(...i){return i.reduce((e,n)=>n==null?e:function(...t){e.apply(this,t),n.apply(this,t)},()=>{})}function HP(i,e=166){let n;function r(...t){const s=()=>{i.apply(this,t)};clearTimeout(n),n=setTimeout(s,e)}return r.clear=()=>{clearTimeout(n)},r}function Oa(i){return i&&i.ownerDocument||document}function fu(i){return Oa(i).defaultView||window}function X_(i,e){typeof i=="function"?i(e):i&&(i.current=e)}let Y_=0;function qP(i){const[e,n]=Z.useState(i),r=i||e;return Z.useEffect(()=>{e==null&&(Y_+=1,n(`mui-${Y_}`))},[e]),r}const jP={...Jb},Q_=jP.useId;function b4(i){if(Q_!==void 0){const e=Q_();return i??e}return qP(i)}function VP({controlled:i,default:e,name:n,state:r="value"}){const{current:t}=Z.useRef(i!==void 0),[s,a]=Z.useState(e),c=t?i:s,u=Z.useCallback(l=>{t||a(l)},[]);return[c,u]}function ds(i){const e=Z.useRef(i);return du(()=>{e.current=i}),Z.useRef((...n)=>(0,e.current)(...n)).current}function Zn(...i){const e=Z.useRef(void 0),n=Z.useCallback(r=>{const t=i.map(s=>{if(s==null)return null;if(typeof s=="function"){const a=s,c=a(r);return typeof c=="function"?c:()=>{a(null)}}return s.current=r,()=>{s.current=null}});return()=>{t.forEach(s=>s==null?void 0:s())}},i);return Z.useMemo(()=>i.every(r=>r==null)?null:r=>{e.current&&(e.current(),e.current=void 0),r!=null&&(e.current=n(r))},i)}const Z_={};function m4(i,e){const n=Z.useRef(Z_);return n.current===Z_&&(n.current=i(e)),n}const KP=[];function WP(i){Z.useEffect(i,KP)}class v0{constructor(){te(this,"currentId",null);te(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});te(this,"disposeEffect",()=>this.clear)}static create(){return new v0}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function iu(){const i=m4(v0.create).current;return WP(i.disposeEffect),i}function Gp(i){try{return i.matches(":focus-visible")}catch{}return!1}function $P(i=window){const e=i.document.documentElement.clientWidth;return i.innerWidth-e}function mn(i,e,n=void 0){const r={};for(const t in i){const s=i[t];let a="",c=!0;for(let u=0;u<s.length;u+=1){const l=s[u];l&&(a+=(c===!0?"":" ")+e(l),c=!1,n&&n[l]&&(a+=" "+n[l]))}r[t]=a}return r}function zP(i){return typeof i=="string"}function w4(i,e,n){return i===void 0||zP(i)?e:{...e,ownerState:{...e.ownerState,...n}}}function v4(i,e=[]){if(i===void 0)return{};const n={};return Object.keys(i).filter(r=>r.match(/^on[A-Z]/)&&typeof i[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=i[r]}),n}function J_(i){if(i===void 0)return{};const e={};return Object.keys(i).filter(n=>!(n.match(/^on[A-Z]/)&&typeof i[n]=="function")).forEach(n=>{e[n]=i[n]}),e}function x4(i){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:t,className:s}=i;if(!e){const d=Xe(n==null?void 0:n.className,s,t==null?void 0:t.className,r==null?void 0:r.className),y={...n==null?void 0:n.style,...t==null?void 0:t.style,...r==null?void 0:r.style},b={...n,...t,...r};return d.length>0&&(b.className=d),Object.keys(y).length>0&&(b.style=y),{props:b,internalRef:void 0}}const a=v4({...t,...r}),c=J_(r),u=J_(t),l=e(a),h=Xe(l==null?void 0:l.className,n==null?void 0:n.className,s,t==null?void 0:t.className,r==null?void 0:r.className),f={...l==null?void 0:l.style,...n==null?void 0:n.style,...t==null?void 0:t.style,...r==null?void 0:r.style},m={...l,...n,...u,...c};return h.length>0&&(m.className=h),Object.keys(f).length>0&&(m.style=f),{props:m,internalRef:l.ref}}function _4(i,e,n){return typeof i=="function"?i(e,n):i}function GP(i){var f;const{elementType:e,externalSlotProps:n,ownerState:r,skipResolvingSlotProps:t=!1,...s}=i,a=t?{}:_4(n,r),{props:c,internalRef:u}=x4({...s,externalSlotProps:a}),l=Zn(u,a==null?void 0:a.ref,(f=i.additionalProps)==null?void 0:f.ref);return w4(e,{...c,ref:l},r)}function vu(i){var e;return parseInt(Z.version,10)>=19?((e=i==null?void 0:i.props)==null?void 0:e.ref)||null:(i==null?void 0:i.ref)||null}const S4=Z.createContext(null);function ew(){return Z.useContext(S4)}const XP=typeof Symbol=="function"&&Symbol.for,YP=XP?Symbol.for("mui.nested"):"__THEME_NESTED__";function QP(i,e){return typeof e=="function"?e(i):{...i,...e}}function ZP(i){const{children:e,theme:n}=i,r=ew(),t=Z.useMemo(()=>{const s=r===null?{...n}:QP(r,n);return s!=null&&(s[YP]=r!==null),s},[n,r]);return J.jsx(S4.Provider,{value:t,children:e})}const I4=Z.createContext();function JP({value:i,...e}){return J.jsx(I4.Provider,{value:i??!0,...e})}const tw=()=>Z.useContext(I4)??!1,T4=Z.createContext(void 0);function eR({value:i,children:e}){return J.jsx(T4.Provider,{value:i,children:e})}function tR(i){const{theme:e,name:n,props:r}=i;if(!e||!e.components||!e.components[n])return r;const t=e.components[n];return t.defaultProps?zp(t.defaultProps,r):!t.styleOverrides&&!t.variants?zp(t,r):r}function nR({props:i,name:e}){const n=Z.useContext(T4);return tR({props:i,name:e,theme:{components:n}})}const e2={};function t2(i,e,n,r=!1){return Z.useMemo(()=>{const t=i&&e[i]||e;if(typeof n=="function"){const s=n(t),a=i?{...e,[i]:s}:s;return r?()=>a:a}return i?{...e,[i]:n}:{...e,...n}},[i,e,n,r])}function k4(i){const{children:e,theme:n,themeId:r}=i,t=c4(e2),s=ew()||e2,a=t2(r,t,n),c=t2(r,s,n,!0),u=(r?a[r]:a).direction==="rtl";return J.jsx(ZP,{theme:c,children:J.jsx(mf.Provider,{value:a,children:J.jsx(JP,{value:u,children:J.jsx(eR,{value:r?a[r].components:a.components,children:e})})})})}const n2={theme:void 0};function iR(i){let e,n;return function(t){let s=e;return(s===void 0||t.theme!==n)&&(n2.theme=t.theme,s=d4(i(n2)),e=s,n=t.theme),s}}const nw="mode",iw="color-scheme",rR="data-color-scheme";function aR(i){const{defaultMode:e="system",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:t=nw,colorSchemeStorageKey:s=iw,attribute:a=rR,colorSchemeNode:c="document.documentElement",nonce:u}=i||{};let l="",h=a;if(a==="class"&&(h=".%s"),a==="data"&&(h="[data-%s]"),h.startsWith(".")){const m=h.substring(1);l+=`${c}.classList.remove('${m}'.replace('%s', light), '${m}'.replace('%s', dark));
      ${c}.classList.add('${m}'.replace('%s', colorScheme));`}const f=h.match(/\[([^\]]+)\]/);if(f){const[m,d]=f[1].split("=");d||(l+=`${c}.removeAttribute('${m}'.replace('%s', light));
      ${c}.removeAttribute('${m}'.replace('%s', dark));`),l+=`
      ${c}.setAttribute('${m}'.replace('%s', colorScheme), ${d?`${d}.replace('%s', colorScheme)`:'""'});`}else l+=`${c}.setAttribute('${h}', colorScheme);`;return J.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?u:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${t}') || '${e}';
  const dark = localStorage.getItem('${s}-dark') || '${r}';
  const light = localStorage.getItem('${s}-light') || '${n}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${l}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function sR(){}const oR=({key:i,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(n){if(typeof window>"u")return;if(!e)return n;let r;try{r=e.localStorage.getItem(i)}catch{}return r||n},set:n=>{if(e)try{e.localStorage.setItem(i,n)}catch{}},subscribe:n=>{if(!e)return sR;const r=t=>{const s=t.newValue;t.key===i&&n(s)};return e.addEventListener("storage",r),()=>{e.removeEventListener("storage",r)}}});function cb(){}function i2(i){if(typeof window<"u"&&typeof window.matchMedia=="function"&&i==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function E4(i,e){if(i.mode==="light"||i.mode==="system"&&i.systemMode==="light")return e("light");if(i.mode==="dark"||i.mode==="system"&&i.systemMode==="dark")return e("dark")}function cR(i){return E4(i,e=>{if(e==="light")return i.lightColorScheme;if(e==="dark")return i.darkColorScheme})}function uR(i){const{defaultMode:e="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:t=[],modeStorageKey:s=nw,colorSchemeStorageKey:a=iw,storageWindow:c=typeof window>"u"?void 0:window,storageManager:u=oR,noSsr:l=!1}=i,h=t.join(","),f=t.length>1,m=Z.useMemo(()=>u==null?void 0:u({key:s,storageWindow:c}),[u,s,c]),d=Z.useMemo(()=>u==null?void 0:u({key:`${a}-light`,storageWindow:c}),[u,a,c]),y=Z.useMemo(()=>u==null?void 0:u({key:`${a}-dark`,storageWindow:c}),[u,a,c]),[b,g]=Z.useState(()=>{const k=(m==null?void 0:m.get(e))||e,P=(d==null?void 0:d.get(n))||n,T=(y==null?void 0:y.get(r))||r;return{mode:k,systemMode:i2(k),lightColorScheme:P,darkColorScheme:T}}),[v,_]=Z.useState(l||!f);Z.useEffect(()=>{_(!0)},[]);const S=cR(b),I=Z.useCallback(k=>{g(P=>{if(k===P.mode)return P;const T=k??e;return m==null||m.set(T),{...P,mode:T,systemMode:i2(T)}})},[m,e]),A=Z.useCallback(k=>{k?typeof k=="string"?k&&!h.includes(k)?console.error(`\`${k}\` does not exist in \`theme.colorSchemes\`.`):g(P=>{const T={...P};return E4(P,M=>{M==="light"&&(d==null||d.set(k),T.lightColorScheme=k),M==="dark"&&(y==null||y.set(k),T.darkColorScheme=k)}),T}):g(P=>{const T={...P},M=k.light===null?n:k.light,C=k.dark===null?r:k.dark;return M&&(h.includes(M)?(T.lightColorScheme=M,d==null||d.set(M)):console.error(`\`${M}\` does not exist in \`theme.colorSchemes\`.`)),C&&(h.includes(C)?(T.darkColorScheme=C,y==null||y.set(C)):console.error(`\`${C}\` does not exist in \`theme.colorSchemes\`.`)),T}):g(P=>(d==null||d.set(n),y==null||y.set(r),{...P,lightColorScheme:n,darkColorScheme:r}))},[h,d,y,n,r]),R=Z.useCallback(k=>{b.mode==="system"&&g(P=>{const T=k!=null&&k.matches?"dark":"light";return P.systemMode===T?P:{...P,systemMode:T}})},[b.mode]),E=Z.useRef(R);return E.current=R,Z.useEffect(()=>{if(typeof window.matchMedia!="function"||!f)return;const k=(...T)=>E.current(...T),P=window.matchMedia("(prefers-color-scheme: dark)");return P.addListener(k),k(P),()=>{P.removeListener(k)}},[f]),Z.useEffect(()=>{if(f){const k=(m==null?void 0:m.subscribe(M=>{(!M||["light","dark","system"].includes(M))&&I(M||e)}))||cb,P=(d==null?void 0:d.subscribe(M=>{(!M||h.match(M))&&A({light:M})}))||cb,T=(y==null?void 0:y.subscribe(M=>{(!M||h.match(M))&&A({dark:M})}))||cb;return()=>{k(),P(),T()}}},[A,I,h,e,c,f,m,d,y]),{...b,mode:v?b.mode:void 0,systemMode:v?b.systemMode:void 0,colorScheme:v?S:void 0,setMode:I,setColorScheme:A}}const lR="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function dR(i){const{themeId:e,theme:n={},modeStorageKey:r=nw,colorSchemeStorageKey:t=iw,disableTransitionOnChange:s=!1,defaultColorScheme:a,resolveTheme:c}=i,u={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},l=Z.createContext(void 0),h=()=>Z.useContext(l)||u,f={},m={};function d(v){var wn,Dt,vn,qt;const{children:_,theme:S,modeStorageKey:I=r,colorSchemeStorageKey:A=t,disableTransitionOnChange:R=s,storageManager:E,storageWindow:k=typeof window>"u"?void 0:window,documentNode:P=typeof document>"u"?void 0:document,colorSchemeNode:T=typeof document>"u"?void 0:document.documentElement,disableNestedContext:M=!1,disableStyleSheetGeneration:C=!1,defaultMode:D="system",forceThemeRerender:F=!1,noSsr:B}=v,L=Z.useRef(!1),q=ew(),K=Z.useContext(l),$=!!K&&!M,U=Z.useMemo(()=>S||(typeof n=="function"?n():n),[S]),z=U[e],G=z||U,{colorSchemes:ne=f,components:ce=m,cssVarPrefix:Se}=G,Ie=Object.keys(ne).filter(Wt=>!!ne[Wt]).join(","),me=Z.useMemo(()=>Ie.split(","),[Ie]),xe=typeof a=="string"?a:a.light,ke=typeof a=="string"?a:a.dark,Re=ne[xe]&&ne[ke]?D:((Dt=(wn=ne[G.defaultColorScheme])==null?void 0:wn.palette)==null?void 0:Dt.mode)||((vn=G.palette)==null?void 0:vn.mode),{mode:Ce,setMode:Ne,systemMode:We,lightColorScheme:dt,darkColorScheme:Ut,colorScheme:Ht,setColorScheme:Je}=uR({supportedColorSchemes:me,defaultLightColorScheme:xe,defaultDarkColorScheme:ke,modeStorageKey:I,colorSchemeStorageKey:A,defaultMode:Re,storageManager:E,storageWindow:k,noSsr:B});let At=Ce,Te=Ht;$&&(At=K.mode,Te=K.colorScheme);let j=Te||G.defaultColorScheme;G.vars&&!F&&(j=G.defaultColorScheme);const he=Z.useMemo(()=>{var An;const Wt=((An=G.generateThemeVars)==null?void 0:An.call(G))||G.vars,rt={...G,components:ce,colorSchemes:ne,cssVarPrefix:Se,vars:Wt};if(typeof rt.generateSpacing=="function"&&(rt.spacing=rt.generateSpacing()),j){const Lt=ne[j];Lt&&typeof Lt=="object"&&Object.keys(Lt).forEach(Y=>{Lt[Y]&&typeof Lt[Y]=="object"?rt[Y]={...rt[Y],...Lt[Y]}:rt[Y]=Lt[Y]})}return c?c(rt):rt},[G,j,ce,ne,Se]),de=G.colorSchemeSelector;du(()=>{if(Te&&T&&de&&de!=="media"){const Wt=de;let rt=de;if(Wt==="class"&&(rt=".%s"),Wt==="data"&&(rt="[data-%s]"),Wt!=null&&Wt.startsWith("data-")&&!Wt.includes("%s")&&(rt=`[${Wt}="%s"]`),rt.startsWith("."))T.classList.remove(...me.map(An=>rt.substring(1).replace("%s",An))),T.classList.add(rt.substring(1).replace("%s",Te));else{const An=rt.replace("%s",Te).match(/\[([^\]]+)\]/);if(An){const[Lt,Y]=An[1].split("=");Y||me.forEach(X=>{T.removeAttribute(Lt.replace(Te,X))}),T.setAttribute(Lt,Y?Y.replace(/"|'/g,""):"")}else T.setAttribute(rt,Te)}}},[Te,de,T,me]),Z.useEffect(()=>{let Wt;if(R&&L.current&&P){const rt=P.createElement("style");rt.appendChild(P.createTextNode(lR)),P.head.appendChild(rt),window.getComputedStyle(P.body),Wt=setTimeout(()=>{P.head.removeChild(rt)},1)}return()=>{clearTimeout(Wt)}},[Te,R,P]),Z.useEffect(()=>(L.current=!0,()=>{L.current=!1}),[]);const Me=Z.useMemo(()=>({allColorSchemes:me,colorScheme:Te,darkColorScheme:Ut,lightColorScheme:dt,mode:At,setColorScheme:Je,setMode:Ne,systemMode:We}),[me,Te,Ut,dt,At,Je,Ne,We,he.colorSchemeSelector]);let ct=!0;(C||G.cssVariables===!1||$&&(q==null?void 0:q.cssVarPrefix)===Se)&&(ct=!1);const Hn=J.jsxs(Z.Fragment,{children:[J.jsx(k4,{themeId:z?e:void 0,theme:he,children:_}),ct&&J.jsx(e4,{styles:((qt=he.generateStyleSheets)==null?void 0:qt.call(he))||[]})]});return $?Hn:J.jsx(l.Provider,{value:Me,children:Hn})}const y=typeof a=="string"?a:a.light,b=typeof a=="string"?a:a.dark;return{CssVarsProvider:d,useColorScheme:h,getInitColorSchemeScript:v=>aR({colorSchemeStorageKey:t,defaultLightColorScheme:y,defaultDarkColorScheme:b,modeStorageKey:r,...v})}}function fR(i=""){function e(...r){if(!r.length)return"";const t=r[0];return typeof t=="string"&&!t.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${i?`${i}-`:""}${t}${e(...r.slice(1))})`:`, ${t}`}return(r,...t)=>`var(--${i?`${i}-`:""}${r}${e(...t)})`}const r2=(i,e,n,r=[])=>{let t=i;e.forEach((s,a)=>{a===e.length-1?Array.isArray(t)?t[Number(s)]=n:t&&typeof t=="object"&&(t[s]=n):t&&typeof t=="object"&&(t[s]||(t[s]=r.includes(s)?[]:{}),t=t[s])})},hR=(i,e,n)=>{function r(t,s=[],a=[]){Object.entries(t).forEach(([c,u])=>{(!n||n&&!n([...s,c]))&&u!=null&&(typeof u=="object"&&Object.keys(u).length>0?r(u,[...s,c],Array.isArray(u)?[...a,c]:a):e([...s,c],u,a))})}r(i)},pR=(i,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>i.includes(r))||i[i.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function ub(i,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},t={},s={},a={};return hR(i,(c,u,l)=>{if((typeof u=="string"||typeof u=="number")&&(!r||!r(c,u))){const h=`--${n?`${n}-`:""}${c.join("-")}`,f=pR(c,u);Object.assign(t,{[h]:f}),r2(s,c,`var(${h})`,l),r2(a,c,`var(${h}, ${f})`,l)}},c=>c[0]==="vars"),{css:t,vars:s,varsWithDefaults:a}}function yR(i,e={}){const{getSelector:n=g,disableCssColorScheme:r,colorSchemeSelector:t}=e,{colorSchemes:s={},components:a,defaultColorScheme:c="light",...u}=i,{vars:l,css:h,varsWithDefaults:f}=ub(u,e);let m=f;const d={},{[c]:y,...b}=s;if(Object.entries(b||{}).forEach(([S,I])=>{const{vars:A,css:R,varsWithDefaults:E}=ub(I,e);m=Un(m,E),d[S]={css:R,vars:A}}),y){const{css:S,vars:I,varsWithDefaults:A}=ub(y,e);m=Un(m,A),d[c]={css:S,vars:I}}function g(S,I){var R,E;let A=t;if(t==="class"&&(A=".%s"),t==="data"&&(A="[data-%s]"),t!=null&&t.startsWith("data-")&&!t.includes("%s")&&(A=`[${t}="%s"]`),S){if(A==="media")return i.defaultColorScheme===S?":root":{[`@media (prefers-color-scheme: ${((E=(R=s[S])==null?void 0:R.palette)==null?void 0:E.mode)||S})`]:{":root":I}};if(A)return i.defaultColorScheme===S?`:root, ${A.replace("%s",String(S))}`:A.replace("%s",String(S))}return":root"}return{vars:m,generateThemeVars:()=>{let S={...l};return Object.entries(d).forEach(([,{vars:I}])=>{S=Un(S,I)}),S},generateStyleSheets:()=>{var k,P;const S=[],I=i.defaultColorScheme||"light";function A(T,M){Object.keys(M).length&&S.push(typeof T=="string"?{[T]:{...M}}:T)}A(n(void 0,{...h}),h);const{[I]:R,...E}=d;if(R){const{css:T}=R,M=(P=(k=s[I])==null?void 0:k.palette)==null?void 0:P.mode,C=!r&&M?{colorScheme:M,...T}:{...T};A(n(I,{...C}),C)}return Object.entries(E).forEach(([T,{css:M}])=>{var F,B;const C=(B=(F=s[T])==null?void 0:F.palette)==null?void 0:B.mode,D=!r&&C?{colorScheme:C,...M}:{...M};A(n(T,{...D}),D)}),S}}}function gR(i){return function(n){return i==="media"?`@media (prefers-color-scheme: ${n})`:i?i.startsWith("data-")&&!i.includes("%s")?`[${i}="${n}"] &`:i==="class"?`.${n} &`:i==="data"?`[data-${n}] &`:`${i.replace("%s",n)} &`:"&"}}const bR=_f(),mR=p4("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`maxWidth${Le(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),wR=i=>y4({props:i,name:"MuiContainer",defaultTheme:bR}),vR=(i,e)=>{const n=u=>dn(e,u),{classes:r,fixed:t,disableGutters:s,maxWidth:a}=i,c={root:["root",a&&`maxWidth${Le(String(a))}`,t&&"fixed",s&&"disableGutters"]};return mn(c,n,r)};function xR(i={}){const{createStyledComponent:e=mR,useThemeProps:n=wR,componentName:r="MuiContainer"}=i,t=e(({theme:a,ownerState:c})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!c.disableGutters&&{paddingLeft:a.spacing(2),paddingRight:a.spacing(2),[a.breakpoints.up("sm")]:{paddingLeft:a.spacing(3),paddingRight:a.spacing(3)}}}),({theme:a,ownerState:c})=>c.fixed&&Object.keys(a.breakpoints.values).reduce((u,l)=>{const h=l,f=a.breakpoints.values[h];return f!==0&&(u[a.breakpoints.up(h)]={maxWidth:`${f}${a.breakpoints.unit}`}),u},{}),({theme:a,ownerState:c})=>({...c.maxWidth==="xs"&&{[a.breakpoints.up("xs")]:{maxWidth:Math.max(a.breakpoints.values.xs,444)}},...c.maxWidth&&c.maxWidth!=="xs"&&{[a.breakpoints.up(c.maxWidth)]:{maxWidth:`${a.breakpoints.values[c.maxWidth]}${a.breakpoints.unit}`}}}));return Z.forwardRef(function(c,u){const l=n(c),{className:h,component:f="div",disableGutters:m=!1,fixed:d=!1,maxWidth:y="lg",classes:b,...g}=l,v={...l,component:f,disableGutters:m,fixed:d,maxWidth:y},_=vR(v,r);return J.jsx(t,{as:f,ownerState:v,className:Xe(_.root,h),ref:u,...g})})}const _R=_f(),SR=p4("div",{name:"MuiStack",slot:"Root",overridesResolver:(i,e)=>e.root});function IR(i){return y4({props:i,name:"MuiStack",defaultTheme:_R})}function TR(i,e){const n=Z.Children.toArray(i).filter(Boolean);return n.reduce((r,t,s)=>(r.push(t),s<n.length-1&&r.push(Z.cloneElement(e,{key:`separator-${s}`})),r),[])}const kR=i=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[i],ER=({ownerState:i,theme:e})=>{let n={display:"flex",flexDirection:"column",...hr({theme:e},sb({values:i.direction,breakpoints:e.breakpoints.values}),r=>({flexDirection:r}))};if(i.spacing){const r=f0(e),t=Object.keys(e.breakpoints.values).reduce((u,l)=>((typeof i.spacing=="object"&&i.spacing[l]!=null||typeof i.direction=="object"&&i.direction[l]!=null)&&(u[l]=!0),u),{}),s=sb({values:i.direction,base:t}),a=sb({values:i.spacing,base:t});typeof s=="object"&&Object.keys(s).forEach((u,l,h)=>{if(!s[u]){const m=l>0?s[h[l-1]]:"column";s[u]=m}}),n=Un(n,hr({theme:e},a,(u,l)=>i.useFlexGap?{gap:Oo(r,u)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${kR(l?s[l]:i.direction)}`]:Oo(r,u)}}))}return n=NA(e.breakpoints,n),n};function OR(i={}){const{createStyledComponent:e=SR,useThemeProps:n=IR,componentName:r="MuiStack"}=i,t=()=>mn({root:["root"]},u=>dn(r,u),{}),s=e(ER);return Z.forwardRef(function(u,l){const h=n(u),f=Ym(h),{component:m="div",direction:d="column",spacing:y=0,divider:b,children:g,className:v,useFlexGap:_=!1,...S}=f,I={direction:d,spacing:y,useFlexGap:_},A=t();return J.jsx(s,{as:m,ownerState:I,ref:l,className:Xe(A.root,v),...S,children:b?TR(g,b):g})})}function O4(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:of.white,default:of.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const AR=O4();function A4(){return{text:{primary:of.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:of.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const a2=A4();function s2(i,e,n,r){const t=r.light||r,s=r.dark||r*1.5;i[e]||(i.hasOwnProperty(n)?i[e]=i[n]:e==="light"?i.light=Jm(i.main,t):e==="dark"&&(i.dark=Zm(i.main,s)))}function PR(i="light"){return i==="dark"?{main:hc[200],light:hc[50],dark:hc[400]}:{main:hc[700],light:hc[400],dark:hc[800]}}function RR(i="light"){return i==="dark"?{main:fc[200],light:fc[50],dark:fc[400]}:{main:fc[500],light:fc[300],dark:fc[700]}}function NR(i="light"){return i==="dark"?{main:dc[500],light:dc[300],dark:dc[700]}:{main:dc[700],light:dc[400],dark:dc[800]}}function CR(i="light"){return i==="dark"?{main:pc[400],light:pc[300],dark:pc[700]}:{main:pc[700],light:pc[500],dark:pc[900]}}function MR(i="light"){return i==="dark"?{main:yc[400],light:yc[300],dark:yc[700]}:{main:yc[800],light:yc[500],dark:yc[900]}}function BR(i="light"){return i==="dark"?{main:xl[400],light:xl[300],dark:xl[700]}:{main:"#ed6c02",light:xl[500],dark:xl[900]}}function rw(i){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...t}=i,s=i.primary||PR(e),a=i.secondary||RR(e),c=i.error||NR(e),u=i.info||CR(e),l=i.success||MR(e),h=i.warning||BR(e);function f(b){return FP(b,a2.text.primary)>=n?a2.text.primary:AR.text.primary}const m=({color:b,name:g,mainShade:v=500,lightShade:_=300,darkShade:S=700})=>{if(b={...b},!b.main&&b[v]&&(b.main=b[v]),!b.hasOwnProperty("main"))throw new Error(hs(11,g?` (${g})`:"",v));if(typeof b.main!="string")throw new Error(hs(12,g?` (${g})`:"",JSON.stringify(b.main)));return s2(b,"light",_,r),s2(b,"dark",S,r),b.contrastText||(b.contrastText=f(b.main)),b};let d;return e==="light"?d=O4():e==="dark"&&(d=A4()),Un({common:{...of},mode:e,primary:m({color:s,name:"primary"}),secondary:m({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:c,name:"error"}),warning:m({color:h,name:"warning"}),info:m({color:u,name:"info"}),success:m({color:l,name:"success"}),grey:_5,contrastThreshold:n,getContrastText:f,augmentColor:m,tonalOffset:r,...d},t)}function DR(i){const e={};return Object.entries(i).forEach(r=>{const[t,s]=r;typeof s=="object"&&(e[t]=`${s.fontStyle?`${s.fontStyle} `:""}${s.fontVariant?`${s.fontVariant} `:""}${s.fontWeight?`${s.fontWeight} `:""}${s.fontStretch?`${s.fontStretch} `:""}${s.fontSize||""}${s.lineHeight?`/${s.lineHeight} `:""}${s.fontFamily||""}`)}),e}function LR(i,e){return{toolbar:{minHeight:56,[i.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[i.up("sm")]:{minHeight:64}},...e}}function FR(i){return Math.round(i*1e5)/1e5}const o2={textTransform:"uppercase"},c2='"Roboto", "Helvetica", "Arial", sans-serif';function P4(i,e){const{fontFamily:n=c2,fontSize:r=14,fontWeightLight:t=300,fontWeightRegular:s=400,fontWeightMedium:a=500,fontWeightBold:c=700,htmlFontSize:u=16,allVariants:l,pxToRem:h,...f}=typeof e=="function"?e(i):e,m=r/14,d=h||(g=>`${g/u*m}rem`),y=(g,v,_,S,I)=>({fontFamily:n,fontWeight:g,fontSize:d(v),lineHeight:_,...n===c2?{letterSpacing:`${FR(S/v)}em`}:{},...I,...l}),b={h1:y(t,96,1.167,-1.5),h2:y(t,60,1.2,-.5),h3:y(s,48,1.167,0),h4:y(s,34,1.235,.25),h5:y(s,24,1.334,0),h6:y(a,20,1.6,.15),subtitle1:y(s,16,1.75,.15),subtitle2:y(a,14,1.57,.1),body1:y(s,16,1.5,.15),body2:y(s,14,1.43,.15),button:y(a,14,1.75,.4,o2),caption:y(s,12,1.66,.4),overline:y(s,12,2.66,1,o2),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Un({htmlFontSize:u,pxToRem:d,fontFamily:n,fontSize:r,fontWeightLight:t,fontWeightRegular:s,fontWeightMedium:a,fontWeightBold:c,...b},f,{clone:!1})}const UR=.2,HR=.14,qR=.12;function Vt(...i){return[`${i[0]}px ${i[1]}px ${i[2]}px ${i[3]}px rgba(0,0,0,${UR})`,`${i[4]}px ${i[5]}px ${i[6]}px ${i[7]}px rgba(0,0,0,${HR})`,`${i[8]}px ${i[9]}px ${i[10]}px ${i[11]}px rgba(0,0,0,${qR})`].join(",")}const jR=["none",Vt(0,2,1,-1,0,1,1,0,0,1,3,0),Vt(0,3,1,-2,0,2,2,0,0,1,5,0),Vt(0,3,3,-2,0,3,4,0,0,1,8,0),Vt(0,2,4,-1,0,4,5,0,0,1,10,0),Vt(0,3,5,-1,0,5,8,0,0,1,14,0),Vt(0,3,5,-1,0,6,10,0,0,1,18,0),Vt(0,4,5,-2,0,7,10,1,0,2,16,1),Vt(0,5,5,-3,0,8,10,1,0,3,14,2),Vt(0,5,6,-3,0,9,12,1,0,3,16,2),Vt(0,6,6,-3,0,10,14,1,0,4,18,3),Vt(0,6,7,-4,0,11,15,1,0,4,20,3),Vt(0,7,8,-4,0,12,17,2,0,5,22,4),Vt(0,7,8,-4,0,13,19,2,0,5,24,4),Vt(0,7,9,-4,0,14,21,2,0,5,26,4),Vt(0,8,9,-5,0,15,22,2,0,6,28,5),Vt(0,8,10,-5,0,16,24,2,0,6,30,5),Vt(0,8,11,-5,0,17,26,2,0,6,32,5),Vt(0,9,11,-5,0,18,28,2,0,7,34,6),Vt(0,9,12,-6,0,19,29,2,0,7,36,6),Vt(0,10,13,-6,0,20,31,3,0,8,38,7),Vt(0,10,13,-6,0,21,33,3,0,8,40,7),Vt(0,10,14,-6,0,22,35,3,0,8,42,7),Vt(0,11,14,-7,0,23,36,3,0,9,44,8),Vt(0,11,15,-7,0,24,38,3,0,9,46,8)],VR={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},KR={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function u2(i){return`${Math.round(i)}ms`}function WR(i){if(!i)return 0;const e=i/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function $R(i){const e={...VR,...i.easing},n={...KR,...i.duration};return{getAutoHeightDuration:WR,create:(t=["all"],s={})=>{const{duration:a=n.standard,easing:c=e.easeInOut,delay:u=0,...l}=s;return(Array.isArray(t)?t:[t]).map(h=>`${h} ${typeof a=="string"?a:u2(a)} ${c} ${typeof u=="string"?u:u2(u)}`).join(",")},...i,easing:e,duration:n}}const zR={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function GR(i){return Rr(i)||typeof i>"u"||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||Array.isArray(i)}function R4(i={}){const e={...i};function n(r){const t=Object.entries(r);for(let s=0;s<t.length;s++){const[a,c]=t[s];!GR(c)||a.startsWith("unstable_")?delete r[a]:Rr(c)&&(r[a]={...c},n(r[a]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function am(i={},...e){const{breakpoints:n,mixins:r={},spacing:t,palette:s={},transitions:a={},typography:c={},shape:u,...l}=i;if(i.vars&&i.generateThemeVars===void 0)throw new Error(hs(20));const h=rw(s),f=_f(i);let m=Un(f,{mixins:LR(f.breakpoints,r),palette:h,shadows:jR.slice(),typography:P4(h,c),transitions:$R(a),zIndex:{...zR}});return m=Un(m,l),m=e.reduce((d,y)=>Un(d,y),m),m.unstable_sxConfig={...xf,...l==null?void 0:l.unstable_sxConfig},m.unstable_sx=function(y){return ps({sx:y,theme:this})},m.toRuntimeSource=R4,m}function sm(i){let e;return i<1?e=5.11916*i**2:e=4.5*Math.log(i+1)+2,Math.round(e*10)/1e3}const XR=[...Array(25)].map((i,e)=>{if(e===0)return"none";const n=sm(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function N4(i){return{inputPlaceholder:i==="dark"?.5:.42,inputUnderline:i==="dark"?.7:.42,switchTrackDisabled:i==="dark"?.2:.12,switchTrack:i==="dark"?.3:.38}}function C4(i){return i==="dark"?XR:[]}function YR(i){const{palette:e={mode:"light"},opacity:n,overlays:r,...t}=i,s=rw(e);return{palette:s,opacity:{...N4(s.mode),...n},overlays:r||C4(s.mode),...t}}function QR(i){var e;return!!i[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!i[0].match(/sxConfig$/)||i[0]==="palette"&&!!((e=i[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const ZR=i=>[...[...Array(25)].map((e,n)=>`--${i?`${i}-`:""}overlays-${n}`),`--${i?`${i}-`:""}palette-AppBar-darkBg`,`--${i?`${i}-`:""}palette-AppBar-darkColor`],JR=i=>(e,n)=>{const r=i.rootSelector||":root",t=i.colorSchemeSelector;let s=t;if(t==="class"&&(s=".%s"),t==="data"&&(s="[data-%s]"),t!=null&&t.startsWith("data-")&&!t.includes("%s")&&(s=`[${t}="%s"]`),i.defaultColorScheme===e){if(e==="dark"){const a={};return ZR(i.cssVarPrefix).forEach(c=>{a[c]=n[c],delete n[c]}),s==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:a}}:s?{[s.replace("%s",e)]:a,[`${r}, ${s.replace("%s",e)}`]:n}:{[r]:{...n,...a}}}if(s&&s!=="media")return`${r}, ${s.replace("%s",String(e))}`}else if(e){if(s==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(s)return s.replace("%s",String(e))}return r};function e7(i,e){e.forEach(n=>{i[n]||(i[n]={})})}function ge(i,e,n){!i[e]&&n&&(i[e]=n)}function Wd(i){return typeof i!="string"||!i.startsWith("hsl")?i:g4(i)}function ca(i,e){`${e}Channel`in i||(i[`${e}Channel`]=Kd(Wd(i[e])))}function t7(i){return typeof i=="number"?`${i}px`:typeof i=="string"||typeof i=="function"||Array.isArray(i)?i:"8px"}const Tr=i=>{try{return i()}catch{}},n7=(i="mui")=>fR(i);function lb(i,e,n,r){if(!e)return;e=e===!0?{}:e;const t=r==="dark"?"dark":"light";if(!n){i[r]=YR({...e,palette:{mode:t,...e==null?void 0:e.palette}});return}const{palette:s,...a}=am({...n,palette:{mode:t,...e==null?void 0:e.palette}});return i[r]={...e,palette:s,opacity:{...N4(t),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||C4(t)},a}function i7(i={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:t=!1,cssVarPrefix:s="mui",shouldSkipGeneratingVar:a=QR,colorSchemeSelector:c=n.light&&n.dark?"media":void 0,rootSelector:u=":root",...l}=i,h=Object.keys(n)[0],f=r||(n.light&&h!=="light"?"light":h),m=n7(s),{[f]:d,light:y,dark:b,...g}=n,v={...g};let _=d;if((f==="dark"&&!("dark"in n)||f==="light"&&!("light"in n))&&(_=!0),!_)throw new Error(hs(21,f));const S=lb(v,_,l,f);y&&!v.light&&lb(v,y,void 0,"light"),b&&!v.dark&&lb(v,b,void 0,"dark");let I={defaultColorScheme:f,...S,cssVarPrefix:s,colorSchemeSelector:c,rootSelector:u,getCssVar:m,colorSchemes:v,font:{...DR(S.typography),...S.font},spacing:t7(l.spacing)};Object.keys(I.colorSchemes).forEach(P=>{const T=I.colorSchemes[P].palette,M=C=>{const D=C.split("-"),F=D[1],B=D[2];return m(C,T[F][B])};if(T.mode==="light"&&(ge(T.common,"background","#fff"),ge(T.common,"onBackground","#000")),T.mode==="dark"&&(ge(T.common,"background","#000"),ge(T.common,"onBackground","#fff")),e7(T,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),T.mode==="light"){ge(T.Alert,"errorColor",Rt(T.error.light,.6)),ge(T.Alert,"infoColor",Rt(T.info.light,.6)),ge(T.Alert,"successColor",Rt(T.success.light,.6)),ge(T.Alert,"warningColor",Rt(T.warning.light,.6)),ge(T.Alert,"errorFilledBg",M("palette-error-main")),ge(T.Alert,"infoFilledBg",M("palette-info-main")),ge(T.Alert,"successFilledBg",M("palette-success-main")),ge(T.Alert,"warningFilledBg",M("palette-warning-main")),ge(T.Alert,"errorFilledColor",Tr(()=>T.getContrastText(T.error.main))),ge(T.Alert,"infoFilledColor",Tr(()=>T.getContrastText(T.info.main))),ge(T.Alert,"successFilledColor",Tr(()=>T.getContrastText(T.success.main))),ge(T.Alert,"warningFilledColor",Tr(()=>T.getContrastText(T.warning.main))),ge(T.Alert,"errorStandardBg",Nt(T.error.light,.9)),ge(T.Alert,"infoStandardBg",Nt(T.info.light,.9)),ge(T.Alert,"successStandardBg",Nt(T.success.light,.9)),ge(T.Alert,"warningStandardBg",Nt(T.warning.light,.9)),ge(T.Alert,"errorIconColor",M("palette-error-main")),ge(T.Alert,"infoIconColor",M("palette-info-main")),ge(T.Alert,"successIconColor",M("palette-success-main")),ge(T.Alert,"warningIconColor",M("palette-warning-main")),ge(T.AppBar,"defaultBg",M("palette-grey-100")),ge(T.Avatar,"defaultBg",M("palette-grey-400")),ge(T.Button,"inheritContainedBg",M("palette-grey-300")),ge(T.Button,"inheritContainedHoverBg",M("palette-grey-A100")),ge(T.Chip,"defaultBorder",M("palette-grey-400")),ge(T.Chip,"defaultAvatarColor",M("palette-grey-700")),ge(T.Chip,"defaultIconColor",M("palette-grey-700")),ge(T.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),ge(T.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),ge(T.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),ge(T.LinearProgress,"primaryBg",Nt(T.primary.main,.62)),ge(T.LinearProgress,"secondaryBg",Nt(T.secondary.main,.62)),ge(T.LinearProgress,"errorBg",Nt(T.error.main,.62)),ge(T.LinearProgress,"infoBg",Nt(T.info.main,.62)),ge(T.LinearProgress,"successBg",Nt(T.success.main,.62)),ge(T.LinearProgress,"warningBg",Nt(T.warning.main,.62)),ge(T.Skeleton,"bg",`rgba(${M("palette-text-primaryChannel")} / 0.11)`),ge(T.Slider,"primaryTrack",Nt(T.primary.main,.62)),ge(T.Slider,"secondaryTrack",Nt(T.secondary.main,.62)),ge(T.Slider,"errorTrack",Nt(T.error.main,.62)),ge(T.Slider,"infoTrack",Nt(T.info.main,.62)),ge(T.Slider,"successTrack",Nt(T.success.main,.62)),ge(T.Slider,"warningTrack",Nt(T.warning.main,.62));const C=$h(T.background.default,.8);ge(T.SnackbarContent,"bg",C),ge(T.SnackbarContent,"color",Tr(()=>T.getContrastText(C))),ge(T.SpeedDialAction,"fabHoverBg",$h(T.background.paper,.15)),ge(T.StepConnector,"border",M("palette-grey-400")),ge(T.StepContent,"border",M("palette-grey-400")),ge(T.Switch,"defaultColor",M("palette-common-white")),ge(T.Switch,"defaultDisabledColor",M("palette-grey-100")),ge(T.Switch,"primaryDisabledColor",Nt(T.primary.main,.62)),ge(T.Switch,"secondaryDisabledColor",Nt(T.secondary.main,.62)),ge(T.Switch,"errorDisabledColor",Nt(T.error.main,.62)),ge(T.Switch,"infoDisabledColor",Nt(T.info.main,.62)),ge(T.Switch,"successDisabledColor",Nt(T.success.main,.62)),ge(T.Switch,"warningDisabledColor",Nt(T.warning.main,.62)),ge(T.TableCell,"border",Nt(Wh(T.divider,1),.88)),ge(T.Tooltip,"bg",Wh(T.grey[700],.92))}if(T.mode==="dark"){ge(T.Alert,"errorColor",Nt(T.error.light,.6)),ge(T.Alert,"infoColor",Nt(T.info.light,.6)),ge(T.Alert,"successColor",Nt(T.success.light,.6)),ge(T.Alert,"warningColor",Nt(T.warning.light,.6)),ge(T.Alert,"errorFilledBg",M("palette-error-dark")),ge(T.Alert,"infoFilledBg",M("palette-info-dark")),ge(T.Alert,"successFilledBg",M("palette-success-dark")),ge(T.Alert,"warningFilledBg",M("palette-warning-dark")),ge(T.Alert,"errorFilledColor",Tr(()=>T.getContrastText(T.error.dark))),ge(T.Alert,"infoFilledColor",Tr(()=>T.getContrastText(T.info.dark))),ge(T.Alert,"successFilledColor",Tr(()=>T.getContrastText(T.success.dark))),ge(T.Alert,"warningFilledColor",Tr(()=>T.getContrastText(T.warning.dark))),ge(T.Alert,"errorStandardBg",Rt(T.error.light,.9)),ge(T.Alert,"infoStandardBg",Rt(T.info.light,.9)),ge(T.Alert,"successStandardBg",Rt(T.success.light,.9)),ge(T.Alert,"warningStandardBg",Rt(T.warning.light,.9)),ge(T.Alert,"errorIconColor",M("palette-error-main")),ge(T.Alert,"infoIconColor",M("palette-info-main")),ge(T.Alert,"successIconColor",M("palette-success-main")),ge(T.Alert,"warningIconColor",M("palette-warning-main")),ge(T.AppBar,"defaultBg",M("palette-grey-900")),ge(T.AppBar,"darkBg",M("palette-background-paper")),ge(T.AppBar,"darkColor",M("palette-text-primary")),ge(T.Avatar,"defaultBg",M("palette-grey-600")),ge(T.Button,"inheritContainedBg",M("palette-grey-800")),ge(T.Button,"inheritContainedHoverBg",M("palette-grey-700")),ge(T.Chip,"defaultBorder",M("palette-grey-700")),ge(T.Chip,"defaultAvatarColor",M("palette-grey-300")),ge(T.Chip,"defaultIconColor",M("palette-grey-300")),ge(T.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),ge(T.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),ge(T.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),ge(T.LinearProgress,"primaryBg",Rt(T.primary.main,.5)),ge(T.LinearProgress,"secondaryBg",Rt(T.secondary.main,.5)),ge(T.LinearProgress,"errorBg",Rt(T.error.main,.5)),ge(T.LinearProgress,"infoBg",Rt(T.info.main,.5)),ge(T.LinearProgress,"successBg",Rt(T.success.main,.5)),ge(T.LinearProgress,"warningBg",Rt(T.warning.main,.5)),ge(T.Skeleton,"bg",`rgba(${M("palette-text-primaryChannel")} / 0.13)`),ge(T.Slider,"primaryTrack",Rt(T.primary.main,.5)),ge(T.Slider,"secondaryTrack",Rt(T.secondary.main,.5)),ge(T.Slider,"errorTrack",Rt(T.error.main,.5)),ge(T.Slider,"infoTrack",Rt(T.info.main,.5)),ge(T.Slider,"successTrack",Rt(T.success.main,.5)),ge(T.Slider,"warningTrack",Rt(T.warning.main,.5));const C=$h(T.background.default,.98);ge(T.SnackbarContent,"bg",C),ge(T.SnackbarContent,"color",Tr(()=>T.getContrastText(C))),ge(T.SpeedDialAction,"fabHoverBg",$h(T.background.paper,.15)),ge(T.StepConnector,"border",M("palette-grey-600")),ge(T.StepContent,"border",M("palette-grey-600")),ge(T.Switch,"defaultColor",M("palette-grey-300")),ge(T.Switch,"defaultDisabledColor",M("palette-grey-600")),ge(T.Switch,"primaryDisabledColor",Rt(T.primary.main,.55)),ge(T.Switch,"secondaryDisabledColor",Rt(T.secondary.main,.55)),ge(T.Switch,"errorDisabledColor",Rt(T.error.main,.55)),ge(T.Switch,"infoDisabledColor",Rt(T.info.main,.55)),ge(T.Switch,"successDisabledColor",Rt(T.success.main,.55)),ge(T.Switch,"warningDisabledColor",Rt(T.warning.main,.55)),ge(T.TableCell,"border",Rt(Wh(T.divider,1),.68)),ge(T.Tooltip,"bg",Wh(T.grey[700],.92))}ca(T.background,"default"),ca(T.background,"paper"),ca(T.common,"background"),ca(T.common,"onBackground"),ca(T,"divider"),Object.keys(T).forEach(C=>{const D=T[C];C!=="tonalOffset"&&D&&typeof D=="object"&&(D.main&&ge(T[C],"mainChannel",Kd(Wd(D.main))),D.light&&ge(T[C],"lightChannel",Kd(Wd(D.light))),D.dark&&ge(T[C],"darkChannel",Kd(Wd(D.dark))),D.contrastText&&ge(T[C],"contrastTextChannel",Kd(Wd(D.contrastText))),C==="text"&&(ca(T[C],"primary"),ca(T[C],"secondary")),C==="action"&&(D.active&&ca(T[C],"active"),D.selected&&ca(T[C],"selected")))})}),I=e.reduce((P,T)=>Un(P,T),I);const A={prefix:s,disableCssColorScheme:t,shouldSkipGeneratingVar:a,getSelector:JR(I)},{vars:R,generateThemeVars:E,generateStyleSheets:k}=yR(I,A);return I.vars=R,Object.entries(I.colorSchemes[I.defaultColorScheme]).forEach(([P,T])=>{I[P]=T}),I.generateThemeVars=E,I.generateStyleSheets=k,I.generateSpacing=function(){return o4(l.spacing,f0(this))},I.getColorSchemeSelector=gR(c),I.spacing=I.generateSpacing(),I.shouldSkipGeneratingVar=a,I.unstable_sxConfig={...xf,...l==null?void 0:l.unstable_sxConfig},I.unstable_sx=function(T){return ps({sx:T,theme:this})},I.toRuntimeSource=R4,I}function l2(i,e,n){i.colorSchemes&&n&&(i.colorSchemes[e]={...n!==!0&&n,palette:rw({...n===!0?{}:n.palette,mode:e})})}function x0(i={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:t=n?void 0:{light:!0},defaultColorScheme:s=n==null?void 0:n.mode,...a}=i,c=s||"light",u=t==null?void 0:t[c],l={...t,...n?{[c]:{...typeof u!="boolean"&&u,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in i))return am(i,...e);let h=n;"palette"in i||l[c]&&(l[c]!==!0?h=l[c].palette:c==="dark"&&(h={mode:"dark"}));const f=am({...i,palette:h},...e);return f.defaultColorScheme=c,f.colorSchemes=l,f.palette.mode==="light"&&(f.colorSchemes.light={...l.light!==!0&&l.light,palette:f.palette},l2(f,"dark",l.dark)),f.palette.mode==="dark"&&(f.colorSchemes.dark={...l.dark!==!0&&l.dark,palette:f.palette},l2(f,"light",l.light)),f}return!n&&!("light"in l)&&c==="light"&&(l.light=!0),i7({...a,colorSchemes:l,defaultColorScheme:c,...typeof r!="boolean"&&r},...e)}function d2(i){return String(parseFloat(i)).length===String(i).length}function r7(i){return String(i).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Us(i){return parseFloat(i)}function a7(i){return(e,n)=>{const r=r7(e);if(r===n)return e;let t=Us(e);r!=="px"&&(r==="em"||r==="rem")&&(t=Us(e)*Us(i));let s=t;if(n!=="px")if(n==="em")s=t/Us(i);else if(n==="rem")s=t/Us(i);else return e;return parseFloat(s.toFixed(5))+n}}function s7({size:i,grid:e}){const n=i-i%e,r=n+e;return i-n<r-i?n:r}function o7({lineHeight:i,pixels:e,htmlFontSize:n}){return e/(i*n)}function c7({cssProperty:i,min:e,max:n,unit:r="rem",breakpoints:t=[600,900,1200],transform:s=null}){const a={[i]:`${e}${r}`},c=(n-e)/t[t.length-1];return t.forEach(u=>{let l=e+c*u;s!==null&&(l=s(l)),a[`@media (min-width:${u}px)`]={[i]:`${Math.round(l*1e4)/1e4}${r}`}}),a}function u7(i,e={}){const{breakpoints:n=["sm","md","lg"],disableAlign:r=!1,factor:t=2,variants:s=["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]}=e,a={...i};a.typography={...a.typography};const c=a.typography,u=a7(c.htmlFontSize),l=n.map(h=>a.breakpoints.values[h]);return s.forEach(h=>{const f=c[h];if(!f)return;const m=parseFloat(u(f.fontSize,"rem"));if(m<=1)return;const d=m,y=1+(d-1)/t;let{lineHeight:b}=f;if(!d2(b)&&!r)throw new Error(hs(6));d2(b)||(b=parseFloat(u(b,"rem"))/parseFloat(m));let g=null;r||(g=v=>s7({size:v,grid:o7({pixels:4,lineHeight:b,htmlFontSize:c.htmlFontSize})})),c[h]={...f,...c7({cssProperty:"fontSize",min:y,max:d,unit:"rem",breakpoints:l,transform:g})}}),a}const aw=x0();function bs(){const i=m0(aw);return i[Cr]||i}function l7(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const M4=i=>l7(i)&&i!=="classes",pt=h4({themeId:Cr,defaultTheme:aw,rootShouldForwardProp:M4});function db({theme:i,...e}){const n=Cr in i?i[Cr]:void 0;return J.jsx(k4,{...e,themeId:n?Cr:void 0,theme:n||i})}const zh={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:d7}=dR({themeId:Cr,theme:()=>x0({cssVariables:!0}),colorSchemeStorageKey:zh.colorSchemeStorageKey,modeStorageKey:zh.modeStorageKey,defaultColorScheme:{light:zh.defaultLightColorScheme,dark:zh.defaultDarkColorScheme},resolveTheme:i=>{const e={...i,typography:P4(i.palette,i.typography)};return e.unstable_sx=function(r){return ps({sx:r,theme:this})},e}}),f7=d7;function h7({theme:i,...e}){if(typeof i=="function")return J.jsx(db,{theme:i,...e});const n=Cr in i?i[Cr]:i;return"colorSchemes"in n?J.jsx(f7,{theme:i,...e}):"vars"in n?J.jsx(db,{theme:i,...e}):J.jsx(db,{theme:{...i,vars:null},...e})}function p7(i){return J.jsx(_P,{...i,defaultTheme:aw,themeId:Cr})}function B4(i){return function(n){return J.jsx(p7,{styles:typeof i=="function"?r=>i({theme:r,...n}):i})}}function y7(){return Ym}const On=iR;function rn(i){return nR(i)}function g7(i){return dn("MuiSvgIcon",i)}bn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const b7=i=>{const{color:e,fontSize:n,classes:r}=i,t={root:["root",e!=="inherit"&&`color${Le(e)}`,`fontSize${Le(n)}`]};return mn(t,g7,r)},m7=pt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.color!=="inherit"&&e[`color${Le(n.color)}`],e[`fontSize${Le(n.fontSize)}`]]}})(On(({theme:i})=>{var e,n,r,t,s,a,c,u,l,h,f,m,d,y;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(t=(e=i.transitions)==null?void 0:e.create)==null?void 0:t.call(e,"fill",{duration:(r=(n=(i.vars??i).transitions)==null?void 0:n.duration)==null?void 0:r.shorter}),variants:[{props:b=>!b.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((a=(s=i.typography)==null?void 0:s.pxToRem)==null?void 0:a.call(s,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((u=(c=i.typography)==null?void 0:c.pxToRem)==null?void 0:u.call(c,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((h=(l=i.typography)==null?void 0:l.pxToRem)==null?void 0:h.call(l,35))||"2.1875rem"}},...Object.entries((i.vars??i).palette).filter(([,b])=>b&&b.main).map(([b])=>{var g,v;return{props:{color:b},style:{color:(v=(g=(i.vars??i).palette)==null?void 0:g[b])==null?void 0:v.main}}}),{props:{color:"action"},style:{color:(m=(f=(i.vars??i).palette)==null?void 0:f.action)==null?void 0:m.active}},{props:{color:"disabled"},style:{color:(y=(d=(i.vars??i).palette)==null?void 0:d.action)==null?void 0:y.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),om=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiSvgIcon"}),{children:t,className:s,color:a="inherit",component:c="svg",fontSize:u="medium",htmlColor:l,inheritViewBox:h=!1,titleAccess:f,viewBox:m="0 0 24 24",...d}=r,y=Z.isValidElement(t)&&t.type==="svg",b={...r,color:a,component:c,fontSize:u,instanceFontSize:e.fontSize,inheritViewBox:h,viewBox:m,hasSvgAsChild:y},g={};h||(g.viewBox=m);const v=b7(b);return J.jsxs(m7,{as:c,className:Xe(v.root,s),focusable:"false",color:l,"aria-hidden":f?void 0:!0,role:f?"img":void 0,ref:n,...g,...d,...y&&t.props,ownerState:b,children:[y?t.props.children:t,f?J.jsx("title",{children:f}):null]})});om.muiName="SvgIcon";function Na(i,e){function n(r,t){return J.jsx(om,{"data-testid":void 0,ref:t,...r,children:i})}return n.muiName=om.muiName,Z.memo(Z.forwardRef(n))}function w7(i,e){const n=i.charCodeAt(2);return i[0]==="o"&&i[1]==="n"&&n>=65&&n<=90&&typeof e=="function"}function v7(i,e){if(!i)return e;function n(a,c){const u={};return Object.keys(c).forEach(l=>{w7(l,c[l])&&typeof a[l]=="function"&&(u[l]=(...h)=>{a[l](...h),c[l](...h)})}),u}if(typeof i=="function"||typeof e=="function")return a=>{const c=typeof e=="function"?e(a):e,u=typeof i=="function"?i({...a,...c}):i,l=Xe(a==null?void 0:a.className,c==null?void 0:c.className,u==null?void 0:u.className),h=n(u,c);return{...c,...u,...h,...!!l&&{className:l},...(c==null?void 0:c.style)&&(u==null?void 0:u.style)&&{style:{...c.style,...u.style}},...(c==null?void 0:c.sx)&&(u==null?void 0:u.sx)&&{sx:[...Array.isArray(c.sx)?c.sx:[c.sx],...Array.isArray(u.sx)?u.sx:[u.sx]]}}};const r=e,t=n(i,r),s=Xe(r==null?void 0:r.className,i==null?void 0:i.className);return{...e,...i,...t,...!!s&&{className:s},...(r==null?void 0:r.style)&&(i==null?void 0:i.style)&&{style:{...r.style,...i.style}},...(r==null?void 0:r.sx)&&(i==null?void 0:i.sx)&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(i.sx)?i.sx:[i.sx]]}}}function D4(i,e){if(i==null)return{};var n={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.indexOf(r)!==-1)continue;n[r]=i[r]}return n}function cm(i,e){return cm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},cm(i,e)}function L4(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,cm(i,e)}var F4=H8();const Gh=F8(F4),f2={disabled:!1},Xp=Nr.createContext(null);var x7=function(e){return e.scrollTop},$d="unmounted",yo="exited",go="entering",Zc="entered",um="exiting",pr=function(i){L4(e,i);function e(r,t){var s;s=i.call(this,r,t)||this;var a=t,c=a&&!a.isMounting?r.enter:r.appear,u;return s.appearStatus=null,r.in?c?(u=yo,s.appearStatus=go):u=Zc:r.unmountOnExit||r.mountOnEnter?u=$d:u=yo,s.state={status:u},s.nextCallback=null,s}e.getDerivedStateFromProps=function(t,s){var a=t.in;return a&&s.status===$d?{status:yo}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(t){var s=null;if(t!==this.props){var a=this.state.status;this.props.in?a!==go&&a!==Zc&&(s=go):(a===go||a===Zc)&&(s=um)}this.updateStatus(!1,s)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var t=this.props.timeout,s,a,c;return s=a=c=t,t!=null&&typeof t!="number"&&(s=t.exit,a=t.enter,c=t.appear!==void 0?t.appear:a),{exit:s,enter:a,appear:c}},n.updateStatus=function(t,s){if(t===void 0&&(t=!1),s!==null)if(this.cancelNextCallback(),s===go){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Gh.findDOMNode(this);a&&x7(a)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===yo&&this.setState({status:$d})},n.performEnter=function(t){var s=this,a=this.props.enter,c=this.context?this.context.isMounting:t,u=this.props.nodeRef?[c]:[Gh.findDOMNode(this),c],l=u[0],h=u[1],f=this.getTimeouts(),m=c?f.appear:f.enter;if(!t&&!a||f2.disabled){this.safeSetState({status:Zc},function(){s.props.onEntered(l)});return}this.props.onEnter(l,h),this.safeSetState({status:go},function(){s.props.onEntering(l,h),s.onTransitionEnd(m,function(){s.safeSetState({status:Zc},function(){s.props.onEntered(l,h)})})})},n.performExit=function(){var t=this,s=this.props.exit,a=this.getTimeouts(),c=this.props.nodeRef?void 0:Gh.findDOMNode(this);if(!s||f2.disabled){this.safeSetState({status:yo},function(){t.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:um},function(){t.props.onExiting(c),t.onTransitionEnd(a.exit,function(){t.safeSetState({status:yo},function(){t.props.onExited(c)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(t,s){s=this.setNextCallback(s),this.setState(t,s)},n.setNextCallback=function(t){var s=this,a=!0;return this.nextCallback=function(c){a&&(a=!1,s.nextCallback=null,t(c))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},n.onTransitionEnd=function(t,s){this.setNextCallback(s);var a=this.props.nodeRef?this.props.nodeRef.current:Gh.findDOMNode(this),c=t==null&&!this.props.addEndListener;if(!a||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],l=u[0],h=u[1];this.props.addEndListener(l,h)}t!=null&&setTimeout(this.nextCallback,t)},n.render=function(){var t=this.state.status;if(t===$d)return null;var s=this.props,a=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var c=D4(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Nr.createElement(Xp.Provider,{value:null},typeof a=="function"?a(t,c):Nr.cloneElement(Nr.Children.only(a),c))},e}(Nr.Component);pr.contextType=Xp;pr.propTypes={};function gc(){}pr.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:gc,onEntering:gc,onEntered:gc,onExit:gc,onExiting:gc,onExited:gc};pr.UNMOUNTED=$d;pr.EXITED=yo;pr.ENTERING=go;pr.ENTERED=Zc;pr.EXITING=um;function _7(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function sw(i,e){var n=function(s){return e&&Z.isValidElement(s)?e(s):s},r=Object.create(null);return i&&Z.Children.map(i,function(t){return t}).forEach(function(t){r[t.key]=n(t)}),r}function S7(i,e){i=i||{},e=e||{};function n(h){return h in e?e[h]:i[h]}var r=Object.create(null),t=[];for(var s in i)s in e?t.length&&(r[s]=t,t=[]):t.push(s);var a,c={};for(var u in e){if(r[u])for(a=0;a<r[u].length;a++){var l=r[u][a];c[r[u][a]]=n(l)}c[u]=n(u)}for(a=0;a<t.length;a++)c[t[a]]=n(t[a]);return c}function _o(i,e,n){return n[e]!=null?n[e]:i.props[e]}function I7(i,e){return sw(i.children,function(n){return Z.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:_o(n,"appear",i),enter:_o(n,"enter",i),exit:_o(n,"exit",i)})})}function T7(i,e,n){var r=sw(i.children),t=S7(e,r);return Object.keys(t).forEach(function(s){var a=t[s];if(Z.isValidElement(a)){var c=s in e,u=s in r,l=e[s],h=Z.isValidElement(l)&&!l.props.in;u&&(!c||h)?t[s]=Z.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:_o(a,"exit",i),enter:_o(a,"enter",i)}):!u&&c&&!h?t[s]=Z.cloneElement(a,{in:!1}):u&&c&&Z.isValidElement(l)&&(t[s]=Z.cloneElement(a,{onExited:n.bind(null,a),in:l.props.in,exit:_o(a,"exit",i),enter:_o(a,"enter",i)}))}}),t}var k7=Object.values||function(i){return Object.keys(i).map(function(e){return i[e]})},E7={component:"div",childFactory:function(e){return e}},ow=function(i){L4(e,i);function e(r,t){var s;s=i.call(this,r,t)||this;var a=s.handleExited.bind(_7(s));return s.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},s}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(t,s){var a=s.children,c=s.handleExited,u=s.firstRender;return{children:u?I7(t,c):T7(t,a,c),firstRender:!1}},n.handleExited=function(t,s){var a=sw(this.props.children);t.key in a||(t.props.onExited&&t.props.onExited(s),this.mounted&&this.setState(function(c){var u=Kp({},c.children);return delete u[t.key],{children:u}}))},n.render=function(){var t=this.props,s=t.component,a=t.childFactory,c=D4(t,["component","childFactory"]),u=this.state.contextValue,l=k7(this.state.children).map(a);return delete c.appear,delete c.enter,delete c.exit,s===null?Nr.createElement(Xp.Provider,{value:u},l):Nr.createElement(Xp.Provider,{value:u},Nr.createElement(s,c,l))},e}(Nr.Component);ow.propTypes={};ow.defaultProps=E7;const cw=i=>i.scrollTop;function hu(i,e){const{timeout:n,easing:r,style:t={}}=i;return{duration:t.transitionDuration??(typeof n=="number"?n:n[e.mode]||0),easing:t.transitionTimingFunction??(typeof r=="object"?r[e.mode]:r),delay:t.transitionDelay}}function O7(i){return dn("MuiPaper",i)}bn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const A7=i=>{const{square:e,elevation:n,variant:r,classes:t}=i,s={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return mn(s,O7,t)},P7=pt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(On(({theme:i})=>({backgroundColor:(i.vars||i).palette.background.paper,color:(i.vars||i).palette.text.primary,transition:i.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:i.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(i.vars||i).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Sf=Z.forwardRef(function(e,n){var d;const r=rn({props:e,name:"MuiPaper"}),t=bs(),{className:s,component:a="div",elevation:c=1,square:u=!1,variant:l="elevation",...h}=r,f={...r,component:a,elevation:c,square:u,variant:l},m=A7(f);return J.jsx(P7,{as:a,ownerState:f,className:Xe(m.root,s),ref:n,...h,style:{...l==="elevation"&&{"--Paper-shadow":(t.vars||t).shadows[c],...t.vars&&{"--Paper-overlay":(d=t.vars.overlays)==null?void 0:d[c]},...!t.vars&&t.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${En("#fff",sm(c))}, ${En("#fff",sm(c))})`}},...h.style}})});function Hi(i,e){const{className:n,elementType:r,ownerState:t,externalForwardedProps:s,internalForwardedProps:a,shouldForwardComponentProp:c=!1,...u}=e,{component:l,slots:h={[i]:void 0},slotProps:f={[i]:void 0},...m}=s,d=h[i]||r,y=_4(f[i],t),{props:{component:b,...g},internalRef:v}=x4({className:n,...u,externalForwardedProps:i==="root"?m:void 0,externalSlotProps:y}),_=Zn(v,y==null?void 0:y.ref,e.ref),S=i==="root"?b||l:b,I=w4(d,{...i==="root"&&!l&&!h[i]&&a,...i!=="root"&&!h[i]&&a,...g,...S&&!c&&{as:S},...S&&c&&{component:S},ref:_},t);return[d,I]}class Yp{constructor(){te(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Yp}static use(){const e=m4(Yp.create).current,[n,r]=Z.useState(!1);return e.shouldMount=n,e.setShouldMount=r,Z.useEffect(e.mountEffect,[n]),e}mount(){return this.mounted||(this.mounted=N7(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.start(...e)})}stop(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.stop(...e)})}pulsate(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.pulsate(...e)})}}function R7(){return Yp.use()}function N7(){let i,e;const n=new Promise((r,t)=>{i=r,e=t});return n.resolve=i,n.reject=e,n}function C7(i){const{className:e,classes:n,pulsate:r=!1,rippleX:t,rippleY:s,rippleSize:a,in:c,onExited:u,timeout:l}=i,[h,f]=Z.useState(!1),m=Xe(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),d={width:a,height:a,top:-(a/2)+s,left:-(a/2)+t},y=Xe(n.child,h&&n.childLeaving,r&&n.childPulsate);return!c&&!h&&f(!0),Z.useEffect(()=>{if(!c&&u!=null){const b=setTimeout(u,l);return()=>{clearTimeout(b)}}},[u,c,l]),J.jsx("span",{className:m,style:d,children:J.jsx("span",{className:y})})}const Fi=bn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),lm=550,M7=80,B7=wf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,D7=wf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,L7=wf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,F7=pt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),U7=pt(C7,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Fi.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${B7};
    animation-duration: ${lm}ms;
    animation-timing-function: ${({theme:i})=>i.transitions.easing.easeInOut};
  }

  &.${Fi.ripplePulsate} {
    animation-duration: ${({theme:i})=>i.transitions.duration.shorter}ms;
  }

  & .${Fi.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Fi.childLeaving} {
    opacity: 0;
    animation-name: ${D7};
    animation-duration: ${lm}ms;
    animation-timing-function: ${({theme:i})=>i.transitions.easing.easeInOut};
  }

  & .${Fi.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${L7};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:i})=>i.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,H7=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiTouchRipple"}),{center:t=!1,classes:s={},className:a,...c}=r,[u,l]=Z.useState([]),h=Z.useRef(0),f=Z.useRef(null);Z.useEffect(()=>{f.current&&(f.current(),f.current=null)},[u]);const m=Z.useRef(!1),d=iu(),y=Z.useRef(null),b=Z.useRef(null),g=Z.useCallback(I=>{const{pulsate:A,rippleX:R,rippleY:E,rippleSize:k,cb:P}=I;l(T=>[...T,J.jsx(U7,{classes:{ripple:Xe(s.ripple,Fi.ripple),rippleVisible:Xe(s.rippleVisible,Fi.rippleVisible),ripplePulsate:Xe(s.ripplePulsate,Fi.ripplePulsate),child:Xe(s.child,Fi.child),childLeaving:Xe(s.childLeaving,Fi.childLeaving),childPulsate:Xe(s.childPulsate,Fi.childPulsate)},timeout:lm,pulsate:A,rippleX:R,rippleY:E,rippleSize:k},h.current)]),h.current+=1,f.current=P},[s]),v=Z.useCallback((I={},A={},R=()=>{})=>{const{pulsate:E=!1,center:k=t||A.pulsate,fakeElement:P=!1}=A;if((I==null?void 0:I.type)==="mousedown"&&m.current){m.current=!1;return}(I==null?void 0:I.type)==="touchstart"&&(m.current=!0);const T=P?null:b.current,M=T?T.getBoundingClientRect():{width:0,height:0,left:0,top:0};let C,D,F;if(k||I===void 0||I.clientX===0&&I.clientY===0||!I.clientX&&!I.touches)C=Math.round(M.width/2),D=Math.round(M.height/2);else{const{clientX:B,clientY:L}=I.touches&&I.touches.length>0?I.touches[0]:I;C=Math.round(B-M.left),D=Math.round(L-M.top)}if(k)F=Math.sqrt((2*M.width**2+M.height**2)/3),F%2===0&&(F+=1);else{const B=Math.max(Math.abs((T?T.clientWidth:0)-C),C)*2+2,L=Math.max(Math.abs((T?T.clientHeight:0)-D),D)*2+2;F=Math.sqrt(B**2+L**2)}I!=null&&I.touches?y.current===null&&(y.current=()=>{g({pulsate:E,rippleX:C,rippleY:D,rippleSize:F,cb:R})},d.start(M7,()=>{y.current&&(y.current(),y.current=null)})):g({pulsate:E,rippleX:C,rippleY:D,rippleSize:F,cb:R})},[t,g,d]),_=Z.useCallback(()=>{v({},{pulsate:!0})},[v]),S=Z.useCallback((I,A)=>{if(d.clear(),(I==null?void 0:I.type)==="touchend"&&y.current){y.current(),y.current=null,d.start(0,()=>{S(I,A)});return}y.current=null,l(R=>R.length>0?R.slice(1):R),f.current=A},[d]);return Z.useImperativeHandle(n,()=>({pulsate:_,start:v,stop:S}),[_,v,S]),J.jsx(F7,{className:Xe(Fi.root,s.root,a),ref:b,...c,children:J.jsx(ow,{component:null,exit:!0,children:u})})});function q7(i){return dn("MuiButtonBase",i)}const j7=bn("MuiButtonBase",["root","disabled","focusVisible"]),V7=i=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:t}=i,a=mn({root:["root",e&&"disabled",n&&"focusVisible"]},q7,t);return n&&r&&(a.root+=` ${r}`),a},K7=pt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(i,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${j7.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Qp=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiButtonBase"}),{action:t,centerRipple:s=!1,children:a,className:c,component:u="button",disabled:l=!1,disableRipple:h=!1,disableTouchRipple:f=!1,focusRipple:m=!1,focusVisibleClassName:d,LinkComponent:y="a",onBlur:b,onClick:g,onContextMenu:v,onDragLeave:_,onFocus:S,onFocusVisible:I,onKeyDown:A,onKeyUp:R,onMouseDown:E,onMouseLeave:k,onMouseUp:P,onTouchEnd:T,onTouchMove:M,onTouchStart:C,tabIndex:D=0,TouchRippleProps:F,touchRippleRef:B,type:L,...q}=r,K=Z.useRef(null),$=R7(),U=Zn($.ref,B),[z,G]=Z.useState(!1);l&&z&&G(!1),Z.useImperativeHandle(t,()=>({focusVisible:()=>{G(!0),K.current.focus()}}),[]);const ne=$.shouldMount&&!h&&!l;Z.useEffect(()=>{z&&m&&!h&&$.pulsate()},[h,m,z,$]);const ce=ua($,"start",E,f),Se=ua($,"stop",v,f),Ie=ua($,"stop",_,f),me=ua($,"stop",P,f),xe=ua($,"stop",de=>{z&&de.preventDefault(),k&&k(de)},f),ke=ua($,"start",C,f),Re=ua($,"stop",T,f),Ce=ua($,"stop",M,f),Ne=ua($,"stop",de=>{Gp(de.target)||G(!1),b&&b(de)},!1),We=ds(de=>{K.current||(K.current=de.currentTarget),Gp(de.target)&&(G(!0),I&&I(de)),S&&S(de)}),dt=()=>{const de=K.current;return u&&u!=="button"&&!(de.tagName==="A"&&de.href)},Ut=ds(de=>{m&&!de.repeat&&z&&de.key===" "&&$.stop(de,()=>{$.start(de)}),de.target===de.currentTarget&&dt()&&de.key===" "&&de.preventDefault(),A&&A(de),de.target===de.currentTarget&&dt()&&de.key==="Enter"&&!l&&(de.preventDefault(),g&&g(de))}),Ht=ds(de=>{m&&de.key===" "&&z&&!de.defaultPrevented&&$.stop(de,()=>{$.pulsate(de)}),R&&R(de),g&&de.target===de.currentTarget&&dt()&&de.key===" "&&!de.defaultPrevented&&g(de)});let Je=u;Je==="button"&&(q.href||q.to)&&(Je=y);const At={};Je==="button"?(At.type=L===void 0?"button":L,At.disabled=l):(!q.href&&!q.to&&(At.role="button"),l&&(At["aria-disabled"]=l));const Te=Zn(n,K),j={...r,centerRipple:s,component:u,disabled:l,disableRipple:h,disableTouchRipple:f,focusRipple:m,tabIndex:D,focusVisible:z},he=V7(j);return J.jsxs(K7,{as:Je,className:Xe(he.root,c),ownerState:j,onBlur:Ne,onClick:g,onContextMenu:Se,onFocus:We,onKeyDown:Ut,onKeyUp:Ht,onMouseDown:ce,onMouseLeave:xe,onMouseUp:me,onDragLeave:Ie,onTouchEnd:Re,onTouchMove:Ce,onTouchStart:ke,ref:Te,tabIndex:l?-1:D,type:L,...At,...q,children:[a,ne?J.jsx(H7,{ref:U,center:s,...F}):null]})});function ua(i,e,n,r=!1){return ds(t=>(n&&n(t),r||i[e](t),!0))}function W7(i){return typeof i.main=="string"}function $7(i,e=[]){if(!W7(i))return!1;for(const n of e)if(!i.hasOwnProperty(n)||typeof i[n]!="string")return!1;return!0}function ls(i=[]){return([,e])=>e&&$7(e,i)}function z7(i){return dn("MuiCircularProgress",i)}bn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const as=44,dm=wf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,fm=wf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,G7=typeof dm!="string"?$m`
        animation: ${dm} 1.4s linear infinite;
      `:null,X7=typeof fm!="string"?$m`
        animation: ${fm} 1.4s ease-in-out infinite;
      `:null,Y7=i=>{const{classes:e,variant:n,color:r,disableShrink:t}=i,s={root:["root",n,`color${Le(r)}`],svg:["svg"],circle:["circle",`circle${Le(n)}`,t&&"circleDisableShrink"]};return mn(s,z7,e)},Q7=pt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[n.variant],e[`color${Le(n.color)}`]]}})(On(({theme:i})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:i.transitions.create("transform")}},{props:{variant:"indeterminate"},style:G7||{animation:`${dm} 1.4s linear infinite`}},...Object.entries(i.palette).filter(ls()).map(([e])=>({props:{color:e},style:{color:(i.vars||i).palette[e].main}}))]}))),Z7=pt("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(i,e)=>e.svg})({display:"block"}),J7=pt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.circle,e[`circle${Le(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(On(({theme:i})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:i.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:X7||{animation:`${fm} 1.4s ease-in-out infinite`}}]}))),e9=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiCircularProgress"}),{className:t,color:s="primary",disableShrink:a=!1,size:c=40,style:u,thickness:l=3.6,value:h=0,variant:f="indeterminate",...m}=r,d={...r,color:s,disableShrink:a,size:c,thickness:l,value:h,variant:f},y=Y7(d),b={},g={},v={};if(f==="determinate"){const _=2*Math.PI*((as-l)/2);b.strokeDasharray=_.toFixed(3),v["aria-valuenow"]=Math.round(h),b.strokeDashoffset=`${((100-h)/100*_).toFixed(3)}px`,g.transform="rotate(-90deg)"}return J.jsx(Q7,{className:Xe(y.root,t),style:{width:c,height:c,...g,...u},ownerState:d,ref:n,role:"progressbar",...v,...m,children:J.jsx(Z7,{className:y.svg,ownerState:d,viewBox:`${as/2} ${as/2} ${as} ${as}`,children:J.jsx(J7,{className:y.circle,style:b,ownerState:d,cx:as,cy:as,r:(as-l)/2,fill:"none",strokeWidth:l})})})});function t9(i){return dn("MuiIconButton",i)}const h2=bn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),n9=i=>{const{classes:e,disabled:n,color:r,edge:t,size:s,loading:a}=i,c={root:["root",a&&"loading",n&&"disabled",r!=="default"&&`color${Le(r)}`,t&&`edge${Le(t)}`,`size${Le(s)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return mn(c,t9,e)},i9=pt(Qp,{name:"MuiIconButton",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.loading&&e.loading,n.color!=="default"&&e[`color${Le(n.color)}`],n.edge&&e[`edge${Le(n.edge)}`],e[`size${Le(n.size)}`]]}})(On(({theme:i})=>({textAlign:"center",flex:"0 0 auto",fontSize:i.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(i.vars||i).palette.action.active,transition:i.transitions.create("background-color",{duration:i.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":i.vars?`rgba(${i.vars.palette.action.activeChannel} / ${i.vars.palette.action.hoverOpacity})`:En(i.palette.action.active,i.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),On(({theme:i})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(i.palette).filter(ls()).map(([e])=>({props:{color:e},style:{color:(i.vars||i).palette[e].main}})),...Object.entries(i.palette).filter(ls()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":i.vars?`rgba(${(i.vars||i).palette[e].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:En((i.vars||i).palette[e].main,i.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:i.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:i.typography.pxToRem(28)}}],[`&.${h2.disabled}`]:{backgroundColor:"transparent",color:(i.vars||i).palette.action.disabled},[`&.${h2.loading}`]:{color:"transparent"}}))),r9=pt("span",{name:"MuiIconButton",slot:"LoadingIndicator",overridesResolver:(i,e)=>e.loadingIndicator})(({theme:i})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(i.vars||i).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),ou=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiIconButton"}),{edge:t=!1,children:s,className:a,color:c="default",disabled:u=!1,disableFocusRipple:l=!1,size:h="medium",id:f,loading:m=null,loadingIndicator:d,...y}=r,b=b4(f),g=d??J.jsx(e9,{"aria-labelledby":b,color:"inherit",size:16}),v={...r,edge:t,color:c,disabled:u,disableFocusRipple:l,loading:m,loadingIndicator:g,size:h},_=n9(v);return J.jsxs(i9,{id:m?b:f,className:Xe(_.root,a),centerRipple:!0,focusRipple:!l,disabled:u||m,ref:n,...y,ownerState:v,children:[typeof m=="boolean"&&J.jsx("span",{className:_.loadingWrapper,style:{display:"contents"},children:J.jsx(r9,{className:_.loadingIndicator,ownerState:v,children:m&&g})}),s]})});function a9(i){return dn("MuiTypography",i)}bn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const s9={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},o9=y7(),c9=i=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:t,variant:s,classes:a}=i,c={root:["root",s,i.align!=="inherit"&&`align${Le(e)}`,n&&"gutterBottom",r&&"noWrap",t&&"paragraph"]};return mn(c,a9,a)},u9=pt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${Le(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(On(({theme:i})=>{var e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(i.typography).filter(([n,r])=>n!=="inherit"&&r&&typeof r=="object").map(([n,r])=>({props:{variant:n},style:r})),...Object.entries(i.palette).filter(ls()).map(([n])=>({props:{color:n},style:{color:(i.vars||i).palette[n].main}})),...Object.entries(((e=i.palette)==null?void 0:e.text)||{}).filter(([,n])=>typeof n=="string").map(([n])=>({props:{color:`text${Le(n)}`},style:{color:(i.vars||i).palette.text[n]}})),{props:({ownerState:n})=>n.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:n})=>n.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:n})=>n.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:n})=>n.paragraph,style:{marginBottom:16}}]}})),p2={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Qt=Z.forwardRef(function(e,n){const{color:r,...t}=rn({props:e,name:"MuiTypography"}),s=!s9[r],a=o9({...t,...s&&{color:r}}),{align:c="inherit",className:u,component:l,gutterBottom:h=!1,noWrap:f=!1,paragraph:m=!1,variant:d="body1",variantMapping:y=p2,...b}=a,g={...a,align:c,color:r,className:u,component:l,gutterBottom:h,noWrap:f,paragraph:m,variant:d,variantMapping:y},v=l||(m?"p":y[d]||p2[d])||"span",_=c9(g);return J.jsx(u9,{as:v,ref:n,className:Xe(_.root,u),...b,ownerState:g,style:{...c!=="inherit"&&{"--Typography-textAlign":c},...b.style}})});var Gn="top",Vi="bottom",Ki="right",Xn="left",uw="auto",If=[Gn,Vi,Ki,Xn],pu="start",df="end",l9="clippingParents",U4="viewport",Sl="popper",d9="reference",y2=If.reduce(function(i,e){return i.concat([e+"-"+pu,e+"-"+df])},[]),H4=[].concat(If,[uw]).reduce(function(i,e){return i.concat([e,e+"-"+pu,e+"-"+df])},[]),f9="beforeRead",h9="read",p9="afterRead",y9="beforeMain",g9="main",b9="afterMain",m9="beforeWrite",w9="write",v9="afterWrite",x9=[f9,h9,p9,y9,g9,b9,m9,w9,v9];function Ur(i){return i?(i.nodeName||"").toLowerCase():null}function yi(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var e=i.ownerDocument;return e&&e.defaultView||window}return i}function Ao(i){var e=yi(i).Element;return i instanceof e||i instanceof Element}function qi(i){var e=yi(i).HTMLElement;return i instanceof e||i instanceof HTMLElement}function lw(i){if(typeof ShadowRoot>"u")return!1;var e=yi(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}function _9(i){var e=i.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},t=e.attributes[n]||{},s=e.elements[n];!qi(s)||!Ur(s)||(Object.assign(s.style,r),Object.keys(t).forEach(function(a){var c=t[a];c===!1?s.removeAttribute(a):s.setAttribute(a,c===!0?"":c)}))})}function S9(i){var e=i.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var t=e.elements[r],s=e.attributes[r]||{},a=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),c=a.reduce(function(u,l){return u[l]="",u},{});!qi(t)||!Ur(t)||(Object.assign(t.style,c),Object.keys(s).forEach(function(u){t.removeAttribute(u)}))})}}const I9={name:"applyStyles",enabled:!0,phase:"write",fn:_9,effect:S9,requires:["computeStyles"]};function Br(i){return i.split("-")[0]}var ko=Math.max,Zp=Math.min,yu=Math.round;function hm(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function q4(){return!/^((?!chrome|android).)*safari/i.test(hm())}function gu(i,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=i.getBoundingClientRect(),t=1,s=1;e&&qi(i)&&(t=i.offsetWidth>0&&yu(r.width)/i.offsetWidth||1,s=i.offsetHeight>0&&yu(r.height)/i.offsetHeight||1);var a=Ao(i)?yi(i):window,c=a.visualViewport,u=!q4()&&n,l=(r.left+(u&&c?c.offsetLeft:0))/t,h=(r.top+(u&&c?c.offsetTop:0))/s,f=r.width/t,m=r.height/s;return{width:f,height:m,top:h,right:l+f,bottom:h+m,left:l,x:l,y:h}}function dw(i){var e=gu(i),n=i.offsetWidth,r=i.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:i.offsetLeft,y:i.offsetTop,width:n,height:r}}function j4(i,e){var n=e.getRootNode&&e.getRootNode();if(i.contains(e))return!0;if(n&&lw(n)){var r=e;do{if(r&&i.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Aa(i){return yi(i).getComputedStyle(i)}function T9(i){return["table","td","th"].indexOf(Ur(i))>=0}function ms(i){return((Ao(i)?i.ownerDocument:i.document)||window.document).documentElement}function _0(i){return Ur(i)==="html"?i:i.assignedSlot||i.parentNode||(lw(i)?i.host:null)||ms(i)}function g2(i){return!qi(i)||Aa(i).position==="fixed"?null:i.offsetParent}function k9(i){var e=/firefox/i.test(hm()),n=/Trident/i.test(hm());if(n&&qi(i)){var r=Aa(i);if(r.position==="fixed")return null}var t=_0(i);for(lw(t)&&(t=t.host);qi(t)&&["html","body"].indexOf(Ur(t))<0;){var s=Aa(t);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return t;t=t.parentNode}return null}function Tf(i){for(var e=yi(i),n=g2(i);n&&T9(n)&&Aa(n).position==="static";)n=g2(n);return n&&(Ur(n)==="html"||Ur(n)==="body"&&Aa(n).position==="static")?e:n||k9(i)||e}function fw(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function rf(i,e,n){return ko(i,Zp(e,n))}function E9(i,e,n){var r=rf(i,e,n);return r>n?n:r}function V4(){return{top:0,right:0,bottom:0,left:0}}function K4(i){return Object.assign({},V4(),i)}function W4(i,e){return e.reduce(function(n,r){return n[r]=i,n},{})}var O9=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,K4(typeof e!="number"?e:W4(e,If))};function A9(i){var e,n=i.state,r=i.name,t=i.options,s=n.elements.arrow,a=n.modifiersData.popperOffsets,c=Br(n.placement),u=fw(c),l=[Xn,Ki].indexOf(c)>=0,h=l?"height":"width";if(!(!s||!a)){var f=O9(t.padding,n),m=dw(s),d=u==="y"?Gn:Xn,y=u==="y"?Vi:Ki,b=n.rects.reference[h]+n.rects.reference[u]-a[u]-n.rects.popper[h],g=a[u]-n.rects.reference[u],v=Tf(s),_=v?u==="y"?v.clientHeight||0:v.clientWidth||0:0,S=b/2-g/2,I=f[d],A=_-m[h]-f[y],R=_/2-m[h]/2+S,E=rf(I,R,A),k=u;n.modifiersData[r]=(e={},e[k]=E,e.centerOffset=E-R,e)}}function P9(i){var e=i.state,n=i.options,r=n.element,t=r===void 0?"[data-popper-arrow]":r;t!=null&&(typeof t=="string"&&(t=e.elements.popper.querySelector(t),!t)||j4(e.elements.popper,t)&&(e.elements.arrow=t))}const R9={name:"arrow",enabled:!0,phase:"main",fn:A9,effect:P9,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function bu(i){return i.split("-")[1]}var N9={top:"auto",right:"auto",bottom:"auto",left:"auto"};function C9(i,e){var n=i.x,r=i.y,t=e.devicePixelRatio||1;return{x:yu(n*t)/t||0,y:yu(r*t)/t||0}}function b2(i){var e,n=i.popper,r=i.popperRect,t=i.placement,s=i.variation,a=i.offsets,c=i.position,u=i.gpuAcceleration,l=i.adaptive,h=i.roundOffsets,f=i.isFixed,m=a.x,d=m===void 0?0:m,y=a.y,b=y===void 0?0:y,g=typeof h=="function"?h({x:d,y:b}):{x:d,y:b};d=g.x,b=g.y;var v=a.hasOwnProperty("x"),_=a.hasOwnProperty("y"),S=Xn,I=Gn,A=window;if(l){var R=Tf(n),E="clientHeight",k="clientWidth";if(R===yi(n)&&(R=ms(n),Aa(R).position!=="static"&&c==="absolute"&&(E="scrollHeight",k="scrollWidth")),R=R,t===Gn||(t===Xn||t===Ki)&&s===df){I=Vi;var P=f&&R===A&&A.visualViewport?A.visualViewport.height:R[E];b-=P-r.height,b*=u?1:-1}if(t===Xn||(t===Gn||t===Vi)&&s===df){S=Ki;var T=f&&R===A&&A.visualViewport?A.visualViewport.width:R[k];d-=T-r.width,d*=u?1:-1}}var M=Object.assign({position:c},l&&N9),C=h===!0?C9({x:d,y:b},yi(n)):{x:d,y:b};if(d=C.x,b=C.y,u){var D;return Object.assign({},M,(D={},D[I]=_?"0":"",D[S]=v?"0":"",D.transform=(A.devicePixelRatio||1)<=1?"translate("+d+"px, "+b+"px)":"translate3d("+d+"px, "+b+"px, 0)",D))}return Object.assign({},M,(e={},e[I]=_?b+"px":"",e[S]=v?d+"px":"",e.transform="",e))}function M9(i){var e=i.state,n=i.options,r=n.gpuAcceleration,t=r===void 0?!0:r,s=n.adaptive,a=s===void 0?!0:s,c=n.roundOffsets,u=c===void 0?!0:c,l={placement:Br(e.placement),variation:bu(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:t,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,b2(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,b2(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const B9={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:M9,data:{}};var Xh={passive:!0};function D9(i){var e=i.state,n=i.instance,r=i.options,t=r.scroll,s=t===void 0?!0:t,a=r.resize,c=a===void 0?!0:a,u=yi(e.elements.popper),l=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&l.forEach(function(h){h.addEventListener("scroll",n.update,Xh)}),c&&u.addEventListener("resize",n.update,Xh),function(){s&&l.forEach(function(h){h.removeEventListener("scroll",n.update,Xh)}),c&&u.removeEventListener("resize",n.update,Xh)}}const L9={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:D9,data:{}};var F9={left:"right",right:"left",bottom:"top",top:"bottom"};function Up(i){return i.replace(/left|right|bottom|top/g,function(e){return F9[e]})}var U9={start:"end",end:"start"};function m2(i){return i.replace(/start|end/g,function(e){return U9[e]})}function hw(i){var e=yi(i),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function pw(i){return gu(ms(i)).left+hw(i).scrollLeft}function H9(i,e){var n=yi(i),r=ms(i),t=n.visualViewport,s=r.clientWidth,a=r.clientHeight,c=0,u=0;if(t){s=t.width,a=t.height;var l=q4();(l||!l&&e==="fixed")&&(c=t.offsetLeft,u=t.offsetTop)}return{width:s,height:a,x:c+pw(i),y:u}}function q9(i){var e,n=ms(i),r=hw(i),t=(e=i.ownerDocument)==null?void 0:e.body,s=ko(n.scrollWidth,n.clientWidth,t?t.scrollWidth:0,t?t.clientWidth:0),a=ko(n.scrollHeight,n.clientHeight,t?t.scrollHeight:0,t?t.clientHeight:0),c=-r.scrollLeft+pw(i),u=-r.scrollTop;return Aa(t||n).direction==="rtl"&&(c+=ko(n.clientWidth,t?t.clientWidth:0)-s),{width:s,height:a,x:c,y:u}}function yw(i){var e=Aa(i),n=e.overflow,r=e.overflowX,t=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+t+r)}function $4(i){return["html","body","#document"].indexOf(Ur(i))>=0?i.ownerDocument.body:qi(i)&&yw(i)?i:$4(_0(i))}function af(i,e){var n;e===void 0&&(e=[]);var r=$4(i),t=r===((n=i.ownerDocument)==null?void 0:n.body),s=yi(r),a=t?[s].concat(s.visualViewport||[],yw(r)?r:[]):r,c=e.concat(a);return t?c:c.concat(af(_0(a)))}function pm(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function j9(i,e){var n=gu(i,!1,e==="fixed");return n.top=n.top+i.clientTop,n.left=n.left+i.clientLeft,n.bottom=n.top+i.clientHeight,n.right=n.left+i.clientWidth,n.width=i.clientWidth,n.height=i.clientHeight,n.x=n.left,n.y=n.top,n}function w2(i,e,n){return e===U4?pm(H9(i,n)):Ao(e)?j9(e,n):pm(q9(ms(i)))}function V9(i){var e=af(_0(i)),n=["absolute","fixed"].indexOf(Aa(i).position)>=0,r=n&&qi(i)?Tf(i):i;return Ao(r)?e.filter(function(t){return Ao(t)&&j4(t,r)&&Ur(t)!=="body"}):[]}function K9(i,e,n,r){var t=e==="clippingParents"?V9(i):[].concat(e),s=[].concat(t,[n]),a=s[0],c=s.reduce(function(u,l){var h=w2(i,l,r);return u.top=ko(h.top,u.top),u.right=Zp(h.right,u.right),u.bottom=Zp(h.bottom,u.bottom),u.left=ko(h.left,u.left),u},w2(i,a,r));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function z4(i){var e=i.reference,n=i.element,r=i.placement,t=r?Br(r):null,s=r?bu(r):null,a=e.x+e.width/2-n.width/2,c=e.y+e.height/2-n.height/2,u;switch(t){case Gn:u={x:a,y:e.y-n.height};break;case Vi:u={x:a,y:e.y+e.height};break;case Ki:u={x:e.x+e.width,y:c};break;case Xn:u={x:e.x-n.width,y:c};break;default:u={x:e.x,y:e.y}}var l=t?fw(t):null;if(l!=null){var h=l==="y"?"height":"width";switch(s){case pu:u[l]=u[l]-(e[h]/2-n[h]/2);break;case df:u[l]=u[l]+(e[h]/2-n[h]/2);break}}return u}function ff(i,e){e===void 0&&(e={});var n=e,r=n.placement,t=r===void 0?i.placement:r,s=n.strategy,a=s===void 0?i.strategy:s,c=n.boundary,u=c===void 0?l9:c,l=n.rootBoundary,h=l===void 0?U4:l,f=n.elementContext,m=f===void 0?Sl:f,d=n.altBoundary,y=d===void 0?!1:d,b=n.padding,g=b===void 0?0:b,v=K4(typeof g!="number"?g:W4(g,If)),_=m===Sl?d9:Sl,S=i.rects.popper,I=i.elements[y?_:m],A=K9(Ao(I)?I:I.contextElement||ms(i.elements.popper),u,h,a),R=gu(i.elements.reference),E=z4({reference:R,element:S,placement:t}),k=pm(Object.assign({},S,E)),P=m===Sl?k:R,T={top:A.top-P.top+v.top,bottom:P.bottom-A.bottom+v.bottom,left:A.left-P.left+v.left,right:P.right-A.right+v.right},M=i.modifiersData.offset;if(m===Sl&&M){var C=M[t];Object.keys(T).forEach(function(D){var F=[Ki,Vi].indexOf(D)>=0?1:-1,B=[Gn,Vi].indexOf(D)>=0?"y":"x";T[D]+=C[B]*F})}return T}function W9(i,e){e===void 0&&(e={});var n=e,r=n.placement,t=n.boundary,s=n.rootBoundary,a=n.padding,c=n.flipVariations,u=n.allowedAutoPlacements,l=u===void 0?H4:u,h=bu(r),f=h?c?y2:y2.filter(function(y){return bu(y)===h}):If,m=f.filter(function(y){return l.indexOf(y)>=0});m.length===0&&(m=f);var d=m.reduce(function(y,b){return y[b]=ff(i,{placement:b,boundary:t,rootBoundary:s,padding:a})[Br(b)],y},{});return Object.keys(d).sort(function(y,b){return d[y]-d[b]})}function $9(i){if(Br(i)===uw)return[];var e=Up(i);return[m2(i),e,m2(e)]}function z9(i){var e=i.state,n=i.options,r=i.name;if(!e.modifiersData[r]._skip){for(var t=n.mainAxis,s=t===void 0?!0:t,a=n.altAxis,c=a===void 0?!0:a,u=n.fallbackPlacements,l=n.padding,h=n.boundary,f=n.rootBoundary,m=n.altBoundary,d=n.flipVariations,y=d===void 0?!0:d,b=n.allowedAutoPlacements,g=e.options.placement,v=Br(g),_=v===g,S=u||(_||!y?[Up(g)]:$9(g)),I=[g].concat(S).reduce(function(ce,Se){return ce.concat(Br(Se)===uw?W9(e,{placement:Se,boundary:h,rootBoundary:f,padding:l,flipVariations:y,allowedAutoPlacements:b}):Se)},[]),A=e.rects.reference,R=e.rects.popper,E=new Map,k=!0,P=I[0],T=0;T<I.length;T++){var M=I[T],C=Br(M),D=bu(M)===pu,F=[Gn,Vi].indexOf(C)>=0,B=F?"width":"height",L=ff(e,{placement:M,boundary:h,rootBoundary:f,altBoundary:m,padding:l}),q=F?D?Ki:Xn:D?Vi:Gn;A[B]>R[B]&&(q=Up(q));var K=Up(q),$=[];if(s&&$.push(L[C]<=0),c&&$.push(L[q]<=0,L[K]<=0),$.every(function(ce){return ce})){P=M,k=!1;break}E.set(M,$)}if(k)for(var U=y?3:1,z=function(Se){var Ie=I.find(function(me){var xe=E.get(me);if(xe)return xe.slice(0,Se).every(function(ke){return ke})});if(Ie)return P=Ie,"break"},G=U;G>0;G--){var ne=z(G);if(ne==="break")break}e.placement!==P&&(e.modifiersData[r]._skip=!0,e.placement=P,e.reset=!0)}}const G9={name:"flip",enabled:!0,phase:"main",fn:z9,requiresIfExists:["offset"],data:{_skip:!1}};function v2(i,e,n){return n===void 0&&(n={x:0,y:0}),{top:i.top-e.height-n.y,right:i.right-e.width+n.x,bottom:i.bottom-e.height+n.y,left:i.left-e.width-n.x}}function x2(i){return[Gn,Ki,Vi,Xn].some(function(e){return i[e]>=0})}function X9(i){var e=i.state,n=i.name,r=e.rects.reference,t=e.rects.popper,s=e.modifiersData.preventOverflow,a=ff(e,{elementContext:"reference"}),c=ff(e,{altBoundary:!0}),u=v2(a,r),l=v2(c,t,s),h=x2(u),f=x2(l);e.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:h,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":f})}const Y9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:X9};function Q9(i,e,n){var r=Br(i),t=[Xn,Gn].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:i})):n,a=s[0],c=s[1];return a=a||0,c=(c||0)*t,[Xn,Ki].indexOf(r)>=0?{x:c,y:a}:{x:a,y:c}}function Z9(i){var e=i.state,n=i.options,r=i.name,t=n.offset,s=t===void 0?[0,0]:t,a=H4.reduce(function(h,f){return h[f]=Q9(f,e.rects,s),h},{}),c=a[e.placement],u=c.x,l=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=l),e.modifiersData[r]=a}const J9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Z9};function eN(i){var e=i.state,n=i.name;e.modifiersData[n]=z4({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const tN={name:"popperOffsets",enabled:!0,phase:"read",fn:eN,data:{}};function nN(i){return i==="x"?"y":"x"}function iN(i){var e=i.state,n=i.options,r=i.name,t=n.mainAxis,s=t===void 0?!0:t,a=n.altAxis,c=a===void 0?!1:a,u=n.boundary,l=n.rootBoundary,h=n.altBoundary,f=n.padding,m=n.tether,d=m===void 0?!0:m,y=n.tetherOffset,b=y===void 0?0:y,g=ff(e,{boundary:u,rootBoundary:l,padding:f,altBoundary:h}),v=Br(e.placement),_=bu(e.placement),S=!_,I=fw(v),A=nN(I),R=e.modifiersData.popperOffsets,E=e.rects.reference,k=e.rects.popper,P=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,T=typeof P=="number"?{mainAxis:P,altAxis:P}:Object.assign({mainAxis:0,altAxis:0},P),M=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,C={x:0,y:0};if(R){if(s){var D,F=I==="y"?Gn:Xn,B=I==="y"?Vi:Ki,L=I==="y"?"height":"width",q=R[I],K=q+g[F],$=q-g[B],U=d?-k[L]/2:0,z=_===pu?E[L]:k[L],G=_===pu?-k[L]:-E[L],ne=e.elements.arrow,ce=d&&ne?dw(ne):{width:0,height:0},Se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:V4(),Ie=Se[F],me=Se[B],xe=rf(0,E[L],ce[L]),ke=S?E[L]/2-U-xe-Ie-T.mainAxis:z-xe-Ie-T.mainAxis,Re=S?-E[L]/2+U+xe+me+T.mainAxis:G+xe+me+T.mainAxis,Ce=e.elements.arrow&&Tf(e.elements.arrow),Ne=Ce?I==="y"?Ce.clientTop||0:Ce.clientLeft||0:0,We=(D=M==null?void 0:M[I])!=null?D:0,dt=q+ke-We-Ne,Ut=q+Re-We,Ht=rf(d?Zp(K,dt):K,q,d?ko($,Ut):$);R[I]=Ht,C[I]=Ht-q}if(c){var Je,At=I==="x"?Gn:Xn,Te=I==="x"?Vi:Ki,j=R[A],he=A==="y"?"height":"width",de=j+g[At],Me=j-g[Te],ct=[Gn,Xn].indexOf(v)!==-1,Hn=(Je=M==null?void 0:M[A])!=null?Je:0,wn=ct?de:j-E[he]-k[he]-Hn+T.altAxis,Dt=ct?j+E[he]+k[he]-Hn-T.altAxis:Me,vn=d&&ct?E9(wn,j,Dt):rf(d?wn:de,j,d?Dt:Me);R[A]=vn,C[A]=vn-j}e.modifiersData[r]=C}}const rN={name:"preventOverflow",enabled:!0,phase:"main",fn:iN,requiresIfExists:["offset"]};function aN(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function sN(i){return i===yi(i)||!qi(i)?hw(i):aN(i)}function oN(i){var e=i.getBoundingClientRect(),n=yu(e.width)/i.offsetWidth||1,r=yu(e.height)/i.offsetHeight||1;return n!==1||r!==1}function cN(i,e,n){n===void 0&&(n=!1);var r=qi(e),t=qi(e)&&oN(e),s=ms(e),a=gu(i,t,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!n)&&((Ur(e)!=="body"||yw(s))&&(c=sN(e)),qi(e)?(u=gu(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=pw(s))),{x:a.left+c.scrollLeft-u.x,y:a.top+c.scrollTop-u.y,width:a.width,height:a.height}}function uN(i){var e=new Map,n=new Set,r=[];i.forEach(function(s){e.set(s.name,s)});function t(s){n.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(c){if(!n.has(c)){var u=e.get(c);u&&t(u)}}),r.push(s)}return i.forEach(function(s){n.has(s.name)||t(s)}),r}function lN(i){var e=uN(i);return x9.reduce(function(n,r){return n.concat(e.filter(function(t){return t.phase===r}))},[])}function dN(i){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(i())})})),e}}function fN(i){var e=i.reduce(function(n,r){var t=n[r.name];return n[r.name]=t?Object.assign({},t,r,{options:Object.assign({},t.options,r.options),data:Object.assign({},t.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var _2={placement:"bottom",modifiers:[],strategy:"absolute"};function S2(){for(var i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function hN(i){i===void 0&&(i={});var e=i,n=e.defaultModifiers,r=n===void 0?[]:n,t=e.defaultOptions,s=t===void 0?_2:t;return function(c,u,l){l===void 0&&(l=s);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},_2,s),modifiersData:{},elements:{reference:c,popper:u},attributes:{},styles:{}},f=[],m=!1,d={state:h,setOptions:function(v){var _=typeof v=="function"?v(h.options):v;b(),h.options=Object.assign({},s,h.options,_),h.scrollParents={reference:Ao(c)?af(c):c.contextElement?af(c.contextElement):[],popper:af(u)};var S=lN(fN([].concat(r,h.options.modifiers)));return h.orderedModifiers=S.filter(function(I){return I.enabled}),y(),d.update()},forceUpdate:function(){if(!m){var v=h.elements,_=v.reference,S=v.popper;if(S2(_,S)){h.rects={reference:cN(_,Tf(S),h.options.strategy==="fixed"),popper:dw(S)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(T){return h.modifiersData[T.name]=Object.assign({},T.data)});for(var I=0;I<h.orderedModifiers.length;I++){if(h.reset===!0){h.reset=!1,I=-1;continue}var A=h.orderedModifiers[I],R=A.fn,E=A.options,k=E===void 0?{}:E,P=A.name;typeof R=="function"&&(h=R({state:h,options:k,name:P,instance:d})||h)}}}},update:dN(function(){return new Promise(function(g){d.forceUpdate(),g(h)})}),destroy:function(){b(),m=!0}};if(!S2(c,u))return d;d.setOptions(l).then(function(g){!m&&l.onFirstUpdate&&l.onFirstUpdate(g)});function y(){h.orderedModifiers.forEach(function(g){var v=g.name,_=g.options,S=_===void 0?{}:_,I=g.effect;if(typeof I=="function"){var A=I({state:h,name:v,instance:d,options:S}),R=function(){};f.push(A||R)}})}function b(){f.forEach(function(g){return g()}),f=[]}return d}}var pN=[L9,tN,B9,I9,J9,G9,rN,R9,Y9],yN=hN({defaultModifiers:pN});function gN(i){return typeof i=="function"?i():i}const G4=Z.forwardRef(function(e,n){const{children:r,container:t,disablePortal:s=!1}=e,[a,c]=Z.useState(null),u=Zn(Z.isValidElement(r)?vu(r):null,n);if(du(()=>{s||c(gN(t)||document.body)},[t,s]),du(()=>{if(a&&!s)return X_(n,a),()=>{X_(n,null)}},[n,a,s]),s){if(Z.isValidElement(r)){const l={ref:u};return Z.cloneElement(r,l)}return r}return a&&F4.createPortal(r,a)});function bN(i){return dn("MuiPopper",i)}bn("MuiPopper",["root"]);function mN(i,e){if(e==="ltr")return i;switch(i){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return i}}function ym(i){return typeof i=="function"?i():i}function wN(i){return i.nodeType!==void 0}const vN=i=>{const{classes:e}=i;return mn({root:["root"]},bN,e)},xN={},_N=Z.forwardRef(function(e,n){const{anchorEl:r,children:t,direction:s,disablePortal:a,modifiers:c,open:u,placement:l,popperOptions:h,popperRef:f,slotProps:m={},slots:d={},TransitionProps:y,ownerState:b,...g}=e,v=Z.useRef(null),_=Zn(v,n),S=Z.useRef(null),I=Zn(S,f),A=Z.useRef(I);du(()=>{A.current=I},[I]),Z.useImperativeHandle(f,()=>S.current,[]);const R=mN(l,s),[E,k]=Z.useState(R),[P,T]=Z.useState(ym(r));Z.useEffect(()=>{S.current&&S.current.forceUpdate()}),Z.useEffect(()=>{r&&T(ym(r))},[r]),du(()=>{if(!P||!u)return;const B=K=>{k(K.placement)};let L=[{name:"preventOverflow",options:{altBoundary:a}},{name:"flip",options:{altBoundary:a}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:K})=>{B(K)}}];c!=null&&(L=L.concat(c)),h&&h.modifiers!=null&&(L=L.concat(h.modifiers));const q=yN(P,v.current,{placement:R,...h,modifiers:L});return A.current(q),()=>{q.destroy(),A.current(null)}},[P,a,c,u,h,R]);const M={placement:E};y!==null&&(M.TransitionProps=y);const C=vN(e),D=d.root??"div",F=GP({elementType:D,externalSlotProps:m.root,externalForwardedProps:g,additionalProps:{role:"tooltip",ref:_},ownerState:e,className:C.root});return J.jsx(D,{...F,children:typeof t=="function"?t(M):t})}),SN=Z.forwardRef(function(e,n){const{anchorEl:r,children:t,container:s,direction:a="ltr",disablePortal:c=!1,keepMounted:u=!1,modifiers:l,open:h,placement:f="bottom",popperOptions:m=xN,popperRef:d,style:y,transition:b=!1,slotProps:g={},slots:v={},..._}=e,[S,I]=Z.useState(!0),A=()=>{I(!1)},R=()=>{I(!0)};if(!u&&!h&&(!b||S))return null;let E;if(s)E=s;else if(r){const T=ym(r);E=T&&wN(T)?Oa(T).body:Oa(null).body}const k=!h&&u&&(!b||S)?"none":void 0,P=b?{in:h,onEnter:A,onExited:R}:void 0;return J.jsx(G4,{disablePortal:c,container:E,children:J.jsx(_N,{anchorEl:r,direction:a,disablePortal:c,modifiers:l,ref:n,open:b?!S:h,placement:f,popperOptions:m,popperRef:d,slotProps:g,slots:v,..._,style:{position:"fixed",top:0,left:0,display:k,...y},TransitionProps:P,children:t})})}),IN=pt(SN,{name:"MuiPopper",slot:"Root",overridesResolver:(i,e)=>e.root})({}),X4=Z.forwardRef(function(e,n){const r=tw(),t=rn({props:e,name:"MuiPopper"}),{anchorEl:s,component:a,components:c,componentsProps:u,container:l,disablePortal:h,keepMounted:f,modifiers:m,open:d,placement:y,popperOptions:b,popperRef:g,transition:v,slots:_,slotProps:S,...I}=t,A=(_==null?void 0:_.root)??(c==null?void 0:c.Root),R={anchorEl:s,container:l,disablePortal:h,keepMounted:f,modifiers:m,open:d,placement:y,popperOptions:b,popperRef:g,transition:v,...I};return J.jsx(IN,{as:a,direction:r?"rtl":"ltr",slots:{root:A},slotProps:S??u,...R,ref:n})}),TN=Na(J.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function kN(i){return dn("MuiChip",i)}const ot=bn("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),EN=i=>{const{classes:e,disabled:n,size:r,color:t,iconColor:s,onDelete:a,clickable:c,variant:u}=i,l={root:["root",u,n&&"disabled",`size${Le(r)}`,`color${Le(t)}`,c&&"clickable",c&&`clickableColor${Le(t)}`,a&&"deletable",a&&`deletableColor${Le(t)}`,`${u}${Le(t)}`],label:["label",`label${Le(r)}`],avatar:["avatar",`avatar${Le(r)}`,`avatarColor${Le(t)}`],icon:["icon",`icon${Le(r)}`,`iconColor${Le(s)}`],deleteIcon:["deleteIcon",`deleteIcon${Le(r)}`,`deleteIconColor${Le(t)}`,`deleteIcon${Le(u)}Color${Le(t)}`]};return mn(l,kN,e)},ON=pt("div",{name:"MuiChip",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i,{color:r,iconColor:t,clickable:s,onDelete:a,size:c,variant:u}=n;return[{[`& .${ot.avatar}`]:e.avatar},{[`& .${ot.avatar}`]:e[`avatar${Le(c)}`]},{[`& .${ot.avatar}`]:e[`avatarColor${Le(r)}`]},{[`& .${ot.icon}`]:e.icon},{[`& .${ot.icon}`]:e[`icon${Le(c)}`]},{[`& .${ot.icon}`]:e[`iconColor${Le(t)}`]},{[`& .${ot.deleteIcon}`]:e.deleteIcon},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${Le(c)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIconColor${Le(r)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${Le(u)}Color${Le(r)}`]},e.root,e[`size${Le(c)}`],e[`color${Le(r)}`],s&&e.clickable,s&&r!=="default"&&e[`clickableColor${Le(r)})`],a&&e.deletable,a&&r!=="default"&&e[`deletableColor${Le(r)}`],e[u],e[`${u}${Le(r)}`]]}})(On(({theme:i})=>{const e=i.palette.mode==="light"?i.palette.grey[700]:i.palette.grey[300];return{maxWidth:"100%",fontFamily:i.typography.fontFamily,fontSize:i.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(i.vars||i).palette.text.primary,backgroundColor:(i.vars||i).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:i.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ot.disabled}`]:{opacity:(i.vars||i).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ot.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:i.vars?i.vars.palette.Chip.defaultAvatarColor:e,fontSize:i.typography.pxToRem(12)},[`& .${ot.avatarColorPrimary}`]:{color:(i.vars||i).palette.primary.contrastText,backgroundColor:(i.vars||i).palette.primary.dark},[`& .${ot.avatarColorSecondary}`]:{color:(i.vars||i).palette.secondary.contrastText,backgroundColor:(i.vars||i).palette.secondary.dark},[`& .${ot.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:i.typography.pxToRem(10)},[`& .${ot.icon}`]:{marginLeft:5,marginRight:-6},[`& .${ot.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / 0.26)`:En(i.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / 0.4)`:En(i.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${ot.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${ot.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(i.palette).filter(ls(["contrastText"])).map(([n])=>({props:{color:n},style:{backgroundColor:(i.vars||i).palette[n].main,color:(i.vars||i).palette[n].contrastText,[`& .${ot.deleteIcon}`]:{color:i.vars?`rgba(${i.vars.palette[n].contrastTextChannel} / 0.7)`:En(i.palette[n].contrastText,.7),"&:hover, &:active":{color:(i.vars||i).palette[n].contrastText}}}})),{props:n=>n.iconColor===n.color,style:{[`& .${ot.icon}`]:{color:i.vars?i.vars.palette.Chip.defaultIconColor:e}}},{props:n=>n.iconColor===n.color&&n.color!=="default",style:{[`& .${ot.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${ot.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.focusOpacity}))`:En(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.focusOpacity)}}},...Object.entries(i.palette).filter(ls(["dark"])).map(([n])=>({props:{color:n,onDelete:!0},style:{[`&.${ot.focusVisible}`]:{background:(i.vars||i).palette[n].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.hoverOpacity}))`:En(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette.action.selectedChannel} / calc(${i.vars.palette.action.selectedOpacity} + ${i.vars.palette.action.focusOpacity}))`:En(i.palette.action.selected,i.palette.action.selectedOpacity+i.palette.action.focusOpacity)},"&:active":{boxShadow:(i.vars||i).shadows[1]}}},...Object.entries(i.palette).filter(ls(["dark"])).map(([n])=>({props:{color:n,clickable:!0},style:{[`&:hover, &.${ot.focusVisible}`]:{backgroundColor:(i.vars||i).palette[n].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:i.vars?`1px solid ${i.vars.palette.Chip.defaultBorder}`:`1px solid ${i.palette.mode==="light"?i.palette.grey[400]:i.palette.grey[700]}`,[`&.${ot.clickable}:hover`]:{backgroundColor:(i.vars||i).palette.action.hover},[`&.${ot.focusVisible}`]:{backgroundColor:(i.vars||i).palette.action.focus},[`& .${ot.avatar}`]:{marginLeft:4},[`& .${ot.avatarSmall}`]:{marginLeft:2},[`& .${ot.icon}`]:{marginLeft:4},[`& .${ot.iconSmall}`]:{marginLeft:2},[`& .${ot.deleteIcon}`]:{marginRight:5},[`& .${ot.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(i.palette).filter(ls()).map(([n])=>({props:{variant:"outlined",color:n},style:{color:(i.vars||i).palette[n].main,border:`1px solid ${i.vars?`rgba(${i.vars.palette[n].mainChannel} / 0.7)`:En(i.palette[n].main,.7)}`,[`&.${ot.clickable}:hover`]:{backgroundColor:i.vars?`rgba(${i.vars.palette[n].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:En(i.palette[n].main,i.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:i.vars?`rgba(${i.vars.palette[n].mainChannel} / ${i.vars.palette.action.focusOpacity})`:En(i.palette[n].main,i.palette.action.focusOpacity)},[`& .${ot.deleteIcon}`]:{color:i.vars?`rgba(${i.vars.palette[n].mainChannel} / 0.7)`:En(i.palette[n].main,.7),"&:hover, &:active":{color:(i.vars||i).palette[n].main}}}}))]}})),AN=pt("span",{name:"MuiChip",slot:"Label",overridesResolver:(i,e)=>{const{ownerState:n}=i,{size:r}=n;return[e.label,e[`label${Le(r)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function I2(i){return i.key==="Backspace"||i.key==="Delete"}const gm=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiChip"}),{avatar:t,className:s,clickable:a,color:c="default",component:u,deleteIcon:l,disabled:h=!1,icon:f,label:m,onClick:d,onDelete:y,onKeyDown:b,onKeyUp:g,size:v="medium",variant:_="filled",tabIndex:S,skipFocusWhenDisabled:I=!1,...A}=r,R=Z.useRef(null),E=Zn(R,n),k=$=>{$.stopPropagation(),y&&y($)},P=$=>{$.currentTarget===$.target&&I2($)&&$.preventDefault(),b&&b($)},T=$=>{$.currentTarget===$.target&&y&&I2($)&&y($),g&&g($)},M=a!==!1&&d?!0:a,C=M||y?Qp:u||"div",D={...r,component:C,disabled:h,size:v,color:c,iconColor:Z.isValidElement(f)&&f.props.color||c,onDelete:!!y,clickable:M,variant:_},F=EN(D),B=C===Qp?{component:u||"div",focusVisibleClassName:F.focusVisible,...y&&{disableRipple:!0}}:{};let L=null;y&&(L=l&&Z.isValidElement(l)?Z.cloneElement(l,{className:Xe(l.props.className,F.deleteIcon),onClick:k}):J.jsx(TN,{className:Xe(F.deleteIcon),onClick:k}));let q=null;t&&Z.isValidElement(t)&&(q=Z.cloneElement(t,{className:Xe(F.avatar,t.props.className)}));let K=null;return f&&Z.isValidElement(f)&&(K=Z.cloneElement(f,{className:Xe(F.icon,f.props.className)})),J.jsxs(ON,{as:C,className:Xe(F.root,s),disabled:M&&h?!0:void 0,onClick:d,onKeyDown:P,onKeyUp:T,ref:E,tabIndex:I&&h?-1:S,ownerState:D,...B,...A,children:[q||K,J.jsx(AN,{className:Xe(F.label),ownerState:D,children:m}),L]})}),PN={entering:{opacity:1},entered:{opacity:1}},RN=Z.forwardRef(function(e,n){const r=bs(),t={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:s,appear:a=!0,children:c,easing:u,in:l,onEnter:h,onEntered:f,onEntering:m,onExit:d,onExited:y,onExiting:b,style:g,timeout:v=t,TransitionComponent:_=pr,...S}=e,I=Z.useRef(null),A=Zn(I,vu(c),n),R=F=>B=>{if(F){const L=I.current;B===void 0?F(L):F(L,B)}},E=R(m),k=R((F,B)=>{cw(F);const L=hu({style:g,timeout:v,easing:u},{mode:"enter"});F.style.webkitTransition=r.transitions.create("opacity",L),F.style.transition=r.transitions.create("opacity",L),h&&h(F,B)}),P=R(f),T=R(b),M=R(F=>{const B=hu({style:g,timeout:v,easing:u},{mode:"exit"});F.style.webkitTransition=r.transitions.create("opacity",B),F.style.transition=r.transitions.create("opacity",B),d&&d(F)}),C=R(y),D=F=>{s&&s(I.current,F)};return J.jsx(_,{appear:a,in:l,nodeRef:I,onEnter:k,onEntered:P,onEntering:E,onExit:M,onExited:C,onExiting:T,addEndListener:D,timeout:v,...S,children:(F,{ownerState:B,...L})=>Z.cloneElement(c,{style:{opacity:0,visibility:F==="exited"&&!l?"hidden":void 0,...PN[F],...g,...c.props.style},ref:A,...L})})});function NN(i){return dn("MuiBackdrop",i)}bn("MuiBackdrop",["root","invisible"]);const CN=i=>{const{classes:e,invisible:n}=i;return mn({root:["root",n&&"invisible"]},NN,e)},MN=pt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),BN=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiBackdrop"}),{children:t,className:s,component:a="div",invisible:c=!1,open:u,components:l={},componentsProps:h={},slotProps:f={},slots:m={},TransitionComponent:d,transitionDuration:y,...b}=r,g={...r,component:a,invisible:c},v=CN(g),_={transition:d,root:l.Root,...m},S={...h,...f},I={slots:_,slotProps:S},[A,R]=Hi("root",{elementType:MN,externalForwardedProps:I,className:Xe(v.root,s),ownerState:g}),[E,k]=Hi("transition",{elementType:RN,externalForwardedProps:I,ownerState:g});return J.jsx(E,{in:u,timeout:y,...b,...k,children:J.jsx(A,{"aria-hidden":!0,...R,classes:v,ref:n,children:t})})}),DN=bn("MuiBox",["root"]),LN=x0(),ht=TP({themeId:Cr,defaultTheme:LN,defaultClassName:DN.root,generateClassName:u4.generate});function FN(i){return dn("MuiCard",i)}bn("MuiCard",["root"]);const UN=i=>{const{classes:e}=i;return mn({root:["root"]},FN,e)},HN=pt(Sf,{name:"MuiCard",slot:"Root",overridesResolver:(i,e)=>e.root})({overflow:"hidden"}),S0=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiCard"}),{className:t,raised:s=!1,...a}=r,c={...r,raised:s},u=UN(c);return J.jsx(HN,{className:Xe(u.root,t),elevation:s?8:void 0,ref:n,ownerState:c,...a})});function qN(i){return dn("MuiCardActionArea",i)}const fb=bn("MuiCardActionArea",["root","focusVisible","focusHighlight"]),jN=i=>{const{classes:e}=i;return mn({root:["root"],focusHighlight:["focusHighlight"]},qN,e)},VN=pt(Qp,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(i,e)=>e.root})(On(({theme:i})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${fb.focusHighlight}`]:{opacity:(i.vars||i).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${fb.focusVisible} .${fb.focusHighlight}`]:{opacity:(i.vars||i).palette.action.focusOpacity}}))),KN=pt("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(i,e)=>e.focusHighlight})(On(({theme:i})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:i.transitions.create("opacity",{duration:i.transitions.duration.short})}))),I0=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiCardActionArea"}),{children:t,className:s,focusVisibleClassName:a,...c}=r,u=r,l=jN(u);return J.jsxs(VN,{className:Xe(l.root,s),focusVisibleClassName:Xe(a,l.focusVisible),ref:n,ownerState:u,...c,children:[t,J.jsx(KN,{className:l.focusHighlight,ownerState:u})]})});function WN(i){return dn("MuiCardContent",i)}bn("MuiCardContent",["root"]);const $N=i=>{const{classes:e}=i;return mn({root:["root"]},WN,e)},zN=pt("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(i,e)=>e.root})({padding:16,"&:last-child":{paddingBottom:24}}),T0=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiCardContent"}),{className:t,component:s="div",...a}=r,c={...r,component:s},u=$N(c);return J.jsx(zN,{as:s,className:Xe(u.root,t),ownerState:c,ref:n,...a})});function GN(i){return dn("MuiCardMedia",i)}bn("MuiCardMedia",["root","media","img"]);const XN=i=>{const{classes:e,isMediaComponent:n,isImageComponent:r}=i;return mn({root:["root",n&&"media",r&&"img"]},GN,e)},YN=pt("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i,{isMediaComponent:r,isImageComponent:t}=n;return[e.root,r&&e.media,t&&e.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),QN=["video","audio","picture","iframe","img"],ZN=["picture","img"],k0=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiCardMedia"}),{children:t,className:s,component:a="div",image:c,src:u,style:l,...h}=r,f=QN.includes(a),m=!f&&c?{backgroundImage:`url("${c}")`,...l}:l,d={...r,component:a,isMediaComponent:f,isImageComponent:ZN.includes(a)},y=XN(d);return J.jsx(YN,{className:Xe(y.root,s),as:a,role:!f&&c?"img":void 0,ref:n,style:m,ownerState:d,src:f?c||u:void 0,...h,children:t})}),JN=xR({createStyledComponent:pt("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,e[`maxWidth${Le(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),useThemeProps:i=>rn({props:i,name:"MuiContainer"})}),bm=typeof B4({})=="function",eC=(i,e)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...e&&!i.vars&&{colorScheme:i.palette.mode}}),tC=i=>({color:(i.vars||i).palette.text.primary,...i.typography.body1,backgroundColor:(i.vars||i).palette.background.default,"@media print":{backgroundColor:(i.vars||i).palette.common.white}}),Y4=(i,e=!1)=>{var s,a;const n={};e&&i.colorSchemes&&typeof i.getColorSchemeSelector=="function"&&Object.entries(i.colorSchemes).forEach(([c,u])=>{var h,f;const l=i.getColorSchemeSelector(c);l.startsWith("@")?n[l]={":root":{colorScheme:(h=u.palette)==null?void 0:h.mode}}:n[l.replace(/\s*&/,"")]={colorScheme:(f=u.palette)==null?void 0:f.mode}});let r={html:eC(i,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:i.typography.fontWeightBold},body:{margin:0,...tC(i),"&::backdrop":{backgroundColor:(i.vars||i).palette.background.default}},...n};const t=(a=(s=i.components)==null?void 0:s.MuiCssBaseline)==null?void 0:a.styleOverrides;return t&&(r=[r,t]),r},Hp="mui-ecs",nC=i=>{const e=Y4(i,!1),n=Array.isArray(e)?e[0]:e;return!i.vars&&n&&(n.html[`:root:has(${Hp})`]={colorScheme:i.palette.mode}),i.colorSchemes&&Object.entries(i.colorSchemes).forEach(([r,t])=>{var a,c;const s=i.getColorSchemeSelector(r);s.startsWith("@")?n[s]={[`:root:not(:has(.${Hp}))`]:{colorScheme:(a=t.palette)==null?void 0:a.mode}}:n[s.replace(/\s*&/,"")]={[`&:not(:has(.${Hp}))`]:{colorScheme:(c=t.palette)==null?void 0:c.mode}}}),e},iC=B4(bm?({theme:i,enableColorScheme:e})=>Y4(i,e):({theme:i})=>nC(i));function rC(i){const e=rn({props:i,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return J.jsxs(Z.Fragment,{children:[bm&&J.jsx(iC,{enableColorScheme:r}),!bm&&!r&&J.jsx("span",{className:Hp,style:{display:"none"}}),n]})}function aC(i){const e=Oa(i);return e.body===i?fu(i).innerWidth>e.documentElement.clientWidth:i.scrollHeight>i.clientHeight}function sf(i,e){e?i.setAttribute("aria-hidden","true"):i.removeAttribute("aria-hidden")}function T2(i){return parseInt(fu(i).getComputedStyle(i).paddingRight,10)||0}function sC(i){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(i.tagName),r=i.tagName==="INPUT"&&i.getAttribute("type")==="hidden";return n||r}function k2(i,e,n,r,t){const s=[e,n,...r];[].forEach.call(i.children,a=>{const c=!s.includes(a),u=!sC(a);c&&u&&sf(a,t)})}function hb(i,e){let n=-1;return i.some((r,t)=>e(r)?(n=t,!0):!1),n}function oC(i,e){const n=[],r=i.container;if(!e.disableScrollLock){if(aC(r)){const a=$P(fu(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${T2(r)+a}px`;const c=Oa(r).querySelectorAll(".mui-fixed");[].forEach.call(c,u=>{n.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${T2(u)+a}px`})}let s;if(r.parentNode instanceof DocumentFragment)s=Oa(r).body;else{const a=r.parentElement,c=fu(r);s=(a==null?void 0:a.nodeName)==="HTML"&&c.getComputedStyle(a).overflowY==="scroll"?a:r}n.push({value:s.style.overflow,property:"overflow",el:s},{value:s.style.overflowX,property:"overflow-x",el:s},{value:s.style.overflowY,property:"overflow-y",el:s}),s.style.overflow="hidden"}return()=>{n.forEach(({value:s,el:a,property:c})=>{s?a.style.setProperty(c,s):a.style.removeProperty(c)})}}function cC(i){const e=[];return[].forEach.call(i.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class uC{constructor(){this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&sf(e.modalRef,!1);const t=cC(n);k2(n,e.mount,e.modalRef,t,!0);const s=hb(this.containers,a=>a.container===n);return s!==-1?(this.containers[s].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:t}),r)}mount(e,n){const r=hb(this.containers,s=>s.modals.includes(e)),t=this.containers[r];t.restore||(t.restore=oC(t,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const t=hb(this.containers,a=>a.modals.includes(e)),s=this.containers[t];if(s.modals.splice(s.modals.indexOf(e),1),this.modals.splice(r,1),s.modals.length===0)s.restore&&s.restore(),e.modalRef&&sf(e.modalRef,n),k2(s.container,e.mount,e.modalRef,s.hiddenSiblings,!1),this.containers.splice(t,1);else{const a=s.modals[s.modals.length-1];a.modalRef&&sf(a.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const lC=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function dC(i){const e=parseInt(i.getAttribute("tabindex")||"",10);return Number.isNaN(e)?i.contentEditable==="true"||(i.nodeName==="AUDIO"||i.nodeName==="VIDEO"||i.nodeName==="DETAILS")&&i.getAttribute("tabindex")===null?0:i.tabIndex:e}function fC(i){if(i.tagName!=="INPUT"||i.type!=="radio"||!i.name)return!1;const e=r=>i.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${i.name}"]:checked`);return n||(n=e(`[name="${i.name}"]`)),n!==i}function hC(i){return!(i.disabled||i.tagName==="INPUT"&&i.type==="hidden"||fC(i))}function pC(i){const e=[],n=[];return Array.from(i.querySelectorAll(lC)).forEach((r,t)=>{const s=dC(r);s===-1||!hC(r)||(s===0?e.push(r):n.push({documentOrder:t,tabIndex:s,node:r}))}),n.sort((r,t)=>r.tabIndex===t.tabIndex?r.documentOrder-t.documentOrder:r.tabIndex-t.tabIndex).map(r=>r.node).concat(e)}function yC(){return!0}function gC(i){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:t=!1,getTabbable:s=pC,isEnabled:a=yC,open:c}=i,u=Z.useRef(!1),l=Z.useRef(null),h=Z.useRef(null),f=Z.useRef(null),m=Z.useRef(null),d=Z.useRef(!1),y=Z.useRef(null),b=Zn(vu(e),y),g=Z.useRef(null);Z.useEffect(()=>{!c||!y.current||(d.current=!n)},[n,c]),Z.useEffect(()=>{if(!c||!y.current)return;const S=Oa(y.current);return y.current.contains(S.activeElement)||(y.current.hasAttribute("tabIndex")||y.current.setAttribute("tabIndex","-1"),d.current&&y.current.focus()),()=>{t||(f.current&&f.current.focus&&(u.current=!0,f.current.focus()),f.current=null)}},[c]),Z.useEffect(()=>{if(!c||!y.current)return;const S=Oa(y.current),I=E=>{g.current=E,!(r||!a()||E.key!=="Tab")&&S.activeElement===y.current&&E.shiftKey&&(u.current=!0,h.current&&h.current.focus())},A=()=>{var P,T;const E=y.current;if(E===null)return;if(!S.hasFocus()||!a()||u.current){u.current=!1;return}if(E.contains(S.activeElement)||r&&S.activeElement!==l.current&&S.activeElement!==h.current)return;if(S.activeElement!==m.current)m.current=null;else if(m.current!==null)return;if(!d.current)return;let k=[];if((S.activeElement===l.current||S.activeElement===h.current)&&(k=s(y.current)),k.length>0){const M=!!((P=g.current)!=null&&P.shiftKey&&((T=g.current)==null?void 0:T.key)==="Tab"),C=k[0],D=k[k.length-1];typeof C!="string"&&typeof D!="string"&&(M?D.focus():C.focus())}else E.focus()};S.addEventListener("focusin",A),S.addEventListener("keydown",I,!0);const R=setInterval(()=>{S.activeElement&&S.activeElement.tagName==="BODY"&&A()},50);return()=>{clearInterval(R),S.removeEventListener("focusin",A),S.removeEventListener("keydown",I,!0)}},[n,r,t,a,c,s]);const v=S=>{f.current===null&&(f.current=S.relatedTarget),d.current=!0,m.current=S.target;const I=e.props.onFocus;I&&I(S)},_=S=>{f.current===null&&(f.current=S.relatedTarget),d.current=!0};return J.jsxs(Z.Fragment,{children:[J.jsx("div",{tabIndex:c?0:-1,onFocus:_,ref:l,"data-testid":"sentinelStart"}),Z.cloneElement(e,{ref:b,onFocus:v}),J.jsx("div",{tabIndex:c?0:-1,onFocus:_,ref:h,"data-testid":"sentinelEnd"})]})}function bC(i){return typeof i=="function"?i():i}function mC(i){return i?i.props.hasOwnProperty("in"):!1}const E2=()=>{},Yh=new uC;function wC(i){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,closeAfterTransition:t=!1,onTransitionEnter:s,onTransitionExited:a,children:c,onClose:u,open:l,rootRef:h}=i,f=Z.useRef({}),m=Z.useRef(null),d=Z.useRef(null),y=Zn(d,h),[b,g]=Z.useState(!l),v=mC(c);let _=!0;(i["aria-hidden"]==="false"||i["aria-hidden"]===!1)&&(_=!1);const S=()=>Oa(m.current),I=()=>(f.current.modalRef=d.current,f.current.mount=m.current,f.current),A=()=>{Yh.mount(I(),{disableScrollLock:r}),d.current&&(d.current.scrollTop=0)},R=ds(()=>{const B=bC(e)||S().body;Yh.add(I(),B),d.current&&A()}),E=()=>Yh.isTopModal(I()),k=ds(B=>{m.current=B,B&&(l&&E()?A():d.current&&sf(d.current,_))}),P=Z.useCallback(()=>{Yh.remove(I(),_)},[_]);Z.useEffect(()=>()=>{P()},[P]),Z.useEffect(()=>{l?R():(!v||!t)&&P()},[l,P,v,t,R]);const T=B=>L=>{var q;(q=B.onKeyDown)==null||q.call(B,L),!(L.key!=="Escape"||L.which===229||!E())&&(n||(L.stopPropagation(),u&&u(L,"escapeKeyDown")))},M=B=>L=>{var q;(q=B.onClick)==null||q.call(B,L),L.target===L.currentTarget&&u&&u(L,"backdropClick")};return{getRootProps:(B={})=>{const L=v4(i);delete L.onTransitionEnter,delete L.onTransitionExited;const q={...L,...B};return{role:"presentation",...q,onKeyDown:T(q),ref:y}},getBackdropProps:(B={})=>{const L=B;return{"aria-hidden":!0,...L,onClick:M(L),open:l}},getTransitionProps:()=>{const B=()=>{g(!1),s&&s()},L=()=>{g(!0),a&&a(),t&&P()};return{onEnter:G_(B,(c==null?void 0:c.props.onEnter)??E2),onExited:G_(L,(c==null?void 0:c.props.onExited)??E2)}},rootRef:y,portalRef:k,isTopModal:E,exited:b,hasTransition:v}}function vC(i){return dn("MuiModal",i)}bn("MuiModal",["root","hidden","backdrop"]);const xC=i=>{const{open:e,exited:n,classes:r}=i;return mn({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},vC,r)},_C=pt("div",{name:"MuiModal",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,!n.open&&n.exited&&e.hidden]}})(On(({theme:i})=>({position:"fixed",zIndex:(i.vars||i).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),SC=pt(BN,{name:"MuiModal",slot:"Backdrop",overridesResolver:(i,e)=>e.backdrop})({zIndex:-1}),IC=Z.forwardRef(function(e,n){const r=rn({name:"MuiModal",props:e}),{BackdropComponent:t=SC,BackdropProps:s,classes:a,className:c,closeAfterTransition:u=!1,children:l,container:h,component:f,components:m={},componentsProps:d={},disableAutoFocus:y=!1,disableEnforceFocus:b=!1,disableEscapeKeyDown:g=!1,disablePortal:v=!1,disableRestoreFocus:_=!1,disableScrollLock:S=!1,hideBackdrop:I=!1,keepMounted:A=!1,onClose:R,onTransitionEnter:E,onTransitionExited:k,open:P,slotProps:T={},slots:M={},theme:C,...D}=r,F={...r,closeAfterTransition:u,disableAutoFocus:y,disableEnforceFocus:b,disableEscapeKeyDown:g,disablePortal:v,disableRestoreFocus:_,disableScrollLock:S,hideBackdrop:I,keepMounted:A},{getRootProps:B,getBackdropProps:L,getTransitionProps:q,portalRef:K,isTopModal:$,exited:U,hasTransition:z}=wC({...F,rootRef:n}),G={...F,exited:U},ne=xC(G),ce={};if(l.props.tabIndex===void 0&&(ce.tabIndex="-1"),z){const{onEnter:Re,onExited:Ce}=q();ce.onEnter=Re,ce.onExited=Ce}const Se={slots:{root:m.Root,backdrop:m.Backdrop,...M},slotProps:{...d,...T}},[Ie,me]=Hi("root",{ref:n,elementType:_C,externalForwardedProps:{...Se,...D,component:f},getSlotProps:B,ownerState:G,className:Xe(c,ne==null?void 0:ne.root,!G.open&&G.exited&&(ne==null?void 0:ne.hidden))}),[xe,ke]=Hi("backdrop",{ref:s==null?void 0:s.ref,elementType:t,externalForwardedProps:Se,shouldForwardComponentProp:!0,additionalProps:s,getSlotProps:Re=>L({...Re,onClick:Ce=>{Re!=null&&Re.onClick&&Re.onClick(Ce)}}),className:Xe(s==null?void 0:s.className,ne==null?void 0:ne.backdrop),ownerState:G});return!A&&!P&&(!z||U)?null:J.jsx(G4,{ref:K,container:h,disablePortal:v,children:J.jsxs(Ie,{...me,children:[!I&&t?J.jsx(xe,{...ke}):null,J.jsx(gC,{disableEnforceFocus:b,disableAutoFocus:y,disableRestoreFocus:_,isEnabled:$,open:P,children:Z.cloneElement(l,ce)})]})})});function TC(i){return dn("MuiDivider",i)}bn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const kC=i=>{const{absolute:e,children:n,classes:r,flexItem:t,light:s,orientation:a,textAlign:c,variant:u}=i;return mn({root:["root",e&&"absolute",u,s&&"light",a==="vertical"&&"vertical",t&&"flexItem",n&&"withChildren",n&&a==="vertical"&&"withChildrenVertical",c==="right"&&a!=="vertical"&&"textAlignRight",c==="left"&&a!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",a==="vertical"&&"wrapperVertical"]},TC,r)},EC=pt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.root,n.absolute&&e.absolute,e[n.variant],n.light&&e.light,n.orientation==="vertical"&&e.vertical,n.flexItem&&e.flexItem,n.children&&e.withChildren,n.children&&n.orientation==="vertical"&&e.withChildrenVertical,n.textAlign==="right"&&n.orientation!=="vertical"&&e.textAlignRight,n.textAlign==="left"&&n.orientation!=="vertical"&&e.textAlignLeft]}})(On(({theme:i})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(i.vars||i).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:i.vars?`rgba(${i.vars.palette.dividerChannel} / 0.08)`:En(i.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:i.spacing(2),marginRight:i.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:i.spacing(1),marginBottom:i.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(i.vars||i).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(i.vars||i).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),OC=pt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.wrapper,n.orientation==="vertical"&&e.wrapperVertical]}})(On(({theme:i})=>({display:"inline-block",paddingLeft:`calc(${i.spacing(1)} * 1.2)`,paddingRight:`calc(${i.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${i.spacing(1)} * 1.2)`,paddingBottom:`calc(${i.spacing(1)} * 1.2)`}}]}))),Jp=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiDivider"}),{absolute:t=!1,children:s,className:a,orientation:c="horizontal",component:u=s||c==="vertical"?"div":"hr",flexItem:l=!1,light:h=!1,role:f=u!=="hr"?"separator":void 0,textAlign:m="center",variant:d="fullWidth",...y}=r,b={...r,absolute:t,component:u,flexItem:l,light:h,orientation:c,role:f,textAlign:m,variant:d},g=kC(b);return J.jsx(EC,{as:u,className:Xe(g.root,a),role:f,ref:n,ownerState:b,"aria-orientation":f==="separator"&&(u!=="hr"||c==="vertical")?c:void 0,...y,children:s?J.jsx(OC,{className:g.wrapper,ownerState:b,children:s}):null})});Jp&&(Jp.muiSkipListHighlight=!0);function AC(i,e,n){const r=e.getBoundingClientRect(),t=n&&n.getBoundingClientRect(),s=fu(e);let a;if(e.fakeTransform)a=e.fakeTransform;else{const l=s.getComputedStyle(e);a=l.getPropertyValue("-webkit-transform")||l.getPropertyValue("transform")}let c=0,u=0;if(a&&a!=="none"&&typeof a=="string"){const l=a.split("(")[1].split(")")[0].split(",");c=parseInt(l[4],10),u=parseInt(l[5],10)}return i==="left"?t?`translateX(${t.right+c-r.left}px)`:`translateX(${s.innerWidth+c-r.left}px)`:i==="right"?t?`translateX(-${r.right-t.left-c}px)`:`translateX(-${r.left+r.width-c}px)`:i==="up"?t?`translateY(${t.bottom+u-r.top}px)`:`translateY(${s.innerHeight+u-r.top}px)`:t?`translateY(-${r.top-t.top+r.height-u}px)`:`translateY(-${r.top+r.height-u}px)`}function PC(i){return typeof i=="function"?i():i}function Qh(i,e,n){const r=PC(n),t=AC(i,e,r);t&&(e.style.webkitTransform=t,e.style.transform=t)}const RC=Z.forwardRef(function(e,n){const r=bs(),t={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:c=!0,children:u,container:l,direction:h="down",easing:f=t,in:m,onEnter:d,onEntered:y,onEntering:b,onExit:g,onExited:v,onExiting:_,style:S,timeout:I=s,TransitionComponent:A=pr,...R}=e,E=Z.useRef(null),k=Zn(vu(u),E,n),P=K=>$=>{K&&($===void 0?K(E.current):K(E.current,$))},T=P((K,$)=>{Qh(h,K,l),cw(K),d&&d(K,$)}),M=P((K,$)=>{const U=hu({timeout:I,style:S,easing:f},{mode:"enter"});K.style.webkitTransition=r.transitions.create("-webkit-transform",{...U}),K.style.transition=r.transitions.create("transform",{...U}),K.style.webkitTransform="none",K.style.transform="none",b&&b(K,$)}),C=P(y),D=P(_),F=P(K=>{const $=hu({timeout:I,style:S,easing:f},{mode:"exit"});K.style.webkitTransition=r.transitions.create("-webkit-transform",$),K.style.transition=r.transitions.create("transform",$),Qh(h,K,l),g&&g(K)}),B=P(K=>{K.style.webkitTransition="",K.style.transition="",v&&v(K)}),L=K=>{a&&a(E.current,K)},q=Z.useCallback(()=>{E.current&&Qh(h,E.current,l)},[h,l]);return Z.useEffect(()=>{if(m||h==="down"||h==="right")return;const K=HP(()=>{E.current&&Qh(h,E.current,l)}),$=fu(E.current);return $.addEventListener("resize",K),()=>{K.clear(),$.removeEventListener("resize",K)}},[h,m,l]),Z.useEffect(()=>{m||q()},[m,q]),J.jsx(A,{nodeRef:E,onEnter:T,onEntered:C,onEntering:M,onExit:F,onExited:B,onExiting:D,addEndListener:L,appear:c,in:m,timeout:I,...R,children:(K,{ownerState:$,...U})=>Z.cloneElement(u,{ref:k,style:{visibility:K==="exited"&&!m?"hidden":void 0,...S,...u.props.style},...U})})});function NC(i){return dn("MuiDrawer",i)}bn("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Q4=(i,e)=>{const{ownerState:n}=i;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},CC=i=>{const{classes:e,anchor:n,variant:r}=i,t={root:["root",`anchor${Le(n)}`],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Le(n)}`,r!=="temporary"&&`paperAnchorDocked${Le(n)}`]};return mn(t,NC,e)},MC=pt(IC,{name:"MuiDrawer",slot:"Root",overridesResolver:Q4})(On(({theme:i})=>({zIndex:(i.vars||i).zIndex.drawer}))),BC=pt("div",{shouldForwardProp:M4,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Q4})({flex:"0 0 auto"}),DC=pt(Sf,{name:"MuiDrawer",slot:"Paper",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.paper,e[`paperAnchor${Le(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${Le(n.anchor)}`]]}})(On(({theme:i})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(i.vars||i).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(i.vars||i).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(i.vars||i).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(i.vars||i).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(i.vars||i).palette.divider}`}}]}))),Z4={left:"right",right:"left",top:"down",bottom:"up"};function LC(i){return["left","right"].includes(i)}function FC({direction:i},e){return i==="rtl"&&LC(e)?Z4[e]:e}const UC=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiDrawer"}),t=bs(),s=tw(),a={enter:t.transitions.duration.enteringScreen,exit:t.transitions.duration.leavingScreen},{anchor:c="left",BackdropProps:u,children:l,className:h,elevation:f=16,hideBackdrop:m=!1,ModalProps:{BackdropProps:d,...y}={},onClose:b,open:g=!1,PaperProps:v={},SlideProps:_,TransitionComponent:S,transitionDuration:I=a,variant:A="temporary",slots:R={},slotProps:E={},...k}=r,P=Z.useRef(!1);Z.useEffect(()=>{P.current=!0},[]);const T=FC({direction:s?"rtl":"ltr"},c),C={...r,anchor:c,elevation:f,open:g,variant:A,...k},D=CC(C),F={slots:{transition:S,...R},slotProps:{paper:v,transition:_,...E,backdrop:v7(E.backdrop||{...u,...d},{transitionDuration:I})}},[B,L]=Hi("root",{ref:n,elementType:MC,className:Xe(D.root,D.modal,h),shouldForwardComponentProp:!0,ownerState:C,externalForwardedProps:{...F,...k,...y},additionalProps:{open:g,onClose:b,hideBackdrop:m,slots:{backdrop:F.slots.backdrop},slotProps:{backdrop:F.slotProps.backdrop}}}),[q,K]=Hi("paper",{elementType:DC,shouldForwardComponentProp:!0,className:Xe(D.paper,v.className),ownerState:C,externalForwardedProps:F,additionalProps:{elevation:A==="temporary"?f:0,square:!0}}),[$,U]=Hi("docked",{elementType:BC,ref:n,className:Xe(D.root,D.docked,h),ownerState:C,externalForwardedProps:F,additionalProps:k}),[z,G]=Hi("transition",{elementType:RC,ownerState:C,externalForwardedProps:F,additionalProps:{in:g,direction:Z4[T],timeout:I,appear:P.current}}),ne=J.jsx(q,{...K,children:l});if(A==="permanent")return J.jsx($,{...U,children:ne});const ce=J.jsx(z,{...G,children:ne});return A==="persistent"?J.jsx($,{...U,children:ce}):J.jsx(B,{...L,children:ce})});function mm(i){return`scale(${i}, ${i**2})`}const HC={entering:{opacity:1,transform:mm(1)},entered:{opacity:1,transform:"none"}},pb=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),wm=Z.forwardRef(function(e,n){const{addEndListener:r,appear:t=!0,children:s,easing:a,in:c,onEnter:u,onEntered:l,onEntering:h,onExit:f,onExited:m,onExiting:d,style:y,timeout:b="auto",TransitionComponent:g=pr,...v}=e,_=iu(),S=Z.useRef(),I=bs(),A=Z.useRef(null),R=Zn(A,vu(s),n),E=B=>L=>{if(B){const q=A.current;L===void 0?B(q):B(q,L)}},k=E(h),P=E((B,L)=>{cw(B);const{duration:q,delay:K,easing:$}=hu({style:y,timeout:b,easing:a},{mode:"enter"});let U;b==="auto"?(U=I.transitions.getAutoHeightDuration(B.clientHeight),S.current=U):U=q,B.style.transition=[I.transitions.create("opacity",{duration:U,delay:K}),I.transitions.create("transform",{duration:pb?U:U*.666,delay:K,easing:$})].join(","),u&&u(B,L)}),T=E(l),M=E(d),C=E(B=>{const{duration:L,delay:q,easing:K}=hu({style:y,timeout:b,easing:a},{mode:"exit"});let $;b==="auto"?($=I.transitions.getAutoHeightDuration(B.clientHeight),S.current=$):$=L,B.style.transition=[I.transitions.create("opacity",{duration:$,delay:q}),I.transitions.create("transform",{duration:pb?$:$*.666,delay:pb?q:q||$*.333,easing:K})].join(","),B.style.opacity=0,B.style.transform=mm(.75),f&&f(B)}),D=E(m),F=B=>{b==="auto"&&_.start(S.current||0,B),r&&r(A.current,B)};return J.jsx(g,{appear:t,in:c,nodeRef:A,onEnter:P,onEntered:T,onEntering:k,onExit:C,onExited:D,onExiting:M,addEndListener:F,timeout:b==="auto"?null:b,...v,children:(B,{ownerState:L,...q})=>Z.cloneElement(s,{style:{opacity:0,transform:mm(.75),visibility:B==="exited"&&!c?"hidden":void 0,...HC[B],...y,...s.props.style},ref:R,...q})})});wm&&(wm.muiSupportAuto=!0);function qC(i){return dn("MuiTooltip",i)}const Yt=bn("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function jC(i){return Math.round(i*1e5)/1e5}const VC=i=>{const{classes:e,disableInteractive:n,arrow:r,touch:t,placement:s}=i,a={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",t&&"touch",`tooltipPlacement${Le(s.split("-")[0])}`],arrow:["arrow"]};return mn(a,qC,e)},KC=pt(X4,{name:"MuiTooltip",slot:"Popper",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(On(({theme:i})=>({zIndex:(i.vars||i).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Yt.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Yt.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Yt.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Yt.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Yt.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Yt.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Yt.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Yt.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),WC=pt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(i,e)=>{const{ownerState:n}=i;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${Le(n.placement.split("-")[0])}`]]}})(On(({theme:i})=>({backgroundColor:i.vars?i.vars.palette.Tooltip.bg:En(i.palette.grey[700],.92),borderRadius:(i.vars||i).shape.borderRadius,color:(i.vars||i).palette.common.white,fontFamily:i.typography.fontFamily,padding:"4px 8px",fontSize:i.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:i.typography.fontWeightMedium,[`.${Yt.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Yt.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Yt.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Yt.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:i.typography.pxToRem(14),lineHeight:`${jC(16/14)}em`,fontWeight:i.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Yt.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Yt.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Yt.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Yt.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Yt.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Yt.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Yt.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Yt.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Yt.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Yt.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),$C=pt("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(i,e)=>e.arrow})(On(({theme:i})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:i.vars?i.vars.palette.Tooltip.bg:En(i.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Zh=!1;const O2=new v0;let Il={x:0,y:0};function Jh(i,e){return(n,...r)=>{e&&e(n,...r),i(n,...r)}}const So=Z.forwardRef(function(e,n){const r=rn({props:e,name:"MuiTooltip"}),{arrow:t=!1,children:s,classes:a,components:c={},componentsProps:u={},describeChild:l=!1,disableFocusListener:h=!1,disableHoverListener:f=!1,disableInteractive:m=!1,disableTouchListener:d=!1,enterDelay:y=100,enterNextDelay:b=0,enterTouchDelay:g=700,followCursor:v=!1,id:_,leaveDelay:S=0,leaveTouchDelay:I=1500,onClose:A,onOpen:R,open:E,placement:k="bottom",PopperComponent:P,PopperProps:T={},slotProps:M={},slots:C={},title:D,TransitionComponent:F,TransitionProps:B,...L}=r,q=Z.isValidElement(s)?s:J.jsx("span",{children:s}),K=bs(),$=tw(),[U,z]=Z.useState(),[G,ne]=Z.useState(null),ce=Z.useRef(!1),Se=m||v,Ie=iu(),me=iu(),xe=iu(),ke=iu(),[Re,Ce]=VP({controlled:E,default:!1,name:"Tooltip",state:"open"});let Ne=Re;const We=b4(_),dt=Z.useRef(),Ut=ds(()=>{dt.current!==void 0&&(document.body.style.WebkitUserSelect=dt.current,dt.current=void 0),ke.clear()});Z.useEffect(()=>Ut,[Ut]);const Ht=Ae=>{O2.clear(),Zh=!0,Ce(!0),R&&!Ne&&R(Ae)},Je=ds(Ae=>{O2.start(800+S,()=>{Zh=!1}),Ce(!1),A&&Ne&&A(Ae),Ie.start(K.transitions.duration.shortest,()=>{ce.current=!1})}),At=Ae=>{ce.current&&Ae.type!=="touchstart"||(U&&U.removeAttribute("title"),me.clear(),xe.clear(),y||Zh&&b?me.start(Zh?b:y,()=>{Ht(Ae)}):Ht(Ae))},Te=Ae=>{me.clear(),xe.start(S,()=>{Je(Ae)})},[,j]=Z.useState(!1),he=Ae=>{Gp(Ae.target)||(j(!1),Te(Ae))},de=Ae=>{U||z(Ae.currentTarget),Gp(Ae.target)&&(j(!0),At(Ae))},Me=Ae=>{ce.current=!0;const nt=q.props;nt.onTouchStart&&nt.onTouchStart(Ae)},ct=Ae=>{Me(Ae),xe.clear(),Ie.clear(),Ut(),dt.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ke.start(g,()=>{document.body.style.WebkitUserSelect=dt.current,At(Ae)})},Hn=Ae=>{q.props.onTouchEnd&&q.props.onTouchEnd(Ae),Ut(),xe.start(I,()=>{Je(Ae)})};Z.useEffect(()=>{if(!Ne)return;function Ae(nt){nt.key==="Escape"&&Je(nt)}return document.addEventListener("keydown",Ae),()=>{document.removeEventListener("keydown",Ae)}},[Je,Ne]);const wn=Zn(vu(q),z,n);!D&&D!==0&&(Ne=!1);const Dt=Z.useRef(),vn=Ae=>{const nt=q.props;nt.onMouseMove&&nt.onMouseMove(Ae),Il={x:Ae.clientX,y:Ae.clientY},Dt.current&&Dt.current.update()},qt={},Wt=typeof D=="string";l?(qt.title=!Ne&&Wt&&!f?D:null,qt["aria-describedby"]=Ne?We:null):(qt["aria-label"]=Wt?D:null,qt["aria-labelledby"]=Ne&&!Wt?We:null);const rt={...qt,...L,...q.props,className:Xe(L.className,q.props.className),onTouchStart:Me,ref:wn,...v?{onMouseMove:vn}:{}},An={};d||(rt.onTouchStart=ct,rt.onTouchEnd=Hn),f||(rt.onMouseOver=Jh(At,rt.onMouseOver),rt.onMouseLeave=Jh(Te,rt.onMouseLeave),Se||(An.onMouseOver=At,An.onMouseLeave=Te)),h||(rt.onFocus=Jh(de,rt.onFocus),rt.onBlur=Jh(he,rt.onBlur),Se||(An.onFocus=de,An.onBlur=he));const Lt={...r,isRtl:$,arrow:t,disableInteractive:Se,placement:k,PopperComponentProp:P,touch:ce.current},Y=typeof M.popper=="function"?M.popper(Lt):M.popper,X=Z.useMemo(()=>{var nt,gr;let Ae=[{name:"arrow",enabled:!!G,options:{element:G,padding:4}}];return(nt=T.popperOptions)!=null&&nt.modifiers&&(Ae=Ae.concat(T.popperOptions.modifiers)),(gr=Y==null?void 0:Y.popperOptions)!=null&&gr.modifiers&&(Ae=Ae.concat(Y.popperOptions.modifiers)),{...T.popperOptions,...Y==null?void 0:Y.popperOptions,modifiers:Ae}},[G,T.popperOptions,Y==null?void 0:Y.popperOptions]),re=VC(Lt),le=typeof M.transition=="function"?M.transition(Lt):M.transition,se={slots:{popper:c.Popper,transition:c.Transition??F,tooltip:c.Tooltip,arrow:c.Arrow,...C},slotProps:{arrow:M.arrow??u.arrow,popper:{...T,...Y??u.popper},tooltip:M.tooltip??u.tooltip,transition:{...B,...le??u.transition}}},[ye,Oe]=Hi("popper",{elementType:KC,externalForwardedProps:se,ownerState:Lt,className:Xe(re.popper,T==null?void 0:T.className)}),[Fe,Ve]=Hi("transition",{elementType:wm,externalForwardedProps:se,ownerState:Lt}),[$e,et]=Hi("tooltip",{elementType:WC,className:re.tooltip,externalForwardedProps:se,ownerState:Lt}),[ze,mt]=Hi("arrow",{elementType:$C,className:re.arrow,externalForwardedProps:se,ownerState:Lt,ref:ne});return J.jsxs(Z.Fragment,{children:[Z.cloneElement(q,rt),J.jsx(ye,{as:P??X4,placement:k,anchorEl:v?{getBoundingClientRect:()=>({top:Il.y,left:Il.x,right:Il.x,bottom:Il.y,width:0,height:0})}:U,popperRef:Dt,open:U?Ne:!1,id:We,transition:!0,...An,...Oe,popperOptions:X,children:({TransitionProps:Ae})=>J.jsx(Fe,{timeout:K.transitions.duration.shorter,...Ae,...Ve,children:J.jsxs($e,{...et,children:[D,t?J.jsx(ze,{...mt}):null]})})})]})}),zC=OR({createStyledComponent:pt("div",{name:"MuiStack",slot:"Root",overridesResolver:(i,e)=>e.root}),useThemeProps:i=>rn({props:i,name:"MuiStack"})}),E0={aspectRatio:"1.67",width:"100%",height:"auto",objectFit:"cover"},O0={width:"100%",height:"auto",borderRadius:2,boxShadow:"0 8px 24px rgba(44, 110, 142, 0.2)",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(44, 110, 142, 0.2)"}},A0={width:"100%",height:"auto",borderRadius:2,boxShadow:"none",opacity:.3,cursor:"not-allowed","&:hover":{transform:"none",boxShadow:"none",cursor:"not-allowed"}},P0={fontSize:20,fontWeight:600,color:"#2c6e8e"},R0={fontSize:15,color:"#607d8b"};var Ee;let ie=(Ee=class{constructor(e=0,n=10,r="be"){te(this,"_magnitude");te(this,"_sign");te(this,"_nominalWordLength");te(this,"red");if(this._magnitude=0n,this._sign=0,this._nominalWordLength=1,this.red=null,e===void 0&&(e=0),e===null){this._initializeState(0n,0);return}if(typeof e=="bigint"){this._initializeState(e<0n?-e:e,e<0n?1:0),this.normSign();return}let t=n,s=r;if((n==="le"||n==="be")&&(s=n,t=10),typeof e=="number"){this.initNumber(e,s);return}if(Array.isArray(e)){this.initArray(e,s);return}if(typeof e=="string"){t==="hex"&&(t=16),this.assert(typeof t=="number"&&t===(t|0)&&t>=2&&t<=36,"Base must be an integer between 2 and 36");const a=e.toString().replace(/\s+/g,"");let c=0,u=0;a.startsWith("-")?(c++,u=1):a.startsWith("+")&&c++;const l=a.substring(c);if(l.length===0){this._initializeState(0n,u===1&&a.startsWith("-")?1:0),this.normSign();return}if(t===16){let h;if(s==="le"){const f=[];let m=l;m.length%2!==0&&(m="0"+m);for(let d=0;d<m.length;d+=2){const y=m.substring(d,d+2),b=parseInt(y,16);if(isNaN(b))throw new Error("Invalid character in "+m);f.push(b)}this.initArray(f,"le"),this._sign=u,this.normSign();return}else try{h=BigInt("0x"+l)}catch{throw new Error("Invalid character in "+l)}this._initializeState(h,u),this.normSign()}else try{if(this._parseBaseString(l,t),this._sign=u,this.normSign(),s==="le"){const h=this._sign;this.initArray(this.toArray("be"),"le"),this._sign=h,this.normSign()}}catch(h){const f=h;throw f.message.includes("Invalid character in string")||f.message.includes("Invalid digit for base")||f.message.startsWith("Invalid character:")?new Error("Invalid character"):f}}else e!==0?this.assert(!1,"Unsupported input type for BigNumber constructor"):this._initializeState(0n,0)}get negative(){return this._sign}set negative(e){this.assert(e===0||e===1,"Negative property must be 0 or 1");const n=e===1?1:0;this._magnitude===0n?this._sign=0:this._sign=n}get _computedWordsArray(){if(this._magnitude===0n)return[0];const e=[];let n=this._magnitude;for(;n>0n;)e.push(Number(n&Ee.WORD_MASK)),n>>=Ee.WORD_SIZE_BIGINT;return e.length>0?e:[0]}get words(){const e=this._computedWordsArray;if(this._nominalWordLength<=e.length)return e;const n=new Array(this._nominalWordLength).fill(0);for(let r=0;r<e.length;r++)n[r]=e[r];return n}set words(e){const n=this._sign;let r=0n;const t=e.length>0?e.length:1;for(let s=t-1;s>=0;s--){const a=e[s]===void 0?0:e[s];r=r<<Ee.WORD_SIZE_BIGINT|BigInt(a&Number(Ee.WORD_MASK))}this._magnitude=r,this._sign=n,this._nominalWordLength=t,this.normSign()}get length(){return Math.max(1,this._nominalWordLength)}static isBN(e){var n;return e instanceof Ee?!0:e!==null&&typeof e=="object"&&((n=e.constructor)==null?void 0:n.wordSize)===Ee.wordSize&&Array.isArray(e.words)}static max(e,n){return e.cmp(n)>0?e:n}static min(e,n){return e.cmp(n)<0?e:n}_bigIntToStringInBase(e,n){if(e===0n)return"0";if(n<2||n>36)throw new Error("Base must be between 2 and 36");const r="0123456789abcdefghijklmnopqrstuvwxyz";let t="",s=e>0n?e:-e;const a=BigInt(n);for(;s>0n;)t=r[Number(s%a)]+t,s/=a;return t}_parseBaseString(e,n){if(e.length===0){this._magnitude=0n,this._finishInitialization();return}this._magnitude=0n;const r=BigInt(n);let t=Ee.groupSizes[n],s=BigInt(Ee.groupBases[n]);(t===0||s===0n)&&(t=Math.floor(Math.log(67108863)/Math.log(n)),t===0&&(t=1),s=r**BigInt(t));let a=0;const c=e.length;let u=c%t;if(u===0&&c>0&&(u=t),u>0){const l=e.substring(a,a+u);this._magnitude=BigInt(this._parseBaseWord(l,n)),a+=u}for(;a<c;){const l=e.substring(a,a+t),h=BigInt(this._parseBaseWord(l,n));this._magnitude=this._magnitude*s+h,a+=t}this._finishInitialization()}_parseBaseWord(e,n){let r=0;for(let t=0;t<e.length;t++){const s=e.charCodeAt(t);let a;if(s>=48&&s<=57)a=s-48;else if(s>=65&&s<=90)a=s-65+10;else if(s>=97&&s<=122)a=s-97+10;else throw new Error("Invalid character: "+e[t]);if(a>=n)throw new Error("Invalid character");r=r*n+a}return r}_initializeState(e,n){this._magnitude=e,this._sign=e===0n?0:n,this._finishInitialization()}_finishInitialization(){if(this._magnitude===0n)this._nominalWordLength=1,this._sign=0;else{const e=this._magnitude.toString(2).length;this._nominalWordLength=Math.max(1,Math.ceil(e/Ee.wordSize))}}assert(e,n="Assertion failed"){if(!e)throw new Error(n)}initNumber(e,n="be"){if(this.assert(BigInt(Math.abs(e))<=Ee.MAX_NUMBER_CONSTRUCTOR_MAG_BIGINT,"The number is larger than 2 ^ 53 (unsafe)"),this.assert(e%1===0,"Number must be an integer for BigNumber conversion"),this._initializeState(BigInt(Math.abs(e)),e<0?1:0),n==="le"){const r=this._sign,t=this.toArray("be");this.initArray(t,"le"),this._sign=r,this.normSign()}return this}initArray(e,n){if(e.length===0)return this._initializeState(0n,0),this;let r=0n;if(n==="be")for(let t=0;t<e.length;t++)r=r<<8n|BigInt(e[t]&255);else for(let t=e.length-1;t>=0;t--)r=r<<8n|BigInt(e[t]&255);return this._initializeState(r,0),this}copy(e){e._magnitude=this._magnitude,e._sign=this._sign,e._nominalWordLength=this._nominalWordLength,e.red=this.red}static move(e,n){e._magnitude=n._magnitude,e._sign=n._sign,e._nominalWordLength=n._nominalWordLength,e.red=n.red}clone(){const e=new Ee(0n);return this.copy(e),e}expand(e){return this.assert(e>=0,"Expand size must be non-negative"),this._nominalWordLength=Math.max(this._nominalWordLength,e,1),this}strip(){return this._finishInitialization(),this.normSign()}normSign(){return this._magnitude===0n&&(this._sign=0),this}inspect(){return(this.red!==null?"<BN-R: ":"<BN: ")+this.toString(16)+">"}_getMinimalHex(){return this._magnitude===0n?"0":this._magnitude.toString(16)}toString(e=10,n=1){if(e===16||e==="hex"){let r=this._getMinimalHex();if(n>1)for(r!=="0"&&r.length%2!==0&&(r="0"+r);r.length%n!==0;)r="0"+r;return(this.isNeg()?"-":"")+r}if(typeof e!="number"||e<2||e>36||e%1!==0)throw new Error("Base should be an integer between 2 and 36");return this.toBaseString(e,n)}toBaseString(e,n){if(this._magnitude===0n){let c="0";if(n>1)for(;c.length<n;)c="0"+c;return c}let r=Ee.groupSizes[e],t=BigInt(Ee.groupBases[e]);(r===0||t===0n)&&(r=Math.floor(Math.log(Number.MAX_SAFE_INTEGER)/Math.log(e)),r===0&&(r=1),t=BigInt(e)**BigInt(r));let s="",a=this._magnitude;for(;a>0n;){const c=a%t;a/=t;const u=this._bigIntToStringInBase(c,e);if(a>0n){const l=r-u.length;l>0&&l<Ee.zeros.length?s=Ee.zeros[l]+u+s:l>0?s="0".repeat(l)+u+s:s=u+s}else s=u+s}if(n>0)for(;s.length<n;)s="0"+s;return(this._sign===1?"-":"")+s}toNumber(){const e=this._getSignedValue();if(e>Ee.MAX_SAFE_INTEGER_BIGINT||e<Ee.MIN_SAFE_INTEGER_BIGINT)throw new Error("Number can only safely store up to 53 bits");return Number(e)}toJSON(){const e=this._getMinimalHex();return(this.isNeg()?"-":"")+e}toArrayLikeGeneric(e,n){let r=this._magnitude,t=n?0:e.length-1;const s=n?1:-1;for(let a=0;a<e.length;++a){if(r===0n&&t>=0&&t<e.length)e[t]=0;else if(t>=0&&t<e.length)e[t]=Number(r&0xffn);else break;r>>=8n,t+=s}}toArray(e="be",n){this.strip();const r=this.byteLength(),t=n??Math.max(1,r);this.assert(r<=t,"byte array longer than desired length"),this.assert(t>0,"Requested array length <= 0");const s=new Array(t).fill(0);return this._magnitude===0n&&t>0?s:this._magnitude===0n&&t===0?[]:(this.toArrayLikeGeneric(s,e==="le"),s)}bitLength(){return this._magnitude===0n?0:this._magnitude.toString(2).length}static toBitArray(e){const n=e.bitLength();if(n===0)return[];const r=new Array(n),t=e._magnitude;for(let s=0;s<n;s++)r[s]=(t>>BigInt(s)&1n)!==0n?1:0;return r}toBitArray(){return Ee.toBitArray(this)}zeroBits(){if(this._magnitude===0n)return 0;let e=0,n=this._magnitude;for(;(n&1n)===0n&&n!==0n;)e++,n>>=1n;return e}byteLength(){return this._magnitude===0n?0:Math.ceil(this.bitLength()/8)}_getSignedValue(){return this._sign===1?-this._magnitude:this._magnitude}_setValueFromSigned(e){e<0n?(this._magnitude=-e,this._sign=1):(this._magnitude=e,this._sign=0),this._finishInitialization(),this.normSign()}toTwos(e){this.assert(e>=0);const n=BigInt(e);let r=this._getSignedValue();this._sign===1&&this._magnitude!==0n&&(r=(1n<<n)+r);const t=(1n<<n)-1n;r&=t;const s=new Ee(0n);return s._initializeState(r,0),s}fromTwos(e){this.assert(e>=0);const n=BigInt(e),r=this._magnitude;if(e>0&&(r>>n-1n&1n)!==0n&&this._sign===0){const t=r-(1n<<n),s=new Ee(0n);return s._setValueFromSigned(t),s}return this.clone()}isNeg(){return this._sign===1&&this._magnitude!==0n}neg(){return this.clone().ineg()}ineg(){return this._magnitude!==0n&&(this._sign=this._sign===1?0:1),this}_iuop(e,n){const r=n(this._magnitude,e._magnitude),t=n===((a,c)=>a^c);let s=this._nominalWordLength;return t&&(s=Math.max(this.length,e.length)),this._magnitude=r,this._finishInitialization(),t&&(this._nominalWordLength=Math.max(this._nominalWordLength,s)),this.strip()}iuor(e){return this._iuop(e,(n,r)=>n|r)}iuand(e){return this._iuop(e,(n,r)=>n&r)}iuxor(e){return this._iuop(e,(n,r)=>n^r)}_iop(e,n){return this.assert(this._sign===0&&e._sign===0),this._iuop(e,n)}ior(e){return this._iop(e,(n,r)=>n|r)}iand(e){return this._iop(e,(n,r)=>n&r)}ixor(e){return this._iop(e,(n,r)=>n^r)}_uop_new(e,n){return this.length>=e.length?this.clone()[n](e):e.clone()[n](this)}or(e){return this.assert(this._sign===0&&e._sign===0),this._uop_new(e,"iuor")}uor(e){return this._uop_new(e,"iuor")}and(e){return this.assert(this._sign===0&&e._sign===0),this._uop_new(e,"iuand")}uand(e){return this._uop_new(e,"iuand")}xor(e){return this.assert(this._sign===0&&e._sign===0),this._uop_new(e,"iuxor")}uxor(e){return this._uop_new(e,"iuxor")}inotn(e){this.assert(typeof e=="number"&&e>=0);const r=(1n<<BigInt(e))-1n;this._magnitude=~this._magnitude&r;const t=e===0?1:Math.ceil(e/Ee.wordSize);return this._nominalWordLength=Math.max(1,t),this.strip(),this._nominalWordLength=Math.max(this._nominalWordLength,Math.max(1,t)),this}notn(e){return this.clone().inotn(e)}setn(e,n){this.assert(typeof e=="number"&&e>=0);const r=BigInt(e);n===1||n===!0?this._magnitude|=1n<<r:this._magnitude&=~(1n<<r);const t=Math.floor(e/Ee.wordSize)+1;return this._nominalWordLength=Math.max(this._nominalWordLength,t),this._finishInitialization(),this.strip()}iadd(e){return this._setValueFromSigned(this._getSignedValue()+e._getSignedValue()),this}add(e){const n=new Ee(0n);return n._setValueFromSigned(this._getSignedValue()+e._getSignedValue()),n}isub(e){return this._setValueFromSigned(this._getSignedValue()-e._getSignedValue()),this}sub(e){const n=new Ee(0n);return n._setValueFromSigned(this._getSignedValue()-e._getSignedValue()),n}mul(e){const n=new Ee(0n);return n._magnitude=this._magnitude*e._magnitude,n._sign=n._magnitude===0n?0:this._sign^e._sign,n._nominalWordLength=this.length+e.length,n.red=null,n.normSign()}imul(e){return this._magnitude*=e._magnitude,this._sign=this._magnitude===0n?0:this._sign^e._sign,this._nominalWordLength=this.length+e.length,this.red=null,this.normSign()}imuln(e){return this.assert(typeof e=="number","Assertion failed"),this.assert(Math.abs(e)<=Ee.MAX_IMULN_ARG,"Assertion failed"),this._setValueFromSigned(this._getSignedValue()*BigInt(e)),this}muln(e){return this.clone().imuln(e)}sqr(){const e=new Ee(0n);return e._magnitude=this._magnitude*this._magnitude,e._sign=0,e._nominalWordLength=this.length*2,e.red=null,e}isqr(){return this._magnitude*=this._magnitude,this._sign=0,this._nominalWordLength=this.length*2,this.red=null,this}pow(e){if(this.assert(e._sign===0,"Exponent for pow must be non-negative"),e.isZero())return new Ee(1n);const n=new Ee(1n),r=this.clone(),t=e.clone(),s=r.isNeg(),a=t.isOdd();for(s&&r.ineg();!t.isZero();)t.isOdd()&&n.imul(r),r.isqr(),t.iushrn(1);return s&&a&&n.ineg(),n}iushln(e){return this.assert(typeof e=="number"&&e>=0),e===0?this:(this._magnitude<<=BigInt(e),this._finishInitialization(),this.strip())}ishln(e){return this.assert(this._sign===0,"ishln requires positive number"),this.iushln(e)}iushrn(e,n,r){if(this.assert(typeof e=="number"&&e>=0),e===0)return r!=null&&r._initializeState(0n,0),this;if(r!=null){const t=(1n<<BigInt(e))-1n,s=this._magnitude&t;r._initializeState(s,0)}return this._magnitude>>=BigInt(e),this._finishInitialization(),this.strip()}ishrn(e,n,r){return this.assert(this._sign===0,"ishrn requires positive number"),this.iushrn(e,n,r)}shln(e){return this.clone().ishln(e)}ushln(e){return this.clone().iushln(e)}shrn(e){return this.clone().ishrn(e)}ushrn(e){return this.clone().iushrn(e)}testn(e){return this.assert(typeof e=="number"&&e>=0),(this._magnitude>>BigInt(e)&1n)!==0n}imaskn(e){this.assert(typeof e=="number"&&e>=0),this.assert(this._sign===0,"imaskn works only with positive numbers");const n=BigInt(e),r=n===0n?0n:(1n<<n)-1n;this._magnitude&=r;const t=e===0?1:Math.max(1,Math.ceil(e/Ee.wordSize));return this._nominalWordLength=t,this._finishInitialization(),this._nominalWordLength=Math.max(this._nominalWordLength,t),this.strip()}maskn(e){return this.clone().imaskn(e)}iaddn(e){return this.assert(typeof e=="number"),this.assert(Math.abs(e)<=Ee.MAX_IMULN_ARG,"num is too large"),this._setValueFromSigned(this._getSignedValue()+BigInt(e)),this}_iaddn(e){return this.iaddn(e)}isubn(e){return this.assert(typeof e=="number"),this.assert(Math.abs(e)<=Ee.MAX_IMULN_ARG,"Assertion failed"),this._setValueFromSigned(this._getSignedValue()-BigInt(e)),this}addn(e){return this.clone().iaddn(e)}subn(e){return this.clone().isubn(e)}iabs(){return this._sign=0,this}abs(){return this.clone().iabs()}divmod(e,n,r){if(this.assert(!e.isZero(),"Division by zero"),this.isZero()){const h=new Ee(0n);return{div:n!=="mod"?h:null,mod:n!=="div"?h:null}}const t=this._getSignedValue(),s=e._getSignedValue();let a=null,c=null;n!=="mod"&&(a=t/s),n!=="div"&&(c=t%s,r===!0&&c<0n&&(c+=s<0n?-s:s));const u=a!==null?new Ee(0n):null;u!==null&&a!==null&&u._setValueFromSigned(a);const l=c!==null?new Ee(0n):null;return l!==null&&c!==null&&l._setValueFromSigned(c),{div:u,mod:l}}div(e){return this.divmod(e,"div",!1).div}mod(e){return this.divmod(e,"mod",!1).mod}umod(e){return this.divmod(e,"mod",!0).mod}divRound(e){this.assert(!e.isZero());const n=this._getSignedValue(),r=e._getSignedValue();let t=n/r;const s=n%r;if(s===0n){const l=new Ee(0n);return l._setValueFromSigned(t),l}const a=s<0n?-s:s,c=r<0n?-r:r;a*2n>=c&&(n>0n&&r>0n||n<0n&&r<0n?t+=1n:t-=1n);const u=new Ee(0n);return u._setValueFromSigned(t),u}modrn(e){this.assert(e!==0,"Division by zero in modrn");const n=BigInt(Math.abs(e));if(n===0n)throw new Error("Division by zero in modrn");const r=this._magnitude%n;return e<0?Number(-r):Number(r)}idivn(e){return this.assert(e!==0),this.assert(Math.abs(e)<=Ee.MAX_IMULN_ARG,"num is too large"),this._setValueFromSigned(this._getSignedValue()/BigInt(e)),this}divn(e){return this.clone().idivn(e)}egcd(e){this.assert(e._sign===0,"p must not be negative"),this.assert(!e.isZero(),"p must not be zero");let n=this._getSignedValue(),r=e._magnitude,t=1n,s=0n,a=0n,c=1n;for(;r!==0n;){const f=n/r;let m=r;r=n%r,n=m,m=s,s=t-f*s,t=m,m=c,c=a-f*c,a=m}const u=new Ee(0n);u._setValueFromSigned(t);const l=new Ee(0n);l._setValueFromSigned(a);const h=new Ee(0n);return h._initializeState(n<0n?-n:n,0),{a:u,b:l,gcd:h}}gcd(e){let n=this._magnitude,r=e._magnitude;if(n===0n){const s=new Ee(0n);return s._setValueFromSigned(r),s.iabs()}if(r===0n){const s=new Ee(0n);return s._setValueFromSigned(n),s.iabs()}for(;r!==0n;){const s=n%r;n=r,r=s}const t=new Ee(0n);return t._initializeState(n,0),t}invm(e){this.assert(!e.isZero()&&e._sign===0,"Modulus for invm must be positive and non-zero");const n=this.egcd(e);if(!n.gcd.eqn(1))throw new Error("Inverse does not exist (numbers are not coprime).");return n.a.umod(e)}isEven(){return this._magnitude%2n===0n}isOdd(){return this._magnitude%2n===1n}andln(e){return this.assert(e>=0),Number(this._magnitude&BigInt(e))}bincn(e){this.assert(typeof e=="number"&&e>=0);const n=1n<<BigInt(e);return this._setValueFromSigned(this._getSignedValue()+n),this}isZero(){return this._magnitude===0n}cmpn(e){this.assert(Math.abs(e)<=Ee.MAX_IMULN_ARG,"Number is too big");const n=this._getSignedValue(),r=BigInt(e);return n<r?-1:n>r?1:0}cmp(e){const n=this._getSignedValue(),r=e._getSignedValue();return n<r?-1:n>r?1:0}ucmp(e){return this._magnitude<e._magnitude?-1:this._magnitude>e._magnitude?1:0}gtn(e){return this.cmpn(e)===1}gt(e){return this.cmp(e)===1}gten(e){return this.cmpn(e)>=0}gte(e){return this.cmp(e)>=0}ltn(e){return this.cmpn(e)===-1}lt(e){return this.cmp(e)===-1}lten(e){return this.cmpn(e)<=0}lte(e){return this.cmp(e)<=0}eqn(e){return this.cmpn(e)===0}eq(e){return this.cmp(e)===0}toRed(e){return this.assert(this.red==null,"Already a number in reduction context"),this.assert(this._sign===0,"toRed works only with positives"),e.convertTo(this).forceRed(e)}fromRed(){return this.assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)}forceRed(e){return this.red=e,this}redAdd(e){return this.assert(this.red,"redAdd works only with red numbers"),this.red.add(this,e)}redIAdd(e){return this.assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)}redSub(e){return this.assert(this.red,"redSub works only with red numbers"),this.red.sub(this,e)}redISub(e){return this.assert(this.red,"redISub works only with red numbers"),this.red.isub(this,e)}redShl(e){return this.assert(this.red,"redShl works only with red numbers"),this.red.shl(this,e)}redMul(e){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,e),this.red.mul(this,e)}redIMul(e){return this.assert(this.red,"redIMul works only with red numbers"),this.red.verify2(this,e),this.red.imul(this,e)}redSqr(){return this.assert(this.red,"redSqr works only with red numbers"),this.red.verify1(this),this.red.sqr(this)}redISqr(){return this.assert(this.red,"redISqr works only with red numbers"),this.red.verify1(this),this.red.isqr(this)}redSqrt(){return this.assert(this.red,"redSqrt works only with red numbers"),this.red.verify1(this),this.red.sqrt(this)}redInvm(){return this.assert(this.red,"redInvm works only with red numbers"),this.red.verify1(this),this.red.invm(this)}redNeg(){return this.assert(this.red,"redNeg works only with red numbers"),this.red.verify1(this),this.red.neg(this)}redPow(e){return this.assert(this.red!=null&&e.red==null,"redPow(normalNum)"),this.red.verify1(this),this.red.pow(this,e)}static fromHex(e,n){let r="be";return(n==="little"||n==="le")&&(r="le"),new Ee(e,16,r)}toHex(e=0){if(this.isZero()&&e===0)return"";let n=this._getMinimalHex();n!=="0"&&n.length%2!==0&&(n="0"+n);const r=e*2;for(;n.length<r;)n="0"+n;return(this.isNeg()?"-":"")+n}static fromJSON(e){return new Ee(e,16)}static fromNumber(e){return new Ee(e)}static fromString(e,n){return new Ee(e,n)}static fromSm(e,n="big"){if(e.length===0)return new Ee(0n);let r=0,t="";if(n==="little"){const c=e.length-1;let u=e[c];(u&128)!==0&&(r=1,u&=127),t+=(u<16?"0":"")+u.toString(16);for(let l=c-1;l>=0;l--){const h=e[l];t+=(h<16?"0":"")+h.toString(16)}}else{let c=e[0];(c&128)!==0&&(r=1,c&=127),t+=(c<16?"0":"")+c.toString(16);for(let u=1;u<e.length;u++){const l=e[u];t+=(l<16?"0":"")+l.toString(16)}}const s=t===""?0n:BigInt("0x"+t),a=new Ee(0n);return a._initializeState(s,r),a}toSm(e="big"){if(this._magnitude===0n)return this._sign===1?[128]:[];let n=this._getMinimalHex();n.length%2!==0&&(n="0"+n);const r=n.length/2,t=new Array(r);for(let s=0,a=0;s<n.length;s+=2)t[a++]=parseInt(n.slice(s,s+2),16);return this._sign===1?(t[0]&128)!==0?t.unshift(128):t[0]|=128:(t[0]&128)!==0&&t.unshift(0),e==="little"?t.reverse():t}static fromBits(e,n=!1){const r=e>>>24,t=e&8388607,s=(e&8388608)!==0;if(n&&s)throw new Error("negative bit set");if(r===0&&t===0){if(s&&n)throw new Error("negative bit set for zero value");return new Ee(0n)}const a=new Ee(t);return r<=3?a.iushrn((3-r)*8):a.iushln((r-3)*8),s&&a.ineg(),a}toBits(){if(this.strip(),this.isZero()&&!this.isNeg())return 0;const e=this.isNeg(),n=this.abs();let r=n.toArray("be"),t=0;for(;t<r.length-1&&r[t]===0;)t++;r=r.slice(t);let s=r.length;s===0&&!n.isZero()&&(r=[0],s=1),n.isZero()&&(s=0,r=[]);let a;if(s===0)a=0;else if(s<=3){a=0;for(let u=0;u<s;u++)a=a<<8|r[u]}else a=r[0]<<16|r[1]<<8|r[2];(a&8388608)!==0&&s<=255&&(a>>>=8,s++);let c=s<<24|a;return e&&(c|=8388608),c>>>0}static fromScriptNum(e,n=!1,r){if(r!==void 0&&e.length>r)throw new Error("script number overflow");if(e.length===0)return new Ee(0n);if(n&&(e[e.length-1]&127)===0&&(e.length<=1||(e[e.length-2]&128)===0))throw new Error("non-minimally encoded script number");return Ee.fromSm(e,"little")}toScriptNum(){return this.toSm("little")}_invmp(e){this.assert(e._sign===0,"p must not be negative for _invmp"),this.assert(!e.isZero(),"p must not be zero for _invmp");let r=this.umod(e)._magnitude,t=e._magnitude,s=1n,a=0n;const c=e._magnitude;for(;r>1n&&t>1n;){let h=0;for(;(r>>BigInt(h)&1n)===0n;)h++;if(h>0){r>>=BigInt(h);for(let m=0;m<h;++m)(s&1n)!==0n&&(s+=c),s>>=1n}let f=0;for(;(t>>BigInt(f)&1n)===0n;)f++;if(f>0){t>>=BigInt(f);for(let m=0;m<f;++m)(a&1n)!==0n&&(a+=c),a>>=1n}r>=t?(r-=t,s-=a):(t-=r,a-=s)}let u;if(r===1n)u=s;else if(t===1n)u=a;else if(r===0n&&t===1n)u=a;else if(t===0n&&r===1n)u=s;else throw new Error("_invmp: GCD is not 1, inverse does not exist. aVal="+r+", bVal="+t);u%=c,u<0n&&(u+=c);const l=new Ee(0n);return l._initializeState(u,0),l}mulTo(e,n){return n._magnitude=this._magnitude*e._magnitude,n._sign=n._magnitude===0n?0:this._sign^e._sign,n._nominalWordLength=this.length+e.length,n.red=null,n.normSign(),n}},te(Ee,"zeros",["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"]),te(Ee,"groupSizes",[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]),te(Ee,"groupBases",[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176]),te(Ee,"wordSize",26),te(Ee,"WORD_SIZE_BIGINT",BigInt(Ee.wordSize)),te(Ee,"WORD_MASK",(1n<<Ee.WORD_SIZE_BIGINT)-1n),te(Ee,"MAX_SAFE_INTEGER_BIGINT",BigInt(Number.MAX_SAFE_INTEGER)),te(Ee,"MIN_SAFE_INTEGER_BIGINT",BigInt(Number.MIN_SAFE_INTEGER)),te(Ee,"MAX_IMULN_ARG",67108863),te(Ee,"MAX_NUMBER_CONSTRUCTOR_MAG_BIGINT",(1n<<53n)-1n),Ee),GC=class{constructor(e,n){te(this,"name");te(this,"p");te(this,"k");te(this,"n");te(this,"tmp");this.name=e,this.p=new ie(n,16),this.n=this.p.bitLength(),this.k=new ie(BigInt(1)).iushln(this.n).isub(this.p),this.tmp=this._tmp()}_tmp(){const e=new ie(BigInt(0)),n=Math.ceil(this.n/ie.wordSize);return e.expand(Math.max(1,n)),e}ireduce(e){const n=e;let r;do this.split(n,this.tmp),this.imulK(n),n.iadd(this.tmp),r=n.bitLength();while(r>this.n);const t=r<this.n?-1:n.ucmp(this.p);return t===0?n.words=[0]:t>0&&n.isub(this.p),n.strip(),n}split(e,n){e.iushrn(this.n,0,n)}imulK(e){return e.imul(this.k)}},XC=class extends GC{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}split(e,n){const t=e.words,s=e.length,a=Math.min(s,9),c=new Array(a+(s>9?1:0)).fill(0);for(let y=0;y<a;y++)c[y]=t[y];let u=a;if(s<=9){const y=new Array(u);for(let b=0;b<u;++b)y[b]=c[b];n.words=y,e.words=[0];return}let l=t[9];c[u++]=l&4194303;const h=new Array(u);for(let y=0;y<u;++y)h[y]=c[y];n.words=h;const f=new Array(Math.max(1,s-9)).fill(0);let m=0;for(let y=10;y<s;y++){const b=t[y]|0;m<f.length&&(f[m++]=(b&4194303)<<4|l>>>22),l=b}l>>>=22,m<f.length?f[m++]=l:l!==0&&f.length>0;const d=new Array(m);for(let y=0;y<m;++y)d[y]=f[y];e.words=d}imulK(e){const n=e.words,r=e.length,t=r+2,s=new Array(t).fill(0);for(let c=0;c<r;c++)s[c]=n[c];let a=0;for(let c=0;c<t;c++){const u=s[c]|0;a+=u*977,s[c]=a&67108863,a=u*64+(a/67108864|0)}return e.words=s,e}},e0=class{constructor(e){te(this,"prime");te(this,"m");if(e==="k256"){const n=new XC;this.m=n.p,this.prime=n}else this.assert(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}assert(e,n="Assertion failed"){if(!e)throw new Error(n)}verify1(e){this.assert(e.negative===0,"red works only with positives"),this.assert(e.red,"red works only with red numbers")}verify2(e,n){this.assert((e.negative|n.negative)===0,"red works only with positives"),this.assert(e.red!=null&&e.red===n.red,"red works only with red numbers")}imod(e){return this.prime!=null?this.prime.ireduce(e).forceRed(this):(ie.move(e,e.umod(this.m).forceRed(this)),e)}neg(e){return e.isZero()?e.clone():this.m.sub(e).forceRed(this)}add(e,n){this.verify2(e,n);const r=e.add(n);return r.cmp(this.m)>=0&&r.isub(this.m),r.forceRed(this)}iadd(e,n){this.verify2(e,n);const r=e.iadd(n);return r.cmp(this.m)>=0&&r.isub(this.m),r}sub(e,n){this.verify2(e,n);const r=e.sub(n);return r.cmpn(0)<0&&r.iadd(this.m),r.forceRed(this)}isub(e,n){this.verify2(e,n);const r=e.isub(n);return r.cmpn(0)<0&&r.iadd(this.m),r}shl(e,n){return this.verify1(e),this.imod(e.ushln(n))}imul(e,n){return this.verify2(e,n),this.imod(e.imul(n))}mul(e,n){return this.verify2(e,n),this.imod(e.mul(n))}isqr(e){return this.imul(e,e.clone())}sqr(e){return this.mul(e,e)}sqrt(e){if(e.isZero())return e.clone();const n=this.m.andln(3);if(this.assert(n%2===1),n===3){const y=this.m.add(new ie(1)).iushrn(2);return this.pow(e,y)}const r=this.m.subn(1);let t=0;for(;!r.isZero()&&r.andln(1)===0;)t++,r.iushrn(1);this.assert(!r.isZero());const s=new ie(1).toRed(this),a=s.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength(),l=new ie(2*u*u).toRed(this);for(;this.pow(l,c).cmp(a)!==0;)l.redIAdd(a);let h=this.pow(l,r),f=this.pow(e,r.addn(1).iushrn(1)),m=this.pow(e,r),d=t;for(;m.cmp(s)!==0;){let y=m,b=0;for(;y.cmp(s)!==0;b++)y=y.redSqr();this.assert(b<d);const g=this.pow(h,new ie(1).iushln(d-b-1));f=f.redMul(g),h=g.redSqr(),m=m.redMul(h),d=b}return f}invm(e){const n=e._invmp(this.m);return n.negative!==0?(n.negative=0,this.imod(n).redNeg()):this.imod(n)}pow(e,n){if(n.isZero())return new ie(1).toRed(this);if(n.cmpn(1)===0)return e.clone();const r=4,t=new Array(1<<r);t[0]=new ie(1).toRed(this),t[1]=e;let s=2;for(;s<t.length;s++)t[s]=this.mul(t[s-1],e);let a=t[0],c=0,u=0,l=n.bitLength()%26;for(l===0&&(l=26),s=n.length-1;s>=0;s--){const h=n.words[s];for(let f=l-1;f>=0;f--){const m=h>>f&1;if(a!==t[0]&&(a=this.sqr(a)),m===0&&c===0){u=0;continue}c<<=1,c|=m,u++,!(u!==r&&(s!==0||f!==0))&&(a=this.mul(a,t[c]),u=0,c=0)}l=26}return a}convertTo(e){const n=e.umod(this.m);return n===e?n.clone():n}convertFrom(e){const n=e.clone();return n.red=null,n}},YC=class extends e0{constructor(n){super(n);te(this,"shift");te(this,"r");te(this,"r2");te(this,"rinv");te(this,"minv");this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new ie(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}convertTo(n){return this.imod(n.ushln(this.shift))}convertFrom(n){const r=this.imod(n.mul(this.rinv));return r.red=null,r}imul(n,r){if(n.isZero()||r.isZero())return n.words[0]=0,n.length=1,n;const t=n.imul(r),s=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=t.isub(s).iushrn(this.shift);let c=a;return a.cmp(this.m)>=0?c=a.isub(this.m):a.cmpn(0)<0&&(c=a.iadd(this.m)),c.forceRed(this)}mul(n,r){if(n.isZero()||r.isZero())return new ie(0).forceRed(this);const t=n.mul(r),s=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=t.isub(s).iushrn(this.shift);let c=a;return a.cmp(this.m)>=0?c=a.isub(this.m):a.cmpn(0)<0&&(c=a.iadd(this.m)),c.forceRed(this)}invm(n){return this.imod(n._invmp(this.m).mul(this.r2)).forceRed(this)}},J4=class{constructor(e){te(this,"curve");te(this,"type");te(this,"precomputed");this.curve=new Yn,this.type=e,this.precomputed=null}},Tl=class bo extends J4{constructor(n,r,t){super("jacobian");te(this,"x");te(this,"y");te(this,"z");te(this,"zOne");n===null&&r===null&&t===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ie(0)):(ie.isBN(n)||(n=new ie(n,16)),this.x=n,ie.isBN(r)||(r=new ie(r,16)),this.y=r,ie.isBN(t)||(t=new ie(t,16)),this.z=t),this.x.red==null&&(this.x=this.x.toRed(this.curve.red)),this.y.red==null&&(this.y=this.y.toRed(this.curve.red)),this.z.red==null&&(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}toP(){if(this.isInfinity())return new ka(null,null);const n=this.z.redInvm(),r=n.redSqr(),t=this.x.redMul(r),s=this.y.redMul(r).redMul(n);return new ka(t,s)}neg(){return new bo(this.x,this.y.redNeg(),this.z)}add(n){if(this.isInfinity())return n;if(n.isInfinity())return this;const r=n.z.redSqr(),t=this.z.redSqr(),s=this.x.redMul(r),a=n.x.redMul(t),c=this.y.redMul(r.redMul(n.z)),u=n.y.redMul(t.redMul(this.z)),l=s.redSub(a),h=c.redSub(u);if(l.cmpn(0)===0)return h.cmpn(0)!==0?new bo(null,null,null):this.dbl();const f=l.redSqr(),m=f.redMul(l),d=s.redMul(f),y=h.redSqr().redIAdd(m).redISub(d).redISub(d),b=h.redMul(d.redISub(y)).redISub(c.redMul(m)),g=this.z.redMul(n.z).redMul(l);return new bo(y,b,g)}mixedAdd(n){if(this.isInfinity())return n.toJ();if(n.isInfinity())return this;if(n.x===null||n.y===null)throw new Error("Point coordinates cannot be null");const r=this.z.redSqr(),t=this.x,s=n.x.redMul(r),a=this.y,c=n.y.redMul(r).redMul(this.z),u=t.redSub(s),l=a.redSub(c);if(u.cmpn(0)===0)return l.cmpn(0)!==0?new bo(null,null,null):this.dbl();const h=u.redSqr(),f=h.redMul(u),m=t.redMul(h),d=l.redSqr().redIAdd(f).redISub(m).redISub(m),y=l.redMul(m.redISub(d)).redISub(a.redMul(f)),b=this.z.redMul(u);return new bo(d,y,b)}dblp(n){if(n===0)return this;if(this.isInfinity())return this;if(typeof n>"u")return this.dbl();let r=this;for(let t=0;t<n;t++)r=r.dbl();return r}dbl(){if(this.isInfinity())return this;let n,r,t;if(this.zOne){const s=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr();let u=this.x.redAdd(a).redSqr().redISub(s).redISub(c);u=u.redIAdd(u);const l=s.redAdd(s).redIAdd(s),h=l.redSqr().redISub(u).redISub(u);let f=c.redIAdd(c);f=f.redIAdd(f),f=f.redIAdd(f),n=h,r=l.redMul(u.redISub(h)).redISub(f),t=this.y.redAdd(this.y)}else{const s=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr();let u=this.x.redAdd(a).redSqr().redISub(s).redISub(c);u=u.redIAdd(u);const l=s.redAdd(s).redIAdd(s),h=l.redSqr();let f=c.redIAdd(c);f=f.redIAdd(f),f=f.redIAdd(f),n=h.redISub(u).redISub(u),r=l.redMul(u.redISub(n)).redISub(f),t=this.y.redMul(this.z),t=t.redIAdd(t)}return new bo(n,r,t)}eq(n){if(n.type==="affine")return this.eq(n.toJ());if(this===n)return!0;const r=this.z.redSqr();n=n;const t=n.z.redSqr();if(this.x.redMul(t).redISub(n.x.redMul(r)).cmpn(0)!==0)return!1;const s=r.redMul(this.z),a=t.redMul(n.z);return this.y.redMul(a).redISub(n.y.redMul(s)).cmpn(0)===0}eqXToP(n){var c;const r=this.z.redSqr(),t=n.toRed((c=this.curve)==null?void 0:c.red).redMul(r);if(this.x.cmp(t)===0)return!0;const s=n.clone();if(this.curve===null||this.curve.redN==null)throw new Error("Curve or redN is not initialized.");const a=this.curve.redN.redMul(r);for(;s.cmp(this.curve.p)<0;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(a),this.x.cmp(t)===0)return!0}return!1}inspect(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"}isInfinity(){return this.z.cmpn(0)===0}};const hf=(i,e="Hash assertion failed")=>{if(!i)throw new Error(e)};class gw{constructor(e,n,r,t){te(this,"pending");te(this,"pendingTotal");te(this,"blockSize");te(this,"outSize");te(this,"endian");te(this,"_delta8");te(this,"_delta32");te(this,"padLength");te(this,"hmacStrength");this.pending=null,this.pendingTotal=0,this.blockSize=e,this.outSize=n,this.hmacStrength=r,this.padLength=t/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}_update(e,n){throw new Error("Not implemented")}_digest(){throw new Error("Not implemented")}_digestHex(){throw new Error("Not implemented")}update(e,n){if(e=e6(e,n),this.pending==null?this.pending=e:this.pending=this.pending.concat(e),this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;const r=e.length%this._delta8;this.pending=e.slice(e.length-r,e.length),this.pending.length===0&&(this.pending=null),e=eM(e,0,e.length-r,this.endian);for(let t=0;t<e.length;t+=this._delta32)this._update(e,t)}return this}digest(){return this.update(this._pad()),hf(this.pending===null),this._digest()}digestHex(){return this.update(this._pad()),hf(this.pending===null),this._digestHex()}_pad(){let e=this.pendingTotal;const n=this._delta8,r=n-(e+this.padLength)%n,t=new Array(r+this.padLength);t[0]=128;let s;for(s=1;s<r;s++)t[s]=0;e<<=3;let a;if(this.endian==="big"){for(a=8;a<this.padLength;a++)t[s++]=0;t[s++]=0,t[s++]=0,t[s++]=0,t[s++]=0,t[s++]=e>>>24&255,t[s++]=e>>>16&255,t[s++]=e>>>8&255,t[s++]=e&255}else for(t[s++]=e&255,t[s++]=e>>>8&255,t[s++]=e>>>16&255,t[s++]=e>>>24&255,t[s++]=0,t[s++]=0,t[s++]=0,t[s++]=0,a=8;a<this.padLength;a++)t[s++]=0;return t}}function QC(i,e){return(i.charCodeAt(e)&64512)!==55296||e<0||e+1>=i.length?!1:(i.charCodeAt(e+1)&64512)===56320}function e6(i,e){if(Array.isArray(i))return i.slice();if(!i)return[];const n=[];if(typeof i=="string")if(e!=="hex"){let r=0;for(let t=0;t<i.length;t++){let s=i.charCodeAt(t);s<128?n[r++]=s:s<2048?(n[r++]=s>>6|192,n[r++]=s&63|128):QC(i,t)?(s=65536+((s&1023)<<10)+(i.charCodeAt(++t)&1023),n[r++]=s>>18|240,n[r++]=s>>12&63|128,n[r++]=s>>6&63|128,n[r++]=s&63|128):(n[r++]=s>>12|224,n[r++]=s>>6&63|128,n[r++]=s&63|128)}}else{i=i.replace(/[^a-z0-9]+/gi,""),i.length%2!==0&&(i="0"+i);for(let r=0;r<i.length;r+=2)n.push(parseInt(i[r]+i[r+1],16))}else{i=i;for(let r=0;r<i.length;r++)n[r]=i[r]|0}return n}function ZC(i){return(i>>>24|i>>>8&65280|i<<8&16711680|(i&255)<<24)>>>0}function bw(i,e){let n="";for(let r=0;r<i.length;r++){let t=i[r];e==="little"&&(t=ZC(t)),n+=JC(t.toString(16))}return n}function JC(i){return i.length===7?"0"+i:i.length===6?"00"+i:i.length===5?"000"+i:i.length===4?"0000"+i:i.length===3?"00000"+i:i.length===2?"000000"+i:i.length===1?"0000000"+i:i}function eM(i,e,n,r){const t=n-e;hf(t%4===0);const s=new Array(t/4);for(let a=0,c=e;a<s.length;a++,c+=4){let u;r==="big"?u=i[c]<<24|i[c+1]<<16|i[c+2]<<8|i[c+3]:u=i[c+3]<<24|i[c+2]<<16|i[c+1]<<8|i[c],s[a]=u>>>0}return s}function mw(i,e){const n=new Array(i.length*4);for(let r=0,t=0;r<i.length;r++,t+=4){const s=i[r];e==="big"?(n[t]=s>>>24,n[t+1]=s>>>16&255,n[t+2]=s>>>8&255,n[t+3]=s&255):(n[t+3]=s>>>24,n[t+2]=s>>>16&255,n[t+1]=s>>>8&255,n[t]=s&255)}return n}function Dr(i,e){return i>>>e|i<<32-e}function Io(i,e){return i<<e|i>>>32-e}function kn(i,e){return i+e>>>0}function kl(i,e,n){return i+e+n>>>0}function vm(i,e,n,r){return i+e+n+r>>>0}function t6(i,e,n,r,t){return i+e+n+r+t>>>0}function tM(i,e,n,r){if(i===0)return n6(e,n,r);if(i===1||i===3)return nM(e,n,r);if(i===2)return i6(e,n,r)}function n6(i,e,n){return i&e^~i&n}function i6(i,e,n){return i&e^i&n^e&n}function nM(i,e,n){return i^e^n}function iM(i){return Dr(i,2)^Dr(i,13)^Dr(i,22)}function rM(i){return Dr(i,6)^Dr(i,11)^Dr(i,25)}function aM(i){return Dr(i,7)^Dr(i,18)^i>>>3}function sM(i){return Dr(i,17)^Dr(i,19)^i>>>10}const oM=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],cM=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],uM=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],lM=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function A2(i,e,n,r){return i<=15?e^n^r:i<=31?e&n|~e&r:i<=47?(e|~n)^r:i<=63?e&r|n&~r:e^(n|~r)}function dM(i){return i<=15?0:i<=31?1518500249:i<=47?1859775393:i<=63?2400959708:2840853838}function fM(i){return i<=15?1352829926:i<=31?1548603684:i<=47?1836072691:i<=63?2053994217:0}class r6 extends gw{constructor(){super(512,160,192,64);te(this,"h");this.endian="little",this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}_update(n,r){let t=this.h[0],s=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],l=t,h=s,f=a,m=c,d=u,y;for(let b=0;b<80;b++)y=kn(Io(vm(t,A2(b,s,a,c),n[oM[b]+r],dM(b)),uM[b]),u),t=u,u=c,c=Io(a,10),a=s,s=y,y=kn(Io(vm(l,A2(79-b,h,f,m),n[cM[b]+r],fM(b)),lM[b]),d),l=d,d=m,m=Io(f,10),f=h,h=y;y=kl(this.h[1],a,m),this.h[1]=kl(this.h[2],c,d),this.h[2]=kl(this.h[3],u,l),this.h[3]=kl(this.h[4],t,h),this.h[4]=kl(this.h[0],s,f),this.h[0]=y}_digest(){return mw(this.h,"little")}_digestHex(){return bw(this.h,"little")}}class Eo extends gw{constructor(){super(512,256,192,64);te(this,"h");te(this,"W");te(this,"k");this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],this.W=new Array(64)}_update(n,r){const t=this.W;r===void 0&&(r=0);let s;for(s=0;s<16;s++)t[s]=n[r+s];for(;s<t.length;s++)t[s]=vm(sM(t[s-2]),t[s-7],aM(t[s-15]),t[s-16]);let a=this.h[0],c=this.h[1],u=this.h[2],l=this.h[3],h=this.h[4],f=this.h[5],m=this.h[6],d=this.h[7];for(hf(this.k.length===t.length),s=0;s<t.length;s++){const y=t6(d,rM(h),n6(h,f,m),this.k[s],t[s]),b=kn(iM(a),i6(a,c,u));d=m,m=f,f=h,h=kn(l,y),l=u,u=c,c=a,a=kn(y,b)}this.h[0]=kn(this.h[0],a),this.h[1]=kn(this.h[1],c),this.h[2]=kn(this.h[2],u),this.h[3]=kn(this.h[3],l),this.h[4]=kn(this.h[4],h),this.h[5]=kn(this.h[5],f),this.h[6]=kn(this.h[6],m),this.h[7]=kn(this.h[7],d)}_digest(){return mw(this.h,"big")}_digestHex(){return bw(this.h,"big")}}class hM extends gw{constructor(){super(512,160,80,64);te(this,"h");te(this,"W");te(this,"k");this.k=[1518500249,1859775393,2400959708,3395469782],this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}_update(n,r){const t=this.W;r===void 0&&(r=0);let s;for(s=0;s<16;s++)t[s]=n[r+s];for(;s<t.length;s++)t[s]=Io(t[s-3]^t[s-8]^t[s-14]^t[s-16],1);let a=this.h[0],c=this.h[1],u=this.h[2],l=this.h[3],h=this.h[4];for(s=0;s<t.length;s++){const f=~~(s/20),m=t6(Io(a,5),tM(f,c,u,l),h,t[s],this.k[f]);h=l,l=u,u=Io(c,30),c=a,a=m}this.h[0]=kn(this.h[0],a),this.h[1]=kn(this.h[1],c),this.h[2]=kn(this.h[2],u),this.h[3]=kn(this.h[3],l),this.h[4]=kn(this.h[4],h)}_digest(){return mw(this.h,"big")}_digestHex(){return bw(this.h,"big")}}class a6{constructor(e){te(this,"inner");te(this,"outer");te(this,"blockSize",64);te(this,"outSize",32);e=e6(e,"hex"),e.length>this.blockSize&&(e=new Eo().update(e).digest()),hf(e.length<=this.blockSize);let n;for(n=e.length;n<this.blockSize;n++)e.push(0);for(n=0;n<e.length;n++)e[n]^=54;for(this.inner=new Eo().update(e),n=0;n<e.length;n++)e[n]^=106;this.outer=new Eo().update(e)}update(e,n){return this.inner.update(e,n),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}const pM=(i,e)=>new r6().update(i,e).digest(),yM=(i,e)=>new hM().update(i,e).digest(),Wi=(i,e)=>new Eo().update(i,e).digest(),ji=(i,e)=>{const n=new Eo().update(i,e).digest();return new Eo().update(n).digest()},s6=(i,e)=>{const n=new Eo().update(i,e).digest();return new r6().update(n).digest()},pf=(i,e,n)=>new a6(i).update(e,n).digest(),gM=i=>i.length%2===1?"0"+i:i,Ue=i=>{let e="";for(const n of i)e+=gM(n.toString(16));return e},_e=(i,e)=>{if(Array.isArray(i))return i.slice();if(i===void 0)return[];if(typeof i!="string")return Array.from(i,n=>n|0);switch(e){case"hex":return bM(i);case"base64":return mM(i);default:return wM(i)}},bM=i=>{i=i.replace(/[^a-z0-9]+/gi,""),i.length%2!==0&&(i="0"+i);const e=[];for(let n=0;n<i.length;n+=2)e.push(parseInt(i[n]+i[n+1],16));return e},mM=i=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[];let r=0,t=0;for(const s of i.replace(/=+$/,""))r=r<<6|e.indexOf(s),t+=6,t>=8&&(t-=8,n.push(r>>t&255),r&=(1<<t)-1);return n};function wM(i){const e=[];for(let n=0;n<i.length;n++){const r=i.codePointAt(n);if(r===void 0)throw new Error(`Index out of range: ${n}`);let t=r;t>65535?n++:t>=55296&&t<=57343&&(t=65533),t<=127?e.push(t):t<=2047?e.push(192|t>>6,128|t&63):t<=65535?e.push(224|t>>12,128|t>>6&63,128|t&63):e.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|t&63)}return e}const Mt=i=>{let e="",n=0;for(let r=0;r<i.length;r++){const t=i[r];if(n>0){n--;continue}if(t<=127)e+=String.fromCharCode(t);else if(t>=192&&t<=223){const s=i[r+1];n=1;const a=(t&31)<<6|s&63;e+=String.fromCharCode(a)}else if(t>=224&&t<=239){const s=i[r+1],a=i[r+2];n=2;const c=(t&15)<<12|(s&63)<<6|a&63;e+=String.fromCharCode(c)}else if(t>=240&&t<=247){const s=i[r+1],a=i[r+2],c=i[r+3];n=3;const u=(t&7)<<18|(s&63)<<12|(a&63)<<6|c&63,l=55296+(u-65536>>10),h=56320+(u-65536&1023);e+=String.fromCharCode(l,h)}}return e},t0=(i,e)=>{switch(e){case"hex":return Ue(i);case"utf8":return Mt(i);default:return i}};function Pa(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let n="",r;for(r=0;r<i.length;r+=3){const t=i[r],s=r+1<i.length?i[r+1]:0,a=r+2<i.length?i[r+2]:0,c=t>>2,u=(t&3)<<4|s>>4,l=(s&15)<<2|a>>6,h=a&63;n+=e.charAt(c)+e.charAt(u),n+=r+1<i.length?e.charAt(l):"=",n+=r+2<i.length?e.charAt(h):"="}return n}const zd="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",xm=i=>{if(i===""||typeof i!="string")throw new Error(`Expected base58 string but got “${i}”`);const e=i.match(/[IOl0]/gmu);if(e!==null)throw new Error(`Invalid base58 character “${e.join("")}”`);const n=i.match(/^1+/gmu),r=n!==null?n[0].length:0,t=(i.length-r)*(Math.log(58)/Math.log(256))+1>>>0;return[...new Uint8Array([...new Uint8Array(r),...(i.match(/./gmu)??[]).map(a=>zd.indexOf(a)).reduce((a,c)=>(a=a.map(u=>{const l=u*58+c;return c=l>>8,l}),a),new Uint8Array(t)).reverse().filter((a=>c=>a=a||c)(!1))])]},_m=i=>{const e=Array(256).fill(-1);for(let r=0;r<zd.length;++r)e[zd.charCodeAt(r)]=r;const n=[];for(const r of i){let t=r;for(let s=0;s<n.length;++s){const a=(e[n[s]]<<8)+t;n[s]=zd.charCodeAt(a%58),t=a/58|0}for(;t!==0;)n.push(zd.charCodeAt(t%58)),t=t/58|0}for(const r of i){if(r!==0)break;n.push(49)}return n.reverse(),String.fromCharCode(...n)},o6=(i,e=[0])=>{let n=ji([...e,...i]);return n=[...e,...i,...n.slice(0,4)],_m(n)},c6=(i,e,n=1)=>{const r=xm(i);let t=r.slice(0,n),s=r.slice(n,-4),a=[...t,...s];return a=ji(a),r.slice(-4).forEach((c,u)=>{if(c!==a[u])throw new Error("Invalid checksum")}),{prefix:t,data:s}};class Ge{constructor(e){te(this,"bufs");te(this,"length");this.bufs=e!==void 0?e:[],this.length=0;for(const n of this.bufs)this.length+=n.length}getLength(){return this.length}toArray(){const e=this.length,n=new Array(e);let r=0;for(const t of this.bufs)for(const s of t)n[r++]=s;return n}write(e){return this.bufs.push(e),this.length+=e.length,this}writeReverse(e){const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[e.length-1-r];return this.bufs.push(n),this.length+=n.length,this}writeUInt8(e){const n=new Array(1);return n[0]=e,this.write(n),this}writeInt8(e){const n=new Array(1);return n[0]=e&255,this.write(n),this}writeUInt16BE(e){const n=[e>>8&255,e&255];return this.bufs.push(n),this.length+=2,this}writeInt16BE(e){return this.writeUInt16BE(e&65535)}writeUInt16LE(e){const n=[e&255,e>>8&255];return this.bufs.push(n),this.length+=2,this}writeInt16LE(e){return this.writeUInt16LE(e&65535)}writeUInt32BE(e){const n=[e>>24&255,e>>16&255,e>>8&255,e&255];return this.bufs.push(n),this.length+=4,this}writeInt32BE(e){return this.writeUInt32BE(e>>>0)}writeUInt32LE(e){const n=[e&255,e>>8&255,e>>16&255,e>>24&255];return this.bufs.push(n),this.length+=4,this}writeInt32LE(e){return this.writeUInt32LE(e>>>0)}writeUInt64BEBn(e){const n=e.toArray("be",8);return this.write(n),this}writeUInt64LEBn(e){const n=e.toArray("be",8);return this.writeReverse(n),this}writeUInt64LE(e){const n=new ie(e).toArray("be",8);return this.writeReverse(n),this}writeVarIntNum(e){const n=Ge.varIntNum(e);return this.write(n),this}writeVarIntBn(e){const n=Ge.varIntBn(e);return this.write(n),this}static varIntNum(e){let n;if(e<0)return this.varIntBn(new ie(e));if(e<253)n=[e];else if(e<65536)n=[253,e&255,e>>8&255];else if(e<4294967296)n=[254,e&255,e>>8&255,e>>16&255,e>>24&255];else{const r=e&4294967295,t=Math.floor(e/4294967296)&4294967295;n=[255,r&255,r>>8&255,r>>16&255,r>>24&255,t&255,t>>8&255,t>>16&255,t>>24&255]}return n}static varIntBn(e){let n;if(e.isNeg()&&(e=e.add(u6)),e.ltn(253))n=[e.toNumber()];else if(e.ltn(65536)){const r=e.toNumber();n=[253,r&255,r>>8&255]}else if(e.lt(new ie(4294967296))){const r=e.toNumber();n=[254,r&255,r>>8&255,r>>16&255,r>>24&255]}else{const r=new Ge;r.writeUInt8(255),r.writeUInt64LEBn(e),n=r.toArray()}return n}}class un{constructor(e=[],n=0){te(this,"bin");te(this,"pos");te(this,"length");this.bin=e,this.pos=n,this.length=e.length}eof(){return this.pos>=this.length}read(e=this.length){const n=this.pos,r=this.pos+e;return this.pos=r,this.bin.slice(n,r)}readReverse(e=this.length){const n=new Array(e);for(let r=0;r<e;r++)n[r]=this.bin[this.pos+e-1-r];return this.pos+=e,n}readUInt8(){const e=this.bin[this.pos];return this.pos+=1,e}readInt8(){const e=this.bin[this.pos];return this.pos+=1,(e&128)!==0?e-256:e}readUInt16BE(){const e=this.bin[this.pos]<<8|this.bin[this.pos+1];return this.pos+=2,e}readInt16BE(){const e=this.readUInt16BE();return(e&32768)!==0?e-65536:e}readUInt16LE(){const e=this.bin[this.pos]|this.bin[this.pos+1]<<8;return this.pos+=2,e}readInt16LE(){const e=this.readUInt16LE();return(e&32768)!==0?e-65536:e}readUInt32BE(){const e=this.bin[this.pos]*16777216+(this.bin[this.pos+1]<<16|this.bin[this.pos+2]<<8|this.bin[this.pos+3]);return this.pos+=4,e}readInt32BE(){const e=this.readUInt32BE();return(e&2147483648)!==0?e-4294967296:e}readUInt32LE(){const e=(this.bin[this.pos]|this.bin[this.pos+1]<<8|this.bin[this.pos+2]<<16|this.bin[this.pos+3]<<24)>>>0;return this.pos+=4,e}readInt32LE(){const e=this.readUInt32LE();return(e&2147483648)!==0?e-4294967296:e}readUInt64BEBn(){const e=this.bin.slice(this.pos,this.pos+8),n=new ie(e);return this.pos=this.pos+8,n}readUInt64LEBn(){const e=this.readReverse(8);return new ie(e)}readInt64LEBn(){const e=this.readReverse(8);let n=new ie(e);return n.gte(vM)&&(n=n.sub(u6)),n}readVarIntNum(e=!0){const n=this.readUInt8();let r;switch(n){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:if(r=e?this.readInt64LEBn():this.readUInt64LEBn(),r.lte(new ie(2).pow(new ie(53))))return r.toNumber();throw new Error("number too large to retain precision - use readVarIntBn");default:return n}}readVarInt(){switch(this.bin[this.pos]){case 253:return this.read(3);case 254:return this.read(5);case 255:return this.read(9);default:return this.read(1)}}readVarIntBn(){const e=this.readUInt8();switch(e){case 253:return new ie(this.readUInt16LE());case 254:return new ie(this.readUInt32LE());case 255:return this.readUInt64LEBn();default:return new ie(e)}}}const P2=i=>{if(i.length===0)return i;const e=i[i.length-1];if((e&127)!==0)return i;if(i.length===1)return[];if((i[i.length-2]&128)!==0)return i;for(let n=i.length-1;n>0;n--)if(i[n-1]!==0)return(i[n-1]&128)!==0?(i[n]=e,i.slice(0,n+1)):(i[n-1]|=e,i.slice(0,n));return[]},vM=new ie(2).pow(new ie(63)),u6=new ie(2).pow(new ie(64));var It;let ka=(It=class extends J4{constructor(n,r,t=!0){super("affine");te(this,"x");te(this,"y");te(this,"inf");this.precomputed=null,n===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(ie.isBN(n)||(n=new ie(n,16)),this.x=n,ie.isBN(r)||(r=new ie(r,16)),this.y=r,t&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red===null&&(this.x=this.x.toRed(this.curve.red)),this.y.red===null&&(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}static fromDER(n){if((n[0]===4||n[0]===6||n[0]===7)&&n.length-1===2*32){if(n[0]===6){if(n[n.length-1]%2!==0)throw new Error("Point string value is wrong length")}else if(n[0]===7&&n[n.length-1]%2!==1)throw new Error("Point string value is wrong length");return new It(n.slice(1,33),n.slice(33,1+2*32))}else if((n[0]===2||n[0]===3)&&n.length-1===32)return It.fromX(n.slice(1,33),n[0]===3);throw new Error("Unknown point format")}static fromString(n){const r=_e(n,"hex");return It.fromDER(r)}static redSqrtOptimized(n){const s=It.red.m.addn(1).iushrn(2);return n.redPow(s)}static fromX(n,r){if(typeof BigInt=="function"){let c=function(_,S){return(_%S+S)%S},u=function(_,S,I){let A=BigInt(1);for(_=c(_,I);S>BigInt(0);)(S&BigInt(1))===BigInt(1)&&(A=c(A*_,I)),S>>=BigInt(1),_=c(_*_,I);return A},l=function(_,S){const I=S+BigInt(1)>>BigInt(2),A=u(_,I,S);return c(A*A,S)===c(_,S)?A:null};var t=c,s=u,a=l;const h=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),f=BigInt(7);let m;if(n instanceof ie)m=BigInt("0x"+n.toString(16));else if(typeof n=="string")m=BigInt("0x"+n);else if(Array.isArray(n))m=BigInt("0x"+Ue(n).padStart(64,"0"));else if(typeof n=="number")m=BigInt(n);else throw new Error("Invalid x-coordinate type");m=c(m,h);const d=c(u(m,BigInt(3),h)+f,h);let y=l(d,h);if(y===null)throw new Error("Invalid point");const b=y%BigInt(2)===BigInt(1);(r&&!b||!r&&b)&&(y=h-y);const g=new ie(m.toString(16),16),v=new ie(y.toString(16),16);return new It(g,v)}else{const c=new e0("k256"),u=new ie(0).toRed(c),l=new ie(7).toRed(c),h=new ie(0).toRed(c);ie.isBN(n)||(n=new ie(n,16)),n=n,n.red==null&&(n=n.toRed(c));const f=n.redSqr().redMul(n).redIAdd(n.redMul(u)).redIAdd(l);let m=f.redSqrt();if(m.redSqr().redSub(f).cmp(h)!==0)throw new Error("invalid point");const d=m.fromRed().isOdd();return(r&&!d||!r&&d)&&(m=m.redNeg()),new It(n,m)}}static fromJSON(n,r){typeof n=="string"&&(n=JSON.parse(n));const t=new It(n[0],n[1],r);if(typeof n[2]!="object")return t;const s=c=>new It(c[0],c[1],r),a=n[2];return t.precomputed={beta:null,doubles:typeof a.doubles=="object"&&a.doubles!==null?{step:a.doubles.step,points:[t].concat(a.doubles.points.map(s))}:void 0,naf:typeof a.naf=="object"&&a.naf!==null?{wnd:a.naf.wnd,points:[t].concat(a.naf.points.map(s))}:void 0},t}validate(){return this.curve.validate(this)}encode(n=!0,r){const t=this.curve.p.byteLength(),s=this.getX().toArray("be",t);let a;return n?a=[this.getY().isEven()?2:3].concat(s):a=[4].concat(s,this.getY().toArray("be",t)),r!=="hex"?a:Ue(a)}toString(){return this.encode(!0,"hex")}toJSON(){return this.precomputed==null?[this.x,this.y]:[this.x,this.y,typeof this.precomputed=="object"&&this.precomputed!==null?{doubles:this.precomputed.doubles!=null?{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)}:void 0,naf:this.precomputed.naf!=null?{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}:void 0}:void 0]}inspect(){var n,r,t,s;return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+(((r=(n=this.x)==null?void 0:n.fromRed())==null?void 0:r.toString(16,2))??"undefined")+" y: "+(((s=(t=this.y)==null?void 0:t.fromRed())==null?void 0:s.toString(16,2))??"undefined")+">"}isInfinity(){return this.inf}add(n){var a,c,u;if(this.inf)return n;if(n.inf)return this;if(this.eq(n))return this.dbl();if(this.neg().eq(n))return new It(new ie(0),new ie(0));if(((a=this.x)==null?void 0:a.cmp(n.x??new ie(0)))===0)return new It(new ie(0),new ie(0));let r=((c=this.y)==null?void 0:c.redSub(n.y??new ie(0)))??new ie(0);r.cmpn(0)!==0&&(r=r.redMul(((u=this.x)==null?void 0:u.redSub(n.x??new ie(0)).redInvm())??new ie(1)));const t=r==null?void 0:r.redSqr().redISub(this.x??new ie(0)).redISub(n.x??new ie(0)),s=(r??new ie(1)).redMul((this.x??new ie(0)).redSub(t??new ie(0))).redISub(this.y??new ie(0));return new It(t??new ie(0),s??new ie(0))}dbl(){if(this.inf)return this;const n=(this.y??new ie(0)).redAdd(this.y??new ie(0));if(n.cmpn(0)===0)return new It(new ie(0),new ie(0));const r=this.curve.a,t=(this.x??new ie(0)).redSqr(),s=n.redInvm(),a=t.redAdd(t).redIAdd(t).redIAdd(r).redMul(s),c=a.redSqr().redISub((this.x??new ie(0)).redAdd(this.x??new ie(0))),u=a.redMul((this.x??new ie(0)).redSub(c)).redISub(this.y??new ie(0));return new It(c,u)}getX(){return(this.x??new ie(0)).fromRed()}getY(){return(this.y??new ie(0)).fromRed()}mul(n){return ie.isBN(n)||(n=new ie(n,16)),n=n,this.isInfinity()?this:this._hasDoubles(n)?this._fixedNafMul(n):this._endoWnafMulAdd([this],[n])}mulAdd(n,r,t){const s=[this,r],a=[n,t];return this._endoWnafMulAdd(s,a)}jmulAdd(n,r,t){const s=[this,r],a=[n,t];return this._endoWnafMulAdd(s,a,!0)}eq(n){return this===n||this.inf===n.inf&&(this.inf||(this.x??new ie(0)).cmp(n.x??new ie(0))===0&&(this.y??new ie(0)).cmp(n.y??new ie(0))===0)}neg(n){if(this.inf)return this;const r=new It(this.x,(this.y??new ie(0)).redNeg());if(n===!0&&this.precomputed!=null){const t=this.precomputed,s=a=>a.neg();r.precomputed={naf:t.naf!=null?{wnd:t.naf.wnd,points:t.naf.points.map(s)}:void 0,doubles:t.doubles!=null?{step:t.doubles.step,points:t.doubles.points.map(a=>a.neg())}:void 0,beta:void 0}}return r}dblp(n){let r=this;for(let t=0;t<n;t++)r=r.dbl();return r}toJ(){return this.inf?new Tl(null,null,null):new Tl(this.x,this.y,this.curve.one)}_getBeta(){if(typeof this.curve.endo!="object")return;const n=this.precomputed;if(typeof n=="object"&&n!==null&&typeof n.beta=="object"&&n.beta!==null)return n.beta;const r=new It((this.x??new ie(0)).redMul(this.curve.endo.beta),this.y);if(n!=null){const t=this.curve,s=a=>{if(a.x===null)throw new Error("p.x is null");if(t.endo===void 0||t.endo===null)throw new Error("curve.endo is undefined");return new It(a.x.redMul(t.endo.beta),a.y)};n.beta=r,r.precomputed={beta:null,naf:n.naf!=null?{wnd:n.naf.wnd,points:n.naf.points.map(s)}:void 0,doubles:n.doubles!=null?{step:n.doubles.step,points:n.doubles.points.map(s)}:void 0}}return r}_fixedNafMul(n){if(typeof this.precomputed!="object"||this.precomputed===null)throw new Error("_fixedNafMul requires precomputed values for the point");const r=this._getDoubles(),t=this.curve.getNAF(n,1,this.curve._bitLength);let s=(1<<r.step+1)-(r.step%2===0?2:1);s/=3;const a=[];for(let l=0;l<t.length;l+=r.step){let h=0;for(let f=l+r.step-1;f>=l;f--)h=(h<<1)+t[f];a.push(h)}let c=new Tl(null,null,null),u=new Tl(null,null,null);for(let l=s;l>0;l--){for(let h=0;h<a.length;h++){const f=a[h];f===l?u=u.mixedAdd(r.points[h]):f===-l&&(u=u.mixedAdd(r.points[h].neg()))}c=c.add(u)}return c.toP()}_wnafMulAdd(n,r,t,s,a){const c=this.curve._wnafT1.map(d=>d.toNumber()),u=this.curve._wnafT2.map(()=>[]),l=this.curve._wnafT3.map(()=>[]);let h=0;for(let d=0;d<s;d++){const b=r[d]._getNAFPoints(n);c[d]=b.wnd,u[d]=b.points}for(let d=s-1;d>=1;d-=2){const y=d-1,b=d;if(c[y]!==1||c[b]!==1){l[y]=this.curve.getNAF(t[y],c[y],this.curve._bitLength),l[b]=this.curve.getNAF(t[b],c[b],this.curve._bitLength),h=Math.max(l[y].length,h),h=Math.max(l[b].length,h);continue}const g=[r[y],null,null,r[b]];(r[y].y??new ie(0)).cmp(r[b].y??new ie(0))===0?(g[1]=r[y].add(r[b]),g[2]=r[y].toJ().mixedAdd(r[b].neg())):(r[y].y??new ie(0)).cmp((r[b].y??new ie(0)).redNeg())===0?(g[1]=r[y].toJ().mixedAdd(r[b]),g[2]=r[y].add(r[b].neg())):(g[1]=r[y].toJ().mixedAdd(r[b]),g[2]=r[y].toJ().mixedAdd(r[b].neg()));const v=[-3,-1,-5,-7,0,7,5,1,3],_=this.curve.getJSF(t[y],t[b]);h=Math.max(_[0].length,h),l[y]=new Array(h),l[b]=new Array(h);for(let S=0;S<h;S++){const I=_[0][S]|0,A=_[1][S]|0;l[y][S]=v[(I+1)*3+(A+1)],l[b][S]=0,u[y]=g}}let f=new Tl(null,null,null);const m=this.curve._wnafT4;for(let d=h;d>=0;d--){let y=0;for(;d>=0;){let v=!0;for(let _=0;_<s;_++)m[_]=new ie(typeof l[_][d]=="number"?l[_][d]:0),m[_].isZero()||(v=!1);if(!v)break;y++,d--}if(d>=0&&y++,f=f.dblp(y),d<0)break;const b=new ie(1),g=new ie(2);for(let v=0;v<s;v++){const _=m[v];let S;_.cmpn(0)!==0&&(_.isNeg()?S=u[v][_.neg().sub(b).div(g).toNumber()].neg():S=u[v][_.sub(b).div(g).toNumber()],S.type==="affine"?f=f.mixedAdd(S):f=f.add(S))}}for(let d=0;d<s;d++)u[d]=[];return a===!0?f:f.toP()}_endoWnafMulAdd(n,r,t){const s=new Array(n.length*2),a=new Array(n.length*2);let c;for(c=0;c<n.length;c++){const l=this.curve._endoSplit(r[c]);let h=n[c],f=h._getBeta()??new It(new ie(0),new ie(0));l.k1.negative!==0&&(l.k1.ineg(),h=h.neg(!0)),l.k2.negative!==0&&(l.k2.ineg(),f=f.neg(!0)),s[c*2]=h,s[c*2+1]=f,a[c*2]=l.k1,a[c*2+1]=l.k2}const u=this._wnafMulAdd(1,s,a,c*2,t);for(let l=0;l<c*2;l++)s[l]=null,a[l]=null;return u}_hasDoubles(n){if(this.precomputed==null)return!1;const r=this.precomputed.doubles;return typeof r!="object"?!1:r.points.length>=Math.ceil((n.bitLength()+1)/r.step)}_getDoubles(n,r){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.doubles=="object"&&this.precomputed.doubles!==null)return this.precomputed.doubles;const t=[this];let s=this;for(let a=0;a<(r??0);a+=n??1){for(let c=0;c<(n??1);c++)s=s.dbl();t.push(s)}return{step:n??1,points:t}}_getNAFPoints(n){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.naf=="object"&&this.precomputed.naf!==null)return this.precomputed.naf;const r=[this],t=(1<<n)-1,s=t===1?null:this.dbl();for(let a=1;a<t;a++)s!==null&&(r[a]=r[a-1].add(s));return{wnd:n,points:r}}},te(It,"red",new e0("k256")),te(It,"a",new ie(0).toRed(It.red)),te(It,"b",new ie(7).toRed(It.red)),te(It,"zero",new ie(0).toRed(It.red)),It),yb,Yn=class l6{constructor(){te(this,"p");te(this,"red");te(this,"redN");te(this,"zero");te(this,"one");te(this,"two");te(this,"g");te(this,"n");te(this,"a");te(this,"b");te(this,"tinv");te(this,"zeroA");te(this,"threeA");te(this,"endo");te(this,"_endoWnafT1");te(this,"_endoWnafT2");te(this,"_wnafT1");te(this,"_wnafT2");te(this,"_wnafT3");te(this,"_wnafT4");te(this,"_bitLength");if(typeof yb<"u")return yb;yb=this;const n={prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",{doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}]};this.p=new ie(n.p,16),this.red=new e0(n.prime),this.zero=new ie(0).toRed(this.red),this.one=new ie(1).toRed(this.red),this.two=new ie(2).toRed(this.red),this.n=new ie(n.n,16),this.g=ka.fromJSON(n.g,n.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n.bitLength(),this.redN=this.n.toRed(this.red),this.a=new ie(n.a,16).toRed(this.red),this.b=new ie(n.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(n),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}static assert(e,n="Elliptic curve assertion failed"){if(!e)throw new Error(n)}getNAF(e,n,r){const t=new Array(Math.max(e.bitLength(),r)+1);t.fill(0);const s=1<<n+1,a=e.clone();for(let c=0;c<t.length;c++){let u;const l=a.andln(s-1);a.isOdd()?(l>(s>>1)-1?u=(s>>1)-l:u=l,a.isubn(u)):u=0,t[c]=u,a.iushrn(1)}return t}getJSF(e,n){const r=[[],[]];e=e.clone(),n=n.clone();let t=0,s=0;for(;e.cmpn(-t)>0||n.cmpn(-s)>0;){let a=e.andln(3)+t&3,c=n.andln(3)+s&3;a===3&&(a=-1),c===3&&(c=-1);let u;if((a&1)===0)u=0;else{const h=e.andln(7)+t&7;(h===3||h===5)&&c===2?u=-a:u=a}r[0].push(u);let l;if((c&1)===0)l=0;else{const h=n.andln(7)+s&7;(h===3||h===5)&&a===2?l=-c:l=c}r[1].push(l),2*t===u+1&&(t=1-t),2*s===l+1&&(s=1-s),e.iushrn(1),n.iushrn(1)}return r}static cachedProperty(e,n,r){const t="_"+n;e.prototype[n]=function(){return this[t]!==void 0?this[t]:this[t]=r.call(this)}}static parseBytes(e){return typeof e=="string"?_e(e,"hex"):e}static intFromLE(e){return new ie(e,"hex","le")}_getEndomorphism(e){var s,a;if(!this.zeroA||this.p.modrn(3)!==1)return;let n,r;if(e.beta!==void 0)n=new ie(e.beta,16).toRed(this.red);else{const c=this._getEndoRoots(this.p);if(c===null)throw new Error("Failed to get endomorphism roots for beta.");n=c[0].cmp(c[1])<0?c[0]:c[1],n=n.toRed(this.red)}if(e.lambda!==void 0)r=new ie(e.lambda,16);else{const c=this._getEndoRoots(this.n);if(c===null)throw new Error("Failed to get endomorphism roots for lambda.");if(this.g==null)throw new Error("Curve generator point (g) is not defined.");const u=(s=this.g.mul(c[0]))==null?void 0:s.x,l=this.g.x!=null?this.g.x.redMul(n):void 0;if(u!=null&&l!=null&&u.cmp(l)===0)r=c[0];else{if(r=c[1],this.g==null)throw new Error("Curve generator point (g) is not defined.");const h=(a=this.g.mul(r))==null?void 0:a.x,f=this.g.x!=null?this.g.x.redMul(n):void 0;if(h==null||f==null)throw new Error("Lambda computation failed: g.mul(lambda).x or g.x.redMul(beta) is undefined.");l6.assert(h.cmp(f)===0,"Lambda selection does not match computed beta.")}}let t;return typeof e.basis=="object"&&e.basis!==null?t=e.basis.map(function(c){return{a:new ie(c.a,16),b:new ie(c.b,16)}}):t=this._getEndoBasis(r),{beta:n,lambda:r,basis:t}}_getEndoRoots(e){const n=e===this.p?this.red:new YC(e),r=new ie(2).toRed(n).redInvm(),t=r.redNeg(),s=new ie(3).toRed(n).redNeg().redSqrt().redMul(r),a=t.redAdd(s).fromRed(),c=t.redSub(s).fromRed();return[a,c]}_getEndoBasis(e){const n=this.n.ushrn(Math.floor(this.n.bitLength()/2));let r=e,t=this.n.clone(),s=new ie(1),a=new ie(0),c=new ie(0),u=new ie(1),l,h,f,m,d,y,b=new ie(0),g=0,v=new ie(0),_=new ie(0);for(;r.cmpn(0)!==0;){const A=t.div(r);v=t.sub(A.mul(r)),_=c.sub(A.mul(s));const R=u.sub(A.mul(a));if(f===void 0&&v.cmp(n)<0)l=b.neg(),h=s,f=v.neg(),m=_;else if(f!==void 0&&++g===2)break;b=v,t=r,r=v,c=s,s=_,u=a,a=R}if(l===void 0||h===void 0||f===void 0||m===void 0)throw new Error("Failed to compute Endo Basis values");d=v.neg(),y=_;const S=f.sqr().add(m.sqr());return d.sqr().add(y.sqr()).cmp(S)>=0&&(d=l,y=h),f.negative!==0&&(f=f.neg(),m=m.neg()),d.negative!==0&&(d=d.neg(),y=y.neg()),[{a:f,b:m},{a:d,b:y}]}_endoSplit(e){if(this.endo==null)throw new Error("Endomorphism is not defined.");const n=this.endo.basis,r=n[0],t=n[1],s=t.b.mul(e).divRound(this.n),a=r.b.neg().mul(e).divRound(this.n),c=s.mul(r.a),u=a.mul(t.a),l=s.mul(r.b),h=a.mul(t.b),f=e.sub(c).sub(u),m=l.add(h).neg();return{k1:f,k2:m}}validate(e){if(e.inf)return!0;const n=e.x,r=e.y;if(n===null||r===null)throw new Error("Point coordinates cannot be null");const t=this.a.redMul(n),s=n.redSqr().redMul(n).redIAdd(t).redIAdd(this.b);return r.redSqr().redISub(s).cmpn(0)===0}},gs=class Sm{constructor(e,n){te(this,"r");te(this,"s");this.r=e,this.s=n}static fromDER(e,n){const r=(f,m)=>{const d=f[m.place++];if((d&128)===0)return d;throw new Error("Invalid DER entity length")};class t{constructor(){te(this,"place");this.place=0}}e=_e(e,n);const s=new t;if(e[s.place++]!==48)throw new Error("Signature DER must start with 0x30");if(r(e,s)+s.place!==e.length)throw new Error("Signature DER invalid");if(e[s.place++]!==2)throw new Error("Signature DER invalid");const c=r(e,s);let u=e.slice(s.place,c+s.place);if(s.place+=c,e[s.place++]!==2)throw new Error("Signature DER invalid");const l=r(e,s);if(e.length!==l+s.place)throw new Error("Invalid R-length in signature DER");let h=e.slice(s.place,l+s.place);if(u[0]===0)if((u[1]&128)!==0)u=u.slice(1);else throw new Error("Invalid R-value in signature DER");if(h[0]===0)if((h[1]&128)!==0)h=h.slice(1);else throw new Error("Invalid S-value in signature DER");return new Sm(new ie(u),new ie(h))}static fromCompact(e,n){if(e=_e(e,n),e.length!==65)throw new Error("Invalid Compact Signature");const r=e[0];if(r<27||r>=35)throw new Error("Invalid Compact Byte");return new Sm(new ie(e.slice(1,33)),new ie(e.slice(33,65)))}verify(e,n,r){const t=new ie(Wi(e,r),16);return kf(t,this,n)}toString(e){return this.toDER(e)}toDER(e){const n=(l,h)=>{if(h<128)l.push(h);else throw new Error("len must be < 0x80")},r=l=>{let h=0;const f=l.length-1;for(;l[h]===0&&(l[h+1]&128)===0&&h<f;)h++;return h===0?l:l.slice(h)};let t=this.r.toArray(),s=this.s.toArray();for((t[0]&128)!==0&&(t=[0].concat(t)),(s[0]&128)!==0&&(s=[0].concat(s)),t=r(t),s=r(s);s[0]===0&&(s[1]&128)===0;)s=s.slice(1);let a=[2];n(a,t.length),a=a.concat(t),a.push(2),n(a,s.length);const c=a.concat(s);let u=[48];return n(u,c.length),u=u.concat(c),e==="hex"?Ue(u):e==="base64"?Pa(u):u}toCompact(e,n,r){if(e<0||e>3)throw new Error("Invalid recovery param");if(typeof n!="boolean")throw new Error("Invalid compressed param");let t=27+e;n&&(t+=4);let s=[t];return s=s.concat(this.r.toArray("be",32)),s=s.concat(this.s.toArray("be",32)),r==="hex"?Ue(s):r==="base64"?Pa(s):s}RecoverPublicKey(e,n){const r=this.r,t=this.s,s=(e&1)!==0,a=e>>1,c=new Yn,u=c.n,l=c.g,h=a!==0?r.add(u):r,f=ka.fromX(h,s);if(!f.mul(u).isInfinity())throw new Error("nR is not at infinity");const d=n.neg().umod(u),y=r.invm(u),b=y.mul(t).umod(u),g=y.mul(d).umod(u),v=l.mul(g).add(f.mul(b)),_=new fs(v);return _.validate(),_}CalculateRecoveryFactor(e,n){for(let r=0;r<4;r++){let t;try{t=this.RecoverPublicKey(r,n)}catch{continue}if(e.eq(t))return r}throw new Error("Unable to find valid recovery factor")}},R2=class{constructor(e,n){te(this,"K");te(this,"V");if(e=_e(e,"hex"),n=_e(n,"hex"),e.length<32)throw new Error("Not enough entropy. Minimum is 256 bits");const r=e.concat(n);this.K=new Array(32),this.V=new Array(32);for(let t=0;t<32;t++)this.K[t]=0,this.V[t]=1;this.update(r)}hmac(){return new a6(this.K)}update(e){let n=this.hmac().update(this.V).update([0]);e!==void 0&&(n=n.update(e)),this.K=n.digest(),this.V=this.hmac().update(this.V).digest(),e!==void 0&&(this.K=this.hmac().update(this.V).update([1]).update(e).digest(),this.V=this.hmac().update(this.V).digest())}generate(e){let n=[];for(;n.length<e;)this.V=this.hmac().update(this.V).digest(),n=n.concat(this.V);const r=n.slice(0,e);return this.update(),Ue(r)}};function xM(i,e,n=new Yn){const r=i.byteLength()*8-n.n.bitLength();return r>0&&i.iushrn(r),e===null&&i.cmp(n.n)>=0?i.sub(n.n):i}const d6=(i,e,n=!1,r)=>{if(typeof BigInt=="function"){let A=function($,U){const z=$.toString(16).padStart(U*2,"0"),G=new Uint8Array(U);for(let ne=0;ne<U;ne++)G[ne]=parseInt(z.substr(ne*2,2),16);return G},C=function($,U,z=!0){const G=$.toString(2).length,ne=U.toString(2).length,ce=G-ne;return ce>0&&($=$>>BigInt(ce)),!z&&$>=U?$-U:$},D=function($){if(typeof $=="function"){const z=$(M).toString(16);return BigInt("0x"+z)}else if($!=null&&ie.isBN($)){const U=$.toString(16);return BigInt("0x"+U)}else{const U=P.generate(R);return BigInt("0x"+U)}},F=function($,U){return($%U+U)%U},B=function($,U){let z=m,G=f,ne=F($,U),ce=U;for(;ne>m;){const Se=ce/ne,Ie=G-z*Se,me=ce-ne*Se;G=z,z=Ie,ce=ne,ne=me}return F(z,U)},L=function($,U){if($===null)return U;if(U===null)return $;if($.x===U.x&&$.y===F(-U.y,b))return null;let z;if($.x===U.x&&$.y===U.y){if($.y===f)return null;const ce=F(BigInt(3)*$.x*$.x,b),Se=B(d*$.y,b);z=F(ce*Se,b)}else{const ce=F(U.y-$.y,b),Se=B(U.x-$.x,b);z=F(ce*Se,b)}const G=F(z*z-$.x-U.x,b),ne=F(z*($.x-G)-$.y,b);return{x:G,y:ne}},q=function($,U){let z=U,G=null;for(;$>BigInt(0);)$%BigInt(2)===BigInt(1)&&(G=G===null?z:L(G,z)??G),z=L(z,z)??z,$>>=BigInt(1);if(G===null)throw new Error("Scalar multiplication resulted in an invalid point.");return G};var t=A,s=C,a=D,c=F,u=B,l=L,h=q;const f=BigInt(0),m=BigInt(1),d=BigInt(2),y=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),b=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),g=BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),v=BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"),_={x:g,y:v},S=BigInt("0x"+i.toString(16)),I=BigInt("0x"+e.toString(16));if(I<=f||I>=y)throw new Error("Invalid private key");const R=32,E=A(I,R),k=A(S,R),P=new R2(Array.from(E),Array.from(k)),T=y-m;let M=0,K=!1;for(;!K;){M+=1,K=!0,M+=1;let $=D(r);if($=C($,y,!0),$<=m||$>=T){if(r instanceof ie)throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const U=q($,_);if(U===null){if(r instanceof ie)throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const z=F(U.x,y);if(z===f){if(r instanceof ie)throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}const G=B($,y),ne=F(z*I,y);let ce=F(G*(S+ne),y);if(ce===f){if(r instanceof ie)throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}n&&ce>y/d&&(ce=y-ce);const Se=new ie(z.toString(16),16),Ie=new ie(ce.toString(16),16);return new gs(Se,Ie)}}else{const f=new Yn;i=s(i);const m=f.n.byteLength(),d=e.toArray("be",m),y=i.toArray("be",m),b=new R2(d,y),g=f.n.subn(1);for(let v=0;;v++){let _=typeof r=="function"?r(v):ie.isBN(r)?r:new ie(b.generate(m),16);if(_!=null)_=s(_,!0);else throw new Error("k is undefined");if(_.cmpn(1)<=0||_.cmp(g)>=0){if(ie.isBN(r))throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const S=f.g.mul(_);if(S.isInfinity()){if(ie.isBN(r))throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const A=S.getX().umod(f.n);if(A.cmpn(0)===0){if(ie.isBN(r))throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}let R=_.invm(f.n).mul(A.mul(e).iadd(i));if(R=R.umod(f.n),R.cmpn(0)===0){if(ie.isBN(r))throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}return n&&R.cmp(f.n.ushrn(1))>0&&(R=f.n.sub(R)),new gs(A,R)}}throw new Error("Failed to generate a valid signature")},kf=(i,e,n)=>{if(typeof BigInt=="function"){const r=BigInt(0),t=BigInt(1),s=BigInt(2),a=BigInt(3),c=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),u=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),l={x:BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),y:BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8")},h=(E,k)=>(E%k+k)%k,f=(E,k)=>{let[P,T]=[E,k],[M,C]=[BigInt(1),BigInt(0)];for(;T!==r;){const D=P/T;[P,T]=[T,P-D*T],[M,C]=[C,M-D*C]}return P>t?r:h(M,k)},m=(E,k,P)=>h(E*k,P),d=(E,k,P)=>h(E-k,P),y=BigInt(4),b=BigInt(8),g=E=>{const{X:k,Y:P,Z:T}=E;if(P===r)return{X:r,Y:t,Z:r};const M=m(P,P,c),C=m(y,m(k,M,c),c),D=m(a,m(k,k,c),c),F=d(m(D,D,c),m(s,C,c),c),B=d(m(D,d(C,F,c),c),m(b,m(M,M,c),c),c),L=m(s,m(P,T,c),c);return{X:F,Y:B,Z:L}},v=(E,k)=>{if(E.Z===r)return k;if(k.Z===r)return E;const P=m(E.Z,E.Z,c),T=m(k.Z,k.Z,c),M=m(E.X,T,c),C=m(k.X,P,c),D=m(E.Y,m(T,k.Z,c),c),F=m(k.Y,m(P,E.Z,c),c),B=d(C,M,c),L=d(F,D,c);if(B===r)return L===r?g(E):{X:r,Y:t,Z:r};const q=m(B,B,c),K=m(B,q,c),$=m(M,q,c),U=d(d(m(L,L,c),K,c),m(s,$,c),c),z=d(m(L,d($,U,c),c),m(D,K,c),c),G=m(B,m(E.Z,k.Z,c),c);return{X:U,Y:z,Z:G}},_=(E,k)=>{const P={X:k.x,Y:k.y,Z:t};let T={X:r,Y:t,Z:r};const M=E.toString(2);for(let C=0;C<M.length;C++)T=g(T),M[C]==="1"&&(T=v(T,P));return T},S=(E,k,P)=>{const{r:T,s:M}=P,C=E;if(T<=r||T>=u||M<=r||M>=u)return!1;const D=f(M,u);if(D===r)return!1;const F=m(C,D,u),B=m(T,D,u),L=_(F,l),q=_(B,k),K=v(L,q);if(K.Z===r)return!1;const $=f(K.Z,c);if($===r)return!1;const U=m($,$,c),z=m(K.X,U,c);return h(z,u)===T},I=BigInt("0x"+i.toString(16));if(n.x==null||n.y==null)throw new Error("Invalid public key: missing coordinates.");const A={x:BigInt("0x"+n.x.toString(16)),y:BigInt("0x"+n.y.toString(16))},R={r:BigInt("0x"+e.r.toString(16)),s:BigInt("0x"+e.s.toString(16))};return S(I,A,R)}else{const r=new Yn;i=xM(i);const t=e.r,s=e.s;if(t.cmpn(1)<0||t.cmp(r.n)>=0||s.cmpn(1)<0||s.cmp(r.n)>=0)return!1;const a=s.invm(r.n),c=a.mul(i).umod(r.n),u=a.mul(t).umod(r.n),l=r.g.jmulAdd(c,n,u);return l.isInfinity()?!1:l.eqXToP(t)}};let fs=class Gd extends ka{static fromPrivateKey(e){const r=new Yn().g.mul(e);return new Gd(r.x,r.y)}static fromString(e){const n=ka.fromString(e);return new Gd(n.x,n.y)}static fromDER(e){const n=ka.fromDER(e);return new Gd(n.x,n.y)}constructor(e,n=null,r=!0){if(e instanceof ka)super(e.getX(),e.getY());else{if(n===null&&r&&typeof e=="string"&&(e.length===66||e.length===130))throw new Error('You are using the "new PublicKey()" constructor with a DER hex string. You need to use "PublicKey.fromString()" instead.');super(e,n,r)}}deriveSharedSecret(e){if(!this.validate())throw new Error("Public key not valid for ECDH secret derivation");return this.mul(e)}verify(e,n,r){const t=new ie(Wi(e,r),16);return kf(t,n,this)}toDER(e){return e==="hex"?this.encode(!0,e):this.encode(!0)}toHash(e){const n=s6(this.encode(!0));return e==="hex"?Ue(n):n}toAddress(e=[0]){if(typeof e=="string")if(e==="testnet"||e==="test")e=[111];else if(e==="mainnet"||e==="main")e=[0];else throw new Error(`Invalid prefix ${e}`);return o6(this.toHash(),e)}deriveChild(e,n){const r=this.deriveSharedSecret(e),t=_e(n,"utf8"),s=pf(r.encode(!0),t),c=new Yn().g.mul(new ie(s)),u=this.add(c);return new Gd(u.x,u.y)}static fromMsgHashAndCompactSignature(e,n,r){const t=_e(n,r);if(t.length!==65)throw new Error("Invalid Compact Signature");const s=t[0];if(s<27||s>=35)throw new Error("Invalid Compact Byte");let a=t[0]-27;return a>3&&(a-=4),new gs(new ie(t.slice(1,33)),new ie(t.slice(33,65))).RecoverPublicKey(a,e)}};class _M{constructor(){te(this,"_rand");var n;const e=()=>{throw new Error("No secure random number generator is available in this environment.")};if(this._rand=e,typeof self=="object")(n=self.crypto)!=null&&n.getRandomValues?this._rand=r=>{const t=new Uint8Array(r);return self.crypto.getRandomValues(t),[...t]}:this._rand=e;else try{const r=require("crypto");typeof r.randomBytes=="function"&&(this._rand=t=>[...r.randomBytes(t)])}catch{this._rand=e}}generate(e){return this._rand(e)}}let gb=null;const Ra=i=>(gb==null&&(gb=new _M),gb.generate(i));class mu{constructor(e,n){te(this,"x");te(this,"y");const r=new Yn().p;this.x=e.umod(r),this.y=n.umod(r)}toString(){return _m(this.x.toArray())+"."+_m(this.y.toArray())}static fromString(e){const[n,r]=e.split(".");return new mu(new ie(xm(n)),new ie(xm(r)))}}let N2=class f6{constructor(e,n){te(this,"points");te(this,"threshold");this.points=e,this.threshold=n??e.length}static fromPrivateKey(e,n){const r=new Yn().p,t=[new mu(new ie(0),new ie(e.toArray()))];for(let s=1;s<n;s++){const a=new ie(Ra(32)).umod(r),c=new ie(Ra(32)).umod(r);t.push(new mu(a,c))}return new f6(t)}valueAt(e){const n=new Yn().p;let r=new ie(0);for(let t=0;t<this.threshold;t++){let s=this.points[t].y;for(let a=0;a<this.threshold;a++)if(t!==a){const c=this.points[a].x,u=this.points[t].x,l=e.sub(c).umod(n),f=u.sub(c).umod(n).invm(n),m=l.mul(f).umod(n);s=s.mul(m).umod(n)}r=r.add(s).umod(n)}return r}};class n0{constructor(e,n,r){te(this,"points");te(this,"threshold");te(this,"integrity");this.points=e,this.threshold=n,this.integrity=r}static fromBackupFormat(e){let n=0,r="";const t=e.map((s,a)=>{const c=s.split(".");if(c.length!==4)throw new Error("Invalid share format in share "+a.toString()+'. Expected format: "x.y.t.i" - received '+s);const[u,l,h,f]=c;if(h===void 0)throw new Error("Threshold not found in share "+a.toString());if(f===void 0)throw new Error("Integrity not found in share "+a.toString());const m=parseInt(h);if(a!==0&&n!==m)throw new Error("Threshold mismatch in share "+a.toString());if(a!==0&&r!==f)throw new Error("Integrity mismatch in share "+a.toString());return n=m,r=f,mu.fromString([u,l].join("."))});return new n0(t,n,r)}toBackupFormat(){return this.points.map(e=>e.toString()+"."+this.threshold.toString()+"."+this.integrity)}}let Lr=class _a extends ie{static fromRandom(){return new _a(Ra(32))}static fromString(e,n="hex"){return new _a(super.fromString(e,n).toArray())}static fromHex(e){return new _a(super.fromHex(e,"big"))}static fromWif(e,n=1){const r=c6(e,void 0,n);if(r.data.length!==33)throw new Error("Invalid WIF length");if(r.data[32]!==1)throw new Error("Invalid WIF padding");return new _a(r.data.slice(0,32))}constructor(e=0,n=10,r="be",t="apply"){if(e instanceof ie?(super(),e.copy(this)):super(e,n,r),t!=="nocheck"){const s=this.checkInField();if(!s.inField){if(t==="error")throw new Error("Input is out of field");ie.move(this,s.modN)}}}checkInField(){const e=new Yn,n=this.mod(e.n);return{inField:this.cmp(n)===0,modN:n}}isValid(){return this.checkInField().inField}sign(e,n,r=!0,t){const s=new ie(Wi(e,n),16);return d6(s,this,r,t)}verify(e,n,r){const t=new ie(Wi(e,r),16);return kf(t,n,this.toPublicKey())}toPublicKey(){const n=new Yn().g.mul(this);return new fs(n.x,n.y)}toWif(e=[128]){if(!this.isValid())throw new Error("Value is out of field");return o6([...this.toArray("be",32),1],e)}toAddress(e=[0]){return this.toPublicKey().toAddress(e)}toHex(){return super.toHex(32)}toString(e="hex",n=64){return super.toString(e,n)}deriveSharedSecret(e){if(!e.validate())throw new Error("Public key not valid for ECDH secret derivation");return e.mul(this)}deriveChild(e,n){const r=this.deriveSharedSecret(e),t=_e(n,"utf8"),s=pf(r.encode(!0),t),a=new Yn;return new _a(this.add(new ie(s)).mod(a.n).toArray())}toKeyShares(e,n){if(typeof e!="number"||typeof n!="number")throw new Error("threshold and totalShares must be numbers");if(e<2)throw new Error("threshold must be at least 2");if(n<2)throw new Error("totalShares must be at least 2");if(e>n)throw new Error("threshold should be less than or equal to totalShares");const r=N2.fromPrivateKey(this,e),t=[];for(let a=0;a<n;a++){const c=new ie(_a.fromRandom().toArray()),u=r.valueAt(c);t.push(new mu(c,u))}const s=this.toPublicKey().toHash("hex").slice(0,8);return new n0(t,e,s)}toBackupShares(e,n){return this.toKeyShares(e,n).toBackupFormat()}static fromBackupShares(e){return _a.fromKeyShares(n0.fromBackupFormat(e))}static fromKeyShares(e){const{points:n,threshold:r,integrity:t}=e;if(r<2)throw new Error("threshold must be at least 2");if(n.length<r)throw new Error(`At least ${r} shares are required to reconstruct the private key`);for(let u=0;u<r;u++)for(let l=u+1;l<r;l++)if(n[u].x.eq(n[l].x))throw new Error("Duplicate share detected, each must be unique.");const s=new N2(n,r),a=new _a(s.valueAt(new ie(0)).toArray());if(a.toPublicKey().toHash("hex").slice(0,8)!==t)throw new Error("Integrity hash mismatch");return a}};const h6=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]),SM=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]].map(i=>new Uint8Array(i)),Xd=new Uint8Array(256),Yd=new Uint8Array(256);for(let i=0;i<256;i++){const e=(i<<1^((i&128)!==0?27:0))&255;Xd[i]=e,Yd[i]=e^i}function C2(i,e,n){for(let r=0;r<4;r++){const t=e[n+r];for(let s=0;s<4;s++)i[s][r]^=t[s]}}function IM(i){for(let e=0;e<4;e++)for(let n=0;n<4;n++)i[e][n]=h6[i[e][n]]}function M2(i){for(let e=0;e<4;e++)i[e]=h6[i[e]]}function TM(i){const e=i[0];i[0]=i[1],i[1]=i[2],i[2]=i[3],i[3]=e}function kM(i){let e=i[1][0];i[1][0]=i[1][1],i[1][1]=i[1][2],i[1][2]=i[1][3],i[1][3]=e,e=i[2][0];const n=i[2][1];i[2][0]=i[2][2],i[2][1]=i[2][3],i[2][2]=e,i[2][3]=n,e=i[3][3],i[3][3]=i[3][2],i[3][2]=i[3][1],i[3][1]=i[3][0],i[3][0]=e}function EM(i){for(let e=0;e<4;e++){const n=i[0][e],r=i[1][e],t=i[2][e],s=i[3][e];i[0][e]=Xd[n]^Yd[r]^t^s,i[1][e]=n^Xd[r]^Yd[t]^s,i[2][e]=n^r^Xd[t]^Yd[s],i[3][e]=Yd[n]^r^t^Xd[s]}}function OM(i,e){const n=e.length/4,r=[];for(let t=0;t<e.length;t++)t%4===0&&r.push([]),r[t>>2].push(e[t]);for(let t=n;t<4*i;t++){r[t]=[];const s=r[t-1].slice();if(t%n===0){TM(s),M2(s);const a=SM[t/n];for(let c=0;c<4;c++)s[c]^=a[c]}else n>6&&t%n===4&&M2(s);for(let a=0;a<4;a++)r[t][a]=r[t-n][a]^s[a]}return r}function ww(i,e){let n,r,t,s;const a=[[],[],[],[]],c=[],u=Array.from(e);if(u.length<=16){for(;u.length<16;)u.unshift(0);s=11}else if(u.length<=24){for(;u.length<24;)u.unshift(0);s=13}else if(e.length<=32){for(;u.length<32;)u.unshift(0);s=15}else throw new Error("Illegal key length: "+String(e.length));const l=OM(s,u);for(let h=0;h<4;h++)a[0][h]=i[h*4],a[1][h]=i[h*4+1],a[2][h]=i[h*4+2],a[3][h]=i[h*4+3];for(C2(a,l,0),t=1;t<s;t++)IM(a),kM(a),t+1<s&&EM(a),C2(a,l,t*4);for(n=0;n<4;n++)for(r=0;r<4;r++)c.push(a[r][n]);return c}const cu=function(i){return[(i&4278190080)>>>24,(i&16711680)>>16,(i&65280)>>8,i&255]},Ft=function(i){return new Array(i).fill(0)},AM=[225].concat(Ft(15)),B2=function(i,e){for(let n=0;n<i.length;n++)i[n]^=e[n]},D2=function(i){let e,n=0,r=0;for(e=0;e<i.length;e++)r=n,n=i[e]&1,i[e]=i[e]>>1,r!==0&&(i[e]=i[e]|128);return i},PM=function(i,e){const n=e.slice(),r=Ft(16);for(let t=0;t<16;t++)for(let s=7;s>=0;s--)(i[t]&1<<s)!==0&&B2(r,n),(n[15]&1)!==0?(D2(n),B2(n,AM)):D2(n);return r},vw=function(i){let e;const n=i.slice();for(e=15;e!==11&&(n[e]=n[e]+1,n[e]===256);e--)n[e]=0;return n};function i0(i,e){let n=Ft(16);for(let r=0;r<i.length;r+=16){const t=n.slice();for(let s=0;s<16;s++)t[s]^=i[r+s]??0;n=PM(t,e)}return n}function r0(i,e,n){if(i.length===0)return[];const r=new Array(i.length);let t=e,s=0;const a=Math.ceil(i.length/16);for(let c=0;c<a;c++){const u=ww(t,n),l=Math.min(16,i.length-s);for(let h=0;h<l;h++)r[s]=i[s]^u[h],s++;c+1<a&&(t=vw(t))}return r}function RM(i,e,n,r){let t,s;const a=ww(Ft(16),r);t=[...n],n.length===12?t=t.concat(Ft(3)).concat([1]):(n.length%16!==0&&(t=t.concat(Ft(16-n.length%16))),t=t.concat(Ft(8)),t=i0(t.concat(Ft(4)).concat(cu(n.length*8)),a));const c=r0(i,vw(t),r);return s=e.slice(),e.length===0?s=s.concat(Ft(16)):e.length%16!==0&&(s=s.concat(Ft(16-e.length%16))),s=s.concat(c),c.length===0?s=s.concat(Ft(16)):c.length%16!==0&&(s=s.concat(Ft(16-c.length%16))),s=s.concat(Ft(4)).concat(cu(e.length*8)).concat(Ft(4)).concat(cu(c.length*8)),{result:c,authenticationTag:r0(i0(s,a),t,r)}}function NM(i,e,n,r,t){let s,a;const c=ww(Ft(16),t);s=[...n],n.length===12?s=s.concat(Ft(3)).concat([1]):(n.length%16!==0&&(s=s.concat(Ft(16-n.length%16))),s=s.concat(Ft(8)),s=i0(s.concat(Ft(4)).concat(cu(n.length*8)),c));const u=r0(i,vw(s),t);return a=e.slice(),e.length===0?a=a.concat(Ft(16)):e.length%16!==0&&(a=a.concat(Ft(16-e.length%16))),a=a.concat(i),i.length===0?a=a.concat(Ft(16)):i.length%16!==0&&(a=a.concat(Ft(16-i.length%16))),a=a.concat(Ft(4)).concat(cu(e.length*8)).concat(Ft(4)).concat(cu(i.length*8)),r0(i0(a,c),s,t).join()!==r.join()?null:u}let CM=class p6 extends ie{static fromRandom(){return new p6(Ra(32))}encrypt(e,n){const r=Ra(32);e=_e(e,n);const{result:t,authenticationTag:s}=RM(e,[],r,this.toArray("be",32));return t0([...r,...t,...s],n)}decrypt(e,n){e=_e(e,n);const r=e.slice(0,32),t=e.slice(32),s=t.slice(-16),a=t.slice(0,-16),c=NM(a,[],r,s,this.toArray());if(c===null)throw new Error("Decryption failed!");return t0(c,n)}};var yn;let gn=(yn=class extends gs{constructor(n,r,t){super(n,r);te(this,"scope");this.scope=t}static format(n){const r={sourceTXID:n.sourceTXID,sourceOutputIndex:n.sourceOutputIndex,sequence:n.inputSequence},t=[...n.otherInputs];t.splice(n.inputIndex,0,r);const s=()=>{const b=new Ge;for(const _ of t){if(typeof _.sourceTXID>"u"){if(_.sourceTransaction==null)throw new Error("Missing sourceTransaction for input");b.write(_.sourceTransaction.hash())}else b.writeReverse(_e(_.sourceTXID,"hex"));b.writeUInt32LE(_.sourceOutputIndex)}const g=b.toArray();return ji(g)},a=()=>{const b=new Ge;for(const _ of t){const S=_.sequence??4294967295;b.writeUInt32LE(S)}const g=b.toArray();return ji(g)};function c(b){var S,I;const g=new Ge;if(typeof b>"u")for(const A of n.outputs){const R=A.satoshis??0;g.writeUInt64LE(R);const E=((S=A.lockingScript)==null?void 0:S.toBinary())??[];g.writeVarIntNum(E.length),g.write(E)}else{const A=n.outputs[b];if(A===void 0)throw new Error(`Output at index ${b} does not exist`);const R=A.satoshis??0;g.writeUInt64LE(R);const E=((I=A.lockingScript)==null?void 0:I.toBinary())??[];g.writeVarIntNum(E.length),g.write(E)}const v=g.toArray();return ji(v)}let u=new Array(32).fill(0),l=new Array(32).fill(0),h=new Array(32).fill(0);(n.scope&yn.SIGHASH_ANYONECANPAY)===0&&(u=s()),(n.scope&yn.SIGHASH_ANYONECANPAY)===0&&(n.scope&31)!==yn.SIGHASH_SINGLE&&(n.scope&31)!==yn.SIGHASH_NONE&&(l=a()),(n.scope&31)!==yn.SIGHASH_SINGLE&&(n.scope&31)!==yn.SIGHASH_NONE?h=c():(n.scope&31)===yn.SIGHASH_SINGLE&&n.inputIndex<n.outputs.length&&(h=c(n.inputIndex));const f=new Ge;f.writeInt32LE(n.transactionVersion),f.write(u),f.write(l),f.writeReverse(_e(n.sourceTXID,"hex")),f.writeUInt32LE(n.sourceOutputIndex);const m=n.subscript.toBinary();f.writeVarIntNum(m.length),f.write(m),f.writeUInt64LE(n.sourceSatoshis);const d=r.sequence;return f.writeUInt32LE(d),f.write(h),f.writeUInt32LE(n.lockTime),f.writeUInt32LE(n.scope>>>0),f.toArray()}static fromChecksigFormat(n){if(n.length===0){const a=new ie(1),c=new ie(1),u=1;return new yn(a,c,u)}const r=n[n.length-1],t=n.slice(0,n.length-1),s=gs.fromDER(t);return new yn(s.r,s.s,r)}hasLowS(){return!(this.s.ltn(1)||this.s.gt(new ie("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))}toChecksigFormat(){return[...this.toDER(),this.scope]}},te(yn,"SIGHASH_ALL",1),te(yn,"SIGHASH_NONE",2),te(yn,"SIGHASH_SINGLE",3),te(yn,"SIGHASH_FORKID",64),te(yn,"SIGHASH_ANYONECANPAY",128),yn),MM=class{constructor(){te(this,"curve");this.curve=new Yn}generateProof(e,n,r,t){const s=Lr.fromRandom(),a=s.toPublicKey(),c=r.mul(s),u=this.computeChallenge(n,r,t,c,a),l=s.add(u.mul(e)).umod(this.curve.n);return{R:a,SPrime:c,z:l}}verifyProof(e,n,r,t){const{R:s,SPrime:a,z:c}=t,u=this.computeChallenge(e,n,r,a,s),l=this.curve.g.mul(c),h=s.add(e.mul(u));if(!l.eq(h))return!1;const f=n.mul(c),m=a.add(r.mul(u));return!!f.eq(m)}computeChallenge(e,n,r,t,s){const a=[...e.encode(!0),...n.encode(!0),...r.encode(!0),...t.encode(!0),...s.encode(!0)],c=Wi(a);return new ie(c).umod(this.curve.n)}};const W={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_SPLIT:127,OP_LEFT:128,OP_NUM2BIN:128,OP_RIGHT:129,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_NOP11:186,OP_NOP12:187,OP_NOP13:188,OP_NOP14:189,OP_NOP15:190,OP_NOP16:191,OP_NOP17:192,OP_NOP18:193,OP_NOP19:194,OP_NOP20:195,OP_NOP21:196,OP_NOP22:197,OP_NOP23:198,OP_NOP24:199,OP_NOP25:200,OP_NOP26:201,OP_NOP27:202,OP_NOP28:203,OP_NOP29:204,OP_NOP30:205,OP_NOP31:206,OP_NOP32:207,OP_NOP33:208,OP_NOP34:209,OP_NOP35:210,OP_NOP36:211,OP_NOP37:212,OP_NOP38:213,OP_NOP39:214,OP_NOP40:215,OP_NOP41:216,OP_NOP42:217,OP_NOP43:218,OP_NOP44:219,OP_NOP45:220,OP_NOP46:221,OP_NOP47:222,OP_NOP48:223,OP_NOP49:224,OP_NOP50:225,OP_NOP51:226,OP_NOP52:227,OP_NOP53:228,OP_NOP54:229,OP_NOP55:230,OP_NOP56:231,OP_NOP57:232,OP_NOP58:233,OP_NOP59:234,OP_NOP60:235,OP_NOP61:236,OP_NOP62:237,OP_NOP63:238,OP_NOP64:239,OP_NOP65:240,OP_NOP66:241,OP_NOP67:242,OP_NOP68:243,OP_NOP69:244,OP_NOP70:245,OP_NOP71:246,OP_NOP72:247,OP_NOP73:248,OP_NOP77:252,OP_SMALLDATA:249,OP_SMALLINTEGER:250,OP_PUBKEYS:251,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};for(const i in W)W[W[i]]=i;let To=class Jc{constructor(e=[]){te(this,"chunks");this.chunks=e}static fromASM(e){const n=[],r=e.split(" ");let t=0;for(;t<r.length;){const s=r[t];let a,c=0;if(s.startsWith("OP_")&&typeof W[s]<"u"&&(a=s,c=W[s]),s==="0")c=0,n.push({op:c}),t=t+1;else if(s==="-1")c=W.OP_1NEGATE,n.push({op:c}),t=t+1;else if(a===void 0){let u=r[t];u.length%2!==0&&(u="0"+u);const l=_e(u,"hex");if(t0(l,"hex")!==u)throw new Error("invalid hex string in script");const h=l.length;h>=0&&h<W.OP_PUSHDATA1?c=h:h<Math.pow(2,8)?c=W.OP_PUSHDATA1:h<Math.pow(2,16)?c=W.OP_PUSHDATA2:h<Math.pow(2,32)&&(c=W.OP_PUSHDATA4),n.push({data:l,op:c}),t=t+1}else c===W.OP_PUSHDATA1||c===W.OP_PUSHDATA2||c===W.OP_PUSHDATA4?(n.push({data:_e(r[t+2],"hex"),op:c}),t=t+3):(n.push({op:c}),t=t+1)}return new Jc(n)}static fromHex(e){if(e.length===0)return Jc.fromBinary([]);if(e.length%2!==0)throw new Error("There is an uneven number of characters in the string which suggests it is not hex encoded.");if(!/^[0-9a-fA-F]+$/.test(e))throw new Error("Some elements in this string are not hex encoded.");return Jc.fromBinary(_e(e,"hex"))}static fromBinary(e){e=[...e];const n=[];let r=0;const t=new un(e);for(;!t.eof();){const s=t.readUInt8();if(s===W.OP_RETURN&&r===0){n.push({op:s,data:t.read()});break}s===W.OP_IF||s===W.OP_NOTIF||s===W.OP_VERIF||s===W.OP_VERNOTIF?r++:s===W.OP_ENDIF&&r--;let a=0,c=[];if(s>0&&s<W.OP_PUSHDATA1)a=s,n.push({data:t.read(a),op:s});else if(s===W.OP_PUSHDATA1){try{a=t.readUInt8(),c=t.read(a)}catch{t.read()}n.push({data:c,op:s})}else if(s===W.OP_PUSHDATA2){try{a=t.readUInt16LE(),c=t.read(a)}catch{t.read()}n.push({data:c,op:s})}else if(s===W.OP_PUSHDATA4){try{a=t.readUInt32LE(),c=t.read(a)}catch{t.read()}n.push({data:c,op:s})}else n.push({op:s})}return new Jc(n)}toASM(){let e="";for(let n=0;n<this.chunks.length;n++){const r=this.chunks[n];e+=this._chunkToString(r)}return e.slice(1)}toHex(){return t0(this.toBinary(),"hex")}toBinary(){const e=new Ge;for(let n=0;n<this.chunks.length;n++){const r=this.chunks[n],t=r.op;if(e.writeUInt8(t),t===W.OP_RETURN&&r.data!=null){e.write(r.data);break}else r.data!=null&&(t<W.OP_PUSHDATA1?e.write(r.data):t===W.OP_PUSHDATA1?(e.writeUInt8(r.data.length),e.write(r.data)):t===W.OP_PUSHDATA2?(e.writeUInt16LE(r.data.length),e.write(r.data)):t===W.OP_PUSHDATA4&&(e.writeUInt32LE(r.data.length),e.write(r.data)))}return e.toArray()}writeScript(e){return this.chunks=this.chunks.concat(e.chunks),this}writeOpCode(e){return this.chunks.push({op:e}),this}setChunkOpCode(e,n){return this.chunks[e]={op:n},this}writeBn(e){if(e.cmpn(0)===W.OP_0)this.chunks.push({op:W.OP_0});else if(e.cmpn(-1)===0)this.chunks.push({op:W.OP_1NEGATE});else if(e.cmpn(1)>=0&&e.cmpn(16)<=0)this.chunks.push({op:e.toNumber()+W.OP_1-1});else{const n=e.toSm("little");this.writeBin(n)}return this}writeBin(e){let n;if(e.length>0&&e.length<W.OP_PUSHDATA1)n=e.length;else if(e.length===0)n=W.OP_0;else if(e.length<Math.pow(2,8))n=W.OP_PUSHDATA1;else if(e.length<Math.pow(2,16))n=W.OP_PUSHDATA2;else if(e.length<Math.pow(2,32))n=W.OP_PUSHDATA4;else throw new Error("You can't push that much data");return this.chunks.push({data:e,op:n}),this}writeNumber(e){return this.writeBn(new ie(e)),this}removeCodeseparators(){const e=[];for(let n=0;n<this.chunks.length;n++)this.chunks[n].op!==W.OP_CODESEPARATOR&&e.push(this.chunks[n]);return this.chunks=e,this}findAndDelete(e){const n=e.toHex();for(let r=0;r<this.chunks.length;r++){const s=new Jc([this.chunks[r]]).toHex();n===s&&this.chunks.splice(r,1)}return this}isPushOnly(){for(let e=0;e<this.chunks.length;e++)if(this.chunks[e].op>W.OP_16)return!1;return!0}isLockingScript(){throw new Error("Not implemented")}isUnlockingScript(){throw new Error("Not implemented")}_chunkToString(e){const n=e.op;let r="";if(typeof e.data>"u"){const t=W[n];r=`${r} ${t}`}else r=`${r} ${Ue(e.data)}`;return r}},uu=class extends To{isLockingScript(){return!0}isUnlockingScript(){return!1}},a0=class extends To{isLockingScript(){return!1}isUnlockingScript(){return!0}};const bc=1024*1024*1024,L2=Math.pow(2,31)-1,Ti=!0,BM=!0,DM=Object.freeze(new ie(-1).toScriptNum()),F2=Object.freeze(Array.from({length:17},(i,e)=>Object.freeze(new ie(e).toScriptNum())));function LM(i,e){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(i[n]!==e[n])return!1;return!0}function FM(i,e=Number.MAX_SAFE_INTEGER){return!(i.length>e||i.length>0&&(i[i.length-1]&127)===0&&(i.length<=1||(i[i.length-2]&128)===0))}function UM(i){if(i.length<9||i.length>73||i[0]!==48||i[1]!==i.length-3)return!1;const e=i[2],n=i[3];if(e!==2||n===0||5+n>=i.length)return!1;const r=4+n,t=i[r],s=i[r+1];if(t!==2||s===0||(i[4]&128)!==0||n>1&&i[4]===0&&(i[5]&128)===0)return!1;const a=r+2;return!((i[a]&128)!==0||s>1&&i[a]===0&&(i[a+1]&128)===0||n+s+7!==i.length)}function HM(i){return i===W.OP_2MUL||i===W.OP_2DIV||i===W.OP_VERIF||i===W.OP_VERNOTIF||i===W.OP_VER}function qM(i){const e=i.data,n=i.op;return Array.isArray(e)?e.length===0?n===W.OP_0:e.length===1&&e[0]>=1&&e[0]<=16?n===W.OP_1+(e[0]-1):e.length===1&&e[0]===129?n===W.OP_1NEGATE:e.length<=75?n===e.length:e.length<=255?n===W.OP_PUSHDATA1:e.length<=65535?n===W.OP_PUSHDATA2:!0:!0}let jM=class{constructor(e){te(this,"sourceTXID");te(this,"sourceOutputIndex");te(this,"sourceSatoshis");te(this,"lockingScript");te(this,"transactionVersion");te(this,"otherInputs");te(this,"outputs");te(this,"inputIndex");te(this,"unlockingScript");te(this,"inputSequence");te(this,"lockTime");te(this,"context");te(this,"programCounter");te(this,"lastCodeSeparator");te(this,"stack");te(this,"altStack");te(this,"ifStack");te(this,"memoryLimit");te(this,"stackMem");te(this,"altStackMem");this.sourceTXID=e.sourceTXID,this.sourceOutputIndex=e.sourceOutputIndex,this.sourceSatoshis=e.sourceSatoshis,this.lockingScript=e.lockingScript,this.transactionVersion=e.transactionVersion,this.otherInputs=e.otherInputs,this.outputs=e.outputs,this.inputIndex=e.inputIndex,this.unlockingScript=e.unlockingScript,this.inputSequence=e.inputSequence,this.lockTime=e.lockTime,this.memoryLimit=e.memoryLimit??32e6,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0,this.reset()}reset(){this.context="UnlockingScript",this.programCounter=0,this.lastCodeSeparator=null,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0}ensureStackMem(e){this.stackMem+e>this.memoryLimit&&this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes")}ensureAltStackMem(e){this.altStackMem+e>this.memoryLimit&&this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes")}pushStack(e){this.ensureStackMem(e.length),this.stack.push(e),this.stackMem+=e.length}pushStackCopy(e){this.ensureStackMem(e.length);const n=e.slice();this.stack.push(n),this.stackMem+=n.length}popStack(){this.stack.length===0&&this.scriptEvaluationError("Attempted to pop from an empty stack.");const e=this.stack.pop();return this.stackMem-=e.length,e}stackTop(e=-1){return(this.stack.length===0||this.stack.length<Math.abs(e)||e>=0&&e>=this.stack.length)&&this.scriptEvaluationError(`Stack underflow accessing element at index ${e}. Stack length is ${this.stack.length}.`),this.stack[this.stack.length+e]}pushAltStack(e){this.ensureAltStackMem(e.length),this.altStack.push(e),this.altStackMem+=e.length}popAltStack(){this.altStack.length===0&&this.scriptEvaluationError("Attempted to pop from an empty alt stack.");const e=this.altStack.pop();return this.altStackMem-=e.length,e}checkSignatureEncoding(e){if(e.length===0)return!0;if(!UM(e))return this.scriptEvaluationError("The signature format is invalid."),!1;try{const n=gn.fromChecksigFormat(e);if(BM&&!n.hasLowS())return this.scriptEvaluationError("The signature must have a low S value."),!1;if((n.scope&gn.SIGHASH_FORKID)===0)return this.scriptEvaluationError("The signature must use SIGHASH_FORKID."),!1}catch{return this.scriptEvaluationError("The signature format is invalid."),!1}return!0}checkPublicKeyEncoding(e){if(e.length===0)return this.scriptEvaluationError("Public key is empty."),!1;if(e.length<33)return this.scriptEvaluationError("The public key is too short, it must be at least 33 bytes."),!1;if(e[0]===4){if(e.length!==65)return this.scriptEvaluationError("The non-compressed public key must be 65 bytes."),!1}else if(e[0]===2||e[0]===3){if(e.length!==33)return this.scriptEvaluationError("The compressed public key must be 33 bytes."),!1}else return this.scriptEvaluationError("The public key is in an unknown format."),!1;try{fs.fromDER(e)}catch{return this.scriptEvaluationError("The public key is in an unknown format."),!1}return!0}verifySignature(e,n,r){const t=gn.format({sourceTXID:this.sourceTXID,sourceOutputIndex:this.sourceOutputIndex,sourceSatoshis:this.sourceSatoshis,transactionVersion:this.transactionVersion,otherInputs:this.otherInputs,outputs:this.outputs,inputIndex:this.inputIndex,subscript:r,inputSequence:this.inputSequence,lockTime:this.lockTime,scope:e.scope}),s=new ie(ji(t));return kf(s,e,n)}step(){if(this.stackMem>this.memoryLimit)return this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;if(this.altStackMem>this.memoryLimit)return this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;this.context==="UnlockingScript"&&this.programCounter>=this.unlockingScript.chunks.length&&(this.context="LockingScript",this.programCounter=0);const e=this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript;if(this.programCounter>=e.chunks.length)return!1;const n=e.chunks[this.programCounter],r=n.op;typeof r>"u"&&this.scriptEvaluationError(`Missing opcode in ${this.context} at pc=${this.programCounter}.`),Array.isArray(n.data)&&n.data.length>bc&&this.scriptEvaluationError(`Data push > ${bc} bytes (pc=${this.programCounter}).`);const t=!this.ifStack.includes(!1);if(t&&HM(r)&&this.scriptEvaluationError(`This opcode is currently disabled. (Opcode: ${W[r]}, PC: ${this.programCounter})`),t&&r>=0&&r<=W.OP_PUSHDATA4)qM(n)||this.scriptEvaluationError(`This data is not minimally-encoded. (PC: ${this.programCounter})`),this.pushStack(Array.isArray(n.data)?n.data:[]);else if(t||r>=W.OP_IF&&r<=W.OP_ENDIF){let s,a,c,u,l,h,f,m,d,y,b,g,v,_,S,I,A,R,E,k,P,T,M,C,D,F;switch(r){case W.OP_1NEGATE:this.pushStackCopy(DM);break;case W.OP_0:this.pushStackCopy(F2[0]);break;case W.OP_1:case W.OP_2:case W.OP_3:case W.OP_4:case W.OP_5:case W.OP_6:case W.OP_7:case W.OP_8:case W.OP_9:case W.OP_10:case W.OP_11:case W.OP_12:case W.OP_13:case W.OP_14:case W.OP_15:case W.OP_16:g=r-(W.OP_1-1),this.pushStackCopy(F2[g]);break;case W.OP_NOP:case W.OP_NOP2:case W.OP_NOP3:case W.OP_NOP1:case W.OP_NOP4:case W.OP_NOP5:case W.OP_NOP6:case W.OP_NOP7:case W.OP_NOP8:case W.OP_NOP9:case W.OP_NOP10:case W.OP_NOP11:case W.OP_NOP12:case W.OP_NOP13:case W.OP_NOP14:case W.OP_NOP15:case W.OP_NOP16:case W.OP_NOP17:case W.OP_NOP18:case W.OP_NOP19:case W.OP_NOP20:case W.OP_NOP21:case W.OP_NOP22:case W.OP_NOP23:case W.OP_NOP24:case W.OP_NOP25:case W.OP_NOP26:case W.OP_NOP27:case W.OP_NOP28:case W.OP_NOP29:case W.OP_NOP30:case W.OP_NOP31:case W.OP_NOP32:case W.OP_NOP33:case W.OP_NOP34:case W.OP_NOP35:case W.OP_NOP36:case W.OP_NOP37:case W.OP_NOP38:case W.OP_NOP39:case W.OP_NOP40:case W.OP_NOP41:case W.OP_NOP42:case W.OP_NOP43:case W.OP_NOP44:case W.OP_NOP45:case W.OP_NOP46:case W.OP_NOP47:case W.OP_NOP48:case W.OP_NOP49:case W.OP_NOP50:case W.OP_NOP51:case W.OP_NOP52:case W.OP_NOP53:case W.OP_NOP54:case W.OP_NOP55:case W.OP_NOP56:case W.OP_NOP57:case W.OP_NOP58:case W.OP_NOP59:case W.OP_NOP60:case W.OP_NOP61:case W.OP_NOP62:case W.OP_NOP63:case W.OP_NOP64:case W.OP_NOP65:case W.OP_NOP66:case W.OP_NOP67:case W.OP_NOP68:case W.OP_NOP69:case W.OP_NOP70:case W.OP_NOP71:case W.OP_NOP72:case W.OP_NOP73:case W.OP_NOP77:break;case W.OP_IF:case W.OP_NOTIF:_=!1,t&&(this.stack.length<1&&this.scriptEvaluationError("OP_IF and OP_NOTIF require at least one item on the stack when they are used!"),s=this.popStack(),_=this.castToBool(s),r===W.OP_NOTIF&&(_=!_)),this.ifStack.push(_);break;case W.OP_ELSE:this.ifStack.length===0&&this.scriptEvaluationError("OP_ELSE requires a preceeding OP_IF."),this.ifStack[this.ifStack.length-1]=!this.ifStack[this.ifStack.length-1];break;case W.OP_ENDIF:this.ifStack.length===0&&this.scriptEvaluationError("OP_ENDIF requires a preceeding OP_IF."),this.ifStack.pop();break;case W.OP_VERIFY:this.stack.length<1&&this.scriptEvaluationError("OP_VERIFY requires at least one item to be on the stack."),a=this.stackTop(),_=this.castToBool(a),_||this.scriptEvaluationError("OP_VERIFY requires the top stack value to be truthy."),this.popStack();break;case W.OP_RETURN:this.context==="UnlockingScript"?this.programCounter=this.unlockingScript.chunks.length:this.programCounter=this.lockingScript.chunks.length,this.ifStack=[],this.programCounter--;break;case W.OP_TOALTSTACK:this.stack.length<1&&this.scriptEvaluationError("OP_TOALTSTACK requires at oeast one item to be on the stack."),this.pushAltStack(this.popStack());break;case W.OP_FROMALTSTACK:this.altStack.length<1&&this.scriptEvaluationError("OP_FROMALTSTACK requires at least one item to be on the stack."),this.pushStack(this.popAltStack());break;case W.OP_2DROP:this.stack.length<2&&this.scriptEvaluationError("OP_2DROP requires at least two items to be on the stack."),this.popStack(),this.popStack();break;case W.OP_2DUP:this.stack.length<2&&this.scriptEvaluationError("OP_2DUP requires at least two items to be on the stack."),a=this.stackTop(-2),c=this.stackTop(-1),this.pushStackCopy(a),this.pushStackCopy(c);break;case W.OP_3DUP:this.stack.length<3&&this.scriptEvaluationError("OP_3DUP requires at least three items to be on the stack."),a=this.stackTop(-3),c=this.stackTop(-2),u=this.stackTop(-1),this.pushStackCopy(a),this.pushStackCopy(c),this.pushStackCopy(u);break;case W.OP_2OVER:this.stack.length<4&&this.scriptEvaluationError("OP_2OVER requires at least four items to be on the stack."),a=this.stackTop(-4),c=this.stackTop(-3),this.pushStackCopy(a),this.pushStackCopy(c);break;case W.OP_2ROT:{this.stack.length<6&&this.scriptEvaluationError("OP_2ROT requires at least six items to be on the stack.");const B=this.popStack(),L=this.popStack(),q=this.popStack(),K=this.popStack(),$=this.popStack(),U=this.popStack();this.pushStack(K),this.pushStack(q),this.pushStack(L),this.pushStack(B),this.pushStack(U),this.pushStack($);break}case W.OP_2SWAP:{this.stack.length<4&&this.scriptEvaluationError("OP_2SWAP requires at least four items to be on the stack.");const B=this.popStack(),L=this.popStack(),q=this.popStack(),K=this.popStack();this.pushStack(L),this.pushStack(B),this.pushStack(K),this.pushStack(q);break}case W.OP_IFDUP:this.stack.length<1&&this.scriptEvaluationError("OP_IFDUP requires at least one item to be on the stack."),a=this.stackTop(),this.castToBool(a)&&this.pushStackCopy(a);break;case W.OP_DEPTH:this.pushStack(new ie(this.stack.length).toScriptNum());break;case W.OP_DROP:this.stack.length<1&&this.scriptEvaluationError("OP_DROP requires at least one item to be on the stack."),this.popStack();break;case W.OP_DUP:this.stack.length<1&&this.scriptEvaluationError("OP_DUP requires at least one item to be on the stack."),this.pushStackCopy(this.stackTop());break;case W.OP_NIP:this.stack.length<2&&this.scriptEvaluationError("OP_NIP requires at least two items to be on the stack."),c=this.popStack(),this.popStack(),this.pushStack(c);break;case W.OP_OVER:this.stack.length<2&&this.scriptEvaluationError("OP_OVER requires at least two items to be on the stack."),this.pushStackCopy(this.stackTop(-2));break;case W.OP_PICK:case W.OP_ROLL:{this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items to be on the stack.`),m=ie.fromScriptNum(this.popStack(),Ti),g=m.toNumber(),(g<0||g>=this.stack.length)&&this.scriptEvaluationError(`${W[r]} requires the top stack element to be 0 or a positive number less than the current size of the stack.`);const B=this.stack[this.stack.length-1-g];r===W.OP_ROLL?(this.stack.splice(this.stack.length-1-g,1),this.stackMem-=B.length,this.pushStack(B)):this.pushStackCopy(B);break}case W.OP_ROT:this.stack.length<3&&this.scriptEvaluationError("OP_ROT requires at least three items to be on the stack."),f=this.popStack(),h=this.popStack(),l=this.popStack(),this.pushStack(h),this.pushStack(f),this.pushStack(l);break;case W.OP_SWAP:this.stack.length<2&&this.scriptEvaluationError("OP_SWAP requires at least two items to be on the stack."),h=this.popStack(),l=this.popStack(),this.pushStack(h),this.pushStack(l);break;case W.OP_TUCK:this.stack.length<2&&this.scriptEvaluationError("OP_TUCK requires at least two items to be on the stack."),a=this.stackTop(-1),this.ensureStackMem(a.length),this.stack.splice(this.stack.length-2,0,a.slice()),this.stackMem+=a.length;break;case W.OP_SIZE:this.stack.length<1&&this.scriptEvaluationError("OP_SIZE requires at least one item to be on the stack."),this.pushStack(new ie(this.stackTop().length).toScriptNum());break;case W.OP_AND:case W.OP_OR:case W.OP_XOR:{this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items on the stack.`),c=this.popStack(),a=this.popStack(),a.length!==c.length&&this.scriptEvaluationError(`${W[r]} requires the top two stack items to be the same size.`);const B=new Array(a.length);for(let L=0;L<a.length;L++)r===W.OP_AND?B[L]=a[L]&c[L]:r===W.OP_OR?B[L]=a[L]|c[L]:B[L]=a[L]^c[L];this.pushStack(B);break}case W.OP_INVERT:{this.stack.length<1&&this.scriptEvaluationError("OP_INVERT requires at least one item to be on the stack."),s=this.popStack();const B=new Array(s.length);for(let L=0;L<s.length;L++)B[L]=~s[L]&255;this.pushStack(B);break}case W.OP_LSHIFT:case W.OP_RSHIFT:{if(this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items to be on the stack.`),y=ie.fromScriptNum(this.popStack(),Ti),a=this.popStack(),g=y.toNumber(),g<0&&this.scriptEvaluationError(`${W[r]} requires the top item on the stack not to be negative.`),a.length===0){this.pushStack([]);break}d=new ie(a);let B;r===W.OP_LSHIFT?B=d.ushln(g):B=d.ushrn(g);const L=B.toArray("le",a.length);this.pushStack(L);break}case W.OP_EQUAL:case W.OP_EQUALVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items to be on the stack.`),c=this.popStack(),a=this.popStack(),_=LM(a,c),this.pushStack(_?[1]:[]),r===W.OP_EQUALVERIFY&&(_||this.scriptEvaluationError("OP_EQUALVERIFY requires the top two stack items to be equal."),this.popStack());break;case W.OP_1ADD:case W.OP_1SUB:case W.OP_NEGATE:case W.OP_ABS:case W.OP_NOT:case W.OP_0NOTEQUAL:switch(this.stack.length<1&&this.scriptEvaluationError(`${W[r]} requires at least one item to be on the stack.`),m=ie.fromScriptNum(this.popStack(),Ti),r){case W.OP_1ADD:m=m.add(new ie(1));break;case W.OP_1SUB:m=m.sub(new ie(1));break;case W.OP_NEGATE:m=m.neg();break;case W.OP_ABS:m.isNeg()&&(m=m.neg());break;case W.OP_NOT:m=new ie(m.cmpn(0)===0?1:0);break;case W.OP_0NOTEQUAL:m=new ie(m.cmpn(0)!==0?1:0);break}this.pushStack(m.toScriptNum());break;case W.OP_ADD:case W.OP_SUB:case W.OP_MUL:case W.OP_DIV:case W.OP_MOD:case W.OP_BOOLAND:case W.OP_BOOLOR:case W.OP_NUMEQUAL:case W.OP_NUMEQUALVERIFY:case W.OP_NUMNOTEQUAL:case W.OP_LESSTHAN:case W.OP_GREATERTHAN:case W.OP_LESSTHANOREQUAL:case W.OP_GREATERTHANOREQUAL:case W.OP_MIN:case W.OP_MAX:{this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items to be on the stack.`),c=this.popStack(),a=this.popStack(),y=ie.fromScriptNum(c,Ti),d=ie.fromScriptNum(a,Ti);let B=0;switch(r){case W.OP_MUL:B=d.byteLength()+y.byteLength();break;case W.OP_ADD:case W.OP_SUB:B=Math.max(d.byteLength(),y.byteLength())+1;break;default:B=Math.max(d.byteLength(),y.byteLength())}this.ensureStackMem(B);let L=new ie(0);switch(r){case W.OP_ADD:L=d.add(y);break;case W.OP_SUB:L=d.sub(y);break;case W.OP_MUL:L=d.mul(y);break;case W.OP_DIV:y.cmpn(0)===0&&this.scriptEvaluationError("OP_DIV cannot divide by zero!"),L=d.div(y);break;case W.OP_MOD:y.cmpn(0)===0&&this.scriptEvaluationError("OP_MOD cannot divide by zero!"),L=d.mod(y);break;case W.OP_BOOLAND:L=new ie(d.cmpn(0)!==0&&y.cmpn(0)!==0?1:0);break;case W.OP_BOOLOR:L=new ie(d.cmpn(0)!==0||y.cmpn(0)!==0?1:0);break;case W.OP_NUMEQUAL:L=new ie(d.cmp(y)===0?1:0);break;case W.OP_NUMEQUALVERIFY:L=new ie(d.cmp(y)===0?1:0);break;case W.OP_NUMNOTEQUAL:L=new ie(d.cmp(y)!==0?1:0);break;case W.OP_LESSTHAN:L=new ie(d.cmp(y)<0?1:0);break;case W.OP_GREATERTHAN:L=new ie(d.cmp(y)>0?1:0);break;case W.OP_LESSTHANOREQUAL:L=new ie(d.cmp(y)<=0?1:0);break;case W.OP_GREATERTHANOREQUAL:L=new ie(d.cmp(y)>=0?1:0);break;case W.OP_MIN:L=d.cmp(y)<0?d:y;break;case W.OP_MAX:L=d.cmp(y)>0?d:y;break}this.pushStack(L.toScriptNum()),r===W.OP_NUMEQUALVERIFY&&(this.castToBool(this.stackTop())||this.scriptEvaluationError("OP_NUMEQUALVERIFY requires the top stack item to be truthy."),this.popStack());break}case W.OP_WITHIN:this.stack.length<3&&this.scriptEvaluationError("OP_WITHIN requires at least three items to be on the stack."),b=ie.fromScriptNum(this.popStack(),Ti),y=ie.fromScriptNum(this.popStack(),Ti),d=ie.fromScriptNum(this.popStack(),Ti),_=d.cmp(y)>=0&&d.cmp(b)<0,this.pushStack(_?[1]:[]);break;case W.OP_RIPEMD160:case W.OP_SHA1:case W.OP_SHA256:case W.OP_HASH160:case W.OP_HASH256:{this.stack.length<1&&this.scriptEvaluationError(`${W[r]} requires at least one item to be on the stack.`),s=this.popStack();let B=[];r===W.OP_RIPEMD160?B=pM(s):r===W.OP_SHA1?B=yM(s):r===W.OP_SHA256?B=Wi(s):r===W.OP_HASH160?B=s6(s):r===W.OP_HASH256&&(B=ji(s)),this.pushStack(B);break}case W.OP_CODESEPARATOR:this.lastCodeSeparator=this.programCounter;break;case W.OP_CHECKSIG:case W.OP_CHECKSIGVERIFY:{this.stack.length<2&&this.scriptEvaluationError(`${W[r]} requires at least two items to be on the stack.`),R=this.popStack(),A=this.popStack(),(!this.checkSignatureEncoding(A)||!this.checkPublicKeyEncoding(R))&&this.scriptEvaluationError(`${W[r]} requires correct encoding for the public key and signature.`);const L=(this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript).chunks.slice(this.lastCodeSeparator===null?0:this.lastCodeSeparator+1);if(I=new To(L),I.findAndDelete(new To().writeBin(A)),S=!1,A.length>0)try{E=gn.fromChecksigFormat(A),k=fs.fromDER(R),S=this.verifySignature(E,k,I)}catch{S=!1}this.pushStack(S?[1]:[]),r===W.OP_CHECKSIGVERIFY&&(S||this.scriptEvaluationError("OP_CHECKSIGVERIFY requires that a valid signature is provided."),this.popStack());break}case W.OP_CHECKMULTISIG:case W.OP_CHECKMULTISIGVERIFY:{P=1,this.stack.length<P&&this.scriptEvaluationError(`${W[r]} requires at least 1 item for nKeys.`),C=ie.fromScriptNum(this.stackTop(-P),Ti).toNumber(),(C<0||C>L2)&&this.scriptEvaluationError(`${W[r]} requires a key count between 0 and ${L2}.`),T=++P,P+=C,this.stack.length<P&&this.scriptEvaluationError(`${W[r]} stack too small for nKeys and keys. Need ${P}, have ${this.stack.length}.`),D=ie.fromScriptNum(this.stackTop(-P),Ti).toNumber(),(D<0||D>C)&&this.scriptEvaluationError(`${W[r]} requires the number of signatures to be no greater than the number of keys.`),M=++P,P+=D,this.stack.length<P&&this.scriptEvaluationError(`${W[r]} stack too small for N, keys, M, sigs, and dummy. Need ${P}, have ${this.stack.length}.`);const L=(this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript).chunks.slice(this.lastCodeSeparator===null?0:this.lastCodeSeparator+1);I=new To(L);for(let U=0;U<D;U++)A=this.stackTop(-M-U),I.findAndDelete(new To().writeBin(A));for(S=!0;S&&D>0;){if(C===0){S=!1;break}if(A=this.stackTop(-M),R=this.stackTop(-T),(!this.checkSignatureEncoding(A)||!this.checkPublicKeyEncoding(R))&&this.scriptEvaluationError(`${W[r]} requires correct encoding for the public key and signature.`),F=!1,A.length>0)try{E=gn.fromChecksigFormat(A),k=fs.fromDER(R),F=this.verifySignature(E,k,I)}catch{F=!1}F&&(M++,D--),T++,C--,D>C&&(S=!1)}let K=1+ie.fromScriptNum(this.stackTop(-1),!1).toNumber()+1+ie.fromScriptNum(this.stackTop(-(1+ie.fromScriptNum(this.stackTop(-1),!1).toNumber()+1)),!1).toNumber()+1-1;for(;K>0;)this.popStack(),K--;this.stack.length<1&&this.scriptEvaluationError(`${W[r]} requires an extra item (dummy) to be on the stack.`),this.popStack().length>0&&this.scriptEvaluationError(`${W[r]} requires the extra stack item (dummy) to be empty.`),this.pushStack(S?[1]:[]),r===W.OP_CHECKMULTISIGVERIFY&&(S||this.scriptEvaluationError("OP_CHECKMULTISIGVERIFY requires that a sufficient number of valid signatures are provided."),this.popStack());break}case W.OP_CAT:{this.stack.length<2&&this.scriptEvaluationError("OP_CAT requires at least two items to be on the stack."),c=this.popStack(),a=this.popStack();const B=a.concat(c);B.length>bc&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${bc} bytes.`),this.pushStack(B);break}case W.OP_SPLIT:{this.stack.length<2&&this.scriptEvaluationError("OP_SPLIT requires at least two items to be on the stack.");const B=this.popStack(),L=this.popStack();g=ie.fromScriptNum(B,Ti).toNumber(),(g<0||g>L.length)&&this.scriptEvaluationError("OP_SPLIT requires the first stack item to be a non-negative number less than or equal to the size of the second-from-top stack item."),this.pushStack(L.slice(0,g)),this.pushStack(L.slice(g));break}case W.OP_NUM2BIN:{this.stack.length<2&&this.scriptEvaluationError("OP_NUM2BIN requires at least two items to be on the stack."),v=ie.fromScriptNum(this.popStack(),Ti).toNumber(),(v>bc||v<0)&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${bc} bytes or negative size.`);let B=this.popStack();if(B=P2(B),B.length>v&&this.scriptEvaluationError("OP_NUM2BIN requires that the size expressed in the top stack item is large enough to hold the value expressed in the second-from-top stack item."),B.length===v){this.pushStack(B);break}const L=new Array(v).fill(0);let q=0;B.length>0&&(q=B[B.length-1]&128,B[B.length-1]&=127);for(let K=0;K<B.length;K++)L[K]=B[K];q!==0&&(L[v-1]|=128),this.pushStack(L);break}case W.OP_BIN2NUM:{this.stack.length<1&&this.scriptEvaluationError("OP_BIN2NUM requires at least one item to be on the stack."),a=this.popStack();const B=P2(a);FM(B)||this.scriptEvaluationError("OP_BIN2NUM requires that the resulting number is valid."),this.pushStack(B);break}default:this.scriptEvaluationError(`Invalid opcode ${r} (pc=${this.programCounter}).`)}}return this.programCounter++,!0}validate(){for(this.unlockingScript.isPushOnly()||this.scriptEvaluationError("Unlocking scripts can only contain push operations, and no other opcodes.");this.step()&&!(this.context==="LockingScript"&&this.programCounter>=this.lockingScript.chunks.length););return this.ifStack.length>0&&this.scriptEvaluationError("Every OP_IF, OP_NOTIF, or OP_ELSE must be terminated with OP_ENDIF prior to the end of the script."),this.stack.length!==1&&this.scriptEvaluationError(`The clean stack rule requires exactly one item to be on the stack after script execution, found ${this.stack.length}.`),this.stack.length===0?this.scriptEvaluationError("The top stack element must be truthy after script evaluation (stack is empty)."):this.castToBool(this.stackTop())||this.scriptEvaluationError("The top stack element must be truthy after script evaluation."),!0}castToBool(e){if(e.length===0)return!1;for(let n=0;n<e.length;n++)if(e[n]!==0)return!(n===e.length-1&&e[n]===128);return!1}scriptEvaluationError(e){const n=`Context: ${this.context}, PC: ${this.programCounter}`,r=this.stack.map(u=>u!=null&&typeof u.length<"u"?Ue(u):u==null?"null/undef":"INVALID_STACK_ITEM").join(", "),t=this.altStack.map(u=>u!=null&&typeof u.length<"u"?Ue(u):u==null?"null/undef":"INVALID_STACK_ITEM").join(", "),s=`Stack: [${r}] (len: ${this.stack.length}, mem: ${this.stackMem})`,a=`AltStack: [${t}] (len: ${this.altStack.length}, mem: ${this.altStackMem})`,c=`IfStack: [${this.ifStack.join(", ")}]`;throw new Error(`Script evaluation error: ${e}
TXID: ${this.sourceTXID}, OutputIdx: ${this.sourceOutputIndex}
${n}
${s}
${a}
${c}`)}};function U2(i){if(i==null)throw new Error("must have value");return i}let VM=class{lock(e){let n;if(typeof e=="string"){const r=c6(e);if(r.prefix[0]!==0&&r.prefix[0]!==111)throw new Error("only P2PKH is supported");n=r.data}else n=e;if(n.length!==20)throw new Error("P2PKH hash length must be 20 bytes");return new uu([{op:W.OP_DUP},{op:W.OP_HASH160},{op:n.length,data:n},{op:W.OP_EQUALVERIFY},{op:W.OP_CHECKSIG}])}unlock(e,n="all",r=!1,t,s){return{sign:async(a,c)=>{var v,_,S;let u=gn.SIGHASH_FORKID;n==="all"&&(u|=gn.SIGHASH_ALL),n==="none"&&(u|=gn.SIGHASH_NONE),n==="single"&&(u|=gn.SIGHASH_SINGLE),r&&(u|=gn.SIGHASH_ANYONECANPAY);const l=a.inputs[c],h=a.inputs.filter((I,A)=>A!==c),f=l.sourceTXID??((v=l.sourceTransaction)==null?void 0:v.id("hex"));if(f==null||f===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(f==="")throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(t||(t=(_=l.sourceTransaction)==null?void 0:_.outputs[l.sourceOutputIndex].satoshis),t==null||t===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(s||(s=(S=l.sourceTransaction)==null?void 0:S.outputs[l.sourceOutputIndex].lockingScript),s==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const m=gn.format({sourceTXID:f,sourceOutputIndex:U2(l.sourceOutputIndex),sourceSatoshis:t,transactionVersion:a.version,otherInputs:h,inputIndex:c,outputs:a.outputs,inputSequence:U2(l.sequence),subscript:s,lockTime:a.lockTime,scope:u}),d=e.sign(Wi(m)),b=new gn(d.r,d.s,u).toChecksigFormat(),g=e.toPublicKey().encode(!0);return new a0([{op:b.length,data:b},{op:g.length,data:g}])},estimateLength:async()=>108}}};function H2(i){if(i==null)throw new Error("must have value");return i}const KM=i=>i.length===0?{op:0}:i.length===1&&i[0]===0?{op:0}:i.length===1&&i[0]>0&&i[0]<=16?{op:80+i[0]}:i.length===1&&i[0]===129?{op:79}:i.length<=75?{op:i.length,data:i}:i.length<=255?{op:76,data:i}:i.length<=65535?{op:77,data:i}:{op:78,data:i};let N0=class{constructor(e,n){te(this,"wallet");te(this,"originator");this.wallet=e,this.originator=n}static decode(e){var t;const n=fs.fromString(Ue(H2(e.chunks[0].data))),r=[];for(let s=2;s<e.chunks.length;s++){const a=(t=e.chunks[s+1])==null?void 0:t.op;let c=e.chunks[s].data??[];if(c.length===0&&(e.chunks[s].op>=80&&e.chunks[s].op<=95?c=[e.chunks[s].op-80]:e.chunks[s].op===0?c=[0]:e.chunks[s].op===79&&(c=[129])),r.push(c),a===W.OP_DROP||a===W.OP_2DROP)break}return{fields:r,lockingPublicKey:n}}async lock(e,n,r,t,s=!1,a=!0,c="before"){const{publicKey:u}=await this.wallet.getPublicKey({protocolID:n,keyID:r,counterparty:t,forSelf:s},this.originator),l=[],h=[];if(l.push({op:u.length/2,data:_e(u,"hex")}),l.push({op:W.OP_CHECKSIG}),a){const m=e.reduce((y,b)=>[...y,...b],[]),{signature:d}=await this.wallet.createSignature({data:m,protocolID:n,keyID:r,counterparty:t},this.originator);e.push(d)}for(const m of e)h.push(KM(m));let f=e.length;for(;f>1;)h.push({op:W.OP_2DROP}),f-=2;return f!==0&&h.push({op:W.OP_DROP}),c==="before"?new uu([...l,...h]):new uu([...h,...l])}unlock(e,n,r,t="all",s=!1,a,c){return{sign:async(u,l)=>{var I,A,R;let h=gn.SIGHASH_FORKID;t==="all"&&(h|=gn.SIGHASH_ALL),t==="none"&&(h|=gn.SIGHASH_NONE),t==="single"&&(h|=gn.SIGHASH_SINGLE),s&&(h|=gn.SIGHASH_ANYONECANPAY);const f=u.inputs[l],m=u.inputs.filter((E,k)=>k!==l),d=f.sourceTXID??((I=f.sourceTransaction)==null?void 0:I.id("hex"));if(d==null||d===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(a||(a=(A=f.sourceTransaction)==null?void 0:A.outputs[f.sourceOutputIndex].satoshis),a==null||a===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(c||(c=(R=f.sourceTransaction)==null?void 0:R.outputs[f.sourceOutputIndex].lockingScript),c==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const y=gn.format({sourceTXID:d,sourceOutputIndex:H2(f.sourceOutputIndex),sourceSatoshis:a,transactionVersion:u.version,otherInputs:m,inputIndex:l,outputs:u.outputs,inputSequence:f.sequence??4294967295,subscript:c,lockTime:u.lockTime,scope:h}),b=Wi(y),{signature:g}=await this.wallet.createSignature({data:b,protocolID:e,keyID:n,counterparty:r},this.originator),v=gs.fromDER([...g]),S=new gn(v.r,v.s,h).toChecksigFormat();return new a0([{op:S.length,data:S}])},estimateLength:async()=>73}}},WM=class{constructor(e){te(this,"value");this.value=e}async computeFee(e){const n=s=>s>4294967296?9:s>65536?5:s>253?3:1;let r=4;r+=n(e.inputs.length);for(let s=0;s<e.inputs.length;s++){const a=e.inputs[s];r+=40;let c;if(typeof a.unlockingScript=="object")c=a.unlockingScript.toBinary().length;else if(typeof a.unlockingScriptTemplate=="object")c=await a.unlockingScriptTemplate.estimateLength(e,s);else throw new Error("All inputs must have an unlocking script or an unlocking script template for sat/kb fee computation.");r+=n(c),r+=c}r+=n(e.outputs.length);for(const s of e.outputs){r+=8;const a=s.lockingScript.toBinary().length;r+=n(a),r+=a}return r+=4,Math.ceil(r/1e3*this.value)}},$M=class{constructor(e){te(this,"https");this.https=e}async request(e,n){return await new Promise((r,t)=>{const s=this.https.request(e,n,a=>{let c="";a.on("data",u=>{c+=u}),a.on("end",()=>{const u=a.statusCode>=200&&a.statusCode<=299,l=a.headers["content-type"],h=c!==""&&typeof l=="string"&&l.startsWith("application/json")?JSON.parse(c):c;r({status:a.statusCode,statusText:a.statusMessage,ok:u,data:h})})});s.on("error",a=>{t(a)}),n.data!==null&&n.data!==void 0&&s.write(JSON.stringify(n.data)),s.end()})}},zM=class{constructor(e){te(this,"fetch");this.fetch=e}async request(e,n){const r={method:n.method,headers:n.headers,body:JSON.stringify(n.data)},t=await this.fetch(e,r),s=t.headers.get("Content-Type"),a=(s==null?void 0:s.startsWith("application/json"))??!1?await t.json():await t.text();return{ok:t.ok,status:t.status,statusText:t.statusText,data:a}}};function Im(){const i={async request(...e){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new zM(window.fetch.bind(window));if(typeof require<"u")try{const e=require("https");return new $M(e)}catch{return i}else return i}function q2(){return`ts-sdk-${Ue(Ra(16))}`}let GM=class{constructor(e,n){te(this,"URL");te(this,"apiKey");te(this,"deploymentId");te(this,"callbackUrl");te(this,"callbackToken");te(this,"headers");te(this,"httpClient");if(this.URL=e,typeof n=="string")this.apiKey=n,this.httpClient=Im(),this.deploymentId=q2(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const r=n??{},{apiKey:t,deploymentId:s,httpClient:a,callbackToken:c,callbackUrl:u,headers:l}=r;this.apiKey=t,this.httpClient=a??Im(),this.deploymentId=s??q2(),this.callbackToken=c,this.callbackUrl=u,this.headers=l}}requestHeaders(){const e={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(e.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(e["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(e["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const n in this.headers)e[n]=this.headers[n];return e}async broadcast(e){let n;try{n=e.toHexEF()}catch(t){if(t.message==="All inputs must have source transactions when serializing to EF format")n=e.toHex();else throw t}const r={method:"POST",headers:this.requestHeaders(),data:{rawTx:n}};try{const t=await this.httpClient.request(`${this.URL}/v1/tx`,r);if(t.ok){const{txid:s,extraInfo:a,txStatus:c,competingTxs:u}=t.data,l={status:"success",txid:s,message:`${c} ${a}`};return u!=null&&(l.competingTxs=u),l}else{const s=typeof t.status,a={status:"error",code:s==="number"||s==="string"?t.status.toString():"ERR_UNKNOWN",description:"Unknown error"};let c=t.data;if(typeof c=="string")try{c=JSON.parse(t.data)}catch{}return typeof c=="object"&&(c!==null&&(a.more=c),c!=null&&typeof c.txid=="string"&&(a.txid=c.txid),c!=null&&"detail"in c&&typeof c.detail=="string"&&(a.description=c.detail)),a}}catch(t){return{status:"error",code:"500",description:typeof t.message=="string"?t.message:"Internal Server Error"}}}async broadcastMany(e){const n=e.map(t=>{try{return{rawTx:t.toHexEF()}}catch(s){if(s.message==="All inputs must have source transactions when serializing to EF format")return{rawTx:t.toHex()};throw s}}),r={method:"POST",headers:this.requestHeaders(),data:n};try{return(await this.httpClient.request(`${this.URL}/v1/txs`,r)).data}catch(t){const s={status:"error",code:"500",description:typeof t.message=="string"?t.message:"Internal Server Error"};return e.map(()=>s)}}};function XM(i=!1,e={}){return new GM(i?"https://arc-test.taal.com":"https://arc.taal.com",e)}let YM=class{constructor(e="main",n={}){te(this,"network");te(this,"apiKey");te(this,"URL");te(this,"httpClient");const{apiKey:r,httpClient:t}=n;this.network=e,this.URL=`https://api.whatsonchain.com/v1/bsv/${e}`,this.httpClient=t??Im(),this.apiKey=r??""}async isValidRootForHeight(e,n){const r={method:"GET",headers:this.getHttpHeaders()},t=await this.httpClient.request(`${this.URL}/block/${n}/header`,r);if(t.ok){const{merkleroot:s}=t.data;return s===e}else{if(t.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${n} because of an error: ${JSON.stringify(t.data)} `)}}async currentHeight(){try{const e={method:"GET",headers:this.getHttpHeaders()},n=await this.httpClient.request(`${this.URL}/block/headers`,e);if(n.ok)return n.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(n.data)} `)}catch(e){throw new Error(`Failed to get current height because of an error: ${e instanceof Error?e.message:String(e)}`)}}getHttpHeaders(){const e={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(e.Authorization=this.apiKey),e}};function QM(){return new YM}let ZM=class Qd{constructor(e,n,r=!0){te(this,"blockHeight");te(this,"path");this.blockHeight=e,this.path=n;const t=Array(this.path.length).fill(0).map(()=>new Set);this.path.forEach((a,c)=>{if(a.length===0&&c===0)throw new Error(`Empty level at height: ${c}`);const u=new Set;a.forEach(l=>{if(u.has(l.offset))throw new Error(`Duplicate offset: ${l.offset}, at height: ${c}`);if(u.add(l.offset),c===0){if(l.duplicate!==!0)for(let h=1;h<this.path.length;h++)t[h].add(l.offset>>h^1)}else if(r&&!t[c].has(l.offset))throw new Error(`Invalid offset: ${l.offset}, at height: ${c}, with legal offsets: ${Array.from(t[c]).join(", ")}`)})});let s;this.path[0].forEach((a,c)=>{if(c===0&&(s=this.computeRoot(a.hash)),s!==this.computeRoot(a.hash))throw new Error("Mismatched roots")})}static fromHex(e){return Qd.fromBinary(_e(e,"hex"))}static fromReader(e,n=!0){const r=e.readVarIntNum(),t=e.readUInt8(),s=Array(t).fill(null).map(()=>[]);let a,c,u;for(let l=0;l<t;l++){for(u=e.readVarIntNum();u>0;){c=e.readVarIntNum(),a=e.readUInt8();const h={offset:c};(a&1)!==0?h.duplicate=!0:((a&2)!==0&&(h.txid=!0),h.hash=Ue(e.read(32).reverse())),(!Array.isArray(s[l])||s[l].length===0)&&(s[l]=[]),s[l].push(h),u--}s[l].sort((h,f)=>h.offset-f.offset)}return new Qd(r,s,n)}static fromBinary(e){const n=new un(e);return Qd.fromReader(n)}static fromCoinbaseTxidAndHeight(e,n){return new Qd(n,[[{offset:0,hash:e,txid:!0}]])}toBinary(){const e=new Ge;e.writeVarIntNum(this.blockHeight);const n=this.path.length;e.writeUInt8(n);for(let r=0;r<n;r++){const t=Object.keys(this.path[r]).length;e.writeVarIntNum(t);for(const s of this.path[r]){e.writeVarIntNum(s.offset);let a=0;(s==null?void 0:s.duplicate)===!0&&(a|=1),(s==null?void 0:s.txid)!==void 0&&s.txid!==null&&(a|=2),e.writeUInt8(a),(a&1)===0&&e.write(_e(s.hash,"hex").reverse())}}return e.toArray()}toHex(){return Ue(this.toBinary())}indexOf(e){const n=this.path[0].find(r=>r.hash===e);if(n==null)throw new Error(`Transaction ID ${e} not found in the Merkle Path`);return n.offset}computeRoot(e){if(typeof e!="string"){const s=this.path[0].find(a=>!!(a!=null&&a.hash));if(s==null)throw new Error("No valid leaf found in the Merkle Path");e=s.hash}if(typeof e!="string")throw new Error("Transaction ID is undefined");const n=this.indexOf(e);if(typeof n!="number")throw new Error(`This proof does not contain the txid: ${e??"undefined"}`);const r=s=>Ue(ji(_e(s,"hex").reverse()).reverse());let t=e;if(this.path.length===1&&this.path[0].length===1)return t;for(let s=0;s<this.path.length;s++){this.path[s];const a=n>>s^1,c=this.findOrComputeLeaf(s,a);if(typeof c!="object")throw new Error(`Missing hash for index ${n} at height ${s}`);c.duplicate===!0?t=r((t??"")+(t??"")):a%2!==0?t=r((c.hash??"")+(t??"")):t=r((t??"")+(c.hash??""))}return t}findOrComputeLeaf(e,n){const r=h=>Ue(ji(_e(h,"hex").reverse()).reverse());let t=this.path[e].find(h=>h.offset===n);if(t!=null)return t;if(e===0)return;const s=e-1,a=n<<1,c=this.findOrComputeLeaf(s,a);if(c==null||c.hash==null||c.hash==="")return;const u=this.findOrComputeLeaf(s,a+1);if(u==null)return;let l;return u.duplicate===!0?l=r(c.hash+c.hash):l=r((u.hash??"")+(c.hash??"")),t={offset:n,hash:l},t}async verify(e,n){const r=this.computeRoot(e);if(this.indexOf(e)===0){const t=await n.currentHeight();if(this.blockHeight+100<t)return!1}return await n.isValidRootForHeight(r,this.blockHeight)}combine(e){var s,a;if(this.blockHeight!==e.blockHeight)throw new Error("You cannot combine paths which do not have the same block height.");const n=this.computeRoot(),r=e.computeRoot();if(n!==r)throw new Error("You cannot combine paths which do not have the same root.");const t=[];for(let c=0;c<this.path.length;c++){t.push([]);for(let u=0;u<this.path[c].length;u++)t[c].push(this.path[c][u]);for(let u=0;u<e.path[c].length;u++)if(t[c].find(l=>l.offset===e.path[c][u].offset)===void 0)t[c].push(e.path[c][u]);else if(((s=e.path[c][u])==null?void 0:s.txid)!==void 0&&((a=e.path[c][u])==null?void 0:a.txid)!==null){const l=t[c].find(h=>h.offset===e.path[c][u].offset);l!=null&&(l.txid=!0)}}this.path=t,this.trim()}trim(){const e=(a,c)=>{(c.length===0||c.slice(-1)[0]!==a)&&c.push(a)},n=(a,c)=>{for(let u=a.length;u>=0;u--){const l=this.path[c].findIndex(h=>h.offset===a[u]);l>=0&&this.path[c].splice(l,1)}},r=a=>{const c=[];for(const u of a)e(u>>1,c);return c};let t=[],s=[];for(let a=0;a<this.path.length;a++)this.path[a].sort((c,u)=>c.offset-u.offset);for(let a=0;a<this.path[0].length;a++){const c=this.path[0][a];if(c.txid===!0)e(c.offset>>1,t);else{const u=c.offset%2===1,l=this.path[0][a+(u?-1:1)];(l.txid===void 0||l.txid===null||!l.txid)&&e(l.offset,s)}}n(s,0);for(let a=1;a<this.path.length;a++)s=t,t=r(t),n(s,a)}},ep=class mo{constructor(e,n){te(this,"_bumpIndex");te(this,"_tx");te(this,"_rawTx");te(this,"_txid");te(this,"inputTxids",[]);te(this,"isValid");typeof e=="string"?this._txid=e:Array.isArray(e)?this._rawTx=e:this._tx=e,this.bumpIndex=n,this.updateInputTxids()}get bumpIndex(){return this._bumpIndex}set bumpIndex(e){this._bumpIndex=e,this.updateInputTxids()}get hasProof(){return this._bumpIndex!==void 0}get isTxidOnly(){return this._txid!==void 0&&this._txid!==null&&this._rawTx==null&&this._tx==null}get txid(){if(this._txid!==void 0&&this._txid!==null&&this._txid!=="")return this._txid;if(this._tx!=null)return this._txid=this._tx.id("hex"),this._txid;if(this._rawTx!=null)return this._txid=Ue(ji(this._rawTx)),this._txid;throw new Error("Internal")}get tx(){if(this._tx!=null)return this._tx;if(this._rawTx!=null)return this._tx=Fr.fromBinary(this._rawTx),this._tx}get rawTx(){if(this._rawTx!=null)return this._rawTx;if(this._tx!=null)return this._rawTx=this._tx.toBinary(),this._rawTx}static fromTx(e,n){return new mo(e,n)}static fromRawTx(e,n){return new mo(e,n)}static fromTxid(e,n){return new mo(e,n)}updateInputTxids(){if(this.hasProof||this.tx==null)this.inputTxids=[];else{const e={};for(const n of this.tx.inputs)n.sourceTXID!==void 0&&n.sourceTXID!==null&&n.sourceTXID!==""&&(e[n.sourceTXID]=!0);this.inputTxids=Object.keys(e)}}toWriter(e,n){const r=c=>{e.writeUInt8(c)},t=()=>{if(this._txid==null)throw new Error("Transaction ID (_txid) is undefined");e.writeReverse(_e(this._txid,"hex"))},s=()=>{if(this._rawTx!=null)e.write(this._rawTx);else if(this._tx!=null)e.write(this._tx.toBinary());else throw new Error("a valid serialized Transaction is expected")},a=()=>{this.bumpIndex===void 0?r(Ta.RAWTX):(r(Ta.RAWTX_AND_BUMP_INDEX),e.writeVarIntNum(this.bumpIndex))};n===ru?this.isTxidOnly?(r(Ta.TXID_ONLY),t()):this.bumpIndex!==void 0?(r(Ta.RAWTX_AND_BUMP_INDEX),e.writeVarIntNum(this.bumpIndex),s()):(r(Ta.RAWTX),s()):(s(),a())}static fromReader(e,n){let r,t,s;if(n===ru){const a=e.readUInt8();a===Ta.TXID_ONLY?s=mo.fromTxid(Ue(e.readReverse(32))):(a===Ta.RAWTX_AND_BUMP_INDEX&&(t=e.readVarIntNum()),r=Fr.fromReader(e),s=mo.fromTx(r,t))}else r=Fr.fromReader(e),t=e.readUInt8()!==0?e.readVarIntNum():void 0,s=mo.fromTx(r,t);return s}};function j2(i){if(i==null)throw new Error("Expected a valid value, but got undefined.");return i}const Tm=4022206465,ru=4022206466,V2=16843009;var Ta;(function(i){i[i.RAWTX=0]="RAWTX",i[i.RAWTX_AND_BUMP_INDEX=1]="RAWTX_AND_BUMP_INDEX",i[i.TXID_ONLY=2]="TXID_ONLY"})(Ta||(Ta={}));let JM=class eu{constructor(e=ru){te(this,"bumps",[]);te(this,"txs",[]);te(this,"version",ru);te(this,"atomicTxid");this.version=e}findTxid(e){return this.txs.find(n=>n.txid===e)}makeTxidOnly(e){const n=this.txs.findIndex(t=>t.txid===e);if(n===-1)return;let r=this.txs[n];return r.isTxidOnly||(this.txs.splice(n,1),r=this.mergeTxidOnly(e)),r}findBump(e){return this.bumps.find(n=>n.path[0].some(r=>r.hash===e))}findTransactionForSigning(e){const n=this.findTxid(e);if(!(n==null||n.tx==null)){for(const r of n.tx.inputs)if(r.sourceTransaction==null){const t=this.findTxid(j2(r.sourceTXID));t!=null&&(r.sourceTransaction=t.tx)}return n.tx}}findAtomicTransaction(e){const n=this.findTxid(e);if(n==null||n.tx==null)return;const r=(t,s)=>{const a=t.findBump(s.id("hex"));if(a!=null)s.merklePath=a;else for(const c of s.inputs){if(c.sourceTransaction==null){const u=t.findTxid(j2(c.sourceTXID));u!=null&&(c.sourceTransaction=u.tx)}if(c.sourceTransaction!=null){const u=t.findBump(c.sourceTransaction.id("hex"));u!=null?c.sourceTransaction.merklePath=u:r(t,c.sourceTransaction)}}};return r(this,n.tx),n.tx}mergeBump(e){let n;for(let t=0;t<this.bumps.length;t++){const s=this.bumps[t];if(s===e)return t;if(s.blockHeight===e.blockHeight){const a=s.computeRoot(),c=e.computeRoot();if(a===c){s.combine(e),n=t;break}}}n===void 0&&(n=this.bumps.length,this.bumps.push(e));const r=this.bumps[n];for(const t of this.txs){const s=t.txid;if(t.bumpIndex==null){for(const a of r.path[0])if(a.hash===s){t.bumpIndex=n,a.txid=!0;break}}}return n}mergeRawTx(e,n){const r=new ep(e,n);return this.removeExistingTxid(r.txid),this.txs.push(r),this.tryToValidateBumpIndex(r),r}mergeTransaction(e){const n=e.id("hex");this.removeExistingTxid(n);let r;e.merklePath!=null&&(r=this.mergeBump(e.merklePath));const t=new ep(e,r);if(this.txs.push(t),this.tryToValidateBumpIndex(t),r=t.bumpIndex,r===void 0)for(const s of e.inputs)s.sourceTransaction!=null&&this.mergeTransaction(s.sourceTransaction);return t}removeExistingTxid(e){const n=this.txs.findIndex(r=>r.txid===e);n>=0&&this.txs.splice(n,1)}mergeTxidOnly(e){let n=this.txs.find(r=>r.txid===e);return n==null&&(n=new ep(e),this.txs.push(n),this.tryToValidateBumpIndex(n)),n}mergeBeefTx(e){let n=this.findTxid(e.txid);if(e.isTxidOnly&&n==null?n=this.mergeTxidOnly(e.txid):e._tx!=null&&(n==null||n.isTxidOnly)?n=this.mergeTransaction(e._tx):e._rawTx!=null&&(n==null||n.isTxidOnly)&&(n=this.mergeRawTx(e._rawTx)),n==null)throw new Error(`Failed to merge BeefTx for txid: ${e.txid}`);return n}mergeBeef(e){const n=Array.isArray(e)?eu.fromBinary(e):e;for(const r of n.bumps)this.mergeBump(r);for(const r of n.txs)this.mergeBeefTx(r)}isValid(e){return this.verifyValid(e).valid}async verify(e,n){const r=this.verifyValid(n);if(!r.valid)return!1;for(const t of Object.keys(r.roots))if(!await e.isValidRootForHeight(r.roots[t],Number(t)))return!1;return!0}verifyValid(e){const n={valid:!1,roots:{}},r=this.sortTxs();if(r.missingInputs.length>0||r.notValid.length>0||r.txidOnly.length>0&&e!==!0||r.withMissingInputs.length>0)return n;const t={};for(const a of this.txs)if(a.isTxidOnly){if(e!==!0)return n;t[a.txid]=!0}const s=(a,c)=>{const u=a.computeRoot(c);return(n.roots[a.blockHeight]===void 0||n.roots[a.blockHeight]==="")&&(n.roots[a.blockHeight]=u),n.roots[a.blockHeight]===u};for(const a of this.bumps)for(const c of a.path[0])if(c.txid===!0&&typeof c.hash=="string"&&c.hash.length>0&&(t[c.hash]=!0,!s(a,c.hash)))return n;for(const a of this.txs)if(a.bumpIndex!==void 0&&this.bumps[a.bumpIndex].path[0].find(u=>u.hash===a.txid)==null)return n;for(const a of this.txs){for(const c of a.inputTxids)if(!t[c])return n;t[a.txid]=!0}return n.valid=!0,n}toWriter(e){e.writeUInt32LE(this.version),e.writeVarIntNum(this.bumps.length);for(const n of this.bumps)e.write(n.toBinary());e.writeVarIntNum(this.txs.length);for(const n of this.txs)n.toWriter(e,this.version)}toBinary(){this.sortTxs();const e=new Ge;return this.toWriter(e),e.toArray()}toBinaryAtomic(e){this.sortTxs();const n=this.findTxid(e);if(n==null)throw new Error(`${e} does not exist in this Beef`);const r=this.txs[this.txs.length-1]===n?this:this.clone();if(r!==this){const s=this.txs.findIndex(a=>a.txid===e);r.txs.splice(s+1)}const t=new Ge;return t.writeUInt32LE(V2),t.writeReverse(_e(e,"hex")),r.toWriter(t),t.toArray()}toHex(){return Ue(this.toBinary())}static fromReader(e){let n=e.readUInt32LE(),r;if(n===V2&&(r=Ue(e.readReverse(32)),n=e.readUInt32LE()),n!==Tm&&n!==ru)throw new Error(`Serialized BEEF must start with ${Tm} or ${ru} but starts with ${n}`);const t=new eu(n),s=e.readVarIntNum();for(let c=0;c<s;c++){const u=ZM.fromReader(e,!1);t.bumps.push(u)}const a=e.readVarIntNum();for(let c=0;c<a;c++){const u=ep.fromReader(e,n);t.txs.push(u)}return t.atomicTxid=r,t}static fromBinary(e){const n=new un(e);return eu.fromReader(n)}static fromString(e,n="hex"){const r=_e(e,n),t=new un(r);return eu.fromReader(t)}tryToValidateBumpIndex(e){if(e.bumpIndex!==void 0)return!0;const n=e.txid;for(let r=0;r<this.bumps.length;r++){const t=this.bumps[r].path[0].findIndex(s=>s.hash===n);if(t>=0)return e.bumpIndex=r,this.bumps[r].path[0][t].txid=!0,!0}return!1}sortTxs(){const e={},n={};let r=[];const t=[],s=[];for(const h of this.txs)n[h.txid]=h,h.isValid=h.hasProof,h.isValid?(e[h.txid]=!0,t.push(h)):h.isTxidOnly&&h.inputTxids.length===0?(e[h.txid]=!0,s.push(h)):r.push(h);const a={},c=[],u=r;r=[];for(const h of u){let f=!1;for(const m of h.inputTxids)n[m]===void 0&&(a[m]=!0,f=!0);f?c.push(h):r.push(h)}for(;r.length>0;){const h=r;r=[];for(const f of h)f.inputTxids.every(m=>e[m])?(e[f.txid]=!0,t.push(f)):r.push(f);if(h.length===r.length)break}const l=r;return this.txs=c.concat(l).concat(s).concat(t),{missingInputs:Object.keys(a),notValid:l.map(h=>h.txid),valid:Object.keys(e),withMissingInputs:c.map(h=>h.txid),txidOnly:s.map(h=>h.txid)}}clone(){const e=new eu;return e.version=this.version,e.bumps=Array.from(this.bumps),e.txs=Array.from(this.txs),e}trimKnownTxids(e){for(let n=0;n<this.txs.length;){const r=this.txs[n];r.isTxidOnly&&e.includes(r.txid)?this.txs.splice(n,1):n++}}getValidTxids(){return this.sortTxs().valid}toLogString(){var r;let e="";e+=`BEEF with ${this.bumps.length} BUMPS and ${this.txs.length} Transactions, isValid ${this.isValid().toString()}
`;let n=-1;for(const t of this.bumps)n++,e+=`  BUMP ${n}
    block: ${t.blockHeight}
    txids: [
${t.path[0].filter(s=>s.txid===!0).map(s=>`      '${s.hash??""}'`).join(`,
`)}
    ]
`;n=-1;for(const t of this.txs)n++,e+=`  TX ${n}
    txid: ${t.txid}
`,t.bumpIndex!==void 0&&(e+=`    bumpIndex: ${t.bumpIndex}
`),t.isTxidOnly?e+=`    txidOnly
`:e+=`    rawTx length=${((r=t.rawTx)==null?void 0:r.length)??0}
`,t.inputTxids.length>0&&(e+=`    inputs: [
${t.inputTxids.map(s=>`      '${s}'`).join(`,
`)}
    ]
`);return e}addComputedLeaves(){const e=n=>Ue(ji(_e(n,"hex").reverse()).reverse());for(const n of this.bumps)for(let r=1;r<n.path.length;r++)for(const t of n.path[r-1])if(typeof t.hash=="string"&&(t.offset&1)===0){const s=n.path[r-1].find(c=>c.offset===t.offset+1),a=t.offset>>1;s!==void 0&&typeof s.hash=="string"&&n.path[r].every(c=>c.offset!==a)&&n.path[r].push({offset:a,hash:e(s.hash+t.hash)})}}},Fr=class lr{constructor(e=1,n=[],r=[],t=0,s=new Map,a){te(this,"version");te(this,"inputs");te(this,"outputs");te(this,"lockTime");te(this,"metadata");te(this,"merklePath");te(this,"cachedHash");this.version=e,this.inputs=n,this.outputs=r,this.lockTime=t,this.metadata=s,this.merklePath=a}static addPathOrInputs(e,n,r){if(typeof e.pathIndex=="number"){const t=r[e.pathIndex];if(typeof t!="object")throw new Error("Invalid merkle path index found in BEEF!");e.tx.merklePath=t}else for(const t of e.tx.inputs){if(t.sourceTXID===void 0)throw new Error("Input sourceTXID is undefined");const s=n[t.sourceTXID];if(typeof s!="object")throw new Error(`Reference to unknown TXID in BEEF: ${t.sourceTXID??"undefined"}`);t.sourceTransaction=s.tx,this.addPathOrInputs(s,n,r)}}static fromBEEF(e,n){const{tx:r}=lr.fromAnyBeef(e,n);return r}static fromAtomicBEEF(e){const{tx:n,txid:r,beef:t}=lr.fromAnyBeef(e);if(r!==t.atomicTxid)throw t.atomicTxid?new Error(`Transaction with TXID ${t.atomicTxid} not found in BEEF data.`):new Error("beef must conform to BRC-95 and must contain the subject txid.");return n}static fromAnyBeef(e,n){const r=JM.fromBinary(e);if(r.txs.length<1)throw new Error("beef must include at least one transaction.");const t=n||r.atomicTxid||r.txs.slice(-1)[0].txid,s=r.findAtomicTransaction(t);if(s==null)throw n?new Error(`Transaction with TXID ${t} not found in BEEF data.`):new Error("beef does not contain transaction for atomic txid.");return{tx:s,beef:r,txid:t}}static fromEF(e){const n=new un(e),r=n.readUInt32LE();if(Ue(n.read(6))!=="0000000000ef")throw new Error("Invalid EF marker");const t=n.readVarIntNum(),s=[];for(let l=0;l<t;l++){const h=Ue(n.readReverse(32)),f=n.readUInt32LE(),m=n.readVarIntNum(),d=n.read(m),y=a0.fromBinary(d),b=n.readUInt32LE(),g=n.readUInt64LEBn().toNumber(),v=n.readVarIntNum(),_=n.read(v),S=uu.fromBinary(_),I=new lr(void 0,[],[],void 0);I.outputs=Array(f+1).fill(null),I.outputs[f]={satoshis:g,lockingScript:S},s.push({sourceTransaction:I,sourceTXID:h,sourceOutputIndex:f,unlockingScript:y,sequence:b})}const a=n.readVarIntNum(),c=[];for(let l=0;l<a;l++){const h=n.readUInt64LEBn().toNumber(),f=n.readVarIntNum(),m=n.read(f),d=uu.fromBinary(m);c.push({satoshis:h,lockingScript:d})}const u=n.readUInt32LE();return new lr(r,s,c,u)}static parseScriptOffsets(e){const n=new un(e),r=[],t=[];n.pos+=4;const s=n.readVarIntNum();for(let c=0;c<s;c++){n.pos+=36;const u=n.readVarIntNum();r.push({vin:c,offset:n.pos,length:u}),n.pos+=u+4}const a=n.readVarIntNum();for(let c=0;c<a;c++){n.pos+=8;const u=n.readVarIntNum();t.push({vout:c,offset:n.pos,length:u}),n.pos+=u}return{inputs:r,outputs:t}}static fromReader(e){const n=e.readUInt32LE(),r=e.readVarIntNum(),t=[];for(let u=0;u<r;u++){const l=Ue(e.readReverse(32)),h=e.readUInt32LE(),f=e.readVarIntNum(),m=e.read(f),d=a0.fromBinary(m),y=e.readUInt32LE();t.push({sourceTXID:l,sourceOutputIndex:h,unlockingScript:d,sequence:y})}const s=e.readVarIntNum(),a=[];for(let u=0;u<s;u++){const l=e.readUInt64LEBn().toNumber(),h=e.readVarIntNum(),f=e.read(h),m=uu.fromBinary(f);a.push({satoshis:l,lockingScript:m})}const c=e.readUInt32LE();return new lr(n,t,a,c)}static fromBinary(e){const n=new un(e);return lr.fromReader(n)}static fromHex(e){return lr.fromBinary(_e(e,"hex"))}static fromHexEF(e){return lr.fromEF(_e(e,"hex"))}static fromHexBEEF(e,n){return lr.fromBEEF(_e(e,"hex"),n)}addInput(e){if(typeof e.sourceTXID>"u"&&typeof e.sourceTransaction>"u")throw new Error("A reference to an an input transaction is required. If the input transaction itself cannot be referenced, its TXID must still be provided.");typeof e.sequence>"u"&&(e.sequence=4294967295),this.cachedHash=void 0,this.inputs.push(e)}addOutput(e){if(this.cachedHash=void 0,e.change!==!0){if(typeof e.satoshis>"u")throw new Error("either satoshis must be defined or change must be set to true");if(e.satoshis<0)throw new Error("satoshis must be a positive integer or zero")}if(e.lockingScript==null)throw new Error("lockingScript must be defined");this.outputs.push(e)}addP2PKHOutput(e,n){const r=new VM().lock(e);if(typeof n>"u")return this.addOutput({lockingScript:r,change:!0});this.addOutput({lockingScript:r,satoshis:n})}updateMetadata(e){this.metadata={...this.metadata,...e}}async fee(e=new WM(1),n="equal"){if(this.cachedHash=void 0,typeof e=="number"){const s=e;e={computeFee:async()=>s}}const r=await e.computeFee(this),t=this.calculateChange(r);if(t<=0){this.outputs=this.outputs.filter(s=>s.change!==!0);return}this.distributeChange(t,n)}calculateChange(e){let n=0;for(const r of this.inputs){if(typeof r.sourceTransaction!="object")throw new Error("Source transactions are required for all inputs during fee computation");n+=r.sourceTransaction.outputs[r.sourceOutputIndex].satoshis??0}n-=e;for(const r of this.outputs)r.change!==!0&&r.satoshis!==void 0&&(n-=r.satoshis);return n}distributeChange(e,n){let r=0;const t=this.outputs.filter(s=>s.change);if(n==="random"?r=this.distributeRandomChange(e,t):n==="equal"&&(r=this.distributeEqualChange(e,t)),r<e){const s=this.outputs[this.outputs.length-1];s.satoshis!==void 0?s.satoshis+=e-r:s.satoshis=e-r}}distributeRandomChange(e,n){let r=0,t=e;const s=Array(n.length).fill(1);t-=n.length,r+=n.length;for(let a=0;a<n.length-1;a++){const c=this.benfordNumber(0,t);s[a]=s[a]+c,r+=c,t-=c}for(const a of this.outputs)a.change===!0&&(a.satoshis=s.shift());return r}distributeEqualChange(e,n){let r=0;const t=Math.floor(e/n.length);for(const s of n)r+=t,s.satoshis=t;return r}benfordNumber(e,n){const r=Math.floor(Math.random()*9)+1;return Math.floor(e+(n-e)*Math.log10(1+1/r)/Math.log10(10))}getFee(){let e=0;for(const r of this.inputs){if(typeof r.sourceTransaction!="object")throw new Error("Source transactions or sourceSatoshis are required for all inputs to calculate fee");e+=r.sourceTransaction.outputs[r.sourceOutputIndex].satoshis??0}let n=0;for(const r of this.outputs)n+=r.satoshis??0;return e-n}async sign(){this.cachedHash=void 0;for(const n of this.outputs)if(typeof n.satoshis>"u")throw n.change===!0?new Error("There are still change outputs with uncomputed amounts. Use the fee() method to compute the change amounts and transaction fees prior to signing."):new Error("One or more transaction outputs is missing an amount. Ensure all output amounts are provided before signing.");const e=await Promise.all(this.inputs.map(async(n,r)=>{var t,s;return typeof this.inputs[r].unlockingScriptTemplate=="object"?await((s=(t=this.inputs[r])==null?void 0:t.unlockingScriptTemplate)==null?void 0:s.sign(this,r)):await Promise.resolve(void 0)}));for(let n=0,r=this.inputs.length;n<r;n++)typeof this.inputs[n].unlockingScriptTemplate=="object"&&(this.inputs[n].unlockingScript=e[n])}async broadcast(e=XM()){return await e.broadcast(this)}toBinary(){const e=new Ge;e.writeUInt32LE(this.version),e.writeVarIntNum(this.inputs.length);for(const n of this.inputs){if(typeof n.sourceTXID>"u")if(n.sourceTransaction!=null)e.write(n.sourceTransaction.hash());else throw new Error("sourceTransaction is undefined");else e.writeReverse(_e(n.sourceTXID,"hex"));if(e.writeUInt32LE(n.sourceOutputIndex),n.unlockingScript==null)throw new Error("unlockingScript is undefined");const r=n.unlockingScript.toBinary();e.writeVarIntNum(r.length),e.write(r),e.writeUInt32LE(n.sequence??0)}e.writeVarIntNum(this.outputs.length);for(const n of this.outputs){e.writeUInt64LE(n.satoshis??0);const r=n.lockingScript.toBinary();e.writeVarIntNum(r.length),e.write(r)}return e.writeUInt32LE(this.lockTime),e.toArray()}toEF(){const e=new Ge;e.writeUInt32LE(this.version),e.write([0,0,0,0,0,239]),e.writeVarIntNum(this.inputs.length);for(const n of this.inputs){if(typeof n.sourceTransaction>"u")throw new Error("All inputs must have source transactions when serializing to EF format");if(typeof n.sourceTXID>"u"?e.write(n.sourceTransaction.hash()):e.write(_e(n.sourceTXID,"hex").reverse()),e.writeUInt32LE(n.sourceOutputIndex),n.unlockingScript==null)throw new Error("unlockingScript is undefined");const r=n.unlockingScript.toBinary();e.writeVarIntNum(r.length),e.write(r),e.writeUInt32LE(n.sequence??0),e.writeUInt64LE(n.sourceTransaction.outputs[n.sourceOutputIndex].satoshis??0);const t=n.sourceTransaction.outputs[n.sourceOutputIndex].lockingScript.toBinary();e.writeVarIntNum(t.length),e.write(t)}e.writeVarIntNum(this.outputs.length);for(const n of this.outputs){e.writeUInt64LE(n.satoshis??0);const r=n.lockingScript.toBinary();e.writeVarIntNum(r.length),e.write(r)}return e.writeUInt32LE(this.lockTime),e.toArray()}toHexEF(){return Ue(this.toEF())}toHex(){return Ue(this.toBinary())}toHexBEEF(){return Ue(this.toBEEF())}toHexAtomicBEEF(){return Ue(this.toAtomicBEEF())}hash(e){let n;return this.cachedHash!=null?n=this.cachedHash:(n=ji(this.toBinary()),this.cachedHash=n),e==="hex"?Ue(n):n}id(e){const n=[...this.hash()];return n.reverse(),e==="hex"?Ue(n):n}async verify(e=QM(),n,r){const t=new Set,s=[this];for(;s.length>0;){const a=s.shift(),c=(a==null?void 0:a.id("hex"))??"";if(c!=null&&c!==""&&t.has(c))continue;if(typeof(a==null?void 0:a.merklePath)=="object"){if(e==="scripts only"){c!=null&&t.add(c);continue}else if(await a.merklePath.verify(c,e)){t.add(c);continue}}if(typeof n<"u"){if(a===void 0)throw new Error("Transaction is undefined");const h=lr.fromEF(a.toEF());if(delete h.outputs[0].satoshis,h.outputs[0].change=!0,await h.fee(n),a.getFee()<h.getFee())throw new Error(`Verification failed because the transaction ${c} has an insufficient fee and has not been mined.`)}let u=0;if(a===void 0)throw new Error("Transaction is undefined");for(let h=0;h<a.inputs.length;h++){const f=a.inputs[h];if(typeof f.sourceTransaction!="object")throw new Error(`Verification failed because the input at index ${h} of transaction ${c} is missing an associated source transaction. This source transaction is required for transaction verification because there is no merkle proof for the transaction spending a UTXO it contains.`);if(typeof f.unlockingScript!="object")throw new Error(`Verification failed because the input at index ${h} of transaction ${c} is missing an associated unlocking script. This script is required for transaction verification because there is no merkle proof for the transaction spending the UTXO.`);const m=f.sourceTransaction.outputs[f.sourceOutputIndex];u+=m.satoshis??0;const d=f.sourceTransaction.id("hex");t.has(d)||s.push(f.sourceTransaction);const y=a.inputs.filter((v,_)=>_!==h);if(typeof f.sourceTXID>"u"&&(f.sourceTXID=d),!new jM({sourceTXID:f.sourceTXID,sourceOutputIndex:f.sourceOutputIndex,lockingScript:m.lockingScript,sourceSatoshis:m.satoshis??0,transactionVersion:a.version,otherInputs:y,unlockingScript:f.unlockingScript,inputSequence:f.sequence??0,inputIndex:h,outputs:a.outputs,lockTime:a.lockTime,memoryLimit:r}).validate())return!1}let l=0;for(const h of a.outputs){if(typeof h.satoshis!="number")throw new Error("Every output must have a defined amount during transaction verification.");l+=h.satoshis}if(l>u)return!1;t.add(c)}return!0}toBEEF(e){const n=new Ge;n.writeUInt32LE(Tm);const r=[],t=[],s=a=>{const c={tx:a},u=typeof a.merklePath=="object";if(u){let h=!1;for(let f=0;f<r.length;f++){if(r[f]===a.merklePath){c.pathIndex=f,h=!0;break}if(a.merklePath!==null&&a.merklePath!==void 0&&r[f].blockHeight===a.merklePath.blockHeight){const m=r[f].computeRoot(),d=a.merklePath.computeRoot();if(m===d){r[f].combine(a.merklePath),c.pathIndex=f,h=!0;break}}}h||(c.pathIndex=r.length,a.merklePath!==null&&a.merklePath!==void 0&&r.push(a.merklePath))}if(t.some(h=>h.tx.id("hex")===a.id("hex"))||t.unshift(c),!u)for(let h=0;h<a.inputs.length;h++){const f=a.inputs[h];if(typeof f.sourceTransaction=="object")s(f.sourceTransaction);else if(e===!1)throw new Error("A required source transaction is missing!")}};s(this),n.writeVarIntNum(r.length);for(const a of r)n.write(a.toBinary());n.writeVarIntNum(t.length);for(const a of t)n.write(a.tx.toBinary()),typeof a.pathIndex=="number"?(n.writeUInt8(1),n.writeVarIntNum(a.pathIndex)):n.writeUInt8(0);return n.toArray()}toAtomicBEEF(e){const n=new Ge;n.writeUInt32LE(16843009),n.write(this.hash());const r=this.toBEEF(e);return n.write(r),n.toArray()}};var km;(function(i){i[i.Silent=0]="Silent",i[i.App=1]="App",i[i.Counterparty=2]="Counterparty"})(km||(km={}));let y6=class{constructor(e){te(this,"rootKey");te(this,"identityKey");e==="anyone"?this.rootKey=new Lr(1):this.rootKey=e,this.identityKey=this.rootKey.toPublicKey().toString()}derivePublicKey(e,n,r,t=!1){return r=this.normalizeCounterparty(r),t?this.rootKey.deriveChild(r,this.computeInvoiceNumber(e,n)).toPublicKey():r.deriveChild(this.rootKey,this.computeInvoiceNumber(e,n))}derivePrivateKey(e,n,r){return r=this.normalizeCounterparty(r),this.rootKey.deriveChild(r,this.computeInvoiceNumber(e,n))}deriveSymmetricKey(e,n,r){var a,c;r==="anyone"&&(r=new Lr(1).toPublicKey()),r=this.normalizeCounterparty(r);const t=this.derivePublicKey(e,n,r),s=this.derivePrivateKey(e,n,r);return new CM(((c=(a=s.deriveSharedSecret(t))==null?void 0:a.x)==null?void 0:c.toArray())??[])}revealCounterpartySecret(e){if(e==="self")throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");e=this.normalizeCounterparty(e);const n=this.rootKey.toPublicKey(),r=this.rootKey.deriveChild(n,"test").toHex(),t=this.rootKey.deriveChild(e,"test").toHex();if(r===t)throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");return this.rootKey.deriveSharedSecret(e).encode(!0)}revealSpecificSecret(e,n,r){e=this.normalizeCounterparty(e);const t=this.rootKey.deriveSharedSecret(e),s=_e(this.computeInvoiceNumber(n,r),"utf8");return pf(t.encode(!0),s)}normalizeCounterparty(e){if(e==null)throw new Error("counterparty must be self, anyone or a public key!");return e==="self"?this.rootKey.toPublicKey():e==="anyone"?new Lr(1).toPublicKey():typeof e=="string"?fs.fromString(e):e}computeInvoiceNumber(e,n){const r=e[0];if(!Number.isInteger(r)||r<0||r>2)throw new Error("Protocol security level must be 0, 1, or 2");const t=e[1].toLowerCase().trim();if(n.length>800)throw new Error("Key IDs must be 800 characters or less");if(n.length<1)throw new Error("Key IDs must be 1 character or more");if(t.length>400)if(t.startsWith("specific linkage revelation ")){if(t.length>430)throw new Error("Specific linkage revelation protocol names must be 430 characters or less")}else throw new Error("Protocol names must be 400 characters or less");if(t.length<5)throw new Error("Protocol names must be 5 characters or more");if(t.includes("  "))throw new Error('Protocol names cannot contain multiple consecutive spaces ("  ")');if(!/^[a-z0-9 ]+$/g.test(t))throw new Error("Protocol names can only contain letters, numbers and spaces");if(t.endsWith(" protocol"))throw new Error('No need to end your protocol name with " protocol"');return`${r}-${t}-${n}`}},g6=class{constructor(e){te(this,"keyDeriver");typeof e.identityKey!="string"&&(e=new y6(e)),this.keyDeriver=e}async getPublicKey(e){if(e.identityKey){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(e.protocolID==null||e.keyID==null||e.keyID==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");return{publicKey:(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(e.protocolID,e.keyID,e.counterparty??"self",e.forSelf).toString()}}}async revealCounterpartyKeyLinkage(e){const{publicKey:n}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const r=this.keyDeriver.revealCounterpartySecret(e.counterparty),t=new MM().generateProof(this.keyDeriver.rootKey,this.keyDeriver.rootKey.toPublicKey(),fs.fromString(e.counterparty),ka.fromDER(r)),s=[...t.R.encode(!0),...t.SPrime.encode(!0),...t.z.toArray()],a=new Date().toISOString(),{ciphertext:c}=await this.encrypt({plaintext:r,protocolID:[2,"counterparty linkage revelation"],keyID:a,counterparty:e.verifier}),{ciphertext:u}=await this.encrypt({plaintext:s,protocolID:[2,"counterparty linkage revelation"],keyID:a,counterparty:e.verifier});return{prover:n,verifier:e.verifier,counterparty:e.counterparty,revelationTime:a,encryptedLinkage:c,encryptedLinkageProof:u}}async revealSpecificKeyLinkage(e){const{publicKey:n}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const r=this.keyDeriver.revealSpecificSecret(e.counterparty,e.protocolID,e.keyID),{ciphertext:t}=await this.encrypt({plaintext:r,protocolID:[2,`specific linkage revelation ${e.protocolID[0]} ${e.protocolID[1]}`],keyID:e.keyID,counterparty:e.verifier}),{ciphertext:s}=await this.encrypt({plaintext:[0],protocolID:[2,`specific linkage revelation ${e.protocolID[0]} ${e.protocolID[1]}`],keyID:e.keyID,counterparty:e.verifier});return{prover:n,verifier:e.verifier,counterparty:e.counterparty,protocolID:e.protocolID,keyID:e.keyID,encryptedLinkage:t,encryptedLinkageProof:s,proofType:0}}async encrypt(e){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{ciphertext:this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,e.counterparty??"self").encrypt(e.plaintext)}}async decrypt(e){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{plaintext:this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,e.counterparty??"self").decrypt(e.ciphertext)}}async createHmac(e){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const n=this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,e.counterparty??"self");return{hmac:pf(n.toArray(),e.data)}}async verifyHmac(e){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const n=this.keyDeriver.deriveSymmetricKey(e.protocolID,e.keyID,e.counterparty??"self"),r=pf(n.toArray(),e.data).toString()===e.hmac.toString();if(!r){const t=new Error("HMAC is not valid");throw t.code="ERR_INVALID_HMAC",t}return{valid:r}}async createSignature(e){if(e.hashToDirectlySign==null&&e.data==null)throw new Error("args.data or args.hashToDirectlySign must be valid");const n=e.hashToDirectlySign??Wi(e.data??[]),t=(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePrivateKey(e.protocolID,e.keyID,e.counterparty??"anyone");return{signature:d6(new ie(n),t,!0).toDER()}}async verifySignature(e){if(e.hashToDirectlyVerify==null&&e.data==null)throw new Error("args.data or args.hashToDirectlyVerify must be valid");const n=e.hashToDirectlyVerify??Wi(e.data??[]),t=(this.keyDeriver??(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(e.protocolID,e.keyID,e.counterparty??"self",e.forSelf),s=kf(new ie(n),gs.fromDER(e.signature),t);if(!s){const a=new Error("Signature is not valid");throw a.code="ERR_INVALID_SIGNATURE",a}return{valid:s}}};class K2{constructor(){te(this,"CWI");if(typeof window!="object")throw new Error("The window.CWI substrate requires a global window object.");if(typeof window.CWI!="object")throw new Error("The window.CWI interface does not appear to be bound to the window object.");this.CWI=window.CWI}async createAction(e,n){return await this.CWI.createAction(e,n)}async signAction(e,n){return await this.CWI.signAction(e,n)}async abortAction(e,n){return await this.CWI.abortAction(e,n)}async listActions(e,n){return await this.CWI.listActions(e,n)}async internalizeAction(e,n){return await this.CWI.internalizeAction(e,n)}async listOutputs(e,n){return await this.CWI.listOutputs(e,n)}async relinquishOutput(e,n){return await this.CWI.relinquishOutput(e,n)}async getPublicKey(e,n){return await this.CWI.getPublicKey(e,n)}async revealCounterpartyKeyLinkage(e,n){return await this.CWI.revealCounterpartyKeyLinkage(e,n)}async revealSpecificKeyLinkage(e,n){return await this.CWI.revealSpecificKeyLinkage(e,n)}async encrypt(e,n){return await this.CWI.encrypt(e,n)}async decrypt(e,n){return await this.CWI.decrypt(e,n)}async createHmac(e,n){return await this.CWI.createHmac(e,n)}async verifyHmac(e,n){return await this.CWI.verifyHmac(e,n)}async createSignature(e,n){return await this.CWI.createSignature(e,n)}async verifySignature(e,n){return await this.CWI.verifySignature(e,n)}async acquireCertificate(e,n){return await this.CWI.acquireCertificate(e,n)}async listCertificates(e,n){return await this.CWI.listCertificates(e,n)}async proveCertificate(e,n){return await this.CWI.proveCertificate(e,n)}async relinquishCertificate(e,n){return await this.CWI.relinquishCertificate(e,n)}async discoverByIdentityKey(e,n){return await this.CWI.discoverByIdentityKey(e,n)}async discoverByAttributes(e,n){return await this.CWI.discoverByAttributes(e,n)}async isAuthenticated(e,n){return await this.CWI.isAuthenticated(e,n)}async waitForAuthentication(e,n){return await this.CWI.waitForAuthentication(e,n)}async getHeight(e,n){return await this.CWI.getHeight(e,n)}async getHeaderForHeight(e,n){return await this.CWI.getHeaderForHeight(e,n)}async getNetwork(e,n){return await this.CWI.getNetwork(e,n)}async getVersion(e,n){return await this.CWI.getVersion(e,n)}}let xw=class extends Error{constructor(n,r=1,t){super(n);te(this,"code");te(this,"isError",!0);this.code=r,this.name=this.constructor.name,t!=null&&t!==""?this.stack=t:Error.captureStackTrace(this,this.constructor)}};var W2;(function(i){i[i.unknownError=1]="unknownError",i[i.unsupportedAction=2]="unsupportedAction",i[i.invalidHmac=3]="invalidHmac",i[i.invalidSignature=4]="invalidSignature",i[i.reviewActions=5]="reviewActions"})(W2||(W2={}));class $2{constructor(e="*"){te(this,"domain");if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(typeof window.postMessage!="function")throw new Error("The window object does not seem to support postMessage calls.");this.domain=e}async invoke(e,n){return await new Promise((r,t)=>{const s=Pa(Ra(12)),a=c=>{if(!(c.data.type!=="CWI"||!c.isTrusted||c.data.id!==s||c.data.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",a),c.data.status==="error"){const u=new xw(c.data.description,c.data.code);t(u)}else r(c.data.result)};window.addEventListener("message",a),window.parent.postMessage({type:"CWI",isInvocation:!0,id:s,call:e,args:n},this.domain)})}async createAction(e){return await this.invoke("createAction",e)}async signAction(e){return await this.invoke("signAction",e)}async abortAction(e){return await this.invoke("abortAction",e)}async listActions(e){return await this.invoke("listActions",e)}async internalizeAction(e){return await this.invoke("internalizeAction",e)}async listOutputs(e){return await this.invoke("listOutputs",e)}async relinquishOutput(e){return await this.invoke("relinquishOutput",e)}async getPublicKey(e){return await this.invoke("getPublicKey",e)}async revealCounterpartyKeyLinkage(e){return await this.invoke("revealCounterpartyKeyLinkage",e)}async revealSpecificKeyLinkage(e){return await this.invoke("revealSpecificKeyLinkage",e)}async encrypt(e){return await this.invoke("encrypt",e)}async decrypt(e){return await this.invoke("decrypt",e)}async createHmac(e){return await this.invoke("createHmac",e)}async verifyHmac(e){return await this.invoke("verifyHmac",e)}async createSignature(e){return await this.invoke("createSignature",e)}async verifySignature(e){return await this.invoke("verifySignature",e)}async acquireCertificate(e){return await this.invoke("acquireCertificate",e)}async listCertificates(e){return await this.invoke("listCertificates",e)}async proveCertificate(e){return await this.invoke("proveCertificate",e)}async relinquishCertificate(e){return await this.invoke("relinquishCertificate",e)}async discoverByIdentityKey(e){return await this.invoke("discoverByIdentityKey",e)}async discoverByAttributes(e){return await this.invoke("discoverByAttributes",e)}async isAuthenticated(e){return await this.invoke("isAuthenticated",e)}async waitForAuthentication(e){return await this.invoke("waitForAuthentication",e)}async getHeight(e){return await this.invoke("getHeight",e)}async getHeaderForHeight(e){return await this.invoke("getHeaderForHeight",e)}async getNetwork(e){return await this.invoke("getNetwork",e)}async getVersion(e){return await this.invoke("getVersion",e)}}let bb=class b6{constructor(e,n,r,t,s,a,c){te(this,"type");te(this,"serialNumber");te(this,"subject");te(this,"certifier");te(this,"revocationOutpoint");te(this,"fields");te(this,"signature");this.type=e,this.serialNumber=n,this.subject=r,this.certifier=t,this.revocationOutpoint=s,this.fields=a,this.signature=c}toBinary(e=!0){const n=new Ge,r=_e(this.type,"base64");n.write(r);const t=_e(this.serialNumber,"base64");n.write(t);const s=_e(this.subject,"hex");n.write(s);const a=_e(this.certifier,"hex");n.write(a);const[c,u]=this.revocationOutpoint.split("."),l=_e(c,"hex");n.write(l),n.writeVarIntNum(Number(u));const h=Object.keys(this.fields).sort();n.writeVarIntNum(h.length);for(const f of h){const m=this.fields[f],d=_e(f,"utf8");n.writeVarIntNum(d.length),n.write(d);const y=_e(m,"utf8");n.writeVarIntNum(y.length),n.write(y)}if(e&&(this.signature??"").length>0){const f=_e(this.signature,"hex");n.write(f)}return n.toArray()}static fromBinary(e){const n=new un(e),r=n.read(32),t=Pa(r),s=n.read(32),a=Pa(s),c=n.read(33),u=Ue(c),l=n.read(33),h=Ue(l),f=n.read(32),m=Ue(f),d=n.readVarIntNum(),y=`${m}.${d}`,b=n.readVarIntNum(),g={};for(let _=0;_<b;_++){const S=n.readVarIntNum(),I=n.read(S),A=Mt(I),R=n.readVarIntNum(),E=n.read(R),k=Mt(E);g[A]=k}let v;if(!n.eof()){const _=n.read();v=gs.fromDER(_).toString("hex")}return new b6(t,a,u,h,y,g,v)}async verify(){const e=new g6("anyone"),n=this.toBinary(!1),r=this.signature??"",{valid:t}=await e.verifySignature({signature:_e(r,"hex"),data:n,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`,counterparty:this.certifier});return t}async sign(e){if(this.signature!=null&&this.signature.length>0)throw new Error(`Certificate has already been signed! Signature present: ${this.signature}`);this.certifier=(await e.getPublicKey({identityKey:!0})).publicKey;const n=this.toBinary(!1),{signature:r}=await e.createSignature({data:n,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`});this.signature=Ue(r)}static getCertificateFieldEncryptionDetails(e,n){return{protocolID:[2,"certificate field encryption"],keyID:n?`${n} ${e}`:e}}};var Em;(function(i){i[i.createAction=1]="createAction",i[i.signAction=2]="signAction",i[i.abortAction=3]="abortAction",i[i.listActions=4]="listActions",i[i.internalizeAction=5]="internalizeAction",i[i.listOutputs=6]="listOutputs",i[i.relinquishOutput=7]="relinquishOutput",i[i.getPublicKey=8]="getPublicKey",i[i.revealCounterpartyKeyLinkage=9]="revealCounterpartyKeyLinkage",i[i.revealSpecificKeyLinkage=10]="revealSpecificKeyLinkage",i[i.encrypt=11]="encrypt",i[i.decrypt=12]="decrypt",i[i.createHmac=13]="createHmac",i[i.verifyHmac=14]="verifyHmac",i[i.createSignature=15]="createSignature",i[i.verifySignature=16]="verifySignature",i[i.acquireCertificate=17]="acquireCertificate",i[i.listCertificates=18]="listCertificates",i[i.proveCertificate=19]="proveCertificate",i[i.relinquishCertificate=20]="relinquishCertificate",i[i.discoverByIdentityKey=21]="discoverByIdentityKey",i[i.discoverByAttributes=22]="discoverByAttributes",i[i.isAuthenticated=23]="isAuthenticated",i[i.waitForAuthentication=24]="waitForAuthentication",i[i.getHeight=25]="getHeight",i[i.getHeaderForHeight=26]="getHeaderForHeight",i[i.getNetwork=27]="getNetwork",i[i.getVersion=28]="getVersion"})(Em||(Em={}));const m6=Em;let z2=class{constructor(e){te(this,"wire");this.wire=e}async transmit(e,n="",r=[]){const t=new Ge;t.writeUInt8(m6[e]);const s=_e(n,"utf8");t.writeUInt8(s.length),t.write(s),r.length>0&&t.write(r);const a=t.toArray(),c=await this.wire.transmitToWallet(a),u=new un(c),l=u.readUInt8();if(l===0)return u.read();{const h=u.readVarIntNum(),f=u.read(h),m=Mt(f),d=u.readVarIntNum(),y=u.read(d),b=Mt(y);throw new xw(m,l,b)}}async createAction(e,n){const r=new Ge,t=_e(e.description,"utf8");if(r.writeVarIntNum(t.length),r.write(t),e.inputBEEF!=null?(r.writeVarIntNum(e.inputBEEF.length),r.write(e.inputBEEF)):r.writeVarIntNum(-1),e.inputs!=null){r.writeVarIntNum(e.inputs.length);for(const d of e.inputs){if(r.write(this.encodeOutpoint(d.outpoint)),d.unlockingScript!=null&&d.unlockingScript!==""){const b=_e(d.unlockingScript,"hex");r.writeVarIntNum(b.length),r.write(b)}else r.writeVarIntNum(-1),r.writeVarIntNum(d.unlockingScriptLength??0);const y=_e(d.inputDescription,"utf8");r.writeVarIntNum(y.length),r.write(y),typeof d.sequenceNumber=="number"?r.writeVarIntNum(d.sequenceNumber):r.writeVarIntNum(-1)}}else r.writeVarIntNum(-1);if(e.outputs!=null){r.writeVarIntNum(e.outputs.length);for(const d of e.outputs){const y=_e(d.lockingScript,"hex");r.writeVarIntNum(y.length),r.write(y),r.writeVarIntNum(d.satoshis);const b=_e(d.outputDescription,"utf8");if(r.writeVarIntNum(b.length),r.write(b),d.basket!=null&&d.basket!==""){const g=_e(d.basket,"utf8");r.writeVarIntNum(g.length),r.write(g)}else r.writeVarIntNum(-1);if(d.customInstructions!=null&&d.customInstructions!==""){const g=_e(d.customInstructions,"utf8");r.writeVarIntNum(g.length),r.write(g)}else r.writeVarIntNum(-1);if(d.tags!=null){r.writeVarIntNum(d.tags.length);for(const g of d.tags){const v=_e(g,"utf8");r.writeVarIntNum(v.length),r.write(v)}}else r.writeVarIntNum(-1)}}else r.writeVarIntNum(-1);if(typeof e.lockTime=="number"?r.writeVarIntNum(e.lockTime):r.writeVarIntNum(-1),typeof e.version=="number"?r.writeVarIntNum(e.version):r.writeVarIntNum(-1),e.labels!=null){r.writeVarIntNum(e.labels.length);for(const d of e.labels){const y=_e(d,"utf8");r.writeVarIntNum(y.length),r.write(y)}}else r.writeVarIntNum(-1);if(e.options!=null){if(r.writeInt8(1),typeof e.options.signAndProcess=="boolean"?r.writeInt8(e.options.signAndProcess?1:0):r.writeInt8(-1),typeof e.options.acceptDelayedBroadcast=="boolean"?r.writeInt8(e.options.acceptDelayedBroadcast?1:0):r.writeInt8(-1),e.options.trustSelf==="known"?r.writeInt8(1):r.writeInt8(-1),e.options.knownTxids!=null){r.writeVarIntNum(e.options.knownTxids.length);for(const d of e.options.knownTxids){const y=_e(d,"hex");r.write(y)}}else r.writeVarIntNum(-1);if(typeof e.options.returnTXIDOnly=="boolean"?r.writeInt8(e.options.returnTXIDOnly?1:0):r.writeInt8(-1),typeof e.options.noSend=="boolean"?r.writeInt8(e.options.noSend?1:0):r.writeInt8(-1),e.options.noSendChange!=null){r.writeVarIntNum(e.options.noSendChange.length);for(const d of e.options.noSendChange)r.write(this.encodeOutpoint(d))}else r.writeVarIntNum(-1);if(e.options.sendWith!=null){r.writeVarIntNum(e.options.sendWith.length);for(const d of e.options.sendWith){const y=_e(d,"hex");r.write(y)}}else r.writeVarIntNum(-1);typeof e.options.randomizeOutputs=="boolean"?r.writeInt8(e.options.randomizeOutputs?1:0):r.writeInt8(-1)}else r.writeInt8(0);const s=await this.transmit("createAction",n,r.toArray()),a=new un(s),c={};if(a.readInt8()===1){const d=a.read(32);c.txid=Ue(d)}if(a.readInt8()===1){const d=a.readVarIntNum();c.tx=a.read(d)}const h=a.readVarIntNum();if(h>=0){c.noSendChange=[];for(let d=0;d<h;d++){const y=this.readOutpoint(a);c.noSendChange.push(y)}}const f=a.readVarIntNum();if(f>=0){c.sendWithResults=[];for(let d=0;d<f;d++){const y=a.read(32),b=Ue(y),g=a.readInt8();let v="unproven";g===1?v="unproven":g===2?v="sending":g===3&&(v="failed"),c.sendWithResults.push({txid:b,status:v})}}if(a.readInt8()===1){const d=a.readVarIntNum(),y=a.read(d),b=a.readVarIntNum(),g=a.read(b);c.signableTransaction={tx:y,reference:Pa(g)}}return c}async signAction(e,n){const r=new Ge,t=Object.keys(e.spends);r.writeVarIntNum(t.length);for(const m of t){r.writeVarIntNum(Number(m));const d=e.spends[Number(m)],y=_e(d.unlockingScript,"hex");r.writeVarIntNum(y.length),r.write(y),typeof d.sequenceNumber=="number"?r.writeVarIntNum(d.sequenceNumber):r.writeVarIntNum(-1)}const s=_e(e.reference,"base64");if(r.writeVarIntNum(s.length),r.write(s),e.options!=null)if(r.writeInt8(1),typeof e.options.acceptDelayedBroadcast=="boolean"?r.writeInt8(e.options.acceptDelayedBroadcast?1:0):r.writeInt8(-1),typeof e.options.returnTXIDOnly=="boolean"?r.writeInt8(e.options.returnTXIDOnly?1:0):r.writeInt8(-1),typeof e.options.noSend=="boolean"?r.writeInt8(e.options.noSend?1:0):r.writeInt8(-1),e.options.sendWith!=null){r.writeVarIntNum(e.options.sendWith.length);for(const m of e.options.sendWith){const d=_e(m,"hex");r.write(d)}}else r.writeVarIntNum(-1);else r.writeInt8(0);const a=await this.transmit("signAction",n,r.toArray()),c=new un(a),u={};if(c.readInt8()===1){const m=c.read(32);u.txid=Ue(m)}if(c.readInt8()===1){const m=c.readVarIntNum();u.tx=c.read(m)}const f=c.readVarIntNum();if(f>=0){u.sendWithResults=[];for(let m=0;m<f;m++){const d=c.read(32),y=Ue(d),b=c.readInt8();let g="unproven";b===1?g="unproven":b===2?g="sending":b===3&&(g="failed"),u.sendWithResults.push({txid:y,status:g})}}return u}async abortAction(e,n){return await this.transmit("abortAction",n,_e(e.reference,"base64")),{aborted:!0}}async listActions(e,n){const r=new Ge;r.writeVarIntNum(e.labels.length);for(const l of e.labels){const h=_e(l,"utf8");r.writeVarIntNum(h.length),r.write(h)}e.labelQueryMode==="any"?r.writeInt8(1):e.labelQueryMode==="all"?r.writeInt8(2):r.writeInt8(-1);const t=[e.includeLabels,e.includeInputs,e.includeInputSourceLockingScripts,e.includeInputUnlockingScripts,e.includeOutputs,e.includeOutputLockingScripts];for(const l of t)typeof l=="boolean"?r.writeInt8(l?1:0):r.writeInt8(-1);typeof e.limit=="number"?r.writeVarIntNum(e.limit):r.writeVarIntNum(-1),typeof e.offset=="number"?r.writeVarIntNum(e.offset):r.writeVarIntNum(-1),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1);const s=await this.transmit("listActions",n,r.toArray()),a=new un(s),c=a.readVarIntNum(),u=[];for(let l=0;l<c;l++){const h=a.read(32),f=Ue(h),m=a.readVarIntNum(),d=a.readInt8();let y;switch(d){case 1:y="completed";break;case 2:y="unprocessed";break;case 3:y="sending";break;case 4:y="unproven";break;case 5:y="unsigned";break;case 6:y="nosend";break;case 7:y="nonfinal";break;case 8:y="failed";break;default:throw new Error(`Unknown status code: ${d}`)}const b=a.readInt8()===1,g=a.readVarIntNum(),v=a.read(g),_=Mt(v),S={txid:f,satoshis:m,status:y,isOutgoing:b,description:_,version:0,lockTime:0},I=a.readVarIntNum();if(I>=0){S.labels=[];for(let E=0;E<I;E++){const k=a.readVarIntNum(),P=a.read(k);S.labels.push(Mt(P))}}S.version=a.readVarIntNum(),S.lockTime=a.readVarIntNum();const A=a.readVarIntNum();if(A>=0){S.inputs=[];for(let E=0;E<A;E++){const k=this.readOutpoint(a),P=a.readVarIntNum(),T=a.readVarIntNum();let M;if(T>=0){const K=a.read(T);M=Ue(K)}const C=a.readVarIntNum();let D;if(C>=0){const K=a.read(C);D=Ue(K)}const F=a.readVarIntNum(),B=a.read(F),L=Mt(B),q=a.readVarIntNum();S.inputs.push({sourceOutpoint:k,sourceSatoshis:P,sourceLockingScript:M,unlockingScript:D,inputDescription:L,sequenceNumber:q})}}const R=a.readVarIntNum();if(R>=0){S.outputs=[];for(let E=0;E<R;E++){const k=a.readVarIntNum(),P=a.readVarIntNum(),T=a.readVarIntNum();let M;if(T>=0){const G=a.read(T);M=Ue(G)}const C=a.readInt8()===1,D=a.readVarIntNum(),F=a.read(D),B=Mt(F),L=a.readVarIntNum();let q;if(L>=0){const G=a.read(L);q=Mt(G)}const K=a.readVarIntNum(),$=[];if(K>=0)for(let G=0;G<K;G++){const ne=a.readVarIntNum(),ce=a.read(ne);$.push(Mt(ce))}const U=a.readVarIntNum();let z;if(U>=0){const G=a.read(U);z=Mt(G)}S.outputs.push({outputIndex:k,satoshis:P,lockingScript:M,spendable:C,outputDescription:B,basket:q,tags:$,customInstructions:z})}}u.push(S)}return{totalActions:c,actions:u}}async internalizeAction(e,n){var s,a,c;const r=new Ge;r.writeVarIntNum(e.tx.length),r.write(e.tx),r.writeVarIntNum(e.outputs.length);for(const u of e.outputs)if(r.writeVarIntNum(u.outputIndex),u.protocol==="wallet payment"){if(u.paymentRemittance==null)throw new Error("Payment remittance is required for wallet payment");r.writeUInt8(1),r.write(_e(u.paymentRemittance.senderIdentityKey,"hex"));const l=_e(u.paymentRemittance.derivationPrefix,"base64");r.writeVarIntNum(l.length),r.write(l);const h=_e(u.paymentRemittance.derivationSuffix,"base64");r.writeVarIntNum(h.length),r.write(h)}else{r.writeUInt8(2);const l=_e((s=u.insertionRemittance)==null?void 0:s.basket,"utf8");if(r.writeVarIntNum(l.length),r.write(l),typeof((a=u.insertionRemittance)==null?void 0:a.customInstructions)=="string"&&u.insertionRemittance.customInstructions!==""){const h=_e(u.insertionRemittance.customInstructions,"utf8");r.writeVarIntNum(h.length),r.write(h)}else r.writeVarIntNum(-1);if(typeof((c=u.insertionRemittance)==null?void 0:c.tags)=="object"){r.writeVarIntNum(u.insertionRemittance.tags.length);for(const h of u.insertionRemittance.tags){const f=_e(h,"utf8");r.writeVarIntNum(f.length),r.write(f)}}else r.writeVarIntNum(0)}if(typeof e.labels=="object"){r.writeVarIntNum(e.labels.length);for(const u of e.labels){const l=_e(u,"utf8");r.writeVarIntNum(l.length),r.write(l)}}else r.writeVarIntNum(-1);const t=_e(e.description);return r.writeVarIntNum(t.length),r.write(t),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),await this.transmit("internalizeAction",n,r.toArray()),{accepted:!0}}async listOutputs(e,n){const r=new Ge,t=_e(e.basket,"utf8");if(r.writeVarIntNum(t.length),r.write(t),typeof e.tags=="object"){r.writeVarIntNum(e.tags.length);for(const f of e.tags){const m=_e(f,"utf8");r.writeVarIntNum(m.length),r.write(m)}}else r.writeVarIntNum(0);e.tagQueryMode==="all"?r.writeInt8(1):e.tagQueryMode==="any"?r.writeInt8(2):r.writeInt8(-1),e.include==="locking scripts"?r.writeInt8(1):e.include==="entire transactions"?r.writeInt8(2):r.writeInt8(-1),typeof e.includeCustomInstructions=="boolean"?r.writeInt8(e.includeCustomInstructions?1:0):r.writeInt8(-1),typeof e.includeTags=="boolean"?r.writeInt8(e.includeTags?1:0):r.writeInt8(-1),typeof e.includeLabels=="boolean"?r.writeInt8(e.includeLabels?1:0):r.writeInt8(-1),typeof e.limit=="number"?r.writeVarIntNum(e.limit):r.writeVarIntNum(-1),typeof e.offset=="number"?r.writeVarIntNum(e.offset):r.writeVarIntNum(-1),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1);const s=await this.transmit("listOutputs",n,r.toArray()),a=new un(s),c=a.readVarIntNum(),u=a.readVarIntNum();let l;u>=0&&(l=a.read(u));const h=[];for(let f=0;f<c;f++){const m=this.readOutpoint(a),d=a.readVarIntNum(),y={spendable:!0,outpoint:m,satoshis:d},b=a.readVarIntNum();b>=0&&(y.lockingScript=Ue(a.read(b)));const g=a.readVarIntNum();g>=0&&(y.customInstructions=Mt(a.read(g)));const v=a.readVarIntNum();if(v!==-1){const S=[];for(let I=0;I<v;I++){const A=a.readVarIntNum();S.push(Mt(a.read(A)))}y.tags=S}const _=a.readVarIntNum();if(_!==-1){const S=[];for(let I=0;I<_;I++){const A=a.readVarIntNum();S.push(Mt(a.read(A)))}y.labels=S}h.push(y)}return{totalOutputs:c,BEEF:l,outputs:h}}async relinquishOutput(e,n){const r=new Ge,t=_e(e.basket,"utf8");return r.writeVarIntNum(t.length),r.write(t),r.write(this.encodeOutpoint(e.output)),await this.transmit("relinquishOutput",n,r.toArray()),{relinquished:!0}}encodeOutpoint(e){const n=new Ge,[r,t]=e.split(".");return n.write(_e(r,"hex")),n.writeVarIntNum(Number(t)),n.toArray()}readOutpoint(e){const n=Ue(e.read(32)),r=e.readVarIntNum();return`${n}.${r}`}async getPublicKey(e,n){const r=new Ge;r.writeUInt8(e.identityKey?1:0),e.identityKey?r.write(this.encodePrivilegedParams(e.privileged,e.privilegedReason)):(r.write(this.encodeKeyRelatedParams(e.protocolID??(e.protocolID=[km.Silent,"default"]),e.keyID??(e.keyID=""),e.counterparty,e.privileged,e.privilegedReason)),typeof e.forSelf=="boolean"?r.writeInt8(e.forSelf?1:0):r.writeInt8(-1)),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1);const t=await this.transmit("getPublicKey",n,r.toArray());return{publicKey:Ue(t)}}async revealCounterpartyKeyLinkage(e,n){const r=new Ge;r.write(this.encodePrivilegedParams(e.privileged,e.privilegedReason)),r.write(_e(e.counterparty,"hex")),r.write(_e(e.verifier,"hex"));const t=await this.transmit("revealCounterpartyKeyLinkage",n,r.toArray()),s=new un(t),a=Ue(s.read(33)),c=Ue(s.read(33)),u=Ue(s.read(33)),l=s.readVarIntNum(),h=Mt(s.read(l)),f=s.readVarIntNum(),m=s.read(f),d=s.readVarIntNum(),y=s.read(d);return{prover:a,verifier:c,counterparty:u,revelationTime:h,encryptedLinkage:m,encryptedLinkageProof:y}}async revealSpecificKeyLinkage(e,n){const r=new Ge;r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),r.write(_e(e.verifier,"hex"));const t=await this.transmit("revealSpecificKeyLinkage",n,r.toArray()),s=new un(t),a=Ue(s.read(33)),c=Ue(s.read(33)),u=Ue(s.read(33)),l=s.readUInt8(),h=s.readVarIntNum(),f=Mt(s.read(h)),m=s.readVarIntNum(),d=Mt(s.read(m)),y=s.readVarIntNum(),b=s.read(y),g=s.readVarIntNum(),v=s.read(g),_=s.readUInt8();return{prover:a,verifier:c,counterparty:u,protocolID:[l,f],keyID:d,encryptedLinkage:b,encryptedLinkageProof:v,proofType:_}}async encrypt(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),r.writeVarIntNum(e.plaintext.length),r.write(e.plaintext),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),{ciphertext:await this.transmit("encrypt",n,r.toArray())}}async decrypt(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),r.writeVarIntNum(e.ciphertext.length),r.write(e.ciphertext),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),{plaintext:await this.transmit("decrypt",n,r.toArray())}}async createHmac(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),r.writeVarIntNum(e.data.length),r.write(e.data),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),{hmac:await this.transmit("createHmac",n,r.toArray())}}async verifyHmac(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),r.write(e.hmac),r.writeVarIntNum(e.data.length),r.write(e.data),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),await this.transmit("verifyHmac",n,r.toArray()),{valid:!0}}async createSignature(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),typeof e.data=="object"?(r.writeUInt8(1),r.writeVarIntNum(e.data.length),r.write(e.data)):(r.writeUInt8(2),r.write(e.hashToDirectlySign??(e.hashToDirectlySign=[]))),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),{signature:await this.transmit("createSignature",n,r.toArray())}}async verifySignature(e,n){const r=new Ge;return r.write(this.encodeKeyRelatedParams(e.protocolID,e.keyID,e.counterparty,e.privileged,e.privilegedReason)),typeof e.forSelf=="boolean"?r.writeInt8(e.forSelf?1:0):r.writeInt8(-1),r.writeVarIntNum(e.signature.length),r.write(e.signature),typeof e.data=="object"?(r.writeUInt8(1),r.writeVarIntNum(e.data.length),r.write(e.data)):(r.writeUInt8(2),r.write(e.hashToDirectlyVerify??[])),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1),await this.transmit("verifySignature",n,r.toArray()),{valid:!0}}encodeKeyRelatedParams(e,n,r,t,s){const a=new Ge;a.writeUInt8(e[0]);const c=_e(e[1],"utf8");a.writeVarIntNum(c.length),a.write(c);const u=_e(n,"utf8");return a.writeVarIntNum(u.length),a.write(u),typeof r!="string"?a.writeUInt8(0):r==="self"?a.writeUInt8(11):r==="anyone"?a.writeUInt8(12):a.write(_e(r,"hex")),a.write(this.encodePrivilegedParams(t,s)),a.toArray()}async acquireCertificate(e,n){var c;const r=new Ge;r.write(_e(e.type,"base64")),r.write(_e(e.certifier,"hex"));const t=Object.entries(e.fields);r.writeVarIntNum(t.length);for(const[u,l]of t){const h=_e(u,"utf8"),f=_e(l,"utf8");r.writeVarIntNum(h.length),r.write(h),r.writeVarIntNum(f.length),r.write(f)}if(r.write(this.encodePrivilegedParams(e.privileged,e.privilegedReason)),r.writeUInt8(e.acquisitionProtocol==="direct"?1:2),e.acquisitionProtocol==="direct"){r.write(_e(e.serialNumber,"base64")),r.write(this.encodeOutpoint(e.revocationOutpoint??""));const u=_e(e.signature,"hex");r.writeVarIntNum(u.length),r.write(u);const l=e.keyringRevealer!=="certifier"?_e(e.keyringRevealer,"hex"):[11];r.write(l);const h=Object.keys(e.keyringForSubject??{});r.writeVarIntNum(h.length);for(let f=0;f<h.length;f++){const m=_e(h[f],"utf8");r.writeVarIntNum(m.length),r.write(m);const d=_e((c=e.keyringForSubject)==null?void 0:c[h[f]],"base64");r.writeVarIntNum(d.length),r.write(d)}}else{const u=_e(e.certifierUrl,"utf8");r.writeVarIntNum(u.length),r.write(u)}const s=await this.transmit("acquireCertificate",n,r.toArray()),a=bb.fromBinary(s);return{...a,signature:a.signature}}encodePrivilegedParams(e,n){const r=new Ge;if(typeof e=="boolean"?r.writeInt8(e?1:0):r.writeInt8(-1),typeof n=="string"){const t=_e(n,"utf8");r.writeInt8(t.length),r.write(t)}else r.writeInt8(-1);return r.toArray()}async listCertificates(e,n){const r=new Ge;r.writeVarIntNum(e.certifiers.length);for(let u=0;u<e.certifiers.length;u++)r.write(_e(e.certifiers[u],"hex"));r.writeVarIntNum(e.types.length);for(let u=0;u<e.types.length;u++)r.write(_e(e.types[u],"base64"));typeof e.limit=="number"?r.writeVarIntNum(e.limit):r.writeVarIntNum(-1),typeof e.offset=="number"?r.writeVarIntNum(e.offset):r.writeVarIntNum(-1),r.write(this.encodePrivilegedParams(e.privileged,e.privilegedReason));const t=await this.transmit("listCertificates",n,r.toArray()),s=new un(t),a=s.readVarIntNum(),c=[];for(let u=0;u<a;u++){const l=s.readVarIntNum(),h=s.read(l),f=bb.fromBinary(h);c.push({...f,signature:f.signature})}return{totalCertificates:a,certificates:c}}async proveCertificate(e,n){const r=new Ge,t=_e(e.certificate.type,"base64");r.write(t);const s=_e(e.certificate.subject,"hex");r.write(s);const a=_e(e.certificate.serialNumber,"base64");r.write(a);const c=_e(e.certificate.certifier,"hex");r.write(c);const u=this.encodeOutpoint(e.certificate.revocationOutpoint??"");r.write(u);const l=_e(e.certificate.signature,"hex");r.writeVarIntNum(l.length),r.write(l);const h=Object.entries(e.certificate.fields??{});r.writeVarIntNum(h.length);for(const[b,g]of h){const v=_e(b,"utf8"),_=_e(g,"utf8");r.writeVarIntNum(v.length),r.write(v),r.writeVarIntNum(_.length),r.write(_)}r.writeVarIntNum(e.fieldsToReveal.length);for(const b of e.fieldsToReveal){const g=_e(b,"utf8");r.writeVarIntNum(g.length),r.write(g)}r.write(_e(e.verifier,"hex")),r.write(this.encodePrivilegedParams(e.privileged,e.privilegedReason));const f=await this.transmit("proveCertificate",n,r.toArray()),m=new un(f),d=m.readVarIntNum(),y={};for(let b=0;b<d;b++){const g=m.readVarIntNum(),v=Mt(m.read(g)),_=m.readVarIntNum();y[v]=Pa(m.read(_))}return{keyringForVerifier:y}}async relinquishCertificate(e,n){const r=new Ge,t=_e(e.type,"base64");r.write(t);const s=_e(e.serialNumber,"base64");r.write(s);const a=_e(e.certifier,"hex");return r.write(a),await this.transmit("relinquishCertificate",n,r.toArray()),{relinquished:!0}}parseDiscoveryResult(e){const n=new un(e),r=n.readVarIntNum(),t=[];for(let s=0;s<r;s++){const a=n.readVarIntNum(),c=n.read(a),u=bb.fromBinary(c),l=n.readVarIntNum(),h=Mt(n.read(l)),f=n.readVarIntNum(),m=Mt(n.read(f)),d=n.readVarIntNum(),y=Mt(n.read(d)),b=n.readUInt8(),g={},v=n.readVarIntNum();for(let I=0;I<v;I++){const A=n.readVarIntNum(),R=Mt(n.read(A)),E=n.readVarIntNum();g[R]=n.read(E)}const _={},S=n.readVarIntNum();for(let I=0;I<S;I++){const A=n.readVarIntNum(),R=Mt(n.read(A)),E=n.readVarIntNum();_[R]=Mt(n.read(E))}t.push({...u,signature:u.signature,certifierInfo:{iconUrl:m,name:h,description:y,trust:b},publiclyRevealedKeyring:g,decryptedFields:_})}return{totalCertificates:r,certificates:t}}async discoverByIdentityKey(e,n){const r=new Ge;r.write(_e(e.identityKey,"hex")),typeof e.limit=="number"?r.writeVarIntNum(e.limit):r.writeVarIntNum(-1),typeof e.offset=="number"?r.writeVarIntNum(e.offset):r.writeVarIntNum(-1),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1);const t=await this.transmit("discoverByIdentityKey",n,r.toArray());return this.parseDiscoveryResult(t)}async discoverByAttributes(e,n){const r=new Ge,t=Object.keys(e.attributes);r.writeVarIntNum(t.length);for(let a=0;a<t.length;a++)r.writeVarIntNum(t[a].length),r.write(_e(t[a],"utf8")),r.writeVarIntNum(e.attributes[t[a]].length),r.write(_e(e.attributes[t[a]],"utf8"));typeof e.limit=="number"?r.writeVarIntNum(e.limit):r.writeVarIntNum(-1),typeof e.offset=="number"?r.writeVarIntNum(e.offset):r.writeVarIntNum(-1),r.writeInt8(typeof e.seekPermission=="boolean"?e.seekPermission?1:0:-1);const s=await this.transmit("discoverByAttributes",n,r.toArray());return this.parseDiscoveryResult(s)}async isAuthenticated(e,n){return{authenticated:(await this.transmit("isAuthenticated",n))[0]===1}}async waitForAuthentication(e,n){return await this.transmit("waitForAuthentication",n),{authenticated:!0}}async getHeight(e,n){const r=await this.transmit("getHeight",n);return{height:new un(r).readVarIntNum()}}async getHeaderForHeight(e,n){const r=new Ge;r.writeVarIntNum(e.height);const t=await this.transmit("getHeaderForHeight",n,r.toArray());return{header:Ue(t)}}async getNetwork(e,n){return{network:(await this.transmit("getNetwork",n))[0]===0?"mainnet":"testnet"}}async getVersion(e,n){const r=await this.transmit("getVersion",n);return{version:Mt(r)}}},G2=class{constructor(e,n="http://localhost:3301",r=fetch){te(this,"baseUrl");te(this,"httpClient");te(this,"originator");this.baseUrl=n,this.httpClient=r,this.originator=e}async transmitToWallet(e){const n=new un(e),r=n.readUInt8(),t=m6[r];if(t===void 0||t==="")throw new Error(`Invalid call code: ${r}`);const s=n.readUInt8();let a;if(s>0){const h=n.read(s);a=Mt(h)}const c=n.read(),l=await(await fetch(`${this.baseUrl}/${t}`,{method:"POST",headers:{"Content-Type":"application/octet-stream",Origin:a??""},body:new Uint8Array(c)})).arrayBuffer();return Array.from(new Uint8Array(l))}},eB=class extends Error{constructor(n,r,t,s,a){super("Undelayed createAction or signAction results require review.");te(this,"reviewActionResults");te(this,"sendWithResults");te(this,"txid");te(this,"tx");te(this,"noSendChange");te(this,"code");te(this,"isError",!0);this.reviewActionResults=n,this.sendWithResults=r,this.txid=t,this.tx=s,this.noSendChange=a,this.code=5,this.name=this.constructor.name}};function tB(i,e="http"){if(/^[a-z][a-z0-9+.-]*:\/\//i.test(i))try{return new URL(i).origin}catch{}try{return new URL(`${e}://${i}`).origin}catch{throw new Error(`Invalid originator value: ${i}`)}}let X2=class{constructor(e,n="http://localhost:3321",r=fetch){te(this,"baseUrl");te(this,"httpClient");te(this,"originator");te(this,"api");this.baseUrl=n,this.originator=e,this.httpClient=r;const t=typeof window<"u"&&typeof document<"u"&&(window==null?void 0:window.origin)!=="file://";this.api=async(s,a)=>{const c=!t&&this.originator?tB(this.originator,"http"):void 0;!t&&c===void 0&&console.error("Originator is required in Node.js environments");const u=await await r(`${this.baseUrl}/${s}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...c?{Origin:c}:{},...c?{Originator:c}:{}},body:JSON.stringify(a)}),l=await u.json();if(!u.ok){if(u.status===400&&l.isError&&l.code===5)throw new eB(l.reviewActionResults,l.sendWithResults,l.txid,l.tx,l.noSendChange);{const h={call:s,args:a,message:l.message??`HTTP Client error ${u.status}`};throw new Error(JSON.stringify(h))}}return l}}async createAction(e){return await this.api("createAction",e)}async signAction(e){return await this.api("signAction",e)}async abortAction(e){return await this.api("abortAction",e)}async listActions(e){return await this.api("listActions",e)}async internalizeAction(e){return await this.api("internalizeAction",e)}async listOutputs(e){return await this.api("listOutputs",e)}async relinquishOutput(e){return await this.api("relinquishOutput",e)}async getPublicKey(e){return await this.api("getPublicKey",e)}async revealCounterpartyKeyLinkage(e){return await this.api("revealCounterpartyKeyLinkage",e)}async revealSpecificKeyLinkage(e){return await this.api("revealSpecificKeyLinkage",e)}async encrypt(e){return await this.api("encrypt",e)}async decrypt(e){return await this.api("decrypt",e)}async createHmac(e){return await this.api("createHmac",e)}async verifyHmac(e){return await this.api("verifyHmac",e)}async createSignature(e){return await this.api("createSignature",e)}async verifySignature(e){return await this.api("verifySignature",e)}async acquireCertificate(e){return await this.api("acquireCertificate",e)}async listCertificates(e){return await this.api("listCertificates",e)}async proveCertificate(e){return await this.api("proveCertificate",e)}async relinquishCertificate(e){return await this.api("relinquishCertificate",e)}async discoverByIdentityKey(e){return await this.api("discoverByIdentityKey",e)}async discoverByAttributes(e){return await this.api("discoverByAttributes",e)}async isAuthenticated(e){return await this.api("isAuthenticated",e)}async waitForAuthentication(e){return await this.api("waitForAuthentication",e)}async getHeight(e){return await this.api("getHeight",e)}async getHeaderForHeight(e){return await this.api("getHeaderForHeight",e)}async getNetwork(e){return await this.api("getNetwork",e)}async getVersion(e){return await this.api("getVersion",e)}},Y2=class{constructor(e="*"){te(this,"domain");if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(!window.hasOwnProperty("ReactNativeWebView"))throw new Error("The window object does not have a ReactNativeWebView property.");if(typeof window.ReactNativeWebView.postMessage!="function")throw new Error("The window.ReactNativeWebView property does not seem to support postMessage calls.");this.domain=e}async invoke(e,n){return await new Promise((r,t)=>{const s=Pa(Ra(12)),a=c=>{const u=JSON.parse(c.data);if(!(u.type!=="CWI"||u.id!==s||u.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",a),u.status==="error"){const l=new xw(u.description,u.code);t(l)}else r(u.result)};window.addEventListener("message",a),window.ReactNativeWebView.postMessage(JSON.stringify({type:"CWI",isInvocation:!0,id:s,call:e,args:n}))})}async createAction(e){return await this.invoke("createAction",e)}async signAction(e){return await this.invoke("signAction",e)}async abortAction(e){return await this.invoke("abortAction",e)}async listActions(e){return await this.invoke("listActions",e)}async internalizeAction(e){return await this.invoke("internalizeAction",e)}async listOutputs(e){return await this.invoke("listOutputs",e)}async relinquishOutput(e){return await this.invoke("relinquishOutput",e)}async getPublicKey(e){return await this.invoke("getPublicKey",e)}async revealCounterpartyKeyLinkage(e){return await this.invoke("revealCounterpartyKeyLinkage",e)}async revealSpecificKeyLinkage(e){return await this.invoke("revealSpecificKeyLinkage",e)}async encrypt(e){return await this.invoke("encrypt",e)}async decrypt(e){return await this.invoke("decrypt",e)}async createHmac(e){return await this.invoke("createHmac",e)}async verifyHmac(e){return await this.invoke("verifyHmac",e)}async createSignature(e){return await this.invoke("createSignature",e)}async verifySignature(e){return await this.invoke("verifySignature",e)}async acquireCertificate(e){return await this.invoke("acquireCertificate",e)}async listCertificates(e){return await this.invoke("listCertificates",e)}async proveCertificate(e){return await this.invoke("proveCertificate",e)}async relinquishCertificate(e){return await this.invoke("relinquishCertificate",e)}async discoverByIdentityKey(e){return await this.invoke("discoverByIdentityKey",e)}async discoverByAttributes(e){return await this.invoke("discoverByAttributes",e)}async isAuthenticated(e){return await this.invoke("isAuthenticated",e)}async waitForAuthentication(e){return await this.invoke("waitForAuthentication",e)}async getHeight(e){return await this.invoke("getHeight",e)}async getHeaderForHeight(e){return await this.invoke("getHeaderForHeight",e)}async getNetwork(e){return await this.invoke("getNetwork",e)}async getVersion(e){return await this.invoke("getVersion",e)}};const nB=200;let iB=class{constructor(e="auto",n){te(this,"substrate");te(this,"originator");e==="Cicada"&&(e=new z2(new G2(n))),e==="window.CWI"&&(e=new K2),e==="XDM"&&(e=new $2),e==="json-api"&&(e=new X2(n)),e==="react-native"&&(e=new Y2(n)),this.substrate=e,this.originator=n}async connectToSubstrate(){if(typeof this.substrate=="object")return;let e;const n=async r=>{let t;if(typeof r=="number"?t=await Promise.race([e.getVersion({}),new Promise((s,a)=>setTimeout(()=>a(new Error("Timed out.")),r))]):t=await e.getVersion({}),typeof t!="object"||typeof t.version!="string")throw new Error("Failed to use substrate.")};try{e=new K2,await n(),this.substrate=e}catch{try{e=new $2,await n(nB),this.substrate=e}catch{try{e=new z2(new G2(this.originator)),await n(),this.substrate=e}catch{try{e=new X2(this.originator),await n(),this.substrate=e}catch{try{e=new Y2(this.originator),await n(),this.substrate=e}catch{throw new Error("No wallet available over any communication substrate. Install a BSV wallet today!")}}}}}}async createAction(e){return await this.connectToSubstrate(),await this.substrate.createAction(e,this.originator)}async signAction(e){return await this.connectToSubstrate(),await this.substrate.signAction(e,this.originator)}async abortAction(e){return await this.connectToSubstrate(),await this.substrate.abortAction(e,this.originator)}async listActions(e){return await this.connectToSubstrate(),await this.substrate.listActions(e,this.originator)}async internalizeAction(e){return await this.connectToSubstrate(),await this.substrate.internalizeAction(e,this.originator)}async listOutputs(e){return await this.connectToSubstrate(),await this.substrate.listOutputs(e,this.originator)}async relinquishOutput(e){return await this.connectToSubstrate(),await this.substrate.relinquishOutput(e,this.originator)}async getPublicKey(e){return await this.connectToSubstrate(),await this.substrate.getPublicKey(e,this.originator)}async revealCounterpartyKeyLinkage(e){return await this.connectToSubstrate(),await this.substrate.revealCounterpartyKeyLinkage(e,this.originator)}async revealSpecificKeyLinkage(e){return await this.connectToSubstrate(),await this.substrate.revealSpecificKeyLinkage(e,this.originator)}async encrypt(e){return await this.connectToSubstrate(),await this.substrate.encrypt(e,this.originator)}async decrypt(e){return await this.connectToSubstrate(),await this.substrate.decrypt(e,this.originator)}async createHmac(e){return await this.connectToSubstrate(),await this.substrate.createHmac(e,this.originator)}async verifyHmac(e){return await this.connectToSubstrate(),await this.substrate.verifyHmac(e,this.originator)}async createSignature(e){return await this.connectToSubstrate(),await this.substrate.createSignature(e,this.originator)}async verifySignature(e){return await this.connectToSubstrate(),await this.substrate.verifySignature(e,this.originator)}async acquireCertificate(e){return await this.connectToSubstrate(),await this.substrate.acquireCertificate(e,this.originator)}async listCertificates(e){return await this.connectToSubstrate(),await this.substrate.listCertificates(e,this.originator)}async proveCertificate(e){return await this.connectToSubstrate(),await this.substrate.proveCertificate(e,this.originator)}async relinquishCertificate(e){return await this.connectToSubstrate(),await this.substrate.relinquishCertificate(e,this.originator)}async discoverByIdentityKey(e){return await this.connectToSubstrate(),await this.substrate.discoverByIdentityKey(e,this.originator)}async discoverByAttributes(e){return await this.connectToSubstrate(),await this.substrate.discoverByAttributes(e,this.originator)}async isAuthenticated(e={}){return await this.connectToSubstrate(),await this.substrate.isAuthenticated(e,this.originator)}async waitForAuthentication(e={}){return await this.connectToSubstrate(),await this.substrate.waitForAuthentication(e,this.originator)}async getHeight(e={}){return await this.connectToSubstrate(),await this.substrate.getHeight(e,this.originator)}async getHeaderForHeight(e){return await this.connectToSubstrate(),await this.substrate.getHeaderForHeight(e,this.originator)}async getNetwork(e={}){return await this.connectToSubstrate(),await this.substrate.getNetwork(e,this.originator)}async getVersion(e={}){return await this.connectToSubstrate(),await this.substrate.getVersion(e,this.originator)}};typeof window<"u"&&fetch.bind(window);var Qi={},Hs={},El={},Q2;function w6(){if(Q2)return El;Q2=1,Object.defineProperty(El,"__esModule",{value:!0}),El.WalletError=void 0;class i extends Error{constructor(n,r,t,s){super(r),this.details=s,this.isError=!0,this.name=n,t&&(this.stack=t)}get code(){return this.name}set code(n){this.name=n}get description(){return this.message}set description(n){this.message=n}static fromUnknown(n){let r="WERR_UNKNOWN",t="",s;const a={};n!==null&&typeof n=="object"&&(n.name==="Error"||n.name==="FetchError"?r=n.code||n.status||"WERR_UNKNOWN":r=n.name||n.code||n.status||"WERR_UNKNOWN",typeof r!="string"&&(r="WERR_UNKNOWN"),t=n.message||n.description||"",typeof t!="string"&&(t="WERR_UNKNOWN"),typeof n.stack=="string"&&(s=n.stack),typeof n.sql=="string"&&(a.sql=n.sql),typeof n.sqlMessage=="string"&&(a.sqlMessage=n.sqlMessage));const c=new i(r,t,s,Object.keys(a).length>0?a:void 0);if(n!==null&&typeof n=="object"){for(const[u,l]of Object.entries(n))if(!(u!=="walletError"&&typeof l!="string"&&typeof l!="number"&&!Array.isArray(l)))switch(u){case"walletError":c[u]=i.fromUnknown(l);break;case"status":break;case"name":break;case"code":break;case"message":break;case"description":break;case"stack":break;case"sql":break;case"sqlMessage":break;default:c[u]=l;break}}return c}asStatus(){return{status:"error",code:this.name,description:this.message}}}return El.WalletError=i,El}var mb={},Z2;function rB(){return Z2||(Z2=1,Object.defineProperty(mb,"__esModule",{value:!0})),mb}var wb={},J2;function aB(){return J2||(J2=1,Object.defineProperty(wb,"__esModule",{value:!0})),wb}var _t={},eS;function sB(){if(eS)return _t;eS=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.WERR_REVIEW_ACTIONS=_t.WERR_INVALID_PUBLIC_KEY=_t.WERR_INSUFFICIENT_FUNDS=_t.WERR_NOT_ACTIVE=_t.WERR_UNAUTHORIZED=_t.WERR_NETWORK_CHAIN=_t.WERR_BAD_REQUEST=_t.WERR_MISSING_PARAMETER=_t.WERR_INVALID_PARAMETER=_t.WERR_BROADCAST_UNAVAILABLE=_t.WERR_INVALID_OPERATION=_t.WERR_INTERNAL=_t.WERR_NOT_IMPLEMENTED=void 0;const i=w6();class e extends i.WalletError{constructor(b){super("WERR_NOT_IMPLEMENTED",b??"Not implemented.")}}_t.WERR_NOT_IMPLEMENTED=e;class n extends i.WalletError{constructor(b){super("WERR_INTERNAL",b??"An internal error has occurred.")}}_t.WERR_INTERNAL=n;class r extends i.WalletError{constructor(b){super("WERR_INVALID_OPERATION",b??"An invalid operation was requested.")}}_t.WERR_INVALID_OPERATION=r;class t extends i.WalletError{constructor(b){super("WERR_BROADCAST_UNAVAILABLE","Unable to broadcast transaction at this time.")}}_t.WERR_BROADCAST_UNAVAILABLE=t;class s extends i.WalletError{constructor(b,g){super("WERR_INVALID_PARAMETER",`The ${b} parameter must be ${g??"valid."}`),this.parameter=b}}_t.WERR_INVALID_PARAMETER=s;class a extends i.WalletError{constructor(b){super("WERR_MISSING_PARAMETER",`The required ${b} parameter is missing.`),this.parameter=b}}_t.WERR_MISSING_PARAMETER=a;class c extends i.WalletError{constructor(b){super("WERR_BAD_REQUEST",b??"The request is invalid.")}}_t.WERR_BAD_REQUEST=c;class u extends i.WalletError{constructor(b){super("WERR_NETWORK_CHAIN",b??"Configured network chain is invalid or does not match across services.")}}_t.WERR_NETWORK_CHAIN=u;class l extends i.WalletError{constructor(b){super("WERR_UNAUTHORIZED",b??"Access is denied due to an authorization error.")}}_t.WERR_UNAUTHORIZED=l;class h extends i.WalletError{constructor(b){super("WERR_NOT_ACTIVE",b??"WalletStorageManager is not accessing user's active storage or there are conflicting active stores configured.")}}_t.WERR_NOT_ACTIVE=h;class f extends i.WalletError{constructor(b,g){super("WERR_INSUFFICIENT_FUNDS",`Insufficient funds in the available inputs to cover the cost of the required outputs and the transaction fee (${g} more satoshis are needed, for a total of ${b}), plus whatever would be required in order to pay the fee to unlock and spend the outputs used to provide the additional satoshis.`),this.totalSatoshisNeeded=b,this.moreSatoshisNeeded=g}}_t.WERR_INSUFFICIENT_FUNDS=f;class m extends i.WalletError{constructor(b,g="mainnet"){const v=g==="mainnet"?`The provided public key "${b}" is invalid or malformed.`:"The provided public key is invalid or malformed.";super("WERR_INVALID_PUBLIC_KEY",v),this.key=b}}_t.WERR_INVALID_PUBLIC_KEY=m;class d extends i.WalletError{constructor(b,g,v,_,S){super("WERR_REVIEW_ACTIONS","Undelayed createAction or signAction results require review."),this.reviewActionResults=b,this.sendWithResults=g,this.txid=v,this.tx=_,this.noSendChange=S}}return _t.WERR_REVIEW_ACTIONS=d,_t}var ut={},qs={},Zi={},tp={},tS;function an(){if(tS)return tp;tS=1,Object.defineProperty(tp,"__esModule",{value:!0});let i=class De{get negative(){return this._sign}set negative(n){this.assert(n===0||n===1,"Negative property must be 0 or 1");const r=n===1?1:0;this._magnitude===0n?this._sign=0:this._sign=r}get _computedWordsArray(){if(this._magnitude===0n)return[0];const n=[];let r=this._magnitude;for(;r>0n;)n.push(Number(r&De.WORD_MASK)),r>>=De.WORD_SIZE_BIGINT;return n.length>0?n:[0]}get words(){const n=this._computedWordsArray;if(this._nominalWordLength<=n.length)return n;const r=new Array(this._nominalWordLength).fill(0);for(let t=0;t<n.length;t++)r[t]=n[t];return r}set words(n){const r=this._sign;let t=0n;const s=n.length>0?n.length:1;for(let a=s-1;a>=0;a--){const c=n[a]===void 0?0:n[a];t=t<<De.WORD_SIZE_BIGINT|BigInt(c&Number(De.WORD_MASK))}this._magnitude=t,this._sign=r,this._nominalWordLength=s,this.normSign()}get length(){return Math.max(1,this._nominalWordLength)}static isBN(n){var r;return n instanceof De?!0:n!==null&&typeof n=="object"&&((r=n.constructor)===null||r===void 0?void 0:r.wordSize)===De.wordSize&&Array.isArray(n.words)}static max(n,r){return n.cmp(r)>0?n:r}static min(n,r){return n.cmp(r)<0?n:r}constructor(n=0,r=10,t="be"){if(this._magnitude=0n,this._sign=0,this._nominalWordLength=1,this.red=null,n===void 0&&(n=0),n===null){this._initializeState(0n,0);return}if(typeof n=="bigint"){this._initializeState(n<0n?-n:n,n<0n?1:0),this.normSign();return}let s=r,a=t;if((r==="le"||r==="be")&&(a=r,s=10),typeof n=="number"){this.initNumber(n,a);return}if(Array.isArray(n)){this.initArray(n,a);return}if(typeof n=="string"){s==="hex"&&(s=16),this.assert(typeof s=="number"&&s===(s|0)&&s>=2&&s<=36,"Base must be an integer between 2 and 36");const c=n.toString().replace(/\s+/g,"");let u=0,l=0;c.startsWith("-")?(u++,l=1):c.startsWith("+")&&u++;const h=c.substring(u);if(h.length===0){this._initializeState(0n,l===1&&c.startsWith("-")?1:0),this.normSign();return}if(s===16){let f;if(a==="le"){const m=[];let d=h;d.length%2!==0&&(d="0"+d);for(let y=0;y<d.length;y+=2){const b=d.substring(y,y+2),g=parseInt(b,16);if(isNaN(g))throw new Error("Invalid character in "+d);m.push(g)}this.initArray(m,"le"),this._sign=l,this.normSign();return}else try{f=BigInt("0x"+h)}catch{throw new Error("Invalid character in "+h)}this._initializeState(f,l),this.normSign()}else try{if(this._parseBaseString(h,s),this._sign=l,this.normSign(),a==="le"){const f=this._sign;this.initArray(this.toArray("be"),"le"),this._sign=f,this.normSign()}}catch(f){const m=f;throw m.message.includes("Invalid character in string")||m.message.includes("Invalid digit for base")||m.message.startsWith("Invalid character:")?new Error("Invalid character"):m}}else n!==0?this.assert(!1,"Unsupported input type for BigNumber constructor"):this._initializeState(0n,0)}_bigIntToStringInBase(n,r){if(n===0n)return"0";if(r<2||r>36)throw new Error("Base must be between 2 and 36");const t="0123456789abcdefghijklmnopqrstuvwxyz";let s="",a=n>0n?n:-n;const c=BigInt(r);for(;a>0n;)s=t[Number(a%c)]+s,a/=c;return s}_parseBaseString(n,r){if(n.length===0){this._magnitude=0n,this._finishInitialization();return}this._magnitude=0n;const t=BigInt(r);let s=De.groupSizes[r],a=BigInt(De.groupBases[r]);(s===0||a===0n)&&(s=Math.floor(Math.log(67108863)/Math.log(r)),s===0&&(s=1),a=t**BigInt(s));let c=0;const u=n.length;let l=u%s;if(l===0&&u>0&&(l=s),l>0){const h=n.substring(c,c+l);this._magnitude=BigInt(this._parseBaseWord(h,r)),c+=l}for(;c<u;){const h=n.substring(c,c+s),f=BigInt(this._parseBaseWord(h,r));this._magnitude=this._magnitude*a+f,c+=s}this._finishInitialization()}_parseBaseWord(n,r){let t=0;for(let s=0;s<n.length;s++){const a=n.charCodeAt(s);let c;if(a>=48&&a<=57)c=a-48;else if(a>=65&&a<=90)c=a-65+10;else if(a>=97&&a<=122)c=a-97+10;else throw new Error("Invalid character: "+n[s]);if(c>=r)throw new Error("Invalid character");t=t*r+c}return t}_initializeState(n,r){this._magnitude=n,this._sign=n===0n?0:r,this._finishInitialization()}_finishInitialization(){if(this._magnitude===0n)this._nominalWordLength=1,this._sign=0;else{const n=this._magnitude.toString(2).length;this._nominalWordLength=Math.max(1,Math.ceil(n/De.wordSize))}}assert(n,r="Assertion failed"){if(!n)throw new Error(r)}initNumber(n,r="be"){if(this.assert(BigInt(Math.abs(n))<=De.MAX_NUMBER_CONSTRUCTOR_MAG_BIGINT,"The number is larger than 2 ^ 53 (unsafe)"),this.assert(n%1===0,"Number must be an integer for BigNumber conversion"),this._initializeState(BigInt(Math.abs(n)),n<0?1:0),r==="le"){const t=this._sign,s=this.toArray("be");this.initArray(s,"le"),this._sign=t,this.normSign()}return this}initArray(n,r){if(n.length===0)return this._initializeState(0n,0),this;let t=0n;if(r==="be")for(let s=0;s<n.length;s++)t=t<<8n|BigInt(n[s]&255);else for(let s=n.length-1;s>=0;s--)t=t<<8n|BigInt(n[s]&255);return this._initializeState(t,0),this}copy(n){n._magnitude=this._magnitude,n._sign=this._sign,n._nominalWordLength=this._nominalWordLength,n.red=this.red}static move(n,r){n._magnitude=r._magnitude,n._sign=r._sign,n._nominalWordLength=r._nominalWordLength,n.red=r.red}clone(){const n=new De(0n);return this.copy(n),n}expand(n){return this.assert(n>=0,"Expand size must be non-negative"),this._nominalWordLength=Math.max(this._nominalWordLength,n,1),this}strip(){return this._finishInitialization(),this.normSign()}normSign(){return this._magnitude===0n&&(this._sign=0),this}inspect(){return(this.red!==null?"<BN-R: ":"<BN: ")+this.toString(16)+">"}_getMinimalHex(){return this._magnitude===0n?"0":this._magnitude.toString(16)}toString(n=10,r=1){if(n===16||n==="hex"){let t=this._getMinimalHex();if(r>1)for(t!=="0"&&t.length%2!==0&&(t="0"+t);t.length%r!==0;)t="0"+t;return(this.isNeg()?"-":"")+t}if(typeof n!="number"||n<2||n>36||n%1!==0)throw new Error("Base should be an integer between 2 and 36");return this.toBaseString(n,r)}toBaseString(n,r){if(this._magnitude===0n){let u="0";if(r>1)for(;u.length<r;)u="0"+u;return u}let t=De.groupSizes[n],s=BigInt(De.groupBases[n]);(t===0||s===0n)&&(t=Math.floor(Math.log(Number.MAX_SAFE_INTEGER)/Math.log(n)),t===0&&(t=1),s=BigInt(n)**BigInt(t));let a="",c=this._magnitude;for(;c>0n;){const u=c%s;c/=s;const l=this._bigIntToStringInBase(u,n);if(c>0n){const h=t-l.length;h>0&&h<De.zeros.length?a=De.zeros[h]+l+a:h>0?a="0".repeat(h)+l+a:a=l+a}else a=l+a}if(r>0)for(;a.length<r;)a="0"+a;return(this._sign===1?"-":"")+a}toNumber(){const n=this._getSignedValue();if(n>De.MAX_SAFE_INTEGER_BIGINT||n<De.MIN_SAFE_INTEGER_BIGINT)throw new Error("Number can only safely store up to 53 bits");return Number(n)}toJSON(){const n=this._getMinimalHex();return(this.isNeg()?"-":"")+n}toArrayLikeGeneric(n,r){let t=this._magnitude,s=r?0:n.length-1;const a=r?1:-1;for(let c=0;c<n.length;++c){if(t===0n&&s>=0&&s<n.length)n[s]=0;else if(s>=0&&s<n.length)n[s]=Number(t&0xffn);else break;t>>=8n,s+=a}}toArray(n="be",r){this.strip();const t=this.byteLength(),s=r??Math.max(1,t);this.assert(t<=s,"byte array longer than desired length"),this.assert(s>0,"Requested array length <= 0");const a=new Array(s).fill(0);return this._magnitude===0n&&s>0?a:this._magnitude===0n&&s===0?[]:(this.toArrayLikeGeneric(a,n==="le"),a)}bitLength(){return this._magnitude===0n?0:this._magnitude.toString(2).length}static toBitArray(n){const r=n.bitLength();if(r===0)return[];const t=new Array(r),s=n._magnitude;for(let a=0;a<r;a++)t[a]=(s>>BigInt(a)&1n)!==0n?1:0;return t}toBitArray(){return De.toBitArray(this)}zeroBits(){if(this._magnitude===0n)return 0;let n=0,r=this._magnitude;for(;(r&1n)===0n&&r!==0n;)n++,r>>=1n;return n}byteLength(){return this._magnitude===0n?0:Math.ceil(this.bitLength()/8)}_getSignedValue(){return this._sign===1?-this._magnitude:this._magnitude}_setValueFromSigned(n){n<0n?(this._magnitude=-n,this._sign=1):(this._magnitude=n,this._sign=0),this._finishInitialization(),this.normSign()}toTwos(n){this.assert(n>=0);const r=BigInt(n);let t=this._getSignedValue();this._sign===1&&this._magnitude!==0n&&(t=(1n<<r)+t);const s=(1n<<r)-1n;t&=s;const a=new De(0n);return a._initializeState(t,0),a}fromTwos(n){this.assert(n>=0);const r=BigInt(n),t=this._magnitude;if(n>0&&(t>>r-1n&1n)!==0n&&this._sign===0){const s=t-(1n<<r),a=new De(0n);return a._setValueFromSigned(s),a}return this.clone()}isNeg(){return this._sign===1&&this._magnitude!==0n}neg(){return this.clone().ineg()}ineg(){return this._magnitude!==0n&&(this._sign=this._sign===1?0:1),this}_iuop(n,r){const t=r(this._magnitude,n._magnitude),s=r===((c,u)=>c^u);let a=this._nominalWordLength;return s&&(a=Math.max(this.length,n.length)),this._magnitude=t,this._finishInitialization(),s&&(this._nominalWordLength=Math.max(this._nominalWordLength,a)),this.strip()}iuor(n){return this._iuop(n,(r,t)=>r|t)}iuand(n){return this._iuop(n,(r,t)=>r&t)}iuxor(n){return this._iuop(n,(r,t)=>r^t)}_iop(n,r){return this.assert(this._sign===0&&n._sign===0),this._iuop(n,r)}ior(n){return this._iop(n,(r,t)=>r|t)}iand(n){return this._iop(n,(r,t)=>r&t)}ixor(n){return this._iop(n,(r,t)=>r^t)}_uop_new(n,r){return this.length>=n.length?this.clone()[r](n):n.clone()[r](this)}or(n){return this.assert(this._sign===0&&n._sign===0),this._uop_new(n,"iuor")}uor(n){return this._uop_new(n,"iuor")}and(n){return this.assert(this._sign===0&&n._sign===0),this._uop_new(n,"iuand")}uand(n){return this._uop_new(n,"iuand")}xor(n){return this.assert(this._sign===0&&n._sign===0),this._uop_new(n,"iuxor")}uxor(n){return this._uop_new(n,"iuxor")}inotn(n){this.assert(typeof n=="number"&&n>=0);const t=(1n<<BigInt(n))-1n;this._magnitude=~this._magnitude&t;const s=n===0?1:Math.ceil(n/De.wordSize);return this._nominalWordLength=Math.max(1,s),this.strip(),this._nominalWordLength=Math.max(this._nominalWordLength,Math.max(1,s)),this}notn(n){return this.clone().inotn(n)}setn(n,r){this.assert(typeof n=="number"&&n>=0);const t=BigInt(n);r===1||r===!0?this._magnitude|=1n<<t:this._magnitude&=~(1n<<t);const s=Math.floor(n/De.wordSize)+1;return this._nominalWordLength=Math.max(this._nominalWordLength,s),this._finishInitialization(),this.strip()}iadd(n){return this._setValueFromSigned(this._getSignedValue()+n._getSignedValue()),this}add(n){const r=new De(0n);return r._setValueFromSigned(this._getSignedValue()+n._getSignedValue()),r}isub(n){return this._setValueFromSigned(this._getSignedValue()-n._getSignedValue()),this}sub(n){const r=new De(0n);return r._setValueFromSigned(this._getSignedValue()-n._getSignedValue()),r}mul(n){const r=new De(0n);return r._magnitude=this._magnitude*n._magnitude,r._sign=r._magnitude===0n?0:this._sign^n._sign,r._nominalWordLength=this.length+n.length,r.red=null,r.normSign()}imul(n){return this._magnitude*=n._magnitude,this._sign=this._magnitude===0n?0:this._sign^n._sign,this._nominalWordLength=this.length+n.length,this.red=null,this.normSign()}imuln(n){return this.assert(typeof n=="number","Assertion failed"),this.assert(Math.abs(n)<=De.MAX_IMULN_ARG,"Assertion failed"),this._setValueFromSigned(this._getSignedValue()*BigInt(n)),this}muln(n){return this.clone().imuln(n)}sqr(){const n=new De(0n);return n._magnitude=this._magnitude*this._magnitude,n._sign=0,n._nominalWordLength=this.length*2,n.red=null,n}isqr(){return this._magnitude*=this._magnitude,this._sign=0,this._nominalWordLength=this.length*2,this.red=null,this}pow(n){if(this.assert(n._sign===0,"Exponent for pow must be non-negative"),n.isZero())return new De(1n);const r=new De(1n),t=this.clone(),s=n.clone(),a=t.isNeg(),c=s.isOdd();for(a&&t.ineg();!s.isZero();)s.isOdd()&&r.imul(t),t.isqr(),s.iushrn(1);return a&&c&&r.ineg(),r}iushln(n){return this.assert(typeof n=="number"&&n>=0),n===0?this:(this._magnitude<<=BigInt(n),this._finishInitialization(),this.strip())}ishln(n){return this.assert(this._sign===0,"ishln requires positive number"),this.iushln(n)}iushrn(n,r,t){if(this.assert(typeof n=="number"&&n>=0),n===0)return t!=null&&t._initializeState(0n,0),this;if(t!=null){const s=(1n<<BigInt(n))-1n,a=this._magnitude&s;t._initializeState(a,0)}return this._magnitude>>=BigInt(n),this._finishInitialization(),this.strip()}ishrn(n,r,t){return this.assert(this._sign===0,"ishrn requires positive number"),this.iushrn(n,r,t)}shln(n){return this.clone().ishln(n)}ushln(n){return this.clone().iushln(n)}shrn(n){return this.clone().ishrn(n)}ushrn(n){return this.clone().iushrn(n)}testn(n){return this.assert(typeof n=="number"&&n>=0),(this._magnitude>>BigInt(n)&1n)!==0n}imaskn(n){this.assert(typeof n=="number"&&n>=0),this.assert(this._sign===0,"imaskn works only with positive numbers");const r=BigInt(n),t=r===0n?0n:(1n<<r)-1n;this._magnitude&=t;const s=n===0?1:Math.max(1,Math.ceil(n/De.wordSize));return this._nominalWordLength=s,this._finishInitialization(),this._nominalWordLength=Math.max(this._nominalWordLength,s),this.strip()}maskn(n){return this.clone().imaskn(n)}iaddn(n){return this.assert(typeof n=="number"),this.assert(Math.abs(n)<=De.MAX_IMULN_ARG,"num is too large"),this._setValueFromSigned(this._getSignedValue()+BigInt(n)),this}_iaddn(n){return this.iaddn(n)}isubn(n){return this.assert(typeof n=="number"),this.assert(Math.abs(n)<=De.MAX_IMULN_ARG,"Assertion failed"),this._setValueFromSigned(this._getSignedValue()-BigInt(n)),this}addn(n){return this.clone().iaddn(n)}subn(n){return this.clone().isubn(n)}iabs(){return this._sign=0,this}abs(){return this.clone().iabs()}divmod(n,r,t){if(this.assert(!n.isZero(),"Division by zero"),this.isZero()){const f=new De(0n);return{div:r!=="mod"?f:null,mod:r!=="div"?f:null}}const s=this._getSignedValue(),a=n._getSignedValue();let c=null,u=null;r!=="mod"&&(c=s/a),r!=="div"&&(u=s%a,t===!0&&u<0n&&(u+=a<0n?-a:a));const l=c!==null?new De(0n):null;l!==null&&c!==null&&l._setValueFromSigned(c);const h=u!==null?new De(0n):null;return h!==null&&u!==null&&h._setValueFromSigned(u),{div:l,mod:h}}div(n){return this.divmod(n,"div",!1).div}mod(n){return this.divmod(n,"mod",!1).mod}umod(n){return this.divmod(n,"mod",!0).mod}divRound(n){this.assert(!n.isZero());const r=this._getSignedValue(),t=n._getSignedValue();let s=r/t;const a=r%t;if(a===0n){const h=new De(0n);return h._setValueFromSigned(s),h}const c=a<0n?-a:a,u=t<0n?-t:t;c*2n>=u&&(r>0n&&t>0n||r<0n&&t<0n?s+=1n:s-=1n);const l=new De(0n);return l._setValueFromSigned(s),l}modrn(n){this.assert(n!==0,"Division by zero in modrn");const r=BigInt(Math.abs(n));if(r===0n)throw new Error("Division by zero in modrn");const t=this._magnitude%r;return n<0?Number(-t):Number(t)}idivn(n){return this.assert(n!==0),this.assert(Math.abs(n)<=De.MAX_IMULN_ARG,"num is too large"),this._setValueFromSigned(this._getSignedValue()/BigInt(n)),this}divn(n){return this.clone().idivn(n)}egcd(n){this.assert(n._sign===0,"p must not be negative"),this.assert(!n.isZero(),"p must not be zero");let r=this._getSignedValue(),t=n._magnitude,s=1n,a=0n,c=0n,u=1n;for(;t!==0n;){const m=r/t;let d=t;t=r%t,r=d,d=a,a=s-m*a,s=d,d=u,u=c-m*u,c=d}const l=new De(0n);l._setValueFromSigned(s);const h=new De(0n);h._setValueFromSigned(c);const f=new De(0n);return f._initializeState(r<0n?-r:r,0),{a:l,b:h,gcd:f}}gcd(n){let r=this._magnitude,t=n._magnitude;if(r===0n){const a=new De(0n);return a._setValueFromSigned(t),a.iabs()}if(t===0n){const a=new De(0n);return a._setValueFromSigned(r),a.iabs()}for(;t!==0n;){const a=r%t;r=t,t=a}const s=new De(0n);return s._initializeState(r,0),s}invm(n){this.assert(!n.isZero()&&n._sign===0,"Modulus for invm must be positive and non-zero");const r=this.egcd(n);if(!r.gcd.eqn(1))throw new Error("Inverse does not exist (numbers are not coprime).");return r.a.umod(n)}isEven(){return this._magnitude%2n===0n}isOdd(){return this._magnitude%2n===1n}andln(n){return this.assert(n>=0),Number(this._magnitude&BigInt(n))}bincn(n){this.assert(typeof n=="number"&&n>=0);const r=1n<<BigInt(n);return this._setValueFromSigned(this._getSignedValue()+r),this}isZero(){return this._magnitude===0n}cmpn(n){this.assert(Math.abs(n)<=De.MAX_IMULN_ARG,"Number is too big");const r=this._getSignedValue(),t=BigInt(n);return r<t?-1:r>t?1:0}cmp(n){const r=this._getSignedValue(),t=n._getSignedValue();return r<t?-1:r>t?1:0}ucmp(n){return this._magnitude<n._magnitude?-1:this._magnitude>n._magnitude?1:0}gtn(n){return this.cmpn(n)===1}gt(n){return this.cmp(n)===1}gten(n){return this.cmpn(n)>=0}gte(n){return this.cmp(n)>=0}ltn(n){return this.cmpn(n)===-1}lt(n){return this.cmp(n)===-1}lten(n){return this.cmpn(n)<=0}lte(n){return this.cmp(n)<=0}eqn(n){return this.cmpn(n)===0}eq(n){return this.cmp(n)===0}toRed(n){return this.assert(this.red==null,"Already a number in reduction context"),this.assert(this._sign===0,"toRed works only with positives"),n.convertTo(this).forceRed(n)}fromRed(){return this.assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)}forceRed(n){return this.red=n,this}redAdd(n){return this.assert(this.red,"redAdd works only with red numbers"),this.red.add(this,n)}redIAdd(n){return this.assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)}redSub(n){return this.assert(this.red,"redSub works only with red numbers"),this.red.sub(this,n)}redISub(n){return this.assert(this.red,"redISub works only with red numbers"),this.red.isub(this,n)}redShl(n){return this.assert(this.red,"redShl works only with red numbers"),this.red.shl(this,n)}redMul(n){return this.assert(this.red,"redMul works only with red numbers"),this.red.verify2(this,n),this.red.mul(this,n)}redIMul(n){return this.assert(this.red,"redIMul works only with red numbers"),this.red.verify2(this,n),this.red.imul(this,n)}redSqr(){return this.assert(this.red,"redSqr works only with red numbers"),this.red.verify1(this),this.red.sqr(this)}redISqr(){return this.assert(this.red,"redISqr works only with red numbers"),this.red.verify1(this),this.red.isqr(this)}redSqrt(){return this.assert(this.red,"redSqrt works only with red numbers"),this.red.verify1(this),this.red.sqrt(this)}redInvm(){return this.assert(this.red,"redInvm works only with red numbers"),this.red.verify1(this),this.red.invm(this)}redNeg(){return this.assert(this.red,"redNeg works only with red numbers"),this.red.verify1(this),this.red.neg(this)}redPow(n){return this.assert(this.red!=null&&n.red==null,"redPow(normalNum)"),this.red.verify1(this),this.red.pow(this,n)}static fromHex(n,r){let t="be";return(r==="little"||r==="le")&&(t="le"),new De(n,16,t)}toHex(n=0){if(this.isZero()&&n===0)return"";let r=this._getMinimalHex();r!=="0"&&r.length%2!==0&&(r="0"+r);const t=n*2;for(;r.length<t;)r="0"+r;return(this.isNeg()?"-":"")+r}static fromJSON(n){return new De(n,16)}static fromNumber(n){return new De(n)}static fromString(n,r){return new De(n,r)}static fromSm(n,r="big"){if(n.length===0)return new De(0n);let t=0,s="";if(r==="little"){const u=n.length-1;let l=n[u];(l&128)!==0&&(t=1,l&=127),s+=(l<16?"0":"")+l.toString(16);for(let h=u-1;h>=0;h--){const f=n[h];s+=(f<16?"0":"")+f.toString(16)}}else{let u=n[0];(u&128)!==0&&(t=1,u&=127),s+=(u<16?"0":"")+u.toString(16);for(let l=1;l<n.length;l++){const h=n[l];s+=(h<16?"0":"")+h.toString(16)}}const a=s===""?0n:BigInt("0x"+s),c=new De(0n);return c._initializeState(a,t),c}toSm(n="big"){if(this._magnitude===0n)return this._sign===1?[128]:[];let r=this._getMinimalHex();r.length%2!==0&&(r="0"+r);const t=r.length/2,s=new Array(t);for(let a=0,c=0;a<r.length;a+=2)s[c++]=parseInt(r.slice(a,a+2),16);return this._sign===1?(s[0]&128)!==0?s.unshift(128):s[0]|=128:(s[0]&128)!==0&&s.unshift(0),n==="little"?s.reverse():s}static fromBits(n,r=!1){const t=n>>>24,s=n&8388607,a=(n&8388608)!==0;if(r&&a)throw new Error("negative bit set");if(t===0&&s===0){if(a&&r)throw new Error("negative bit set for zero value");return new De(0n)}const c=new De(s);return t<=3?c.iushrn((3-t)*8):c.iushln((t-3)*8),a&&c.ineg(),c}toBits(){if(this.strip(),this.isZero()&&!this.isNeg())return 0;const n=this.isNeg(),r=this.abs();let t=r.toArray("be"),s=0;for(;s<t.length-1&&t[s]===0;)s++;t=t.slice(s);let a=t.length;a===0&&!r.isZero()&&(t=[0],a=1),r.isZero()&&(a=0,t=[]);let c;if(a===0)c=0;else if(a<=3){c=0;for(let l=0;l<a;l++)c=c<<8|t[l]}else c=t[0]<<16|t[1]<<8|t[2];(c&8388608)!==0&&a<=255&&(c>>>=8,a++);let u=a<<24|c;return n&&(u|=8388608),u>>>0}static fromScriptNum(n,r=!1,t){if(t!==void 0&&n.length>t)throw new Error("script number overflow");if(n.length===0)return new De(0n);if(r&&(n[n.length-1]&127)===0&&(n.length<=1||(n[n.length-2]&128)===0))throw new Error("non-minimally encoded script number");return De.fromSm(n,"little")}toScriptNum(){return this.toSm("little")}_invmp(n){this.assert(n._sign===0,"p must not be negative for _invmp"),this.assert(!n.isZero(),"p must not be zero for _invmp");let t=this.umod(n)._magnitude,s=n._magnitude,a=1n,c=0n;const u=n._magnitude;for(;t>1n&&s>1n;){let f=0;for(;(t>>BigInt(f)&1n)===0n;)f++;if(f>0){t>>=BigInt(f);for(let d=0;d<f;++d)(a&1n)!==0n&&(a+=u),a>>=1n}let m=0;for(;(s>>BigInt(m)&1n)===0n;)m++;if(m>0){s>>=BigInt(m);for(let d=0;d<m;++d)(c&1n)!==0n&&(c+=u),c>>=1n}t>=s?(t-=s,a-=c):(s-=t,c-=a)}let l;if(t===1n)l=a;else if(s===1n)l=c;else if(t===0n&&s===1n)l=c;else if(s===0n&&t===1n)l=a;else throw new Error("_invmp: GCD is not 1, inverse does not exist. aVal="+t+", bVal="+s);l%=u,l<0n&&(l+=u);const h=new De(0n);return h._initializeState(l,0),h}mulTo(n,r){return r._magnitude=this._magnitude*n._magnitude,r._sign=r._magnitude===0n?0:this._sign^n._sign,r._nominalWordLength=this.length+n.length,r.red=null,r.normSign(),r}};return i.zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],i.groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],i.groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],i.wordSize=26,i.WORD_SIZE_BIGINT=BigInt(i.wordSize),i.WORD_MASK=(1n<<i.WORD_SIZE_BIGINT)-1n,i.MAX_SAFE_INTEGER_BIGINT=BigInt(Number.MAX_SAFE_INTEGER),i.MIN_SAFE_INTEGER_BIGINT=BigInt(Number.MIN_SAFE_INTEGER),i.MAX_IMULN_ARG=67108863,i.MAX_NUMBER_CONSTRUCTOR_MAG_BIGINT=(1n<<53n)-1n,tp.default=i,tp}var mc={},wc={},vc={},xc={},nS;function oB(){if(nS)return xc;nS=1;var i=xc&&xc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xc,"__esModule",{value:!0});const e=i(an());let n=class{constructor(t,s){this.name=t,this.p=new e.default(s,16),this.n=this.p.bitLength(),this.k=new e.default(BigInt(1)).iushln(this.n).isub(this.p),this.tmp=this._tmp()}_tmp(){const t=new e.default(BigInt(0)),s=Math.ceil(this.n/e.default.wordSize);return t.expand(Math.max(1,s)),t}ireduce(t){const s=t;let a;do this.split(s,this.tmp),this.imulK(s),s.iadd(this.tmp),a=s.bitLength();while(a>this.n);const c=a<this.n?-1:s.ucmp(this.p);return c===0?s.words=[0]:c>0&&s.isub(this.p),s.strip(),s}split(t,s){t.iushrn(this.n,0,s)}imulK(t){return t.imul(this.k)}};return xc.default=n,xc}var iS;function cB(){if(iS)return vc;iS=1;var i=vc&&vc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vc,"__esModule",{value:!0});const e=i(oB());let n=class extends e.default{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}split(t,s){const c=t.words,u=t.length,l=Math.min(u,9),h=new Array(l+(u>9?1:0)).fill(0);for(let v=0;v<l;v++)h[v]=c[v];let f=l;if(u<=9){const v=new Array(f);for(let _=0;_<f;++_)v[_]=h[_];s.words=v,t.words=[0];return}let m=c[9];h[f++]=m&4194303;const d=new Array(f);for(let v=0;v<f;++v)d[v]=h[v];s.words=d;const y=new Array(Math.max(1,u-9)).fill(0);let b=0;for(let v=10;v<u;v++){const _=c[v]|0;b<y.length&&(y[b++]=(_&4194303)<<4|m>>>22),m=_}m>>>=22,b<y.length?y[b++]=m:m!==0&&y.length>0;const g=new Array(b);for(let v=0;v<b;++v)g[v]=y[v];t.words=g}imulK(t){const s=t.words,a=t.length,c=a+2,u=new Array(c).fill(0);for(let h=0;h<a;h++)u[h]=s[h];let l=0;for(let h=0;h<c;h++){const f=u[h]|0;l+=f*977,u[h]=l&67108863,l=f*64+(l/67108864|0)}return t.words=u,t}};return vc.default=n,vc}var rS;function _w(){if(rS)return wc;rS=1;var i=wc&&wc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wc,"__esModule",{value:!0});const e=i(an()),n=i(cB());let r=class{constructor(s){if(s==="k256"){const a=new n.default;this.m=a.p,this.prime=a}else this.assert(s.gtn(1),"modulus must be greater than 1"),this.m=s,this.prime=null}assert(s,a="Assertion failed"){if(!s)throw new Error(a)}verify1(s){this.assert(s.negative===0,"red works only with positives"),this.assert(s.red,"red works only with red numbers")}verify2(s,a){this.assert((s.negative|a.negative)===0,"red works only with positives"),this.assert(s.red!=null&&s.red===a.red,"red works only with red numbers")}imod(s){return this.prime!=null?this.prime.ireduce(s).forceRed(this):(e.default.move(s,s.umod(this.m).forceRed(this)),s)}neg(s){return s.isZero()?s.clone():this.m.sub(s).forceRed(this)}add(s,a){this.verify2(s,a);const c=s.add(a);return c.cmp(this.m)>=0&&c.isub(this.m),c.forceRed(this)}iadd(s,a){this.verify2(s,a);const c=s.iadd(a);return c.cmp(this.m)>=0&&c.isub(this.m),c}sub(s,a){this.verify2(s,a);const c=s.sub(a);return c.cmpn(0)<0&&c.iadd(this.m),c.forceRed(this)}isub(s,a){this.verify2(s,a);const c=s.isub(a);return c.cmpn(0)<0&&c.iadd(this.m),c}shl(s,a){return this.verify1(s),this.imod(s.ushln(a))}imul(s,a){return this.verify2(s,a),this.imod(s.imul(a))}mul(s,a){return this.verify2(s,a),this.imod(s.mul(a))}isqr(s){return this.imul(s,s.clone())}sqr(s){return this.mul(s,s)}sqrt(s){if(s.isZero())return s.clone();const a=this.m.andln(3);if(this.assert(a%2===1),a===3){const _=this.m.add(new e.default(1)).iushrn(2);return this.pow(s,_)}const c=this.m.subn(1);let u=0;for(;!c.isZero()&&c.andln(1)===0;)u++,c.iushrn(1);this.assert(!c.isZero());const l=new e.default(1).toRed(this),h=l.redNeg(),f=this.m.subn(1).iushrn(1),m=this.m.bitLength(),d=new e.default(2*m*m).toRed(this);for(;this.pow(d,f).cmp(h)!==0;)d.redIAdd(h);let y=this.pow(d,c),b=this.pow(s,c.addn(1).iushrn(1)),g=this.pow(s,c),v=u;for(;g.cmp(l)!==0;){let _=g,S=0;for(;_.cmp(l)!==0;S++)_=_.redSqr();this.assert(S<v);const I=this.pow(y,new e.default(1).iushln(v-S-1));b=b.redMul(I),y=I.redSqr(),g=g.redMul(y),v=S}return b}invm(s){const a=s._invmp(this.m);return a.negative!==0?(a.negative=0,this.imod(a).redNeg()):this.imod(a)}pow(s,a){if(a.isZero())return new e.default(1).toRed(this);if(a.cmpn(1)===0)return s.clone();const c=4,u=new Array(1<<c);u[0]=new e.default(1).toRed(this),u[1]=s;let l=2;for(;l<u.length;l++)u[l]=this.mul(u[l-1],s);let h=u[0],f=0,m=0,d=a.bitLength()%26;for(d===0&&(d=26),l=a.length-1;l>=0;l--){const y=a.words[l];for(let b=d-1;b>=0;b--){const g=y>>b&1;if(h!==u[0]&&(h=this.sqr(h)),g===0&&f===0){m=0;continue}f<<=1,f|=g,m++,!(m!==c&&(l!==0||b!==0))&&(h=this.mul(h,u[f]),m=0,f=0)}d=26}return h}convertTo(s){const a=s.umod(this.m);return a===s?a.clone():a}convertFrom(s){const a=s.clone();return a.red=null,a}};return wc.default=r,wc}var _c={},aS;function uB(){if(aS)return _c;aS=1;var i=_c&&_c.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_c,"__esModule",{value:!0});const e=i(_w()),n=i(an());let r=class extends e.default{constructor(s){super(s),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n.default(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}convertTo(s){return this.imod(s.ushln(this.shift))}convertFrom(s){const a=this.imod(s.mul(this.rinv));return a.red=null,a}imul(s,a){if(s.isZero()||a.isZero())return s.words[0]=0,s.length=1,s;const c=s.imul(a),u=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=c.isub(u).iushrn(this.shift);let h=l;return l.cmp(this.m)>=0?h=l.isub(this.m):l.cmpn(0)<0&&(h=l.iadd(this.m)),h.forceRed(this)}mul(s,a){if(s.isZero()||a.isZero())return new n.default(0).forceRed(this);const c=s.mul(a),u=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=c.isub(u).iushrn(this.shift);let h=l;return l.cmp(this.m)>=0?h=l.isub(this.m):l.cmpn(0)<0&&(h=l.iadd(this.m)),h.forceRed(this)}invm(s){return this.imod(s._invmp(this.m).mul(this.r2)).forceRed(this)}};return _c.default=r,_c}var Sc={},Ic={},sS;function v6(){if(sS)return Ic;sS=1;var i=Ic&&Ic.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ic,"__esModule",{value:!0});const e=i(qr());let n=class{constructor(t){this.curve=new e.default,this.type=t,this.precomputed=null}};return Ic.default=n,Ic}var Tc={},oS;function lB(){if(oS)return Tc;oS=1;var i=Tc&&Tc.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Tc,"__esModule",{value:!0});const e=i(v6()),n=i(an()),r=i(xu());let t=class wo extends e.default{constructor(a,c,u){super("jacobian"),a===null&&c===null&&u===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n.default(0)):(n.default.isBN(a)||(a=new n.default(a,16)),this.x=a,n.default.isBN(c)||(c=new n.default(c,16)),this.y=c,n.default.isBN(u)||(u=new n.default(u,16)),this.z=u),this.x.red==null&&(this.x=this.x.toRed(this.curve.red)),this.y.red==null&&(this.y=this.y.toRed(this.curve.red)),this.z.red==null&&(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}toP(){if(this.isInfinity())return new r.default(null,null);const a=this.z.redInvm(),c=a.redSqr(),u=this.x.redMul(c),l=this.y.redMul(c).redMul(a);return new r.default(u,l)}neg(){return new wo(this.x,this.y.redNeg(),this.z)}add(a){if(this.isInfinity())return a;if(a.isInfinity())return this;const c=a.z.redSqr(),u=this.z.redSqr(),l=this.x.redMul(c),h=a.x.redMul(u),f=this.y.redMul(c.redMul(a.z)),m=a.y.redMul(u.redMul(this.z)),d=l.redSub(h),y=f.redSub(m);if(d.cmpn(0)===0)return y.cmpn(0)!==0?new wo(null,null,null):this.dbl();const b=d.redSqr(),g=b.redMul(d),v=l.redMul(b),_=y.redSqr().redIAdd(g).redISub(v).redISub(v),S=y.redMul(v.redISub(_)).redISub(f.redMul(g)),I=this.z.redMul(a.z).redMul(d);return new wo(_,S,I)}mixedAdd(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;if(a.x===null||a.y===null)throw new Error("Point coordinates cannot be null");const c=this.z.redSqr(),u=this.x,l=a.x.redMul(c),h=this.y,f=a.y.redMul(c).redMul(this.z),m=u.redSub(l),d=h.redSub(f);if(m.cmpn(0)===0)return d.cmpn(0)!==0?new wo(null,null,null):this.dbl();const y=m.redSqr(),b=y.redMul(m),g=u.redMul(y),v=d.redSqr().redIAdd(b).redISub(g).redISub(g),_=d.redMul(g.redISub(v)).redISub(h.redMul(b)),S=this.z.redMul(m);return new wo(v,_,S)}dblp(a){if(a===0)return this;if(this.isInfinity())return this;if(typeof a>"u")return this.dbl();let c=this;for(let u=0;u<a;u++)c=c.dbl();return c}dbl(){if(this.isInfinity())return this;let a,c,u;if(this.zOne){const l=this.x.redSqr(),h=this.y.redSqr(),f=h.redSqr();let m=this.x.redAdd(h).redSqr().redISub(l).redISub(f);m=m.redIAdd(m);const d=l.redAdd(l).redIAdd(l),y=d.redSqr().redISub(m).redISub(m);let b=f.redIAdd(f);b=b.redIAdd(b),b=b.redIAdd(b),a=y,c=d.redMul(m.redISub(y)).redISub(b),u=this.y.redAdd(this.y)}else{const l=this.x.redSqr(),h=this.y.redSqr(),f=h.redSqr();let m=this.x.redAdd(h).redSqr().redISub(l).redISub(f);m=m.redIAdd(m);const d=l.redAdd(l).redIAdd(l),y=d.redSqr();let b=f.redIAdd(f);b=b.redIAdd(b),b=b.redIAdd(b),a=y.redISub(m).redISub(m),c=d.redMul(m.redISub(a)).redISub(b),u=this.y.redMul(this.z),u=u.redIAdd(u)}return new wo(a,c,u)}eq(a){if(a.type==="affine")return this.eq(a.toJ());if(this===a)return!0;const c=this.z.redSqr();a=a;const u=a.z.redSqr();if(this.x.redMul(u).redISub(a.x.redMul(c)).cmpn(0)!==0)return!1;const l=c.redMul(this.z),h=u.redMul(a.z);return this.y.redMul(h).redISub(a.y.redMul(l)).cmpn(0)===0}eqXToP(a){var c;const u=this.z.redSqr(),l=a.toRed((c=this.curve)===null||c===void 0?void 0:c.red).redMul(u);if(this.x.cmp(l)===0)return!0;const h=a.clone();if(this.curve===null||this.curve.redN==null)throw new Error("Curve or redN is not initialized.");const f=this.curve.redN.redMul(u);for(;h.cmp(this.curve.p)<0;){if(h.iadd(this.curve.n),h.cmp(this.curve.p)>=0)return!1;if(l.redIAdd(f),this.x.cmp(l)===0)return!0}return!1}inspect(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"}isInfinity(){return this.z.cmpn(0)===0}};return Tc.default=t,Tc}var Ol={},vb={},cS;function sn(){return cS||(cS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pbkdf2=i.sha512hmac=i.sha256hmac=i.hash160=i.hash256=i.sha512=i.sha256=i.sha1=i.ripemd160=i.SHA512HMAC=i.SHA1HMAC=i.SHA256HMAC=i.SHA512=i.SHA1=i.SHA256=i.RIPEMD160=i.toArray=void 0;const e=(Y,X="Hash assertion failed")=>{if(!Y)throw new Error(X)};class n{constructor(X,re,le,se){this.pending=null,this.pendingTotal=0,this.blockSize=X,this.outSize=re,this.hmacStrength=le,this.padLength=se/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}_update(X,re){throw new Error("Not implemented")}_digest(){throw new Error("Not implemented")}_digestHex(){throw new Error("Not implemented")}update(X,re){if(X=t(X,re),this.pending==null?this.pending=X:this.pending=this.pending.concat(X),this.pendingTotal+=X.length,this.pending.length>=this._delta8){X=this.pending;const le=X.length%this._delta8;this.pending=X.slice(X.length-le,X.length),this.pending.length===0&&(this.pending=null),X=u(X,0,X.length-le,this.endian);for(let se=0;se<X.length;se+=this._delta32)this._update(X,se)}return this}digest(){return this.update(this._pad()),e(this.pending===null),this._digest()}digestHex(){return this.update(this._pad()),e(this.pending===null),this._digestHex()}_pad(){let X=this.pendingTotal;const re=this._delta8,le=re-(X+this.padLength)%re,se=new Array(le+this.padLength);se[0]=128;let ye;for(ye=1;ye<le;ye++)se[ye]=0;X<<=3;let Oe;if(this.endian==="big"){for(Oe=8;Oe<this.padLength;Oe++)se[ye++]=0;se[ye++]=0,se[ye++]=0,se[ye++]=0,se[ye++]=0,se[ye++]=X>>>24&255,se[ye++]=X>>>16&255,se[ye++]=X>>>8&255,se[ye++]=X&255}else for(se[ye++]=X&255,se[ye++]=X>>>8&255,se[ye++]=X>>>16&255,se[ye++]=X>>>24&255,se[ye++]=0,se[ye++]=0,se[ye++]=0,se[ye++]=0,Oe=8;Oe<this.padLength;Oe++)se[ye++]=0;return se}}function r(Y,X){return(Y.charCodeAt(X)&64512)!==55296||X<0||X+1>=Y.length?!1:(Y.charCodeAt(X+1)&64512)===56320}function t(Y,X){if(Array.isArray(Y))return Y.slice();if(!Y)return[];const re=[];if(typeof Y=="string")if(X!=="hex"){let le=0;for(let se=0;se<Y.length;se++){let ye=Y.charCodeAt(se);ye<128?re[le++]=ye:ye<2048?(re[le++]=ye>>6|192,re[le++]=ye&63|128):r(Y,se)?(ye=65536+((ye&1023)<<10)+(Y.charCodeAt(++se)&1023),re[le++]=ye>>18|240,re[le++]=ye>>12&63|128,re[le++]=ye>>6&63|128,re[le++]=ye&63|128):(re[le++]=ye>>12|224,re[le++]=ye>>6&63|128,re[le++]=ye&63|128)}}else{Y=Y.replace(/[^a-z0-9]+/gi,""),Y.length%2!==0&&(Y="0"+Y);for(let le=0;le<Y.length;le+=2)re.push(parseInt(Y[le]+Y[le+1],16))}else{Y=Y;for(let le=0;le<Y.length;le++)re[le]=Y[le]|0}return re}i.toArray=t;function s(Y){return(Y>>>24|Y>>>8&65280|Y<<8&16711680|(Y&255)<<24)>>>0}function a(Y,X){let re="";for(let le=0;le<Y.length;le++){let se=Y[le];X==="little"&&(se=s(se)),re+=c(se.toString(16))}return re}function c(Y){return Y.length===7?"0"+Y:Y.length===6?"00"+Y:Y.length===5?"000"+Y:Y.length===4?"0000"+Y:Y.length===3?"00000"+Y:Y.length===2?"000000"+Y:Y.length===1?"0000000"+Y:Y}function u(Y,X,re,le){const se=re-X;e(se%4===0);const ye=new Array(se/4);for(let Oe=0,Fe=X;Oe<ye.length;Oe++,Fe+=4){let Ve;le==="big"?Ve=Y[Fe]<<24|Y[Fe+1]<<16|Y[Fe+2]<<8|Y[Fe+3]:Ve=Y[Fe+3]<<24|Y[Fe+2]<<16|Y[Fe+1]<<8|Y[Fe],ye[Oe]=Ve>>>0}return ye}function l(Y,X){const re=new Array(Y.length*4);for(let le=0,se=0;le<Y.length;le++,se+=4){const ye=Y[le];X==="big"?(re[se]=ye>>>24,re[se+1]=ye>>>16&255,re[se+2]=ye>>>8&255,re[se+3]=ye&255):(re[se+3]=ye>>>24,re[se+2]=ye>>>16&255,re[se+1]=ye>>>8&255,re[se]=ye&255)}return re}function h(Y,X){return Y>>>X|Y<<32-X}function f(Y,X){return Y<<X|Y>>>32-X}function m(Y,X){return Y+X>>>0}function d(Y,X,re){return Y+X+re>>>0}function y(Y,X,re,le){return Y+X+re+le>>>0}function b(Y,X,re,le,se){return Y+X+re+le+se>>>0}function g(Y,X,re,le){if(Y===0)return v(X,re,le);if(Y===1||Y===3)return S(X,re,le);if(Y===2)return _(X,re,le)}function v(Y,X,re){return Y&X^~Y&re}function _(Y,X,re){return Y&X^Y&re^X&re}function S(Y,X,re){return Y^X^re}function I(Y){return h(Y,2)^h(Y,13)^h(Y,22)}function A(Y){return h(Y,6)^h(Y,11)^h(Y,25)}function R(Y){return h(Y,7)^h(Y,18)^Y>>>3}function E(Y){return h(Y,17)^h(Y,19)^Y>>>10}const k=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],P=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],T=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],M=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function C(Y,X,re,le){return Y<=15?X^re^le:Y<=31?X&re|~X&le:Y<=47?(X|~re)^le:Y<=63?X&le|re&~le:X^(re|~le)}function D(Y){return Y<=15?0:Y<=31?1518500249:Y<=47?1859775393:Y<=63?2400959708:2840853838}function F(Y){return Y<=15?1352829926:Y<=31?1548603684:Y<=47?1836072691:Y<=63?2053994217:0}function B(Y,X,re,le){const se=Y[X],ye=Y[X+1],Oe=le+ye>>>0,Fe=(Oe<le?1:0)+re+se;Y[X]=Fe>>>0,Y[X+1]=Oe}function L(Y,X,re,le){return(X+le>>>0<X?1:0)+Y+re>>>0}function q(Y,X,re,le){return X+le>>>0}function K(Y,X,re,le,se,ye,Oe,Fe){let Ve=0,$e=X;return $e=$e+le>>>0,Ve+=$e<X?1:0,$e=$e+ye>>>0,Ve+=$e<ye?1:0,$e=$e+Fe>>>0,Ve+=$e<Fe?1:0,Y+re+se+Oe+Ve>>>0}function $(Y,X,re,le,se,ye,Oe,Fe){return X+le+ye+Fe>>>0}function U(Y,X,re,le,se,ye,Oe,Fe,Ve,$e){let et=0,ze=X;return ze=ze+le>>>0,et+=ze<X?1:0,ze=ze+ye>>>0,et+=ze<ye?1:0,ze=ze+Fe>>>0,et+=ze<Fe?1:0,ze=ze+$e>>>0,et+=ze<$e?1:0,Y+re+se+Oe+Ve+et>>>0}function z(Y,X,re,le,se,ye,Oe,Fe,Ve,$e){return X+le+ye+Fe+$e>>>0}function G(Y,X,re){return(X<<32-re|Y>>>re)>>>0}function ne(Y,X,re){return(Y<<32-re|X>>>re)>>>0}function ce(Y,X,re){return Y>>>re}function Se(Y,X,re){return(Y<<32-re|X>>>re)>>>0}class Ie extends n{constructor(){super(512,160,192,64),this.endian="little",this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}_update(X,re){let le=this.h[0],se=this.h[1],ye=this.h[2],Oe=this.h[3],Fe=this.h[4],Ve=le,$e=se,et=ye,ze=Oe,mt=Fe,Ae;for(let nt=0;nt<80;nt++)Ae=m(f(y(le,C(nt,se,ye,Oe),X[k[nt]+re],D(nt)),T[nt]),Fe),le=Fe,Fe=Oe,Oe=f(ye,10),ye=se,se=Ae,Ae=m(f(y(Ve,C(79-nt,$e,et,ze),X[P[nt]+re],F(nt)),M[nt]),mt),Ve=mt,mt=ze,ze=f(et,10),et=$e,$e=Ae;Ae=d(this.h[1],ye,ze),this.h[1]=d(this.h[2],Oe,mt),this.h[2]=d(this.h[3],Fe,Ve),this.h[3]=d(this.h[4],le,$e),this.h[4]=d(this.h[0],se,et),this.h[0]=Ae}_digest(){return l(this.h,"little")}_digestHex(){return a(this.h,"little")}}i.RIPEMD160=Ie;class me extends n{constructor(){super(512,256,192,64),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],this.W=new Array(64)}_update(X,re){const le=this.W;re===void 0&&(re=0);let se;for(se=0;se<16;se++)le[se]=X[re+se];for(;se<le.length;se++)le[se]=y(E(le[se-2]),le[se-7],R(le[se-15]),le[se-16]);let ye=this.h[0],Oe=this.h[1],Fe=this.h[2],Ve=this.h[3],$e=this.h[4],et=this.h[5],ze=this.h[6],mt=this.h[7];for(e(this.k.length===le.length),se=0;se<le.length;se++){const Ae=b(mt,A($e),v($e,et,ze),this.k[se],le[se]),nt=m(I(ye),_(ye,Oe,Fe));mt=ze,ze=et,et=$e,$e=m(Ve,Ae),Ve=Fe,Fe=Oe,Oe=ye,ye=m(Ae,nt)}this.h[0]=m(this.h[0],ye),this.h[1]=m(this.h[1],Oe),this.h[2]=m(this.h[2],Fe),this.h[3]=m(this.h[3],Ve),this.h[4]=m(this.h[4],$e),this.h[5]=m(this.h[5],et),this.h[6]=m(this.h[6],ze),this.h[7]=m(this.h[7],mt)}_digest(){return l(this.h,"big")}_digestHex(){return a(this.h,"big")}}i.SHA256=me;class xe extends n{constructor(){super(512,160,80,64),this.k=[1518500249,1859775393,2400959708,3395469782],this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}_update(X,re){const le=this.W;re===void 0&&(re=0);let se;for(se=0;se<16;se++)le[se]=X[re+se];for(;se<le.length;se++)le[se]=f(le[se-3]^le[se-8]^le[se-14]^le[se-16],1);let ye=this.h[0],Oe=this.h[1],Fe=this.h[2],Ve=this.h[3],$e=this.h[4];for(se=0;se<le.length;se++){const et=~~(se/20),ze=b(f(ye,5),g(et,Oe,Fe,Ve),$e,le[se],this.k[et]);$e=Ve,Ve=Fe,Fe=f(Oe,30),Oe=ye,ye=ze}this.h[0]=m(this.h[0],ye),this.h[1]=m(this.h[1],Oe),this.h[2]=m(this.h[2],Fe),this.h[3]=m(this.h[3],Ve),this.h[4]=m(this.h[4],$e)}_digest(){return l(this.h,"big")}_digestHex(){return a(this.h,"big")}}i.SHA1=xe;class ke extends n{constructor(){super(1024,512,192,128),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],this.W=new Array(160)}_prepareBlock(X,re){const le=this.W;let se;for(se=0;se<32;se++)le[se]=X[re+se];for(;se<le.length;se+=2){const ye=j(le[se-4],le[se-3]),Oe=he(le[se-4],le[se-3]),Fe=le[se-14],Ve=le[se-13],$e=At(le[se-30],le[se-29]),et=Te(le[se-30],le[se-29]),ze=le[se-32],mt=le[se-31];le[se]=K(ye,Oe,Fe,Ve,$e,et,ze,mt),le[se+1]=$(ye,Oe,Fe,Ve,$e,et,ze,mt)}}_update(X,re){this._prepareBlock(X,re);const le=this.W;let se=this.h[0],ye=this.h[1],Oe=this.h[2],Fe=this.h[3],Ve=this.h[4],$e=this.h[5],et=this.h[6],ze=this.h[7],mt=this.h[8],Ae=this.h[9],nt=this.h[10],gr=this.h[11],qn=this.h[12],Zt=this.h[13],xn=this.h[14],br=this.h[15];e(this.k.length===le.length);for(let mr=0;mr<le.length;mr+=2){let ws=xn,vs=br,Ba=Ht(mt,Ae),zi=Je(mt,Ae);const Po=Re(mt,Ae,nt,gr,qn),Vr=Ce(mt,Ae,nt,gr,qn,Zt),Kr=this.k[mr],Da=this.k[mr+1],Wr=le[mr],Jt=le[mr+1],xs=U(ws,vs,Ba,zi,Po,Vr,Kr,Da,Wr,Jt),_s=z(ws,vs,Ba,zi,Po,Vr,Kr,Da,Wr,Jt);ws=dt(se,ye),vs=Ut(se,ye),Ba=Ne(se,ye,Oe,Fe,Ve),zi=We(se,ye,Oe,Fe,Ve,$e);const wr=L(ws,vs,Ba,zi),$r=q(ws,vs,Ba,zi);xn=qn,br=Zt,qn=nt,Zt=gr,nt=mt,gr=Ae,mt=L(et,ze,xs,_s),Ae=q(ze,ze,xs,_s),et=Ve,ze=$e,Ve=Oe,$e=Fe,Oe=se,Fe=ye,se=L(xs,_s,wr,$r),ye=q(xs,_s,wr,$r)}B(this.h,0,se,ye),B(this.h,2,Oe,Fe),B(this.h,4,Ve,$e),B(this.h,6,et,ze),B(this.h,8,mt,Ae),B(this.h,10,nt,gr),B(this.h,12,qn,Zt),B(this.h,14,xn,br)}_digest(){return l(this.h,"big")}_digestHex(){return a(this.h,"big")}}i.SHA512=ke;function Re(Y,X,re,le,se,ye){let Oe=Y&re^~Y&se;return Oe<0&&(Oe+=4294967296),Oe}function Ce(Y,X,re,le,se,ye){let Oe=X&le^~X&ye;return Oe<0&&(Oe+=4294967296),Oe}function Ne(Y,X,re,le,se,ye){let Oe=Y&re^Y&se^re&se;return Oe<0&&(Oe+=4294967296),Oe}function We(Y,X,re,le,se,ye){let Oe=X&le^X&ye^le&ye;return Oe<0&&(Oe+=4294967296),Oe}function dt(Y,X){const re=G(Y,X,28),le=G(X,Y,2),se=G(X,Y,7);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function Ut(Y,X){const re=ne(Y,X,28),le=ne(X,Y,2),se=ne(X,Y,7);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function Ht(Y,X){const re=G(Y,X,14),le=G(Y,X,18),se=G(X,Y,9);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function Je(Y,X){const re=ne(Y,X,14),le=ne(Y,X,18),se=ne(X,Y,9);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function At(Y,X){const re=G(Y,X,1),le=G(Y,X,8),se=ce(Y,X,7);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function Te(Y,X){const re=ne(Y,X,1),le=ne(Y,X,8),se=Se(Y,X,7);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function j(Y,X){const re=G(Y,X,19),le=G(X,Y,29),se=ce(Y,X,6);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}function he(Y,X){const re=ne(Y,X,19),le=ne(X,Y,29),se=Se(Y,X,6);let ye=re^le^se;return ye<0&&(ye+=4294967296),ye}class de{constructor(X){this.blockSize=64,this.outSize=32,X=t(X,"hex"),X.length>this.blockSize&&(X=new me().update(X).digest()),e(X.length<=this.blockSize);let re;for(re=X.length;re<this.blockSize;re++)X.push(0);for(re=0;re<X.length;re++)X[re]^=54;for(this.inner=new me().update(X),re=0;re<X.length;re++)X[re]^=106;this.outer=new me().update(X)}update(X,re){return this.inner.update(X,re),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}i.SHA256HMAC=de;class Me{constructor(X){this.blockSize=64,X=t(X,"hex"),X.length>this.blockSize&&(X=new xe().update(X).digest());let re;for(re=X.length;re<this.blockSize;re++)X.push(0);for(re=0;re<X.length;re++)X[re]^=54;for(this.inner=new xe().update(X),re=0;re<X.length;re++)X[re]^=106;this.outer=new xe().update(X)}update(X,re){return this.inner.update(X,re),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}i.SHA1HMAC=Me;class ct{constructor(X){this.blockSize=128,this.outSize=32,X=t(X,"hex"),X.length>this.blockSize&&(X=new ke().update(X).digest()),e(X.length<=this.blockSize);let re;for(re=X.length;re<this.blockSize;re++)X.push(0);for(re=0;re<X.length;re++)X[re]^=54;for(this.inner=new ke().update(X),re=0;re<X.length;re++)X[re]^=106;this.outer=new ke().update(X)}update(X,re){return this.inner.update(X,re),this}digest(){return this.outer.update(this.inner.digest()),this.outer.digest()}digestHex(){return this.outer.update(this.inner.digest()),this.outer.digestHex()}}i.SHA512HMAC=ct;const Hn=(Y,X)=>new Ie().update(Y,X).digest();i.ripemd160=Hn;const wn=(Y,X)=>new xe().update(Y,X).digest();i.sha1=wn;const Dt=(Y,X)=>new me().update(Y,X).digest();i.sha256=Dt;const vn=(Y,X)=>new ke().update(Y,X).digest();i.sha512=vn;const qt=(Y,X)=>{const re=new me().update(Y,X).digest();return new me().update(re).digest()};i.hash256=qt;const Wt=(Y,X)=>{const re=new me().update(Y,X).digest();return new Ie().update(re).digest()};i.hash160=Wt;const rt=(Y,X,re)=>new de(Y).update(X,re).digest();i.sha256hmac=rt;const An=(Y,X,re)=>new ct(Y).update(X,re).digest();i.sha512hmac=An;function Lt(Y,X,re,le,se="sha512"){if(se!=="sha512")throw new Error("Only sha512 is supported in this PBKDF2 implementation");const ye=new Array(le),Oe=[...X,0,0,0,0];let Fe=0;const Ve=64,$e=Math.ceil(le/Ve);for(let et=1;et<=$e;et++){Oe[X.length]=et>>24&255,Oe[X.length+1]=et>>16&255,Oe[X.length+2]=et>>8&255,Oe[X.length+3]=et&255;const ze=(0,i.sha512hmac)(Y,Oe);let mt=ze;for(let Ae=1;Ae<re;Ae++){mt=(0,i.sha512hmac)(Y,mt);for(let nt=0;nt<Ve;nt++)ze[nt]^=mt[nt]}for(let Ae=0;Ae<ze.length;Ae++)ye[Fe+Ae]=ze[Ae];Fe+=Ve}return ye.slice(0,le)}i.pbkdf2=Lt}(vb)),vb}var uS;function Ze(){return uS||(uS=1,function(i){var e=Ol&&Ol.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(i,"__esModule",{value:!0}),i.minimallyEncode=i.Reader=i.Writer=i.fromBase58Check=i.toBase58Check=i.toBase58=i.fromBase58=i.toBase64=i.encode=i.toUTF8=i.toArray=i.toHex=i.zero2=void 0;const n=e(an()),r=sn(),t=E=>E.length%2===1?"0"+E:E;i.zero2=t;const s=E=>{let k="";for(const P of E)k+=(0,i.zero2)(P.toString(16));return k};i.toHex=s;const a=(E,k)=>{if(Array.isArray(E))return E.slice();if(E===void 0)return[];if(typeof E!="string")return Array.from(E,P=>P|0);switch(k){case"hex":return c(E);case"base64":return u(E);default:return l(E)}};i.toArray=a;const c=E=>{E=E.replace(/[^a-z0-9]+/gi,""),E.length%2!==0&&(E="0"+E);const k=[];for(let P=0;P<E.length;P+=2)k.push(parseInt(E[P]+E[P+1],16));return k},u=E=>{const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=[];let T=0,M=0;for(const C of E.replace(/=+$/,""))T=T<<6|k.indexOf(C),M+=6,M>=8&&(M-=8,P.push(T>>M&255),T&=(1<<M)-1);return P};function l(E){const k=[];for(let P=0;P<E.length;P++){const T=E.codePointAt(P);if(T===void 0)throw new Error(`Index out of range: ${P}`);let M=T;M>65535?P++:M>=55296&&M<=57343&&(M=65533),M<=127?k.push(M):M<=2047?k.push(192|M>>6,128|M&63):M<=65535?k.push(224|M>>12,128|M>>6&63,128|M&63):k.push(240|M>>18,128|M>>12&63,128|M>>6&63,128|M&63)}return k}const h=E=>{let k="",P=0;for(let T=0;T<E.length;T++){const M=E[T];if(P>0){P--;continue}if(M<=127)k+=String.fromCharCode(M);else if(M>=192&&M<=223){const C=E[T+1];P=1;const D=(M&31)<<6|C&63;k+=String.fromCharCode(D)}else if(M>=224&&M<=239){const C=E[T+1],D=E[T+2];P=2;const F=(M&15)<<12|(C&63)<<6|D&63;k+=String.fromCharCode(F)}else if(M>=240&&M<=247){const C=E[T+1],D=E[T+2],F=E[T+3];P=3;const B=(M&7)<<18|(C&63)<<12|(D&63)<<6|F&63,L=55296+(B-65536>>10),q=56320+(B-65536&1023);k+=String.fromCharCode(L,q)}}return k};i.toUTF8=h;const f=(E,k)=>{switch(k){case"hex":return(0,i.toHex)(E);case"utf8":return(0,i.toUTF8)(E);default:return E}};i.encode=f;function m(E){const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let P="",T;for(T=0;T<E.length;T+=3){const M=E[T],C=T+1<E.length?E[T+1]:0,D=T+2<E.length?E[T+2]:0,F=M>>2,B=(M&3)<<4|C>>4,L=(C&15)<<2|D>>6,q=D&63;P+=k.charAt(F)+k.charAt(B),P+=T+1<E.length?k.charAt(L):"=",P+=T+2<E.length?k.charAt(q):"="}return P}i.toBase64=m;const d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",y=E=>{var k;if(E===""||typeof E!="string")throw new Error(`Expected base58 string but got “${E}”`);const P=E.match(/[IOl0]/gmu);if(P!==null)throw new Error(`Invalid base58 character “${P.join("")}”`);const T=E.match(/^1+/gmu),M=T!==null?T[0].length:0,C=(E.length-M)*(Math.log(58)/Math.log(256))+1>>>0;return[...new Uint8Array([...new Uint8Array(M),...((k=E.match(/./gmu))!==null&&k!==void 0?k:[]).map(F=>d.indexOf(F)).reduce((F,B)=>(F=F.map(L=>{const q=L*58+B;return B=q>>8,q}),F),new Uint8Array(C)).reverse().filter((F=>B=>F=F||B)(!1))])]};i.fromBase58=y;const b=E=>{const k=Array(256).fill(-1);for(let T=0;T<d.length;++T)k[d.charCodeAt(T)]=T;const P=[];for(const T of E){let M=T;for(let C=0;C<P.length;++C){const D=(k[P[C]]<<8)+M;P[C]=d.charCodeAt(D%58),M=D/58|0}for(;M!==0;)P.push(d.charCodeAt(M%58)),M=M/58|0}for(const T of E){if(T!==0)break;P.push(49)}return P.reverse(),String.fromCharCode(...P)};i.toBase58=b;const g=(E,k=[0])=>{let P=(0,r.hash256)([...k,...E]);return P=[...k,...E,...P.slice(0,4)],(0,i.toBase58)(P)};i.toBase58Check=g;const v=(E,k,P=1)=>{const T=(0,i.fromBase58)(E);let M=T.slice(0,P),C=T.slice(P,-4),D=[...M,...C];return D=(0,r.hash256)(D),T.slice(-4).forEach((F,B)=>{if(F!==D[B])throw new Error("Invalid checksum")}),k==="hex"&&(M=(0,i.toHex)(M),C=(0,i.toHex)(C)),{prefix:M,data:C}};i.fromBase58Check=v;class _{constructor(k){this.bufs=k!==void 0?k:[],this.length=0;for(const P of this.bufs)this.length+=P.length}getLength(){return this.length}toArray(){const k=this.length,P=new Array(k);let T=0;for(const M of this.bufs)for(const C of M)P[T++]=C;return P}write(k){return this.bufs.push(k),this.length+=k.length,this}writeReverse(k){const P=new Array(k.length);for(let T=0;T<P.length;T++)P[T]=k[k.length-1-T];return this.bufs.push(P),this.length+=P.length,this}writeUInt8(k){const P=new Array(1);return P[0]=k,this.write(P),this}writeInt8(k){const P=new Array(1);return P[0]=k&255,this.write(P),this}writeUInt16BE(k){const P=[k>>8&255,k&255];return this.bufs.push(P),this.length+=2,this}writeInt16BE(k){return this.writeUInt16BE(k&65535)}writeUInt16LE(k){const P=[k&255,k>>8&255];return this.bufs.push(P),this.length+=2,this}writeInt16LE(k){return this.writeUInt16LE(k&65535)}writeUInt32BE(k){const P=[k>>24&255,k>>16&255,k>>8&255,k&255];return this.bufs.push(P),this.length+=4,this}writeInt32BE(k){return this.writeUInt32BE(k>>>0)}writeUInt32LE(k){const P=[k&255,k>>8&255,k>>16&255,k>>24&255];return this.bufs.push(P),this.length+=4,this}writeInt32LE(k){return this.writeUInt32LE(k>>>0)}writeUInt64BEBn(k){const P=k.toArray("be",8);return this.write(P),this}writeUInt64LEBn(k){const P=k.toArray("be",8);return this.writeReverse(P),this}writeUInt64LE(k){const P=new n.default(k).toArray("be",8);return this.writeReverse(P),this}writeVarIntNum(k){const P=_.varIntNum(k);return this.write(P),this}writeVarIntBn(k){const P=_.varIntBn(k);return this.write(P),this}static varIntNum(k){let P;if(k<0)return this.varIntBn(new n.default(k));if(k<253)P=[k];else if(k<65536)P=[253,k&255,k>>8&255];else if(k<4294967296)P=[254,k&255,k>>8&255,k>>16&255,k>>24&255];else{const T=k&4294967295,M=Math.floor(k/4294967296)&4294967295;P=[255,T&255,T>>8&255,T>>16&255,T>>24&255,M&255,M>>8&255,M>>16&255,M>>24&255]}return P}static varIntBn(k){let P;if(k.isNeg()&&(k=k.add(R)),k.ltn(253))P=[k.toNumber()];else if(k.ltn(65536)){const T=k.toNumber();P=[253,T&255,T>>8&255]}else if(k.lt(new n.default(4294967296))){const T=k.toNumber();P=[254,T&255,T>>8&255,T>>16&255,T>>24&255]}else{const T=new _;T.writeUInt8(255),T.writeUInt64LEBn(k),P=T.toArray()}return P}}i.Writer=_;class S{constructor(k=[],P=0){this.bin=k,this.pos=P,this.length=k.length}eof(){return this.pos>=this.length}read(k=this.length){const P=this.pos,T=this.pos+k;return this.pos=T,this.bin.slice(P,T)}readReverse(k=this.length){const P=new Array(k);for(let T=0;T<k;T++)P[T]=this.bin[this.pos+k-1-T];return this.pos+=k,P}readUInt8(){const k=this.bin[this.pos];return this.pos+=1,k}readInt8(){const k=this.bin[this.pos];return this.pos+=1,(k&128)!==0?k-256:k}readUInt16BE(){const k=this.bin[this.pos]<<8|this.bin[this.pos+1];return this.pos+=2,k}readInt16BE(){const k=this.readUInt16BE();return(k&32768)!==0?k-65536:k}readUInt16LE(){const k=this.bin[this.pos]|this.bin[this.pos+1]<<8;return this.pos+=2,k}readInt16LE(){const k=this.readUInt16LE();return(k&32768)!==0?k-65536:k}readUInt32BE(){const k=this.bin[this.pos]*16777216+(this.bin[this.pos+1]<<16|this.bin[this.pos+2]<<8|this.bin[this.pos+3]);return this.pos+=4,k}readInt32BE(){const k=this.readUInt32BE();return(k&2147483648)!==0?k-4294967296:k}readUInt32LE(){const k=(this.bin[this.pos]|this.bin[this.pos+1]<<8|this.bin[this.pos+2]<<16|this.bin[this.pos+3]<<24)>>>0;return this.pos+=4,k}readInt32LE(){const k=this.readUInt32LE();return(k&2147483648)!==0?k-4294967296:k}readUInt64BEBn(){const k=this.bin.slice(this.pos,this.pos+8),P=new n.default(k);return this.pos=this.pos+8,P}readUInt64LEBn(){const k=this.readReverse(8);return new n.default(k)}readInt64LEBn(){const k=this.readReverse(8);let P=new n.default(k);return P.gte(A)&&(P=P.sub(R)),P}readVarIntNum(k=!0){const P=this.readUInt8();let T;switch(P){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:if(T=k?this.readInt64LEBn():this.readUInt64LEBn(),T.lte(new n.default(2).pow(new n.default(53))))return T.toNumber();throw new Error("number too large to retain precision - use readVarIntBn");default:return P}}readVarInt(){switch(this.bin[this.pos]){case 253:return this.read(3);case 254:return this.read(5);case 255:return this.read(9);default:return this.read(1)}}readVarIntBn(){const k=this.readUInt8();switch(k){case 253:return new n.default(this.readUInt16LE());case 254:return new n.default(this.readUInt32LE());case 255:return this.readUInt64LEBn();default:return new n.default(k)}}}i.Reader=S;const I=E=>{if(E.length===0)return E;const k=E[E.length-1];if((k&127)!==0)return E;if(E.length===1)return[];if((E[E.length-2]&128)!==0)return E;for(let P=E.length-1;P>0;P--)if(E[P-1]!==0)return(E[P-1]&128)!==0?(E[P]=k,E.slice(0,P+1)):(E[P-1]|=k,E.slice(0,P));return[]};i.minimallyEncode=I;const A=new n.default(2).pow(new n.default(63)),R=new n.default(2).pow(new n.default(64))}(Ol)),Ol}var lS;function xu(){if(lS)return Sc;lS=1;var i=Sc&&Sc.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Sc,"__esModule",{value:!0});const e=i(v6()),n=i(lB()),r=i(an()),t=Ze(),s=i(_w());let a=class Tn extends e.default{static fromDER(u){if((u[0]===4||u[0]===6||u[0]===7)&&u.length-1===2*32){if(u[0]===6){if(u[u.length-1]%2!==0)throw new Error("Point string value is wrong length")}else if(u[0]===7&&u[u.length-1]%2!==1)throw new Error("Point string value is wrong length");return new Tn(u.slice(1,33),u.slice(33,1+2*32))}else if((u[0]===2||u[0]===3)&&u.length-1===32)return Tn.fromX(u.slice(1,33),u[0]===3);throw new Error("Unknown point format")}static fromString(u){const l=(0,t.toArray)(u,"hex");return Tn.fromDER(l)}static redSqrtOptimized(u){const f=Tn.red.m.addn(1).iushrn(2);return u.redPow(f)}static fromX(u,l){if(typeof BigInt=="function"){let d=function(k,P){return(k%P+P)%P},y=function(k,P,T){let M=BigInt(1);for(k=d(k,T);P>BigInt(0);)(P&BigInt(1))===BigInt(1)&&(M=d(M*k,T)),P>>=BigInt(1),k=d(k*k,T);return M},b=function(k,P){const T=P+BigInt(1)>>BigInt(2),M=y(k,T,P);return d(M*M,P)===d(k,P)?M:null};var h=d,f=y,m=b;const g=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),v=BigInt(7);let _;if(u instanceof r.default)_=BigInt("0x"+u.toString(16));else if(typeof u=="string")_=BigInt("0x"+u);else if(Array.isArray(u))_=BigInt("0x"+(0,t.toHex)(u).padStart(64,"0"));else if(typeof u=="number")_=BigInt(u);else throw new Error("Invalid x-coordinate type");_=d(_,g);const S=d(y(_,BigInt(3),g)+v,g);let I=b(S,g);if(I===null)throw new Error("Invalid point");const A=I%BigInt(2)===BigInt(1);(l&&!A||!l&&A)&&(I=g-I);const R=new r.default(_.toString(16),16),E=new r.default(I.toString(16),16);return new Tn(R,E)}else{const d=new s.default("k256"),y=new r.default(0).toRed(d),b=new r.default(7).toRed(d),g=new r.default(0).toRed(d);r.default.isBN(u)||(u=new r.default(u,16)),u=u,u.red==null&&(u=u.toRed(d));const v=u.redSqr().redMul(u).redIAdd(u.redMul(y)).redIAdd(b);let _=v.redSqrt();if(_.redSqr().redSub(v).cmp(g)!==0)throw new Error("invalid point");const S=_.fromRed().isOdd();return(l&&!S||!l&&S)&&(_=_.redNeg()),new Tn(u,_)}}static fromJSON(u,l){typeof u=="string"&&(u=JSON.parse(u));const h=new Tn(u[0],u[1],l);if(typeof u[2]!="object")return h;const f=d=>new Tn(d[0],d[1],l),m=u[2];return h.precomputed={beta:null,doubles:typeof m.doubles=="object"&&m.doubles!==null?{step:m.doubles.step,points:[h].concat(m.doubles.points.map(f))}:void 0,naf:typeof m.naf=="object"&&m.naf!==null?{wnd:m.naf.wnd,points:[h].concat(m.naf.points.map(f))}:void 0},h}constructor(u,l,h=!0){super("affine"),this.precomputed=null,u===null&&l===null?(this.x=null,this.y=null,this.inf=!0):(r.default.isBN(u)||(u=new r.default(u,16)),this.x=u,r.default.isBN(l)||(l=new r.default(l,16)),this.y=l,h&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red===null&&(this.x=this.x.toRed(this.curve.red)),this.y.red===null&&(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}validate(){return this.curve.validate(this)}encode(u=!0,l){const h=this.curve.p.byteLength(),f=this.getX().toArray("be",h);let m;return u?m=[this.getY().isEven()?2:3].concat(f):m=[4].concat(f,this.getY().toArray("be",h)),l!=="hex"?m:(0,t.toHex)(m)}toString(){return this.encode(!0,"hex")}toJSON(){return this.precomputed==null?[this.x,this.y]:[this.x,this.y,typeof this.precomputed=="object"&&this.precomputed!==null?{doubles:this.precomputed.doubles!=null?{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)}:void 0,naf:this.precomputed.naf!=null?{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}:void 0}:void 0]}inspect(){var u,l,h,f,m,d;return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+((h=(l=(u=this.x)===null||u===void 0?void 0:u.fromRed())===null||l===void 0?void 0:l.toString(16,2))!==null&&h!==void 0?h:"undefined")+" y: "+((d=(m=(f=this.y)===null||f===void 0?void 0:f.fromRed())===null||m===void 0?void 0:m.toString(16,2))!==null&&d!==void 0?d:"undefined")+">"}isInfinity(){return this.inf}add(u){var l,h,f,m,d,y,b,g,v,_,S,I;if(this.inf)return u;if(u.inf)return this;if(this.eq(u))return this.dbl();if(this.neg().eq(u))return new Tn(new r.default(0),new r.default(0));if(((l=this.x)===null||l===void 0?void 0:l.cmp((h=u.x)!==null&&h!==void 0?h:new r.default(0)))===0)return new Tn(new r.default(0),new r.default(0));let A=(d=(f=this.y)===null||f===void 0?void 0:f.redSub((m=u.y)!==null&&m!==void 0?m:new r.default(0)))!==null&&d!==void 0?d:new r.default(0);A.cmpn(0)!==0&&(A=A.redMul((g=(y=this.x)===null||y===void 0?void 0:y.redSub((b=u.x)!==null&&b!==void 0?b:new r.default(0)).redInvm())!==null&&g!==void 0?g:new r.default(1)));const R=A==null?void 0:A.redSqr().redISub((v=this.x)!==null&&v!==void 0?v:new r.default(0)).redISub((_=u.x)!==null&&_!==void 0?_:new r.default(0)),E=(A??new r.default(1)).redMul(((S=this.x)!==null&&S!==void 0?S:new r.default(0)).redSub(R??new r.default(0))).redISub((I=this.y)!==null&&I!==void 0?I:new r.default(0));return new Tn(R??new r.default(0),E??new r.default(0))}dbl(){var u,l,h,f,m,d,y;if(this.inf)return this;const b=((u=this.y)!==null&&u!==void 0?u:new r.default(0)).redAdd((l=this.y)!==null&&l!==void 0?l:new r.default(0));if(b.cmpn(0)===0)return new Tn(new r.default(0),new r.default(0));const g=this.curve.a,v=((h=this.x)!==null&&h!==void 0?h:new r.default(0)).redSqr(),_=b.redInvm(),S=v.redAdd(v).redIAdd(v).redIAdd(g).redMul(_),I=S.redSqr().redISub(((f=this.x)!==null&&f!==void 0?f:new r.default(0)).redAdd((m=this.x)!==null&&m!==void 0?m:new r.default(0))),A=S.redMul(((d=this.x)!==null&&d!==void 0?d:new r.default(0)).redSub(I)).redISub((y=this.y)!==null&&y!==void 0?y:new r.default(0));return new Tn(I,A)}getX(){var u;return((u=this.x)!==null&&u!==void 0?u:new r.default(0)).fromRed()}getY(){var u;return((u=this.y)!==null&&u!==void 0?u:new r.default(0)).fromRed()}mul(u){return r.default.isBN(u)||(u=new r.default(u,16)),u=u,this.isInfinity()?this:this._hasDoubles(u)?this._fixedNafMul(u):this._endoWnafMulAdd([this],[u])}mulAdd(u,l,h){const f=[this,l],m=[u,h];return this._endoWnafMulAdd(f,m)}jmulAdd(u,l,h){const f=[this,l],m=[u,h];return this._endoWnafMulAdd(f,m,!0)}eq(u){var l,h,f,m;return this===u||this.inf===u.inf&&(this.inf||((l=this.x)!==null&&l!==void 0?l:new r.default(0)).cmp((h=u.x)!==null&&h!==void 0?h:new r.default(0))===0&&((f=this.y)!==null&&f!==void 0?f:new r.default(0)).cmp((m=u.y)!==null&&m!==void 0?m:new r.default(0))===0)}neg(u){var l;if(this.inf)return this;const h=new Tn(this.x,((l=this.y)!==null&&l!==void 0?l:new r.default(0)).redNeg());if(u===!0&&this.precomputed!=null){const f=this.precomputed,m=d=>d.neg();h.precomputed={naf:f.naf!=null?{wnd:f.naf.wnd,points:f.naf.points.map(m)}:void 0,doubles:f.doubles!=null?{step:f.doubles.step,points:f.doubles.points.map(d=>d.neg())}:void 0,beta:void 0}}return h}dblp(u){let l=this;for(let h=0;h<u;h++)l=l.dbl();return l}toJ(){return this.inf?new n.default(null,null,null):new n.default(this.x,this.y,this.curve.one)}_getBeta(){var u;if(typeof this.curve.endo!="object")return;const l=this.precomputed;if(typeof l=="object"&&l!==null&&typeof l.beta=="object"&&l.beta!==null)return l.beta;const h=new Tn(((u=this.x)!==null&&u!==void 0?u:new r.default(0)).redMul(this.curve.endo.beta),this.y);if(l!=null){const f=this.curve,m=d=>{if(d.x===null)throw new Error("p.x is null");if(f.endo===void 0||f.endo===null)throw new Error("curve.endo is undefined");return new Tn(d.x.redMul(f.endo.beta),d.y)};l.beta=h,h.precomputed={beta:null,naf:l.naf!=null?{wnd:l.naf.wnd,points:l.naf.points.map(m)}:void 0,doubles:l.doubles!=null?{step:l.doubles.step,points:l.doubles.points.map(m)}:void 0}}return h}_fixedNafMul(u){if(typeof this.precomputed!="object"||this.precomputed===null)throw new Error("_fixedNafMul requires precomputed values for the point");const l=this._getDoubles(),h=this.curve.getNAF(u,1,this.curve._bitLength);let f=(1<<l.step+1)-(l.step%2===0?2:1);f/=3;const m=[];for(let b=0;b<h.length;b+=l.step){let g=0;for(let v=b+l.step-1;v>=b;v--)g=(g<<1)+h[v];m.push(g)}let d=new n.default(null,null,null),y=new n.default(null,null,null);for(let b=f;b>0;b--){for(let g=0;g<m.length;g++){const v=m[g];v===b?y=y.mixedAdd(l.points[g]):v===-b&&(y=y.mixedAdd(l.points[g].neg()))}d=d.add(y)}return d.toP()}_wnafMulAdd(u,l,h,f,m){var d,y,b,g;const v=this.curve._wnafT1.map(E=>E.toNumber()),_=this.curve._wnafT2.map(()=>[]),S=this.curve._wnafT3.map(()=>[]);let I=0;for(let E=0;E<f;E++){const P=l[E]._getNAFPoints(u);v[E]=P.wnd,_[E]=P.points}for(let E=f-1;E>=1;E-=2){const k=E-1,P=E;if(v[k]!==1||v[P]!==1){S[k]=this.curve.getNAF(h[k],v[k],this.curve._bitLength),S[P]=this.curve.getNAF(h[P],v[P],this.curve._bitLength),I=Math.max(S[k].length,I),I=Math.max(S[P].length,I);continue}const T=[l[k],null,null,l[P]];((d=l[k].y)!==null&&d!==void 0?d:new r.default(0)).cmp((y=l[P].y)!==null&&y!==void 0?y:new r.default(0))===0?(T[1]=l[k].add(l[P]),T[2]=l[k].toJ().mixedAdd(l[P].neg())):((b=l[k].y)!==null&&b!==void 0?b:new r.default(0)).cmp(((g=l[P].y)!==null&&g!==void 0?g:new r.default(0)).redNeg())===0?(T[1]=l[k].toJ().mixedAdd(l[P]),T[2]=l[k].add(l[P].neg())):(T[1]=l[k].toJ().mixedAdd(l[P]),T[2]=l[k].toJ().mixedAdd(l[P].neg()));const M=[-3,-1,-5,-7,0,7,5,1,3],C=this.curve.getJSF(h[k],h[P]);I=Math.max(C[0].length,I),S[k]=new Array(I),S[P]=new Array(I);for(let D=0;D<I;D++){const F=C[0][D]|0,B=C[1][D]|0;S[k][D]=M[(F+1)*3+(B+1)],S[P][D]=0,_[k]=T}}let A=new n.default(null,null,null);const R=this.curve._wnafT4;for(let E=I;E>=0;E--){let k=0;for(;E>=0;){let M=!0;for(let C=0;C<f;C++)R[C]=new r.default(typeof S[C][E]=="number"?S[C][E]:0),R[C].isZero()||(M=!1);if(!M)break;k++,E--}if(E>=0&&k++,A=A.dblp(k),E<0)break;const P=new r.default(1),T=new r.default(2);for(let M=0;M<f;M++){const C=R[M];let D;C.cmpn(0)!==0&&(C.isNeg()?D=_[M][C.neg().sub(P).div(T).toNumber()].neg():D=_[M][C.sub(P).div(T).toNumber()],D.type==="affine"?A=A.mixedAdd(D):A=A.add(D))}}for(let E=0;E<f;E++)_[E]=[];return m===!0?A:A.toP()}_endoWnafMulAdd(u,l,h){var f;const m=new Array(u.length*2),d=new Array(u.length*2);let y;for(y=0;y<u.length;y++){const g=this.curve._endoSplit(l[y]);let v=u[y],_=(f=v._getBeta())!==null&&f!==void 0?f:new Tn(new r.default(0),new r.default(0));g.k1.negative!==0&&(g.k1.ineg(),v=v.neg(!0)),g.k2.negative!==0&&(g.k2.ineg(),_=_.neg(!0)),m[y*2]=v,m[y*2+1]=_,d[y*2]=g.k1,d[y*2+1]=g.k2}const b=this._wnafMulAdd(1,m,d,y*2,h);for(let g=0;g<y*2;g++)m[g]=null,d[g]=null;return b}_hasDoubles(u){if(this.precomputed==null)return!1;const l=this.precomputed.doubles;return typeof l!="object"?!1:l.points.length>=Math.ceil((u.bitLength()+1)/l.step)}_getDoubles(u,l){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.doubles=="object"&&this.precomputed.doubles!==null)return this.precomputed.doubles;const h=[this];let f=this;for(let m=0;m<(l??0);m+=u??1){for(let d=0;d<(u??1);d++)f=f.dbl();h.push(f)}return{step:u??1,points:h}}_getNAFPoints(u){if(typeof this.precomputed=="object"&&this.precomputed!==null&&typeof this.precomputed.naf=="object"&&this.precomputed.naf!==null)return this.precomputed.naf;const l=[this],h=(1<<u)-1,f=h===1?null:this.dbl();for(let m=1;m<h;m++)f!==null&&(l[m]=l[m-1].add(f));return{wnd:u,points:l}}};return a.red=new s.default("k256"),a.a=new r.default(0).toRed(a.red),a.b=new r.default(7).toRed(a.red),a.zero=new r.default(0).toRed(a.red),Sc.default=a,Sc}var dS;function qr(){if(dS)return mc;dS=1;var i=mc&&mc.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(mc,"__esModule",{value:!0});const e=i(an()),n=i(_w()),r=i(uB()),t=i(xu()),s=Ze();let a,c=class x6{static assert(l,h="Elliptic curve assertion failed"){if(!l)throw new Error(h)}getNAF(l,h,f){const m=new Array(Math.max(l.bitLength(),f)+1);m.fill(0);const d=1<<h+1,y=l.clone();for(let b=0;b<m.length;b++){let g;const v=y.andln(d-1);y.isOdd()?(v>(d>>1)-1?g=(d>>1)-v:g=v,y.isubn(g)):g=0,m[b]=g,y.iushrn(1)}return m}getJSF(l,h){const f=[[],[]];l=l.clone(),h=h.clone();let m=0,d=0;for(;l.cmpn(-m)>0||h.cmpn(-d)>0;){let y=l.andln(3)+m&3,b=h.andln(3)+d&3;y===3&&(y=-1),b===3&&(b=-1);let g;if((y&1)===0)g=0;else{const _=l.andln(7)+m&7;(_===3||_===5)&&b===2?g=-y:g=y}f[0].push(g);let v;if((b&1)===0)v=0;else{const _=h.andln(7)+d&7;(_===3||_===5)&&y===2?v=-b:v=b}f[1].push(v),2*m===g+1&&(m=1-m),2*d===v+1&&(d=1-d),l.iushrn(1),h.iushrn(1)}return f}static cachedProperty(l,h,f){const m="_"+h;l.prototype[h]=function(){return this[m]!==void 0?this[m]:this[m]=f.call(this)}}static parseBytes(l){return typeof l=="string"?(0,s.toArray)(l,"hex"):l}static intFromLE(l){return new e.default(l,"hex","le")}constructor(){if(typeof a<"u")return a;a=this;const h={prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",{doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}]};this.p=new e.default(h.p,16),this.red=new n.default(h.prime),this.zero=new e.default(0).toRed(this.red),this.one=new e.default(1).toRed(this.red),this.two=new e.default(2).toRed(this.red),this.n=new e.default(h.n,16),this.g=t.default.fromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n.bitLength(),this.redN=this.n.toRed(this.red),this.a=new e.default(h.a,16).toRed(this.red),this.b=new e.default(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}_getEndomorphism(l){var h,f;if(!this.zeroA||this.p.modrn(3)!==1)return;let m,d;if(l.beta!==void 0)m=new e.default(l.beta,16).toRed(this.red);else{const b=this._getEndoRoots(this.p);if(b===null)throw new Error("Failed to get endomorphism roots for beta.");m=b[0].cmp(b[1])<0?b[0]:b[1],m=m.toRed(this.red)}if(l.lambda!==void 0)d=new e.default(l.lambda,16);else{const b=this._getEndoRoots(this.n);if(b===null)throw new Error("Failed to get endomorphism roots for lambda.");if(this.g==null)throw new Error("Curve generator point (g) is not defined.");const g=(h=this.g.mul(b[0]))===null||h===void 0?void 0:h.x,v=this.g.x!=null?this.g.x.redMul(m):void 0;if(g!=null&&v!=null&&g.cmp(v)===0)d=b[0];else{if(d=b[1],this.g==null)throw new Error("Curve generator point (g) is not defined.");const _=(f=this.g.mul(d))===null||f===void 0?void 0:f.x,S=this.g.x!=null?this.g.x.redMul(m):void 0;if(_==null||S==null)throw new Error("Lambda computation failed: g.mul(lambda).x or g.x.redMul(beta) is undefined.");x6.assert(_.cmp(S)===0,"Lambda selection does not match computed beta.")}}let y;return typeof l.basis=="object"&&l.basis!==null?y=l.basis.map(function(b){return{a:new e.default(b.a,16),b:new e.default(b.b,16)}}):y=this._getEndoBasis(d),{beta:m,lambda:d,basis:y}}_getEndoRoots(l){const h=l===this.p?this.red:new r.default(l),f=new e.default(2).toRed(h).redInvm(),m=f.redNeg(),d=new e.default(3).toRed(h).redNeg().redSqrt().redMul(f),y=m.redAdd(d).fromRed(),b=m.redSub(d).fromRed();return[y,b]}_getEndoBasis(l){const h=this.n.ushrn(Math.floor(this.n.bitLength()/2));let f=l,m=this.n.clone(),d=new e.default(1),y=new e.default(0),b=new e.default(0),g=new e.default(1),v,_,S,I,A,R,E=new e.default(0),k=0,P=new e.default(0),T=new e.default(0);for(;f.cmpn(0)!==0;){const D=m.div(f);P=m.sub(D.mul(f)),T=b.sub(D.mul(d));const F=g.sub(D.mul(y));if(S===void 0&&P.cmp(h)<0)v=E.neg(),_=d,S=P.neg(),I=T;else if(S!==void 0&&++k===2)break;E=P,m=f,f=P,b=d,d=T,g=y,y=F}if(v===void 0||_===void 0||S===void 0||I===void 0)throw new Error("Failed to compute Endo Basis values");A=P.neg(),R=T;const M=S.sqr().add(I.sqr());return A.sqr().add(R.sqr()).cmp(M)>=0&&(A=v,R=_),S.negative!==0&&(S=S.neg(),I=I.neg()),A.negative!==0&&(A=A.neg(),R=R.neg()),[{a:S,b:I},{a:A,b:R}]}_endoSplit(l){if(this.endo==null)throw new Error("Endomorphism is not defined.");const h=this.endo.basis,f=h[0],m=h[1],d=m.b.mul(l).divRound(this.n),y=f.b.neg().mul(l).divRound(this.n),b=d.mul(f.a),g=y.mul(m.a),v=d.mul(f.b),_=y.mul(m.b),S=l.sub(b).sub(g),I=v.add(_).neg();return{k1:S,k2:I}}validate(l){if(l.inf)return!0;const h=l.x,f=l.y;if(h===null||f===null)throw new Error("Point coordinates cannot be null");const m=this.a.redMul(h),d=h.redSqr().redMul(h).redIAdd(m).redIAdd(this.b);return f.redSqr().redISub(d).cmpn(0)===0}};return mc.default=c,mc}var kc={},la={},Ec={},fS;function _u(){if(fS)return Ec;fS=1;var i=Ec&&Ec.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ec,"__esModule",{value:!0});const e=i(an()),n=i(Ca()),r=Su(),t=sn(),s=Ze(),a=i(xu()),c=i(qr());let u=class Om{static fromDER(h,f){const m=(I,A)=>{const R=I[A.place++];if((R&128)===0)return R;throw new Error("Invalid DER entity length")};class d{constructor(){this.place=0}}h=(0,s.toArray)(h,f);const y=new d;if(h[y.place++]!==48)throw new Error("Signature DER must start with 0x30");if(m(h,y)+y.place!==h.length)throw new Error("Signature DER invalid");if(h[y.place++]!==2)throw new Error("Signature DER invalid");const g=m(h,y);let v=h.slice(y.place,g+y.place);if(y.place+=g,h[y.place++]!==2)throw new Error("Signature DER invalid");const _=m(h,y);if(h.length!==_+y.place)throw new Error("Invalid R-length in signature DER");let S=h.slice(y.place,_+y.place);if(v[0]===0)if((v[1]&128)!==0)v=v.slice(1);else throw new Error("Invalid R-value in signature DER");if(S[0]===0)if((S[1]&128)!==0)S=S.slice(1);else throw new Error("Invalid S-value in signature DER");return new Om(new e.default(v),new e.default(S))}static fromCompact(h,f){if(h=(0,s.toArray)(h,f),h.length!==65)throw new Error("Invalid Compact Signature");const m=h[0];if(m<27||m>=35)throw new Error("Invalid Compact Byte");return new Om(new e.default(h.slice(1,33)),new e.default(h.slice(33,65)))}constructor(h,f){this.r=h,this.s=f}verify(h,f,m){const d=new e.default((0,t.sha256)(h,m),16);return(0,r.verify)(d,this,f)}toString(h){return this.toDER(h)}toDER(h){const f=(_,S)=>{if(S<128)_.push(S);else throw new Error("len must be < 0x80")},m=_=>{let S=0;const I=_.length-1;for(;_[S]===0&&(_[S+1]&128)===0&&S<I;)S++;return S===0?_:_.slice(S)};let d=this.r.toArray(),y=this.s.toArray();for((d[0]&128)!==0&&(d=[0].concat(d)),(y[0]&128)!==0&&(y=[0].concat(y)),d=m(d),y=m(y);y[0]===0&&(y[1]&128)===0;)y=y.slice(1);let b=[2];f(b,d.length),b=b.concat(d),b.push(2),f(b,y.length);const g=b.concat(y);let v=[48];return f(v,g.length),v=v.concat(g),h==="hex"?(0,s.toHex)(v):h==="base64"?(0,s.toBase64)(v):v}toCompact(h,f,m){if(h<0||h>3)throw new Error("Invalid recovery param");if(typeof f!="boolean")throw new Error("Invalid compressed param");let d=27+h;f&&(d+=4);let y=[d];return y=y.concat(this.r.toArray("be",32)),y=y.concat(this.s.toArray("be",32)),m==="hex"?(0,s.toHex)(y):m==="base64"?(0,s.toBase64)(y):y}RecoverPublicKey(h,f){const m=this.r,d=this.s,y=(h&1)!==0,b=h>>1,g=new c.default,v=g.n,_=g.g,S=b!==0?m.add(v):m,I=a.default.fromX(S,y);if(!I.mul(v).isInfinity())throw new Error("nR is not at infinity");const R=f.neg().umod(v),E=m.invm(v),k=E.mul(d).umod(v),P=E.mul(R).umod(v),T=_.mul(P).add(I.mul(k)),M=new n.default(T);return M.validate(),M}CalculateRecoveryFactor(h,f){for(let m=0;m<4;m++){let d;try{d=this.RecoverPublicKey(m,f)}catch{continue}if(h.eq(d))return m}throw new Error("Unable to find valid recovery factor")}};return Ec.default=u,Ec}var np={},hS;function _6(){if(hS)return np;hS=1,Object.defineProperty(np,"__esModule",{value:!0});const i=sn(),e=Ze();let n=class{constructor(t,s){if(t=(0,e.toArray)(t,"hex"),s=(0,e.toArray)(s,"hex"),t.length<32)throw new Error("Not enough entropy. Minimum is 256 bits");const a=t.concat(s);this.K=new Array(32),this.V=new Array(32);for(let c=0;c<32;c++)this.K[c]=0,this.V[c]=1;this.update(a)}hmac(){return new i.SHA256HMAC(this.K)}update(t){let s=this.hmac().update(this.V).update([0]);t!==void 0&&(s=s.update(t)),this.K=s.digest(),this.V=this.hmac().update(this.V).digest(),t!==void 0&&(this.K=this.hmac().update(this.V).update([1]).update(t).digest(),this.V=this.hmac().update(this.V).digest())}generate(t){let s=[];for(;s.length<t;)this.V=this.hmac().update(this.V).digest(),s=s.concat(this.V);const a=s.slice(0,t);return this.update(),(0,e.toHex)(a)}};return np.default=n,np}var pS;function Su(){if(pS)return la;pS=1;var i=la&&la.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(la,"__esModule",{value:!0}),la.verify=la.sign=void 0;const e=i(an()),n=i(_u()),r=i(qr()),t=i(_6());function s(u,l,h=new r.default){const f=u.byteLength()*8-h.n.bitLength();return f>0&&u.iushrn(f),l===null&&u.cmp(h.n)>=0?u.sub(h.n):u}const a=(u,l,h=!1,f)=>{if(typeof BigInt=="function"){let D=function(me,xe){const ke=me.toString(16).padStart(xe*2,"0"),Re=new Uint8Array(xe);for(let Ce=0;Ce<xe;Ce++)Re[Ce]=parseInt(ke.substr(Ce*2,2),16);return Re},U=function(me,xe,ke=!0){const Re=me.toString(2).length,Ce=xe.toString(2).length,Ne=Re-Ce;return Ne>0&&(me=me>>BigInt(Ne)),!ke&&me>=xe?me-xe:me},z=function(me){if(typeof me=="function"){const ke=me($).toString(16);return BigInt("0x"+ke)}else if(me!=null&&e.default.isBN(me)){const xe=me.toString(16);return BigInt("0x"+xe)}else{const xe=q.generate(F);return BigInt("0x"+xe)}},G=function(me,xe){return(me%xe+xe)%xe},ne=function(me,xe){let ke=I,Re=S,Ce=G(me,xe),Ne=xe;for(;Ce>I;){const We=Ne/Ce,dt=Re-ke*We,Ut=Ne-Ce*We;Re=ke,ke=dt,Ne=Ce,Ce=Ut}return G(ke,xe)},ce=function(me,xe){if(me===null)return xe;if(xe===null)return me;if(me.x===xe.x&&me.y===G(-xe.y,E))return null;let ke;if(me.x===xe.x&&me.y===xe.y){if(me.y===S)return null;const Ne=G(BigInt(3)*me.x*me.x,E),We=ne(A*me.y,E);ke=G(Ne*We,E)}else{const Ne=G(xe.y-me.y,E),We=ne(xe.x-me.x,E);ke=G(Ne*We,E)}const Re=G(ke*ke-me.x-xe.x,E),Ce=G(ke*(me.x-Re)-me.y,E);return{x:Re,y:Ce}},Se=function(me,xe){var ke,Re;let Ce=xe,Ne=null;for(;me>BigInt(0);)me%BigInt(2)===BigInt(1)&&(Ne=Ne===null?Ce:(ke=ce(Ne,Ce))!==null&&ke!==void 0?ke:Ne),Ce=(Re=ce(Ce,Ce))!==null&&Re!==void 0?Re:Ce,me>>=BigInt(1);if(Ne===null)throw new Error("Scalar multiplication resulted in an invalid point.");return Ne};var m=D,d=U,y=z,b=G,g=ne,v=ce,_=Se;const S=BigInt(0),I=BigInt(1),A=BigInt(2),R=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),E=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),k=BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),P=BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"),T={x:k,y:P},M=BigInt("0x"+u.toString(16)),C=BigInt("0x"+l.toString(16));if(C<=S||C>=R)throw new Error("Invalid private key");const F=32,B=D(C,F),L=D(M,F),q=new t.default(Array.from(B),Array.from(L)),K=R-I;let $=0,Ie=!1;for(;!Ie;){$+=1,Ie=!0,$+=1;let me=z(f);if(me=U(me,R,!0),me<=I||me>=K){if(f instanceof e.default)throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const xe=Se(me,T);if(xe===null){if(f instanceof e.default)throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const ke=G(xe.x,R);if(ke===S){if(f instanceof e.default)throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}const Re=ne(me,R),Ce=G(ke*C,R);let Ne=G(Re*(M+Ce),R);if(Ne===S){if(f instanceof e.default)throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}h&&Ne>R/A&&(Ne=R-Ne);const We=new e.default(ke.toString(16),16),dt=new e.default(Ne.toString(16),16);return new n.default(We,dt)}}else{const S=new r.default;u=d(u);const I=S.n.byteLength(),A=l.toArray("be",I),R=u.toArray("be",I),E=new t.default(A,R),k=S.n.subn(1);for(let P=0;;P++){let T=typeof f=="function"?f(P):e.default.isBN(f)?f:new e.default(E.generate(I),16);if(T!=null)T=d(T,!0);else throw new Error("k is undefined");if(T.cmpn(1)<=0||T.cmp(k)>=0){if(e.default.isBN(f))throw new Error("Invalid fixed custom K value (must be more than 1 and less than N-1)");continue}const M=S.g.mul(T);if(M.isInfinity()){if(e.default.isBN(f))throw new Error("Invalid fixed custom K value (must not create a point at infinity when multiplied by the generator point)");continue}const D=M.getX().umod(S.n);if(D.cmpn(0)===0){if(e.default.isBN(f))throw new Error("Invalid fixed custom K value (when multiplied by G, the resulting x coordinate mod N must not be zero)");continue}let F=T.invm(S.n).mul(D.mul(l).iadd(u));if(F=F.umod(S.n),F.cmpn(0)===0){if(e.default.isBN(f))throw new Error("Invalid fixed custom K value (when used with the key, it cannot create a zero value for S)");continue}return h&&F.cmp(S.n.ushrn(1))>0&&(F=S.n.sub(F)),new n.default(D,F)}}throw new Error("Failed to generate a valid signature")};la.sign=a;const c=(u,l,h)=>{if(typeof BigInt=="function"){const f=BigInt(0),m=BigInt(1),d=BigInt(2),y=BigInt(3),b=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),g=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),v={x:BigInt("0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798"),y:BigInt("0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8")},_=(B,L)=>(B%L+L)%L,S=(B,L)=>{let[q,K]=[B,L],[$,U]=[BigInt(1),BigInt(0)];for(;K!==f;){const z=q/K;[q,K]=[K,q-z*K],[$,U]=[U,$-z*U]}return q>m?f:_($,L)},I=(B,L,q)=>_(B*L,q),A=(B,L,q)=>_(B-L,q),R=BigInt(4),E=BigInt(8),k=B=>{const{X:L,Y:q,Z:K}=B;if(q===f)return{X:f,Y:m,Z:f};const $=I(q,q,b),U=I(R,I(L,$,b),b),z=I(y,I(L,L,b),b),G=A(I(z,z,b),I(d,U,b),b),ne=A(I(z,A(U,G,b),b),I(E,I($,$,b),b),b),ce=I(d,I(q,K,b),b);return{X:G,Y:ne,Z:ce}},P=(B,L)=>{if(B.Z===f)return L;if(L.Z===f)return B;const q=I(B.Z,B.Z,b),K=I(L.Z,L.Z,b),$=I(B.X,K,b),U=I(L.X,q,b),z=I(B.Y,I(K,L.Z,b),b),G=I(L.Y,I(q,B.Z,b),b),ne=A(U,$,b),ce=A(G,z,b);if(ne===f)return ce===f?k(B):{X:f,Y:m,Z:f};const Se=I(ne,ne,b),Ie=I(ne,Se,b),me=I($,Se,b),xe=A(A(I(ce,ce,b),Ie,b),I(d,me,b),b),ke=A(I(ce,A(me,xe,b),b),I(z,Ie,b),b),Re=I(ne,I(B.Z,L.Z,b),b);return{X:xe,Y:ke,Z:Re}},T=(B,L)=>{const q={X:L.x,Y:L.y,Z:m};let K={X:f,Y:m,Z:f};const $=B.toString(2);for(let U=0;U<$.length;U++)K=k(K),$[U]==="1"&&(K=P(K,q));return K},M=(B,L,q)=>{const{r:K,s:$}=q,U=B;if(K<=f||K>=g||$<=f||$>=g)return!1;const z=S($,g);if(z===f)return!1;const G=I(U,z,g),ne=I(K,z,g),ce=T(G,v),Se=T(ne,L),Ie=P(ce,Se);if(Ie.Z===f)return!1;const me=S(Ie.Z,b);if(me===f)return!1;const xe=I(me,me,b),ke=I(Ie.X,xe,b);return _(ke,g)===K},C=BigInt("0x"+u.toString(16));if(h.x==null||h.y==null)throw new Error("Invalid public key: missing coordinates.");const D={x:BigInt("0x"+h.x.toString(16)),y:BigInt("0x"+h.y.toString(16))},F={r:BigInt("0x"+l.r.toString(16)),s:BigInt("0x"+l.s.toString(16))};return M(C,D,F)}else{const f=new r.default;u=s(u);const m=l.r,d=l.s;if(m.cmpn(1)<0||m.cmp(f.n)>=0||d.cmpn(1)<0||d.cmp(f.n)>=0)return!1;const y=d.invm(f.n),b=y.mul(u).umod(f.n),g=y.mul(m).umod(f.n),v=f.g.jmulAdd(b,h,g);return v.isInfinity()?!1:v.eqXToP(m)}};return la.verify=c,la}var yS;function Ca(){if(yS)return kc;yS=1;var i=kc&&kc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(kc,"__esModule",{value:!0});const e=i(xu()),n=i(qr()),r=Su(),t=i(an()),s=sn(),a=i(_u()),c=Ze();let u=class Zd extends e.default{static fromPrivateKey(h){const m=new n.default().g.mul(h);return new Zd(m.x,m.y)}static fromString(h){const f=e.default.fromString(h);return new Zd(f.x,f.y)}static fromDER(h){const f=e.default.fromDER(h);return new Zd(f.x,f.y)}constructor(h,f=null,m=!0){if(h instanceof e.default)super(h.getX(),h.getY());else{if(f===null&&m&&typeof h=="string"&&(h.length===66||h.length===130))throw new Error('You are using the "new PublicKey()" constructor with a DER hex string. You need to use "PublicKey.fromString()" instead.');super(h,f,m)}}deriveSharedSecret(h){if(!this.validate())throw new Error("Public key not valid for ECDH secret derivation");return this.mul(h)}verify(h,f,m){const d=new t.default((0,s.sha256)(h,m),16);return(0,r.verify)(d,f,this)}toDER(h){return h==="hex"?this.encode(!0,h):this.encode(!0)}toHash(h){const f=(0,s.hash160)(this.encode(!0));return h==="hex"?(0,c.toHex)(f):f}toAddress(h=[0]){if(typeof h=="string")if(h==="testnet"||h==="test")h=[111];else if(h==="mainnet"||h==="main")h=[0];else throw new Error(`Invalid prefix ${h}`);return(0,c.toBase58Check)(this.toHash(),h)}deriveChild(h,f){const m=this.deriveSharedSecret(h),d=(0,c.toArray)(f,"utf8"),y=(0,s.sha256hmac)(m.encode(!0),d),g=new n.default().g.mul(new t.default(y)),v=this.add(g);return new Zd(v.x,v.y)}static fromMsgHashAndCompactSignature(h,f,m){const d=(0,c.toArray)(f,m);if(d.length!==65)throw new Error("Invalid Compact Signature");const y=d[0];if(y<27||y>=35)throw new Error("Invalid Compact Byte");let b=d[0]-27;return b>3&&(b-=4),new a.default(new t.default(d.slice(1,33)),new t.default(d.slice(33,65))).RecoverPublicKey(b,h)}};return kc.default=u,kc}var $n={},ip={};const dB={},fB=Object.freeze(Object.defineProperty({__proto__:null,default:dB},Symbol.toStringTag,{value:"Module"})),Sw=U8(fB);var gS;function Ln(){if(gS)return ip;gS=1,Object.defineProperty(ip,"__esModule",{value:!0});class i{constructor(){var r;const t=()=>{throw new Error("No secure random number generator is available in this environment.")};if(this._rand=t,typeof self=="object")!((r=self.crypto)===null||r===void 0)&&r.getRandomValues?this._rand=s=>{const a=new Uint8Array(s);return self.crypto.getRandomValues(a),[...a]}:this._rand=t;else try{const s=Sw;typeof s.randomBytes=="function"&&(this._rand=a=>[...s.randomBytes(a)])}catch{this._rand=t}}generate(r){return this._rand(r)}}let e=null;return ip.default=n=>(e==null&&(e=new i),e.generate(n)),ip}var ss={},bS;function I6(){if(bS)return ss;bS=1;var i=ss&&ss.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(ss,"__esModule",{value:!0}),ss.PointInFiniteField=void 0;const e=i(an()),n=i(qr()),r=i(Ln()),t=Ze();class s{constructor(u,l){const h=new n.default().p;this.x=u.umod(h),this.y=l.umod(h)}toString(){return(0,t.toBase58)(this.x.toArray())+"."+(0,t.toBase58)(this.y.toArray())}static fromString(u){const[l,h]=u.split(".");return new s(new e.default((0,t.fromBase58)(l)),new e.default((0,t.fromBase58)(h)))}}ss.PointInFiniteField=s;let a=class S6{constructor(u,l){this.points=u,this.threshold=l??u.length}static fromPrivateKey(u,l){const h=new n.default().p,f=[new s(new e.default(0),new e.default(u.toArray()))];for(let m=1;m<l;m++){const d=new e.default((0,r.default)(32)).umod(h),y=new e.default((0,r.default)(32)).umod(h);f.push(new s(d,y))}return new S6(f)}valueAt(u){const l=new n.default().p;let h=new e.default(0);for(let f=0;f<this.threshold;f++){let m=this.points[f].y;for(let d=0;d<this.threshold;d++)if(f!==d){const y=this.points[d].x,b=this.points[f].x,g=u.sub(y).umod(l),_=b.sub(y).umod(l).invm(l),S=g.mul(_).umod(l);m=m.mul(S).umod(l)}h=h.add(m).umod(l)}return h}};return ss.default=a,ss}var mS;function Iu(){if(mS)return $n;mS=1;var i=$n&&$n.__createBinding||(Object.create?function(y,b,g,v){v===void 0&&(v=g);var _=Object.getOwnPropertyDescriptor(b,g);(!_||("get"in _?!b.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return b[g]}}),Object.defineProperty(y,v,_)}:function(y,b,g,v){v===void 0&&(v=g),y[v]=b[g]}),e=$n&&$n.__setModuleDefault||(Object.create?function(y,b){Object.defineProperty(y,"default",{enumerable:!0,value:b})}:function(y,b){y.default=b}),n=$n&&$n.__importStar||function(y){if(y&&y.__esModule)return y;var b={};if(y!=null)for(var g in y)g!=="default"&&Object.prototype.hasOwnProperty.call(y,g)&&i(b,y,g);return e(b,y),b},r=$n&&$n.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty($n,"__esModule",{value:!0}),$n.KeyShares=void 0;const t=r(an()),s=r(Ca()),a=r(qr()),c=Su(),u=sn(),l=r(Ln()),h=Ze(),f=n(I6());class m{constructor(b,g,v){this.points=b,this.threshold=g,this.integrity=v}static fromBackupFormat(b){let g=0,v="";const _=b.map((S,I)=>{const A=S.split(".");if(A.length!==4)throw new Error("Invalid share format in share "+I.toString()+'. Expected format: "x.y.t.i" - received '+S);const[R,E,k,P]=A;if(k===void 0)throw new Error("Threshold not found in share "+I.toString());if(P===void 0)throw new Error("Integrity not found in share "+I.toString());const T=parseInt(k);if(I!==0&&g!==T)throw new Error("Threshold mismatch in share "+I.toString());if(I!==0&&v!==P)throw new Error("Integrity mismatch in share "+I.toString());return g=T,v=P,f.PointInFiniteField.fromString([R,E].join("."))});return new m(_,g,v)}toBackupFormat(){return this.points.map(b=>b.toString()+"."+this.threshold.toString()+"."+this.integrity)}}$n.KeyShares=m;let d=class Sa extends t.default{static fromRandom(){return new Sa((0,l.default)(32))}static fromString(b,g="hex"){return new Sa(super.fromString(b,g).toArray())}static fromHex(b){return new Sa(super.fromHex(b,"big"))}static fromWif(b,g=1){const v=(0,h.fromBase58Check)(b,void 0,g);if(v.data.length!==33)throw new Error("Invalid WIF length");if(v.data[32]!==1)throw new Error("Invalid WIF padding");return new Sa(v.data.slice(0,32))}constructor(b=0,g=10,v="be",_="apply"){if(b instanceof t.default?(super(),b.copy(this)):super(b,g,v),_!=="nocheck"){const S=this.checkInField();if(!S.inField){if(_==="error")throw new Error("Input is out of field");t.default.move(this,S.modN)}}}checkInField(){const b=new a.default,g=this.mod(b.n);return{inField:this.cmp(g)===0,modN:g}}isValid(){return this.checkInField().inField}sign(b,g,v=!0,_){const S=new t.default((0,u.sha256)(b,g),16);return(0,c.sign)(S,this,v,_)}verify(b,g,v){const _=new t.default((0,u.sha256)(b,v),16);return(0,c.verify)(_,g,this.toPublicKey())}toPublicKey(){const g=new a.default().g.mul(this);return new s.default(g.x,g.y)}toWif(b=[128]){if(!this.isValid())throw new Error("Value is out of field");return(0,h.toBase58Check)([...this.toArray("be",32),1],b)}toAddress(b=[0]){return this.toPublicKey().toAddress(b)}toHex(){return super.toHex(32)}toString(b="hex",g=64){return super.toString(b,g)}deriveSharedSecret(b){if(!b.validate())throw new Error("Public key not valid for ECDH secret derivation");return b.mul(this)}deriveChild(b,g){const v=this.deriveSharedSecret(b),_=(0,h.toArray)(g,"utf8"),S=(0,u.sha256hmac)(v.encode(!0),_),I=new a.default;return new Sa(this.add(new t.default(S)).mod(I.n).toArray())}toKeyShares(b,g){if(typeof b!="number"||typeof g!="number")throw new Error("threshold and totalShares must be numbers");if(b<2)throw new Error("threshold must be at least 2");if(g<2)throw new Error("totalShares must be at least 2");if(b>g)throw new Error("threshold should be less than or equal to totalShares");const v=f.default.fromPrivateKey(this,b),_=[];for(let I=0;I<g;I++){const A=new t.default(Sa.fromRandom().toArray()),R=v.valueAt(A);_.push(new f.PointInFiniteField(A,R))}const S=this.toPublicKey().toHash("hex").slice(0,8);return new m(_,b,S)}toBackupShares(b,g){return this.toKeyShares(b,g).toBackupFormat()}static fromBackupShares(b){return Sa.fromKeyShares(m.fromBackupFormat(b))}static fromKeyShares(b){const{points:g,threshold:v,integrity:_}=b;if(v<2)throw new Error("threshold must be at least 2");if(g.length<v)throw new Error(`At least ${v} shares are required to reconstruct the private key`);for(let R=0;R<v;R++)for(let E=R+1;E<v;E++)if(g[R].x.eq(g[E].x))throw new Error("Duplicate share detected, each must be unique.");const S=new f.default(g,v),I=new Sa(S.valueAt(new t.default(0)).toArray());if(I.toPublicKey().toHash("hex").slice(0,8)!==_)throw new Error("Integrity hash mismatch");return I}};return $n.default=d,$n}var Oc={},xb={},wS;function hB(){return wS||(wS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.AESGCMDecrypt=i.AESGCM=i.ghash=i.incrementLeastSignificantThirtyTwoBits=i.multiply=i.rightShift=i.exclusiveOR=i.getBytes=i.checkBit=i.AES=void 0;const e=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]),n=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]].map(T=>new Uint8Array(T)),r=new Uint8Array(256),t=new Uint8Array(256);for(let T=0;T<256;T++){const M=(T<<1^((T&128)!==0?27:0))&255;r[T]=M,t[T]=M^T}function s(T,M,C){for(let D=0;D<4;D++){const F=M[C+D];for(let B=0;B<4;B++)T[B][D]^=F[B]}}function a(T){for(let M=0;M<4;M++)for(let C=0;C<4;C++)T[M][C]=e[T[M][C]]}function c(T){for(let M=0;M<4;M++)T[M]=e[T[M]]}function u(T){const M=T[0];T[0]=T[1],T[1]=T[2],T[2]=T[3],T[3]=M}function l(T){let M=T[1][0];T[1][0]=T[1][1],T[1][1]=T[1][2],T[1][2]=T[1][3],T[1][3]=M,M=T[2][0];const C=T[2][1];T[2][0]=T[2][2],T[2][1]=T[2][3],T[2][2]=M,T[2][3]=C,M=T[3][3],T[3][3]=T[3][2],T[3][2]=T[3][1],T[3][1]=T[3][0],T[3][0]=M}function h(T){for(let M=0;M<4;M++){const C=T[0][M],D=T[1][M],F=T[2][M],B=T[3][M];T[0][M]=r[C]^t[D]^F^B,T[1][M]=C^r[D]^t[F]^B,T[2][M]=C^D^r[F]^t[B],T[3][M]=t[C]^D^F^r[B]}}function f(T,M){const C=M.length/4,D=[];for(let F=0;F<M.length;F++)F%4===0&&D.push([]),D[F>>2].push(M[F]);for(let F=C;F<4*T;F++){D[F]=[];const B=D[F-1].slice();if(F%C===0){u(B),c(B);const L=n[F/C];for(let q=0;q<4;q++)B[q]^=L[q]}else C>6&&F%C===4&&c(B);for(let L=0;L<4;L++)D[F][L]=D[F-C][L]^B[L]}return D}function m(T,M){let C,D,F,B;const L=[[],[],[],[]],q=[],K=Array.from(M);if(K.length<=16){for(;K.length<16;)K.unshift(0);B=11}else if(K.length<=24){for(;K.length<24;)K.unshift(0);B=13}else if(M.length<=32){for(;K.length<32;)K.unshift(0);B=15}else throw new Error("Illegal key length: "+String(M.length));const $=f(B,K);for(let U=0;U<4;U++)L[0][U]=T[U*4],L[1][U]=T[U*4+1],L[2][U]=T[U*4+2],L[3][U]=T[U*4+3];for(s(L,$,0),F=1;F<B;F++)a(L),l(L),F+1<B&&h(L),s(L,$,F*4);for(C=0;C<4;C++)for(D=0;D<4;D++)q.push(L[D][C]);return q}i.AES=m;const d=function(T,M,C){return(T[M]&1<<C)!==0?1:0};i.checkBit=d;const y=function(T){return[(T&4278190080)>>>24,(T&16711680)>>16,(T&65280)>>8,T&255]};i.getBytes=y;const b=function(T){return new Array(T).fill(0)},g=[225].concat(b(15)),v=function(T,M){const C=T.length,D=new Array(C);for(let F=0;F<C;F++)D[F]=T[F]^M[F];return D};i.exclusiveOR=v;const _=function(T,M){for(let C=0;C<T.length;C++)T[C]^=M[C]},S=function(T){let M,C=0,D=0;for(M=0;M<T.length;M++)D=C,C=T[M]&1,T[M]=T[M]>>1,D!==0&&(T[M]=T[M]|128);return T};i.rightShift=S;const I=function(T,M){const C=M.slice(),D=b(16);for(let F=0;F<16;F++)for(let B=7;B>=0;B--)(T[F]&1<<B)!==0&&_(D,C),(C[15]&1)!==0?((0,i.rightShift)(C),_(C,g)):(0,i.rightShift)(C);return D};i.multiply=I;const A=function(T){let M;const C=T.slice();for(M=15;M!==11&&(C[M]=C[M]+1,C[M]===256);M--)C[M]=0;return C};i.incrementLeastSignificantThirtyTwoBits=A;function R(T,M){var C;let D=b(16);for(let F=0;F<T.length;F+=16){const B=D.slice();for(let L=0;L<16;L++)B[L]^=(C=T[F+L])!==null&&C!==void 0?C:0;D=(0,i.multiply)(B,M)}return D}i.ghash=R;function E(T,M,C){if(T.length===0)return[];const D=new Array(T.length);let F=M,B=0;const L=Math.ceil(T.length/16);for(let q=0;q<L;q++){const K=m(F,C),$=Math.min(16,T.length-B);for(let U=0;U<$;U++)D[B]=T[B]^K[U],B++;q+1<L&&(F=(0,i.incrementLeastSignificantThirtyTwoBits)(F))}return D}function k(T,M,C,D){let F,B;const L=m(b(16),D);F=[...C],C.length===12?F=F.concat(b(3)).concat([1]):(C.length%16!==0&&(F=F.concat(b(16-C.length%16))),F=F.concat(b(8)),F=R(F.concat(b(4)).concat((0,i.getBytes)(C.length*8)),L));const q=E(T,(0,i.incrementLeastSignificantThirtyTwoBits)(F),D);return B=M.slice(),M.length===0?B=B.concat(b(16)):M.length%16!==0&&(B=B.concat(b(16-M.length%16))),B=B.concat(q),q.length===0?B=B.concat(b(16)):q.length%16!==0&&(B=B.concat(b(16-q.length%16))),B=B.concat(b(4)).concat((0,i.getBytes)(M.length*8)).concat(b(4)).concat((0,i.getBytes)(q.length*8)),{result:q,authenticationTag:E(R(B,L),F,D)}}i.AESGCM=k;function P(T,M,C,D,F){let B,L;const q=m(b(16),F);B=[...C],C.length===12?B=B.concat(b(3)).concat([1]):(C.length%16!==0&&(B=B.concat(b(16-C.length%16))),B=B.concat(b(8)),B=R(B.concat(b(4)).concat((0,i.getBytes)(C.length*8)),q));const K=E(T,(0,i.incrementLeastSignificantThirtyTwoBits)(B),F);return L=M.slice(),M.length===0?L=L.concat(b(16)):M.length%16!==0&&(L=L.concat(b(16-M.length%16))),L=L.concat(T),T.length===0?L=L.concat(b(16)):T.length%16!==0&&(L=L.concat(b(16-T.length%16))),L=L.concat(b(4)).concat((0,i.getBytes)(M.length*8)).concat(b(4)).concat((0,i.getBytes)(T.length*8)),E(R(L,q),B,F).join()!==D.join()?null:K}i.AESGCMDecrypt=P}(xb)),xb}var vS;function C0(){if(vS)return Oc;vS=1;var i=Oc&&Oc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Oc,"__esModule",{value:!0});const e=i(an()),n=hB(),r=i(Ln()),t=Ze();let s=class T6 extends e.default{static fromRandom(){return new T6((0,r.default)(32))}encrypt(c,u){const l=(0,r.default)(32);c=(0,t.toArray)(c,u);const{result:h,authenticationTag:f}=(0,n.AESGCM)(c,[],l,this.toArray("be",32));return(0,t.encode)([...l,...h,...f],u)}decrypt(c,u){c=(0,t.toArray)(c,u);const l=c.slice(0,32),h=c.slice(32),f=h.slice(-16),m=h.slice(0,-16),d=(0,n.AESGCMDecrypt)(m,[],l,f,this.toArray());if(d===null)throw new Error("Decryption failed!");return(0,t.encode)(d,u)}};return Oc.default=s,Oc}var ki={},xS;function M0(){if(xS)return ki;xS=1;var i=ki&&ki.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),e=ki&&ki.__setModuleDefault||(Object.create?function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}:function(l,h){l.default=h}),n=ki&&ki.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var f in l)f!=="default"&&Object.prototype.hasOwnProperty.call(l,f)&&i(h,l,f);return e(h,l),h},r=ki&&ki.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(ki,"__esModule",{value:!0});const t=r(_u()),s=r(an()),a=n(sn()),c=Ze();let u=class Er extends t.default{static format(h){const f={sourceTXID:h.sourceTXID,sourceOutputIndex:h.sourceOutputIndex,sequence:h.inputSequence},m=[...h.otherInputs];m.splice(h.inputIndex,0,f);const d=()=>{const E=new c.Writer;for(const T of m){if(typeof T.sourceTXID>"u"){if(T.sourceTransaction==null)throw new Error("Missing sourceTransaction for input");E.write(T.sourceTransaction.hash())}else E.writeReverse((0,c.toArray)(T.sourceTXID,"hex"));E.writeUInt32LE(T.sourceOutputIndex)}const k=E.toArray();return a.hash256(k)},y=()=>{var E;const k=new c.Writer;for(const M of m){const C=(E=M.sequence)!==null&&E!==void 0?E:4294967295;k.writeUInt32LE(C)}const P=k.toArray();return a.hash256(P)};function b(E){var k,P,T,M,C,D;const F=new c.Writer;if(typeof E>"u")for(const q of h.outputs){const K=(k=q.satoshis)!==null&&k!==void 0?k:0;F.writeUInt64LE(K);const $=(T=(P=q.lockingScript)===null||P===void 0?void 0:P.toBinary())!==null&&T!==void 0?T:[];F.writeVarIntNum($.length),F.write($)}else{const q=h.outputs[E];if(q===void 0)throw new Error(`Output at index ${E} does not exist`);const K=(M=q.satoshis)!==null&&M!==void 0?M:0;F.writeUInt64LE(K);const $=(D=(C=q.lockingScript)===null||C===void 0?void 0:C.toBinary())!==null&&D!==void 0?D:[];F.writeVarIntNum($.length),F.write($)}const B=F.toArray();return a.hash256(B)}let g=new Array(32).fill(0),v=new Array(32).fill(0),_=new Array(32).fill(0);(h.scope&Er.SIGHASH_ANYONECANPAY)===0&&(g=d()),(h.scope&Er.SIGHASH_ANYONECANPAY)===0&&(h.scope&31)!==Er.SIGHASH_SINGLE&&(h.scope&31)!==Er.SIGHASH_NONE&&(v=y()),(h.scope&31)!==Er.SIGHASH_SINGLE&&(h.scope&31)!==Er.SIGHASH_NONE?_=b():(h.scope&31)===Er.SIGHASH_SINGLE&&h.inputIndex<h.outputs.length&&(_=b(h.inputIndex));const S=new c.Writer;S.writeInt32LE(h.transactionVersion),S.write(g),S.write(v),S.writeReverse((0,c.toArray)(h.sourceTXID,"hex")),S.writeUInt32LE(h.sourceOutputIndex);const I=h.subscript.toBinary();S.writeVarIntNum(I.length),S.write(I),S.writeUInt64LE(h.sourceSatoshis);const A=f.sequence;return S.writeUInt32LE(A),S.write(_),S.writeUInt32LE(h.lockTime),S.writeUInt32LE(h.scope>>>0),S.toArray()}static fromChecksigFormat(h){if(h.length===0){const y=new s.default(1),b=new s.default(1),g=1;return new Er(y,b,g)}const f=h[h.length-1],m=h.slice(0,h.length-1),d=t.default.fromDER(m);return new Er(d.r,d.s,f)}constructor(h,f,m){super(h,f),this.scope=m}hasLowS(){return!(this.s.ltn(1)||this.s.gt(new s.default("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))}toChecksigFormat(){return[...this.toDER(),this.scope]}};return u.SIGHASH_ALL=1,u.SIGHASH_NONE=2,u.SIGHASH_SINGLE=3,u.SIGHASH_FORKID=64,u.SIGHASH_ANYONECANPAY=128,ki.default=u,ki}var Ac={},_S;function pB(){if(_S)return Ac;_S=1;var i=Ac&&Ac.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ac,"__esModule",{value:!0});const e=i(an()),n=i(qr()),r=sn(),t=jr();let s=class{constructor(){this.curve=new n.default}generateProof(c,u,l,h){const f=t.PrivateKey.fromRandom(),m=f.toPublicKey(),d=l.mul(f),y=this.computeChallenge(u,l,h,d,m),b=f.add(y.mul(c)).umod(this.curve.n);return{R:m,SPrime:d,z:b}}verifyProof(c,u,l,h){const{R:f,SPrime:m,z:d}=h,y=this.computeChallenge(c,u,l,m,f),b=this.curve.g.mul(d),g=f.add(c.mul(y));if(!b.eq(g))return!1;const v=u.mul(d),_=m.add(l.mul(y));return!!v.eq(_)}computeChallenge(c,u,l,h,f){const m=[...c.encode(!0),...u.encode(!0),...l.encode(!0),...h.encode(!0),...f.encode(!0)],d=(0,r.sha256)(m);return new e.default(d).umod(this.curve.n)}};return Ac.default=s,Ac}var SS;function jr(){return SS||(SS=1,function(i){var e=Zi&&Zi.__createBinding||(Object.create?function(v,_,S,I){I===void 0&&(I=S);var A=Object.getOwnPropertyDescriptor(_,S);(!A||("get"in A?!_.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return _[S]}}),Object.defineProperty(v,I,A)}:function(v,_,S,I){I===void 0&&(I=S),v[I]=_[S]}),n=Zi&&Zi.__setModuleDefault||(Object.create?function(v,_){Object.defineProperty(v,"default",{enumerable:!0,value:_})}:function(v,_){v.default=_}),r=Zi&&Zi.__importStar||function(v){if(v&&v.__esModule)return v;var _={};if(v!=null)for(var S in v)S!=="default"&&Object.prototype.hasOwnProperty.call(v,S)&&e(_,v,S);return n(_,v),_},t=Zi&&Zi.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(i,"__esModule",{value:!0}),i.Schnorr=i.PointInFiniteField=i.Polynomial=i.TransactionSignature=i.Random=i.Hash=i.Utils=i.ECDSA=i.DRBG=i.SymmetricKey=i.KeyShares=i.PrivateKey=i.Signature=i.PublicKey=i.Point=i.Curve=i.BigNumber=void 0;var s=an();Object.defineProperty(i,"BigNumber",{enumerable:!0,get:function(){return t(s).default}});var a=qr();Object.defineProperty(i,"Curve",{enumerable:!0,get:function(){return t(a).default}});var c=xu();Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return t(c).default}});var u=Ca();Object.defineProperty(i,"PublicKey",{enumerable:!0,get:function(){return t(u).default}});var l=_u();Object.defineProperty(i,"Signature",{enumerable:!0,get:function(){return t(l).default}});var h=Iu();Object.defineProperty(i,"PrivateKey",{enumerable:!0,get:function(){return t(h).default}}),Object.defineProperty(i,"KeyShares",{enumerable:!0,get:function(){return h.KeyShares}});var f=C0();Object.defineProperty(i,"SymmetricKey",{enumerable:!0,get:function(){return t(f).default}});var m=_6();Object.defineProperty(i,"DRBG",{enumerable:!0,get:function(){return t(m).default}}),i.ECDSA=r(Su()),i.Utils=r(Ze()),i.Hash=r(sn());var d=Ln();Object.defineProperty(i,"Random",{enumerable:!0,get:function(){return t(d).default}});var y=M0();Object.defineProperty(i,"TransactionSignature",{enumerable:!0,get:function(){return t(y).default}});var b=I6();Object.defineProperty(i,"Polynomial",{enumerable:!0,get:function(){return t(b).default}}),Object.defineProperty(i,"PointInFiniteField",{enumerable:!0,get:function(){return b.PointInFiniteField}});var g=pB();Object.defineProperty(i,"Schnorr",{enumerable:!0,get:function(){return t(g).default}})}(Zi)),Zi}var da={},rp={},IS;function Ef(){if(IS)return rp;IS=1,Object.defineProperty(rp,"__esModule",{value:!0});const i={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_SPLIT:127,OP_LEFT:128,OP_NUM2BIN:128,OP_RIGHT:129,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_NOP11:186,OP_NOP12:187,OP_NOP13:188,OP_NOP14:189,OP_NOP15:190,OP_NOP16:191,OP_NOP17:192,OP_NOP18:193,OP_NOP19:194,OP_NOP20:195,OP_NOP21:196,OP_NOP22:197,OP_NOP23:198,OP_NOP24:199,OP_NOP25:200,OP_NOP26:201,OP_NOP27:202,OP_NOP28:203,OP_NOP29:204,OP_NOP30:205,OP_NOP31:206,OP_NOP32:207,OP_NOP33:208,OP_NOP34:209,OP_NOP35:210,OP_NOP36:211,OP_NOP37:212,OP_NOP38:213,OP_NOP39:214,OP_NOP40:215,OP_NOP41:216,OP_NOP42:217,OP_NOP43:218,OP_NOP44:219,OP_NOP45:220,OP_NOP46:221,OP_NOP47:222,OP_NOP48:223,OP_NOP49:224,OP_NOP50:225,OP_NOP51:226,OP_NOP52:227,OP_NOP53:228,OP_NOP54:229,OP_NOP55:230,OP_NOP56:231,OP_NOP57:232,OP_NOP58:233,OP_NOP59:234,OP_NOP60:235,OP_NOP61:236,OP_NOP62:237,OP_NOP63:238,OP_NOP64:239,OP_NOP65:240,OP_NOP66:241,OP_NOP67:242,OP_NOP68:243,OP_NOP69:244,OP_NOP70:245,OP_NOP71:246,OP_NOP72:247,OP_NOP73:248,OP_NOP77:252,OP_SMALLDATA:249,OP_SMALLINTEGER:250,OP_PUBKEYS:251,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};for(const e in i)i[i[e]]=e;return rp.default=i,rp}var Pc={},TS;function Of(){if(TS)return Pc;TS=1;var i=Pc&&Pc.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pc,"__esModule",{value:!0});const e=i(Ef()),n=Ze(),r=i(an());let t=class tu{static fromASM(a){const c=[],u=a.split(" ");let l=0;for(;l<u.length;){const h=u[l];let f,m=0;if(h.startsWith("OP_")&&typeof e.default[h]<"u"&&(f=h,m=e.default[h]),h==="0")m=0,c.push({op:m}),l=l+1;else if(h==="-1")m=e.default.OP_1NEGATE,c.push({op:m}),l=l+1;else if(f===void 0){let d=u[l];d.length%2!==0&&(d="0"+d);const y=(0,n.toArray)(d,"hex");if((0,n.encode)(y,"hex")!==d)throw new Error("invalid hex string in script");const b=y.length;b>=0&&b<e.default.OP_PUSHDATA1?m=b:b<Math.pow(2,8)?m=e.default.OP_PUSHDATA1:b<Math.pow(2,16)?m=e.default.OP_PUSHDATA2:b<Math.pow(2,32)&&(m=e.default.OP_PUSHDATA4),c.push({data:y,op:m}),l=l+1}else m===e.default.OP_PUSHDATA1||m===e.default.OP_PUSHDATA2||m===e.default.OP_PUSHDATA4?(c.push({data:(0,n.toArray)(u[l+2],"hex"),op:m}),l=l+3):(c.push({op:m}),l=l+1)}return new tu(c)}static fromHex(a){if(a.length===0)return tu.fromBinary([]);if(a.length%2!==0)throw new Error("There is an uneven number of characters in the string which suggests it is not hex encoded.");if(!/^[0-9a-fA-F]+$/.test(a))throw new Error("Some elements in this string are not hex encoded.");return tu.fromBinary((0,n.toArray)(a,"hex"))}static fromBinary(a){a=[...a];const c=[];let u=0;const l=new n.Reader(a);for(;!l.eof();){const h=l.readUInt8();if(h===e.default.OP_RETURN&&u===0){c.push({op:h,data:l.read()});break}h===e.default.OP_IF||h===e.default.OP_NOTIF||h===e.default.OP_VERIF||h===e.default.OP_VERNOTIF?u++:h===e.default.OP_ENDIF&&u--;let f=0,m=[];if(h>0&&h<e.default.OP_PUSHDATA1)f=h,c.push({data:l.read(f),op:h});else if(h===e.default.OP_PUSHDATA1){try{f=l.readUInt8(),m=l.read(f)}catch{l.read()}c.push({data:m,op:h})}else if(h===e.default.OP_PUSHDATA2){try{f=l.readUInt16LE(),m=l.read(f)}catch{l.read()}c.push({data:m,op:h})}else if(h===e.default.OP_PUSHDATA4){try{f=l.readUInt32LE(),m=l.read(f)}catch{l.read()}c.push({data:m,op:h})}else c.push({op:h})}return new tu(c)}constructor(a=[]){this.chunks=a}toASM(){let a="";for(let c=0;c<this.chunks.length;c++){const u=this.chunks[c];a+=this._chunkToString(u)}return a.slice(1)}toHex(){return(0,n.encode)(this.toBinary(),"hex")}toBinary(){const a=new n.Writer;for(let c=0;c<this.chunks.length;c++){const u=this.chunks[c],l=u.op;if(a.writeUInt8(l),l===e.default.OP_RETURN&&u.data!=null){a.write(u.data);break}else u.data!=null&&(l<e.default.OP_PUSHDATA1?a.write(u.data):l===e.default.OP_PUSHDATA1?(a.writeUInt8(u.data.length),a.write(u.data)):l===e.default.OP_PUSHDATA2?(a.writeUInt16LE(u.data.length),a.write(u.data)):l===e.default.OP_PUSHDATA4&&(a.writeUInt32LE(u.data.length),a.write(u.data)))}return a.toArray()}writeScript(a){return this.chunks=this.chunks.concat(a.chunks),this}writeOpCode(a){return this.chunks.push({op:a}),this}setChunkOpCode(a,c){return this.chunks[a]={op:c},this}writeBn(a){if(a.cmpn(0)===e.default.OP_0)this.chunks.push({op:e.default.OP_0});else if(a.cmpn(-1)===0)this.chunks.push({op:e.default.OP_1NEGATE});else if(a.cmpn(1)>=0&&a.cmpn(16)<=0)this.chunks.push({op:a.toNumber()+e.default.OP_1-1});else{const c=a.toSm("little");this.writeBin(c)}return this}writeBin(a){let c;if(a.length>0&&a.length<e.default.OP_PUSHDATA1)c=a.length;else if(a.length===0)c=e.default.OP_0;else if(a.length<Math.pow(2,8))c=e.default.OP_PUSHDATA1;else if(a.length<Math.pow(2,16))c=e.default.OP_PUSHDATA2;else if(a.length<Math.pow(2,32))c=e.default.OP_PUSHDATA4;else throw new Error("You can't push that much data");return this.chunks.push({data:a,op:c}),this}writeNumber(a){return this.writeBn(new r.default(a)),this}removeCodeseparators(){const a=[];for(let c=0;c<this.chunks.length;c++)this.chunks[c].op!==e.default.OP_CODESEPARATOR&&a.push(this.chunks[c]);return this.chunks=a,this}findAndDelete(a){const c=a.toHex();for(let u=0;u<this.chunks.length;u++){const h=new tu([this.chunks[u]]).toHex();c===h&&this.chunks.splice(u,1)}return this}isPushOnly(){for(let a=0;a<this.chunks.length;a++)if(this.chunks[a].op>e.default.OP_16)return!1;return!0}isLockingScript(){throw new Error("Not implemented")}isUnlockingScript(){throw new Error("Not implemented")}_chunkToString(a){const c=a.op;let u="";if(typeof a.data>"u"){const l=e.default[c];u=`${u} ${l}`}else u=`${u} ${(0,n.toHex)(a.data)}`;return u}};return Pc.default=t,Pc}var Rc={},kS;function Af(){if(kS)return Rc;kS=1;var i=Rc&&Rc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rc,"__esModule",{value:!0});const e=i(Of());let n=class extends e.default{isLockingScript(){return!0}isUnlockingScript(){return!1}};return Rc.default=n,Rc}var Nc={},ES;function B0(){if(ES)return Nc;ES=1;var i=Nc&&Nc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Nc,"__esModule",{value:!0});const e=i(Of());let n=class extends e.default{isLockingScript(){return!1}isUnlockingScript(){return!0}};return Nc.default=n,Nc}var Ei={},OS;function k6(){if(OS)return Ei;OS=1;var i=Ei&&Ei.__createBinding||(Object.create?function(k,P,T,M){M===void 0&&(M=T);var C=Object.getOwnPropertyDescriptor(P,T);(!C||("get"in C?!P.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return P[T]}}),Object.defineProperty(k,M,C)}:function(k,P,T,M){M===void 0&&(M=T),k[M]=P[T]}),e=Ei&&Ei.__setModuleDefault||(Object.create?function(k,P){Object.defineProperty(k,"default",{enumerable:!0,value:P})}:function(k,P){k.default=P}),n=Ei&&Ei.__importStar||function(k){if(k&&k.__esModule)return k;var P={};if(k!=null)for(var T in k)T!=="default"&&Object.prototype.hasOwnProperty.call(k,T)&&i(P,k,T);return e(P,k),P},r=Ei&&Ei.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(Ei,"__esModule",{value:!0});const t=r(Of()),s=r(an()),a=r(Ef()),c=Ze(),u=n(sn()),l=r(M0()),h=r(Ca()),f=Su(),m=1024*1024*1024,d=Math.pow(2,31)-1,y=!0,b=!0,g=Object.freeze(new s.default(-1).toScriptNum()),v=Object.freeze(Array.from({length:17},(k,P)=>Object.freeze(new s.default(P).toScriptNum())));function _(k,P){if(k.length!==P.length)return!1;for(let T=0;T<k.length;T++)if(k[T]!==P[T])return!1;return!0}function S(k,P=Number.MAX_SAFE_INTEGER){return!(k.length>P||k.length>0&&(k[k.length-1]&127)===0&&(k.length<=1||(k[k.length-2]&128)===0))}function I(k){if(k.length<9||k.length>73||k[0]!==48||k[1]!==k.length-3)return!1;const P=k[2],T=k[3];if(P!==2||T===0||5+T>=k.length)return!1;const M=4+T,C=k[M],D=k[M+1];if(C!==2||D===0||(k[4]&128)!==0||T>1&&k[4]===0&&(k[5]&128)===0)return!1;const F=M+2;return!((k[F]&128)!==0||D>1&&k[F]===0&&(k[F+1]&128)===0||T+D+7!==k.length)}function A(k){return k===a.default.OP_2MUL||k===a.default.OP_2DIV||k===a.default.OP_VERIF||k===a.default.OP_VERNOTIF||k===a.default.OP_VER}function R(k){const P=k.data,T=k.op;return Array.isArray(P)?P.length===0?T===a.default.OP_0:P.length===1&&P[0]>=1&&P[0]<=16?T===a.default.OP_1+(P[0]-1):P.length===1&&P[0]===129?T===a.default.OP_1NEGATE:P.length<=75?T===P.length:P.length<=255?T===a.default.OP_PUSHDATA1:P.length<=65535?T===a.default.OP_PUSHDATA2:!0:!0}let E=class{constructor(P){var T;this.sourceTXID=P.sourceTXID,this.sourceOutputIndex=P.sourceOutputIndex,this.sourceSatoshis=P.sourceSatoshis,this.lockingScript=P.lockingScript,this.transactionVersion=P.transactionVersion,this.otherInputs=P.otherInputs,this.outputs=P.outputs,this.inputIndex=P.inputIndex,this.unlockingScript=P.unlockingScript,this.inputSequence=P.inputSequence,this.lockTime=P.lockTime,this.memoryLimit=(T=P.memoryLimit)!==null&&T!==void 0?T:32e6,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0,this.reset()}reset(){this.context="UnlockingScript",this.programCounter=0,this.lastCodeSeparator=null,this.stack=[],this.altStack=[],this.ifStack=[],this.stackMem=0,this.altStackMem=0}ensureStackMem(P){this.stackMem+P>this.memoryLimit&&this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes")}ensureAltStackMem(P){this.altStackMem+P>this.memoryLimit&&this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes")}pushStack(P){this.ensureStackMem(P.length),this.stack.push(P),this.stackMem+=P.length}pushStackCopy(P){this.ensureStackMem(P.length);const T=P.slice();this.stack.push(T),this.stackMem+=T.length}popStack(){this.stack.length===0&&this.scriptEvaluationError("Attempted to pop from an empty stack.");const P=this.stack.pop();return this.stackMem-=P.length,P}stackTop(P=-1){return(this.stack.length===0||this.stack.length<Math.abs(P)||P>=0&&P>=this.stack.length)&&this.scriptEvaluationError(`Stack underflow accessing element at index ${P}. Stack length is ${this.stack.length}.`),this.stack[this.stack.length+P]}pushAltStack(P){this.ensureAltStackMem(P.length),this.altStack.push(P),this.altStackMem+=P.length}popAltStack(){this.altStack.length===0&&this.scriptEvaluationError("Attempted to pop from an empty alt stack.");const P=this.altStack.pop();return this.altStackMem-=P.length,P}checkSignatureEncoding(P){if(P.length===0)return!0;if(!I(P))return this.scriptEvaluationError("The signature format is invalid."),!1;try{const T=l.default.fromChecksigFormat(P);if(b&&!T.hasLowS())return this.scriptEvaluationError("The signature must have a low S value."),!1;if((T.scope&l.default.SIGHASH_FORKID)===0)return this.scriptEvaluationError("The signature must use SIGHASH_FORKID."),!1}catch{return this.scriptEvaluationError("The signature format is invalid."),!1}return!0}checkPublicKeyEncoding(P){if(P.length===0)return this.scriptEvaluationError("Public key is empty."),!1;if(P.length<33)return this.scriptEvaluationError("The public key is too short, it must be at least 33 bytes."),!1;if(P[0]===4){if(P.length!==65)return this.scriptEvaluationError("The non-compressed public key must be 65 bytes."),!1}else if(P[0]===2||P[0]===3){if(P.length!==33)return this.scriptEvaluationError("The compressed public key must be 33 bytes."),!1}else return this.scriptEvaluationError("The public key is in an unknown format."),!1;try{h.default.fromDER(P)}catch{return this.scriptEvaluationError("The public key is in an unknown format."),!1}return!0}verifySignature(P,T,M){const C=l.default.format({sourceTXID:this.sourceTXID,sourceOutputIndex:this.sourceOutputIndex,sourceSatoshis:this.sourceSatoshis,transactionVersion:this.transactionVersion,otherInputs:this.otherInputs,outputs:this.outputs,inputIndex:this.inputIndex,subscript:M,inputSequence:this.inputSequence,lockTime:this.lockTime,scope:P.scope}),D=new s.default(u.hash256(C));return(0,f.verify)(D,P,T)}step(){if(this.stackMem>this.memoryLimit)return this.scriptEvaluationError("Stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;if(this.altStackMem>this.memoryLimit)return this.scriptEvaluationError("Alt stack memory usage has exceeded "+String(this.memoryLimit)+" bytes"),!1;this.context==="UnlockingScript"&&this.programCounter>=this.unlockingScript.chunks.length&&(this.context="LockingScript",this.programCounter=0);const P=this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript;if(this.programCounter>=P.chunks.length)return!1;const T=P.chunks[this.programCounter],M=T.op;typeof M>"u"&&this.scriptEvaluationError(`Missing opcode in ${this.context} at pc=${this.programCounter}.`),Array.isArray(T.data)&&T.data.length>m&&this.scriptEvaluationError(`Data push > ${m} bytes (pc=${this.programCounter}).`);const C=!this.ifStack.includes(!1);if(C&&A(M)&&this.scriptEvaluationError(`This opcode is currently disabled. (Opcode: ${a.default[M]}, PC: ${this.programCounter})`),C&&M>=0&&M<=a.default.OP_PUSHDATA4)R(T)||this.scriptEvaluationError(`This data is not minimally-encoded. (PC: ${this.programCounter})`),this.pushStack(Array.isArray(T.data)?T.data:[]);else if(C||M>=a.default.OP_IF&&M<=a.default.OP_ENDIF){let D,F,B,L,q,K,$,U,z,G,ne,ce,Se,Ie,me,xe,ke,Re,Ce,Ne,We,dt,Ut,Ht,Je,At;switch(M){case a.default.OP_1NEGATE:this.pushStackCopy(g);break;case a.default.OP_0:this.pushStackCopy(v[0]);break;case a.default.OP_1:case a.default.OP_2:case a.default.OP_3:case a.default.OP_4:case a.default.OP_5:case a.default.OP_6:case a.default.OP_7:case a.default.OP_8:case a.default.OP_9:case a.default.OP_10:case a.default.OP_11:case a.default.OP_12:case a.default.OP_13:case a.default.OP_14:case a.default.OP_15:case a.default.OP_16:ce=M-(a.default.OP_1-1),this.pushStackCopy(v[ce]);break;case a.default.OP_NOP:case a.default.OP_NOP2:case a.default.OP_NOP3:case a.default.OP_NOP1:case a.default.OP_NOP4:case a.default.OP_NOP5:case a.default.OP_NOP6:case a.default.OP_NOP7:case a.default.OP_NOP8:case a.default.OP_NOP9:case a.default.OP_NOP10:case a.default.OP_NOP11:case a.default.OP_NOP12:case a.default.OP_NOP13:case a.default.OP_NOP14:case a.default.OP_NOP15:case a.default.OP_NOP16:case a.default.OP_NOP17:case a.default.OP_NOP18:case a.default.OP_NOP19:case a.default.OP_NOP20:case a.default.OP_NOP21:case a.default.OP_NOP22:case a.default.OP_NOP23:case a.default.OP_NOP24:case a.default.OP_NOP25:case a.default.OP_NOP26:case a.default.OP_NOP27:case a.default.OP_NOP28:case a.default.OP_NOP29:case a.default.OP_NOP30:case a.default.OP_NOP31:case a.default.OP_NOP32:case a.default.OP_NOP33:case a.default.OP_NOP34:case a.default.OP_NOP35:case a.default.OP_NOP36:case a.default.OP_NOP37:case a.default.OP_NOP38:case a.default.OP_NOP39:case a.default.OP_NOP40:case a.default.OP_NOP41:case a.default.OP_NOP42:case a.default.OP_NOP43:case a.default.OP_NOP44:case a.default.OP_NOP45:case a.default.OP_NOP46:case a.default.OP_NOP47:case a.default.OP_NOP48:case a.default.OP_NOP49:case a.default.OP_NOP50:case a.default.OP_NOP51:case a.default.OP_NOP52:case a.default.OP_NOP53:case a.default.OP_NOP54:case a.default.OP_NOP55:case a.default.OP_NOP56:case a.default.OP_NOP57:case a.default.OP_NOP58:case a.default.OP_NOP59:case a.default.OP_NOP60:case a.default.OP_NOP61:case a.default.OP_NOP62:case a.default.OP_NOP63:case a.default.OP_NOP64:case a.default.OP_NOP65:case a.default.OP_NOP66:case a.default.OP_NOP67:case a.default.OP_NOP68:case a.default.OP_NOP69:case a.default.OP_NOP70:case a.default.OP_NOP71:case a.default.OP_NOP72:case a.default.OP_NOP73:case a.default.OP_NOP77:break;case a.default.OP_IF:case a.default.OP_NOTIF:Ie=!1,C&&(this.stack.length<1&&this.scriptEvaluationError("OP_IF and OP_NOTIF require at least one item on the stack when they are used!"),D=this.popStack(),Ie=this.castToBool(D),M===a.default.OP_NOTIF&&(Ie=!Ie)),this.ifStack.push(Ie);break;case a.default.OP_ELSE:this.ifStack.length===0&&this.scriptEvaluationError("OP_ELSE requires a preceeding OP_IF."),this.ifStack[this.ifStack.length-1]=!this.ifStack[this.ifStack.length-1];break;case a.default.OP_ENDIF:this.ifStack.length===0&&this.scriptEvaluationError("OP_ENDIF requires a preceeding OP_IF."),this.ifStack.pop();break;case a.default.OP_VERIFY:this.stack.length<1&&this.scriptEvaluationError("OP_VERIFY requires at least one item to be on the stack."),F=this.stackTop(),Ie=this.castToBool(F),Ie||this.scriptEvaluationError("OP_VERIFY requires the top stack value to be truthy."),this.popStack();break;case a.default.OP_RETURN:this.context==="UnlockingScript"?this.programCounter=this.unlockingScript.chunks.length:this.programCounter=this.lockingScript.chunks.length,this.ifStack=[],this.programCounter--;break;case a.default.OP_TOALTSTACK:this.stack.length<1&&this.scriptEvaluationError("OP_TOALTSTACK requires at oeast one item to be on the stack."),this.pushAltStack(this.popStack());break;case a.default.OP_FROMALTSTACK:this.altStack.length<1&&this.scriptEvaluationError("OP_FROMALTSTACK requires at least one item to be on the stack."),this.pushStack(this.popAltStack());break;case a.default.OP_2DROP:this.stack.length<2&&this.scriptEvaluationError("OP_2DROP requires at least two items to be on the stack."),this.popStack(),this.popStack();break;case a.default.OP_2DUP:this.stack.length<2&&this.scriptEvaluationError("OP_2DUP requires at least two items to be on the stack."),F=this.stackTop(-2),B=this.stackTop(-1),this.pushStackCopy(F),this.pushStackCopy(B);break;case a.default.OP_3DUP:this.stack.length<3&&this.scriptEvaluationError("OP_3DUP requires at least three items to be on the stack."),F=this.stackTop(-3),B=this.stackTop(-2),L=this.stackTop(-1),this.pushStackCopy(F),this.pushStackCopy(B),this.pushStackCopy(L);break;case a.default.OP_2OVER:this.stack.length<4&&this.scriptEvaluationError("OP_2OVER requires at least four items to be on the stack."),F=this.stackTop(-4),B=this.stackTop(-3),this.pushStackCopy(F),this.pushStackCopy(B);break;case a.default.OP_2ROT:{this.stack.length<6&&this.scriptEvaluationError("OP_2ROT requires at least six items to be on the stack.");const Te=this.popStack(),j=this.popStack(),he=this.popStack(),de=this.popStack(),Me=this.popStack(),ct=this.popStack();this.pushStack(de),this.pushStack(he),this.pushStack(j),this.pushStack(Te),this.pushStack(ct),this.pushStack(Me);break}case a.default.OP_2SWAP:{this.stack.length<4&&this.scriptEvaluationError("OP_2SWAP requires at least four items to be on the stack.");const Te=this.popStack(),j=this.popStack(),he=this.popStack(),de=this.popStack();this.pushStack(j),this.pushStack(Te),this.pushStack(de),this.pushStack(he);break}case a.default.OP_IFDUP:this.stack.length<1&&this.scriptEvaluationError("OP_IFDUP requires at least one item to be on the stack."),F=this.stackTop(),this.castToBool(F)&&this.pushStackCopy(F);break;case a.default.OP_DEPTH:this.pushStack(new s.default(this.stack.length).toScriptNum());break;case a.default.OP_DROP:this.stack.length<1&&this.scriptEvaluationError("OP_DROP requires at least one item to be on the stack."),this.popStack();break;case a.default.OP_DUP:this.stack.length<1&&this.scriptEvaluationError("OP_DUP requires at least one item to be on the stack."),this.pushStackCopy(this.stackTop());break;case a.default.OP_NIP:this.stack.length<2&&this.scriptEvaluationError("OP_NIP requires at least two items to be on the stack."),B=this.popStack(),this.popStack(),this.pushStack(B);break;case a.default.OP_OVER:this.stack.length<2&&this.scriptEvaluationError("OP_OVER requires at least two items to be on the stack."),this.pushStackCopy(this.stackTop(-2));break;case a.default.OP_PICK:case a.default.OP_ROLL:{this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items to be on the stack.`),U=s.default.fromScriptNum(this.popStack(),y),ce=U.toNumber(),(ce<0||ce>=this.stack.length)&&this.scriptEvaluationError(`${a.default[M]} requires the top stack element to be 0 or a positive number less than the current size of the stack.`);const Te=this.stack[this.stack.length-1-ce];M===a.default.OP_ROLL?(this.stack.splice(this.stack.length-1-ce,1),this.stackMem-=Te.length,this.pushStack(Te)):this.pushStackCopy(Te);break}case a.default.OP_ROT:this.stack.length<3&&this.scriptEvaluationError("OP_ROT requires at least three items to be on the stack."),$=this.popStack(),K=this.popStack(),q=this.popStack(),this.pushStack(K),this.pushStack($),this.pushStack(q);break;case a.default.OP_SWAP:this.stack.length<2&&this.scriptEvaluationError("OP_SWAP requires at least two items to be on the stack."),K=this.popStack(),q=this.popStack(),this.pushStack(K),this.pushStack(q);break;case a.default.OP_TUCK:this.stack.length<2&&this.scriptEvaluationError("OP_TUCK requires at least two items to be on the stack."),F=this.stackTop(-1),this.ensureStackMem(F.length),this.stack.splice(this.stack.length-2,0,F.slice()),this.stackMem+=F.length;break;case a.default.OP_SIZE:this.stack.length<1&&this.scriptEvaluationError("OP_SIZE requires at least one item to be on the stack."),this.pushStack(new s.default(this.stackTop().length).toScriptNum());break;case a.default.OP_AND:case a.default.OP_OR:case a.default.OP_XOR:{this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items on the stack.`),B=this.popStack(),F=this.popStack(),F.length!==B.length&&this.scriptEvaluationError(`${a.default[M]} requires the top two stack items to be the same size.`);const Te=new Array(F.length);for(let j=0;j<F.length;j++)M===a.default.OP_AND?Te[j]=F[j]&B[j]:M===a.default.OP_OR?Te[j]=F[j]|B[j]:Te[j]=F[j]^B[j];this.pushStack(Te);break}case a.default.OP_INVERT:{this.stack.length<1&&this.scriptEvaluationError("OP_INVERT requires at least one item to be on the stack."),D=this.popStack();const Te=new Array(D.length);for(let j=0;j<D.length;j++)Te[j]=~D[j]&255;this.pushStack(Te);break}case a.default.OP_LSHIFT:case a.default.OP_RSHIFT:{if(this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items to be on the stack.`),G=s.default.fromScriptNum(this.popStack(),y),F=this.popStack(),ce=G.toNumber(),ce<0&&this.scriptEvaluationError(`${a.default[M]} requires the top item on the stack not to be negative.`),F.length===0){this.pushStack([]);break}z=new s.default(F);let Te;M===a.default.OP_LSHIFT?Te=z.ushln(ce):Te=z.ushrn(ce);const j=Te.toArray("le",F.length);this.pushStack(j);break}case a.default.OP_EQUAL:case a.default.OP_EQUALVERIFY:this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items to be on the stack.`),B=this.popStack(),F=this.popStack(),Ie=_(F,B),this.pushStack(Ie?[1]:[]),M===a.default.OP_EQUALVERIFY&&(Ie||this.scriptEvaluationError("OP_EQUALVERIFY requires the top two stack items to be equal."),this.popStack());break;case a.default.OP_1ADD:case a.default.OP_1SUB:case a.default.OP_NEGATE:case a.default.OP_ABS:case a.default.OP_NOT:case a.default.OP_0NOTEQUAL:switch(this.stack.length<1&&this.scriptEvaluationError(`${a.default[M]} requires at least one item to be on the stack.`),U=s.default.fromScriptNum(this.popStack(),y),M){case a.default.OP_1ADD:U=U.add(new s.default(1));break;case a.default.OP_1SUB:U=U.sub(new s.default(1));break;case a.default.OP_NEGATE:U=U.neg();break;case a.default.OP_ABS:U.isNeg()&&(U=U.neg());break;case a.default.OP_NOT:U=new s.default(U.cmpn(0)===0?1:0);break;case a.default.OP_0NOTEQUAL:U=new s.default(U.cmpn(0)!==0?1:0);break}this.pushStack(U.toScriptNum());break;case a.default.OP_ADD:case a.default.OP_SUB:case a.default.OP_MUL:case a.default.OP_DIV:case a.default.OP_MOD:case a.default.OP_BOOLAND:case a.default.OP_BOOLOR:case a.default.OP_NUMEQUAL:case a.default.OP_NUMEQUALVERIFY:case a.default.OP_NUMNOTEQUAL:case a.default.OP_LESSTHAN:case a.default.OP_GREATERTHAN:case a.default.OP_LESSTHANOREQUAL:case a.default.OP_GREATERTHANOREQUAL:case a.default.OP_MIN:case a.default.OP_MAX:{this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items to be on the stack.`),B=this.popStack(),F=this.popStack(),G=s.default.fromScriptNum(B,y),z=s.default.fromScriptNum(F,y);let Te=0;switch(M){case a.default.OP_MUL:Te=z.byteLength()+G.byteLength();break;case a.default.OP_ADD:case a.default.OP_SUB:Te=Math.max(z.byteLength(),G.byteLength())+1;break;default:Te=Math.max(z.byteLength(),G.byteLength())}this.ensureStackMem(Te);let j=new s.default(0);switch(M){case a.default.OP_ADD:j=z.add(G);break;case a.default.OP_SUB:j=z.sub(G);break;case a.default.OP_MUL:j=z.mul(G);break;case a.default.OP_DIV:G.cmpn(0)===0&&this.scriptEvaluationError("OP_DIV cannot divide by zero!"),j=z.div(G);break;case a.default.OP_MOD:G.cmpn(0)===0&&this.scriptEvaluationError("OP_MOD cannot divide by zero!"),j=z.mod(G);break;case a.default.OP_BOOLAND:j=new s.default(z.cmpn(0)!==0&&G.cmpn(0)!==0?1:0);break;case a.default.OP_BOOLOR:j=new s.default(z.cmpn(0)!==0||G.cmpn(0)!==0?1:0);break;case a.default.OP_NUMEQUAL:j=new s.default(z.cmp(G)===0?1:0);break;case a.default.OP_NUMEQUALVERIFY:j=new s.default(z.cmp(G)===0?1:0);break;case a.default.OP_NUMNOTEQUAL:j=new s.default(z.cmp(G)!==0?1:0);break;case a.default.OP_LESSTHAN:j=new s.default(z.cmp(G)<0?1:0);break;case a.default.OP_GREATERTHAN:j=new s.default(z.cmp(G)>0?1:0);break;case a.default.OP_LESSTHANOREQUAL:j=new s.default(z.cmp(G)<=0?1:0);break;case a.default.OP_GREATERTHANOREQUAL:j=new s.default(z.cmp(G)>=0?1:0);break;case a.default.OP_MIN:j=z.cmp(G)<0?z:G;break;case a.default.OP_MAX:j=z.cmp(G)>0?z:G;break}this.pushStack(j.toScriptNum()),M===a.default.OP_NUMEQUALVERIFY&&(this.castToBool(this.stackTop())||this.scriptEvaluationError("OP_NUMEQUALVERIFY requires the top stack item to be truthy."),this.popStack());break}case a.default.OP_WITHIN:this.stack.length<3&&this.scriptEvaluationError("OP_WITHIN requires at least three items to be on the stack."),ne=s.default.fromScriptNum(this.popStack(),y),G=s.default.fromScriptNum(this.popStack(),y),z=s.default.fromScriptNum(this.popStack(),y),Ie=z.cmp(G)>=0&&z.cmp(ne)<0,this.pushStack(Ie?[1]:[]);break;case a.default.OP_RIPEMD160:case a.default.OP_SHA1:case a.default.OP_SHA256:case a.default.OP_HASH160:case a.default.OP_HASH256:{this.stack.length<1&&this.scriptEvaluationError(`${a.default[M]} requires at least one item to be on the stack.`),D=this.popStack();let Te=[];M===a.default.OP_RIPEMD160?Te=u.ripemd160(D):M===a.default.OP_SHA1?Te=u.sha1(D):M===a.default.OP_SHA256?Te=u.sha256(D):M===a.default.OP_HASH160?Te=u.hash160(D):M===a.default.OP_HASH256&&(Te=u.hash256(D)),this.pushStack(Te);break}case a.default.OP_CODESEPARATOR:this.lastCodeSeparator=this.programCounter;break;case a.default.OP_CHECKSIG:case a.default.OP_CHECKSIGVERIFY:{this.stack.length<2&&this.scriptEvaluationError(`${a.default[M]} requires at least two items to be on the stack.`),Re=this.popStack(),ke=this.popStack(),(!this.checkSignatureEncoding(ke)||!this.checkPublicKeyEncoding(Re))&&this.scriptEvaluationError(`${a.default[M]} requires correct encoding for the public key and signature.`);const j=(this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript).chunks.slice(this.lastCodeSeparator===null?0:this.lastCodeSeparator+1);if(xe=new t.default(j),xe.findAndDelete(new t.default().writeBin(ke)),me=!1,ke.length>0)try{Ce=l.default.fromChecksigFormat(ke),Ne=h.default.fromDER(Re),me=this.verifySignature(Ce,Ne,xe)}catch{me=!1}this.pushStack(me?[1]:[]),M===a.default.OP_CHECKSIGVERIFY&&(me||this.scriptEvaluationError("OP_CHECKSIGVERIFY requires that a valid signature is provided."),this.popStack());break}case a.default.OP_CHECKMULTISIG:case a.default.OP_CHECKMULTISIGVERIFY:{We=1,this.stack.length<We&&this.scriptEvaluationError(`${a.default[M]} requires at least 1 item for nKeys.`),Ht=s.default.fromScriptNum(this.stackTop(-We),y).toNumber(),(Ht<0||Ht>d)&&this.scriptEvaluationError(`${a.default[M]} requires a key count between 0 and ${d}.`),dt=++We,We+=Ht,this.stack.length<We&&this.scriptEvaluationError(`${a.default[M]} stack too small for nKeys and keys. Need ${We}, have ${this.stack.length}.`),Je=s.default.fromScriptNum(this.stackTop(-We),y).toNumber(),(Je<0||Je>Ht)&&this.scriptEvaluationError(`${a.default[M]} requires the number of signatures to be no greater than the number of keys.`),Ut=++We,We+=Je,this.stack.length<We&&this.scriptEvaluationError(`${a.default[M]} stack too small for N, keys, M, sigs, and dummy. Need ${We}, have ${this.stack.length}.`);const j=(this.context==="UnlockingScript"?this.unlockingScript:this.lockingScript).chunks.slice(this.lastCodeSeparator===null?0:this.lastCodeSeparator+1);xe=new t.default(j);for(let ct=0;ct<Je;ct++)ke=this.stackTop(-Ut-ct),xe.findAndDelete(new t.default().writeBin(ke));for(me=!0;me&&Je>0;){if(Ht===0){me=!1;break}if(ke=this.stackTop(-Ut),Re=this.stackTop(-dt),(!this.checkSignatureEncoding(ke)||!this.checkPublicKeyEncoding(Re))&&this.scriptEvaluationError(`${a.default[M]} requires correct encoding for the public key and signature.`),At=!1,ke.length>0)try{Ce=l.default.fromChecksigFormat(ke),Ne=h.default.fromDER(Re),At=this.verifySignature(Ce,Ne,xe)}catch{At=!1}At&&(Ut++,Je--),dt++,Ht--,Je>Ht&&(me=!1)}let de=1+s.default.fromScriptNum(this.stackTop(-1),!1).toNumber()+1+s.default.fromScriptNum(this.stackTop(-(1+s.default.fromScriptNum(this.stackTop(-1),!1).toNumber()+1)),!1).toNumber()+1-1;for(;de>0;)this.popStack(),de--;this.stack.length<1&&this.scriptEvaluationError(`${a.default[M]} requires an extra item (dummy) to be on the stack.`),this.popStack().length>0&&this.scriptEvaluationError(`${a.default[M]} requires the extra stack item (dummy) to be empty.`),this.pushStack(me?[1]:[]),M===a.default.OP_CHECKMULTISIGVERIFY&&(me||this.scriptEvaluationError("OP_CHECKMULTISIGVERIFY requires that a sufficient number of valid signatures are provided."),this.popStack());break}case a.default.OP_CAT:{this.stack.length<2&&this.scriptEvaluationError("OP_CAT requires at least two items to be on the stack."),B=this.popStack(),F=this.popStack();const Te=F.concat(B);Te.length>m&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${m} bytes.`),this.pushStack(Te);break}case a.default.OP_SPLIT:{this.stack.length<2&&this.scriptEvaluationError("OP_SPLIT requires at least two items to be on the stack.");const Te=this.popStack(),j=this.popStack();ce=s.default.fromScriptNum(Te,y).toNumber(),(ce<0||ce>j.length)&&this.scriptEvaluationError("OP_SPLIT requires the first stack item to be a non-negative number less than or equal to the size of the second-from-top stack item."),this.pushStack(j.slice(0,ce)),this.pushStack(j.slice(ce));break}case a.default.OP_NUM2BIN:{this.stack.length<2&&this.scriptEvaluationError("OP_NUM2BIN requires at least two items to be on the stack."),Se=s.default.fromScriptNum(this.popStack(),y).toNumber(),(Se>m||Se<0)&&this.scriptEvaluationError(`It's not currently possible to push data larger than ${m} bytes or negative size.`);let Te=this.popStack();if(Te=(0,c.minimallyEncode)(Te),Te.length>Se&&this.scriptEvaluationError("OP_NUM2BIN requires that the size expressed in the top stack item is large enough to hold the value expressed in the second-from-top stack item."),Te.length===Se){this.pushStack(Te);break}const j=new Array(Se).fill(0);let he=0;Te.length>0&&(he=Te[Te.length-1]&128,Te[Te.length-1]&=127);for(let de=0;de<Te.length;de++)j[de]=Te[de];he!==0&&(j[Se-1]|=128),this.pushStack(j);break}case a.default.OP_BIN2NUM:{this.stack.length<1&&this.scriptEvaluationError("OP_BIN2NUM requires at least one item to be on the stack."),F=this.popStack();const Te=(0,c.minimallyEncode)(F);S(Te)||this.scriptEvaluationError("OP_BIN2NUM requires that the resulting number is valid."),this.pushStack(Te);break}default:this.scriptEvaluationError(`Invalid opcode ${M} (pc=${this.programCounter}).`)}}return this.programCounter++,!0}validate(){for(this.unlockingScript.isPushOnly()||this.scriptEvaluationError("Unlocking scripts can only contain push operations, and no other opcodes.");this.step()&&!(this.context==="LockingScript"&&this.programCounter>=this.lockingScript.chunks.length););return this.ifStack.length>0&&this.scriptEvaluationError("Every OP_IF, OP_NOTIF, or OP_ELSE must be terminated with OP_ENDIF prior to the end of the script."),this.stack.length!==1&&this.scriptEvaluationError(`The clean stack rule requires exactly one item to be on the stack after script execution, found ${this.stack.length}.`),this.stack.length===0?this.scriptEvaluationError("The top stack element must be truthy after script evaluation (stack is empty)."):this.castToBool(this.stackTop())||this.scriptEvaluationError("The top stack element must be truthy after script evaluation."),!0}castToBool(P){if(P.length===0)return!1;for(let T=0;T<P.length;T++)if(P[T]!==0)return!(T===P.length-1&&P[T]===128);return!1}scriptEvaluationError(P){const T=`Context: ${this.context}, PC: ${this.programCounter}`,M=this.stack.map(L=>L!=null&&typeof L.length<"u"?(0,c.toHex)(L):L==null?"null/undef":"INVALID_STACK_ITEM").join(", "),C=this.altStack.map(L=>L!=null&&typeof L.length<"u"?(0,c.toHex)(L):L==null?"null/undef":"INVALID_STACK_ITEM").join(", "),D=`Stack: [${M}] (len: ${this.stack.length}, mem: ${this.stackMem})`,F=`AltStack: [${C}] (len: ${this.altStack.length}, mem: ${this.altStackMem})`,B=`IfStack: [${this.ifStack.join(", ")}]`;throw new Error(`Script evaluation error: ${P}
TXID: ${this.sourceTXID}, OutputIdx: ${this.sourceOutputIndex}
${T}
${D}
${F}
${B}`)}};return Ei.default=E,Ei}var Al={},Cc={},AS;function Iw(){if(AS)return Cc;AS=1;var i=Cc&&Cc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Cc,"__esModule",{value:!0});const e=i(Ef()),n=Ze(),r=i(Af()),t=i(B0()),s=i(M0()),a=sn();function c(l){if(l==null)throw new Error("must have value");return l}let u=class{lock(h){let f;if(typeof h=="string"){const m=(0,n.fromBase58Check)(h);if(m.prefix[0]!==0&&m.prefix[0]!==111)throw new Error("only P2PKH is supported");f=m.data}else f=h;if(f.length!==20)throw new Error("P2PKH hash length must be 20 bytes");return new r.default([{op:e.default.OP_DUP},{op:e.default.OP_HASH160},{op:f.length,data:f},{op:e.default.OP_EQUALVERIFY},{op:e.default.OP_CHECKSIG}])}unlock(h,f="all",m=!1,d,y){return{sign:async(b,g)=>{var v,_,S,I;let A=s.default.SIGHASH_FORKID;f==="all"&&(A|=s.default.SIGHASH_ALL),f==="none"&&(A|=s.default.SIGHASH_NONE),f==="single"&&(A|=s.default.SIGHASH_SINGLE),m&&(A|=s.default.SIGHASH_ANYONECANPAY);const R=b.inputs[g],E=b.inputs.filter((F,B)=>B!==g),k=(v=R.sourceTXID)!==null&&v!==void 0?v:(_=R.sourceTransaction)===null||_===void 0?void 0:_.id("hex");if(k==null||k===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(k==="")throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(d||(d=(S=R.sourceTransaction)===null||S===void 0?void 0:S.outputs[R.sourceOutputIndex].satoshis),d==null||d===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(y||(y=(I=R.sourceTransaction)===null||I===void 0?void 0:I.outputs[R.sourceOutputIndex].lockingScript),y==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const P=s.default.format({sourceTXID:k,sourceOutputIndex:c(R.sourceOutputIndex),sourceSatoshis:d,transactionVersion:b.version,otherInputs:E,inputIndex:g,outputs:b.outputs,inputSequence:c(R.sequence),subscript:y,lockTime:b.lockTime,scope:A}),T=h.sign((0,a.sha256)(P)),C=new s.default(T.r,T.s,A).toChecksigFormat(),D=h.toPublicKey().encode(!0);return new t.default([{op:C.length,data:C},{op:D.length,data:D}])},estimateLength:async()=>108}}};return Cc.default=u,Cc}var Mc={},PS;function yB(){if(PS)return Mc;PS=1;var i=Mc&&Mc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Mc,"__esModule",{value:!0});const e=i(Ef()),n=i(Af()),r=i(B0()),t=i(Iu()),s=i(M0()),a=sn(),c=i(Of());let u=class{constructor(h="raw"){this.type="raw",this.type=h}lock(h){const f=[{op:e.default.OP_OVER},{op:e.default.OP_3},{op:e.default.OP_SPLIT},{op:e.default.OP_NIP},{op:e.default.OP_1},{op:e.default.OP_SPLIT},{op:e.default.OP_SWAP},{op:e.default.OP_SPLIT},{op:e.default.OP_DROP}];return this.type!=="raw"&&f.push({op:e.default["OP_"+this.type]}),f.push({op:h.length,data:h}),f.push({op:e.default.OP_EQUALVERIFY}),f.push({op:e.default.OP_CHECKSIG}),new n.default(f)}unlock(h,f,m="all",d=!1){return{sign:async(y,b)=>{var g,v,_,S,I,A,R,E,k,P;typeof f>"u"&&(f=t.default.fromRandom());let T=s.default.SIGHASH_FORKID;m==="all"&&(T|=s.default.SIGHASH_ALL),m==="none"&&(T|=s.default.SIGHASH_NONE),m==="single"&&(T|=s.default.SIGHASH_SINGLE),d&&(T|=s.default.SIGHASH_ANYONECANPAY);const M=[...y.inputs],[C]=M.splice(b,1);if(typeof C.sourceTransaction!="object")throw new Error("The source transaction is needed for transaction signing.");const D=s.default.format({sourceTXID:(v=(g=C.sourceTransaction)===null||g===void 0?void 0:g.id("hex"))!==null&&v!==void 0?v:"",sourceOutputIndex:(_=C.sourceOutputIndex)!==null&&_!==void 0?_:0,sourceSatoshis:(A=(I=(S=C.sourceTransaction)===null||S===void 0?void 0:S.outputs[C.sourceOutputIndex])===null||I===void 0?void 0:I.satoshis)!==null&&A!==void 0?A:0,transactionVersion:y.version,otherInputs:M,inputIndex:b,outputs:y.outputs,inputSequence:(R=C.sequence)!==null&&R!==void 0?R:4294967295,subscript:(P=(k=(E=C.sourceTransaction)===null||E===void 0?void 0:E.outputs[C.sourceOutputIndex])===null||k===void 0?void 0:k.lockingScript)!==null&&P!==void 0?P:new c.default,lockTime:y.lockTime,scope:T}),F=f.sign((0,a.sha256)(D),void 0,!0,h),L=new s.default(F.r,F.s,T).toChecksigFormat(),q=f.toPublicKey().encode(!0);return new r.default([{op:L.length,data:L},{op:q.length,data:q}])},estimateLength:async()=>108}}};return Mc.default=u,Mc}var ap={},RS;function D0(){if(RS)return ap;RS=1,Object.defineProperty(ap,"__esModule",{value:!0});const i=L0(),e=jr();function n(s){if(s==null)throw new Error("must have value");return s}const r=s=>s.length===0?{op:0}:s.length===1&&s[0]===0?{op:0}:s.length===1&&s[0]>0&&s[0]<=16?{op:80+s[0]}:s.length===1&&s[0]===129?{op:79}:s.length<=75?{op:s.length,data:s}:s.length<=255?{op:76,data:s}:s.length<=65535?{op:77,data:s}:{op:78,data:s};let t=class{static decode(a){var c,u;const l=e.PublicKey.fromString(e.Utils.toHex(n(a.chunks[0].data))),h=[];for(let f=2;f<a.chunks.length;f++){const m=(c=a.chunks[f+1])===null||c===void 0?void 0:c.op;let d=(u=a.chunks[f].data)!==null&&u!==void 0?u:[];if(d.length===0&&(a.chunks[f].op>=80&&a.chunks[f].op<=95?d=[a.chunks[f].op-80]:a.chunks[f].op===0?d=[0]:a.chunks[f].op===79&&(d=[129])),h.push(d),m===i.OP.OP_DROP||m===i.OP.OP_2DROP)break}return{fields:h,lockingPublicKey:l}}constructor(a,c){this.wallet=a,this.originator=c}async lock(a,c,u,l,h=!1,f=!0,m="before"){const{publicKey:d}=await this.wallet.getPublicKey({protocolID:c,keyID:u,counterparty:l,forSelf:h},this.originator),y=[],b=[];if(y.push({op:d.length/2,data:e.Utils.toArray(d,"hex")}),y.push({op:i.OP.OP_CHECKSIG}),f){const v=a.reduce((S,I)=>[...S,...I],[]),{signature:_}=await this.wallet.createSignature({data:v,protocolID:c,keyID:u,counterparty:l},this.originator);a.push(_)}for(const v of a)b.push(r(v));let g=a.length;for(;g>1;)b.push({op:i.OP.OP_2DROP}),g-=2;return g!==0&&b.push({op:i.OP.OP_DROP}),m==="before"?new i.LockingScript([...y,...b]):new i.LockingScript([...b,...y])}unlock(a,c,u,l="all",h=!1,f,m){return{sign:async(d,y)=>{var b,g,v,_,S;let I=e.TransactionSignature.SIGHASH_FORKID;l==="all"&&(I|=e.TransactionSignature.SIGHASH_ALL),l==="none"&&(I|=e.TransactionSignature.SIGHASH_NONE),l==="single"&&(I|=e.TransactionSignature.SIGHASH_SINGLE),h&&(I|=e.TransactionSignature.SIGHASH_ANYONECANPAY);const A=d.inputs[y],R=d.inputs.filter((F,B)=>B!==y),E=(b=A.sourceTXID)!==null&&b!==void 0?b:(g=A.sourceTransaction)===null||g===void 0?void 0:g.id("hex");if(E==null||E===void 0)throw new Error("The input sourceTXID or sourceTransaction is required for transaction signing.");if(f||(f=(v=A.sourceTransaction)===null||v===void 0?void 0:v.outputs[A.sourceOutputIndex].satoshis),f==null||f===void 0)throw new Error("The sourceSatoshis or input sourceTransaction is required for transaction signing.");if(m||(m=(_=A.sourceTransaction)===null||_===void 0?void 0:_.outputs[A.sourceOutputIndex].lockingScript),m==null)throw new Error("The lockingScript or input sourceTransaction is required for transaction signing.");const k=e.TransactionSignature.format({sourceTXID:E,sourceOutputIndex:n(A.sourceOutputIndex),sourceSatoshis:f,transactionVersion:d.version,otherInputs:R,inputIndex:y,outputs:d.outputs,inputSequence:(S=A.sequence)!==null&&S!==void 0?S:4294967295,subscript:m,lockTime:d.lockTime,scope:I}),P=e.Hash.sha256(k),{signature:T}=await this.wallet.createSignature({data:P,protocolID:a,keyID:c,counterparty:u},this.originator),M=e.Signature.fromDER([...T]),D=new e.TransactionSignature(M.r,M.s,I).toChecksigFormat();return new i.UnlockingScript([{op:D.length,data:D}])},estimateLength:async()=>73}}};return ap.default=t,ap}var NS;function E6(){return NS||(NS=1,function(i){var e=Al&&Al.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i,"__esModule",{value:!0}),i.PushDrop=i.RPuzzle=i.P2PKH=void 0;var n=Iw();Object.defineProperty(i,"P2PKH",{enumerable:!0,get:function(){return e(n).default}});var r=yB();Object.defineProperty(i,"RPuzzle",{enumerable:!0,get:function(){return e(r).default}});var t=D0();Object.defineProperty(i,"PushDrop",{enumerable:!0,get:function(){return e(t).default}})}(Al)),Al}var CS;function L0(){return CS||(CS=1,function(i){var e=da&&da.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),n=da&&da.__exportStar||function(l,h){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(h,f)&&e(h,l,f)},r=da&&da.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.Spend=i.UnlockingScript=i.LockingScript=i.Script=i.OP=void 0;var t=Ef();Object.defineProperty(i,"OP",{enumerable:!0,get:function(){return r(t).default}});var s=Of();Object.defineProperty(i,"Script",{enumerable:!0,get:function(){return r(s).default}});var a=Af();Object.defineProperty(i,"LockingScript",{enumerable:!0,get:function(){return r(a).default}});var c=B0();Object.defineProperty(i,"UnlockingScript",{enumerable:!0,get:function(){return r(c).default}});var u=k6();Object.defineProperty(i,"Spend",{enumerable:!0,get:function(){return r(u).default}}),n(E6(),i)}(da)),da}var fa={},Bc={},sp={},MS;function O6(){if(MS)return sp;MS=1,Object.defineProperty(sp,"__esModule",{value:!0});let i=class{constructor(n){this.value=n}async computeFee(n){const r=a=>a>4294967296?9:a>65536?5:a>253?3:1;let t=4;t+=r(n.inputs.length);for(let a=0;a<n.inputs.length;a++){const c=n.inputs[a];t+=40;let u;if(typeof c.unlockingScript=="object")u=c.unlockingScript.toBinary().length;else if(typeof c.unlockingScriptTemplate=="object")u=await c.unlockingScriptTemplate.estimateLength(n,a);else throw new Error("All inputs must have an unlocking script or an unlocking script template for sat/kb fee computation.");t+=r(u),t+=u}t+=r(n.outputs.length);for(const a of n.outputs){t+=8;const c=a.lockingScript.toBinary().length;t+=r(c),t+=c}return t+=4,Math.ceil(t/1e3*this.value)}};return sp.default=i,sp}var js={},Dc={};function A6(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pl={},Rl={},BS;function P6(){if(BS)return Rl;BS=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.NodejsHttpClient=void 0;let i=class{constructor(n){this.https=n}async request(n,r){return await new Promise((t,s)=>{const a=this.https.request(n,r,c=>{let u="";c.on("data",l=>{u+=l}),c.on("end",()=>{const l=c.statusCode>=200&&c.statusCode<=299,h=c.headers["content-type"],f=u!==""&&typeof h=="string"&&h.startsWith("application/json")?JSON.parse(u):u;t({status:c.statusCode,statusText:c.statusMessage,ok:l,data:f})})});a.on("error",c=>{s(c)}),r.data!==null&&r.data!==void 0&&a.write(JSON.stringify(r.data)),a.end()})}};return Rl.NodejsHttpClient=i,Rl}var Nl={},DS;function R6(){if(DS)return Nl;DS=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.FetchHttpClient=void 0;let i=class{constructor(n){this.fetch=n}async request(n,r){var t;const s={method:r.method,headers:r.headers,body:JSON.stringify(r.data)},a=await this.fetch(n,s),c=a.headers.get("Content-Type"),u=(t=c==null?void 0:c.startsWith("application/json"))!==null&&t!==void 0&&t?await a.json():await a.text();return{ok:a.ok,status:a.status,statusText:a.statusText,data:u}}};return Nl.FetchHttpClient=i,Nl}var LS;function Pf(){if(LS)return Pl;LS=1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.defaultHttpClient=void 0;const i=P6(),e=R6();function n(){const r={async request(...t){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new e.FetchHttpClient(window.fetch.bind(window));if(typeof A6<"u")try{const t=Sw;return new i.NodejsHttpClient(t)}catch{return r}else return r}return Pl.defaultHttpClient=n,Pl}var FS;function N6(){if(FS)return Dc;FS=1;var i=Dc&&Dc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Dc,"__esModule",{value:!0});const e=Pf(),n=i(Ln()),r=Ze();function t(){return`ts-sdk-${(0,r.toHex)((0,n.default)(16))}`}class s{constructor(c,u){if(this.URL=c,typeof u=="string")this.apiKey=u,this.httpClient=(0,e.defaultHttpClient)(),this.deploymentId=t(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const l=u??{},{apiKey:h,deploymentId:f,httpClient:m,callbackToken:d,callbackUrl:y,headers:b}=l;this.apiKey=h,this.httpClient=m??(0,e.defaultHttpClient)(),this.deploymentId=f??t(),this.callbackToken=d,this.callbackUrl=y,this.headers=b}}requestHeaders(){const c={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(c.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(c["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(c["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const u in this.headers)c[u]=this.headers[u];return c}async broadcast(c){let u;try{u=c.toHexEF()}catch(h){if(h.message==="All inputs must have source transactions when serializing to EF format")u=c.toHex();else throw h}const l={method:"POST",headers:this.requestHeaders(),data:{rawTx:u}};try{const h=await this.httpClient.request(`${this.URL}/v1/tx`,l);if(h.ok){const{txid:f,extraInfo:m,txStatus:d,competingTxs:y}=h.data,b={status:"success",txid:f,message:`${d} ${m}`};return y!=null&&(b.competingTxs=y),b}else{const f=typeof h.status,m={status:"error",code:f==="number"||f==="string"?h.status.toString():"ERR_UNKNOWN",description:"Unknown error"};let d=h.data;if(typeof d=="string")try{d=JSON.parse(h.data)}catch{}return typeof d=="object"&&(d!==null&&(m.more=d),d!=null&&typeof d.txid=="string"&&(m.txid=d.txid),d!=null&&"detail"in d&&typeof d.detail=="string"&&(m.description=d.detail)),m}}catch(h){return{status:"error",code:"500",description:typeof h.message=="string"?h.message:"Internal Server Error"}}}async broadcastMany(c){const u=c.map(h=>{try{return{rawTx:h.toHexEF()}}catch(f){if(f.message==="All inputs must have source transactions when serializing to EF format")return{rawTx:h.toHex()};throw f}}),l={method:"POST",headers:this.requestHeaders(),data:u};try{return(await this.httpClient.request(`${this.URL}/v1/txs`,l)).data}catch(h){const f={status:"error",code:"500",description:typeof h.message=="string"?h.message:"Internal Server Error"};return c.map(()=>f)}}}return Dc.default=s,Dc}var US;function C6(){if(US)return js;US=1;var i=js&&js.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(js,"__esModule",{value:!0}),js.defaultBroadcaster=void 0;const e=i(N6());function n(r=!1,t={}){return new e.default(r?"https://arc-test.taal.com":"https://arc.taal.com",t)}return js.defaultBroadcaster=n,js}var Vs={},op={},HS;function M6(){if(HS)return op;HS=1,Object.defineProperty(op,"__esModule",{value:!0});const i=Pf();class e{constructor(r="main",t={}){const{apiKey:s,httpClient:a}=t;this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}`,this.httpClient=a??(0,i.defaultHttpClient)(),this.apiKey=s??""}async isValidRootForHeight(r,t){const s={method:"GET",headers:this.getHttpHeaders()},a=await this.httpClient.request(`${this.URL}/block/${t}/header`,s);if(a.ok){const{merkleroot:c}=a.data;return c===r}else{if(a.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${t} because of an error: ${JSON.stringify(a.data)} `)}}async currentHeight(){try{const r={method:"GET",headers:this.getHttpHeaders()},t=await this.httpClient.request(`${this.URL}/block/headers`,r);if(t.ok)return t.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(t.data)} `)}catch(r){throw new Error(`Failed to get current height because of an error: ${r instanceof Error?r.message:String(r)}`)}}getHttpHeaders(){const r={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(r.Authorization=this.apiKey),r}}return op.default=e,op}var qS;function B6(){if(qS)return Vs;qS=1;var i=Vs&&Vs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.defaultChainTracker=void 0;const e=i(M6());function n(){return new e.default}return Vs.defaultChainTracker=n,Vs}var Cl={},cp={},jS;function D6(){if(jS)return cp;jS=1,Object.defineProperty(cp,"__esModule",{value:!0});const i=Ze(),e=sn();let n=class Jd{static fromHex(t){return Jd.fromBinary((0,i.toArray)(t,"hex"))}static fromReader(t,s=!0){const a=t.readVarIntNum(),c=t.readUInt8(),u=Array(c).fill(null).map(()=>[]);let l,h,f;for(let m=0;m<c;m++){for(f=t.readVarIntNum();f>0;){h=t.readVarIntNum(),l=t.readUInt8();const d={offset:h};(l&1)!==0?d.duplicate=!0:((l&2)!==0&&(d.txid=!0),d.hash=(0,i.toHex)(t.read(32).reverse())),(!Array.isArray(u[m])||u[m].length===0)&&(u[m]=[]),u[m].push(d),f--}u[m].sort((d,y)=>d.offset-y.offset)}return new Jd(a,u,s)}static fromBinary(t){const s=new i.Reader(t);return Jd.fromReader(s)}static fromCoinbaseTxidAndHeight(t,s){return new Jd(s,[[{offset:0,hash:t,txid:!0}]])}constructor(t,s,a=!0){this.blockHeight=t,this.path=s;const c=Array(this.path.length).fill(0).map(()=>new Set);this.path.forEach((l,h)=>{if(l.length===0&&h===0)throw new Error(`Empty level at height: ${h}`);const f=new Set;l.forEach(m=>{if(f.has(m.offset))throw new Error(`Duplicate offset: ${m.offset}, at height: ${h}`);if(f.add(m.offset),h===0){if(m.duplicate!==!0)for(let d=1;d<this.path.length;d++)c[d].add(m.offset>>d^1)}else if(a&&!c[h].has(m.offset))throw new Error(`Invalid offset: ${m.offset}, at height: ${h}, with legal offsets: ${Array.from(c[h]).join(", ")}`)})});let u;this.path[0].forEach((l,h)=>{if(h===0&&(u=this.computeRoot(l.hash)),u!==this.computeRoot(l.hash))throw new Error("Mismatched roots")})}toBinary(){const t=new i.Writer;t.writeVarIntNum(this.blockHeight);const s=this.path.length;t.writeUInt8(s);for(let a=0;a<s;a++){const c=Object.keys(this.path[a]).length;t.writeVarIntNum(c);for(const u of this.path[a]){t.writeVarIntNum(u.offset);let l=0;(u==null?void 0:u.duplicate)===!0&&(l|=1),(u==null?void 0:u.txid)!==void 0&&u.txid!==null&&(l|=2),t.writeUInt8(l),(l&1)===0&&t.write((0,i.toArray)(u.hash,"hex").reverse())}}return t.toArray()}toHex(){return(0,i.toHex)(this.toBinary())}indexOf(t){const s=this.path[0].find(a=>a.hash===t);if(s==null)throw new Error(`Transaction ID ${t} not found in the Merkle Path`);return s.offset}computeRoot(t){var s,a;if(typeof t!="string"){const h=this.path[0].find(f=>!!(f!=null&&f.hash));if(h==null)throw new Error("No valid leaf found in the Merkle Path");t=h.hash}if(typeof t!="string")throw new Error("Transaction ID is undefined");const c=this.indexOf(t);if(typeof c!="number")throw new Error(`This proof does not contain the txid: ${t??"undefined"}`);const u=h=>(0,i.toHex)((0,e.hash256)((0,i.toArray)(h,"hex").reverse()).reverse());let l=t;if(this.path.length===1&&this.path[0].length===1)return l;for(let h=0;h<this.path.length;h++){this.path[h];const f=c>>h^1,m=this.findOrComputeLeaf(h,f);if(typeof m!="object")throw new Error(`Missing hash for index ${c} at height ${h}`);m.duplicate===!0?l=u((l??"")+(l??"")):f%2!==0?l=u(((s=m.hash)!==null&&s!==void 0?s:"")+(l??"")):l=u((l??"")+((a=m.hash)!==null&&a!==void 0?a:""))}return l}findOrComputeLeaf(t,s){var a,c;const u=b=>(0,i.toHex)((0,e.hash256)((0,i.toArray)(b,"hex").reverse()).reverse());let l=this.path[t].find(b=>b.offset===s);if(l!=null)return l;if(t===0)return;const h=t-1,f=s<<1,m=this.findOrComputeLeaf(h,f);if(m==null||m.hash==null||m.hash==="")return;const d=this.findOrComputeLeaf(h,f+1);if(d==null)return;let y;return d.duplicate===!0?y=u(m.hash+m.hash):y=u(((a=d.hash)!==null&&a!==void 0?a:"")+((c=m.hash)!==null&&c!==void 0?c:"")),l={offset:s,hash:y},l}async verify(t,s){const a=this.computeRoot(t);if(this.indexOf(t)===0){const c=await s.currentHeight();if(this.blockHeight+100<c)return!1}return await s.isValidRootForHeight(a,this.blockHeight)}combine(t){var s,a;if(this.blockHeight!==t.blockHeight)throw new Error("You cannot combine paths which do not have the same block height.");const c=this.computeRoot(),u=t.computeRoot();if(c!==u)throw new Error("You cannot combine paths which do not have the same root.");const l=[];for(let h=0;h<this.path.length;h++){l.push([]);for(let f=0;f<this.path[h].length;f++)l[h].push(this.path[h][f]);for(let f=0;f<t.path[h].length;f++)if(l[h].find(m=>m.offset===t.path[h][f].offset)===void 0)l[h].push(t.path[h][f]);else if(((s=t.path[h][f])===null||s===void 0?void 0:s.txid)!==void 0&&((a=t.path[h][f])===null||a===void 0?void 0:a.txid)!==null){const m=l[h].find(d=>d.offset===t.path[h][f].offset);m!=null&&(m.txid=!0)}}this.path=l,this.trim()}trim(){const t=(l,h)=>{(h.length===0||h.slice(-1)[0]!==l)&&h.push(l)},s=(l,h)=>{for(let f=l.length;f>=0;f--){const m=this.path[h].findIndex(d=>d.offset===l[f]);m>=0&&this.path[h].splice(m,1)}},a=l=>{const h=[];for(const f of l)t(f>>1,h);return h};let c=[],u=[];for(let l=0;l<this.path.length;l++)this.path[l].sort((h,f)=>h.offset-f.offset);for(let l=0;l<this.path[0].length;l++){const h=this.path[0][l];if(h.txid===!0)t(h.offset>>1,c);else{const f=h.offset%2===1,m=this.path[0][l+(f?-1:1)];(m.txid===void 0||m.txid===null||!m.txid)&&t(m.offset,u)}}s(u,0);for(let l=1;l<this.path.length;l++)u=c,c=a(c),s(u,l)}};return cp.default=n,cp}var Lc={},VS;function L6(){if(VS)return Lc;VS=1;var i=Lc&&Lc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Lc,"__esModule",{value:!0});const e=sn(),n=Ze(),r=i(Nf()),t=Rf();let s=class vo{get bumpIndex(){return this._bumpIndex}set bumpIndex(c){this._bumpIndex=c,this.updateInputTxids()}get hasProof(){return this._bumpIndex!==void 0}get isTxidOnly(){return this._txid!==void 0&&this._txid!==null&&this._rawTx==null&&this._tx==null}get txid(){if(this._txid!==void 0&&this._txid!==null&&this._txid!=="")return this._txid;if(this._tx!=null)return this._txid=this._tx.id("hex"),this._txid;if(this._rawTx!=null)return this._txid=(0,n.toHex)((0,e.hash256)(this._rawTx)),this._txid;throw new Error("Internal")}get tx(){if(this._tx!=null)return this._tx;if(this._rawTx!=null)return this._tx=r.default.fromBinary(this._rawTx),this._tx}get rawTx(){if(this._rawTx!=null)return this._rawTx;if(this._tx!=null)return this._rawTx=this._tx.toBinary(),this._rawTx}constructor(c,u){this.inputTxids=[],this.isValid=void 0,typeof c=="string"?this._txid=c:Array.isArray(c)?this._rawTx=c:this._tx=c,this.bumpIndex=u,this.updateInputTxids()}static fromTx(c,u){return new vo(c,u)}static fromRawTx(c,u){return new vo(c,u)}static fromTxid(c,u){return new vo(c,u)}updateInputTxids(){if(this.hasProof||this.tx==null)this.inputTxids=[];else{const c={};for(const u of this.tx.inputs)u.sourceTXID!==void 0&&u.sourceTXID!==null&&u.sourceTXID!==""&&(c[u.sourceTXID]=!0);this.inputTxids=Object.keys(c)}}toWriter(c,u){const l=d=>{c.writeUInt8(d)},h=()=>{if(this._txid==null)throw new Error("Transaction ID (_txid) is undefined");c.writeReverse((0,n.toArray)(this._txid,"hex"))},f=()=>{if(this._rawTx!=null)c.write(this._rawTx);else if(this._tx!=null)c.write(this._tx.toBinary());else throw new Error("a valid serialized Transaction is expected")},m=()=>{this.bumpIndex===void 0?l(t.TX_DATA_FORMAT.RAWTX):(l(t.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX),c.writeVarIntNum(this.bumpIndex))};u===t.BEEF_V2?this.isTxidOnly?(l(t.TX_DATA_FORMAT.TXID_ONLY),h()):this.bumpIndex!==void 0?(l(t.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX),c.writeVarIntNum(this.bumpIndex),f()):(l(t.TX_DATA_FORMAT.RAWTX),f()):(f(),m())}static fromReader(c,u){let l,h,f;if(u===t.BEEF_V2){const m=c.readUInt8();m===t.TX_DATA_FORMAT.TXID_ONLY?f=vo.fromTxid((0,n.toHex)(c.readReverse(32))):(m===t.TX_DATA_FORMAT.RAWTX_AND_BUMP_INDEX&&(h=c.readVarIntNum()),l=r.default.fromReader(c),f=vo.fromTx(l,h))}else l=r.default.fromReader(c),h=c.readUInt8()!==0?c.readVarIntNum():void 0,f=vo.fromTx(l,h);return f}};return Lc.default=s,Lc}var KS;function Rf(){return KS||(KS=1,function(i){var e=Cl&&Cl.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.Beef=i.TX_DATA_FORMAT=i.ATOMIC_BEEF=i.BEEF_V2=i.BEEF_V1=void 0;const n=e(D6()),r=e(L6()),t=Ze(),s=sn();function a(l){if(l==null)throw new Error("Expected a valid value, but got undefined.");return l}i.BEEF_V1=4022206465,i.BEEF_V2=4022206466,i.ATOMIC_BEEF=16843009;var c;(function(l){l[l.RAWTX=0]="RAWTX",l[l.RAWTX_AND_BUMP_INDEX=1]="RAWTX_AND_BUMP_INDEX",l[l.TXID_ONLY=2]="TXID_ONLY"})(c||(i.TX_DATA_FORMAT=c={}));let u=class nu{constructor(h=i.BEEF_V2){this.bumps=[],this.txs=[],this.version=i.BEEF_V2,this.atomicTxid=void 0,this.version=h}findTxid(h){return this.txs.find(f=>f.txid===h)}makeTxidOnly(h){const f=this.txs.findIndex(d=>d.txid===h);if(f===-1)return;let m=this.txs[f];return m.isTxidOnly||(this.txs.splice(f,1),m=this.mergeTxidOnly(h)),m}findBump(h){return this.bumps.find(f=>f.path[0].some(m=>m.hash===h))}findTransactionForSigning(h){const f=this.findTxid(h);if(!(f==null||f.tx==null)){for(const m of f.tx.inputs)if(m.sourceTransaction==null){const d=this.findTxid(a(m.sourceTXID));d!=null&&(m.sourceTransaction=d.tx)}return f.tx}}findAtomicTransaction(h){const f=this.findTxid(h);if(f==null||f.tx==null)return;const m=(d,y)=>{const b=d.findBump(y.id("hex"));if(b!=null)y.merklePath=b;else for(const g of y.inputs){if(g.sourceTransaction==null){const v=d.findTxid(a(g.sourceTXID));v!=null&&(g.sourceTransaction=v.tx)}if(g.sourceTransaction!=null){const v=d.findBump(g.sourceTransaction.id("hex"));v!=null?g.sourceTransaction.merklePath=v:m(d,g.sourceTransaction)}}};return m(this,f.tx),f.tx}mergeBump(h){let f;for(let d=0;d<this.bumps.length;d++){const y=this.bumps[d];if(y===h)return d;if(y.blockHeight===h.blockHeight){const b=y.computeRoot(),g=h.computeRoot();if(b===g){y.combine(h),f=d;break}}}f===void 0&&(f=this.bumps.length,this.bumps.push(h));const m=this.bumps[f];for(const d of this.txs){const y=d.txid;if(d.bumpIndex==null){for(const b of m.path[0])if(b.hash===y){d.bumpIndex=f,b.txid=!0;break}}}return f}mergeRawTx(h,f){const m=new r.default(h,f);return this.removeExistingTxid(m.txid),this.txs.push(m),this.tryToValidateBumpIndex(m),m}mergeTransaction(h){const f=h.id("hex");this.removeExistingTxid(f);let m;h.merklePath!=null&&(m=this.mergeBump(h.merklePath));const d=new r.default(h,m);if(this.txs.push(d),this.tryToValidateBumpIndex(d),m=d.bumpIndex,m===void 0)for(const y of h.inputs)y.sourceTransaction!=null&&this.mergeTransaction(y.sourceTransaction);return d}removeExistingTxid(h){const f=this.txs.findIndex(m=>m.txid===h);f>=0&&this.txs.splice(f,1)}mergeTxidOnly(h){let f=this.txs.find(m=>m.txid===h);return f==null&&(f=new r.default(h),this.txs.push(f),this.tryToValidateBumpIndex(f)),f}mergeBeefTx(h){let f=this.findTxid(h.txid);if(h.isTxidOnly&&f==null?f=this.mergeTxidOnly(h.txid):h._tx!=null&&(f==null||f.isTxidOnly)?f=this.mergeTransaction(h._tx):h._rawTx!=null&&(f==null||f.isTxidOnly)&&(f=this.mergeRawTx(h._rawTx)),f==null)throw new Error(`Failed to merge BeefTx for txid: ${h.txid}`);return f}mergeBeef(h){const f=Array.isArray(h)?nu.fromBinary(h):h;for(const m of f.bumps)this.mergeBump(m);for(const m of f.txs)this.mergeBeefTx(m)}isValid(h){return this.verifyValid(h).valid}async verify(h,f){const m=this.verifyValid(f);if(!m.valid)return!1;for(const d of Object.keys(m.roots))if(!await h.isValidRootForHeight(m.roots[d],Number(d)))return!1;return!0}verifyValid(h){const f={valid:!1,roots:{}},m=this.sortTxs();if(m.missingInputs.length>0||m.notValid.length>0||m.txidOnly.length>0&&h!==!0||m.withMissingInputs.length>0)return f;const d={};for(const b of this.txs)if(b.isTxidOnly){if(h!==!0)return f;d[b.txid]=!0}const y=(b,g)=>{const v=b.computeRoot(g);return(f.roots[b.blockHeight]===void 0||f.roots[b.blockHeight]==="")&&(f.roots[b.blockHeight]=v),f.roots[b.blockHeight]===v};for(const b of this.bumps)for(const g of b.path[0])if(g.txid===!0&&typeof g.hash=="string"&&g.hash.length>0&&(d[g.hash]=!0,!y(b,g.hash)))return f;for(const b of this.txs)if(b.bumpIndex!==void 0&&this.bumps[b.bumpIndex].path[0].find(v=>v.hash===b.txid)==null)return f;for(const b of this.txs){for(const g of b.inputTxids)if(!d[g])return f;d[b.txid]=!0}return f.valid=!0,f}toWriter(h){h.writeUInt32LE(this.version),h.writeVarIntNum(this.bumps.length);for(const f of this.bumps)h.write(f.toBinary());h.writeVarIntNum(this.txs.length);for(const f of this.txs)f.toWriter(h,this.version)}toBinary(){this.sortTxs();const h=new t.Writer;return this.toWriter(h),h.toArray()}toBinaryAtomic(h){this.sortTxs();const f=this.findTxid(h);if(f==null)throw new Error(`${h} does not exist in this Beef`);const m=this.txs[this.txs.length-1]===f?this:this.clone();if(m!==this){const y=this.txs.findIndex(b=>b.txid===h);m.txs.splice(y+1)}const d=new t.Writer;return d.writeUInt32LE(i.ATOMIC_BEEF),d.writeReverse((0,t.toArray)(h,"hex")),m.toWriter(d),d.toArray()}toHex(){return(0,t.toHex)(this.toBinary())}static fromReader(h){let f=h.readUInt32LE(),m;if(f===i.ATOMIC_BEEF&&(m=(0,t.toHex)(h.readReverse(32)),f=h.readUInt32LE()),f!==i.BEEF_V1&&f!==i.BEEF_V2)throw new Error(`Serialized BEEF must start with ${i.BEEF_V1} or ${i.BEEF_V2} but starts with ${f}`);const d=new nu(f),y=h.readVarIntNum();for(let g=0;g<y;g++){const v=n.default.fromReader(h,!1);d.bumps.push(v)}const b=h.readVarIntNum();for(let g=0;g<b;g++){const v=r.default.fromReader(h,f);d.txs.push(v)}return d.atomicTxid=m,d}static fromBinary(h){const f=new t.Reader(h);return nu.fromReader(f)}static fromString(h,f="hex"){const m=(0,t.toArray)(h,f),d=new t.Reader(m);return nu.fromReader(d)}tryToValidateBumpIndex(h){if(h.bumpIndex!==void 0)return!0;const f=h.txid;for(let m=0;m<this.bumps.length;m++){const d=this.bumps[m].path[0].findIndex(y=>y.hash===f);if(d>=0)return h.bumpIndex=m,this.bumps[m].path[0][d].txid=!0,!0}return!1}sortTxs(){const h={},f={};let m=[];const d=[],y=[];for(const S of this.txs)f[S.txid]=S,S.isValid=S.hasProof,S.isValid?(h[S.txid]=!0,d.push(S)):S.isTxidOnly&&S.inputTxids.length===0?(h[S.txid]=!0,y.push(S)):m.push(S);const b={},g=[],v=m;m=[];for(const S of v){let I=!1;for(const A of S.inputTxids)f[A]===void 0&&(b[A]=!0,I=!0);I?g.push(S):m.push(S)}for(;m.length>0;){const S=m;m=[];for(const I of S)I.inputTxids.every(A=>h[A])?(h[I.txid]=!0,d.push(I)):m.push(I);if(S.length===m.length)break}const _=m;return this.txs=g.concat(_).concat(y).concat(d),{missingInputs:Object.keys(b),notValid:_.map(S=>S.txid),valid:Object.keys(h),withMissingInputs:g.map(S=>S.txid),txidOnly:y.map(S=>S.txid)}}clone(){const h=new nu;return h.version=this.version,h.bumps=Array.from(this.bumps),h.txs=Array.from(this.txs),h}trimKnownTxids(h){for(let f=0;f<this.txs.length;){const m=this.txs[f];m.isTxidOnly&&h.includes(m.txid)?this.txs.splice(f,1):f++}}getValidTxids(){return this.sortTxs().valid}toLogString(){var h,f;let m="";m+=`BEEF with ${this.bumps.length} BUMPS and ${this.txs.length} Transactions, isValid ${this.isValid().toString()}
`;let d=-1;for(const y of this.bumps)d++,m+=`  BUMP ${d}
    block: ${y.blockHeight}
    txids: [
${y.path[0].filter(b=>b.txid===!0).map(b=>{var g;return`      '${(g=b.hash)!==null&&g!==void 0?g:""}'`}).join(`,
`)}
    ]
`;d=-1;for(const y of this.txs)d++,m+=`  TX ${d}
    txid: ${y.txid}
`,y.bumpIndex!==void 0&&(m+=`    bumpIndex: ${y.bumpIndex}
`),y.isTxidOnly?m+=`    txidOnly
`:m+=`    rawTx length=${(f=(h=y.rawTx)===null||h===void 0?void 0:h.length)!==null&&f!==void 0?f:0}
`,y.inputTxids.length>0&&(m+=`    inputs: [
${y.inputTxids.map(b=>`      '${b}'`).join(`,
`)}
    ]
`);return m}addComputedLeaves(){const h=f=>(0,t.toHex)((0,s.hash256)((0,t.toArray)(f,"hex").reverse()).reverse());for(const f of this.bumps)for(let m=1;m<f.path.length;m++)for(const d of f.path[m-1])if(typeof d.hash=="string"&&(d.offset&1)===0){const y=f.path[m-1].find(g=>g.offset===d.offset+1),b=d.offset>>1;y!==void 0&&typeof y.hash=="string"&&f.path[m].every(g=>g.offset!==b)&&f.path[m].push({offset:b,hash:h(y.hash+d.hash)})}}};i.Beef=u}(Cl)),Cl}var WS;function Nf(){if(WS)return Bc;WS=1;var i=Bc&&Bc.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(Bc,"__esModule",{value:!0});const e=i(B0()),n=i(Af()),r=Ze(),t=sn(),s=i(O6()),a=i(k6()),c=C6(),u=B6(),l=Rf(),h=i(Iw());let f=class dr{static addPathOrInputs(d,y,b){var g;if(typeof d.pathIndex=="number"){const v=b[d.pathIndex];if(typeof v!="object")throw new Error("Invalid merkle path index found in BEEF!");d.tx.merklePath=v}else for(const v of d.tx.inputs){if(v.sourceTXID===void 0)throw new Error("Input sourceTXID is undefined");const _=y[v.sourceTXID];if(typeof _!="object")throw new Error(`Reference to unknown TXID in BEEF: ${(g=v.sourceTXID)!==null&&g!==void 0?g:"undefined"}`);v.sourceTransaction=_.tx,this.addPathOrInputs(_,y,b)}}static fromBEEF(d,y){const{tx:b}=dr.fromAnyBeef(d,y);return b}static fromAtomicBEEF(d){const{tx:y,txid:b,beef:g}=dr.fromAnyBeef(d);if(b!==g.atomicTxid)throw g.atomicTxid?new Error(`Transaction with TXID ${g.atomicTxid} not found in BEEF data.`):new Error("beef must conform to BRC-95 and must contain the subject txid.");return y}static fromAnyBeef(d,y){const b=l.Beef.fromBinary(d);if(b.txs.length<1)throw new Error("beef must include at least one transaction.");const g=y||b.atomicTxid||b.txs.slice(-1)[0].txid,v=b.findAtomicTransaction(g);if(v==null)throw y?new Error(`Transaction with TXID ${g} not found in BEEF data.`):new Error("beef does not contain transaction for atomic txid.");return{tx:v,beef:b,txid:g}}static fromEF(d){const y=new r.Reader(d),b=y.readUInt32LE();if((0,r.toHex)(y.read(6))!=="0000000000ef")throw new Error("Invalid EF marker");const g=y.readVarIntNum(),v=[];for(let A=0;A<g;A++){const R=(0,r.toHex)(y.readReverse(32)),E=y.readUInt32LE(),k=y.readVarIntNum(),P=y.read(k),T=e.default.fromBinary(P),M=y.readUInt32LE(),C=y.readUInt64LEBn().toNumber(),D=y.readVarIntNum(),F=y.read(D),B=n.default.fromBinary(F),L=new dr(void 0,[],[],void 0);L.outputs=Array(E+1).fill(null),L.outputs[E]={satoshis:C,lockingScript:B},v.push({sourceTransaction:L,sourceTXID:R,sourceOutputIndex:E,unlockingScript:T,sequence:M})}const _=y.readVarIntNum(),S=[];for(let A=0;A<_;A++){const R=y.readUInt64LEBn().toNumber(),E=y.readVarIntNum(),k=y.read(E),P=n.default.fromBinary(k);S.push({satoshis:R,lockingScript:P})}const I=y.readUInt32LE();return new dr(b,v,S,I)}static parseScriptOffsets(d){const y=new r.Reader(d),b=[],g=[];y.pos+=4;const v=y.readVarIntNum();for(let S=0;S<v;S++){y.pos+=36;const I=y.readVarIntNum();b.push({vin:S,offset:y.pos,length:I}),y.pos+=I+4}const _=y.readVarIntNum();for(let S=0;S<_;S++){y.pos+=8;const I=y.readVarIntNum();g.push({vout:S,offset:y.pos,length:I}),y.pos+=I}return{inputs:b,outputs:g}}static fromReader(d){const y=d.readUInt32LE(),b=d.readVarIntNum(),g=[];for(let I=0;I<b;I++){const A=(0,r.toHex)(d.readReverse(32)),R=d.readUInt32LE(),E=d.readVarIntNum(),k=d.read(E),P=e.default.fromBinary(k),T=d.readUInt32LE();g.push({sourceTXID:A,sourceOutputIndex:R,unlockingScript:P,sequence:T})}const v=d.readVarIntNum(),_=[];for(let I=0;I<v;I++){const A=d.readUInt64LEBn().toNumber(),R=d.readVarIntNum(),E=d.read(R),k=n.default.fromBinary(E);_.push({satoshis:A,lockingScript:k})}const S=d.readUInt32LE();return new dr(y,g,_,S)}static fromBinary(d){const y=new r.Reader(d);return dr.fromReader(y)}static fromHex(d){return dr.fromBinary((0,r.toArray)(d,"hex"))}static fromHexEF(d){return dr.fromEF((0,r.toArray)(d,"hex"))}static fromHexBEEF(d,y){return dr.fromBEEF((0,r.toArray)(d,"hex"),y)}constructor(d=1,y=[],b=[],g=0,v=new Map,_){this.version=d,this.inputs=y,this.outputs=b,this.lockTime=g,this.metadata=v,this.merklePath=_}addInput(d){if(typeof d.sourceTXID>"u"&&typeof d.sourceTransaction>"u")throw new Error("A reference to an an input transaction is required. If the input transaction itself cannot be referenced, its TXID must still be provided.");typeof d.sequence>"u"&&(d.sequence=4294967295),this.cachedHash=void 0,this.inputs.push(d)}addOutput(d){if(this.cachedHash=void 0,d.change!==!0){if(typeof d.satoshis>"u")throw new Error("either satoshis must be defined or change must be set to true");if(d.satoshis<0)throw new Error("satoshis must be a positive integer or zero")}if(d.lockingScript==null)throw new Error("lockingScript must be defined");this.outputs.push(d)}addP2PKHOutput(d,y){const b=new h.default().lock(d);if(typeof y>"u")return this.addOutput({lockingScript:b,change:!0});this.addOutput({lockingScript:b,satoshis:y})}updateMetadata(d){this.metadata={...this.metadata,...d}}async fee(d=new s.default(1),y="equal"){if(this.cachedHash=void 0,typeof d=="number"){const v=d;d={computeFee:async()=>v}}const b=await d.computeFee(this),g=this.calculateChange(b);if(g<=0){this.outputs=this.outputs.filter(v=>v.change!==!0);return}this.distributeChange(g,y)}calculateChange(d){var y;let b=0;for(const g of this.inputs){if(typeof g.sourceTransaction!="object")throw new Error("Source transactions are required for all inputs during fee computation");b+=(y=g.sourceTransaction.outputs[g.sourceOutputIndex].satoshis)!==null&&y!==void 0?y:0}b-=d;for(const g of this.outputs)g.change!==!0&&g.satoshis!==void 0&&(b-=g.satoshis);return b}distributeChange(d,y){let b=0;const g=this.outputs.filter(v=>v.change);if(y==="random"?b=this.distributeRandomChange(d,g):y==="equal"&&(b=this.distributeEqualChange(d,g)),b<d){const v=this.outputs[this.outputs.length-1];v.satoshis!==void 0?v.satoshis+=d-b:v.satoshis=d-b}}distributeRandomChange(d,y){let b=0,g=d;const v=Array(y.length).fill(1);g-=y.length,b+=y.length;for(let _=0;_<y.length-1;_++){const S=this.benfordNumber(0,g);v[_]=v[_]+S,b+=S,g-=S}for(const _ of this.outputs)_.change===!0&&(_.satoshis=v.shift());return b}distributeEqualChange(d,y){let b=0;const g=Math.floor(d/y.length);for(const v of y)b+=g,v.satoshis=g;return b}benfordNumber(d,y){const b=Math.floor(Math.random()*9)+1;return Math.floor(d+(y-d)*Math.log10(1+1/b)/Math.log10(10))}getFee(){var d,y;let b=0;for(const v of this.inputs){if(typeof v.sourceTransaction!="object")throw new Error("Source transactions or sourceSatoshis are required for all inputs to calculate fee");b+=(d=v.sourceTransaction.outputs[v.sourceOutputIndex].satoshis)!==null&&d!==void 0?d:0}let g=0;for(const v of this.outputs)g+=(y=v.satoshis)!==null&&y!==void 0?y:0;return b-g}async sign(){this.cachedHash=void 0;for(const y of this.outputs)if(typeof y.satoshis>"u")throw y.change===!0?new Error("There are still change outputs with uncomputed amounts. Use the fee() method to compute the change amounts and transaction fees prior to signing."):new Error("One or more transaction outputs is missing an amount. Ensure all output amounts are provided before signing.");const d=await Promise.all(this.inputs.map(async(y,b)=>{var g,v;return typeof this.inputs[b].unlockingScriptTemplate=="object"?await((v=(g=this.inputs[b])===null||g===void 0?void 0:g.unlockingScriptTemplate)===null||v===void 0?void 0:v.sign(this,b)):await Promise.resolve(void 0)}));for(let y=0,b=this.inputs.length;y<b;y++)typeof this.inputs[y].unlockingScriptTemplate=="object"&&(this.inputs[y].unlockingScript=d[y])}async broadcast(d=(0,c.defaultBroadcaster)()){return await d.broadcast(this)}toBinary(){var d,y;const b=new r.Writer;b.writeUInt32LE(this.version),b.writeVarIntNum(this.inputs.length);for(const g of this.inputs){if(typeof g.sourceTXID>"u")if(g.sourceTransaction!=null)b.write(g.sourceTransaction.hash());else throw new Error("sourceTransaction is undefined");else b.writeReverse((0,r.toArray)(g.sourceTXID,"hex"));if(b.writeUInt32LE(g.sourceOutputIndex),g.unlockingScript==null)throw new Error("unlockingScript is undefined");const v=g.unlockingScript.toBinary();b.writeVarIntNum(v.length),b.write(v),b.writeUInt32LE((d=g.sequence)!==null&&d!==void 0?d:0)}b.writeVarIntNum(this.outputs.length);for(const g of this.outputs){b.writeUInt64LE((y=g.satoshis)!==null&&y!==void 0?y:0);const v=g.lockingScript.toBinary();b.writeVarIntNum(v.length),b.write(v)}return b.writeUInt32LE(this.lockTime),b.toArray()}toEF(){var d,y,b;const g=new r.Writer;g.writeUInt32LE(this.version),g.write([0,0,0,0,0,239]),g.writeVarIntNum(this.inputs.length);for(const v of this.inputs){if(typeof v.sourceTransaction>"u")throw new Error("All inputs must have source transactions when serializing to EF format");if(typeof v.sourceTXID>"u"?g.write(v.sourceTransaction.hash()):g.write((0,r.toArray)(v.sourceTXID,"hex").reverse()),g.writeUInt32LE(v.sourceOutputIndex),v.unlockingScript==null)throw new Error("unlockingScript is undefined");const _=v.unlockingScript.toBinary();g.writeVarIntNum(_.length),g.write(_),g.writeUInt32LE((d=v.sequence)!==null&&d!==void 0?d:0),g.writeUInt64LE((y=v.sourceTransaction.outputs[v.sourceOutputIndex].satoshis)!==null&&y!==void 0?y:0);const S=v.sourceTransaction.outputs[v.sourceOutputIndex].lockingScript.toBinary();g.writeVarIntNum(S.length),g.write(S)}g.writeVarIntNum(this.outputs.length);for(const v of this.outputs){g.writeUInt64LE((b=v.satoshis)!==null&&b!==void 0?b:0);const _=v.lockingScript.toBinary();g.writeVarIntNum(_.length),g.write(_)}return g.writeUInt32LE(this.lockTime),g.toArray()}toHexEF(){return(0,r.toHex)(this.toEF())}toHex(){return(0,r.toHex)(this.toBinary())}toHexBEEF(){return(0,r.toHex)(this.toBEEF())}toHexAtomicBEEF(){return(0,r.toHex)(this.toAtomicBEEF())}hash(d){let y;return this.cachedHash!=null?y=this.cachedHash:(y=(0,t.hash256)(this.toBinary()),this.cachedHash=y),d==="hex"?(0,r.toHex)(y):y}id(d){const y=[...this.hash()];return y.reverse(),d==="hex"?(0,r.toHex)(y):y}async verify(d=(0,u.defaultChainTracker)(),y,b){var g,v,_,S;const I=new Set,A=[this];for(;A.length>0;){const R=A.shift(),E=(g=R==null?void 0:R.id("hex"))!==null&&g!==void 0?g:"";if(E!=null&&E!==""&&I.has(E))continue;if(typeof(R==null?void 0:R.merklePath)=="object"){if(d==="scripts only"){E!=null&&I.add(E);continue}else if(await R.merklePath.verify(E,d)){I.add(E);continue}}if(typeof y<"u"){if(R===void 0)throw new Error("Transaction is undefined");const T=dr.fromEF(R.toEF());if(delete T.outputs[0].satoshis,T.outputs[0].change=!0,await T.fee(y),R.getFee()<T.getFee())throw new Error(`Verification failed because the transaction ${E} has an insufficient fee and has not been mined.`)}let k=0;if(R===void 0)throw new Error("Transaction is undefined");for(let T=0;T<R.inputs.length;T++){const M=R.inputs[T];if(typeof M.sourceTransaction!="object")throw new Error(`Verification failed because the input at index ${T} of transaction ${E} is missing an associated source transaction. This source transaction is required for transaction verification because there is no merkle proof for the transaction spending a UTXO it contains.`);if(typeof M.unlockingScript!="object")throw new Error(`Verification failed because the input at index ${T} of transaction ${E} is missing an associated unlocking script. This script is required for transaction verification because there is no merkle proof for the transaction spending the UTXO.`);const C=M.sourceTransaction.outputs[M.sourceOutputIndex];k+=(v=C.satoshis)!==null&&v!==void 0?v:0;const D=M.sourceTransaction.id("hex");I.has(D)||A.push(M.sourceTransaction);const F=R.inputs.filter((q,K)=>K!==T);if(typeof M.sourceTXID>"u"&&(M.sourceTXID=D),!new a.default({sourceTXID:M.sourceTXID,sourceOutputIndex:M.sourceOutputIndex,lockingScript:C.lockingScript,sourceSatoshis:(_=C.satoshis)!==null&&_!==void 0?_:0,transactionVersion:R.version,otherInputs:F,unlockingScript:M.unlockingScript,inputSequence:(S=M.sequence)!==null&&S!==void 0?S:0,inputIndex:T,outputs:R.outputs,lockTime:R.lockTime,memoryLimit:b}).validate())return!1}let P=0;for(const T of R.outputs){if(typeof T.satoshis!="number")throw new Error("Every output must have a defined amount during transaction verification.");P+=T.satoshis}if(P>k)return!1;I.add(E)}return!0}toBEEF(d){const y=new r.Writer;y.writeUInt32LE(l.BEEF_V1);const b=[],g=[],v=_=>{const S={tx:_},I=typeof _.merklePath=="object";if(I){let R=!1;for(let E=0;E<b.length;E++){if(b[E]===_.merklePath){S.pathIndex=E,R=!0;break}if(_.merklePath!==null&&_.merklePath!==void 0&&b[E].blockHeight===_.merklePath.blockHeight){const k=b[E].computeRoot(),P=_.merklePath.computeRoot();if(k===P){b[E].combine(_.merklePath),S.pathIndex=E,R=!0;break}}}R||(S.pathIndex=b.length,_.merklePath!==null&&_.merklePath!==void 0&&b.push(_.merklePath))}if(g.some(R=>R.tx.id("hex")===_.id("hex"))||g.unshift(S),!I)for(let R=0;R<_.inputs.length;R++){const E=_.inputs[R];if(typeof E.sourceTransaction=="object")v(E.sourceTransaction);else if(d===!1)throw new Error("A required source transaction is missing!")}};v(this),y.writeVarIntNum(b.length);for(const _ of b)y.write(_.toBinary());y.writeVarIntNum(g.length);for(const _ of g)y.write(_.tx.toBinary()),typeof _.pathIndex=="number"?(y.writeUInt8(1),y.writeVarIntNum(_.pathIndex)):y.writeUInt8(0);return y.toArray()}toAtomicBEEF(d){const y=new r.Writer;y.writeUInt32LE(16843009),y.write(this.hash());const b=this.toBEEF(d);return y.write(b),y.toArray()}};return Bc.default=f,Bc}var Ks={},$S;function gB(){if($S)return Ks;$S=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.isBroadcastFailure=Ks.isBroadcastResponse=void 0;function i(n){return n.status==="success"}Ks.isBroadcastResponse=i;function e(n){return n.status==="error"}return Ks.isBroadcastFailure=e,Ks}var Fc={},zS;function bB(){if(zS)return Fc;zS=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.BeefParty=void 0;const i=Rf();let e=class extends i.Beef{constructor(r){if(super(),this.knownTo={},r!=null)for(const t of r)this.addParty(t)}isParty(r){return Object.keys(this.knownTo).includes(r)}addParty(r){if(this.isParty(r))throw new Error(`Party ${r} already exists.`);this.knownTo[r]={}}getKnownTxidsForParty(r){const t=this.knownTo[r];if(t===void 0)throw new Error(`Party ${r} is unknown.`);return Object.keys(t)}getTrimmedBeefForParty(r){const t=this.getKnownTxidsForParty(r),s=this.clone();return s.trimKnownTxids(t),s}addKnownTxidsForParty(r,t){this.isParty(r)||this.addParty(r);const s=this.knownTo[r];for(const a of t)s[a]=!0,this.mergeTxidOnly(a)}mergeBeefFromParty(r,t){const s=Array.isArray(t)?i.Beef.fromBinary(t):t,a=s.getValidTxids();this.mergeBeef(s),this.addKnownTxidsForParty(r,a)}};return Fc.BeefParty=e,Fc.default=e,Fc}var GS;function Cf(){return GS||(GS=1,function(i){var e=fa&&fa.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),n=fa&&fa.__exportStar||function(l,h){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(h,f)&&e(h,l,f)},r=fa&&fa.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.BeefParty=i.BeefTx=i.isBroadcastFailure=i.isBroadcastResponse=i.MerklePath=i.Transaction=void 0;var t=Nf();Object.defineProperty(i,"Transaction",{enumerable:!0,get:function(){return r(t).default}});var s=D6();Object.defineProperty(i,"MerklePath",{enumerable:!0,get:function(){return r(s).default}});var a=gB();Object.defineProperty(i,"isBroadcastResponse",{enumerable:!0,get:function(){return a.isBroadcastResponse}}),Object.defineProperty(i,"isBroadcastFailure",{enumerable:!0,get:function(){return a.isBroadcastFailure}});var c=L6();Object.defineProperty(i,"BeefTx",{enumerable:!0,get:function(){return r(c).default}}),n(Rf(),i);var u=bB();Object.defineProperty(i,"BeefParty",{enumerable:!0,get:function(){return r(u).default}})}(fa)),fa}var Ml={},XS;function mB(){return XS||(XS=1,function(i){var e=Ml&&Ml.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(i,"__esModule",{value:!0}),i.SatoshisPerKilobyte=void 0;var n=O6();Object.defineProperty(i,"SatoshisPerKilobyte",{enumerable:!0,get:function(){return e(n).default}})}(Ml)),Ml}var Bl={},up={},YS;function wB(){if(YS)return up;YS=1,Object.defineProperty(up,"__esModule",{value:!0});const i=Pf();let e=class{constructor(r="main",t=(0,i.defaultHttpClient)()){this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}/tx/raw`,this.httpClient=t}async broadcast(r){var t,s;const a=r.toHex(),c={method:"POST",headers:{"Content-Type":"application/json",Accept:"text/plain"},data:{txhex:a}};try{const u=await this.httpClient.request(this.URL,c);return u.ok?{status:"success",txid:u.data,message:"broadcast successful"}:{status:"error",code:(t=u.status.toString())!==null&&t!==void 0?t:"ERR_UNKNOWN",description:(s=u.data)!==null&&s!==void 0?s:"Unknown error"}}catch(u){return{status:"error",code:"500",description:typeof u.message=="string"?u.message:"Internal Server Error"}}}};return up.default=e,up}var lp={},_b={},ha={},QS;function vB(){if(QS)return ha;QS=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.binaryHttpClient=ha.BinaryFetchClient=ha.BinaryNodejsHttpClient=void 0;class i{constructor(t){this.https=t}async request(t,s){return await new Promise((a,c)=>{const u=this.https.request(t,s,l=>{let h="";l.on("data",f=>{h+=f}),l.on("end",()=>{const f=l.statusCode>=200&&l.statusCode<=299,m=l.headers["content-type"],d=h!==""&&typeof m=="string"&&m.startsWith("application/json")?JSON.parse(h):h;a({status:l.statusCode,statusText:l.statusMessage,ok:f,data:d})})});u.on("error",l=>{c(l)}),s.data!==null&&s.data!==void 0&&u.write(Buffer.from(s.data)),u.end()})}}ha.BinaryNodejsHttpClient=i;let e=class{constructor(t){this.fetch=t}async request(t,s){const a={method:s.method,headers:s.headers,body:s.data},c=await this.fetch(t,a),u=await c.text();return{ok:c.ok,status:c.status,statusText:c.statusText,data:u}}};ha.BinaryFetchClient=e;function n(){const r={async request(...t){throw new Error("No method available to perform HTTP request")}};if(typeof window<"u"&&typeof window.fetch=="function")return new e(window.fetch.bind(window));if(typeof A6<"u")try{const t=Sw;return new i(t)}catch{return r}else return r}return ha.binaryHttpClient=n,ha}var ZS;function F6(){return ZS||(ZS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.FetchHttpClient=i.NodejsHttpClient=i.binaryHttpClient=i.defaultHttpClient=void 0;var e=Pf();Object.defineProperty(i,"defaultHttpClient",{enumerable:!0,get:function(){return e.defaultHttpClient}});var n=vB();Object.defineProperty(i,"binaryHttpClient",{enumerable:!0,get:function(){return n.binaryHttpClient}});var r=P6();Object.defineProperty(i,"NodejsHttpClient",{enumerable:!0,get:function(){return r.NodejsHttpClient}});var t=R6();Object.defineProperty(i,"FetchHttpClient",{enumerable:!0,get:function(){return t.FetchHttpClient}})}(_b)),_b}var JS;function xB(){if(JS)return lp;JS=1,Object.defineProperty(lp,"__esModule",{value:!0});const i=F6();let e=class{constructor(r,t=(0,i.binaryHttpClient)()){this.URL=r,this.httpClient=t}async broadcast(r){var t,s;const a=r.toEF(),c={method:"POST",headers:{"Content-Type":"application/octet-stream"},data:new Blob([new Uint8Array(a)])};try{const u=await this.httpClient.request(this.URL,c);return u.ok?{status:"success",txid:r.id("hex"),message:"broadcast successful"}:{status:"error",code:(t=u.status.toString())!==null&&t!==void 0?t:"ERR_UNKNOWN",description:(s=u.data)!==null&&s!==void 0?s:"Unknown error"}}catch(u){return{status:"error",code:"500",description:typeof u.message=="string"?u.message:"Internal Server Error"}}}};return lp.default=e,lp}var eI;function _B(){return eI||(eI=1,function(i){var e=Bl&&Bl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(i,"__esModule",{value:!0}),i.defaultBroadcaster=i.Teranode=i.WhatsOnChainBroadcaster=i.ARC=void 0;var n=N6();Object.defineProperty(i,"ARC",{enumerable:!0,get:function(){return e(n).default}});var r=wB();Object.defineProperty(i,"WhatsOnChainBroadcaster",{enumerable:!0,get:function(){return e(r).default}});var t=xB();Object.defineProperty(i,"Teranode",{enumerable:!0,get:function(){return e(t).default}});var s=C6();Object.defineProperty(i,"defaultBroadcaster",{enumerable:!0,get:function(){return s.defaultBroadcaster}})}(Bl)),Bl}var Dl={},Ll={},tI;function SB(){if(tI)return Ll;tI=1,Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.BlockHeadersService=void 0;const i=Pf();let e=class{constructor(r,t={}){const{httpClient:s,apiKey:a}=t;this.baseUrl=r,this.httpClient=s??(0,i.defaultHttpClient)(),this.apiKey=a??""}async isValidRootForHeight(r,t){const s={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.apiKey}`},data:[{blockHeight:t,merkleRoot:r}]};try{const a=await this.httpClient.request(`${this.baseUrl}/api/v1/chain/merkleroot/verify`,s);if(a.ok)return a.data.confirmationState==="CONFIRMED";throw new Error(`Failed to verify merkleroot for height ${t} because of an error: ${JSON.stringify(a.data)}`)}catch(a){throw new Error(`Failed to verify merkleroot for height ${t} because of an error: ${a instanceof Error?a.message:String(a)}`)}}async currentHeight(){const r={method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${this.apiKey}`}};try{const t=await this.httpClient.request(`${this.baseUrl}/api/v1/chain/tip/longest`,r);if(t.ok&&t.data&&typeof t.data.height=="number")return t.data.height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(t.data)}`)}catch(t){throw new Error(`Failed to get current height because of an error: ${t instanceof Error?t.message:String(t)}`)}}};return Ll.BlockHeadersService=e,Ll}var nI;function IB(){return nI||(nI=1,function(i){var e=Dl&&Dl.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i,"__esModule",{value:!0}),i.defaultChainTracker=i.BlockHeadersService=i.WhatsOnChain=void 0;var n=M6();Object.defineProperty(i,"WhatsOnChain",{enumerable:!0,get:function(){return e(n).default}});var r=SB();Object.defineProperty(i,"BlockHeadersService",{enumerable:!0,get:function(){return r.BlockHeadersService}});var t=B6();Object.defineProperty(i,"defaultChainTracker",{enumerable:!0,get:function(){return t.defaultChainTracker}})}(Dl)),Dl}var oi={},pa={},iI;function TB(){if(iI)return pa;iI=1;var i=pa&&pa.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(pa,"__esModule",{value:!0}),pa.verify=pa.sign=void 0;const e=i(Ca()),n=i(Iu()),r=i(_u()),t=i(qr()),s=i(Ln()),a=Ze(),c="42423301",u=(h,f,m)=>{const d=typeof m!="object";if(d){const A=new t.default,R=new n.default(1),E=A.g.mul(R);m=new e.default(E.x,E.y)}const y=(0,s.default)(32),g=`2-message signing-${(0,a.toBase64)(y)}`,_=f.deriveChild(m,g).sign(h).toDER(),S=f.toPublicKey().encode(!0);return[...(0,a.toArray)(c,"hex"),...S,...d?[0]:m.encode(!0),...y,..._]};pa.sign=u;const l=(h,f,m)=>{const d=new a.Reader(f),y=(0,a.toHex)(d.read(4));if(y!==c)throw new Error(`Message version mismatch: Expected ${c}, received ${y}`);const b=e.default.fromString((0,a.toHex)(d.read(33))),[g]=d.read(1);if(g===0)m=new n.default(1);else{const E=d.read(32),k=(0,a.toHex)([g,...E]);if(typeof m!="object")throw new Error(`This signature can only be verified with knowledge of a specific private key. The associated public key is: ${k}`);const P=m.toPublicKey().encode(!0,"hex");if(k!==P)throw new Error(`The recipient public key is ${P} but the signature requres the recipient to have public key ${k}`)}const v=(0,a.toBase64)(d.read(32)),_=(0,a.toHex)(d.read(d.bin.length-d.pos)),S=r.default.fromDER(_,"hex"),I=`2-message signing-${v}`;return b.deriveChild(m,I).verify(h,S)};return pa.verify=l,pa}var ya={},rI;function kB(){if(rI)return ya;rI=1;var i=ya&&ya.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ya,"__esModule",{value:!0}),ya.decrypt=ya.encrypt=void 0;const e=i(Ca()),n=i(C0()),r=i(Ln()),t=Ze(),s="42421033",a=(u,l,h)=>{const f=(0,r.default)(32),d=`2-message encryption-${(0,t.toBase64)(f)}`,y=l.deriveChild(h,d),b=h.deriveChild(l,d),g=y.deriveSharedSecret(b),_=new n.default(g.encode(!0).slice(1)).encrypt(u),S=l.toPublicKey().encode(!0);return[...(0,t.toArray)(s,"hex"),...S,...h.encode(!0),...f,..._]};ya.encrypt=a;const c=(u,l)=>{const h=new t.Reader(u),f=(0,t.toHex)(h.read(4));if(f!==s)throw new Error(`Message version mismatch: Expected ${s}, received ${f}`);const m=e.default.fromString((0,t.toHex)(h.read(33))),d=(0,t.toHex)(h.read(33)),y=l.toPublicKey().encode(!0,"hex");if(d!==y)throw new Error(`The encrypted message expects a recipient public key of ${d}, but the provided key is ${y}`);const b=(0,t.toBase64)(h.read(32)),g=h.read(h.bin.length-h.pos),v=`2-message encryption-${b}`,_=m.deriveChild(l,v),S=l.deriveChild(m,v),I=_.deriveSharedSecret(S);return new n.default(I.encode(!0).slice(1)).decrypt(g)};return ya.decrypt=c,ya}var aI;function EB(){if(aI)return oi;aI=1;var i=oi&&oi.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),e=oi&&oi.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),n=oi&&oi.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var s in r)s!=="default"&&Object.prototype.hasOwnProperty.call(r,s)&&i(t,r,s);return e(t,r),t};return Object.defineProperty(oi,"__esModule",{value:!0}),oi.EncryptedMessage=oi.SignedMessage=void 0,oi.SignedMessage=n(TB()),oi.EncryptedMessage=n(kB()),oi}var Ji={},er={},sI;function OB(){return sI||(sI=1,function(i){var e=er&&er.__createBinding||(Object.create?function(d,y,b,g){g===void 0&&(g=b);var v=Object.getOwnPropertyDescriptor(y,b);(!v||("get"in v?!y.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return y[b]}}),Object.defineProperty(d,g,v)}:function(d,y,b,g){g===void 0&&(g=b),d[g]=y[b]}),n=er&&er.__setModuleDefault||(Object.create?function(d,y){Object.defineProperty(d,"default",{enumerable:!0,value:y})}:function(d,y){d.default=y}),r=er&&er.__importStar||function(d){if(d&&d.__esModule)return d;var y={};if(d!=null)for(var b in d)b!=="default"&&Object.prototype.hasOwnProperty.call(d,b)&&e(y,d,b);return n(y,d),y},t=er&&er.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(i,"__esModule",{value:!0}),i.verify=i.sign=i.magicHash=void 0;const s=t(an()),a=Ze(),c=r(Su()),u=r(sn()),l=`Bitcoin Signed Message:
`,h=d=>{const y=new a.Writer;y.writeVarIntNum(l.length),y.write((0,a.toArray)(l,"utf8")),y.writeVarIntNum(d.length),y.write(d);const b=y.toArray();return u.hash256(b)};i.magicHash=h;const f=(d,y,b="base64")=>{const g=(0,i.magicHash)(d),v=c.sign(new s.default(g),y,!0);if(b==="raw")return v;const _=new s.default(g),S=v.CalculateRecoveryFactor(y.toPublicKey(),_);return v.toCompact(S,!0,"base64")};i.sign=f;const m=(d,y,b)=>{const g=(0,i.magicHash)(d);return c.verify(new s.default(g),y,b)};i.verify=m}(er)),er}var Oi={},oI;function AB(){if(oI)return Oi;oI=1;var i=Oi&&Oi.__createBinding||(Object.create?function(m,d,y,b){b===void 0&&(b=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(m,b,g)}:function(m,d,y,b){b===void 0&&(b=y),m[b]=d[y]}),e=Oi&&Oi.__setModuleDefault||(Object.create?function(m,d){Object.defineProperty(m,"default",{enumerable:!0,value:d})}:function(m,d){m.default=d}),n=Oi&&Oi.__importStar||function(m){if(m&&m.__esModule)return m;var d={};if(m!=null)for(var y in m)y!=="default"&&Object.prototype.hasOwnProperty.call(m,y)&&i(d,m,y);return e(d,m),d},r=Oi&&Oi.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(Oi,"__esModule",{value:!0});const t=Ze(),s=n(sn()),a=r(qr()),c=r(Iu()),u=r(Ca()),l=r(Ln()),h=r(an());let f=class qp{constructor(d,y,b,g,v,_,S){this.constants={pubKey:76067358,privKey:76066276},this.versionBytesNum=d,this.depth=y,this.parentFingerPrint=b,this.childIndex=g,this.chainCode=v,this.privKey=_,this.pubKey=S}fromRandom(){return this.versionBytesNum=this.constants.privKey,this.depth=0,this.parentFingerPrint=[0,0,0,0],this.childIndex=0,this.chainCode=(0,l.default)(32),this.privKey=c.default.fromRandom(),this.pubKey=this.privKey.toPublicKey(),this}static fromRandom(){return new this().fromRandom()}static fromString(d){return new this().fromString(d)}fromString(d){const y=(0,t.fromBase58Check)(d);return this.fromBinary([...y.prefix,...y.data])}static fromSeed(d){return new this().fromSeed(d)}fromSeed(d){if(d.length<128/8)throw new Error("Need more than 128 bits of entropy");if(d.length>512/8)throw new Error("More than 512 bits of entropy is nonstandard");const y=s.sha512hmac((0,t.toArray)("Bitcoin seed","utf8"),d);return this.depth=0,this.parentFingerPrint=[0,0,0,0],this.childIndex=0,this.chainCode=y.slice(32,64),this.versionBytesNum=this.constants.privKey,this.privKey=new c.default(y.slice(0,32)),this.pubKey=this.privKey.toPublicKey(),this}static fromBinary(d){return new this().fromBinary(d)}fromBinary(d){if(d.length!==78)throw new Error("incorrect bip32 data length");const y=new t.Reader(d);this.versionBytesNum=y.readUInt32BE(),this.depth=y.readUInt8(),this.parentFingerPrint=y.read(4),this.childIndex=y.readUInt32BE(),this.chainCode=y.read(32);const b=y.read(33),g=this.versionBytesNum===this.constants.privKey,v=this.versionBytesNum===this.constants.pubKey;if(g&&b[0]===0)this.privKey=new c.default(b.slice(1,33)),this.pubKey=this.privKey.toPublicKey();else if(v&&(b[0]===2||b[0]===3))this.pubKey=u.default.fromString((0,t.toHex)(b));else throw new Error("Invalid key");return this}toString(){const d=this.toBinary();return(0,t.toBase58Check)(d,[])}derive(d){if(d==="m")return this;const y=d.split("/");let b=this;for(const[g,v]of y.entries()){if(g===0){if(v!=="m")throw new Error("invalid path");continue}if(parseInt(v.replace("'",""),10).toString()!==v.replace("'",""))throw new Error("invalid path");const _=v.length>1&&v[v.length-1]==="'";let S=parseInt(_?v.slice(0,v.length-1):v,10)&2147483647;_&&(S+=2147483648),b=b.deriveChild(S)}return b}deriveChild(d){if(typeof d!="number")throw new Error("i must be a number");const y=[];y.push(d>>24&255),y.push(d>>16&255),y.push(d>>8&255),y.push(d&255);const b=[...y],g=(d&2147483648)!==0,v=this.versionBytesNum===this.constants.privKey;if(g&&(this.privKey===null||this.privKey===void 0||!v))throw new Error("Cannot do private key derivation without private key");let _=null;if(this.privKey!==null&&this.privKey!==void 0){let I=null;g?I=[0,...this.privKey.toArray("be",32),...b]:I=[...this.pubKey.encode(!0),...b];const A=s.sha512hmac(this.chainCode,I),R=new h.default(A.slice(0,32)),E=A.slice(32,64),k=R.add(this.privKey).mod(new a.default().n);_=new qp,_.chainCode=E,_.privKey=new c.default(k.toArray()),_.pubKey=_.privKey.toPublicKey()}else{const I=[...this.pubKey.encode(!0),...b],A=s.sha512hmac(this.chainCode,I),R=new h.default(A.slice(0,32)),E=A.slice(32,64),k=new a.default().g.mul(R),P=this.pubKey,T=k.add(P),M=new u.default(T.x,T.y);_=new qp,_.chainCode=E,_.pubKey=M}_.childIndex=d;const S=s.hash160(this.pubKey.encode(!0));return _.parentFingerPrint=S.slice(0,4),_.versionBytesNum=this.versionBytesNum,_.depth=this.depth+1,_}toPublic(){const d=new qp(this.versionBytesNum,this.depth,this.parentFingerPrint,this.childIndex,this.chainCode,this.privKey,this.pubKey);return d.versionBytesNum=this.constants.pubKey,d.privKey=void 0,d}toBinary(){const d=this.versionBytesNum===this.constants.privKey,y=this.versionBytesNum===this.constants.pubKey;if(d)return new t.Writer().writeUInt32BE(this.versionBytesNum).writeUInt8(this.depth).write(this.parentFingerPrint).writeUInt32BE(this.childIndex).write(this.chainCode).writeUInt8(0).write(this.privKey.toArray("be",32)).toArray();if(y)return new t.Writer().writeUInt32BE(this.versionBytesNum).writeUInt8(this.depth).write(this.parentFingerPrint).writeUInt32BE(this.childIndex).write(this.chainCode).write(this.pubKey.encode(!0)).toArray();throw new Error("bip32: invalid versionBytesNum byte")}isPrivate(){return this.versionBytesNum===this.constants.privKey}};return Oi.default=f,Oi}var Ai={},Fl={},cI;function PB(){return cI||(cI=1,Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.wordList=void 0,Fl.wordList={value:["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"],space:" "}),Fl}var uI;function RB(){if(uI)return Ai;uI=1;var i=Ai&&Ai.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),e=Ai&&Ai.__setModuleDefault||(Object.create?function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}:function(l,h){l.default=h}),n=Ai&&Ai.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var f in l)f!=="default"&&Object.prototype.hasOwnProperty.call(l,f)&&i(h,l,f);return e(h,l),h},r=Ai&&Ai.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ai,"__esModule",{value:!0});const t=PB(),s=Ze(),a=n(sn()),c=r(Ln());let u=class U6{constructor(h,f,m=t.wordList){this.mnemonic=h??"",this.seed=f??[],this.Wordlist=m}toBinary(){const h=new s.Writer;if(this.mnemonic!==""){const f=(0,s.toArray)(this.mnemonic,"utf8");h.writeVarIntNum(f.length),h.write(f)}else h.writeVarIntNum(0);return this.seed.length>0?(h.writeVarIntNum(this.seed.length),h.write(this.seed)):h.writeVarIntNum(0),h.toArray()}fromBinary(h){const f=new s.Reader(h),m=f.readVarIntNum();m>0&&(this.mnemonic=(0,s.encode)(f.read(m),"utf8"));const d=f.readVarIntNum();return d>0&&(this.seed=f.read(d)),this}fromRandom(h){if((h==null||isNaN(h)||h===0)&&(h=128),h%32!==0)throw new Error("bits must be multiple of 32");if(h<128)throw new Error("bits must be at least 128");const f=(0,c.default)(h/8);return this.entropy2Mnemonic(f),this.mnemonic2Seed(),this}static fromRandom(h){return new this().fromRandom(h)}fromEntropy(h){return this.entropy2Mnemonic(h),this}static fromEntropy(h){return new this().fromEntropy(h)}fromString(h){return this.mnemonic=h,this}static fromString(h){return new this().fromString(h)}toString(){return this.mnemonic}toSeed(h){return this.mnemonic2Seed(h),this.seed}entropy2Mnemonic(h){if(h.length<128/8)throw new Error("Entropy is less than 128 bits. It must be 128 bits or more.");const f=a.sha256(h);let m="";const d=h.length*8;for(let g=0;g<h.length;g++)m=m+("00000000"+h[g].toString(2)).slice(-8);let y=f[0].toString(2);if(y=("00000000"+y).slice(-8).slice(0,d/32),m=m+y,m.length%11!==0)throw new Error("internal error - entropy not an even multiple of 11 bits - "+m.length.toString());let b="";for(let g=0;g<m.length/11;g++){b!==""&&(b=b+this.Wordlist.space);const v=parseInt(m.slice(g*11,(g+1)*11),2);b=b+this.Wordlist.value[v]}return this.mnemonic=b,this}check(){const f=this.mnemonic.split(this.Wordlist.space);let m="";for(let S=0;S<f.length;S++){const I=this.Wordlist.value.indexOf(f[S]);if(I<0)return!1;m=m+("00000000000"+I.toString(2)).slice(-11)}if(m.length%11!==0)throw new Error("internal error - entropy not an even multiple of 11 bits - "+m.length.toString());const d=m.length/33,y=m.slice(-d),b=m.slice(0,m.length-d),g=[];for(let S=0;S<b.length/8;S++)g.push(parseInt(m.slice(S*8,(S+1)*8),2));let _=a.sha256(g.slice(0,b.length/8))[0].toString(2);return _=("00000000"+_).slice(-8).slice(0,d),_===y}mnemonic2Seed(h=""){let f=this.mnemonic;if(!this.check())throw new Error("Mnemonic does not pass the check - was the mnemonic typed incorrectly? Are there extra spaces?");if(typeof h!="string")throw new Error("passphrase must be a string or undefined");f=f.normalize("NFKD"),h=h.normalize("NFKD");const m=(0,s.toArray)(f,"utf8"),d=[...(0,s.toArray)("mnemonic","utf8"),...(0,s.toArray)(h,"utf8")];return this.seed=a.pbkdf2(m,d,2048,64,"sha512"),this}isValid(h=""){let f;try{this.mnemonic2Seed(h),f=!0}catch{f=!1}return f}static isValid(h,f=""){return new U6(h).isValid(f)}};return Ai.default=u,Ai}var Pi={},lI;function NB(){if(lI)return Pi;lI=1;var i=Pi&&Pi.__createBinding||(Object.create?function(b,g,v,_){_===void 0&&(_=v);var S=Object.getOwnPropertyDescriptor(g,v);(!S||("get"in S?!g.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return g[v]}}),Object.defineProperty(b,_,S)}:function(b,g,v,_){_===void 0&&(_=v),b[_]=g[v]}),e=Pi&&Pi.__setModuleDefault||(Object.create?function(b,g){Object.defineProperty(b,"default",{enumerable:!0,value:g})}:function(b,g){b.default=g}),n=Pi&&Pi.__importStar||function(b){if(b&&b.__esModule)return b;var g={};if(b!=null)for(var v in b)v!=="default"&&Object.prototype.hasOwnProperty.call(b,v)&&i(g,b,v);return e(g,b),g},r=Pi&&Pi.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(Pi,"__esModule",{value:!0});const t=r(Ln()),s=r(Iu()),a=r(Ca()),c=r(xu()),u=n(sn()),l=Ze();function h(b){this._tables[0][0][0]===0&&this._precompute();let g,v,_;const S=this._tables[0][4],I=this._tables[1],A=b.length;let R=1;if(A!==4&&A!==6&&A!==8)throw new Error("invalid aes key size");this._key=[v=b.slice(0),_=[]];let E;for(E=A;E<4*A+28;E++)g=v[E-1],(E%A===0||A===8&&E%A===4)&&(g=S[g>>>24]<<24^S[g>>16&255]<<16^S[g>>8&255]<<8^S[g&255],E%A===0&&(g=g<<8^g>>>24^R<<24,R=R<<1^(R>>7)*283)),v[E]=v[E-A]^g;for(let k=0;E>0;k++,E--)g=v[(k&3)!==0?E:E-4],E<=4||k<4?_[k]=g:_[k]=I[0][S[g>>>24]]^I[1][S[g>>16&255]]^I[2][S[g>>8&255]]^I[3][S[g&255]]}h.prototype={encrypt:function(b){return this._crypt(b,0)},decrypt:function(b){return this._crypt(b,1)},_tables:[[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]],_precompute:function(){const b=this._tables[0],g=this._tables[1],v=b[4],_=g[4];let S,I,A;const R=new Uint8Array(256),E=new Uint8Array(256);let k,P,T,M,C,D;for(S=0;S<256;S++)E[(R[S]=S<<1^(S>>7)*283)^S]=S;for(I=A=0;v[I]===0;I^=k!==0?k:1,A=E[A]!==0?E[A]:1)for(M=A^A<<1^A<<2^A<<3^A<<4,M=M>>8^M&255^99,v[I]=M,_[M]=I,T=R[P=R[k=R[I]]],D=T*16843009^P*65537^k*257^I*16843008,C=R[M]*257^M*16843008,S=0;S<4;S++)b[S][I]=C=C<<24^C>>>8,g[S][M]=D=D<<24^D>>>8},_crypt:function(b,g){if(b.length!==4)throw new Error("invalid aes block size");const v=this._key[g];let _=b[0]^v[0],S=b[g===1?3:1]^v[1],I=b[2]^v[2],A=b[g===1?1:3]^v[3],R,E,k;const P=v.length/4-2;let T,M=4;const C=new Uint32Array(4),D=this._tables[g],F=D[0],B=D[1],L=D[2],q=D[3],K=D[4];for(T=0;T<P;T++)R=F[_>>>24]^B[S>>16&255]^L[I>>8&255]^q[A&255]^v[M],E=F[S>>>24]^B[I>>16&255]^L[A>>8&255]^q[_&255]^v[M+1],k=F[I>>>24]^B[A>>16&255]^L[_>>8&255]^q[S&255]^v[M+2],A=F[A>>>24]^B[_>>16&255]^L[S>>8&255]^q[I&255]^v[M+3],M+=4,_=R,S=E,I=k;for(T=0;T<4;T++)C[g===1?3&-T:T]=K[_>>>24]<<24^K[S>>16&255]<<16^K[I>>8&255]<<8^K[A&255]^v[M++],R=_,_=S,S=I,I=A,A=R;return C}};class f{static encrypt(g,v){const _=f.buf2Words(v),S=f.buf2Words(g),A=new h(_).encrypt(S);return f.words2Buf(A)}static decrypt(g,v){const _=f.buf2Words(g),S=f.buf2Words(v),A=new h(S).decrypt(_);return f.words2Buf(A)}static buf2Words(g){if(g.length%4!==0)throw new Error("buf length must be a multiple of 4");const v=[];for(let _=0;_<g.length/4;_++){const S=g[_*4]*16777216+(g[_*4+1]<<16|g[_*4+2]<<8|g[_*4+3]);v.push(S)}return v}static words2Buf(g){const v=new Array(g.length*4);for(let _=0;_<g.length;_++){const S=g[_];v[_*4]=S>>>24&255,v[_*4+1]=S>>>16&255,v[_*4+2]=S>>>8&255,v[_*4+3]=S&255}return v}}class m{static buf2BlocksBuf(g,v){const _=v/8,S=[];for(let I=0;I<=g.length/_;I++){let A=g.slice(I*_,I*_+_);A.length<v&&(A=m.pkcs7Pad(A,v)),S.push(A)}return S}static blockBufs2Buf(g){let v=g[g.length-1];return v=m.pkcs7Unpad(v),g[g.length-1]=v,g.flat()}static encrypt(g,v,_,S){const I=v.length*8,A=m.buf2BlocksBuf(g,I);return m.encryptBlocks(A,v,_,S).flat()}static decrypt(g,v,_,S){const I=v.length,A=[];for(let k=0;k<g.length/I;k++)A.push(g.slice(k*I,k*I+I));const R=m.decryptBlocks(A,v,_,S);return m.blockBufs2Buf(R)}static encryptBlock(g,v,_,S){const I=m.xorBufs(g,v);return _.encrypt(I,S)}static decryptBlock(g,v,_,S){const I=_.decrypt(g,S);return m.xorBufs(I,v)}static encryptBlocks(g,v,_,S){const I=[];for(let A=0;A<g.length;A++){const R=g[A],E=m.encryptBlock(R,v,_,S);I.push(E),v=E}return I}static decryptBlocks(g,v,_,S){const I=[];for(let A=0;A<g.length;A++){const R=g[A],E=m.decryptBlock(R,v,_,S);I.push(E),v=R}return I}static pkcs7Pad(g,v){const S=v/8-g.length,I=new Array(S);return I.fill(S),[...g,...I]}static pkcs7Unpad(g){const v=g[g.length-1],_=g.slice(g.length-v,g.length),S=new Array(v);if(S.fill(v),(0,l.toHex)(_)!==(0,l.toHex)(S))throw new Error("invalid padding");return g.slice(0,g.length-v)}static xorBufs(g,v){if(g.length!==v.length)throw new Error("bufs must have the same length");const _=new Array(g.length);for(let S=0;S<g.length;S++)_[S]=g[S]^v[S];return _}}class d{static encrypt(g,v,_,S=!0){_=_??(0,t.default)(128/8);const I=m.encrypt(g,_,f,v);return S?[..._,...I]:[...I]}static decrypt(g,v,_){if(_==null){_=g.slice(0,128/8);const S=g.slice(128/8);return m.decrypt(S,_,f,v)}else{const S=g;return m.decrypt(S,_,f,v)}}}let y=class Am{static ivkEkM(g,v){const _=g,I=v.mul(_),R=new a.default(I.x,I.y).encode(!0),E=u.sha512(R);return{iv:E.slice(0,16),kE:E.slice(16,32),kM:E.slice(32,64)}}static electrumEncrypt(g,v,_,S=!1){let I=null;_==null&&(_=s.default.fromRandom()),S||(I=_.toPublicKey().encode(!0));const{iv:A,kE:R,kM:E}=Am.ivkEkM(_,v),k=d.encrypt(g,R,A,!1),P=(0,l.toArray)("BIE1","utf8");let T;I!=null&&I.length>0?T=[...P,...I,...k]:T=[...P,...k];const M=u.sha256hmac(E,T);return[...T,...M]}static electrumDecrypt(g,v,_){const I=g.slice(0,4);if((0,l.encode)(I,"utf8")!=="BIE1")throw new Error("Invalid Magic");let A=4,R=null;if(g.length-A-32>=33){const D=g[A];D===2||D===3?(R=g.slice(A,A+33),A+=33):D===4&&(R=g.slice(A,A+65),A+=65)}if(R!==null)_==null&&(_=a.default.fromString((0,l.toHex)(R)));else if(_==null)throw new Error("Sender public key is required");const{iv:E,kE:k,kM:P}=Am.ivkEkM(v,_),T=g.slice(A,g.length-32),M=g.slice(g.length-32,g.length),C=u.sha256hmac(P,g.slice(0,g.length-32));if((0,l.toHex)(M)!==(0,l.toHex)(C))throw new Error("Invalid checksum");return d.decrypt(T,k,E)}static bitcoreEncrypt(g,v,_,S){_==null&&(_=s.default.fromRandom()),S==null&&(S=(0,t.default)(16));const I=_,R=_.toPublicKey().encode(!0),T=v.mul(I).getX().toArray("be",32),M=u.sha512(T),C=M.slice(0,32),D=M.slice(32,64),F=d.encrypt(g,C,S),B=u.sha256hmac(D,[...F]);return[...R,...F,...B]}static bitcoreDecrypt(g,v){const _=v,A=a.default.fromString((0,l.toHex)(g.slice(0,33))).mul(_);if(A.eq(new c.default(0,0)))throw new Error("P equals 0");const E=A.getX().toArray("be",32),k=u.sha512(E),P=k.slice(0,32),T=k.slice(32,64),M=g.slice(33,g.length-32),C=g.slice(g.length-32,g.length),D=u.sha256hmac(T,M);if((0,l.toHex)(C)!==(0,l.toHex)(D))throw new Error("Invalid checksum");return[...d.decrypt(M,P)]}};return Pi.default=y,Pi}var Uc={},dI;function CB(){if(dI)return Uc;dI=1;var i=Uc&&Uc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uc,"__esModule",{value:!0});const e=i(Nf()),n=i(Af());function r(t,s){const a=new e.default(0,[],[],0);return a.outputs=Array(t.vout+1).fill(null),a.outputs[t.vout]={satoshis:t.satoshis,lockingScript:n.default.fromHex(t.script)},{sourceTransaction:a,sourceTXID:t.txid,sourceOutputIndex:t.vout,unlockingScriptTemplate:s,sequence:4294967295}}return Uc.default=r,Uc}var fI;function MB(){return fI||(fI=1,function(i){var e=Ji&&Ji.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),n=Ji&&Ji.__setModuleDefault||(Object.create?function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}:function(l,h){l.default=h}),r=Ji&&Ji.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var f in l)f!=="default"&&Object.prototype.hasOwnProperty.call(l,f)&&e(h,l,f);return n(h,l),h},t=Ji&&Ji.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.fromUtxo=i.ECIES=i.Mnemonic=i.HD=i.BSM=void 0,i.BSM=r(OB());var s=AB();Object.defineProperty(i,"HD",{enumerable:!0,get:function(){return t(s).default}});var a=RB();Object.defineProperty(i,"Mnemonic",{enumerable:!0,get:function(){return t(a).default}});var c=NB();Object.defineProperty(i,"ECIES",{enumerable:!0,get:function(){return t(c).default}});var u=CB();Object.defineProperty(i,"fromUtxo",{enumerable:!0,get:function(){return t(u).default}})}(Ji)),Ji}var Ws={},$s={},hI;function BB(){if(hI)return $s;hI=1;var i=$s&&$s.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty($s,"__esModule",{value:!0}),$s.TOTP=void 0;const e=sn(),n=i(an());class r{static generate(c,u){const l=this.withDefaultOptions(u),h=this.getCounter(l.timestamp,l.period);return t(c,h,l)}static validate(c,u,l){const h=this.withDefaultValidateOptions(l);if(u=u.trim(),u.length!==h.digits)return!1;const f=this.getCounter(h.timestamp,h.period),m=[f];for(let d=1;d<=h.skew;d++)m.push(f+d),m.push(f-d);for(const d of m)if(u===t(c,d,h))return!0;return!1}static getCounter(c,u){const l=Math.floor(c/1e3);return Math.floor(l/u)}static withDefaultOptions(c){return{digits:2,algorithm:"SHA-1",period:30,timestamp:Date.now(),...c}}static withDefaultValidateOptions(c){return{skew:1,...this.withDefaultOptions(c)}}}$s.TOTP=r;function t(a,c,u){const l=new n.default(c).toArray("be",8),f=s(a,l,u.algorithm).digest(),m=f[f.length-1]&15,d=f.slice(m,m+4);return(new n.default(d).toNumber()&2147483647).toString().slice(-u.digits)}function s(a,c,u){switch(u){case"SHA-1":return new e.SHA1HMAC(a).update(c);case"SHA-256":return new e.SHA256HMAC(a).update(c);case"SHA-512":return new e.SHA512HMAC(a).update(c);default:throw new Error("unsupported HMAC algorithm")}}return $s}var pI;function DB(){return pI||(pI=1,function(i){var e=Ws&&Ws.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Ws&&Ws.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(BB(),i)}(Ws)),Ws}var ga={},Ul={},yI;function H6(){if(yI)return Ul;yI=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.SecurityLevels=void 0;var i;return function(e){e[e.Silent=0]="Silent",e[e.App=1]="App",e[e.Counterparty=2]="Counterparty"}(i||(Ul.SecurityLevels=i={})),Ul}var Hc={},gI;function Tw(){if(gI)return Hc;gI=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.KeyDeriver=void 0;const i=jr();let e=class{constructor(r){r==="anyone"?this.rootKey=new i.PrivateKey(1):this.rootKey=r,this.identityKey=this.rootKey.toPublicKey().toString()}derivePublicKey(r,t,s,a=!1){return s=this.normalizeCounterparty(s),a?this.rootKey.deriveChild(s,this.computeInvoiceNumber(r,t)).toPublicKey():s.deriveChild(this.rootKey,this.computeInvoiceNumber(r,t))}derivePrivateKey(r,t,s){return s=this.normalizeCounterparty(s),this.rootKey.deriveChild(s,this.computeInvoiceNumber(r,t))}deriveSymmetricKey(r,t,s){var a,c,u;s==="anyone"&&(s=new i.PrivateKey(1).toPublicKey()),s=this.normalizeCounterparty(s);const l=this.derivePublicKey(r,t,s),h=this.derivePrivateKey(r,t,s);return new i.SymmetricKey((u=(c=(a=h.deriveSharedSecret(l))===null||a===void 0?void 0:a.x)===null||c===void 0?void 0:c.toArray())!==null&&u!==void 0?u:[])}revealCounterpartySecret(r){if(r==="self")throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");r=this.normalizeCounterparty(r);const t=this.rootKey.toPublicKey(),s=this.rootKey.deriveChild(t,"test").toHex(),a=this.rootKey.deriveChild(r,"test").toHex();if(s===a)throw new Error("Counterparty secrets cannot be revealed for counterparty=self.");return this.rootKey.deriveSharedSecret(r).encode(!0)}revealSpecificSecret(r,t,s){r=this.normalizeCounterparty(r);const a=this.rootKey.deriveSharedSecret(r),c=i.Utils.toArray(this.computeInvoiceNumber(t,s),"utf8");return i.Hash.sha256hmac(a.encode(!0),c)}normalizeCounterparty(r){if(r==null)throw new Error("counterparty must be self, anyone or a public key!");return r==="self"?this.rootKey.toPublicKey():r==="anyone"?new i.PrivateKey(1).toPublicKey():typeof r=="string"?i.PublicKey.fromString(r):r}computeInvoiceNumber(r,t){const s=r[0];if(!Number.isInteger(s)||s<0||s>2)throw new Error("Protocol security level must be 0, 1, or 2");const a=r[1].toLowerCase().trim();if(t.length>800)throw new Error("Key IDs must be 800 characters or less");if(t.length<1)throw new Error("Key IDs must be 1 character or more");if(a.length>400)if(a.startsWith("specific linkage revelation ")){if(a.length>430)throw new Error("Specific linkage revelation protocol names must be 430 characters or less")}else throw new Error("Protocol names must be 400 characters or less");if(a.length<5)throw new Error("Protocol names must be 5 characters or more");if(a.includes("  "))throw new Error('Protocol names cannot contain multiple consecutive spaces ("  ")');if(!/^[a-z0-9 ]+$/g.test(a))throw new Error("Protocol names can only contain letters, numbers and spaces");if(a.endsWith(" protocol"))throw new Error('No need to end your protocol name with " protocol"');return`${s}-${a}-${t}`}};return Hc.KeyDeriver=e,Hc.default=e,Hc}var dp={},bI;function LB(){if(bI)return dp;bI=1,Object.defineProperty(dp,"__esModule",{value:!0});const i=jr(),e=Tw();let n=class{constructor(t,s){this.keyDeriver=new e.KeyDeriver(t),this.cache=new Map;const a=s==null?void 0:s.maxCacheSize;this.maxCacheSize=a!=null&&!isNaN(a)&&a>0?a:1e3}derivePublicKey(t,s,a,c=!1){const u=this.generateCacheKey("derivePublicKey",t,s,a,c);if(this.cache.has(u)){const l=this.cacheGet(u);if(l===void 0)throw new Error("Cached value is undefined");return l}else{const l=this.keyDeriver.derivePublicKey(t,s,a,c);return this.cacheSet(u,l),l}}derivePrivateKey(t,s,a){const c=this.generateCacheKey("derivePrivateKey",t,s,a);if(this.cache.has(c)){const u=this.cacheGet(c);if(u===void 0)throw new Error("Cached value is undefined");return u}else{const u=this.keyDeriver.derivePrivateKey(t,s,a);return this.cacheSet(c,u),u}}deriveSymmetricKey(t,s,a){const c=this.generateCacheKey("deriveSymmetricKey",t,s,a);if(this.cache.has(c)){const u=this.cacheGet(c);if(u===void 0)throw new Error("Cached value is undefined");return u}else{const u=this.keyDeriver.deriveSymmetricKey(t,s,a);return this.cacheSet(c,u),u}}revealCounterpartySecret(t){const s=this.generateCacheKey("revealCounterpartySecret",t);if(this.cache.has(s)){const a=this.cacheGet(s);if(a===void 0)throw new Error("Cached value is undefined");return a}else{const a=this.keyDeriver.revealCounterpartySecret(t);return this.cacheSet(s,a),a}}revealSpecificSecret(t,s,a){const c=this.generateCacheKey("revealSpecificSecret",t,s,a);if(this.cache.has(c)){const u=this.cacheGet(c);if(u===void 0)throw new Error("Cached value is undefined");return u}else{const u=this.keyDeriver.revealSpecificSecret(t,s,a);return this.cacheSet(c,u),u}}generateCacheKey(t,...s){const a=s.map(c=>this.serializeArgument(c)).join("|");return`${t}|${a}`}serializeArgument(t){return t instanceof i.PublicKey||t instanceof i.PrivateKey?t.toString():Array.isArray(t)?t.map(s=>this.serializeArgument(s)).join(","):typeof t=="object"&&t!==null?JSON.stringify(t):String(t)}cacheGet(t){const s=this.cache.get(t);return this.cache.delete(t),s!==void 0&&this.cache.set(t,s),s}cacheSet(t,s){if(this.cache.size>=this.maxCacheSize){const a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,s)}};return dp.default=n,dp}var qc={},mI;function q6(){if(mI)return qc;mI=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.ProtoWallet=void 0;const i=Tw(),e=jr();let n=class{constructor(t){typeof t.identityKey!="string"&&(t=new i.KeyDeriver(t)),this.keyDeriver=t}async getPublicKey(t){var s,a;if(t.identityKey){if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(t.protocolID==null||t.keyID==null||t.keyID==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");return{publicKey:((s=this.keyDeriver)!==null&&s!==void 0?s:(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(t.protocolID,t.keyID,(a=t.counterparty)!==null&&a!==void 0?a:"self",t.forSelf).toString()}}}async revealCounterpartyKeyLinkage(t){const{publicKey:s}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.revealCounterpartySecret(t.counterparty),c=new e.Schnorr().generateProof(this.keyDeriver.rootKey,this.keyDeriver.rootKey.toPublicKey(),e.PublicKey.fromString(t.counterparty),e.Point.fromDER(a)),u=[...c.R.encode(!0),...c.SPrime.encode(!0),...c.z.toArray()],l=new Date().toISOString(),{ciphertext:h}=await this.encrypt({plaintext:a,protocolID:[2,"counterparty linkage revelation"],keyID:l,counterparty:t.verifier}),{ciphertext:f}=await this.encrypt({plaintext:u,protocolID:[2,"counterparty linkage revelation"],keyID:l,counterparty:t.verifier});return{prover:s,verifier:t.verifier,counterparty:t.counterparty,revelationTime:l,encryptedLinkage:h,encryptedLinkageProof:f}}async revealSpecificKeyLinkage(t){const{publicKey:s}=await this.getPublicKey({identityKey:!0});if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.revealSpecificSecret(t.counterparty,t.protocolID,t.keyID),{ciphertext:c}=await this.encrypt({plaintext:a,protocolID:[2,`specific linkage revelation ${t.protocolID[0]} ${t.protocolID[1]}`],keyID:t.keyID,counterparty:t.verifier}),{ciphertext:u}=await this.encrypt({plaintext:[0],protocolID:[2,`specific linkage revelation ${t.protocolID[0]} ${t.protocolID[1]}`],keyID:t.keyID,counterparty:t.verifier});return{prover:s,verifier:t.verifier,counterparty:t.counterparty,protocolID:t.protocolID,keyID:t.keyID,encryptedLinkage:c,encryptedLinkageProof:u,proofType:0}}async encrypt(t){var s;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{ciphertext:this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,(s=t.counterparty)!==null&&s!==void 0?s:"self").encrypt(t.plaintext)}}async decrypt(t){var s;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");return{plaintext:this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,(s=t.counterparty)!==null&&s!==void 0?s:"self").decrypt(t.ciphertext)}}async createHmac(t){var s;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,(s=t.counterparty)!==null&&s!==void 0?s:"self");return{hmac:e.Hash.sha256hmac(a.toArray(),t.data)}}async verifyHmac(t){var s;if(this.keyDeriver==null)throw new Error("keyDeriver is undefined");const a=this.keyDeriver.deriveSymmetricKey(t.protocolID,t.keyID,(s=t.counterparty)!==null&&s!==void 0?s:"self"),c=e.Hash.sha256hmac(a.toArray(),t.data).toString()===t.hmac.toString();if(!c){const u=new Error("HMAC is not valid");throw u.code="ERR_INVALID_HMAC",u}return{valid:c}}async createSignature(t){var s,a,c,u;if(t.hashToDirectlySign==null&&t.data==null)throw new Error("args.data or args.hashToDirectlySign must be valid");const l=(s=t.hashToDirectlySign)!==null&&s!==void 0?s:e.Hash.sha256((a=t.data)!==null&&a!==void 0?a:[]),f=((c=this.keyDeriver)!==null&&c!==void 0?c:(()=>{throw new Error("keyDeriver is undefined")})()).derivePrivateKey(t.protocolID,t.keyID,(u=t.counterparty)!==null&&u!==void 0?u:"anyone");return{signature:e.ECDSA.sign(new e.BigNumber(l),f,!0).toDER()}}async verifySignature(t){var s,a,c,u;if(t.hashToDirectlyVerify==null&&t.data==null)throw new Error("args.data or args.hashToDirectlyVerify must be valid");const l=(s=t.hashToDirectlyVerify)!==null&&s!==void 0?s:e.Hash.sha256((a=t.data)!==null&&a!==void 0?a:[]),f=((c=this.keyDeriver)!==null&&c!==void 0?c:(()=>{throw new Error("keyDeriver is undefined")})()).derivePublicKey(t.protocolID,t.keyID,(u=t.counterparty)!==null&&u!==void 0?u:"self",t.forSelf),m=e.ECDSA.verify(new e.BigNumber(l),e.Signature.fromDER(t.signature),f);if(!m){const d=new Error("Signature is not valid");throw d.code="ERR_INVALID_SIGNATURE",d}return{valid:m}}};return qc.ProtoWallet=n,qc.default=n,qc}var jc={},fp={},wI;function j6(){if(wI)return fp;wI=1,Object.defineProperty(fp,"__esModule",{value:!0});class i{constructor(){if(typeof window!="object")throw new Error("The window.CWI substrate requires a global window object.");if(typeof window.CWI!="object")throw new Error("The window.CWI interface does not appear to be bound to the window object.");this.CWI=window.CWI}async createAction(n,r){return await this.CWI.createAction(n,r)}async signAction(n,r){return await this.CWI.signAction(n,r)}async abortAction(n,r){return await this.CWI.abortAction(n,r)}async listActions(n,r){return await this.CWI.listActions(n,r)}async internalizeAction(n,r){return await this.CWI.internalizeAction(n,r)}async listOutputs(n,r){return await this.CWI.listOutputs(n,r)}async relinquishOutput(n,r){return await this.CWI.relinquishOutput(n,r)}async getPublicKey(n,r){return await this.CWI.getPublicKey(n,r)}async revealCounterpartyKeyLinkage(n,r){return await this.CWI.revealCounterpartyKeyLinkage(n,r)}async revealSpecificKeyLinkage(n,r){return await this.CWI.revealSpecificKeyLinkage(n,r)}async encrypt(n,r){return await this.CWI.encrypt(n,r)}async decrypt(n,r){return await this.CWI.decrypt(n,r)}async createHmac(n,r){return await this.CWI.createHmac(n,r)}async verifyHmac(n,r){return await this.CWI.verifyHmac(n,r)}async createSignature(n,r){return await this.CWI.createSignature(n,r)}async verifySignature(n,r){return await this.CWI.verifySignature(n,r)}async acquireCertificate(n,r){return await this.CWI.acquireCertificate(n,r)}async listCertificates(n,r){return await this.CWI.listCertificates(n,r)}async proveCertificate(n,r){return await this.CWI.proveCertificate(n,r)}async relinquishCertificate(n,r){return await this.CWI.relinquishCertificate(n,r)}async discoverByIdentityKey(n,r){return await this.CWI.discoverByIdentityKey(n,r)}async discoverByAttributes(n,r){return await this.CWI.discoverByAttributes(n,r)}async isAuthenticated(n,r){return await this.CWI.isAuthenticated(n,r)}async waitForAuthentication(n,r){return await this.CWI.waitForAuthentication(n,r)}async getHeight(n,r){return await this.CWI.getHeight(n,r)}async getHeaderForHeight(n,r){return await this.CWI.getHeaderForHeight(n,r)}async getNetwork(n,r){return await this.CWI.getNetwork(n,r)}async getVersion(n,r){return await this.CWI.getVersion(n,r)}}return fp.default=i,fp}var Ri={},os={},vI;function yf(){if(vI)return os;vI=1,Object.defineProperty(os,"__esModule",{value:!0}),os.walletErrors=os.WalletError=void 0;let i=class extends Error{constructor(r,t=1,s){super(r),this.isError=!0,this.code=t,this.name=this.constructor.name,s!=null&&s!==""?this.stack=s:Error.captureStackTrace(this,this.constructor)}};os.WalletError=i;var e;return function(n){n[n.unknownError=1]="unknownError",n[n.unsupportedAction=2]="unsupportedAction",n[n.invalidHmac=3]="invalidHmac",n[n.invalidSignature=4]="invalidSignature",n[n.reviewActions=5]="reviewActions"}(e||(os.walletErrors=e={})),os.default=i,os}var xI;function V6(){if(xI)return Ri;xI=1;var i=Ri&&Ri.__createBinding||(Object.create?function(u,l,h,f){f===void 0&&(f=h);var m=Object.getOwnPropertyDescriptor(l,h);(!m||("get"in m?!l.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(u,f,m)}:function(u,l,h,f){f===void 0&&(f=h),u[f]=l[h]}),e=Ri&&Ri.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),n=Ri&&Ri.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h in u)h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)&&i(l,u,h);return e(l,u),l},r=Ri&&Ri.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ri,"__esModule",{value:!0});const t=r(Ln()),s=n(Ze()),a=yf();class c{constructor(l="*"){if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(typeof window.postMessage!="function")throw new Error("The window object does not seem to support postMessage calls.");this.domain=l}async invoke(l,h){return await new Promise((f,m)=>{const d=s.toBase64((0,t.default)(12)),y=b=>{if(!(b.data.type!=="CWI"||!b.isTrusted||b.data.id!==d||b.data.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",y),b.data.status==="error"){const g=new a.WalletError(b.data.description,b.data.code);m(g)}else f(b.data.result)};window.addEventListener("message",y),window.parent.postMessage({type:"CWI",isInvocation:!0,id:d,call:l,args:h},this.domain)})}async createAction(l){return await this.invoke("createAction",l)}async signAction(l){return await this.invoke("signAction",l)}async abortAction(l){return await this.invoke("abortAction",l)}async listActions(l){return await this.invoke("listActions",l)}async internalizeAction(l){return await this.invoke("internalizeAction",l)}async listOutputs(l){return await this.invoke("listOutputs",l)}async relinquishOutput(l){return await this.invoke("relinquishOutput",l)}async getPublicKey(l){return await this.invoke("getPublicKey",l)}async revealCounterpartyKeyLinkage(l){return await this.invoke("revealCounterpartyKeyLinkage",l)}async revealSpecificKeyLinkage(l){return await this.invoke("revealSpecificKeyLinkage",l)}async encrypt(l){return await this.invoke("encrypt",l)}async decrypt(l){return await this.invoke("decrypt",l)}async createHmac(l){return await this.invoke("createHmac",l)}async verifyHmac(l){return await this.invoke("verifyHmac",l)}async createSignature(l){return await this.invoke("createSignature",l)}async verifySignature(l){return await this.invoke("verifySignature",l)}async acquireCertificate(l){return await this.invoke("acquireCertificate",l)}async listCertificates(l){return await this.invoke("listCertificates",l)}async proveCertificate(l){return await this.invoke("proveCertificate",l)}async relinquishCertificate(l){return await this.invoke("relinquishCertificate",l)}async discoverByIdentityKey(l){return await this.invoke("discoverByIdentityKey",l)}async discoverByAttributes(l){return await this.invoke("discoverByAttributes",l)}async isAuthenticated(l){return await this.invoke("isAuthenticated",l)}async waitForAuthentication(l){return await this.invoke("waitForAuthentication",l)}async getHeight(l){return await this.invoke("getHeight",l)}async getHeaderForHeight(l){return await this.invoke("getHeaderForHeight",l)}async getNetwork(l){return await this.invoke("getNetwork",l)}async getVersion(l){return await this.invoke("getVersion",l)}}return Ri.default=c,Ri}var Ni={},Ci={},_I;function Tu(){if(_I)return Ci;_I=1;var i=Ci&&Ci.__createBinding||(Object.create?function(u,l,h,f){f===void 0&&(f=h);var m=Object.getOwnPropertyDescriptor(l,h);(!m||("get"in m?!l.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(u,f,m)}:function(u,l,h,f){f===void 0&&(f=h),u[f]=l[h]}),e=Ci&&Ci.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),n=Ci&&Ci.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h in u)h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)&&i(l,u,h);return e(l,u),l},r=Ci&&Ci.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ci,"__esModule",{value:!0});const t=n(Ze()),s=r(q6()),a=r(_u());let c=class K6{constructor(l,h,f,m,d,y,b){this.type=l,this.serialNumber=h,this.subject=f,this.certifier=m,this.revocationOutpoint=d,this.fields=y,this.signature=b}toBinary(l=!0){var h;const f=new t.Writer,m=t.toArray(this.type,"base64");f.write(m);const d=t.toArray(this.serialNumber,"base64");f.write(d);const y=t.toArray(this.subject,"hex");f.write(y);const b=t.toArray(this.certifier,"hex");f.write(b);const[g,v]=this.revocationOutpoint.split("."),_=t.toArray(g,"hex");f.write(_),f.writeVarIntNum(Number(v));const S=Object.keys(this.fields).sort();f.writeVarIntNum(S.length);for(const I of S){const A=this.fields[I],R=t.toArray(I,"utf8");f.writeVarIntNum(R.length),f.write(R);const E=t.toArray(A,"utf8");f.writeVarIntNum(E.length),f.write(E)}if(l&&((h=this.signature)!==null&&h!==void 0?h:"").length>0){const I=t.toArray(this.signature,"hex");f.write(I)}return f.toArray()}static fromBinary(l){const h=new t.Reader(l),f=h.read(32),m=t.toBase64(f),d=h.read(32),y=t.toBase64(d),b=h.read(33),g=t.toHex(b),v=h.read(33),_=t.toHex(v),S=h.read(32),I=t.toHex(S),A=h.readVarIntNum(),R=`${I}.${A}`,E=h.readVarIntNum(),k={};for(let T=0;T<E;T++){const M=h.readVarIntNum(),C=h.read(M),D=t.toUTF8(C),F=h.readVarIntNum(),B=h.read(F),L=t.toUTF8(B);k[D]=L}let P;if(!h.eof()){const T=h.read();P=a.default.fromDER(T).toString("hex")}return new K6(m,y,g,_,R,k,P)}async verify(){var l;const h=new s.default("anyone"),f=this.toBinary(!1),m=(l=this.signature)!==null&&l!==void 0?l:"",{valid:d}=await h.verifySignature({signature:t.toArray(m,"hex"),data:f,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`,counterparty:this.certifier});return d}async sign(l){if(this.signature!=null&&this.signature.length>0)throw new Error(`Certificate has already been signed! Signature present: ${this.signature}`);this.certifier=(await l.getPublicKey({identityKey:!0})).publicKey;const h=this.toBinary(!1),{signature:f}=await l.createSignature({data:h,protocolID:[2,"certificate signature"],keyID:`${this.type} ${this.serialNumber}`});this.signature=t.toHex(f)}static getCertificateFieldEncryptionDetails(l,h){return{protocolID:[2,"certificate field encryption"],keyID:h?`${h} ${l}`:l}}};return Ci.default=c,Ci}var hp={},SI;function F0(){if(SI)return hp;SI=1,Object.defineProperty(hp,"__esModule",{value:!0});var i;return function(e){e[e.createAction=1]="createAction",e[e.signAction=2]="signAction",e[e.abortAction=3]="abortAction",e[e.listActions=4]="listActions",e[e.internalizeAction=5]="internalizeAction",e[e.listOutputs=6]="listOutputs",e[e.relinquishOutput=7]="relinquishOutput",e[e.getPublicKey=8]="getPublicKey",e[e.revealCounterpartyKeyLinkage=9]="revealCounterpartyKeyLinkage",e[e.revealSpecificKeyLinkage=10]="revealSpecificKeyLinkage",e[e.encrypt=11]="encrypt",e[e.decrypt=12]="decrypt",e[e.createHmac=13]="createHmac",e[e.verifyHmac=14]="verifyHmac",e[e.createSignature=15]="createSignature",e[e.verifySignature=16]="verifySignature",e[e.acquireCertificate=17]="acquireCertificate",e[e.listCertificates=18]="listCertificates",e[e.proveCertificate=19]="proveCertificate",e[e.relinquishCertificate=20]="relinquishCertificate",e[e.discoverByIdentityKey=21]="discoverByIdentityKey",e[e.discoverByAttributes=22]="discoverByAttributes",e[e.isAuthenticated=23]="isAuthenticated",e[e.waitForAuthentication=24]="waitForAuthentication",e[e.getHeight=25]="getHeight",e[e.getHeaderForHeight=26]="getHeaderForHeight",e[e.getNetwork=27]="getNetwork",e[e.getVersion=28]="getVersion"}(i||(i={})),hp.default=i,hp}var II;function W6(){if(II)return Ni;II=1;var i=Ni&&Ni.__createBinding||(Object.create?function(h,f,m,d){d===void 0&&(d=m);var y=Object.getOwnPropertyDescriptor(f,m);(!y||("get"in y?!f.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return f[m]}}),Object.defineProperty(h,d,y)}:function(h,f,m,d){d===void 0&&(d=m),h[d]=f[m]}),e=Ni&&Ni.__setModuleDefault||(Object.create?function(h,f){Object.defineProperty(h,"default",{enumerable:!0,value:f})}:function(h,f){h.default=f}),n=Ni&&Ni.__importStar||function(h){if(h&&h.__esModule)return h;var f={};if(h!=null)for(var m in h)m!=="default"&&Object.prototype.hasOwnProperty.call(h,m)&&i(f,h,m);return e(f,h),f},r=Ni&&Ni.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Ni,"__esModule",{value:!0});const t=H6(),s=r(Tu()),a=n(Ze()),c=r(F0()),u=yf();let l=class{constructor(f){this.wire=f}async transmit(f,m="",d=[]){const y=new a.Writer;y.writeUInt8(c.default[f]);const b=a.toArray(m,"utf8");y.writeUInt8(b.length),y.write(b),d.length>0&&y.write(d);const g=y.toArray(),v=await this.wire.transmitToWallet(g),_=new a.Reader(v),S=_.readUInt8();if(S===0)return _.read();{const I=_.readVarIntNum(),A=_.read(I),R=a.toUTF8(A),E=_.readVarIntNum(),k=_.read(E),P=a.toUTF8(k);throw new u.WalletError(R,S,P)}}async createAction(f,m){var d;const y=new a.Writer,b=a.toArray(f.description,"utf8");if(y.writeVarIntNum(b.length),y.write(b),f.inputBEEF!=null?(y.writeVarIntNum(f.inputBEEF.length),y.write(f.inputBEEF)):y.writeVarIntNum(-1),f.inputs!=null){y.writeVarIntNum(f.inputs.length);for(const k of f.inputs){if(y.write(this.encodeOutpoint(k.outpoint)),k.unlockingScript!=null&&k.unlockingScript!==""){const T=a.toArray(k.unlockingScript,"hex");y.writeVarIntNum(T.length),y.write(T)}else y.writeVarIntNum(-1),y.writeVarIntNum((d=k.unlockingScriptLength)!==null&&d!==void 0?d:0);const P=a.toArray(k.inputDescription,"utf8");y.writeVarIntNum(P.length),y.write(P),typeof k.sequenceNumber=="number"?y.writeVarIntNum(k.sequenceNumber):y.writeVarIntNum(-1)}}else y.writeVarIntNum(-1);if(f.outputs!=null){y.writeVarIntNum(f.outputs.length);for(const k of f.outputs){const P=a.toArray(k.lockingScript,"hex");y.writeVarIntNum(P.length),y.write(P),y.writeVarIntNum(k.satoshis);const T=a.toArray(k.outputDescription,"utf8");if(y.writeVarIntNum(T.length),y.write(T),k.basket!=null&&k.basket!==""){const M=a.toArray(k.basket,"utf8");y.writeVarIntNum(M.length),y.write(M)}else y.writeVarIntNum(-1);if(k.customInstructions!=null&&k.customInstructions!==""){const M=a.toArray(k.customInstructions,"utf8");y.writeVarIntNum(M.length),y.write(M)}else y.writeVarIntNum(-1);if(k.tags!=null){y.writeVarIntNum(k.tags.length);for(const M of k.tags){const C=a.toArray(M,"utf8");y.writeVarIntNum(C.length),y.write(C)}}else y.writeVarIntNum(-1)}}else y.writeVarIntNum(-1);if(typeof f.lockTime=="number"?y.writeVarIntNum(f.lockTime):y.writeVarIntNum(-1),typeof f.version=="number"?y.writeVarIntNum(f.version):y.writeVarIntNum(-1),f.labels!=null){y.writeVarIntNum(f.labels.length);for(const k of f.labels){const P=a.toArray(k,"utf8");y.writeVarIntNum(P.length),y.write(P)}}else y.writeVarIntNum(-1);if(f.options!=null){if(y.writeInt8(1),typeof f.options.signAndProcess=="boolean"?y.writeInt8(f.options.signAndProcess?1:0):y.writeInt8(-1),typeof f.options.acceptDelayedBroadcast=="boolean"?y.writeInt8(f.options.acceptDelayedBroadcast?1:0):y.writeInt8(-1),f.options.trustSelf==="known"?y.writeInt8(1):y.writeInt8(-1),f.options.knownTxids!=null){y.writeVarIntNum(f.options.knownTxids.length);for(const k of f.options.knownTxids){const P=a.toArray(k,"hex");y.write(P)}}else y.writeVarIntNum(-1);if(typeof f.options.returnTXIDOnly=="boolean"?y.writeInt8(f.options.returnTXIDOnly?1:0):y.writeInt8(-1),typeof f.options.noSend=="boolean"?y.writeInt8(f.options.noSend?1:0):y.writeInt8(-1),f.options.noSendChange!=null){y.writeVarIntNum(f.options.noSendChange.length);for(const k of f.options.noSendChange)y.write(this.encodeOutpoint(k))}else y.writeVarIntNum(-1);if(f.options.sendWith!=null){y.writeVarIntNum(f.options.sendWith.length);for(const k of f.options.sendWith){const P=a.toArray(k,"hex");y.write(P)}}else y.writeVarIntNum(-1);typeof f.options.randomizeOutputs=="boolean"?y.writeInt8(f.options.randomizeOutputs?1:0):y.writeInt8(-1)}else y.writeInt8(0);const g=await this.transmit("createAction",m,y.toArray()),v=new a.Reader(g),_={};if(v.readInt8()===1){const k=v.read(32);_.txid=a.toHex(k)}if(v.readInt8()===1){const k=v.readVarIntNum();_.tx=v.read(k)}const A=v.readVarIntNum();if(A>=0){_.noSendChange=[];for(let k=0;k<A;k++){const P=this.readOutpoint(v);_.noSendChange.push(P)}}const R=v.readVarIntNum();if(R>=0){_.sendWithResults=[];for(let k=0;k<R;k++){const P=v.read(32),T=a.toHex(P),M=v.readInt8();let C="unproven";M===1?C="unproven":M===2?C="sending":M===3&&(C="failed"),_.sendWithResults.push({txid:T,status:C})}}if(v.readInt8()===1){const k=v.readVarIntNum(),P=v.read(k),T=v.readVarIntNum(),M=v.read(T);_.signableTransaction={tx:P,reference:a.toBase64(M)}}return _}async signAction(f,m){const d=new a.Writer,y=Object.keys(f.spends);d.writeVarIntNum(y.length);for(const R of y){d.writeVarIntNum(Number(R));const E=f.spends[Number(R)],k=a.toArray(E.unlockingScript,"hex");d.writeVarIntNum(k.length),d.write(k),typeof E.sequenceNumber=="number"?d.writeVarIntNum(E.sequenceNumber):d.writeVarIntNum(-1)}const b=a.toArray(f.reference,"base64");if(d.writeVarIntNum(b.length),d.write(b),f.options!=null)if(d.writeInt8(1),typeof f.options.acceptDelayedBroadcast=="boolean"?d.writeInt8(f.options.acceptDelayedBroadcast?1:0):d.writeInt8(-1),typeof f.options.returnTXIDOnly=="boolean"?d.writeInt8(f.options.returnTXIDOnly?1:0):d.writeInt8(-1),typeof f.options.noSend=="boolean"?d.writeInt8(f.options.noSend?1:0):d.writeInt8(-1),f.options.sendWith!=null){d.writeVarIntNum(f.options.sendWith.length);for(const R of f.options.sendWith){const E=a.toArray(R,"hex");d.write(E)}}else d.writeVarIntNum(-1);else d.writeInt8(0);const g=await this.transmit("signAction",m,d.toArray()),v=new a.Reader(g),_={};if(v.readInt8()===1){const R=v.read(32);_.txid=a.toHex(R)}if(v.readInt8()===1){const R=v.readVarIntNum();_.tx=v.read(R)}const A=v.readVarIntNum();if(A>=0){_.sendWithResults=[];for(let R=0;R<A;R++){const E=v.read(32),k=a.toHex(E),P=v.readInt8();let T="unproven";P===1?T="unproven":P===2?T="sending":P===3&&(T="failed"),_.sendWithResults.push({txid:k,status:T})}}return _}async abortAction(f,m){return await this.transmit("abortAction",m,a.toArray(f.reference,"base64")),{aborted:!0}}async listActions(f,m){const d=new a.Writer;d.writeVarIntNum(f.labels.length);for(const S of f.labels){const I=a.toArray(S,"utf8");d.writeVarIntNum(I.length),d.write(I)}f.labelQueryMode==="any"?d.writeInt8(1):f.labelQueryMode==="all"?d.writeInt8(2):d.writeInt8(-1);const y=[f.includeLabels,f.includeInputs,f.includeInputSourceLockingScripts,f.includeInputUnlockingScripts,f.includeOutputs,f.includeOutputLockingScripts];for(const S of y)typeof S=="boolean"?d.writeInt8(S?1:0):d.writeInt8(-1);typeof f.limit=="number"?d.writeVarIntNum(f.limit):d.writeVarIntNum(-1),typeof f.offset=="number"?d.writeVarIntNum(f.offset):d.writeVarIntNum(-1),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1);const b=await this.transmit("listActions",m,d.toArray()),g=new a.Reader(b),v=g.readVarIntNum(),_=[];for(let S=0;S<v;S++){const I=g.read(32),A=a.toHex(I),R=g.readVarIntNum(),E=g.readInt8();let k;switch(E){case 1:k="completed";break;case 2:k="unprocessed";break;case 3:k="sending";break;case 4:k="unproven";break;case 5:k="unsigned";break;case 6:k="nosend";break;case 7:k="nonfinal";break;case 8:k="failed";break;default:throw new Error(`Unknown status code: ${E}`)}const P=g.readInt8()===1,T=g.readVarIntNum(),M=g.read(T),C=a.toUTF8(M),D={txid:A,satoshis:R,status:k,isOutgoing:P,description:C,version:0,lockTime:0},F=g.readVarIntNum();if(F>=0){D.labels=[];for(let q=0;q<F;q++){const K=g.readVarIntNum(),$=g.read(K);D.labels.push(a.toUTF8($))}}D.version=g.readVarIntNum(),D.lockTime=g.readVarIntNum();const B=g.readVarIntNum();if(B>=0){D.inputs=[];for(let q=0;q<B;q++){const K=this.readOutpoint(g),$=g.readVarIntNum(),U=g.readVarIntNum();let z;if(U>=0){const xe=g.read(U);z=a.toHex(xe)}const G=g.readVarIntNum();let ne;if(G>=0){const xe=g.read(G);ne=a.toHex(xe)}const ce=g.readVarIntNum(),Se=g.read(ce),Ie=a.toUTF8(Se),me=g.readVarIntNum();D.inputs.push({sourceOutpoint:K,sourceSatoshis:$,sourceLockingScript:z,unlockingScript:ne,inputDescription:Ie,sequenceNumber:me})}}const L=g.readVarIntNum();if(L>=0){D.outputs=[];for(let q=0;q<L;q++){const K=g.readVarIntNum(),$=g.readVarIntNum(),U=g.readVarIntNum();let z;if(U>=0){const Ne=g.read(U);z=a.toHex(Ne)}const G=g.readInt8()===1,ne=g.readVarIntNum(),ce=g.read(ne),Se=a.toUTF8(ce),Ie=g.readVarIntNum();let me;if(Ie>=0){const Ne=g.read(Ie);me=a.toUTF8(Ne)}const xe=g.readVarIntNum(),ke=[];if(xe>=0)for(let Ne=0;Ne<xe;Ne++){const We=g.readVarIntNum(),dt=g.read(We);ke.push(a.toUTF8(dt))}const Re=g.readVarIntNum();let Ce;if(Re>=0){const Ne=g.read(Re);Ce=a.toUTF8(Ne)}D.outputs.push({outputIndex:K,satoshis:$,lockingScript:z,spendable:G,outputDescription:Se,basket:me,tags:ke,customInstructions:Ce})}}_.push(D)}return{totalActions:v,actions:_}}async internalizeAction(f,m){var d,y,b;const g=new a.Writer;g.writeVarIntNum(f.tx.length),g.write(f.tx),g.writeVarIntNum(f.outputs.length);for(const _ of f.outputs)if(g.writeVarIntNum(_.outputIndex),_.protocol==="wallet payment"){if(_.paymentRemittance==null)throw new Error("Payment remittance is required for wallet payment");g.writeUInt8(1),g.write(a.toArray(_.paymentRemittance.senderIdentityKey,"hex"));const S=a.toArray(_.paymentRemittance.derivationPrefix,"base64");g.writeVarIntNum(S.length),g.write(S);const I=a.toArray(_.paymentRemittance.derivationSuffix,"base64");g.writeVarIntNum(I.length),g.write(I)}else{g.writeUInt8(2);const S=a.toArray((d=_.insertionRemittance)===null||d===void 0?void 0:d.basket,"utf8");if(g.writeVarIntNum(S.length),g.write(S),typeof((y=_.insertionRemittance)===null||y===void 0?void 0:y.customInstructions)=="string"&&_.insertionRemittance.customInstructions!==""){const I=a.toArray(_.insertionRemittance.customInstructions,"utf8");g.writeVarIntNum(I.length),g.write(I)}else g.writeVarIntNum(-1);if(typeof((b=_.insertionRemittance)===null||b===void 0?void 0:b.tags)=="object"){g.writeVarIntNum(_.insertionRemittance.tags.length);for(const I of _.insertionRemittance.tags){const A=a.toArray(I,"utf8");g.writeVarIntNum(A.length),g.write(A)}}else g.writeVarIntNum(0)}if(typeof f.labels=="object"){g.writeVarIntNum(f.labels.length);for(const _ of f.labels){const S=a.toArray(_,"utf8");g.writeVarIntNum(S.length),g.write(S)}}else g.writeVarIntNum(-1);const v=a.toArray(f.description);return g.writeVarIntNum(v.length),g.write(v),g.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),await this.transmit("internalizeAction",m,g.toArray()),{accepted:!0}}async listOutputs(f,m){const d=new a.Writer,y=a.toArray(f.basket,"utf8");if(d.writeVarIntNum(y.length),d.write(y),typeof f.tags=="object"){d.writeVarIntNum(f.tags.length);for(const A of f.tags){const R=a.toArray(A,"utf8");d.writeVarIntNum(R.length),d.write(R)}}else d.writeVarIntNum(0);f.tagQueryMode==="all"?d.writeInt8(1):f.tagQueryMode==="any"?d.writeInt8(2):d.writeInt8(-1),f.include==="locking scripts"?d.writeInt8(1):f.include==="entire transactions"?d.writeInt8(2):d.writeInt8(-1),typeof f.includeCustomInstructions=="boolean"?d.writeInt8(f.includeCustomInstructions?1:0):d.writeInt8(-1),typeof f.includeTags=="boolean"?d.writeInt8(f.includeTags?1:0):d.writeInt8(-1),typeof f.includeLabels=="boolean"?d.writeInt8(f.includeLabels?1:0):d.writeInt8(-1),typeof f.limit=="number"?d.writeVarIntNum(f.limit):d.writeVarIntNum(-1),typeof f.offset=="number"?d.writeVarIntNum(f.offset):d.writeVarIntNum(-1),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1);const b=await this.transmit("listOutputs",m,d.toArray()),g=new a.Reader(b),v=g.readVarIntNum(),_=g.readVarIntNum();let S;_>=0&&(S=g.read(_));const I=[];for(let A=0;A<v;A++){const R=this.readOutpoint(g),E=g.readVarIntNum(),k={spendable:!0,outpoint:R,satoshis:E},P=g.readVarIntNum();P>=0&&(k.lockingScript=a.toHex(g.read(P)));const T=g.readVarIntNum();T>=0&&(k.customInstructions=a.toUTF8(g.read(T)));const M=g.readVarIntNum();if(M!==-1){const D=[];for(let F=0;F<M;F++){const B=g.readVarIntNum();D.push(a.toUTF8(g.read(B)))}k.tags=D}const C=g.readVarIntNum();if(C!==-1){const D=[];for(let F=0;F<C;F++){const B=g.readVarIntNum();D.push(a.toUTF8(g.read(B)))}k.labels=D}I.push(k)}return{totalOutputs:v,BEEF:S,outputs:I}}async relinquishOutput(f,m){const d=new a.Writer,y=a.toArray(f.basket,"utf8");return d.writeVarIntNum(y.length),d.write(y),d.write(this.encodeOutpoint(f.output)),await this.transmit("relinquishOutput",m,d.toArray()),{relinquished:!0}}encodeOutpoint(f){const m=new a.Writer,[d,y]=f.split(".");return m.write(a.toArray(d,"hex")),m.writeVarIntNum(Number(y)),m.toArray()}readOutpoint(f){const m=a.toHex(f.read(32)),d=f.readVarIntNum();return`${m}.${d}`}async getPublicKey(f,m){var d,y;const b=new a.Writer;b.writeUInt8(f.identityKey?1:0),f.identityKey?b.write(this.encodePrivilegedParams(f.privileged,f.privilegedReason)):(b.write(this.encodeKeyRelatedParams((d=f.protocolID)!==null&&d!==void 0?d:f.protocolID=[t.SecurityLevels.Silent,"default"],(y=f.keyID)!==null&&y!==void 0?y:f.keyID="",f.counterparty,f.privileged,f.privilegedReason)),typeof f.forSelf=="boolean"?b.writeInt8(f.forSelf?1:0):b.writeInt8(-1)),b.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1);const g=await this.transmit("getPublicKey",m,b.toArray());return{publicKey:a.toHex(g)}}async revealCounterpartyKeyLinkage(f,m){const d=new a.Writer;d.write(this.encodePrivilegedParams(f.privileged,f.privilegedReason)),d.write(a.toArray(f.counterparty,"hex")),d.write(a.toArray(f.verifier,"hex"));const y=await this.transmit("revealCounterpartyKeyLinkage",m,d.toArray()),b=new a.Reader(y),g=a.toHex(b.read(33)),v=a.toHex(b.read(33)),_=a.toHex(b.read(33)),S=b.readVarIntNum(),I=a.toUTF8(b.read(S)),A=b.readVarIntNum(),R=b.read(A),E=b.readVarIntNum(),k=b.read(E);return{prover:g,verifier:v,counterparty:_,revelationTime:I,encryptedLinkage:R,encryptedLinkageProof:k}}async revealSpecificKeyLinkage(f,m){const d=new a.Writer;d.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),d.write(a.toArray(f.verifier,"hex"));const y=await this.transmit("revealSpecificKeyLinkage",m,d.toArray()),b=new a.Reader(y),g=a.toHex(b.read(33)),v=a.toHex(b.read(33)),_=a.toHex(b.read(33)),S=b.readUInt8(),I=b.readVarIntNum(),A=a.toUTF8(b.read(I)),R=b.readVarIntNum(),E=a.toUTF8(b.read(R)),k=b.readVarIntNum(),P=b.read(k),T=b.readVarIntNum(),M=b.read(T),C=b.readUInt8();return{prover:g,verifier:v,counterparty:_,protocolID:[S,A],keyID:E,encryptedLinkage:P,encryptedLinkageProof:M,proofType:C}}async encrypt(f,m){const d=new a.Writer;return d.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),d.writeVarIntNum(f.plaintext.length),d.write(f.plaintext),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),{ciphertext:await this.transmit("encrypt",m,d.toArray())}}async decrypt(f,m){const d=new a.Writer;return d.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),d.writeVarIntNum(f.ciphertext.length),d.write(f.ciphertext),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),{plaintext:await this.transmit("decrypt",m,d.toArray())}}async createHmac(f,m){const d=new a.Writer;return d.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),d.writeVarIntNum(f.data.length),d.write(f.data),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),{hmac:await this.transmit("createHmac",m,d.toArray())}}async verifyHmac(f,m){const d=new a.Writer;return d.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),d.write(f.hmac),d.writeVarIntNum(f.data.length),d.write(f.data),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),await this.transmit("verifyHmac",m,d.toArray()),{valid:!0}}async createSignature(f,m){var d;const y=new a.Writer;return y.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),typeof f.data=="object"?(y.writeUInt8(1),y.writeVarIntNum(f.data.length),y.write(f.data)):(y.writeUInt8(2),y.write((d=f.hashToDirectlySign)!==null&&d!==void 0?d:f.hashToDirectlySign=[])),y.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),{signature:await this.transmit("createSignature",m,y.toArray())}}async verifySignature(f,m){var d;const y=new a.Writer;return y.write(this.encodeKeyRelatedParams(f.protocolID,f.keyID,f.counterparty,f.privileged,f.privilegedReason)),typeof f.forSelf=="boolean"?y.writeInt8(f.forSelf?1:0):y.writeInt8(-1),y.writeVarIntNum(f.signature.length),y.write(f.signature),typeof f.data=="object"?(y.writeUInt8(1),y.writeVarIntNum(f.data.length),y.write(f.data)):(y.writeUInt8(2),y.write((d=f.hashToDirectlyVerify)!==null&&d!==void 0?d:[])),y.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1),await this.transmit("verifySignature",m,y.toArray()),{valid:!0}}encodeKeyRelatedParams(f,m,d,y,b){const g=new a.Writer;g.writeUInt8(f[0]);const v=a.toArray(f[1],"utf8");g.writeVarIntNum(v.length),g.write(v);const _=a.toArray(m,"utf8");return g.writeVarIntNum(_.length),g.write(_),typeof d!="string"?g.writeUInt8(0):d==="self"?g.writeUInt8(11):d==="anyone"?g.writeUInt8(12):g.write(a.toArray(d,"hex")),g.write(this.encodePrivilegedParams(y,b)),g.toArray()}async acquireCertificate(f,m){var d,y,b;const g=new a.Writer;g.write(a.toArray(f.type,"base64")),g.write(a.toArray(f.certifier,"hex"));const v=Object.entries(f.fields);g.writeVarIntNum(v.length);for(const[I,A]of v){const R=a.toArray(I,"utf8"),E=a.toArray(A,"utf8");g.writeVarIntNum(R.length),g.write(R),g.writeVarIntNum(E.length),g.write(E)}if(g.write(this.encodePrivilegedParams(f.privileged,f.privilegedReason)),g.writeUInt8(f.acquisitionProtocol==="direct"?1:2),f.acquisitionProtocol==="direct"){g.write(a.toArray(f.serialNumber,"base64")),g.write(this.encodeOutpoint((d=f.revocationOutpoint)!==null&&d!==void 0?d:""));const I=a.toArray(f.signature,"hex");g.writeVarIntNum(I.length),g.write(I);const A=f.keyringRevealer!=="certifier"?a.toArray(f.keyringRevealer,"hex"):[11];g.write(A);const R=Object.keys((y=f.keyringForSubject)!==null&&y!==void 0?y:{});g.writeVarIntNum(R.length);for(let E=0;E<R.length;E++){const k=a.toArray(R[E],"utf8");g.writeVarIntNum(k.length),g.write(k);const P=a.toArray((b=f.keyringForSubject)===null||b===void 0?void 0:b[R[E]],"base64");g.writeVarIntNum(P.length),g.write(P)}}else{const I=a.toArray(f.certifierUrl,"utf8");g.writeVarIntNum(I.length),g.write(I)}const _=await this.transmit("acquireCertificate",m,g.toArray()),S=s.default.fromBinary(_);return{...S,signature:S.signature}}encodePrivilegedParams(f,m){const d=new a.Writer;if(typeof f=="boolean"?d.writeInt8(f?1:0):d.writeInt8(-1),typeof m=="string"){const y=a.toArray(m,"utf8");d.writeInt8(y.length),d.write(y)}else d.writeInt8(-1);return d.toArray()}async listCertificates(f,m){const d=new a.Writer;d.writeVarIntNum(f.certifiers.length);for(let _=0;_<f.certifiers.length;_++)d.write(a.toArray(f.certifiers[_],"hex"));d.writeVarIntNum(f.types.length);for(let _=0;_<f.types.length;_++)d.write(a.toArray(f.types[_],"base64"));typeof f.limit=="number"?d.writeVarIntNum(f.limit):d.writeVarIntNum(-1),typeof f.offset=="number"?d.writeVarIntNum(f.offset):d.writeVarIntNum(-1),d.write(this.encodePrivilegedParams(f.privileged,f.privilegedReason));const y=await this.transmit("listCertificates",m,d.toArray()),b=new a.Reader(y),g=b.readVarIntNum(),v=[];for(let _=0;_<g;_++){const S=b.readVarIntNum(),I=b.read(S),A=s.default.fromBinary(I);v.push({...A,signature:A.signature})}return{totalCertificates:g,certificates:v}}async proveCertificate(f,m){var d,y;const b=new a.Writer,g=a.toArray(f.certificate.type,"base64");b.write(g);const v=a.toArray(f.certificate.subject,"hex");b.write(v);const _=a.toArray(f.certificate.serialNumber,"base64");b.write(_);const S=a.toArray(f.certificate.certifier,"hex");b.write(S);const I=this.encodeOutpoint((d=f.certificate.revocationOutpoint)!==null&&d!==void 0?d:"");b.write(I);const A=a.toArray(f.certificate.signature,"hex");b.writeVarIntNum(A.length),b.write(A);const R=Object.entries((y=f.certificate.fields)!==null&&y!==void 0?y:{});b.writeVarIntNum(R.length);for(const[M,C]of R){const D=a.toArray(M,"utf8"),F=a.toArray(C,"utf8");b.writeVarIntNum(D.length),b.write(D),b.writeVarIntNum(F.length),b.write(F)}b.writeVarIntNum(f.fieldsToReveal.length);for(const M of f.fieldsToReveal){const C=a.toArray(M,"utf8");b.writeVarIntNum(C.length),b.write(C)}b.write(a.toArray(f.verifier,"hex")),b.write(this.encodePrivilegedParams(f.privileged,f.privilegedReason));const E=await this.transmit("proveCertificate",m,b.toArray()),k=new a.Reader(E),P=k.readVarIntNum(),T={};for(let M=0;M<P;M++){const C=k.readVarIntNum(),D=a.toUTF8(k.read(C)),F=k.readVarIntNum();T[D]=a.toBase64(k.read(F))}return{keyringForVerifier:T}}async relinquishCertificate(f,m){const d=new a.Writer,y=a.toArray(f.type,"base64");d.write(y);const b=a.toArray(f.serialNumber,"base64");d.write(b);const g=a.toArray(f.certifier,"hex");return d.write(g),await this.transmit("relinquishCertificate",m,d.toArray()),{relinquished:!0}}parseDiscoveryResult(f){const m=new a.Reader(f),d=m.readVarIntNum(),y=[];for(let b=0;b<d;b++){const g=m.readVarIntNum(),v=m.read(g),_=s.default.fromBinary(v),S=m.readVarIntNum(),I=a.toUTF8(m.read(S)),A=m.readVarIntNum(),R=a.toUTF8(m.read(A)),E=m.readVarIntNum(),k=a.toUTF8(m.read(E)),P=m.readUInt8(),T={},M=m.readVarIntNum();for(let F=0;F<M;F++){const B=m.readVarIntNum(),L=a.toUTF8(m.read(B)),q=m.readVarIntNum();T[L]=m.read(q)}const C={},D=m.readVarIntNum();for(let F=0;F<D;F++){const B=m.readVarIntNum(),L=a.toUTF8(m.read(B)),q=m.readVarIntNum();C[L]=a.toUTF8(m.read(q))}y.push({..._,signature:_.signature,certifierInfo:{iconUrl:R,name:I,description:k,trust:P},publiclyRevealedKeyring:T,decryptedFields:C})}return{totalCertificates:d,certificates:y}}async discoverByIdentityKey(f,m){const d=new a.Writer;d.write(a.toArray(f.identityKey,"hex")),typeof f.limit=="number"?d.writeVarIntNum(f.limit):d.writeVarIntNum(-1),typeof f.offset=="number"?d.writeVarIntNum(f.offset):d.writeVarIntNum(-1),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1);const y=await this.transmit("discoverByIdentityKey",m,d.toArray());return this.parseDiscoveryResult(y)}async discoverByAttributes(f,m){const d=new a.Writer,y=Object.keys(f.attributes);d.writeVarIntNum(y.length);for(let g=0;g<y.length;g++)d.writeVarIntNum(y[g].length),d.write(a.toArray(y[g],"utf8")),d.writeVarIntNum(f.attributes[y[g]].length),d.write(a.toArray(f.attributes[y[g]],"utf8"));typeof f.limit=="number"?d.writeVarIntNum(f.limit):d.writeVarIntNum(-1),typeof f.offset=="number"?d.writeVarIntNum(f.offset):d.writeVarIntNum(-1),d.writeInt8(typeof f.seekPermission=="boolean"?f.seekPermission?1:0:-1);const b=await this.transmit("discoverByAttributes",m,d.toArray());return this.parseDiscoveryResult(b)}async isAuthenticated(f,m){return{authenticated:(await this.transmit("isAuthenticated",m))[0]===1}}async waitForAuthentication(f,m){return await this.transmit("waitForAuthentication",m),{authenticated:!0}}async getHeight(f,m){const d=await this.transmit("getHeight",m);return{height:new a.Reader(d).readVarIntNum()}}async getHeaderForHeight(f,m){const d=new a.Writer;d.writeVarIntNum(f.height);const y=await this.transmit("getHeaderForHeight",m,d.toArray());return{header:a.toHex(y)}}async getNetwork(f,m){return{network:(await this.transmit("getNetwork",m))[0]===0?"mainnet":"testnet"}}async getVersion(f,m){const d=await this.transmit("getVersion",m);return{version:a.toUTF8(d)}}};return Ni.default=l,Ni}var Mi={},TI;function $6(){if(TI)return Mi;TI=1;var i=Mi&&Mi.__createBinding||(Object.create?function(c,u,l,h){h===void 0&&(h=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(c,h,f)}:function(c,u,l,h){h===void 0&&(h=l),c[h]=u[l]}),e=Mi&&Mi.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),n=Mi&&Mi.__importStar||function(c){if(c&&c.__esModule)return c;var u={};if(c!=null)for(var l in c)l!=="default"&&Object.prototype.hasOwnProperty.call(c,l)&&i(u,c,l);return e(u,c),u},r=Mi&&Mi.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Mi,"__esModule",{value:!0});const t=r(F0()),s=n(Ze());let a=class{constructor(u,l="http://localhost:3301",h=fetch){this.baseUrl=l,this.httpClient=h,this.originator=u}async transmitToWallet(u){const l=new s.Reader(u),h=l.readUInt8(),f=t.default[h];if(f===void 0||f==="")throw new Error(`Invalid call code: ${h}`);const m=l.readUInt8();let d;if(m>0){const v=l.read(m);d=s.toUTF8(v)}const y=l.read(),g=await(await fetch(`${this.baseUrl}/${f}`,{method:"POST",headers:{"Content-Type":"application/octet-stream",Origin:d??""},body:new Uint8Array(y)})).arrayBuffer();return Array.from(new Uint8Array(g))}};return Mi.default=a,Mi}var pp={},Vc={},kI;function z6(){if(kI)return Vc;kI=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.WERR_REVIEW_ACTIONS=void 0;let i=class extends Error{constructor(n,r,t,s,a){super("Undelayed createAction or signAction results require review."),this.reviewActionResults=n,this.sendWithResults=r,this.txid=t,this.tx=s,this.noSendChange=a,this.isError=!0,this.code=5,this.name=this.constructor.name}};return Vc.WERR_REVIEW_ACTIONS=i,Vc.default=i,Vc}var Hl={},EI;function FB(){if(EI)return Hl;EI=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.toOriginHeader=void 0;function i(e,n="http"){if(/^[a-z][a-z0-9+.-]*:\/\//i.test(e))try{return new URL(e).origin}catch{}try{return new URL(`${n}://${e}`).origin}catch{throw new Error(`Invalid originator value: ${e}`)}}return Hl.toOriginHeader=i,Hl}var OI;function G6(){if(OI)return pp;OI=1,Object.defineProperty(pp,"__esModule",{value:!0});const i=z6(),e=FB();let n=class{constructor(t,s="http://localhost:3321",a=fetch){this.baseUrl=s,this.originator=t,this.httpClient=a;const c=typeof window<"u"&&typeof document<"u"&&(window==null?void 0:window.origin)!=="file://";this.api=async(u,l)=>{var h;const f=!c&&this.originator?(0,e.toOriginHeader)(this.originator,"http"):void 0;!c&&f===void 0&&console.error("Originator is required in Node.js environments");const m=await await a(`${this.baseUrl}/${u}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...f?{Origin:f}:{},...f?{Originator:f}:{}},body:JSON.stringify(l)}),d=await m.json();if(!m.ok){if(m.status===400&&d.isError&&d.code===5)throw new i.WERR_REVIEW_ACTIONS(d.reviewActionResults,d.sendWithResults,d.txid,d.tx,d.noSendChange);{const y={call:u,args:l,message:(h=d.message)!==null&&h!==void 0?h:`HTTP Client error ${m.status}`};throw new Error(JSON.stringify(y))}}return d}}async createAction(t){return await this.api("createAction",t)}async signAction(t){return await this.api("signAction",t)}async abortAction(t){return await this.api("abortAction",t)}async listActions(t){return await this.api("listActions",t)}async internalizeAction(t){return await this.api("internalizeAction",t)}async listOutputs(t){return await this.api("listOutputs",t)}async relinquishOutput(t){return await this.api("relinquishOutput",t)}async getPublicKey(t){return await this.api("getPublicKey",t)}async revealCounterpartyKeyLinkage(t){return await this.api("revealCounterpartyKeyLinkage",t)}async revealSpecificKeyLinkage(t){return await this.api("revealSpecificKeyLinkage",t)}async encrypt(t){return await this.api("encrypt",t)}async decrypt(t){return await this.api("decrypt",t)}async createHmac(t){return await this.api("createHmac",t)}async verifyHmac(t){return await this.api("verifyHmac",t)}async createSignature(t){return await this.api("createSignature",t)}async verifySignature(t){return await this.api("verifySignature",t)}async acquireCertificate(t){return await this.api("acquireCertificate",t)}async listCertificates(t){return await this.api("listCertificates",t)}async proveCertificate(t){return await this.api("proveCertificate",t)}async relinquishCertificate(t){return await this.api("relinquishCertificate",t)}async discoverByIdentityKey(t){return await this.api("discoverByIdentityKey",t)}async discoverByAttributes(t){return await this.api("discoverByAttributes",t)}async isAuthenticated(t){return await this.api("isAuthenticated",t)}async waitForAuthentication(t){return await this.api("waitForAuthentication",t)}async getHeight(t){return await this.api("getHeight",t)}async getHeaderForHeight(t){return await this.api("getHeaderForHeight",t)}async getNetwork(t){return await this.api("getNetwork",t)}async getVersion(t){return await this.api("getVersion",t)}};return pp.default=n,pp}var Bi={},AI;function X6(){if(AI)return Bi;AI=1;var i=Bi&&Bi.__createBinding||(Object.create?function(u,l,h,f){f===void 0&&(f=h);var m=Object.getOwnPropertyDescriptor(l,h);(!m||("get"in m?!l.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(u,f,m)}:function(u,l,h,f){f===void 0&&(f=h),u[f]=l[h]}),e=Bi&&Bi.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),n=Bi&&Bi.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h in u)h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)&&i(l,u,h);return e(l,u),l},r=Bi&&Bi.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Bi,"__esModule",{value:!0});const t=r(Ln()),s=n(Ze()),a=yf();let c=class{constructor(l="*"){if(typeof window!="object")throw new Error("The XDM substrate requires a global window object.");if(!window.hasOwnProperty("ReactNativeWebView"))throw new Error("The window object does not have a ReactNativeWebView property.");if(typeof window.ReactNativeWebView.postMessage!="function")throw new Error("The window.ReactNativeWebView property does not seem to support postMessage calls.");this.domain=l}async invoke(l,h){return await new Promise((f,m)=>{const d=s.toBase64((0,t.default)(12)),y=b=>{const g=JSON.parse(b.data);if(!(g.type!=="CWI"||g.id!==d||g.isInvocation===!0))if(typeof window.removeEventListener=="function"&&window.removeEventListener("message",y),g.status==="error"){const v=new a.WalletError(g.description,g.code);m(v)}else f(g.result)};window.addEventListener("message",y),window.ReactNativeWebView.postMessage(JSON.stringify({type:"CWI",isInvocation:!0,id:d,call:l,args:h}))})}async createAction(l){return await this.invoke("createAction",l)}async signAction(l){return await this.invoke("signAction",l)}async abortAction(l){return await this.invoke("abortAction",l)}async listActions(l){return await this.invoke("listActions",l)}async internalizeAction(l){return await this.invoke("internalizeAction",l)}async listOutputs(l){return await this.invoke("listOutputs",l)}async relinquishOutput(l){return await this.invoke("relinquishOutput",l)}async getPublicKey(l){return await this.invoke("getPublicKey",l)}async revealCounterpartyKeyLinkage(l){return await this.invoke("revealCounterpartyKeyLinkage",l)}async revealSpecificKeyLinkage(l){return await this.invoke("revealSpecificKeyLinkage",l)}async encrypt(l){return await this.invoke("encrypt",l)}async decrypt(l){return await this.invoke("decrypt",l)}async createHmac(l){return await this.invoke("createHmac",l)}async verifyHmac(l){return await this.invoke("verifyHmac",l)}async createSignature(l){return await this.invoke("createSignature",l)}async verifySignature(l){return await this.invoke("verifySignature",l)}async acquireCertificate(l){return await this.invoke("acquireCertificate",l)}async listCertificates(l){return await this.invoke("listCertificates",l)}async proveCertificate(l){return await this.invoke("proveCertificate",l)}async relinquishCertificate(l){return await this.invoke("relinquishCertificate",l)}async discoverByIdentityKey(l){return await this.invoke("discoverByIdentityKey",l)}async discoverByAttributes(l){return await this.invoke("discoverByAttributes",l)}async isAuthenticated(l){return await this.invoke("isAuthenticated",l)}async waitForAuthentication(l){return await this.invoke("waitForAuthentication",l)}async getHeight(l){return await this.invoke("getHeight",l)}async getHeaderForHeight(l){return await this.invoke("getHeaderForHeight",l)}async getNetwork(l){return await this.invoke("getNetwork",l)}async getVersion(l){return await this.invoke("getVersion",l)}};return Bi.default=c,Bi}var PI;function Y6(){if(PI)return jc;PI=1;var i=jc&&jc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(jc,"__esModule",{value:!0});const e=i(j6()),n=i(V6()),r=i(W6()),t=i($6()),s=i(G6()),a=i(X6()),c=200;let u=class{constructor(h="auto",f){h==="Cicada"&&(h=new r.default(new t.default(f))),h==="window.CWI"&&(h=new e.default),h==="XDM"&&(h=new n.default),h==="json-api"&&(h=new s.default(f)),h==="react-native"&&(h=new a.default(f)),this.substrate=h,this.originator=f}async connectToSubstrate(){if(typeof this.substrate=="object")return;let h;const f=async m=>{let d;if(typeof m=="number"?d=await Promise.race([h.getVersion({}),new Promise((y,b)=>setTimeout(()=>b(new Error("Timed out.")),m))]):d=await h.getVersion({}),typeof d!="object"||typeof d.version!="string")throw new Error("Failed to use substrate.")};try{h=new e.default,await f(),this.substrate=h}catch{try{h=new n.default,await f(c),this.substrate=h}catch{try{h=new r.default(new t.default(this.originator)),await f(),this.substrate=h}catch{try{h=new s.default(this.originator),await f(),this.substrate=h}catch{try{h=new a.default(this.originator),await f(),this.substrate=h}catch{throw new Error("No wallet available over any communication substrate. Install a BSV wallet today!")}}}}}}async createAction(h){return await this.connectToSubstrate(),await this.substrate.createAction(h,this.originator)}async signAction(h){return await this.connectToSubstrate(),await this.substrate.signAction(h,this.originator)}async abortAction(h){return await this.connectToSubstrate(),await this.substrate.abortAction(h,this.originator)}async listActions(h){return await this.connectToSubstrate(),await this.substrate.listActions(h,this.originator)}async internalizeAction(h){return await this.connectToSubstrate(),await this.substrate.internalizeAction(h,this.originator)}async listOutputs(h){return await this.connectToSubstrate(),await this.substrate.listOutputs(h,this.originator)}async relinquishOutput(h){return await this.connectToSubstrate(),await this.substrate.relinquishOutput(h,this.originator)}async getPublicKey(h){return await this.connectToSubstrate(),await this.substrate.getPublicKey(h,this.originator)}async revealCounterpartyKeyLinkage(h){return await this.connectToSubstrate(),await this.substrate.revealCounterpartyKeyLinkage(h,this.originator)}async revealSpecificKeyLinkage(h){return await this.connectToSubstrate(),await this.substrate.revealSpecificKeyLinkage(h,this.originator)}async encrypt(h){return await this.connectToSubstrate(),await this.substrate.encrypt(h,this.originator)}async decrypt(h){return await this.connectToSubstrate(),await this.substrate.decrypt(h,this.originator)}async createHmac(h){return await this.connectToSubstrate(),await this.substrate.createHmac(h,this.originator)}async verifyHmac(h){return await this.connectToSubstrate(),await this.substrate.verifyHmac(h,this.originator)}async createSignature(h){return await this.connectToSubstrate(),await this.substrate.createSignature(h,this.originator)}async verifySignature(h){return await this.connectToSubstrate(),await this.substrate.verifySignature(h,this.originator)}async acquireCertificate(h){return await this.connectToSubstrate(),await this.substrate.acquireCertificate(h,this.originator)}async listCertificates(h){return await this.connectToSubstrate(),await this.substrate.listCertificates(h,this.originator)}async proveCertificate(h){return await this.connectToSubstrate(),await this.substrate.proveCertificate(h,this.originator)}async relinquishCertificate(h){return await this.connectToSubstrate(),await this.substrate.relinquishCertificate(h,this.originator)}async discoverByIdentityKey(h){return await this.connectToSubstrate(),await this.substrate.discoverByIdentityKey(h,this.originator)}async discoverByAttributes(h){return await this.connectToSubstrate(),await this.substrate.discoverByAttributes(h,this.originator)}async isAuthenticated(h={}){return await this.connectToSubstrate(),await this.substrate.isAuthenticated(h,this.originator)}async waitForAuthentication(h={}){return await this.connectToSubstrate(),await this.substrate.waitForAuthentication(h,this.originator)}async getHeight(h={}){return await this.connectToSubstrate(),await this.substrate.getHeight(h,this.originator)}async getHeaderForHeight(h){return await this.connectToSubstrate(),await this.substrate.getHeaderForHeight(h,this.originator)}async getNetwork(h={}){return await this.connectToSubstrate(),await this.substrate.getNetwork(h,this.originator)}async getVersion(h={}){return await this.connectToSubstrate(),await this.substrate.getVersion(h,this.originator)}};return jc.default=u,jc}var ba={},Sb={},RI;function UB(){return RI||(RI=1,Object.defineProperty(Sb,"__esModule",{value:!0})),Sb}var Di={},NI;function HB(){if(NI)return Di;NI=1;var i=Di&&Di.__createBinding||(Object.create?function(u,l,h,f){f===void 0&&(f=h);var m=Object.getOwnPropertyDescriptor(l,h);(!m||("get"in m?!l.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(u,f,m)}:function(u,l,h,f){f===void 0&&(f=h),u[f]=l[h]}),e=Di&&Di.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),n=Di&&Di.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h in u)h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)&&i(l,u,h);return e(l,u),l},r=Di&&Di.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Di,"__esModule",{value:!0});const t=n(Ze()),s=r(F0()),a=r(Tu());let c=class{constructor(l){this.wallet=l}decodeOutpoint(l){const h=l.read(32),f=t.toHex(h),m=l.readVarIntNum();return`${f}.${m}`}encodeOutpoint(l){const h=new t.Writer,[f,m]=l.split(".");return h.write(t.toArray(f,"hex")),h.writeVarIntNum(Number(m)),h.toArray()}async transmitToWallet(l){const h=new t.Reader(l);try{const f=h.readUInt8(),m=s.default[f];if(m===void 0||m==="")throw new Error(`Invalid call code: ${f}`);const d=h.readUInt8(),y=h.read(d),b=t.toUTF8(y),g=h;switch(m){case"createAction":{const v={},_=g.readVarIntNum(),S=g.read(_);v.description=t.toUTF8(S);const I=g.readVarIntNum();I>=0?v.inputBEEF=g.read(I):v.inputBEEF=void 0;const A=g.readVarIntNum();if(A>=0){v.inputs=[];for(let F=0;F<A;F++){const B={};B.outpoint=this.decodeOutpoint(g);const L=g.readVarIntNum();if(L>=0){const U=g.read(L);B.unlockingScript=t.toHex(U)}else{B.unlockingScript=void 0;const U=g.readVarIntNum();B.unlockingScriptLength=U}const q=g.readVarIntNum(),K=g.read(q);B.inputDescription=t.toUTF8(K);const $=g.readVarIntNum();$>=0?B.sequenceNumber=$:B.sequenceNumber=void 0,v.inputs.push(B)}}else v.inputs=void 0;const R=g.readVarIntNum();if(R>=0){v.outputs=[];for(let F=0;F<R;F++){const B={},L=g.readVarIntNum(),q=g.read(L);B.lockingScript=t.toHex(q),B.satoshis=g.readVarIntNum();const K=g.readVarIntNum(),$=g.read(K);B.outputDescription=t.toUTF8($);const U=g.readVarIntNum();if(U>=0){const ne=g.read(U);B.basket=t.toUTF8(ne)}else B.basket=void 0;const z=g.readVarIntNum();if(z>=0){const ne=g.read(z);B.customInstructions=t.toUTF8(ne)}else B.customInstructions=void 0;const G=g.readVarIntNum();if(G>=0){B.tags=[];for(let ne=0;ne<G;ne++){const ce=g.readVarIntNum(),Se=g.read(ce),Ie=t.toUTF8(Se);B.tags.push(Ie)}}else B.tags=void 0;v.outputs.push(B)}}else v.outputs=void 0;const E=g.readVarIntNum();E>=0?v.lockTime=E:v.lockTime=void 0;const k=g.readVarIntNum();k>=0?v.version=k:v.version=void 0;const P=g.readVarIntNum();if(P>=0){v.labels=[];for(let F=0;F<P;F++){const B=g.readVarIntNum(),L=g.read(B),q=t.toUTF8(L);v.labels.push(q)}}else v.labels=void 0;if(g.readInt8()===1){v.options={};const F=g.readInt8();F===-1?v.options.signAndProcess=void 0:v.options.signAndProcess=F===1;const B=g.readInt8();B===-1?v.options.acceptDelayedBroadcast=void 0:v.options.acceptDelayedBroadcast=B===1;const L=g.readInt8();L===-1?v.options.trustSelf=void 0:L===1&&(v.options.trustSelf="known");const q=g.readVarIntNum();if(q>=0){v.options.knownTxids=[];for(let ne=0;ne<q;ne++){const ce=g.read(32),Se=t.toHex(ce);v.options.knownTxids.push(Se)}}else v.options.knownTxids=void 0;const K=g.readInt8();K===-1?v.options.returnTXIDOnly=void 0:v.options.returnTXIDOnly=K===1;const $=g.readInt8();$===-1?v.options.noSend=void 0:v.options.noSend=$===1;const U=g.readVarIntNum();if(U>=0){v.options.noSendChange=[];for(let ne=0;ne<U;ne++){const ce=this.decodeOutpoint(g);v.options.noSendChange.push(ce)}}else v.options.noSendChange=void 0;const z=g.readVarIntNum();if(z>=0){v.options.sendWith=[];for(let ne=0;ne<z;ne++){const ce=g.read(32),Se=t.toHex(ce);v.options.sendWith.push(Se)}}else v.options.sendWith=void 0;const G=g.readInt8();G===-1?v.options.randomizeOutputs=void 0:v.options.randomizeOutputs=G===1}else v.options=void 0;const M=await this.wallet.createAction(v,b),C=new t.Writer;if(M.txid!=null&&M.txid!==""?(C.writeInt8(1),C.write(t.toArray(M.txid,"hex"))):C.writeInt8(0),M.tx!=null?(C.writeInt8(1),C.writeVarIntNum(M.tx.length),C.write(M.tx)):C.writeInt8(0),M.noSendChange!=null){C.writeVarIntNum(M.noSendChange.length);for(const F of M.noSendChange)C.write(this.encodeOutpoint(F))}else C.writeVarIntNum(-1);if(M.sendWithResults!=null){C.writeVarIntNum(M.sendWithResults.length);for(const F of M.sendWithResults){C.write(t.toArray(F.txid,"hex"));let B;F.status==="unproven"?B=1:F.status==="sending"?B=2:F.status==="failed"&&(B=3),C.writeInt8(B)}}else C.writeVarIntNum(-1);if(M.signableTransaction!=null){C.writeInt8(1),C.writeVarIntNum(M.signableTransaction.tx.length),C.write(M.signableTransaction.tx);const F=t.toArray(M.signableTransaction.reference,"base64");C.writeVarIntNum(F.length),C.write(F)}else C.writeInt8(0);const D=new t.Writer;return D.writeUInt8(0),D.write(C.toArray()),D.toArray()}case"signAction":{const v={},_=g.readVarIntNum();v.spends={};for(let P=0;P<_;P++){const T=g.readVarIntNum(),M={},C=g.readVarIntNum(),D=g.read(C);M.unlockingScript=t.toHex(D);const F=g.readVarIntNum();F>=0?M.sequenceNumber=F:M.sequenceNumber=void 0,v.spends[T]=M}const S=g.readVarIntNum(),I=g.read(S);if(v.reference=t.toBase64(I),g.readInt8()===1){v.options={};const P=g.readInt8();P===-1?v.options.acceptDelayedBroadcast=void 0:v.options.acceptDelayedBroadcast=P===1;const T=g.readInt8();T===-1?v.options.returnTXIDOnly=void 0:v.options.returnTXIDOnly=T===1;const M=g.readInt8();M===-1?v.options.noSend=void 0:v.options.noSend=M===1;const C=g.readVarIntNum();if(C>=0){v.options.sendWith=[];for(let D=0;D<C;D++){const F=g.read(32),B=t.toHex(F);v.options.sendWith.push(B)}}else v.options.sendWith=void 0}else v.options=void 0;const R=await this.wallet.signAction(v,b),E=new t.Writer;if(R.txid!=null&&R.txid!==""?(E.writeInt8(1),E.write(t.toArray(R.txid,"hex"))):E.writeInt8(0),R.tx!=null?(E.writeInt8(1),E.writeVarIntNum(R.tx.length),E.write(R.tx)):E.writeInt8(0),R.sendWithResults!=null){E.writeVarIntNum(R.sendWithResults.length);for(const P of R.sendWithResults){E.write(t.toArray(P.txid,"hex"));let T;P.status==="unproven"?T=1:P.status==="sending"?T=2:P.status==="failed"&&(T=3),E.writeInt8(T)}}else E.writeVarIntNum(-1);const k=new t.Writer;return k.writeUInt8(0),k.write(E.toArray()),k.toArray()}case"abortAction":{const v=g.read(),_=t.toBase64(v);await this.wallet.abortAction({reference:_},b);const S=new t.Writer;return S.writeUInt8(0),S.toArray()}case"listActions":{const v={},_=g.readVarIntNum();v.labels=[];for(let M=0;M<_;M++){const C=g.readVarIntNum(),D=g.read(C);v.labels.push(t.toUTF8(D))}const S=g.readInt8();S===-1?v.labelQueryMode=void 0:S===1?v.labelQueryMode="any":S===2&&(v.labelQueryMode="all");const I=["includeLabels","includeInputs","includeInputSourceLockingScripts","includeInputUnlockingScripts","includeOutputs","includeOutputLockingScripts"];for(const M of I){const C=g.readInt8();C===-1?v[M]=void 0:v[M]=C===1}const A=g.readVarIntNum();A>=0?v.limit=A:v.limit=void 0;const R=g.readVarIntNum();R>=0?v.offset=R:v.offset=void 0;const E=g.readInt8();E>=0?v.seekPermission=E===1:v.seekPermission=void 0;const k=await this.wallet.listActions(v,b),P=new t.Writer;P.writeVarIntNum(k.totalActions);for(const M of k.actions){P.write(t.toArray(M.txid,"hex")),P.writeVarIntNum(M.satoshis);let C;switch(M.status){case"completed":C=1;break;case"unprocessed":C=2;break;case"sending":C=3;break;case"unproven":C=4;break;case"unsigned":C=5;break;case"nosend":C=6;break;case"nonfinal":C=7;break;case"failed":C=8;break;default:C=-1;break}P.writeInt8(C),P.writeInt8(M.isOutgoing?1:0);const D=t.toArray(M.description,"utf8");if(P.writeVarIntNum(D.length),P.write(D),M.labels!==void 0){P.writeVarIntNum(M.labels.length);for(const F of M.labels){const B=t.toArray(F,"utf8");P.writeVarIntNum(B.length),P.write(B)}}else P.writeVarIntNum(-1);if(P.writeVarIntNum(M.version),P.writeVarIntNum(M.lockTime),M.inputs!==void 0){P.writeVarIntNum(M.inputs.length);for(const F of M.inputs){if(P.write(this.encodeOutpoint(F.sourceOutpoint)),P.writeVarIntNum(F.sourceSatoshis),F.sourceLockingScript!==void 0){const L=t.toArray(F.sourceLockingScript,"hex");P.writeVarIntNum(L.length),P.write(L)}else P.writeVarIntNum(-1);if(F.unlockingScript!==void 0){const L=t.toArray(F.unlockingScript,"hex");P.writeVarIntNum(L.length),P.write(L)}else P.writeVarIntNum(-1);const B=t.toArray(F.inputDescription,"utf8");P.writeVarIntNum(B.length),P.write(B),P.writeVarIntNum(F.sequenceNumber)}}else P.writeVarIntNum(-1);if(M.outputs!==void 0){P.writeVarIntNum(M.outputs.length);for(const F of M.outputs){if(P.writeVarIntNum(F.outputIndex),P.writeVarIntNum(F.satoshis),F.lockingScript!==void 0){const L=t.toArray(F.lockingScript,"hex");P.writeVarIntNum(L.length),P.write(L)}else P.writeVarIntNum(-1);P.writeInt8(F.spendable?1:0);const B=t.toArray(F.outputDescription,"utf8");if(P.writeVarIntNum(B.length),P.write(B),F.basket!==void 0){const L=t.toArray(F.basket,"utf8");P.writeVarIntNum(L.length),P.write(L)}else P.writeVarIntNum(-1);if(F.tags!==void 0){P.writeVarIntNum(F.tags.length);for(const L of F.tags){const q=t.toArray(L,"utf8");P.writeVarIntNum(q.length),P.write(q)}}else P.writeVarIntNum(-1);if(F.customInstructions!==void 0){const L=t.toArray(F.customInstructions,"utf8");P.writeVarIntNum(L.length),P.write(L)}else P.writeVarIntNum(-1)}}else P.writeVarIntNum(-1)}const T=new t.Writer;return T.writeUInt8(0),T.write(P.toArray()),T.toArray()}case"internalizeAction":{const v={},_=g.readVarIntNum();v.tx=g.read(_);const S=g.readVarIntNum();v.outputs=[];for(let k=0;k<S;k++){const P={};P.outputIndex=g.readVarIntNum();const T=g.readUInt8();if(T===1){P.protocol="wallet payment",P.paymentRemittance={};const M=g.read(33);P.paymentRemittance.senderIdentityKey=t.toHex(M);const C=g.readVarIntNum(),D=g.read(C);P.paymentRemittance.derivationPrefix=t.toBase64(D);const F=g.readVarIntNum(),B=g.read(F);P.paymentRemittance.derivationSuffix=t.toBase64(B)}else if(T===2){P.protocol="basket insertion",P.insertionRemittance={};const M=g.readVarIntNum(),C=g.read(M);P.insertionRemittance.basket=t.toUTF8(C);const D=g.readVarIntNum();if(D>=0){const B=g.read(D);P.insertionRemittance.customInstructions=t.toUTF8(B)}const F=g.readVarIntNum();if(F>0){P.insertionRemittance.tags=[];for(let B=0;B<F;B++){const L=g.readVarIntNum(),q=g.read(L);P.insertionRemittance.tags.push(t.toUTF8(q))}}else P.insertionRemittance.tags=[]}v.outputs.push(P)}const I=g.readVarIntNum();if(I>=0){v.labels=[];for(let k=0;k<I;k++){const P=g.readVarIntNum();v.labels.push(t.toUTF8(g.read(P)))}}const A=g.readVarIntNum();v.description=t.toUTF8(g.read(A));const R=g.readInt8();R>=0?v.seekPermission=R===1:v.seekPermission=void 0,await this.wallet.internalizeAction(v,b);const E=new t.Writer;return E.writeUInt8(0),E.toArray()}case"listOutputs":{const v={},_=g.readVarIntNum(),S=g.read(_);v.basket=t.toUTF8(S);const I=g.readVarIntNum();if(I>0){v.tags=[];for(let L=0;L<I;L++){const q=g.readVarIntNum(),K=g.read(q);v.tags.push(t.toUTF8(K))}}else v.tags=void 0;const A=g.readInt8();A===1?v.tagQueryMode="all":A===2?v.tagQueryMode="any":v.tagQueryMode=void 0;const R=g.readInt8();R===1?v.include="locking scripts":R===2?v.include="entire transactions":v.include=void 0;const E=g.readInt8();E===-1?v.includeCustomInstructions=void 0:v.includeCustomInstructions=E===1;const k=g.readInt8();k===-1?v.includeTags=void 0:v.includeTags=k===1;const P=g.readInt8();P===-1?v.includeLabels=void 0:v.includeLabels=P===1;const T=g.readVarIntNum();T>=0?v.limit=T:v.limit=void 0;const M=g.readVarIntNum();M>=0?v.offset=M:v.offset=void 0;const C=g.readInt8();C>=0?v.seekPermission=C===1:v.seekPermission=void 0;const D=await this.wallet.listOutputs(v,b),F=new t.Writer;F.writeVarIntNum(D.totalOutputs),D.BEEF!=null?(F.writeVarIntNum(D.BEEF.length),F.write(D.BEEF)):F.writeVarIntNum(-1);for(const L of D.outputs){if(F.write(this.encodeOutpoint(L.outpoint)),F.writeVarIntNum(L.satoshis),L.lockingScript!==void 0){const q=t.toArray(L.lockingScript,"hex");F.writeVarIntNum(q.length),F.write(q)}else F.writeVarIntNum(-1);if(L.customInstructions!==void 0){const q=t.toArray(L.customInstructions,"utf8");F.writeVarIntNum(q.length),F.write(q)}else F.writeVarIntNum(-1);if(L.tags!==void 0){F.writeVarIntNum(L.tags.length);for(const q of L.tags){const K=t.toArray(q,"utf8");F.writeVarIntNum(K.length),F.write(K)}}else F.writeVarIntNum(-1);if(L.labels!==void 0){F.writeVarIntNum(L.labels.length);for(const q of L.labels){const K=t.toArray(q,"utf8");F.writeVarIntNum(K.length),F.write(K)}}else F.writeVarIntNum(-1)}const B=new t.Writer;return B.writeUInt8(0),B.write(F.toArray()),B.toArray()}case"relinquishOutput":{const v={},_=g.readVarIntNum(),S=g.read(_);v.basket=t.toUTF8(S),v.output=this.decodeOutpoint(g),await this.wallet.relinquishOutput(v,b);const I=new t.Writer;return I.writeUInt8(0),I.toArray()}case"getPublicKey":{const v={},_=g.readUInt8();if(v.identityKey=_===1,v.identityKey!==!0){v.protocolID=this.decodeProtocolID(g),v.keyID=this.decodeString(g),v.counterparty=this.decodeCounterparty(g);const E=g.readInt8();E===-1?v.privileged=void 0:v.privileged=E===1;const k=g.readInt8();if(k!==-1){const T=g.read(k);v.privilegedReason=t.toUTF8(T)}else v.privilegedReason=void 0;const P=g.readInt8();P===-1?v.forSelf=void 0:v.forSelf=P===1}else{const E=g.readInt8();E===-1?v.privileged=void 0:v.privileged=E===1;const k=g.readInt8();if(k!==-1){const P=g.read(k);v.privilegedReason=t.toUTF8(P)}else v.privilegedReason=void 0}const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const I=await this.wallet.getPublicKey(v,b),A=new t.Writer;A.writeUInt8(0);const R=t.toArray(I.publicKey,"hex");return A.write(R),A.toArray()}case"encrypt":{const v=this.decodeKeyRelatedParams(g),_=g.readVarIntNum();v.plaintext=g.read(_);const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const I=await this.wallet.encrypt(v,b),A=new t.Writer;return A.writeUInt8(0),A.write(I.ciphertext),A.toArray()}case"decrypt":{const v=this.decodeKeyRelatedParams(g),_=g.readVarIntNum();v.ciphertext=g.read(_);const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const I=await this.wallet.decrypt(v,b),A=new t.Writer;return A.writeUInt8(0),A.write(I.plaintext),A.toArray()}case"createHmac":{const v=this.decodeKeyRelatedParams(g),_=g.readVarIntNum();v.data=g.read(_);const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const I=await this.wallet.createHmac(v,b),A=new t.Writer;return A.writeUInt8(0),A.write(I.hmac),A.toArray()}case"verifyHmac":{const v=this.decodeKeyRelatedParams(g);v.hmac=g.read(32);const _=g.readVarIntNum();v.data=g.read(_);const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0,await this.wallet.verifyHmac(v,b);const I=new t.Writer;return I.writeUInt8(0),I.toArray()}case"createSignature":{const v=this.decodeKeyRelatedParams(g),_=g.readUInt8();if(_===1){const R=g.readVarIntNum();v.data=g.read(R)}else _===2&&(v.hashToDirectlySign=g.read(32));const S=g.readInt8();S>=0?v.seekPermission=S===1:v.seekPermission=void 0;const I=await this.wallet.createSignature(v,b),A=new t.Writer;return A.writeUInt8(0),A.write(I.signature),A.toArray()}case"verifySignature":{const v=this.decodeKeyRelatedParams(g),_=g.readInt8();_===-1?v.forSelf=void 0:v.forSelf=_===1;const S=g.readVarIntNum();v.signature=g.read(S);const I=g.readUInt8();if(I===1){const E=g.readVarIntNum();v.data=g.read(E)}else I===2&&(v.hashToDirectlyVerify=g.read(32));const A=g.readInt8();A>=0?v.seekPermission=A===1:v.seekPermission=void 0,await this.wallet.verifySignature(v,b);const R=new t.Writer;return R.writeUInt8(0),R.toArray()}case"isAuthenticated":{const v=await this.wallet.isAuthenticated({},b),_=new t.Writer;return _.writeUInt8(0),_.writeUInt8(v.authenticated?1:0),_.toArray()}case"waitForAuthentication":{await this.wallet.waitForAuthentication({},b);const v=new t.Writer;return v.writeUInt8(0),v.toArray()}case"getHeight":{const v=await this.wallet.getHeight({},b),_=new t.Writer;return _.writeUInt8(0),_.writeVarIntNum(v.height),_.toArray()}case"getHeaderForHeight":{const v={};v.height=g.readVarIntNum();const _=await this.wallet.getHeaderForHeight(v,b),S=new t.Writer;S.writeUInt8(0);const I=t.toArray(_.header,"hex");return S.write(I),S.toArray()}case"getNetwork":{const v=await this.wallet.getNetwork({},b),_=new t.Writer;return _.writeUInt8(0),_.writeUInt8(v.network==="mainnet"?0:1),_.toArray()}case"getVersion":{const v=await this.wallet.getVersion({},b),_=new t.Writer;_.writeUInt8(0);const S=t.toArray(v.version,"utf8");return _.write(S),_.toArray()}case"revealCounterpartyKeyLinkage":{const v={},_=g.readInt8();_===-1?v.privileged=void 0:v.privileged=_===1;const S=g.readInt8();if(S===-1)v.privilegedReason=void 0;else{const T=g.read(S);v.privilegedReason=t.toUTF8(T)}const I=g.read(33);v.counterparty=t.toHex(I);const A=g.read(33);v.verifier=t.toHex(A);const R=await this.wallet.revealCounterpartyKeyLinkage(v,b),E=new t.Writer;E.write(t.toArray(R.prover,"hex")),E.write(t.toArray(R.verifier,"hex")),E.write(t.toArray(R.counterparty,"hex"));const k=t.toArray(R.revelationTime,"utf8");E.writeVarIntNum(k.length),E.write(k),E.writeVarIntNum(R.encryptedLinkage.length),E.write(R.encryptedLinkage),E.writeVarIntNum(R.encryptedLinkageProof.length),E.write(R.encryptedLinkageProof);const P=new t.Writer;return P.writeUInt8(0),P.write(E.toArray()),P.toArray()}case"revealSpecificKeyLinkage":{const v=this.decodeKeyRelatedParams(g),_=g.read(33);v.verifier=t.toHex(_);const S=await this.wallet.revealSpecificKeyLinkage(v,b),I=new t.Writer;I.write(t.toArray(S.prover,"hex")),I.write(t.toArray(S.verifier,"hex")),I.write(t.toArray(S.counterparty,"hex")),I.writeUInt8(S.protocolID[0]);const A=t.toArray(S.protocolID[1],"utf8");I.writeVarIntNum(A.length),I.write(A);const R=t.toArray(S.keyID,"utf8");I.writeVarIntNum(R.length),I.write(R),I.writeVarIntNum(S.encryptedLinkage.length),I.write(S.encryptedLinkage),I.writeVarIntNum(S.encryptedLinkageProof.length),I.write(S.encryptedLinkageProof),I.writeUInt8(S.proofType);const E=new t.Writer;return E.writeUInt8(0),E.write(I.toArray()),E.toArray()}case"acquireCertificate":{const v={},_=g.read(32);v.type=t.toBase64(_);const S=g.read(33);v.certifier=t.toHex(S);const I=g.readVarIntNum();v.fields={};for(let C=0;C<I;C++){const D=g.readVarIntNum(),F=g.read(D),B=t.toUTF8(F),L=g.readVarIntNum(),q=g.read(L),K=t.toUTF8(q);v.fields[B]=K}const A=g.readInt8();A===-1?v.privileged=void 0:v.privileged=A===1;const R=g.readInt8();if(R===-1)v.privilegedReason=void 0;else{const C=g.read(R);v.privilegedReason=t.toUTF8(C)}const E=g.readUInt8();if(v.acquisitionProtocol=E===1?"direct":"issuance",v.acquisitionProtocol==="direct"){const C=g.read(32);v.serialNumber=t.toBase64(C),v.revocationOutpoint=this.decodeOutpoint(g);const D=g.readVarIntNum(),F=g.read(D);v.signature=t.toHex(F);const B=g.readUInt8();if(B===11)v.keyringRevealer="certifier";else{const q=[B].concat(g.read(32));v.keyringRevealer=t.toHex(q)}const L=g.readVarIntNum();v.keyringForSubject={};for(let q=0;q<L;q++){const K=g.readVarIntNum(),$=g.read(K),U=t.toUTF8($),z=g.readVarIntNum(),G=g.read(z),ne=t.toBase64(G);v.keyringForSubject[U]=ne}}else{const C=g.readVarIntNum(),D=g.read(C);v.certifierUrl=t.toUTF8(D)}const k=await this.wallet.acquireCertificate(v,b),T=new a.default(k.type,k.serialNumber,k.subject,k.certifier,k.revocationOutpoint,k.fields,k.signature).toBinary(),M=new t.Writer;return M.writeUInt8(0),M.write(T),M.toArray()}case"listCertificates":{const v={},_=g.readVarIntNum();v.certifiers=[];for(let M=0;M<_;M++){const C=g.read(33);v.certifiers.push(t.toHex(C))}const S=g.readVarIntNum();v.types=[];for(let M=0;M<S;M++){const C=g.read(32);v.types.push(t.toBase64(C))}const I=g.readVarIntNum();I>=0?v.limit=I:v.limit=void 0;const A=g.readVarIntNum();A>=0?v.offset=A:v.offset=void 0;const R=g.readInt8();R===-1?v.privileged=void 0:v.privileged=R===1;const E=g.readInt8();if(E===-1)v.privilegedReason=void 0;else{const M=g.read(E);v.privilegedReason=t.toUTF8(M)}const k=await this.wallet.listCertificates(v,b),P=new t.Writer;P.writeVarIntNum(k.totalCertificates);for(const M of k.certificates){const D=new a.default(M.type,M.serialNumber,M.subject,M.certifier,M.revocationOutpoint,M.fields,M.signature).toBinary();P.writeVarIntNum(D.length),P.write(D)}const T=new t.Writer;return T.writeUInt8(0),T.write(P.toArray()),T.toArray()}case"proveCertificate":{const v={},_={},S=g.read(32);_.type=t.toBase64(S);const I=g.read(33);_.subject=t.toHex(I);const A=g.read(32);_.serialNumber=t.toBase64(A);const R=g.read(33);_.certifier=t.toHex(R),_.revocationOutpoint=this.decodeOutpoint(g);const E=g.readVarIntNum(),k=g.read(E);_.signature=t.toHex(k);const P=g.readVarIntNum();_.fields={};for(let K=0;K<P;K++){const $=g.readVarIntNum(),U=g.read($),z=t.toUTF8(U),G=g.readVarIntNum(),ne=g.read(G),ce=t.toUTF8(ne);_.fields[z]=ce}v.certificate=_;const T=g.readVarIntNum();v.fieldsToReveal=[];for(let K=0;K<T;K++){const $=g.readVarIntNum(),U=g.read($),z=t.toUTF8(U);v.fieldsToReveal.push(z)}const M=g.read(33);v.verifier=t.toHex(M);const C=g.readInt8();C===-1?v.privileged=void 0:v.privileged=C===1;const D=g.readInt8();if(D===-1)v.privilegedReason=void 0;else{const K=g.read(D);v.privilegedReason=t.toUTF8(K)}const F=await this.wallet.proveCertificate(v,b),B=new t.Writer,L=Object.entries(F.keyringForVerifier);B.writeVarIntNum(L.length);for(const[K,$]of L){const U=t.toArray(K,"utf8");B.writeVarIntNum(U.length),B.write(U);const z=t.toArray($,"base64");B.writeVarIntNum(z.length),B.write(z)}const q=new t.Writer;return q.writeUInt8(0),q.write(B.toArray()),q.toArray()}case"relinquishCertificate":{const v={},_=g.read(32);v.type=t.toBase64(_);const S=g.read(32);v.serialNumber=t.toBase64(S);const I=g.read(33);v.certifier=t.toHex(I),await this.wallet.relinquishCertificate(v,b);const A=new t.Writer;return A.writeUInt8(0),A.toArray()}case"discoverByIdentityKey":{const v={},_=g.read(33);v.identityKey=t.toHex(_);const S=g.readVarIntNum();S>=0?v.limit=S:v.limit=void 0;const I=g.readVarIntNum();I>=0?v.offset=I:v.offset=void 0;const A=g.readInt8();A>=0?v.seekPermission=A===1:v.seekPermission=void 0;const R=await this.wallet.discoverByIdentityKey(v,b),E=this.serializeDiscoveryResult(R),k=new t.Writer;return k.writeUInt8(0),k.write(E),k.toArray()}case"discoverByAttributes":{const v={},_=g.readVarIntNum();v.attributes={};for(let P=0;P<_;P++){const T=g.readVarIntNum(),M=g.read(T),C=t.toUTF8(M),D=g.readVarIntNum(),F=g.read(D),B=t.toUTF8(F);v.attributes[C]=B}const S=g.readVarIntNum();S>=0?v.limit=S:v.limit=void 0;const I=g.readVarIntNum();I>=0?v.offset=I:v.offset=void 0;const A=g.readInt8();A>=0?v.seekPermission=A===1:v.seekPermission=void 0;const R=await this.wallet.discoverByAttributes(v,b),E=this.serializeDiscoveryResult(R),k=new t.Writer;return k.writeUInt8(0),k.write(E),k.toArray()}default:throw new Error(`Method ${m} not implemented`)}}catch(f){const m=new t.Writer;m.writeUInt8(typeof f.code=="number"?f.code:1);const d=typeof f.message=="string"?f.message:"Unknown error",y=t.toArray(d,"utf8");m.writeVarIntNum(y.length),m.write(y);const b=typeof f.stack=="string"?f.stack:"",g=t.toArray(b,"utf8");return m.writeVarIntNum(g.length),m.write(g),m.toArray()}}decodeProtocolID(l){const h=l.readUInt8(),f=l.readVarIntNum(),m=l.read(f),d=t.toUTF8(m);return[h,d]}decodeString(l){const h=l.readVarIntNum(),f=l.read(h);return t.toUTF8(f)}decodeCounterparty(l){const h=l.readUInt8();if(h===11)return"self";if(h===12)return"anyone";if(h===0)return;{const f=l.read(32);return t.toHex([h,...f])}}serializeDiscoveryResult(l){const h=new t.Writer;h.writeVarIntNum(l.totalCertificates);for(const f of l.certificates){const d=new a.default(f.type,f.serialNumber,f.subject,f.certifier,f.revocationOutpoint,f.fields,f.signature).toBinary();h.writeVarIntNum(d.length),h.write(d);const y=t.toArray(f.certifierInfo.name,"utf8");h.writeVarIntNum(y.length),h.write(y);const b=t.toArray(f.certifierInfo.iconUrl,"utf8");h.writeVarIntNum(b.length),h.write(b);const g=t.toArray(f.certifierInfo.description,"utf8");h.writeVarIntNum(g.length),h.write(g),h.writeUInt8(f.certifierInfo.trust);const v=Object.entries(f.publiclyRevealedKeyring);h.writeVarIntNum(v.length);for(const[S,I]of v){const A=t.toArray(S,"utf8");h.writeVarIntNum(A.length),h.write(A);const R=t.toArray(I,"base64");h.writeVarIntNum(R.length),h.write(R)}const _=Object.entries(f.decryptedFields);h.writeVarIntNum(_.length);for(const[S,I]of _){const A=t.toArray(S,"utf8");h.writeVarIntNum(A.length),h.write(A);const R=t.toArray(I,"utf8");h.writeVarIntNum(R.length),h.write(R)}}return h.toArray()}decodeKeyRelatedParams(l){const h={};h.protocolID=this.decodeProtocolID(l);const f=l.readVarIntNum(),m=l.read(f);h.keyID=t.toUTF8(m),h.counterparty=this.decodeCounterparty(l);const d=l.readInt8();d===-1?h.privileged=void 0:h.privileged=d===1;const y=l.readInt8();if(y===-1)h.privilegedReason=void 0;else{const b=l.read(y);h.privilegedReason=t.toUTF8(b)}return h}};return Di.default=c,Di}var CI;function Q6(){return CI||(CI=1,function(i){var e=ba&&ba.__createBinding||(Object.create?function(f,m,d,y){y===void 0&&(y=d);var b=Object.getOwnPropertyDescriptor(m,d);(!b||("get"in b?!m.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return m[d]}}),Object.defineProperty(f,y,b)}:function(f,m,d,y){y===void 0&&(y=d),f[y]=m[d]}),n=ba&&ba.__exportStar||function(f,m){for(var d in f)d!=="default"&&!Object.prototype.hasOwnProperty.call(m,d)&&e(m,f,d)},r=ba&&ba.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(i,"__esModule",{value:!0}),i.ReactNativeWebView=i.HTTPWalletJSON=i.HTTPWalletWire=i.WalletWireProcessor=i.WalletWireTransceiver=i.XDM=i.WindowCWISubstrate=void 0;var t=j6();Object.defineProperty(i,"WindowCWISubstrate",{enumerable:!0,get:function(){return r(t).default}});var s=V6();Object.defineProperty(i,"XDM",{enumerable:!0,get:function(){return r(s).default}}),n(UB(),i),n(F0(),i);var a=W6();Object.defineProperty(i,"WalletWireTransceiver",{enumerable:!0,get:function(){return r(a).default}});var c=HB();Object.defineProperty(i,"WalletWireProcessor",{enumerable:!0,get:function(){return r(c).default}});var u=$6();Object.defineProperty(i,"HTTPWalletWire",{enumerable:!0,get:function(){return r(u).default}});var l=G6();Object.defineProperty(i,"HTTPWalletJSON",{enumerable:!0,get:function(){return r(l).default}});var h=X6();Object.defineProperty(i,"ReactNativeWebView",{enumerable:!0,get:function(){return r(h).default}})}(ba)),ba}var MI;function U0(){return MI||(MI=1,function(i){var e=ga&&ga.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),n=ga&&ga.__exportStar||function(l,h){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(h,f)&&e(h,l,f)},r=ga&&ga.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.WERR_REVIEW_ACTIONS=i.WalletErrors=i.WalletClient=i.ProtoWallet=i.CachedKeyDeriver=void 0,n(H6(),i),n(Tw(),i);var t=LB();Object.defineProperty(i,"CachedKeyDeriver",{enumerable:!0,get:function(){return r(t).default}});var s=q6();Object.defineProperty(i,"ProtoWallet",{enumerable:!0,get:function(){return r(s).default}});var a=Y6();Object.defineProperty(i,"WalletClient",{enumerable:!0,get:function(){return r(a).default}});var c=yf();Object.defineProperty(i,"WalletErrors",{enumerable:!0,get:function(){return r(c).default}});var u=z6();Object.defineProperty(i,"WERR_REVIEW_ACTIONS",{enumerable:!0,get:function(){return r(u).default}}),n(yf(),i),n(Q6(),i)}(ga)),ga}var zs={},ma={},ci={},BI;function qB(){if(BI)return ci;BI=1;var i=ci&&ci.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),e=ci&&ci.__setModuleDefault||(Object.create?function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}:function(l,h){l.default=h}),n=ci&&ci.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var f in l)f!=="default"&&Object.prototype.hasOwnProperty.call(l,f)&&i(h,l,f);return e(h,l),h},r=ci&&ci.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(ci,"__esModule",{value:!0}),ci.MasterCertificate=void 0;const t=r(Tu()),s=n(Ze()),a=r(C0()),c=r(Ln());let u=class Z6 extends t.default{constructor(h,f,m,d,y,b,g,v){super(h,f,m,d,y,b,v);for(const _ of Object.keys(b))if(g[_]===void 0||g[_]==="")throw new Error(`Master keyring must contain a value for every field. Missing or empty key for field: "${_}".`);this.masterKeyring=g}static async createCertificateFields(h,f,m,d,y){const b={},g={};for(const[v,_]of Object.entries(m)){const S=a.default.fromRandom(),I=S.encrypt(s.toArray(_,"utf8"));b[v]=s.toBase64(I);const{ciphertext:A}=await h.encrypt({plaintext:S.toArray(),...t.default.getCertificateFieldEncryptionDetails(v),counterparty:f,privileged:d,privilegedReason:y});g[v]=s.toBase64(A)}return{certificateFields:b,masterKeyring:g}}static async createKeyringForVerifier(h,f,m,d,y,b,g,v,_){if(!Array.isArray(y))throw new Error("fieldsToReveal must be an array of strings");const S={};for(const I of y){if(d[I]===void 0||d[I]===null||d[I]==="")throw new Error(`Fields to reveal must be a subset of the certificate fields. Missing the "${I}" field.`);const A=(await this.decryptField(h,b,I,d[I],f,v,_)).fieldRevelationKey,{ciphertext:R}=await h.encrypt({plaintext:A,...t.default.getCertificateFieldEncryptionDetails(I,g),counterparty:m,privileged:v,privilegedReason:_});S[I]=s.toBase64(R)}return S}static async issueCertificateForSubject(h,f,m,d,y=async g=>"Certificate revocation not tracked.",b){const g=b??s.toBase64((0,c.default)(32)),{certificateFields:v,masterKeyring:_}=await this.createCertificateFields(h,f,m),S=await y(g),I=new Z6(d,g,f,(await h.getPublicKey({identityKey:!0})).publicKey,S,v,_);return await I.sign(h),I}static async decryptFields(h,f,m,d,y,b){if(f==null||Object.keys(f).length===0)throw new Error("A MasterCertificate must have a valid masterKeyring!");try{const g={};for(const v of Object.keys(m))g[v]=(await this.decryptField(h,f,v,m[v],d,y,b)).decryptedFieldValue;return g}catch{throw new Error("Failed to decrypt all master certificate fields.")}}static async decryptField(h,f,m,d,y,b,g){if(f==null||Object.keys(f).length===0)throw new Error("A MasterCertificate must have a valid masterKeyring!");try{const{plaintext:v}=await h.decrypt({ciphertext:s.toArray(f[m],"base64"),...t.default.getCertificateFieldEncryptionDetails(m),counterparty:y,privileged:b,privilegedReason:g}),_=new a.default(v).decrypt(s.toArray(d,"base64"));return{fieldRevelationKey:v,decryptedFieldValue:s.toUTF8(_)}}catch{throw new Error("Failed to decrypt certificate field!")}}};return ci.MasterCertificate=u,ci}var ui={},DI;function kw(){if(DI)return ui;DI=1;var i=ui&&ui.__createBinding||(Object.create?function(u,l,h,f){f===void 0&&(f=h);var m=Object.getOwnPropertyDescriptor(l,h);(!m||("get"in m?!l.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return l[h]}}),Object.defineProperty(u,f,m)}:function(u,l,h,f){f===void 0&&(f=h),u[f]=l[h]}),e=ui&&ui.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),n=ui&&ui.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h in u)h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)&&i(l,u,h);return e(l,u),l},r=ui&&ui.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ui,"__esModule",{value:!0}),ui.VerifiableCertificate=void 0;const t=r(C0()),s=n(Ze()),a=r(Tu());let c=class J6 extends a.default{constructor(l,h,f,m,d,y,b,g,v){super(l,h,f,m,d,y,g),this.keyring=b,this.decryptedFields=v}static fromCertificate(l,h){return new J6(l.type,l.serialNumber,l.subject,l.certifier,l.revocationOutpoint,l.fields,h,l.signature)}async decryptFields(l,h,f){if(this.keyring==null||Object.keys(this.keyring).length===0)throw new Error("A keyring is required to decrypt certificate fields for the verifier.");try{const m={};for(const d in this.keyring){const{plaintext:y}=await l.decrypt({ciphertext:s.toArray(this.keyring[d],"base64"),...a.default.getCertificateFieldEncryptionDetails(d,this.serialNumber),counterparty:this.subject,privileged:h,privilegedReason:f}),b=new t.default(y).decrypt(s.toArray(this.fields[d],"base64"));m[d]=s.toUTF8(b)}return m}catch(m){throw new Error(`Failed to decrypt selectively revealed certificate fields using keyring: ${String(m instanceof Error?m.message:m)}`)}}};return ui.VerifiableCertificate=c,ui}var Gs={},LI;function jB(){if(LI)return Gs;LI=1;var i=Gs&&Gs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.CompletedProtoWallet=void 0;const e=i(Iu()),n=U0();let r=class extends n.ProtoWallet{constructor(s){if(super(s),s instanceof n.KeyDeriver)this.keyDeriver=s;else if(typeof s=="string"||s instanceof e.default)this.keyDeriver=new n.KeyDeriver(s);else throw new Error("Invalid key deriver provided")}async isAuthenticated(){throw new Error("not implemented")}async waitForAuthentication(){throw new Error("not implemented")}async getNetwork(){throw new Error("not implemented")}async getVersion(){throw new Error("not implemented")}async getPublicKey(s){if(s.privileged===!0)throw new Error("no privilege support");if(s.identityKey===!0){if(this.keyDeriver===null||this.keyDeriver===void 0)throw new Error("keyDeriver is not initialized");return{publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}else{if(s.protocolID==null||typeof s.keyID!="string"||s.keyID.trim()==="")throw new Error("protocolID and keyID are required if identityKey is false or undefined.");if(this.keyDeriver===null||this.keyDeriver===void 0)throw new Error("keyDeriver is not initialized");return{publicKey:this.keyDeriver.derivePublicKey(s.protocolID,s.keyID,typeof s.counterparty=="string"&&s.counterparty.trim()!==""?s.counterparty:"self",!!s.forSelf).toString()}}}async createAction(){throw new Error("not implemented")}async signAction(){throw new Error("not implemented")}async abortAction(){throw new Error("not implemented")}async listActions(){throw new Error("not implemented")}async internalizeAction(){throw new Error("not implemented")}async listOutputs(){throw new Error("not implemented")}async relinquishOutput(){throw new Error("not implemented")}async acquireCertificate(){throw new Error("not implemented")}async listCertificates(){throw new Error("not implemented")}async proveCertificate(){throw new Error("not implemented")}async relinquishCertificate(){throw new Error("not implemented")}async discoverByIdentityKey(){throw new Error("not implemented")}async discoverByAttributes(){throw new Error("not implemented")}async getHeight(){throw new Error("not implemented")}async getHeaderForHeight(){throw new Error("not implemented")}};return Gs.CompletedProtoWallet=r,Gs}var FI;function VB(){return FI||(FI=1,function(i){var e=ma&&ma.__createBinding||(Object.create?function(s,a,c,u){u===void 0&&(u=c);var l=Object.getOwnPropertyDescriptor(a,c);(!l||("get"in l?!a.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,u,l)}:function(s,a,c,u){u===void 0&&(u=c),s[u]=a[c]}),n=ma&&ma.__exportStar||function(s,a){for(var c in s)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,s,c)},r=ma&&ma.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i,"__esModule",{value:!0}),i.Certificate=void 0;var t=Tu();Object.defineProperty(i,"Certificate",{enumerable:!0,get:function(){return r(t).default}}),n(qB(),i),n(kw(),i),n(jB(),i)}(ma)),ma}var li={},ql={},UI;function Ew(){if(UI)return ql;UI=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.SessionManager=void 0;let i=class{constructor(){this.sessionNonceToSession=new Map,this.identityKeyToNonces=new Map}addSession(n){if(typeof n.sessionNonce!="string")throw new Error("Invalid session: sessionNonce is required to add a session.");if(this.sessionNonceToSession.set(n.sessionNonce,n),typeof n.peerIdentityKey=="string"){let r=this.identityKeyToNonces.get(n.peerIdentityKey);r==null&&(r=new Set,this.identityKeyToNonces.set(n.peerIdentityKey,r)),r.add(n.sessionNonce)}}updateSession(n){this.removeSession(n),this.addSession(n)}getSession(n){var r,t;const s=this.sessionNonceToSession.get(n);if(s!=null)return s;const a=this.identityKeyToNonces.get(n);if(a==null||a.size===0)return;let c;for(const u of a){const l=this.sessionNonceToSession.get(u);l!=null&&(c==null||((r=l.lastUpdate)!==null&&r!==void 0?r:0)>((t=c.lastUpdate)!==null&&t!==void 0?t:0))&&(c=l)}return c}removeSession(n){var r;if(typeof n.sessionNonce=="string"&&this.sessionNonceToSession.delete(n.sessionNonce),typeof n.peerIdentityKey=="string"){const t=this.identityKeyToNonces.get(n.peerIdentityKey);t!=null&&(t.delete((r=n.sessionNonce)!==null&&r!==void 0?r:""),t.size===0&&this.identityKeyToNonces.delete(n.peerIdentityKey))}}hasSession(n){if(this.sessionNonceToSession.has(n))return!0;const t=this.identityKeyToNonces.get(n);return t!=null&&t.size>0}};return ql.SessionManager=i,ql}var Xs={},tr={},HI;function KB(){if(HI)return tr;HI=1;var i=tr&&tr.__createBinding||(Object.create?function(s,a,c,u){u===void 0&&(u=c);var l=Object.getOwnPropertyDescriptor(a,c);(!l||("get"in l?!a.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,u,l)}:function(s,a,c,u){u===void 0&&(u=c),s[u]=a[c]}),e=tr&&tr.__setModuleDefault||(Object.create?function(s,a){Object.defineProperty(s,"default",{enumerable:!0,value:a})}:function(s,a){s.default=a}),n=tr&&tr.__importStar||function(s){if(s&&s.__esModule)return s;var a={};if(s!=null)for(var c in s)c!=="default"&&Object.prototype.hasOwnProperty.call(s,c)&&i(a,s,c);return e(a,s),a};Object.defineProperty(tr,"__esModule",{value:!0}),tr.verifyNonce=void 0;const r=n(Ze());async function t(s,a,c="self"){const u=r.toArray(s,"base64"),l=u.slice(0,16),h=u.slice(16),{valid:f}=await a.verifyHmac({data:l,hmac:h,protocolID:[2,"server hmac"],keyID:r.toUTF8(l),counterparty:c});return f}return tr.verifyNonce=t,tr}var di={},qI;function ek(){if(qI)return di;qI=1;var i=di&&di.__createBinding||(Object.create?function(c,u,l,h){h===void 0&&(h=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(c,h,f)}:function(c,u,l,h){h===void 0&&(h=l),c[h]=u[l]}),e=di&&di.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),n=di&&di.__importStar||function(c){if(c&&c.__esModule)return c;var u={};if(c!=null)for(var l in c)l!=="default"&&Object.prototype.hasOwnProperty.call(c,l)&&i(u,c,l);return e(u,c),u},r=di&&di.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(di,"__esModule",{value:!0}),di.createNonce=void 0;const t=n(Ze()),s=r(Ln());async function a(c,u="self"){const l=(0,s.default)(16),{hmac:h}=await c.createHmac({protocolID:[2,"server hmac"],keyID:t.toUTF8(l),data:l,counterparty:u}),f=[...l,...h];return t.toBase64(f)}return di.createNonce=a,di}var jl={},jI;function WB(){if(jI)return jl;jI=1,Object.defineProperty(jl,"__esModule",{value:!0}),jl.getVerifiableCertificates=void 0;const i=kw(),e=async(n,r,t)=>{const s=await n.listCertificates({certifiers:r.certifiers,types:Object.keys(r.types)});return await Promise.all(s.certificates.map(async a=>{const{keyringForVerifier:c}=await n.proveCertificate({certificate:a,fieldsToReveal:r.types[a.type],verifier:t});return new i.VerifiableCertificate(a.type,a.serialNumber,a.subject,a.certifier,a.revocationOutpoint,a.fields,c,a.signature)}))};return jl.getVerifiableCertificates=e,jl}var Vl={},VI;function $B(){if(VI)return Vl;VI=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.validateCertificates=void 0;const i=kw(),e=async(n,r,t)=>{if(r.certificates==null||r.certificates.length===0)throw new Error("No certificates were provided in the AuthMessage.");await Promise.all(r.certificates.map(async s=>{if(s.subject!==r.identityKey)throw new Error(`The subject of one of your certificates ("${s.subject}") is not the same as the request sender ("${r.identityKey}").`);const a=new i.VerifiableCertificate(s.type,s.serialNumber,s.subject,s.certifier,s.revocationOutpoint,s.fields,s.keyring,s.signature);if(!await a.verify())throw new Error(`The signature for the certificate with serial number ${a.serialNumber} is invalid!`);if(t!=null){const{certifiers:u,types:l}=t;if(!u.includes(a.certifier))throw new Error(`Certificate with serial number ${a.serialNumber} has an unrequested certifier: ${a.certifier}`);if(l[a.type]==null)throw new Error(`Certificate with type ${a.type} was not requested`)}await a.decryptFields(n)}))};return Vl.validateCertificates=e,Vl}var KI;function Ow(){return KI||(KI=1,function(i){var e=Xs&&Xs.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Xs&&Xs.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(KB(),i),n(ek(),i),n(WB(),i),n($B(),i)}(Xs)),Xs}var WI;function tk(){if(WI)return li;WI=1;var i=li&&li.__createBinding||(Object.create?function(h,f,m,d){d===void 0&&(d=m);var y=Object.getOwnPropertyDescriptor(f,m);(!y||("get"in y?!f.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return f[m]}}),Object.defineProperty(h,d,y)}:function(h,f,m,d){d===void 0&&(d=m),h[d]=f[m]}),e=li&&li.__setModuleDefault||(Object.create?function(h,f){Object.defineProperty(h,"default",{enumerable:!0,value:f})}:function(h,f){h.default=f}),n=li&&li.__importStar||function(h){if(h&&h.__esModule)return h;var f={};if(h!=null)for(var m in h)m!=="default"&&Object.prototype.hasOwnProperty.call(h,m)&&i(f,h,m);return e(f,h),f},r=li&&li.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(li,"__esModule",{value:!0}),li.Peer=void 0;const t=Ew(),s=Ow(),a=r(Ln()),c=n(Ze()),u="0.1";let l=class{constructor(f,m,d,y,b){this.onGeneralMessageReceivedCallbacks=new Map,this.onCertificatesReceivedCallbacks=new Map,this.onCertificateRequestReceivedCallbacks=new Map,this.onInitialResponseReceivedCallbacks=new Map,this.callbackIdCounter=0,this.autoPersistLastSession=!0,this.wallet=f,this.transport=m,this.certificatesToRequest=d??{certifiers:[],types:{}},this.transport.onData(this.handleIncomingMessage.bind(this)).catch(g=>{throw g}),this.sessionManager=y??new t.SessionManager,b===!1?this.autoPersistLastSession=!1:this.autoPersistLastSession=!0}async toPeer(f,m,d){var y,b;this.autoPersistLastSession&&typeof this.lastInteractedWithPeer=="string"&&typeof m!="string"&&(m=this.lastInteractedWithPeer);const g=await this.getAuthenticatedSession(m,d),v=c.toBase64((0,a.default)(32)),{signature:_}=await this.wallet.createSignature({data:f,protocolID:[2,"auth message signature"],keyID:`${v} ${(y=g.peerNonce)!==null&&y!==void 0?y:""}`,counterparty:g.peerIdentityKey}),S={version:u,messageType:"general",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:v,yourNonce:g.peerNonce,payload:f,signature:_};g.lastUpdate=Date.now(),this.sessionManager.updateSession(g);try{await this.transport.send(S)}catch(I){const A=new Error(`Failed to send message to peer ${(b=g.peerIdentityKey)!==null&&b!==void 0?b:"unknown"}: ${String(I.message)}`);throw A.stack=I.stack,A}}async requestCertificates(f,m,d=1e4){var y,b;this.autoPersistLastSession&&typeof this.lastInteractedWithPeer=="string"&&typeof m!="string"&&(m=this.lastInteractedWithPeer);const g=await this.getAuthenticatedSession(m,d),v=c.toBase64((0,a.default)(32)),{signature:_}=await this.wallet.createSignature({data:c.toArray(JSON.stringify(f),"utf8"),protocolID:[2,"auth message signature"],keyID:`${v} ${(y=g.peerNonce)!==null&&y!==void 0?y:""}`,counterparty:g.peerIdentityKey}),S={version:u,messageType:"certificateRequest",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:v,initialNonce:g.sessionNonce,yourNonce:g.peerNonce,requestedCertificates:f,signature:_};g.lastUpdate=Date.now(),this.sessionManager.updateSession(g);try{await this.transport.send(S)}catch(I){throw new Error(`Failed to send certificate request message to peer ${(b=g.peerIdentityKey)!==null&&b!==void 0?b:"unknown"}: ${String(I.message)}`)}}async getAuthenticatedSession(f,m){if(this.transport===void 0)throw new Error("Peer transport is not connected!");let d;if(typeof f=="string"&&(d=this.sessionManager.getSession(f)),d==null||!d.isAuthenticated){const y=await this.initiateHandshake(f,m);if(d=this.sessionManager.getSession(y),d==null||!d.isAuthenticated)throw new Error("Unable to establish mutual authentication with peer!")}return d}listenForGeneralMessages(f){const m=this.callbackIdCounter++;return this.onGeneralMessageReceivedCallbacks.set(m,f),m}stopListeningForGeneralMessages(f){this.onGeneralMessageReceivedCallbacks.delete(f)}listenForCertificatesReceived(f){const m=this.callbackIdCounter++;return this.onCertificatesReceivedCallbacks.set(m,f),m}stopListeningForCertificatesReceived(f){this.onCertificatesReceivedCallbacks.delete(f)}listenForCertificatesRequested(f){const m=this.callbackIdCounter++;return this.onCertificateRequestReceivedCallbacks.set(m,f),m}stopListeningForCertificatesRequested(f){this.onCertificateRequestReceivedCallbacks.delete(f)}async initiateHandshake(f,m=1e4){const d=await(0,s.createNonce)(this.wallet),y=Date.now();this.sessionManager.addSession({isAuthenticated:!1,sessionNonce:d,peerIdentityKey:f,lastUpdate:y});const b={version:u,messageType:"initialRequest",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,initialNonce:d,requestedCertificates:this.certificatesToRequest};return await this.transport.send(b),await this.waitForInitialResponse(d,m)}async waitForInitialResponse(f,m=1e4){return await new Promise((d,y)=>{const b=this.listenForInitialResponse(f,v=>{clearTimeout(g),this.stopListeningForInitialResponses(b),d(v)}),g=setTimeout(()=>{this.stopListeningForInitialResponses(b),y(new Error("Initial response timed out."))},m)})}listenForInitialResponse(f,m){const d=this.callbackIdCounter++;return this.onInitialResponseReceivedCallbacks.set(d,{callback:m,sessionNonce:f}),d}stopListeningForInitialResponses(f){this.onInitialResponseReceivedCallbacks.delete(f)}async handleIncomingMessage(f){if(typeof f.version!="string"||f.version!==u)throw new Error(`Invalid or unsupported message auth version! Received: ${f.version}, expected: ${u}`);switch(f.messageType){case"initialRequest":await this.processInitialRequest(f);break;case"initialResponse":await this.processInitialResponse(f);break;case"certificateRequest":await this.processCertificateRequest(f);break;case"certificateResponse":await this.processCertificateResponse(f);break;case"general":await this.processGeneralMessage(f);break;default:throw new Error(`Unknown message type of ${String(f.messageType)} from ${String(f.identityKey)}`)}}async processInitialRequest(f){if(typeof f.identityKey!="string"||typeof f.initialNonce!="string"||f.initialNonce==="")throw new Error("Missing required fields in initialRequest message.");const m=await(0,s.createNonce)(this.wallet),d=Date.now();this.sessionManager.addSession({isAuthenticated:!0,sessionNonce:m,peerNonce:f.initialNonce,peerIdentityKey:f.identityKey,lastUpdate:d});let y;f.requestedCertificates!=null&&Array.isArray(f.requestedCertificates.certifiers)&&f.requestedCertificates.certifiers.length>0&&(this.onCertificateRequestReceivedCallbacks.size>0?this.onCertificateRequestReceivedCallbacks.forEach(v=>{v(f.identityKey,f.requestedCertificates)}):y=await(0,s.getVerifiableCertificates)(this.wallet,f.requestedCertificates,f.identityKey));const{signature:b}=await this.wallet.createSignature({data:c.toArray(f.initialNonce+m,"base64"),protocolID:[2,"auth message signature"],keyID:`${f.initialNonce} ${m}`,counterparty:f.identityKey}),g={version:u,messageType:"initialResponse",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,initialNonce:m,yourNonce:f.initialNonce,certificates:y,requestedCertificates:this.certificatesToRequest,signature:b};this.lastInteractedWithPeer===void 0&&(this.lastInteractedWithPeer=f.identityKey),await this.transport.send(g)}async processInitialResponse(f){var m,d,y,b,g,v,_;if(!await(0,s.verifyNonce)(f.yourNonce,this.wallet))throw new Error(`Initial response nonce verification failed from peer: ${f.identityKey}`);const I=this.sessionManager.getSession(f.yourNonce);if(I==null)throw new Error(`Peer session not found for peer: ${f.identityKey}`);const A=c.toArray(((m=I.sessionNonce)!==null&&m!==void 0?m:"")+((d=f.initialNonce)!==null&&d!==void 0?d:""),"base64"),{valid:R}=await this.wallet.verifySignature({data:A,signature:f.signature,protocolID:[2,"auth message signature"],keyID:`${(y=I.sessionNonce)!==null&&y!==void 0?y:""} ${(b=f.initialNonce)!==null&&b!==void 0?b:""}`,counterparty:f.identityKey});if(!R)throw new Error(`Unable to verify initial response signature for peer: ${f.identityKey}`);if(I.peerNonce=f.initialNonce,I.peerIdentityKey=f.identityKey,I.isAuthenticated=!0,I.lastUpdate=Date.now(),this.sessionManager.updateSession(I),((v=(g=this.certificatesToRequest)===null||g===void 0?void 0:g.certifiers)===null||v===void 0?void 0:v.length)>0&&((_=f.certificates)===null||_===void 0?void 0:_.length)>0&&(await(0,s.validateCertificates)(this.wallet,f,this.certificatesToRequest),this.onCertificatesReceivedCallbacks.forEach(E=>E(f.identityKey,f.certificates))),this.lastInteractedWithPeer=f.identityKey,this.onInitialResponseReceivedCallbacks.forEach(E=>{E.sessionNonce===I.sessionNonce&&E.callback(I.sessionNonce)}),f.requestedCertificates!=null&&Array.isArray(f.requestedCertificates.certifiers)&&f.requestedCertificates.certifiers.length>0)if(this.onCertificateRequestReceivedCallbacks.size>0)this.onCertificateRequestReceivedCallbacks.forEach(E=>{E(f.identityKey,f.requestedCertificates)});else{const E=await(0,s.getVerifiableCertificates)(this.wallet,f.requestedCertificates,f.identityKey);await this.sendCertificateResponse(f.identityKey,E)}}async processCertificateRequest(f){var m,d;if(!await(0,s.verifyNonce)(f.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for certificate request message from: ${f.identityKey}`);const b=this.sessionManager.getSession(f.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${f.yourNonce}`);const{valid:g}=await this.wallet.verifySignature({data:c.toArray(JSON.stringify(f.requestedCertificates),"utf8"),signature:f.signature,protocolID:[2,"auth message signature"],keyID:`${(m=f.nonce)!==null&&m!==void 0?m:""} ${(d=b.sessionNonce)!==null&&d!==void 0?d:""}`,counterparty:b.peerIdentityKey});if(!g)throw new Error(`Invalid signature in certificate request message from ${b.peerIdentityKey}`);if(b.lastUpdate=Date.now(),this.sessionManager.updateSession(b),f.requestedCertificates!=null&&Array.isArray(f.requestedCertificates.certifiers)&&f.requestedCertificates.certifiers.length>0)if(this.onCertificateRequestReceivedCallbacks.size>0)this.onCertificateRequestReceivedCallbacks.forEach(v=>{v(f.identityKey,f.requestedCertificates)});else{const v=await(0,s.getVerifiableCertificates)(this.wallet,f.requestedCertificates,f.identityKey);await this.sendCertificateResponse(f.identityKey,v)}}async sendCertificateResponse(f,m){var d,y;const b=await this.getAuthenticatedSession(f),g=c.toBase64((0,a.default)(32)),{signature:v}=await this.wallet.createSignature({data:c.toArray(JSON.stringify(m),"utf8"),protocolID:[2,"auth message signature"],keyID:`${g} ${(d=b.peerNonce)!==null&&d!==void 0?d:""}`,counterparty:b.peerIdentityKey}),_={version:u,messageType:"certificateResponse",identityKey:(await this.wallet.getPublicKey({identityKey:!0})).publicKey,nonce:g,initialNonce:b.sessionNonce,yourNonce:b.peerNonce,certificates:m,signature:v};b.lastUpdate=Date.now(),this.sessionManager.updateSession(b);try{await this.transport.send(_)}catch(S){const I=S instanceof Error?S.message:String(S);throw new Error(`Failed to send certificate response message to peer ${(y=b.peerIdentityKey)!==null&&y!==void 0?y:"unknown"}: ${I}`)}}async processCertificateResponse(f){var m,d;if(!await(0,s.verifyNonce)(f.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for certificate response from: ${f.identityKey}`);const b=this.sessionManager.getSession(f.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${f.yourNonce}`);const{valid:g}=await this.wallet.verifySignature({data:c.toArray(JSON.stringify(f.certificates),"utf8"),signature:f.signature,protocolID:[2,"auth message signature"],keyID:`${(m=f.nonce)!==null&&m!==void 0?m:""} ${(d=b.sessionNonce)!==null&&d!==void 0?d:""}`,counterparty:f.identityKey});if(!g)throw new Error(`Unable to verify certificate response signature for peer: ${f.identityKey}`);await(0,s.validateCertificates)(this.wallet,f,f.requestedCertificates),this.onCertificatesReceivedCallbacks.forEach(v=>{var _;v(f.identityKey,(_=f.certificates)!==null&&_!==void 0?_:[])}),b.lastUpdate=Date.now(),this.sessionManager.updateSession(b)}async processGeneralMessage(f){var m,d;if(!await(0,s.verifyNonce)(f.yourNonce,this.wallet))throw new Error(`Unable to verify nonce for general message from: ${f.identityKey}`);const b=this.sessionManager.getSession(f.yourNonce);if(b==null)throw new Error(`Session not found for nonce: ${f.yourNonce}`);const{valid:g}=await this.wallet.verifySignature({data:f.payload,signature:f.signature,protocolID:[2,"auth message signature"],keyID:`${(m=f.nonce)!==null&&m!==void 0?m:""} ${(d=b.sessionNonce)!==null&&d!==void 0?d:""}`,counterparty:b.peerIdentityKey});if(!g)throw new Error(`Invalid signature in generalMessage from ${b.peerIdentityKey}`);b.lastUpdate=Date.now(),this.sessionManager.updateSession(b),this.lastInteractedWithPeer=f.identityKey,this.onGeneralMessageReceivedCallbacks.forEach(v=>{var _;v(f.identityKey,(_=f.payload)!==null&&_!==void 0?_:[])})}};return li.Peer=l,li}var Ib={},$I;function zB(){return $I||($I=1,Object.defineProperty(Ib,"__esModule",{value:!0})),Ib}var Ys={},fi={},nr={},zI;function nk(){if(zI)return nr;zI=1;var i=nr&&nr.__createBinding||(Object.create?function(a,c,u,l){l===void 0&&(l=u);var h=Object.getOwnPropertyDescriptor(c,u);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(a,l,h)}:function(a,c,u,l){l===void 0&&(l=u),a[l]=c[u]}),e=nr&&nr.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),n=nr&&nr.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var u in a)u!=="default"&&Object.prototype.hasOwnProperty.call(a,u)&&i(c,a,u);return e(c,a),c};Object.defineProperty(nr,"__esModule",{value:!0}),nr.SimplifiedFetchTransport=void 0;const r=n(Ze()),t=typeof window<"u"?fetch.bind(window):fetch;let s=class{constructor(c,u=t){this.fetchClient=u,this.baseUrl=c}async send(c){if(!this.onDataCallback)throw new Error("Listen before you start speaking. God gave you two ears and one mouth for a reason.");if(c.messageType!=="general")return new Promise(async(u,l)=>{try{const h=this.fetchClient(`${this.baseUrl}/.well-known/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});c.messageType!=="initialRequest"&&u();const f=await h;if(f.ok&&this.onDataCallback){const m=await f.json();this.onDataCallback(m)}else throw new Error("HTTP server failed to authenticate");c.messageType==="initialRequest"&&u()}catch(h){l(h);return}});{const u=this.deserializeRequestPayload(c.payload),l=`${this.baseUrl}${u.urlPostfix}`;let h=u;if(typeof u.headers!="object"&&(h.headers={}),h.headers["x-bsv-auth-version"]=c.version,h.headers["x-bsv-auth-identity-key"]=c.identityKey,h.headers["x-bsv-auth-nonce"]=c.nonce,h.headers["x-bsv-auth-your-nonce"]=c.yourNonce,h.headers["x-bsv-auth-signature"]=r.toHex(c.signature),h.headers["x-bsv-auth-request-id"]=u.requestId,h.body){const g=h.headers;if(!g["content-type"])throw new Error("Content-Type header is required for requests with a body.");const v=g["content-type"];v.includes("application/json")||v.includes("application/x-www-form-urlencoded")||v.includes("text/plain")?h.body=r.toUTF8(h.body):h.body=new Uint8Array(h.body)}const f=await this.fetchClient(l,{method:h.method,headers:h.headers,body:h.body});if(f.status===500&&f.headers.get("x-bsv-auth-request-id")==null&&f.headers.get("x-bsv-auth-requested-certificates")==null){const g=await f.json();throw new Error(`HTTP ${f.status} - ${JSON.stringify(g)}`)}const m=await f.arrayBuffer(),d=new r.Writer;f.headers.get("x-bsv-auth-request-id")!=null&&d.write(r.toArray(f.headers.get("x-bsv-auth-request-id"),"base64")),d.writeVarIntNum(f.status);const y=[];f.headers.forEach((g,v)=>{const _=v.toLowerCase();(_.startsWith("x-bsv-")||_==="authorization")&&!_.startsWith("x-bsv-auth")&&y.push([_,g])}),y.sort(([g],[v])=>g.localeCompare(v)),d.writeVarIntNum(y.length);for(let g=0;g<y.length;g++){const v=r.toArray(y[g][0],"utf8");d.writeVarIntNum(v.length),d.write(v);const _=r.toArray(y[g][1],"utf8");d.writeVarIntNum(_.length),d.write(_)}if(m){const g=Array.from(new Uint8Array(m));d.writeVarIntNum(g.length),d.write(g)}else d.writeVarIntNum(-1);const b={version:f.headers.get("x-bsv-auth-version"),messageType:f.headers.get("x-bsv-auth-message-type")==="certificateRequest"?"certificateRequest":"general",identityKey:f.headers.get("x-bsv-auth-identity-key"),nonce:f.headers.get("x-bsv-auth-nonce"),yourNonce:f.headers.get("x-bsv-auth-your-nonce"),requestedCertificates:JSON.parse(f.headers.get("x-bsv-auth-requested-certificates")),payload:d.toArray(),signature:r.toArray(f.headers.get("x-bsv-auth-signature"),"hex")};if(!b.version)throw new Error("HTTP server failed to authenticate");this.onDataCallback(b)}}async onData(c){this.onDataCallback=u=>{c(u)}}deserializeRequestPayload(c){const u=new r.Reader(c),l=r.toBase64(u.read(32)),h=u.readVarIntNum();let f="GET";h>0&&(f=r.toUTF8(u.read(h)));const m=u.readVarIntNum();let d="";m>0&&(d=r.toUTF8(u.read(m)));const y=u.readVarIntNum();let b="";y>0&&(b=r.toUTF8(u.read(y)));const g={},v=u.readVarIntNum();if(v>0)for(let I=0;I<v;I++){const A=u.readVarIntNum(),R=u.read(A),E=r.toUTF8(R),k=u.readVarIntNum(),P=u.read(k),T=r.toUTF8(P);g[E]=T}let _;const S=u.readVarIntNum();return S>0&&(_=u.read(S)),{urlPostfix:d+b,method:f,headers:g,body:_,requestId:l}}};return nr.SimplifiedFetchTransport=s,nr}var GI;function ik(){if(GI)return fi;GI=1;var i=fi&&fi.__createBinding||(Object.create?function(b,g,v,_){_===void 0&&(_=v);var S=Object.getOwnPropertyDescriptor(g,v);(!S||("get"in S?!g.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return g[v]}}),Object.defineProperty(b,_,S)}:function(b,g,v,_){_===void 0&&(_=v),b[_]=g[v]}),e=fi&&fi.__setModuleDefault||(Object.create?function(b,g){Object.defineProperty(b,"default",{enumerable:!0,value:g})}:function(b,g){b.default=g}),n=fi&&fi.__importStar||function(b){if(b&&b.__esModule)return b;var g={};if(b!=null)for(var v in b)v!=="default"&&Object.prototype.hasOwnProperty.call(b,v)&&i(g,b,v);return e(g,b),g},r=fi&&fi.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(fi,"__esModule",{value:!0}),fi.AuthFetch=void 0;const t=n(Ze()),s=r(Ln()),a=r(Iw()),c=r(Ca()),u=ek(),l=tk(),h=nk(),f=Ew(),m=Ow(),d="1.0";let y=class{constructor(g,v,_){this.callbacks={},this.certificatesReceived=[],this.peers={},this.wallet=g,this.requestedCertificates=v,this.sessionManager=_||new f.SessionManager}async fetch(g,v={}){if(typeof v.retryCounter=="number"){if(v.retryCounter<=0)throw new Error("Request failed after maximum number of retries.");v.retryCounter--}const _=await new Promise(async(S,I)=>{try{const{method:A="GET",headers:R={},body:E}=v,k=new URL(g),P=k.origin;let T;if(typeof this.peers[P]>"u"){const B=new h.SimplifiedFetchTransport(P);T={peer:new l.Peer(this.wallet,B,this.requestedCertificates,this.sessionManager),pendingCertificateRequests:[]},this.peers[P]=T,this.peers[P].peer.listenForCertificatesReceived((L,q)=>{this.certificatesReceived.push(...q)}),this.peers[P].peer.listenForCertificatesRequested(async(L,q)=>{try{this.peers[P].pendingCertificateRequests.push(!0);const K=await(0,m.getVerifiableCertificates)(this.wallet,q,L);await this.peers[P].peer.sendCertificateResponse(L,K)}finally{await new Promise(K=>setTimeout(K,500)),this.peers[P].pendingCertificateRequests.shift()}})}else{if(this.peers[P].supportsMutualAuth===!1){try{const B=await this.handleFetchAndValidate(g,v,this.peers[P]);S(B)}catch(B){I(B)}return}T=this.peers[P]}const M=(0,s.default)(32),C=t.toBase64(M),D=await this.serializeRequest(A,R,E,k,M);this.callbacks[C]={resolve:S,reject:I};const F=T.peer.listenForGeneralMessages((B,L)=>{const q=new t.Reader(L);if(t.toBase64(q.read(32))!==C)return;T.peer.stopListeningForGeneralMessages(F),this.peers[P].identityKey=B,this.peers[P].supportsMutualAuth=!0;const $=q.readVarIntNum(),U={},z=q.readVarIntNum();if(z>0)for(let Se=0;Se<z;Se++){const Ie=q.readVarIntNum(),me=q.read(Ie),xe=t.toUTF8(me),ke=q.readVarIntNum(),Re=q.read(ke),Ce=t.toUTF8(Re);U[xe]=Ce}U["x-bsv-auth-identity-key"]=B;let G;const ne=q.readVarIntNum();ne>0&&(G=q.read(ne));const ce=new Response(G?new Uint8Array(G):null,{status:$,statusText:`${$}`,headers:new Headers(U)});this.callbacks[C].resolve(ce),delete this.callbacks[C]});T.pendingCertificateRequests.length>0&&await new Promise(B=>{setInterval(()=>{T.pendingCertificateRequests.length===0&&B()},100)}),await T.peer.toPeer(D.toArray(),T.identityKey).catch(async B=>{var L;if(B.message.includes("Session not found for nonce")){delete this.peers[P],(L=v.retryCounter)!==null&&L!==void 0||(v.retryCounter=3);const q=await this.fetch(g,v);S(q);return}if(B.message.includes("HTTP server failed to authenticate"))try{const q=await this.handleFetchAndValidate(g,v,T);S(q);return}catch(q){I(q)}else I(B)})}catch(A){I(A)}});return _.status===402?await this.handlePaymentAndRetry(g,v,_):_}async sendCertificateRequest(g,v){const S=new URL(g).origin;let I;if(typeof this.peers[S]<"u")I={peer:this.peers[S].peer};else{const A=new h.SimplifiedFetchTransport(S);I={peer:new l.Peer(this.wallet,A,this.requestedCertificates,this.sessionManager)},this.peers[S]=I}return await new Promise(async(A,R)=>{const E=I.peer.listenForCertificatesReceived((k,P)=>{I.peer.stopListeningForCertificatesReceived(E),this.certificatesReceived.push(...P),A(P)});try{await I.peer.requestCertificates(v,I.identityKey)}catch(k){I.peer.stopListeningForCertificatesReceived(E),R(k)}})}consumeReceivedCertificates(){return this.certificatesReceived.splice(0)}async serializeRequest(g,v,_,S,I){const A=new t.Writer;if(A.write(I),A.writeVarIntNum(g.length),A.write(t.toArray(g)),S.pathname.length>0){const k=t.toArray(S.pathname);A.writeVarIntNum(k.length),A.write(k)}else A.writeVarIntNum(-1);if(S.search.length>0){const k=t.toArray(S.search);A.writeVarIntNum(k.length),A.write(k)}else A.writeVarIntNum(-1);const R=[];for(let[k,P]of Object.entries(v))if(k=k.toLowerCase(),k.startsWith("x-bsv-")||k==="authorization"){if(k.startsWith("x-bsv-auth"))throw new Error("No BSV auth headers allowed here!");R.push([k,P])}else if(k.startsWith("content-type"))P=P.split(";")[0].trim(),R.push([k,P]);else throw new Error("Unsupported header in the simplified fetch implementation. Only content-type, authorization, and x-bsv-* headers are supported.");R.sort(([k],[P])=>k.localeCompare(P)),A.writeVarIntNum(R.length);for(let k=0;k<R.length;k++){const P=t.toArray(R[k][0],"utf8");A.writeVarIntNum(P.length),A.write(P);const T=t.toArray(R[k][1],"utf8");A.writeVarIntNum(T.length),A.write(T)}if(["POST","PUT","PATCH","DELETE"].includes(g.toUpperCase())&&_===void 0){const k=R.find(([P])=>P==="content-type");k&&k[1].includes("application/json")?_="{}":_=""}if(_){const k=await this.normalizeBodyToNumberArray(_);A.writeVarIntNum(k.length),A.write(k)}else A.writeVarIntNum(-1);return A}async handleFetchAndValidate(g,v,_){const S=await fetch(g,v);if(S.headers.forEach(I=>{if(I.toLocaleLowerCase().startsWith("x-bsv"))throw new Error("The server is trying to claim it has been authenticated when it has not!")}),S.ok)return _.supportsMutualAuth=!1,S;throw new Error(`Request failed with status: ${S.status}`)}async handlePaymentAndRetry(g,v={},_){var S;const I=_.headers.get("x-bsv-payment-version");if(!I||I!==d)throw new Error(`Unsupported x-bsv-payment-version response header. Client version: ${d}, Server version: ${I}`);const A=_.headers.get("x-bsv-payment-satoshis-required");if(!A)throw new Error("Missing x-bsv-payment-satoshis-required response header.");const R=parseInt(A);if(isNaN(R)||R<=0)throw new Error("Invalid x-bsv-payment-satoshis-required response header value.");const E=_.headers.get("x-bsv-auth-identity-key");if(!E)throw new Error("Missing x-bsv-auth-identity-key response header.");const k=_.headers.get("x-bsv-payment-derivation-prefix");if(typeof k!="string"||k.length<1)throw new Error("Missing x-bsv-payment-derivation-prefix response header.");const P=await(0,u.createNonce)(this.wallet),{publicKey:T}=await this.wallet.getPublicKey({protocolID:[2,"3241645161d8"],keyID:`${k} ${P}`,counterparty:E}),M=new a.default().lock(c.default.fromString(T).toAddress()).toHex(),{tx:C}=await this.wallet.createAction({description:`Payment for request to ${new URL(g).origin}`,outputs:[{satoshis:R,lockingScript:M,customInstructions:JSON.stringify({derivationPrefix:k,derivationSuffix:P,payee:E}),outputDescription:"HTTP request payment"}],options:{randomizeOutputs:!1}});return v.headers=v.headers||{},v.headers["x-bsv-payment"]=JSON.stringify({derivationPrefix:k,derivationSuffix:P,transaction:t.toBase64(C)}),(S=v.retryCounter)!==null&&S!==void 0||(v.retryCounter=3),this.fetch(g,v)}async normalizeBodyToNumberArray(g){if(g==null)return[];if(typeof g=="object")return t.toArray(JSON.stringify(g,"utf8"));if(Array.isArray(g)&&g.every(v=>typeof v=="number"))return g;if(typeof g=="string")return t.toArray(g,"utf8");if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)){const v=g instanceof ArrayBuffer?new Uint8Array(g):new Uint8Array(g.buffer);return Array.from(v)}if(g instanceof Blob){const v=await g.arrayBuffer();return Array.from(new Uint8Array(v))}if(g instanceof FormData){const v=[];g.forEach((S,I)=>{v.push([I,S.toString()])});const _=new URLSearchParams(v).toString();return t.toArray(_,"utf8")}if(g instanceof URLSearchParams)return t.toArray(g.toString(),"utf8");throw g instanceof ReadableStream?new Error("ReadableStream cannot be directly converted to number[]."):new Error("Unsupported body type in this SimplifiedFetch implementation.")}};return fi.AuthFetch=y,fi}var XI;function rk(){return XI||(XI=1,function(i){var e=Ys&&Ys.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Ys&&Ys.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(ik(),i)}(Ys)),Ys}var Qs={},YI;function GB(){return YI||(YI=1,function(i){var e=Qs&&Qs.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Qs&&Qs.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(nk(),i)}(Qs)),Qs}var QI;function XB(){return QI||(QI=1,function(i){var e=zs&&zs.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=zs&&zs.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(VB(),i),n(tk(),i),n(Ew(),i),n(zB(),i),n(Ow(),i),n(rk(),i),n(GB(),i)}(zs)),zs}var wa={},Kl={},Kc={},ZI;function Aw(){if(ZI)return Kc;ZI=1;var i=Kc&&Kc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Kc,"__esModule",{value:!0});const e=i(D0()),n=jr();let r=class{static decode(s){const a=e.default.decode(s);if(a.fields.length<4)throw new Error("Invalid SHIP/SLAP advertisement!");const c=n.Utils.toUTF8(a.fields[0]);if(c!=="SHIP"&&c!=="SLAP")throw new Error("Invalid protocol type!");const u=n.Utils.toHex(a.fields[1]),l=n.Utils.toUTF8(a.fields[2]),h=n.Utils.toUTF8(a.fields[3]);return{protocol:c,identityKey:u,domain:l,topicOrService:h}}constructor(s){this.pushDrop=new e.default(s)}async lock(s,a,c){const{publicKey:u}=await this.pushDrop.wallet.getPublicKey({identityKey:!0});return await this.pushDrop.lock([n.Utils.toArray(s,"utf8"),n.Utils.toArray(u,"hex"),n.Utils.toArray(a,"utf8"),n.Utils.toArray(c,"utf8")],[2,s==="SHIP"?"Service Host Interconnect":"Service Lookup Availability"],"1","self")}unlock(s){return this.pushDrop.unlock([2,s==="SHIP"?"Service Host Interconnect":"Service Lookup Availability"],"1","self")}};return Kc.default=r,Kc}var JI;function Pm(){return JI||(JI=1,function(i){var e=Kl&&Kl.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0}),i.HTTPSOverlayLookupFacilitator=i.DEFAULT_TESTNET_SLAP_TRACKERS=i.DEFAULT_SLAP_TRACKERS=void 0;const n=Cf(),r=e(Aw());i.DEFAULT_SLAP_TRACKERS=["https://users.bapp.dev"],i.DEFAULT_TESTNET_SLAP_TRACKERS=["https://testnet-users.bapp.dev"];const t=5e3;class s{constructor(u=fetch,l=!1){this.fetchClient=u,this.allowHTTP=l}async lookup(u,l,h=5e3){if(!u.startsWith("https:")&&!this.allowHTTP)throw new Error('HTTPS facilitator can only use URLs that start with "https:"');const f=new Promise((y,b)=>setTimeout(()=>b(new Error("Request timed out")),h)),m=fetch(`${u}/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:l.service,query:l.query})}),d=await Promise.race([m,f]);if(d.ok)return await d.json();throw new Error("Failed to facilitate lookup")}}i.HTTPSOverlayLookupFacilitator=s;let a=class{constructor(u={}){var l,h,f,m,d;this.networkPreset=(l=u.networkPreset)!==null&&l!==void 0?l:"mainnet",this.facilitator=(h=u.facilitator)!==null&&h!==void 0?h:new s(void 0,this.networkPreset==="local"),this.slapTrackers=(f=u.slapTrackers)!==null&&f!==void 0?f:this.networkPreset==="mainnet"?i.DEFAULT_SLAP_TRACKERS:i.DEFAULT_TESTNET_SLAP_TRACKERS,this.hostOverrides=(m=u.hostOverrides)!==null&&m!==void 0?m:{},this.additionalHosts=(d=u.additionalHosts)!==null&&d!==void 0?d:{}}async query(u,l){var h;let f=[];if(u.service==="ls_slap"?f=this.networkPreset==="local"?["http://localhost:8080"]:this.slapTrackers:this.hostOverrides[u.service]!=null?f=this.hostOverrides[u.service]:this.networkPreset==="local"?f=["http://localhost:8080"]:f=await this.findCompetentHosts(u.service),((h=this.additionalHosts[u.service])===null||h===void 0?void 0:h.length)>0&&(f=[...f,...this.additionalHosts[u.service]]),f.length<1)throw new Error(`No competent ${this.networkPreset} hosts found by the SLAP trackers for lookup service: ${u.service}`);const d=(await Promise.allSettled(f.map(async b=>await this.facilitator.lookup(b,u,l)))).filter(b=>b.status==="fulfilled").map(b=>b.value);if(d.length===0)throw new Error("No successful responses from any hosts");const y=new Map;for(const b of d)if(b.type==="output-list")try{for(const g of b.outputs)try{const _=`${n.Transaction.fromBEEF(g.beef).id("hex")}.${g.outputIndex}`;y.set(_,g)}catch{continue}}catch{}return{type:"output-list",outputs:Array.from(y.values())}}async findCompetentHosts(u){const l={service:"ls_slap",query:{service:u}},h=await Promise.allSettled(this.slapTrackers.map(async m=>await this.facilitator.lookup(m,l,t))),f=new Set;for(const m of h)if(m.status==="fulfilled"){const d=m.value;if(d.type!=="output-list")continue;for(const y of d.outputs)try{const g=n.Transaction.fromBEEF(y.beef).outputs[y.outputIndex].lockingScript,v=r.default.decode(g);if(v.topicOrService!==u||v.protocol!=="SLAP")continue;f.add(v.domain)}catch{continue}}else continue;return[...f]}};i.default=a}(Kl)),Kl}var zn={},eT;function yp(){if(eT)return zn;eT=1;var i=zn&&zn.__createBinding||(Object.create?function(f,m,d,y){y===void 0&&(y=d);var b=Object.getOwnPropertyDescriptor(m,d);(!b||("get"in b?!m.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return m[d]}}),Object.defineProperty(f,y,b)}:function(f,m,d,y){y===void 0&&(y=d),f[y]=m[d]}),e=zn&&zn.__setModuleDefault||(Object.create?function(f,m){Object.defineProperty(f,"default",{enumerable:!0,value:m})}:function(f,m){f.default=m}),n=zn&&zn.__importStar||function(f){if(f&&f.__esModule)return f;var m={};if(f!=null)for(var d in f)d!=="default"&&Object.prototype.hasOwnProperty.call(f,d)&&i(m,f,d);return e(m,f),m},r=zn&&zn.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(zn,"__esModule",{value:!0}),zn.HTTPSOverlayBroadcastFacilitator=void 0;const t=Cf(),s=n(Ze()),a=r(Pm()),c=r(Aw()),u=5e3;class l{constructor(m=fetch,d=!1){this.httpClient=m,this.allowHTTP=d}async send(m,d){if(!m.startsWith("https:")&&!this.allowHTTP)throw new Error('HTTPS facilitator can only use URLs that start with "https:"');const y={"Content-Type":"application/octet-stream","X-Topics":JSON.stringify(d.topics)};let b;if(Array.isArray(d.offChainValues)){y["x-includes-off-chain-values"]="true";const v=new s.Writer;v.writeVarIntNum(d.beef.length),v.write(d.beef),v.write(d.offChainValues),b=new Uint8Array(v.toArray())}else b=new Uint8Array(d.beef);const g=await fetch(`${m}/submit`,{method:"POST",headers:y,body:b});if(g.ok)return await g.json();throw new Error("Failed to facilitate broadcast")}}zn.HTTPSOverlayBroadcastFacilitator=l;class h{constructor(m,d={}){var y,b,g,v,_,S;if(m.length===0)throw new Error("At least one topic is required for broadcast.");if(m.some(I=>!I.startsWith("tm_")))throw new Error('Every topic must start with "tm_".');this.topics=m,this.networkPreset=(y=d.networkPreset)!==null&&y!==void 0?y:"mainnet",this.facilitator=(b=d.facilitator)!==null&&b!==void 0?b:new l(void 0,this.networkPreset==="local"),this.resolver=(g=d.resolver)!==null&&g!==void 0?g:new a.default({networkPreset:this.networkPreset}),this.requireAcknowledgmentFromAllHostsForTopics=(v=d.requireAcknowledgmentFromAllHostsForTopics)!==null&&v!==void 0?v:[],this.requireAcknowledgmentFromAnyHostForTopics=(_=d.requireAcknowledgmentFromAnyHostForTopics)!==null&&_!==void 0?_:"all",this.requireAcknowledgmentFromSpecificHostsForTopics=(S=d.requireAcknowledgmentFromSpecificHostsForTopics)!==null&&S!==void 0?S:{}}async broadcast(m){let d;const y=m.metadata.get("OffChainValues");try{d=m.toBEEF()}catch{throw new Error("Transactions sent via SHIP to Overlay Services must be serializable to BEEF format.")}const b=await this.findInterestedHosts();if(Object.keys(b).length===0)return{status:"error",code:"ERR_NO_HOSTS_INTERESTED",description:`No ${this.networkPreset} hosts are interested in receiving this transaction.`};const g=Object.entries(b).map(async([k,P])=>{try{const T=await this.facilitator.send(k,{beef:d,offChainValues:y,topics:[...P]});if(T==null||Object.keys(T).length===0)throw new Error("Steak has no topics.");return{host:k,success:!0,steak:T}}catch(T){return console.error(T),{host:k,success:!1,error:T}}}),_=(await Promise.all(g)).filter(k=>k.success);if(_.length===0)return{status:"error",code:"ERR_ALL_HOSTS_REJECTED",description:`All ${this.networkPreset} topical hosts have rejected the transaction.`};const S={};for(const k of _){const P=k.host,T=k.steak,M=new Set;for(const[C,D]of Object.entries(T)){const F=D.outputsToAdmit,B=D.coinsToRetain,L=D.coinsRemoved;((F==null?void 0:F.length)>0||(B==null?void 0:B.length)>0||(L==null?void 0:L.length)>0)&&M.add(C)}S[P]=M}let I,A;if(this.requireAcknowledgmentFromAllHostsForTopics==="all"?(I=this.topics,A="all"):this.requireAcknowledgmentFromAllHostsForTopics==="any"?(I=this.topics,A="any"):Array.isArray(this.requireAcknowledgmentFromAllHostsForTopics)?(I=this.requireAcknowledgmentFromAllHostsForTopics,A="all"):(I=this.topics,A="all"),I.length>0&&!this.checkAcknowledgmentFromAllHosts(S,I,A))return{status:"error",code:"ERR_REQUIRE_ACK_FROM_ALL_HOSTS_FAILED",description:"Not all hosts acknowledged the required topics."};let R,E;return this.requireAcknowledgmentFromAnyHostForTopics==="all"?(R=this.topics,E="all"):this.requireAcknowledgmentFromAnyHostForTopics==="any"?(R=this.topics,E="any"):Array.isArray(this.requireAcknowledgmentFromAnyHostForTopics)?(R=this.requireAcknowledgmentFromAnyHostForTopics,E="all"):(R=[],E="all"),R.length>0&&!this.checkAcknowledgmentFromAnyHost(S,R,E)?{status:"error",code:"ERR_REQUIRE_ACK_FROM_ANY_HOST_FAILED",description:"No host acknowledged the required topics."}:Object.keys(this.requireAcknowledgmentFromSpecificHostsForTopics).length>0&&!this.checkAcknowledgmentFromSpecificHosts(S,this.requireAcknowledgmentFromSpecificHostsForTopics)?{status:"error",code:"ERR_REQUIRE_ACK_FROM_SPECIFIC_HOSTS_FAILED",description:"Specific hosts did not acknowledge the required topics."}:{status:"success",txid:m.id("hex"),message:`Sent to ${_.length} Overlay Services ${_.length===1?"host":"hosts"}.`}}checkAcknowledgmentFromAllHosts(m,d,y){for(const b of Object.values(m))if(y==="all"){for(const g of d)if(!b.has(g))return!1}else if(y==="any"){let g=!1;for(const v of d)if(b.has(v)){g=!0;break}if(!g)return!1}return!0}checkAcknowledgmentFromAnyHost(m,d,y){if(y==="all"){for(const b of Object.values(m)){let g=!0;for(const v of d)if(!b.has(v)){g=!1;break}if(g)return!0}return!1}else{for(const b of Object.values(m))for(const g of d)if(b.has(g))return!0;return!1}}checkAcknowledgmentFromSpecificHosts(m,d){for(const[y,b]of Object.entries(d)){const g=m[y];if(g==null)return!1;let v,_;if(b==="all"||b==="any")_=b,v=this.topics;else if(Array.isArray(b))v=b,_="all";else continue;if(_==="all"){for(const S of v)if(!g.has(S))return!1}else if(_==="any"){let S=!1;for(const I of v)if(g.has(I)){S=!0;break}if(!S)return!1}}return!0}async findInterestedHosts(){if(this.networkPreset==="local"){const y=new Set;for(let b=0;b<this.topics.length;b++)y.add(this.topics[b]);return{"http://localhost:8080":y}}const m={},d=await this.resolver.query({service:"ls_ship",query:{topics:this.topics}},u);if(d.type!=="output-list")throw new Error("SHIP answer is not an output list.");for(const y of d.outputs)try{const g=t.Transaction.fromBEEF(y.beef).outputs[y.outputIndex].lockingScript,v=c.default.decode(g);if(!this.topics.includes(v.topicOrService)||v.protocol!=="SHIP")continue;m[v.domain]===void 0&&(m[v.domain]=new Set),m[v.domain].add(v.topicOrService)}catch{continue}return m}}return zn.default=h,zn}var tT;function H0(){return tT||(tT=1,function(i){var e=wa&&wa.__createBinding||(Object.create?function(l,h,f,m){m===void 0&&(m=f);var d=Object.getOwnPropertyDescriptor(h,f);(!d||("get"in d?!h.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(l,m,d)}:function(l,h,f,m){m===void 0&&(m=f),l[m]=h[f]}),n=wa&&wa.__exportStar||function(l,h){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(h,f)&&e(h,l,f)},r=wa&&wa.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.SHIPCast=i.SHIPBroadcaster=i.TopicBroadcaster=i.LookupResolver=i.OverlayAdminTokenTemplate=void 0,n(Pm(),i),n(yp(),i);var t=Aw();Object.defineProperty(i,"OverlayAdminTokenTemplate",{enumerable:!0,get:function(){return r(t).default}});var s=Pm();Object.defineProperty(i,"LookupResolver",{enumerable:!0,get:function(){return r(s).default}});var a=yp();Object.defineProperty(i,"TopicBroadcaster",{enumerable:!0,get:function(){return r(a).default}});var c=yp();Object.defineProperty(i,"SHIPBroadcaster",{enumerable:!0,get:function(){return r(c).default}});var u=yp();Object.defineProperty(i,"SHIPCast",{enumerable:!0,get:function(){return r(u).default}})}(wa)),wa}var va={},Tb={},nT;function ak(){return nT||(nT=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.isValidURL=i.getHashFromURL=i.getURLForFile=i.getURLForHash=i.normalizeURL=void 0;const e=sn(),n=Ze(),r=u=>(u.toLowerCase().startsWith("uhrp:")&&(u=u.slice(5)),u.startsWith("//")&&(u=u.slice(2)),u);i.normalizeURL=r;const t=u=>{if(u.length!==32)throw new Error("Hash length must be 32 bytes (sha256)");return(0,n.toBase58Check)(u,(0,n.toArray)("ce00","hex"))};i.getURLForHash=t;const s=u=>{const l=(0,e.sha256)(u);return(0,i.getURLForHash)(l)};i.getURLForFile=s;const a=u=>{u=(0,i.normalizeURL)(u);const{data:l,prefix:h}=(0,n.fromBase58Check)(u,void 0,2);if(l.length!==32)throw new Error("Invalid length!");if((0,n.toHex)(h)!=="ce00")throw new Error("Bad prefix");return l};i.getHashFromURL=a;const c=u=>{try{return(0,i.getHashFromURL)(u),!0}catch{return!1}};i.isValidURL=c}(Tb)),Tb}var ir={},iT;function YB(){if(iT)return ir;iT=1;var i=ir&&ir.__createBinding||(Object.create?function(a,c,u,l){l===void 0&&(l=u);var h=Object.getOwnPropertyDescriptor(c,u);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(a,l,h)}:function(a,c,u,l){l===void 0&&(l=u),a[l]=c[u]}),e=ir&&ir.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),n=ir&&ir.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var u in a)u!=="default"&&Object.prototype.hasOwnProperty.call(a,u)&&i(c,a,u);return e(c,a),c};Object.defineProperty(ir,"__esModule",{value:!0}),ir.StorageUploader=void 0;const r=ik(),t=n(ak());let s=class{constructor(c){this.baseURL=c.storageURL,this.authFetch=new r.AuthFetch(c.wallet)}async getUploadInfo(c,u){const l=`${this.baseURL}/upload`,h={fileSize:c,retentionPeriod:u},f=await this.authFetch.fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!f.ok)throw new Error(`Upload info request failed: HTTP ${f.status}`);const m=await f.json();if(m.status==="error")throw new Error("Upload route returned an error.");return{uploadURL:m.uploadURL,requiredHeaders:m.requiredHeaders,amount:m.amount}}async uploadFile(c,u,l){const h=Uint8Array.from(u.data),f=await fetch(c,{method:"PUT",body:h,headers:{"Content-Type":u.type,...l}});if(!f.ok)throw new Error(`File upload failed: HTTP ${f.status}`);return{published:!0,uhrpURL:await t.getURLForFile(u.data)}}async publishFile(c){const{file:u,retentionPeriod:l}=c,h=u.data.length,{uploadURL:f,requiredHeaders:m}=await this.getUploadInfo(h,l);return await this.uploadFile(f,u,m)}async findFile(c){var u,l;const h=new URL(`${this.baseURL}/find`);h.searchParams.set("uhrpUrl",c);const f=await this.authFetch.fetch(h.toString(),{method:"GET"});if(!f.ok)throw new Error(`findFile request failed: HTTP ${f.status}`);const m=await f.json();if(m.status==="error"){const d=(u=m.code)!==null&&u!==void 0?u:"unknown-code",y=(l=m.description)!==null&&l!==void 0?l:"no-description";throw new Error(`findFile returned an error: ${d} - ${y}`)}return m.data}async listUploads(){var c,u;const l=`${this.baseURL}/list`,h=await this.authFetch.fetch(l,{method:"GET"});if(!h.ok)throw new Error(`listUploads request failed: HTTP ${h.status}`);const f=await h.json();if(f.status==="error"){const m=(c=f.code)!==null&&c!==void 0?c:"unknown-code",d=(u=f.description)!==null&&u!==void 0?u:"no-description";throw new Error(`listUploads returned an error: ${m} - ${d}`)}return f.uploads}async renewFile(c,u){var l,h;const f=`${this.baseURL}/renew`,m={uhrpUrl:c,additionalMinutes:u},d=await this.authFetch.fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!d.ok)throw new Error(`renewFile request failed: HTTP ${d.status}`);const y=await d.json();if(y.status==="error"){const b=(l=y.code)!==null&&l!==void 0?l:"unknown-code",g=(h=y.description)!==null&&h!==void 0?h:"no-description";throw new Error(`renewFile returned an error: ${b} - ${g}`)}return{status:y.status,prevExpiryTime:y.prevExpiryTime,newExpiryTime:y.newExpiryTime,amount:y.amount}}};return ir.StorageUploader=s,ir}var Zs={},rT;function QB(){if(rT)return Zs;rT=1;var i=Zs&&Zs.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.StorageDownloader=void 0;const e=H0(),n=sk(),r=i(D0()),t=i(Nf()),s=jr();let a=class{constructor(u){this.networkPreset="mainnet",this.networkPreset=u==null?void 0:u.networkPreset}async resolve(u){const h=await new e.LookupResolver({networkPreset:this.networkPreset}).query({service:"ls_uhrp",query:{uhrpUrl:u}});if(h.type!=="output-list")throw new Error("Lookup answer must be an output list");const f=[],m=Math.floor(Date.now()/1e3);for(let d=0;d<h.outputs.length;d++){const y=t.default.fromBEEF(h.outputs[d].beef),{fields:b}=r.default.decode(y.outputs[h.outputs[d].outputIndex].lockingScript);new s.Utils.Reader(b[3]).readVarIntNum()<m||f.push(s.Utils.toUTF8(b[2]))}return f}async download(u){if(!n.StorageUtils.isValidURL(u))throw new Error("Invalid parameter UHRP url");const l=n.StorageUtils.getHashFromURL(u),h=await this.resolve(u);if(!Array.isArray(h)||h.length===0)throw new Error("No one currently hosts this file!");for(let f=0;f<h.length;f++)try{const m=await fetch(h[f],{method:"GET"});if(!m.ok||m.status>=400)continue;const d=await m.arrayBuffer(),y=[...new Uint8Array(d)],b=s.Hash.sha256(y);for(let g=0;g<b.length;++g)if(b[g]!==l[g])throw new Error("Value of content does not match hash of the url given");return{data:y,mimeType:m.headers.get("Content-Type")}}catch{continue}throw new Error(`Unable to download content from ${u}`)}};return Zs.StorageDownloader=a,Zs}var aT;function sk(){return aT||(aT=1,function(i){var e=va&&va.__createBinding||(Object.create?function(a,c,u,l){l===void 0&&(l=u);var h=Object.getOwnPropertyDescriptor(c,u);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(a,l,h)}:function(a,c,u,l){l===void 0&&(l=u),a[l]=c[u]}),n=va&&va.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),r=va&&va.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var u in a)u!=="default"&&Object.prototype.hasOwnProperty.call(a,u)&&e(c,a,u);return n(c,a),c};Object.defineProperty(i,"__esModule",{value:!0}),i.StorageDownloader=i.StorageUploader=i.StorageUtils=void 0,i.StorageUtils=r(ak());var t=YB();Object.defineProperty(i,"StorageUploader",{enumerable:!0,get:function(){return t.StorageUploader}});var s=QB();Object.defineProperty(i,"StorageDownloader",{enumerable:!0,get:function(){return s.StorageDownloader}})}(va)),va}var Js={},eo={},xa={},sT;function ok(){return sT||(sT=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.KNOWN_IDENTITY_TYPES=xa.DEFAULT_IDENTITY_CLIENT_OPTIONS=xa.defaultIdentity=void 0,xa.defaultIdentity={name:"Unknown Identity",avatarURL:"XUUB8bbn9fEthk15Ge3zTQXypUShfC94vFjp65v7u5CQ8qkpxzst",identityKey:"",abbreviatedKey:"",badgeIconURL:"XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",badgeLabel:"Not verified by anyone you trust.",badgeClickURL:"https://projectbabbage.com/docs/unknown-identity"},xa.DEFAULT_IDENTITY_CLIENT_OPTIONS={protocolID:[1,"identity"],keyID:"1",tokenAmount:1,outputIndex:0},xa.KNOWN_IDENTITY_TYPES={identiCert:"z40BOInXkI8m7f/wBrv4MJ09bZfzZbTj2fJqCtONqCY=",discordCert:"2TgqRC35B1zehGmB21xveZNc7i5iqHc0uxMb+1NMPW4=",phoneCert:"mffUklUzxbHr65xLohn0hRL0Tq2GjW1GYF/OPfzqJ6A=",xCert:"vdDWvftf1H+5+ZprUw123kjHlywH+v20aPQTuXgMpNc=",registrant:"YoPsbfR6YQczjzPdHCoGC7nJsOdPQR50+SYqcWpJ0y0=",emailCert:"exOl3KM0dIJ04EW5pZgbZmPag6MdJXd3/a1enmUU/BA=",anyone:"mfkOMfLDQmrr3SBxBQ5WeE+6Hy3VJRFq6w4A5Ljtlis=",self:"Hkge6X5JRxt1cWXtHLCrSTg6dCVTxjQJJ48iOYd7n3g=",coolCert:"AGfk/WrT1eBDXpz3mcw386Zww2HmqcIn3uY6x4Af1eo="}),xa}var oT;function ZB(){if(oT)return eo;oT=1;var i=eo&&eo.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(eo,"__esModule",{value:!0}),eo.IdentityClient=void 0;const e=rk(),n=ok(),r=U0(),t=Cf(),s=i(Tu()),a=L0(),c=jr(),u=H0();let l=class Rm{constructor(f,m=n.DEFAULT_IDENTITY_CLIENT_OPTIONS,d){this.options=m,this.originator=d,this.wallet=f??new r.WalletClient,this.authClient=new e.AuthFetch(this.wallet)}async publiclyRevealAttributes(f,m){if(Object.keys(f.fields).length===0)throw new Error("Public reveal failed: Certificate has no fields to reveal!");if(m.length===0)throw new Error("Public reveal failed: You must reveal at least one field!");try{await new s.default(f.type,f.serialNumber,f.subject,f.certifier,f.revocationOutpoint,f.fields,f.signature).verify()}catch{throw new Error("Public reveal failed: Certificate verification failed!")}const{keyringForVerifier:d}=await this.wallet.proveCertificate({certificate:f,fieldsToReveal:m,verifier:new c.PrivateKey(1).toPublicKey().toString()}),y=await new a.PushDrop(this.wallet).lock([c.Utils.toArray(JSON.stringify({...f,keyring:d}))],this.options.protocolID,this.options.keyID,"anyone",!0,!0),{tx:b}=await this.wallet.createAction({description:"Create a new Identity Token",outputs:[{satoshis:this.options.tokenAmount,lockingScript:y.toHex(),outputDescription:"Identity Token"}],options:{randomizeOutputs:!1}});if(b!==void 0)return await new u.TopicBroadcaster(["tm_identity"],{networkPreset:(await this.wallet.getNetwork({})).network}).broadcast(t.Transaction.fromAtomicBEEF(b));throw new Error("Public reveal failed: failed to create action!")}async resolveByIdentityKey(f){const{certificates:m}=await this.wallet.discoverByIdentityKey(f,this.originator);return m.map(d=>Rm.parseIdentity(d))}async resolveByAttributes(f){const{certificates:m}=await this.wallet.discoverByAttributes(f,this.originator);return m.map(d=>Rm.parseIdentity(d))}static parseIdentity(f){const{type:m,decryptedFields:d,certifierInfo:y}=f;let b,g,v,_,S;switch(m){case n.KNOWN_IDENTITY_TYPES.xCert:b=d.userName,g=d.profilePhoto,v=`X account certified by ${y.name}`,_=y.iconUrl,S="https://socialcert.net";break;case n.KNOWN_IDENTITY_TYPES.discordCert:b=d.userName,g=d.profilePhoto,v=`Discord account certified by ${y.name}`,_=y.iconUrl,S="https://socialcert.net";break;case n.KNOWN_IDENTITY_TYPES.emailCert:b=d.email,g="XUTZxep7BBghAJbSBwTjNfmcsDdRFs5EaGEgkESGSgjJVYgMEizu",v=`Email certified by ${y.name}`,_=y.iconUrl,S="https://socialcert.net";break;case n.KNOWN_IDENTITY_TYPES.phoneCert:b=d.phoneNumber,g="XUTLxtX3ELNUwRhLwL7kWNGbdnFM8WG2eSLv84J7654oH8HaJWrU",v=`Phone certified by ${y.name}`,_=y.iconUrl,S="https://socialcert.net";break;case n.KNOWN_IDENTITY_TYPES.identiCert:b=`${d.firstName} ${d.lastName}`,g=d.profilePhoto,v=`Government ID certified by ${y.name}`,_=y.iconUrl,S="https://identicert.me";break;case n.KNOWN_IDENTITY_TYPES.registrant:b=d.name,g=d.icon,v=`Entity certified by ${y.name}`,_=y.iconUrl,S="https://projectbabbage.com/docs/registrant";break;case n.KNOWN_IDENTITY_TYPES.coolCert:b=d.cool==="true"?"Cool Person!":"Not cool!";break;case n.KNOWN_IDENTITY_TYPES.anyone:b="Anyone",g="XUT4bpQ6cpBaXi1oMzZsXfpkWGbtp2JTUYAoN7PzhStFJ6wLfoeR",v="Represents the ability for anyone to access this information.",_="XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",S="https://projectbabbage.com/docs/anyone-identity";break;case n.KNOWN_IDENTITY_TYPES.self:b="You",g="XUT9jHGk2qace148jeCX5rDsMftkSGYKmigLwU2PLLBc7Hm63VYR",v="Represents your ability to access this information.",_="XUUV39HVPkpmMzYNTx7rpKzJvXfeiVyQWg2vfSpjBAuhunTCA9uG",S="https://projectbabbage.com/docs/self-identity";break;default:b=n.defaultIdentity.name,g=d.profilePhoto,v=n.defaultIdentity.badgeLabel,_=n.defaultIdentity.badgeIconURL,S=n.defaultIdentity.badgeClickURL;break}return{name:b,avatarURL:g,abbreviatedKey:f.subject.length>0?`${f.subject.substring(0,10)}...`:"",identityKey:f.subject,badgeIconURL:_,badgeLabel:v,badgeClickURL:S}}};return eo.IdentityClient=l,eo}var cT;function JB(){return cT||(cT=1,function(i){var e=Js&&Js.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Js&&Js.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(ZB(),i),n(ok(),i)}(Js)),Js}var to={},no={},uT;function eD(){if(uT)return no;uT=1,Object.defineProperty(no,"__esModule",{value:!0}),no.deserializeWalletProtocol=no.RegistryClient=void 0;const i=U0(),e=jr(),n=Cf(),r=H0(),t=L0(),s=1;let a=class{constructor(l=new i.WalletClient){this.wallet=l}async registerDefinition(l){var h;const f=(await this.wallet.getPublicKey({identityKey:!0})).publicKey,m=new t.PushDrop(this.wallet),d=this.buildPushDropFields(l,f),y=this.mapDefinitionTypeToWalletProtocol(l.definitionType),b=await m.lock(d,y,"1","anyone",!0),{tx:g}=await this.wallet.createAction({description:`Register a new ${l.definitionType} item`,outputs:[{satoshis:s,lockingScript:b.toHex(),outputDescription:`New ${l.definitionType} registration token`,basket:this.mapDefinitionTypeToBasketName(l.definitionType)}],options:{randomizeOutputs:!1}});if(g===void 0)throw new Error(`Failed to create ${l.definitionType} registration transaction!`);return await new r.TopicBroadcaster([this.mapDefinitionTypeToTopic(l.definitionType)],{networkPreset:(h=this.network)!==null&&h!==void 0?h:this.network=(await this.wallet.getNetwork({})).network}).broadcast(n.Transaction.fromAtomicBEEF(g))}async resolve(l,h){const f=new r.LookupResolver,m=this.mapDefinitionTypeToServiceName(l),d=await f.query({service:m,query:h});if(d.type!=="output-list")return[];const y=[];for(const b of d.outputs)try{const v=n.Transaction.fromBEEF(b.beef).outputs[b.outputIndex].lockingScript,_=await this.parseLockingScript(l,v);y.push(_)}catch{}return y}async listOwnRegistryEntries(l){const h=this.mapDefinitionTypeToBasketName(l),{outputs:f,BEEF:m}=await this.wallet.listOutputs({basket:h,include:"entire transactions"}),d=[];for(const y of f)if(y.spendable)try{const[b,g]=y.outpoint.split("."),_=n.Transaction.fromBEEF(m).outputs[g].lockingScript,S=await this.parseLockingScript(l,_);d.push({...S,txid:b,outputIndex:Number(g),satoshis:y.satoshis,lockingScript:_.toHex(),beef:m})}catch{}return d}async revokeOwnRegistryEntry(l){var h;if(l.txid===void 0||typeof l.outputIndex>"u"||l.lockingScript===void 0)throw new Error("Invalid registry record. Missing txid, outputIndex, or lockingScript.");const f=(await this.wallet.getPublicKey({identityKey:!0})).publicKey;if(l.registryOperator!==f)throw new Error("This registry token does not belong to the current wallet.");const m=l.definitionType==="basket"?l.basketID:l.definitionType==="protocol"?l.name:l.definitionType==="certificate"?l.name!==void 0?l.name:l.type:"unknown",d=`${l.txid}.${l.outputIndex}`,{signableTransaction:y}=await this.wallet.createAction({description:`Revoke ${l.definitionType} item: ${m}`,inputBEEF:l.beef,inputs:[{outpoint:d,unlockingScriptLength:73,inputDescription:`Revoking ${l.definitionType} token`}]});if(y===void 0)throw new Error("Failed to create signable transaction.");const b=n.Transaction.fromBEEF(y.tx),_=await(await new t.PushDrop(this.wallet).unlock(this.mapDefinitionTypeToWalletProtocol(l.definitionType),"1","anyone","all",!1,l.satoshis,t.LockingScript.fromHex(l.lockingScript))).sign(b,l.outputIndex),{tx:S}=await this.wallet.signAction({reference:y.reference,spends:{[l.outputIndex]:{unlockingScript:_.toHex()}},options:{acceptDelayedBroadcast:!1}});if(S===void 0)throw new Error("Failed to finalize the transaction signature.");return await new r.TopicBroadcaster([this.mapDefinitionTypeToTopic(l.definitionType)],{networkPreset:(h=this.network)!==null&&h!==void 0?h:this.network=(await this.wallet.getNetwork({})).network}).broadcast(n.Transaction.fromAtomicBEEF(S))}buildPushDropFields(l,h){let f;switch(l.definitionType){case"basket":f=[l.basketID,l.name,l.iconURL,l.description,l.documentationURL];break;case"protocol":f=[JSON.stringify(l.protocolID),l.name,l.iconURL,l.description,l.documentationURL];break;case"certificate":f=[l.type,l.name,l.iconURL,l.description,l.documentationURL,JSON.stringify(l.fields)];break;default:throw new Error("Unsupported definition type")}return f.push(h),f.map(m=>e.Utils.toArray(m))}async parseLockingScript(l,h){const f=t.PushDrop.decode(h);if(f.fields.length===0)throw new Error("Not a valid registry pushdrop script.");let m,d;switch(l){case"basket":{if(f.fields.length!==7)throw new Error("Unexpected field count for basket type.");const[y,b,g,v,_,S]=f.fields;m=e.Utils.toUTF8(S),d={definitionType:"basket",basketID:e.Utils.toUTF8(y),name:e.Utils.toUTF8(b),iconURL:e.Utils.toUTF8(g),description:e.Utils.toUTF8(v),documentationURL:e.Utils.toUTF8(_)};break}case"protocol":{if(f.fields.length!==7)throw new Error("Unexpected field count for protocol type.");const[y,b,g,v,_,S]=f.fields;m=e.Utils.toUTF8(S),d={definitionType:"protocol",protocolID:c(e.Utils.toUTF8(y)),name:e.Utils.toUTF8(b),iconURL:e.Utils.toUTF8(g),description:e.Utils.toUTF8(v),documentationURL:e.Utils.toUTF8(_)};break}case"certificate":{if(f.fields.length!==8)throw new Error("Unexpected field count for certificate type.");const[y,b,g,v,_,S,I]=f.fields;m=e.Utils.toUTF8(I);let A={};try{A=JSON.parse(e.Utils.toUTF8(S))}catch{}d={definitionType:"certificate",type:e.Utils.toUTF8(y),name:e.Utils.toUTF8(b),iconURL:e.Utils.toUTF8(g),description:e.Utils.toUTF8(v),documentationURL:e.Utils.toUTF8(_),fields:A};break}default:throw new Error(`Unsupported definition type: ${l}`)}return{...d,registryOperator:m}}mapDefinitionTypeToWalletProtocol(l){switch(l){case"basket":return[1,"basketmap"];case"protocol":return[1,"protomap"];case"certificate":return[1,"certmap"];default:throw new Error(`Unknown definition type: ${l}`)}}mapDefinitionTypeToBasketName(l){switch(l){case"basket":return"basketmap";case"protocol":return"protomap";case"certificate":return"certmap";default:throw new Error(`Unknown definition type: ${l}`)}}mapDefinitionTypeToTopic(l){switch(l){case"basket":return"tm_basketmap";case"protocol":return"tm_protomap";case"certificate":return"tm_certmap";default:throw new Error(`Unknown definition type: ${l}`)}}mapDefinitionTypeToServiceName(l){switch(l){case"basket":return"ls_basketmap";case"protocol":return"ls_protomap";case"certificate":return"ls_certmap";default:throw new Error(`Unknown definition type: ${l}`)}}};no.RegistryClient=a;function c(u){const l=JSON.parse(u);if(!Array.isArray(l)||l.length!==2)throw new Error("Invalid wallet protocol format.");const[h,f]=l;if(![0,1,2].includes(h))throw new Error("Invalid security level.");if(typeof f!="string")throw new Error("Invalid protocolID");return[h,f]}return no.deserializeWalletProtocol=c,no}var kb={},lT;function tD(){return lT||(lT=1,Object.defineProperty(kb,"__esModule",{value:!0})),kb}var dT;function nD(){return dT||(dT=1,function(i){var e=to&&to.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=to&&to.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(eD(),i),n(tD(),i)}(to)),to}var Wl={},Li={},fT;function iD(){if(fT)return Li;fT=1;var i=Li&&Li.__createBinding||(Object.create?function(h,f,m,d){d===void 0&&(d=m);var y=Object.getOwnPropertyDescriptor(f,m);(!y||("get"in y?!f.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return f[m]}}),Object.defineProperty(h,d,y)}:function(h,f,m,d){d===void 0&&(d=m),h[d]=f[m]}),e=Li&&Li.__setModuleDefault||(Object.create?function(h,f){Object.defineProperty(h,"default",{enumerable:!0,value:f})}:function(h,f){h.default=f}),n=Li&&Li.__importStar||function(h){if(h&&h.__esModule)return h;var f={};if(h!=null)for(var m in h)m!=="default"&&Object.prototype.hasOwnProperty.call(h,m)&&i(f,h,m);return e(f,h),f},r=Li&&Li.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Li,"__esModule",{value:!0});const t=r(D0()),s=n(Ze()),a=r(Y6()),c=r(Nf()),u=Rf();let l=class{constructor(f=new a.default,m="kvstore default",d=!0,y,b=!1){if(this.acceptDelayedBroadcast=!1,this.keyLocks=new Map,typeof m!="string"||m.length<1)throw new Error("A context in which to operate is required.");this.wallet=f,this.context=m,this.encrypt=d,this.originator=y,this.acceptDelayedBroadcast=b}async queueOperationOnKey(f){let m=this.keyLocks.get(f);m==null&&(m=[],this.keyLocks.set(f,m));let d=()=>{};const y=new Promise(b=>{d=b,m!=null&&m.push(b)});return m.length===1&&d(),await y,m}finishOperationOnKey(f,m){m.shift(),m.length>0&&m[0]()}getProtocol(f){return{protocolID:[2,this.context],keyID:f}}async getOutputs(f,m){return await this.wallet.listOutputs({basket:this.context,tags:[f],tagQueryMode:"all",include:"entire transactions",limit:m})}async get(f,m=void 0){const d=await this.queueOperationOnKey(f);try{return(await this.lookupValue(f,m,5)).value}finally{this.finishOperationOnKey(f,d)}}getLockingScript(f,m){var d;const[y,b]=f.outpoint.split("."),g=(d=m.findTxid(y))===null||d===void 0?void 0:d.tx;if(g==null)throw new Error(`beef must contain txid ${y}`);return g.outputs[Number(b)].lockingScript}async lookupValue(f,m,d){const y=await this.getOutputs(f,d),b={value:m,outpoint:void 0,lor:y},{outputs:g}=y;if(g.length===0)return b;const v=g.slice(-1)[0];b.outpoint=v.outpoint;let _;try{if(y.BEEF===void 0)throw new Error("entire transactions listOutputs option must return valid BEEF");const S=this.getLockingScript(v,u.Beef.fromBinary(y.BEEF)),I=t.default.decode(S);if(I.fields.length<1||I.fields.length>2)throw new Error("Invalid token.");_=I.fields[0]}catch{throw new Error(`Invalid value found. You need to call set to collapse the corrupted state (or relinquish the corrupted ${g[0].outpoint} output from the ${this.context} basket) before you can get this value again.`)}if(!this.encrypt)b.value=s.toUTF8(_);else{const{plaintext:S}=await this.wallet.decrypt({...this.getProtocol(f),ciphertext:_});b.value=s.toUTF8(S)}return b}getInputs(f){const m=[];for(let d=0;d<f.length;d++)m.push({outpoint:f[d].outpoint,unlockingScriptLength:74,inputDescription:"Previous key-value token"});return m}async getSpends(f,m,d,y){const b=this.getProtocol(f),g=c.default.fromAtomicBEEF(y),v={};for(let _=0;_<m.length;_++){const I=await d.unlock(b.protocolID,b.keyID,"self").sign(g,_);v[_]={unlockingScript:I.toHex()}}return v}async set(f,m){const d=await this.queueOperationOnKey(f);try{const y=await this.lookupValue(f,void 0,10);if(y.value===m){if(y.outpoint===void 0)throw new Error("outpoint must be valid when value is valid and unchanged");return y.outpoint}const b=this.getProtocol(f);let g=s.toArray(m,"utf8");if(this.encrypt){const{ciphertext:R}=await this.wallet.encrypt({...b,plaintext:g});g=R}const v=new t.default(this.wallet,this.originator),_=await v.lock([g],b.protocolID,b.keyID,"self"),{outputs:S,BEEF:I}=y.lor;let A;try{const R=this.getInputs(S),{txid:E,signableTransaction:k}=await this.wallet.createAction({description:`Update ${f} in ${this.context}`,inputBEEF:I,inputs:R,outputs:[{basket:this.context,tags:[f],lockingScript:_.toHex(),satoshis:1,outputDescription:"Key-value token"}],options:{acceptDelayedBroadcast:this.acceptDelayedBroadcast,randomizeOutputs:!1}});if(S.length>0&&typeof k!="object")throw new Error("Wallet did not return a signable transaction when expected.");if(k==null)A=`${E}.0`;else{const P=await this.getSpends(f,S,v,k.tx),{txid:T}=await this.wallet.signAction({reference:k.reference,spends:P});A=`${T}.0`}}catch{throw new Error(`There are ${S.length} outputs with tag ${f} that cannot be unlocked.`)}return A}finally{this.finishOperationOnKey(f,d)}}async remove(f){const m=await this.queueOperationOnKey(f);try{const d=[];for(;;){const{outputs:y,BEEF:b,totalOutputs:g}=await this.getOutputs(f);if(y.length>0){const v=new t.default(this.wallet,this.originator);try{const _=this.getInputs(y),{signableTransaction:S}=await this.wallet.createAction({description:`Remove ${f} in ${this.context}`,inputBEEF:b,inputs:_,options:{acceptDelayedBroadcast:this.acceptDelayedBroadcast}});if(typeof S!="object")throw new Error("Wallet did not return a signable transaction when expected.");const I=await this.getSpends(f,y,v,S.tx),{txid:A}=await this.wallet.signAction({reference:S.reference,spends:I});if(A===void 0)throw new Error("signAction must return a valid txid");d.push(A)}catch{throw new Error(`There are ${g} outputs with tag ${f} that cannot be unlocked.`)}}if(y.length===g)break}return d}finally{this.finishOperationOnKey(f,m)}}};return Li.default=l,Li}var hT;function rD(){return hT||(hT=1,function(i){var e=Wl&&Wl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(i,"__esModule",{value:!0}),i.LocalKVStore=void 0;var n=iD();Object.defineProperty(i,"LocalKVStore",{enumerable:!0,get:function(){return e(n).default}})}(Wl)),Wl}var pT;function Ye(){return pT||(pT=1,function(i){var e=qs&&qs.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=qs&&qs.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(jr(),i),n(L0(),i),n(E6(),i),n(Cf(),i),n(mB(),i),n(_B(),i),n(IB(),i),n(F6(),i),n(EB(),i),n(MB(),i),n(DB(),i),n(U0(),i),n(Q6(),i),n(XB(),i),n(H0(),i),n(sk(),i),n(JB(),i),n(nD(),i),n(rD(),i)}(qs)),qs}var yT;function aD(){if(yT)return ut;yT=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.parseWalletOutpoint=n,ut.validateSatoshis=h,ut.validateOptionalInteger=f,ut.validateInteger=m,ut.validatePositiveIntegerOrZero=d,ut.validateStringLength=y,ut.isHexString=k,ut.validateCreateActionInput=P,ut.validateCreateActionOutput=T,ut.validateCreateActionOptions=M,ut.validateCreateActionArgs=C,ut.validateSignActionOptions=D,ut.validateSignActionArgs=F,ut.validateAbortActionArgs=B,ut.validateWalletPayment=L,ut.validateBasketInsertion=q,ut.validateInternalizeOutput=K,ut.validateOriginator=$,ut.validateInternalizeActionArgs=U,ut.validateOptionalOutpointString=z,ut.validateOutpointString=G,ut.validateRelinquishOutputArgs=ne,ut.validateRelinquishCertificateArgs=ce,ut.validateListCertificatesArgs=Se,ut.validateAcquireCertificateArgs=Ce,ut.validateAcquireIssuanceCertificateArgs=Ne,ut.validateAcquireDirectCertificateArgs=We,ut.validateProveCertificateArgs=dt,ut.validateDiscoverByIdentityKeyArgs=Ut,ut.validateDiscoverByAttributesArgs=Je,ut.validateListOutputsArgs=At,ut.validateListActionsArgs=Te;const i=Ye(),e=Ke();function n(j){const[he,de]=j.split(".");return{txid:he,vout:Number(de)}}function r(j){return j??!0}function t(j){return j??!1}function s(j){return j??0}function a(j){return j??4294967295}function c(j){return j??1}function u(j){return j??[]}function l(j,he,de,Me){if(j!==void 0)return y(j,he,de,Me)}function h(j,he,de){if(j===void 0||!Number.isInteger(j)||j<0||j>21e14)throw new e.sdk.WERR_INVALID_PARAMETER(he,"a valid number of satoshis");if(de!==void 0&&j<de)throw new e.sdk.WERR_INVALID_PARAMETER(he,`at least ${de} satoshis.`);return j}function f(j,he,de,Me){if(j!==void 0)return m(j,he,void 0,de,Me)}function m(j,he,de,Me,ct){if(j===void 0){if(de!==void 0)return de;throw new e.sdk.WERR_INVALID_PARAMETER(he,"a valid integer")}if(!Number.isInteger(j))throw new e.sdk.WERR_INVALID_PARAMETER(he,"an integer");if(j=Number(j),Me!==void 0&&j<Me)throw new e.sdk.WERR_INVALID_PARAMETER(he,`at least ${Me} length.`);if(ct!==void 0&&j>ct)throw new e.sdk.WERR_INVALID_PARAMETER(he,`no more than ${ct} length.`);return j}function d(j,he){return m(j,he,0,0)}function y(j,he,de,Me){const ct=i.Utils.toArray(j,"utf8").length;if(de!==void 0&&ct<de)throw new e.sdk.WERR_INVALID_PARAMETER(he,`at least ${de} length.`);if(Me!==void 0&&ct>Me)throw new e.sdk.WERR_INVALID_PARAMETER(he,`no more than ${Me} length.`);return j}function b(j){if(j!==void 0)return g(j)}function g(j){return S(j,"basket",1,300)}function v(j){return S(j,"label",1,300)}function _(j){return S(j,"tag",1,300)}function S(j,he,de,Me){j=j.trim().toLowerCase();const ct=i.Utils.toArray(j,"utf8").length;if(ct<de)throw new e.sdk.WERR_INVALID_PARAMETER(he,`at least ${de} length.`);if(ct>Me)throw new e.sdk.WERR_INVALID_PARAMETER(he,`no more than ${Me} length.`);return j}function I(j,he,de,Me){if(j!==void 0)return A(j,he)}function A(j,he,de,Me){j=j.trim();const ct=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,Hn=/=+$/.exec(j),wn=Hn?Hn[0].length:0;if(wn>2||j.length%4!==0&&wn!==0||!ct.test(j))throw new e.sdk.WERR_INVALID_PARAMETER(he,"balid base64 string");return i.Utils.toArray(j,"base64").length,j}function R(j,he,de,Me){if(j!==void 0)return E(j,he,de,Me)}function E(j,he,de,Me){if(j=j.trim().toLowerCase(),j.length%2===1)throw new e.sdk.WERR_INVALID_PARAMETER(he,`even length, not ${j.length}.`);if(!/^[0-9A-Fa-f]+$/.test(j))throw new e.sdk.WERR_INVALID_PARAMETER(he,"hexadecimal string.");if(de!==void 0&&j.length<de)throw new e.sdk.WERR_INVALID_PARAMETER(he,`at least ${de} length.`);if(Me!==void 0&&j.length>Me)throw new e.sdk.WERR_INVALID_PARAMETER(he,`no more than ${Me} length.`);return j}function k(j){return j=j.trim(),!(j.length%2===1||!/^[0-9A-Fa-f]+$/.test(j))}function P(j){var he;if(j.unlockingScript===void 0&&j.unlockingScriptLength===void 0)throw new e.sdk.WERR_INVALID_PARAMETER("unlockingScript, unlockingScriptLength","at least one valid value.");const de=R(j.unlockingScript,"unlockingScript"),Me=(he=j.unlockingScriptLength)!==null&&he!==void 0?he:de.length/2;if(de&&Me!==de.length/2)throw new e.sdk.WERR_INVALID_PARAMETER("unlockingScriptLength","length unlockingScript if both valid.");return{outpoint:n(j.outpoint),inputDescription:y(j.inputDescription,"inputDescription",5,2e3),unlockingScript:de,unlockingScriptLength:Me,sequenceNumber:a(j.sequenceNumber)}}function T(j){return{lockingScript:E(j.lockingScript,"lockingScript"),satoshis:h(j.satoshis,"satoshis"),outputDescription:y(j.outputDescription,"outputDescription",5,2e3),basket:b(j.basket),customInstructions:j.customInstructions,tags:u(j.tags).map(de=>_(de))}}function M(j){const he=j||{};return{signAndProcess:r(he.signAndProcess),acceptDelayedBroadcast:r(he.acceptDelayedBroadcast),knownTxids:u(he.knownTxids),returnTXIDOnly:t(he.returnTXIDOnly),noSend:t(he.noSend),noSendChange:u(he.noSendChange).map(Me=>n(Me)),sendWith:u(he.sendWith),randomizeOutputs:r(he.randomizeOutputs)}}function C(j){var he;const de={description:y(j.description,"description",5,2e3),inputBEEF:j.inputBEEF,inputs:u(j.inputs).map(Me=>P(Me)),outputs:u(j.outputs).map(Me=>T(Me)),lockTime:s(j.lockTime),version:c(j.version),labels:u((he=j.labels)===null||he===void 0?void 0:he.map(Me=>v(Me))),options:M(j.options),isSendWith:!1,isDelayed:!1,isNoSend:!1,isNewTx:!1,isRemixChange:!1,isSignAction:!1,randomVals:void 0,includeAllSourceTransactions:!1};return de.isSendWith=de.options.sendWith.length>0,de.isRemixChange=!de.isSendWith&&de.inputs.length===0&&de.outputs.length===0,de.isNewTx=de.isRemixChange||de.inputs.length>0||de.outputs.length>0,de.isSignAction=de.isNewTx&&(de.options.signAndProcess===!1||de.inputs.some(Me=>Me.unlockingScript===void 0)),de.isDelayed=de.options.acceptDelayedBroadcast,de.isNoSend=de.options.noSend,de}function D(j){const he=j||{};return{acceptDelayedBroadcast:r(he.acceptDelayedBroadcast),returnTXIDOnly:t(he.returnTXIDOnly),noSend:t(he.noSend),sendWith:u(he.sendWith)}}function F(j){const he={spends:j.spends,reference:j.reference,options:D(j.options),isSendWith:!1,isDelayed:!1,isNoSend:!1,isNewTx:!0,isRemixChange:!1};return he.isSendWith=he.options.sendWith.length>0,he.isDelayed=he.options.acceptDelayedBroadcast,he.isNoSend=he.options.noSend,he}function B(j){return{reference:A(j.reference,"reference")}}function L(j){return j===void 0?void 0:{derivationPrefix:A(j.derivationPrefix,"derivationPrefix"),derivationSuffix:A(j.derivationSuffix,"derivationSuffix"),senderIdentityKey:E(j.senderIdentityKey,"senderIdentityKey")}}function q(j){return j===void 0?void 0:{basket:g(j.basket),customInstructions:l(j.customInstructions,"customInstructions",0,1e3),tags:u(j.tags).map(de=>_(de))}}function K(j){if(j.protocol!=="basket insertion"&&j.protocol!=="wallet payment")throw new e.sdk.WERR_INVALID_PARAMETER("protocol","'basket insertion' or 'wallet payment'");return{outputIndex:d(j.outputIndex,"outputIndex"),protocol:j.protocol,paymentRemittance:L(j.paymentRemittance),insertionRemittance:q(j.insertionRemittance)}}function $(j){if(j===void 0)return;j=j.trim().toLowerCase(),y(j,"originator",1,250);const he=j.split(".");for(const de of he)y(de,"originator part",1,63)}function U(j){const he={tx:j.tx,outputs:j.outputs.map(de=>K(de)),description:y(j.description,"description",5,2e3),labels:(j.labels||[]).map(de=>v(de)),seekPermission:r(j.seekPermission)};try{if(i.Beef.fromBinary(he.tx).txs.length<1)throw new e.sdk.WERR_INVALID_PARAMETER("tx","at least one transaction to internalize an output from")}catch{throw new e.sdk.WERR_INVALID_PARAMETER("tx","valid with at least one transaction to internalize an output from")}if(he.outputs.length<1)throw new e.sdk.WERR_INVALID_PARAMETER("outputs","at least one output to internalize from the transaction");return he}function z(j,he){if(j!==void 0)return G(j,he)}function G(j,he){const de=j.split(".");if(de.length!==2||!Number.isInteger(Number(de[1])))throw new e.sdk.WERR_INVALID_PARAMETER(he,"txid as hex string and numeric output index joined with '.'");const Me=E(de[0],`${he} txid`,void 0,64),ct=d(Number(de[1]),`${he} vout`);return`${Me}.${ct}`}function ne(j){return{basket:g(j.basket),output:G(j.output,"output")}}function ce(j){return{type:A(j.type,"type"),serialNumber:A(j.serialNumber,"serialNumber"),certifier:E(j.certifier,"certifier")}}function Se(j){return{certifiers:u(j.certifiers.map(de=>E(de.trim(),"certifiers"))),types:u(j.types.map(de=>A(de.trim(),"types"))),limit:m(j.limit,"limit",10,1,1e4),offset:d(s(j.offset),"offset"),privileged:t(j.privileged),privilegedReason:l(j.privilegedReason,"privilegedReason",5,50),partial:void 0}}function Ie(j){for(const he of Object.keys(j))y(he,"field name",1,50);return j}function me(j,he){return j==="certifier"?j:E(j,he)}function xe(j,he){if(j!==void 0)return me(j,he)}function ke(j,he){for(const de of Object.keys(j))y(de,`${he} field name`,1,50),A(j[de],`${he} field value`);return j}function Re(j,he){if(j!==void 0)return ke(j,he)}async function Ce(j){const he={acquisitionProtocol:j.acquisitionProtocol,type:A(j.type,"type"),serialNumber:I(j.serialNumber,"serialNumber"),certifier:E(j.certifier,"certifier"),revocationOutpoint:z(j.revocationOutpoint,"revocationOutpoint"),fields:Ie(j.fields),signature:R(j.signature,"signature"),certifierUrl:j.certifierUrl,keyringRevealer:xe(j.keyringRevealer,"keyringRevealer"),keyringForSubject:Re(j.keyringForSubject,"keyringForSubject"),privileged:t(j.privileged),privilegedReason:l(j.privilegedReason,"privilegedReason",5,50)};if(he.privileged&&!he.privilegedReason)throw new e.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");if(he.acquisitionProtocol==="direct"){if(!he.serialNumber)throw new e.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(!he.signature)throw new e.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(!he.revocationOutpoint)throw new e.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"')}return he}function Ne(j){if(j.acquisitionProtocol!=="issuance")throw new e.sdk.WERR_INTERNAL("Only acquire certificate via issuance requests allowed here.");if(j.serialNumber)throw new e.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(j.signature)throw new e.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(j.revocationOutpoint)throw new e.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"');if(j.keyringRevealer)throw new e.sdk.WERR_INVALID_PARAMETER("keyringRevealer",'valid when acquisitionProtocol is "direct"');if(j.keyringForSubject)throw new e.sdk.WERR_INVALID_PARAMETER("keyringForSubject",'valid when acquisitionProtocol is "direct"');if(!j.certifierUrl)throw new e.sdk.WERR_INVALID_PARAMETER("certifierUrl",'valid when acquisitionProtocol is "issuance"');if(j.privileged&&!j.privilegedReason)throw new e.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:A(j.type,"type"),certifier:E(j.certifier,"certifier"),certifierUrl:j.certifierUrl,fields:Ie(j.fields),privileged:t(j.privileged),privilegedReason:l(j.privilegedReason,"privilegedReason",5,50),subject:""}}function We(j){if(j.acquisitionProtocol!=="direct")throw new e.sdk.WERR_INTERNAL("Only acquire direct certificate requests allowed here.");if(!j.serialNumber)throw new e.sdk.WERR_INVALID_PARAMETER("serialNumber",'valid when acquisitionProtocol is "direct"');if(!j.signature)throw new e.sdk.WERR_INVALID_PARAMETER("signature",'valid when acquisitionProtocol is "direct"');if(!j.revocationOutpoint)throw new e.sdk.WERR_INVALID_PARAMETER("revocationOutpoint",'valid when acquisitionProtocol is "direct"');if(!j.keyringRevealer)throw new e.sdk.WERR_INVALID_PARAMETER("keyringRevealer",'valid when acquisitionProtocol is "direct"');if(!j.keyringForSubject)throw new e.sdk.WERR_INVALID_PARAMETER("keyringForSubject",'valid when acquisitionProtocol is "direct"');if(j.privileged&&!j.privilegedReason)throw new e.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:A(j.type,"type"),serialNumber:A(j.serialNumber,"serialNumber"),certifier:E(j.certifier,"certifier"),revocationOutpoint:G(j.revocationOutpoint,"revocationOutpoint"),fields:Ie(j.fields),signature:E(j.signature,"signature"),keyringRevealer:me(j.keyringRevealer,"keyringRevealer"),keyringForSubject:ke(j.keyringForSubject,"keyringForSubject"),privileged:t(j.privileged),privilegedReason:l(j.privilegedReason,"privilegedReason",5,50),subject:""}}function dt(j){if(j.privileged&&!j.privilegedReason)throw new e.sdk.WERR_INVALID_PARAMETER("privilegedReason","valid when 'privileged' is true ");return{type:I(j.certificate.type,"certificate.type"),serialNumber:I(j.certificate.serialNumber,"certificate.serialNumber"),certifier:R(j.certificate.certifier,"certificate.certifier"),subject:R(j.certificate.subject,"certificate.subject"),revocationOutpoint:z(j.certificate.revocationOutpoint,"certificate.revocationOutpoint"),signature:R(j.certificate.signature,"certificate.signature"),fieldsToReveal:u(j.fieldsToReveal).map(de=>y(de,`fieldsToReveal ${de}`,1,50)),verifier:E(j.verifier,"verifier"),privileged:t(j.privileged),privilegedReason:l(j.privilegedReason,"privilegedReason",5,50)}}function Ut(j){return{identityKey:E(j.identityKey,"identityKey",66,66),limit:m(j.limit,"limit",10,1,1e4),offset:d(s(j.offset),"offset"),seekPermission:t(j.seekPermission)}}function Ht(j){for(const he of Object.keys(j))y(he,`field name ${he}`,1,50);return j}function Je(j){return{attributes:Ht(j.attributes),limit:m(j.limit,"limit",10,1,1e4),offset:d(s(j.offset),"offset"),seekPermission:t(j.seekPermission)}}function At(j){let he;if(j.tagQueryMode===void 0||j.tagQueryMode==="any")he="any";else if(j.tagQueryMode==="all")he="all";else throw new e.sdk.WERR_INVALID_PARAMETER("tagQueryMode","undefined, 'any', or 'all'");return{basket:y(j.basket,"basket",1,300),tags:(j.tags||[]).map(Me=>y(Me,"tag",1,300)),tagQueryMode:he,includeLockingScripts:j.include==="locking scripts",includeTransactions:j.include==="entire transactions",includeCustomInstructions:t(j.includeCustomInstructions),includeTags:t(j.includeTags),includeLabels:t(j.includeLabels),limit:m(j.limit,"limit",10,1,1e4),offset:m(j.offset,"offset",0,0),seekPermission:r(j.seekPermission),knownTxids:[]}}function Te(j){let he;if(j.labelQueryMode===void 0||j.labelQueryMode==="any")he="any";else if(j.labelQueryMode==="all")he="all";else throw new e.sdk.WERR_INVALID_PARAMETER("labelQueryMode","undefined, 'any', or 'all'");return{labels:(j.labels||[]).map(Me=>v(Me)),labelQueryMode:he,includeLabels:t(j.includeLabels),includeInputs:t(j.includeInputs),includeInputSourceLockingScripts:t(j.includeInputSourceLockingScripts),includeInputUnlockingScripts:t(j.includeInputUnlockingScripts),includeOutputs:t(j.includeOutputs),includeOutputLockingScripts:t(j.includeOutputLockingScripts),limit:m(j.limit,"limit",10,1,1e4),offset:m(j.offset,"offset",0,0),seekPermission:r(j.seekPermission)}}return ut}var Eb={},gT;function sD(){return gT||(gT=1,Object.defineProperty(Eb,"__esModule",{value:!0})),Eb}var Ob={},bT;function oD(){return bT||(bT=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.specOpThrowReviewActions=i.specOpFailedActions=i.specOpNoSendActions=i.specOpSetWalletChangeParams=i.specOpInvalidChange=i.specOpWalletBalance=i.ProvenTxReqNonTerminalStatus=i.ProvenTxReqTerminalStatus=void 0,i.isListOutputsSpecOp=e,i.isListActionsSpecOp=n,i.isCreateActionSpecOp=r,i.ProvenTxReqTerminalStatus=["completed","invalid","doubleSpend"],i.ProvenTxReqNonTerminalStatus=["sending","unsent","nosend","unknown","nonfinal","unprocessed","unmined","callback","unconfirmed"],i.specOpWalletBalance="893b7646de0e1c9f741bd6e9169b76a8847ae34adef7bef1e6a285371206d2e8",i.specOpInvalidChange="5a76fd430a311f8bc0553859061710a4475c19fed46e2ff95969aa918e612e57",i.specOpSetWalletChangeParams="a4979d28ced8581e9c1c92f1001cc7cb3aabf8ea32e10888ad898f0a509a3929";function e(t){return[i.specOpWalletBalance,i.specOpInvalidChange,i.specOpSetWalletChangeParams].indexOf(t)>=0}i.specOpNoSendActions="ac6b20a3bb320adafecd637b25c84b792ad828d3aa510d05dc841481f664277d",i.specOpFailedActions="97d4eb1e49215e3374cc2c1939a7c43a55e95c7427bf2d45ed63e3b4e0c88153";function n(t){return[i.specOpNoSendActions,i.specOpFailedActions].indexOf(t)>=0}i.specOpThrowReviewActions="a496e747fc3ad5fabdd4ae8f91184e71f87539bd3d962aa2548942faaaf0047a";function r(t){return[i.specOpThrowReviewActions].indexOf(t)>=0}}(Ob)),Ob}var Ab={},mT;function cD(){return mT||(mT=1,Object.defineProperty(Ab,"__esModule",{value:!0})),Ab}var $l={},wT;function Pw(){if(wT)return $l;wT=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.PrivilegedKeyManager=void 0;const i=Ye();let e=class{constructor(r,t=12e4){this.chunkPropNames=[],this.chunkPadPropNames=[],this.decoyPropNamesDestroy=[],this.decoyPropNamesRemain=[],this.CHUNK_COUNT=4,this.keyGetter=r,this.retentionPeriod=t;for(let s=0;s<2;s++){const a=this.generateRandomPropName();this[a]=Uint8Array.from((0,i.Random)(16)),this.decoyPropNamesRemain.push(a)}}destroyKey(){try{for(const r of this.chunkPropNames){const t=this[r];t&&t.fill(0),delete this[r]}for(const r of this.chunkPadPropNames){const t=this[r];t&&t.fill(0),delete this[r]}for(const r of this.decoyPropNamesDestroy){const t=this[r];t&&t.fill(0),delete this[r]}this.chunkPropNames=[],this.chunkPadPropNames=[],this.decoyPropNamesDestroy=[]}catch{}finally{this.destroyTimer&&(clearTimeout(this.destroyTimer),this.destroyTimer=void 0)}}scheduleKeyDestruction(){this.destroyTimer&&clearTimeout(this.destroyTimer),this.destroyTimer=setTimeout(()=>{this.destroyKey()},this.retentionPeriod)}xorBytes(r,t){const s=new Uint8Array(r.length);for(let a=0;a<r.length;a++)s[a]=r[a]^t[a];return s}splitKeyIntoChunks(r){const t=Math.floor(r.length/this.CHUNK_COUNT),s=[];let a=0;for(let c=0;c<this.CHUNK_COUNT;c++){const u=c===this.CHUNK_COUNT-1?r.length-a:t;s.push(r.slice(a,a+u)),a+=u}return s}reassembleKeyFromChunks(){try{const r=[];for(let c=0;c<this.chunkPropNames.length;c++){const u=this[this.chunkPropNames[c]],l=this[this.chunkPadPropNames[c]];if(!u||!l||u.length!==l.length)return null;const h=this.xorBytes(u,l);r.push(h)}const t=r.reduce((c,u)=>c+u.length,0);if(t!==32)return null;const s=new Uint8Array(t);let a=0;for(const c of r)s.set(c,a),a+=c.length,c.fill(0);return s}catch{return null}}generateRandomPropName(){return`_${i.Utils.toHex((0,i.Random)(4))}_${Math.floor(Math.random()*1e6)}`}get32ByteRepresentation(r){const t=r.toArray();if(t.length>32)throw new Error("PrivilegedKeyManager: Expected a 32-byte key, but got more.");const s=new Uint8Array(32);return s.set(t,32-t.length),s}async getPrivilegedKey(r){if(this.chunkPropNames.length>0&&this.chunkPadPropNames.length>0){const c=this.reassembleKeyFromChunks();if(c&&c.length===32){const u=i.Utils.toHex([...c]);return c.fill(0),this.scheduleKeyDestruction(),new i.PrivateKey(u,"hex")}}const t=await this.keyGetter(r),s=this.get32ByteRepresentation(t);this.destroyKey();const a=this.splitKeyIntoChunks(s);for(let c=0;c<a.length;c++){const u=this.generateRandomPropName(),l=this.generateRandomPropName();this.chunkPropNames.push(u),this.chunkPadPropNames.push(l);const h=Uint8Array.from((0,i.Random)(a[c].length)),f=this.xorBytes(a[c],h);this[u]=f,this[l]=h}for(let c=0;c<2;c++){const u=this.generateRandomPropName();this[u]=Uint8Array.from((0,i.Random)(32)),this.decoyPropNamesDestroy.push(u)}return s.fill(0),this.scheduleKeyDestruction(),t}async getPublicKey(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).getPublicKey(r)}async revealCounterpartyKeyLinkage(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).revealCounterpartyKeyLinkage(r)}async revealSpecificKeyLinkage(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).revealSpecificKeyLinkage(r)}async encrypt(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).encrypt(r)}async decrypt(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).decrypt(r)}async createHmac(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).createHmac(r)}async verifyHmac(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).verifyHmac(r)}async createSignature(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).createSignature(r)}async verifySignature(r){return new i.ProtoWallet(await this.getPrivilegedKey(r.privilegedReason)).verifySignature(r)}};return $l.PrivilegedKeyManager=e,$l}var vT;function Jn(){return vT||(vT=1,function(i){var e=Hs&&Hs.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=Hs&&Hs.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(w6(),i),n(rB(),i),n(aB(),i),n(sB(),i),n(aD(),i),n(sD(),i),n(oD(),i),n(cD(),i),n(Pw(),i)}(Hs)),Hs}var io={},zl={},xT;function uD(){if(xT)return zl;xT=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.stampLog=i,zl.stampLogFormat=e;function i(n,r){const t=`${new Date().toISOString()} ${r}
`;if(typeof n=="object"&&typeof n.log=="string")return n.log=n.log+t;if(typeof n=="string")return n+t}function e(n){if(typeof n!="string")return"";const r=n.split(`
`),t=[];let s=0;const a=[];for(const l of r){const h=l.indexOf(" ");if(h>-1){const f=new Date(l.substring(0,h)).getTime(),m=l.substring(h+1),d=f-(s||f),y=m.indexOf("**NETWORK**")>-1;y&&a.push(t.length),t.push({when:f,rest:m,delta:d,newClock:y}),s=f}}const c=t[t.length-1].when-t[0].when;if(a.length%2===0){let l=c,h=0;for(const m of a)l-=t[m-1].when-t[h].when,h=m;l-=t[t.length-1].when-t[h].when;let f=a.length;for(const m of a){const d=f>1?Math.floor(l/f):l;t[m].delta=d,l-=d,f--}}let u=`${new Date(t[0].when).toISOString()} Total = ${c} msecs
`;for(const l of t){let h=l.delta.toString();h=`${" ".repeat(8-h.length)}${h}`,u+=`${h} ${l.rest}
`}return u}return zl}var Pb={},_T;function ck(){return _T||(_T=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ScriptTemplateBRC29=i.brc29ProtocolID=void 0;const e=Rw(),n=Ye();i.brc29ProtocolID=[2,"3241645161d8"];class r{constructor(s){this.params=s,this.unlockLength=108,this.p2pkh=new n.P2PKH,(0,e.verifyTruthy)(s.derivationPrefix),(0,e.verifyTruthy)(s.derivationSuffix)}getKeyID(){return`${this.params.derivationPrefix} ${this.params.derivationSuffix}`}getKeyDeriver(s){return typeof s=="string"&&(s=n.PrivateKey.fromHex(s)),!this.params.keyDeriver||this.params.keyDeriver.rootKey.toHex()!==s.toHex()?new n.KeyDeriver(s):this.params.keyDeriver}lock(s,a){const c=this.getKeyDeriver(s).derivePublicKey(i.brc29ProtocolID,this.getKeyID(),a,!1).toAddress();return this.p2pkh.lock(c)}unlock(s,a,c,u){const l=this.getKeyDeriver(s).derivePrivateKey(i.brc29ProtocolID,this.getKeyID(),a).toHex();return this.p2pkh.unlock((0,e.asBsvSdkPrivateKey)(l),"all",!1,c,u)}}i.ScriptTemplateBRC29=r}(Pb)),Pb}var gp={},ST;function lD(){if(ST)return gp;ST=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.parseTxScriptOffsets=e;const i=Ye();function e(n){const r=new i.Utils.Reader(n),t=[],s=[];r.pos+=4;const a=r.readVarIntNum();for(let u=0;u<a;u++){r.pos+=36;const l=r.readVarIntNum();t.push({vin:u,offset:r.pos,length:l}),r.pos+=l+4}const c=r.readVarIntNum();for(let u=0;u<c;u++){r.pos+=8;const l=r.readVarIntNum();s.push({vout:u,offset:r.pos,length:l}),r.pos+=l}return{inputs:t,outputs:s}}return gp}var bp={},IT;function uk(){if(IT)return bp;IT=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.convertProofToMerklePath=e;const i=Ye();function e(n,r){const t=r.height,s=r.nodes.length,a=Array(s).fill(0).map(()=>[]);let c=r.index;for(let u=0;u<s;u++){const l=r.nodes[u],h=c%2===1,m={offset:h?c-1:c+1};if(l==="*"||u===0&&l===n?m.duplicate=!0:m.hash=l,a[u].push(m),u===0){const d={offset:r.index,hash:n,txid:!0};h?a[0].push(d):a[0].unshift(d)}c=c>>1}return new i.MerklePath(t,a)}return bp}var St={},TT;function Ma(){if(TT)return St;TT=1,Object.defineProperty(St,"__esModule",{value:!0}),St.getIdentityKey=n,St.toWalletNetwork=r,St.makeAtomicBeef=t,St.asBsvSdkTx=s,St.asBsvSdkScript=a,St.asBsvSdkPrivateKey=c,St.asBsvSdkPublickKey=u,St.verifyTruthy=l,St.verifyHexString=h,St.verifyOptionalHexString=f,St.verifyNumber=m,St.verifyInteger=d,St.verifyId=y,St.verifyOneOrNone=b,St.verifyOne=g,St.wait=v,St.randomBytes=_,St.randomBytesHex=S,St.randomBytesBase64=I,St.validateSecondsSinceEpoch=A,St.arraysEqual=R,St.optionalArraysEqual=E,St.maxDate=k,St.sha256Hash=P,St.doubleSha256LE=T,St.doubleSha256BE=M;const i=Ye(),e=Ke();async function n(C){return(await C.getPublicKey({identityKey:!0})).publicKey}function r(C){return C==="main"?"mainnet":"testnet"}function t(C,D){return Array.isArray(D)&&(D=i.Beef.fromBinary(D)),D.mergeTransaction(C),D.toBinaryAtomic(C.id("hex"))}function s(C){return Array.isArray(C)?C=i.Transaction.fromBinary(C):typeof C=="string"&&(C=i.Transaction.fromHex(C)),C}function a(C){return Array.isArray(C)?C=i.Script.fromBinary(C):typeof C=="string"&&(C=i.Script.fromHex(C)),C}function c(C){return i.PrivateKey.fromString(C,"hex")}function u(C){return i.PublicKey.fromString(C)}function l(C,D){if(!C)throw new e.sdk.WERR_INTERNAL(D??"A truthy value is required.");return C}function h(C){if(typeof C!="string")throw new e.sdk.WERR_INTERNAL("A string is required.");return C=C.trim().toLowerCase(),C}function f(C){if(C)return h(C)}function m(C){if(typeof C!="number")throw new e.sdk.WERR_INTERNAL("A number is required.");return C}function d(C){if(typeof C!="number"||!Number.isInteger(C))throw new e.sdk.WERR_INTERNAL("An integer is required.");return C}function y(C){if(C=d(C),C<1)throw new e.sdk.WERR_INTERNAL("id must be valid integer greater than zero.");return C}function b(C){if(C.length>1)throw new e.sdk.WERR_BAD_REQUEST("Result must be unique.");return C[0]}function g(C,D){if(C.length!==1)throw new e.sdk.WERR_BAD_REQUEST(D??"Result must exist and be unique.");return C[0]}function v(C){return new Promise(D=>setTimeout(D,C))}function _(C){return(0,i.Random)(C)}function S(C){return i.Utils.toHex((0,i.Random)(C))}function I(C){return i.Utils.toBase64((0,i.Random)(C))}function A(C){const D=new Date(C*1e3);if(D.getTime()/1e3!==C||C<16e8||C>1e11)throw new e.sdk.WERR_INVALID_PARAMETER("time",'valid "since epoch" unix time');return D}function R(C,D){if(C.length!==D.length)return!1;for(let F=0;F<C.length;F++)if(C[F]!==D[F])return!1;return!0}function E(C,D){return!C&&!D?!0:!C||!D?!1:R(C,D)}function k(C,D){if(C&&D)return C>D?C:D;if(C)return C;if(D)return D}function P(C){return new i.Hash.SHA256().update(C).digest()}function T(C){const D=new i.Hash.SHA256().update(C).digest();return new i.Hash.SHA256().update(D).digest()}function M(C){return T(C).reverse()}return St}var Gl={},kT;function lk(){if(kT)return Gl;kT=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.asString=e,Gl.asArray=n;const i=Ye();function e(r){return typeof r=="string"?r:i.Utils.toHex(r)}function n(r){return Array.isArray(r)?r:i.Utils.toArray(r,"hex")}return Gl}var ET;function Rw(){return ET||(ET=1,function(i){var e=io&&io.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=io&&io.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(uD(),i),n(ck(),i),n(lD(),i),n(uk(),i),n(Ma(),i),n(lk(),i)}(io)),io}var Xl={},rr={};const Nm=(i,e)=>e.some(n=>i instanceof n);let OT,AT;function dD(){return OT||(OT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fD(){return AT||(AT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Cm=new WeakMap,Rb=new WeakMap,q0=new WeakMap;function hD(i){const e=new Promise((n,r)=>{const t=()=>{i.removeEventListener("success",s),i.removeEventListener("error",a)},s=()=>{n(Ea(i.result)),t()},a=()=>{r(i.error),t()};i.addEventListener("success",s),i.addEventListener("error",a)});return q0.set(e,i),e}function pD(i){if(Cm.has(i))return;const e=new Promise((n,r)=>{const t=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",a),i.removeEventListener("abort",a)},s=()=>{n(),t()},a=()=>{r(i.error||new DOMException("AbortError","AbortError")),t()};i.addEventListener("complete",s),i.addEventListener("error",a),i.addEventListener("abort",a)});Cm.set(i,e)}let Mm={get(i,e,n){if(i instanceof IDBTransaction){if(e==="done")return Cm.get(i);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ea(i[e])},set(i,e,n){return i[e]=n,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function dk(i){Mm=i(Mm)}function yD(i){return fD().includes(i)?function(...e){return i.apply(s0(this),e),Ea(this.request)}:function(...e){return Ea(i.apply(s0(this),e))}}function gD(i){return typeof i=="function"?yD(i):(i instanceof IDBTransaction&&pD(i),Nm(i,dD())?new Proxy(i,Mm):i)}function Ea(i){if(i instanceof IDBRequest)return hD(i);if(Rb.has(i))return Rb.get(i);const e=gD(i);return e!==i&&(Rb.set(i,e),q0.set(e,i)),e}const s0=i=>q0.get(i);function bD(i,e,{blocked:n,upgrade:r,blocking:t,terminated:s}={}){const a=indexedDB.open(i,e),c=Ea(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Ea(a.result),u.oldVersion,u.newVersion,Ea(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),t&&u.addEventListener("versionchange",l=>t(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}function mD(i,{blocked:e}={}){const n=indexedDB.deleteDatabase(i);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Ea(n).then(()=>{})}const wD=["get","getKey","getAll","getAllKeys","count"],vD=["put","add","delete","clear"],Nb=new Map;function PT(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Nb.get(e))return Nb.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,t=vD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(t||wD.includes(n)))return;const s=async function(a,...c){const u=this.transaction(a,t?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[n](...c),t&&u.done]))[0]};return Nb.set(e,s),s}dk(i=>({...i,get:(e,n,r)=>PT(e,n)||i.get(e,n,r),has:(e,n)=>!!PT(e,n)||i.has(e,n)}));const xD=["continue","continuePrimaryKey","advance"],RT={},Bm=new WeakMap,fk=new WeakMap,_D={get(i,e){if(!xD.includes(e))return i[e];let n=RT[e];return n||(n=RT[e]=function(...r){Bm.set(this,fk.get(this)[e](...r))}),n}};async function*SD(...i){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...i)),!e)return;e=e;const n=new Proxy(e,_D);for(fk.set(n,e),q0.set(n,s0(e));e;)yield n,e=await(Bm.get(n)||e.continue()),Bm.delete(n)}function NT(i,e){return e===Symbol.asyncIterator&&Nm(i,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Nm(i,[IDBIndex,IDBObjectStore])}dk(i=>({...i,get(e,n,r){return NT(e,n)?SD:i.get(e,n,r)},has(e,n){return NT(e,n)||i.has(e,n)}}));const ID=Object.freeze(Object.defineProperty({__proto__:null,deleteDB:mD,openDB:bD,unwrap:s0,wrap:Ea},Symbol.toStringTag,{value:"Module"})),TD=U8(ID);var Wc={},mp={},CT;function kD(){if(CT)return mp;CT=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.getBeefForTransaction=n;const i=Ye(),e=Ke();async function n(s,a,c){const u=Array.isArray(c.mergeToBeef)?i.Beef.fromBinary(c.mergeToBeef):c.mergeToBeef||new i.Beef;return await t(u,s,a,c,0),u}async function r(s,a,c){var u;s.getServices();const l=await e.EntityProvenTx.fromTxid(a,await s.getServices());return l.proven&&!c.ignoreStorage&&!c.ignoreNewProven&&(l.proven.provenTxId=await s.insertProvenTx(l.proven.toApi())),{proven:(u=l.proven)===null||u===void 0?void 0:u.toApi(),rawTx:l.rawTx}}async function t(s,a,c,u,l){const h=a.maxRecursionDepth;if(h&&h<=l)throw new e.sdk.WERR_INVALID_OPERATION(`Maximum BEEF depth exceeded. Limit is ${a.maxRecursionDepth}`);if(u.knownTxids&&u.knownTxids.indexOf(c)>-1)return s.mergeTxidOnly(c),s;if(!u.ignoreStorage){const d=u.minProofLevel===void 0?void 0:u.minProofLevel+l,y=await a.getValidBeefForTxid(c,s,u.trustSelf,u.knownTxids,void 0,d);if(y)return y}if(u.ignoreServices)throw new e.sdk.WERR_INVALID_PARAMETER(`txid ${c}`,`valid transaction on chain ${a.chain}`);const f=await r(a,c,u);if(f.proven&&u.minProofLevel!==void 0&&u.minProofLevel>l&&(f.proven=void 0),f.proven)return s.mergeRawTx(f.proven.rawTx),s.mergeBump(new e.EntityProvenTx(f.proven).getMerklePath()),s;if(!f.rawTx)throw new e.sdk.WERR_INVALID_PARAMETER(`txid ${c}`,`valid transaction on chain ${a.chain}`);s.mergeRawTx(f.rawTx);const m=(0,e.asBsvSdkTx)(f.rawTx);for(const d of m.inputs){const y=(0,e.verifyTruthy)(d.sourceTXID);s.findTxid(y)||await t(s,a,y,u,l+1)}return s}return mp}var Yl={},MT;function hk(){if(MT)return Yl;MT=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.processAction=n,Yl.shareReqsWithWorld=r;const i=Ye(),e=Ke();async function n(c,u,l){(0,e.stampLog)(l.log,"start storage processActionSdk");const h=(0,e.verifyId)(u.userId),f={sendWithResults:void 0};let m;const d=[...l.sendWith];if(l.isNewTx){const g=await t(c,h,l);if({req:m,log:l.log}=await s(c,h,g),!m)throw new e.sdk.WERR_INTERNAL;l.isNoSend&&!l.isSendWith?(0,e.stampLog)(l.log,"... storage processActionSdk newTx committed noSend"):(d.push(m.txid),(0,e.stampLog)(l.log,`... storage processActionSdk newTx committed sendWith ${m.txid}`))}const{swr:y,ndr:b}=await r(c,h,d,l.isDelayed);return f.sendWithResults=y,f.notDelayedResults=b,(0,e.stampLog)(l.log,"end storage processActionSdk"),f}async function r(c,u,l,h){let f=[],m;if(l.length<1)return{swr:f,ndr:m};const d=await c.getReqsAndBeefToShareWithWorld(l,[]),y=[],b=[];for(const A of d.details){let R="failed";A.status==="alreadySent"?R="unproven":A.status==="readyToSend"&&(R="sending",b.push(new e.EntityProvenTxReq(A.req))),y.push({txid:A.txid,getReq:A,status:R})}const g=b.map(A=>A.id),v=b.map(A=>A.notify.transactionIds||[]).flat();if(b.length>0&&!await d.beef.verify(await c.getServices().getChainTracker()))throw console.log(`VERIFY FALSE BEEF: ${d.beef.toLogString()}`),new e.sdk.WERR_INTERNAL("merged Beef failed validation.");const _=l.length>1?(0,e.randomBytesBase64)(16):void 0;if(h)return g.length>0&&await c.transaction(async A=>{await c.updateProvenTxReq(g,{status:"unsent",batch:_},A),await c.updateTransaction(v,{status:"sending"},A)}),I();if(g.length<1)return I();if(_){for(const A of b)A.batch=_;await c.updateProvenTxReq(g,{batch:_})}const S=await c.attemptToPostReqsToNetwork(b);for(const A of y){const R=A.txid,E=S.details.find(k=>k.txid===R);if(!E)throw new e.sdk.WERR_INTERNAL(`missing details for ${R}`);switch(A.ndr={txid:E.txid,status:"success",competingTxs:E.competingTxs},E.status){case"success":A.status="unproven";break;case"doubleSpend":A.status="failed",A.ndr.status="doubleSpend",E.competingTxs&&(A.ndr.competingBeef=await a(E.competingTxs,c));break;case"serviceError":A.status="sending",A.ndr.status="serviceError";break;case"invalidTx":A.status="failed",A.ndr.status="invalidTx";break;case"unknown":case"invalid":default:throw new e.sdk.WERR_INTERNAL(`processAction with notDelayed status ${E.status} should not occur.`)}}return I();function I(){f=[],m=h?void 0:[];for(const A of y)f.push({txid:A.txid,status:A.status}),A.ndr&&m&&m.push(A.ndr);return{swr:f,ndr:m}}}async function t(c,u,l){if(!l.reference||!l.txid||!l.rawTx)throw new e.sdk.WERR_INVALID_OPERATION("One or more expected params are undefined.");let h;try{h=i.Transaction.fromBinary(l.rawTx)}catch{throw new e.sdk.WERR_INVALID_OPERATION("Parsing serialized transaction failed.")}if(l.txid!==h.id("hex"))throw new e.sdk.WERR_INVALID_OPERATION("Hash of serialized transaction doesn't match expected txid");if(!(await c.getServices()).nLockTimeIsFinal(h))throw new e.sdk.WERR_INVALID_OPERATION(`This transaction is not final.
         Ensure that the transaction meets the rules for being a finalized
         which can be found at https://wiki.bitcoinsv.io/index.php/NLocktime_and_nSequence`);const f=(0,e.parseTxScriptOffsets)(l.rawTx),m=(0,e.verifyOne)(await c.findTransactions({partial:{userId:u,reference:l.reference}}));if(!m.isOutgoing)throw new e.sdk.WERR_INVALID_OPERATION("isOutgoing is not true");if(!m.inputBEEF)throw new e.sdk.WERR_INVALID_OPERATION;const d=i.Beef.fromBinary((0,e.asArray)(m.inputBEEF));if(m.status!=="unsigned"&&m.status!=="unprocessed")throw new e.sdk.WERR_INVALID_OPERATION(`invalid transaction status ${m.status}`);const y=(0,e.verifyId)(m.transactionId),b=await c.findOutputs({partial:{userId:u,transactionId:y}}),g=await c.findOutputs({partial:{userId:u,spentBy:y}}),v=(0,e.verifyOneOrNone)(await c.findCommissions({partial:{transactionId:y,userId:u}}));if(c.commissionSatoshis>0){if(!v)throw new e.sdk.WERR_INTERNAL;if(!h.outputs.some(E=>E.satoshis===v.satoshis&&E.lockingScript.toHex()===(0,e.asString)(v.lockingScript)))throw new e.sdk.WERR_INVALID_OPERATION("Transaction did not include an output to cover service fee.")}const _=e.EntityProvenTxReq.fromTxid(l.txid,l.rawTx,m.inputBEEF);_.addNotifyTransactionId(y);let S,I;if(l.isNoSend&&!l.isSendWith)I={req:"nosend",tx:"nosend"};else if(!l.isNoSend&&l.isDelayed)I={req:"unsent",tx:"unprocessed"};else if(!l.isNoSend&&!l.isDelayed)I={req:"unprocessed",tx:"unprocessed"},S={req:"unmined",tx:"unproven"};else throw new e.sdk.WERR_INTERNAL("logic error");_.status=I.req;const A={reference:l.reference,txid:l.txid,rawTx:l.rawTx,isSendWith:!!l.sendWith&&l.sendWith.length>0,isDelayed:l.isDelayed,isNoSend:l.isNoSend,tx:h,txScriptOffsets:f,transactionId:y,transaction:m,inputOutputs:g,outputOutputs:b,commission:v,beef:d,req:_,outputUpdates:[],transactionUpdate:{txid:l.txid,rawTx:void 0,inputBEEF:void 0,status:I.tx},postStatus:S};for(const R of A.outputOutputs){const E=(0,e.verifyInteger)(R.vout),k=A.txScriptOffsets.outputs[E],P=(0,e.asString)(A.rawTx.slice(k.offset,k.offset+k.length));if(R.lockingScript&&P!==(0,e.asString)(R.lockingScript))throw new e.sdk.WERR_INVALID_OPERATION(`rawTx output locking script for vout ${E} not equal to expected output script.`);if(h.outputs[E].lockingScript.toHex()!==P)throw new e.sdk.WERR_INVALID_OPERATION(`parsed transaction output locking script for vout ${E} not equal to expected output script.`);const T={txid:A.txid,spendable:!0,scriptLength:k.length,scriptOffset:k.offset};k.length>(await c.getSettings()).maxOutputScript&&(T.lockingScript=void 0),A.outputUpdates.push({id:R.outputId,update:T})}return A}async function s(c,u,l){let h=l.log;h=(0,e.stampLog)(h,"start storage commitNewTxToStorage");let f;await c.transaction(async d=>{h=(0,e.stampLog)(h,"... storage commitNewTxToStorage storage transaction start"),f=await l.req.insertOrMerge(c,d),h=(0,e.stampLog)(h,"... storage commitNewTxToStorage req inserted");for(const y of l.outputUpdates)await c.updateOutput(y.id,y.update,d);h=(0,e.stampLog)(h,"... storage commitNewTxToStorage outputs updated"),await c.updateTransaction(l.transactionId,l.transactionUpdate,d),h=(0,e.stampLog)(h,"... storage commitNewTxToStorage storage transaction end")}),h=(0,e.stampLog)(h,"... storage commitNewTxToStorage storage transaction await done");const m={req:(0,e.verifyTruthy)(f),log:h};return h=(0,e.stampLog)(h,"end storage commitNewTxToStorage"),m}async function a(c,u){const l=new i.Beef,h={mergeToBeef:l,ignoreNewProven:!0};for(const f of c)await u.getBeefForTransaction(f,h);return l.toBinary()}return Yl}var kr={},BT;function pk(){if(BT)return kr;BT=1;var i=kr&&kr.__createBinding||(Object.create?function(m,d,y,b){b===void 0&&(b=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(m,b,g)}:function(m,d,y,b){b===void 0&&(b=y),m[b]=d[y]}),e=kr&&kr.__setModuleDefault||(Object.create?function(m,d){Object.defineProperty(m,"default",{enumerable:!0,value:d})}:function(m,d){m.default=d}),n=kr&&kr.__importStar||function(){var m=function(d){return m=Object.getOwnPropertyNames||function(y){var b=[];for(var g in y)Object.prototype.hasOwnProperty.call(y,g)&&(b[b.length]=g);return b},m(d)};return function(d){if(d&&d.__esModule)return d;var y={};if(d!=null)for(var b=m(d),g=0;g<b.length;g++)b[g]!=="default"&&i(y,d,b[g]);return e(y,d),y}}();Object.defineProperty(kr,"__esModule",{value:!0}),kr.attemptToPostReqsToNetwork=a;const r=Ye(),t=n(Jn()),s=Ma();async function a(m,d,y){const{r:b,vreqs:g,txids:v}=await c(m,d,y),_=m.getServices(),S=await _.postBeef(b.beef,v);await u(v,g,S,m,y);const I=l(v,g,S);return await h(v,b,I,m,_,y),b}async function c(m,d,y){const b={status:"success",beef:new r.Beef,details:[],log:""},g=[];for(const v of d)try{const _=!v.rawTx,S=!v.notify.transactionIds||v.notify.transactionIds.length<1,I=!v.inputBEEF;if(_||S||I)v.addHistoryNote({when:new Date().toISOString(),what:"validateReqFailed",noRawTx:_,noTxIds:S,noInputBEEF:I}),v.status="invalid",await v.updateStorageDynamicProperties(m,y),b.details.push({txid:v.txid,req:v,status:"invalid"});else{const A={txid:v.txid,req:v,status:"unknown"};await m.mergeReqToBeefToShareExternally(v.api,b.beef,[],y),g.push(A),b.details.push(A)}}catch(_){const{code:S,message:I}=t.WalletError.fromUnknown(_);v.addHistoryNote({when:new Date().toISOString(),what:"validateReqError",txid:v.txid,code:S,message:I}),v.attempts++,v.attempts>6&&(v.status="invalid",b.details.push({txid:v.txid,req:v,status:"invalid"})),await v.updateStorageDynamicProperties(m,y)}return{r:b,vreqs:g,txids:g.map(v=>v.txid)}}async function u(m,d,y,b,g){for(const v of m){const _=d.find(I=>I.txid===v);if(!_)throw new t.WERR_INTERNAL;const S=[];for(const I of y){S.push(...I.notes||[]);const A=I.txidResults.find(R=>R.txid===v);A&&S.push(...A.notes||[])}for(const I of S)_.req.addHistoryNote(I);await _.req.updateStorageDynamicProperties(b,g)}}function l(m,d,y){const b={};for(const g of m){const v=d.find(S=>S.txid===g),_={txid:g,vreq:v,txidResults:[],status:"success",successCount:0,doubleSpendCount:0,statusErrorCount:0,serviceErrorCount:0,competingTxs:[]};b[g]=_;for(const S of y){const I=S.txidResults.find(A=>A.txid===g);I&&(_.txidResults.push(I),I.status==="success"?_.successCount++:I.doubleSpend?(_.doubleSpendCount++,I.competingTxs&&(_.competingTxs=[...I.competingTxs])):I.serviceError?_.serviceErrorCount++:_.statusErrorCount++),_.competingTxs.length>1&&(_.competingTxs=[...new Set(_.competingTxs)])}_.successCount>0&&_.doubleSpendCount===0?_.status="success":_.doubleSpendCount>0?_.status="doubleSpend":_.statusErrorCount>0?_.status="invalidTx":_.status="serviceError"}return b}async function h(m,d,y,b,g,v){for(const _ of m){const S=y[_],I=S.vreq.req;await I.refreshFromStorage(b,v);const{successCount:A,doubleSpendCount:R,statusErrorCount:E,serviceErrorCount:k}=S,P={when:new Date().toISOString(),what:"aggregateResults",reqStatus:I.status,aggStatus:S.status,attempts:I.attempts,successCount:A,doubleSpendCount:R,statusErrorCount:E,serviceErrorCount:k};if(["completed","unmined"].indexOf(I.status)>=0)continue;S.status==="doubleSpend"&&g&&!v&&await f(S,d.beef,b,g);let T,M;switch(S.status){case"success":T="unmined",M="unproven";break;case"doubleSpend":T="doubleSpend",M="failed";break;case"invalidTx":T="invalid",M="failed";break;case"serviceError":T="sending",M="sending",I.attempts++;break;default:throw new t.WERR_INTERNAL(`unimplemented AggregateStatus ${S.status}`)}if(P.newReqStatus=T,P.newTxStatus=M,P.newAttempts=I.attempts,T&&(I.status=T),I.addHistoryNote(P),await I.updateStorageDynamicProperties(b,v),M){const D=I.notify.transactionIds;D&&await b.updateTransactionsStatus(D,M,v)}const C=d.details.find(D=>D.txid===_);C.status=S.status,C.competingTxs=S.competingTxs}}async function f(m,d,y,b){var g,v;const _=m.vreq.req,S={when:new Date().toISOString(),what:"confirmDoubleSpend"};let I=!1;for(let A=0;A<3;A++){const R=await b.getStatusForTxids([_.txid]);if(S[`getStatus${A}`]=`${R.status}${R.error?`${R.error.code}`:""},${(g=R.results[0])===null||g===void 0?void 0:g.status}`,R.status==="success"&&R.results[0].status!=="unknown"){I=!0;break}else await(0,s.wait)(1e3)}if(I)m.status="success",S.newStatus=m.status;else{const A=r.Transaction.fromBinary(_.rawTx),R=new Set(m.competingTxs);for(const E of A.inputs){const k=(v=d.findTxid(E.sourceTXID))===null||v===void 0?void 0:v.tx;if(!k)throw new t.WERR_INTERNAL(`beef lacks tx for ${E.sourceTXID}`);const P=k.outputs[E.sourceOutputIndex].lockingScript.toHex(),T=b.hashOutputScript(P),M=await b.getScriptHashHistory(T);if(M.status==="success")for(const C of M.history)C.txid!==E.sourceTXID&&C.txid!==m.txid&&R.add(C.txid)}m.competingTxs=[...R].slice(-24),S.competingTxs=m.competingTxs.join(",")}_.addHistoryNote(S)}return kr}var wp={},DT;function ED(){if(DT)return wp;DT=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.listCertificates=i;async function i(e,n,r,t){const s={limit:r.limit,offset:r.offset},a={userId:n.userId,isDeleted:!1};if(r.partial){const u=r.partial;u.type&&(a.type=u.type),u.subject&&(a.subject=u.subject),u.serialNumber&&(a.serialNumber=u.serialNumber),u.certifier&&(a.certifier=u.certifier),u.revocationOutpoint&&(a.revocationOutpoint=u.revocationOutpoint),u.signature&&(a.signature=u.signature)}return await e.transaction(async u=>{const l={partial:a,certifiers:r.certifiers,types:r.types,paged:s,trx:u},h=await e.findCertificates(l),m={totalCertificates:0,certificates:(await Promise.all(h.map(async d=>{const y=await e.findCertificateFields({partial:{certificateId:d.certificateId,userId:n.userId},trx:u});return{...d,fields:Object.fromEntries(y.map(b=>[b.fieldName,b.fieldValue])),masterKeyring:Object.fromEntries(y.map(b=>[b.fieldName,b.masterKey]))}}))).map(d=>({type:d.type,subject:d.subject,serialNumber:d.serialNumber,certifier:d.certifier,revocationOutpoint:d.revocationOutpoint,signature:d.signature,fields:d.fields,verifier:d.verifier,keyring:d.masterKeyring}))};return m.certificates.length<s.limit?m.totalCertificates=m.certificates.length:m.totalCertificates=await e.countCertificates(l),m})}return wp}var cs={},Cb={},ro={},LT;function OD(){if(LT)return ro;LT=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.varUintSize=e,ro.transactionInputSize=n,ro.transactionOutputSize=r,ro.transactionSize=t;const i=Ke();function e(s){if(s<0)throw new i.sdk.WERR_INVALID_PARAMETER("varUint","non-negative");return s<=252?1:s<=65535?3:s<=4294967295?5:9}function n(s){return 36+e(s)+s+4}function r(s){return e(s)+s+8}function t(s,a){return 4+e(s.length)+s.reduce((c,u)=>c+n(u),0)+e(a.length)+a.reduce((c,u)=>c+r(u),0)+4}return ro}var FT;function yk(){return FT||(FT=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.maxPossibleSatoshis=void 0,i.generateChangeSdk=r,i.validateGenerateChangeSdkResult=t,i.validateGenerateChangeSdkParams=a,i.generateChangeSdkMakeStorage=c;const e=Ke(),n=OD();i.maxPossibleSatoshis=0x775f05a073fff;async function r(u,l,h){u.noLogging===!1&&s(u);const f={allocatedChangeInputs:[],changeOutputs:[],size:0,fee:0,satsPerKb:0};try{const m=a(u),d=u.feeModel.value||0,y=[...u.randomVals||[]],b=[],g=()=>{let U=0;return!y||y.length===0?U=Math.random():(U=y.shift()||0,y.push(U)),b.push(U),U},v=(U,z)=>{if(z<U)throw new e.sdk.WERR_INVALID_PARAMETER("max",`less than min (${U}). max is (${z})`);return Math.floor(g()*(z-U+1)+U)},_=u.fixedInputs,S=u.fixedOutputs,I=()=>_.reduce((U,z)=>U+z.satoshis,0)+f.allocatedChangeInputs.reduce((U,z)=>U+z.satoshis,0),A=()=>S.reduce((U,z)=>U+z.satoshis,0),R=()=>f.changeOutputs.reduce((U,z)=>U+z.satoshis,0),E=()=>I()-A()-R(),k=(U,z)=>{const G=[..._.map(Se=>Se.unlockingScriptLength),...Array(f.allocatedChangeInputs.length+(U||0)).fill(u.changeUnlockingScriptLength)],ne=[...S.map(Se=>Se.lockingScriptLength),...Array(f.changeOutputs.length+(z||0)).fill(u.changeLockingScriptLength)];return(0,n.transactionSize)(G,ne)},P=(U,z)=>Math.ceil(k(U,z)/1e3*d),T=(U,z)=>{const G=I()-A()-R()-P(U,z);return!U&&!z&&(M=G),G};let M=0;T();const C=u.targetNetCount!==void 0,D=u.targetNetCount||0,F=()=>f.changeOutputs.length-f.allocatedChangeInputs.length,B=()=>C?F()-1<D:!1,L=async()=>{for(;f.allocatedChangeInputs.length>0;){const U=f.allocatedChangeInputs.pop();U&&await h(U.outputId)}M=T()};for(;C&&D>F()||f.changeOutputs.length===0&&T()>0;)f.changeOutputs.push({satoshis:f.changeOutputs.length===0?u.changeFirstSatoshis:u.changeInitialSatoshis,lockingScriptLength:u.changeLockingScriptLength});if(await(async()=>{let U=!1;const z=async()=>{if(T()>0)return!0;let G;!C&&f.changeOutputs.length===0&&(G=-T(1));const ne=B()?1:0,ce=-T(1,ne)+(ne===1?2*u.changeInitialSatoshis:0),Se=await l(ce,G);return Se?(f.allocatedChangeInputs.push(Se),!U&&T()>0&&(ne==1||f.changeOutputs.length===0)&&f.changeOutputs.push({satoshis:Math.min(T(),f.changeOutputs.length===0?u.changeFirstSatoshis:u.changeInitialSatoshis),lockingScriptLength:u.changeLockingScriptLength}),!0):!1};for(;;){for(await L();T()<0&&await z(););if(T()>=0||f.changeOutputs.length===0)break;for(U=!0;f.changeOutputs.length>0&&T()<0;)f.changeOutputs.pop();if(T()<0)break;const G=[...f.allocatedChangeInputs];for(;G.length>1&&f.changeOutputs.length>1;){const ne=f.changeOutputs.slice(-1)[0],ce=G.findIndex(Se=>Se.satoshis<=ne.satoshis);if(ce<0)break;f.changeOutputs.pop(),G.splice(ce,1)}}})(),T()<0&&m.hasMaxPossibleOutput!==void 0){if(S[m.hasMaxPossibleOutput].satoshis!==i.maxPossibleSatoshis)throw new e.sdk.WERR_INTERNAL;S[m.hasMaxPossibleOutput].satoshis+=T(),f.maxPossibleSatoshisAdjustment={fixedOutputIndex:m.hasMaxPossibleOutput,satoshis:S[m.hasMaxPossibleOutput].satoshis}}if(T()<0)throw await L(),new e.sdk.WERR_INSUFFICIENT_FUNDS(A()+P(),-M);if(f.changeOutputs.length===0&&M>0)throw await L(),new e.sdk.WERR_INSUFFICIENT_FUNDS(A()+P(),u.changeFirstSatoshis);for(;f.changeOutputs.length>0&&M>0;)if(f.changeOutputs.length===1)f.changeOutputs[0].satoshis+=M,M=0;else if(f.changeOutputs[0].satoshis<u.changeInitialSatoshis){const U=Math.min(M,u.changeInitialSatoshis-f.changeOutputs[0].satoshis);M-=U,f.changeOutputs[0].satoshis+=U}else{const U=Math.max(1,Math.floor(v(2500,5e3)/1e4*M));M-=U;const z=v(0,f.changeOutputs.length-1);f.changeOutputs[z].satoshis+=U}f.size=k(),f.fee=E(),f.satsPerKb=d;const{ok:K,log:$}=t(u,f);if(!K)throw new e.sdk.WERR_INTERNAL(`generateChangeSdk error: ${$}`);return f.allocatedChangeInputs.length>4&&f.changeOutputs.length>4&&(console.log("generateChangeSdk_Capture_too_many_ins_and_outs"),s(u)),f}catch(m){throw e.sdk.WalletError.fromUnknown(m).code==="WERR_INSUFFICIENT_FUNDS",m}}function t(u,l){let h=!0,f="";const m=u.fixedInputs.reduce((g,v)=>g+v.satoshis,0)+l.allocatedChangeInputs.reduce((g,v)=>g+v.satoshis,0),d=u.fixedOutputs.reduce((g,v)=>g+v.satoshis,0)+l.changeOutputs.reduce((g,v)=>g+v.satoshis,0);l.fee&&Number.isInteger(l.fee)&&l.fee<0&&(f+=`basic fee error ${l.fee};`,h=!1);const y=m-d;y!==l.fee&&(f+=`exact fee error ${y} !== ${l.fee};`,h=!1);const b=Math.ceil((l.size||0)/1e3*(l.satsPerKb||0));return b!==l.fee&&(f+=`required fee error ${b} !== ${l.fee};`,h=!1),{ok:h,log:f}}function s(u,l){let h=JSON.stringify(u);console.log(`generateChangeSdk params length ${h.length}`);let f=-1;const m=99900;for(;f++,console.log(`generateChangeSdk params ${f} XXX${h.slice(0,m)}XXX`),h=h.slice(m),!(!h||f>100););}function a(u){if(!Array.isArray(u.fixedInputs))throw new e.sdk.WERR_INVALID_PARAMETER("fixedInputs","an array of objects");const l={};if(u.fixedInputs.forEach((h,f)=>{e.sdk.validateSatoshis(h.satoshis,`fixedInputs[${f}].satoshis`),e.sdk.validateInteger(h.unlockingScriptLength,`fixedInputs[${f}].unlockingScriptLength`,void 0,0)}),!Array.isArray(u.fixedOutputs))throw new e.sdk.WERR_INVALID_PARAMETER("fixedOutputs","an array of objects");if(u.fixedOutputs.forEach((h,f)=>{if(e.sdk.validateSatoshis(h.satoshis,`fixedOutputs[${f}].satoshis`),e.sdk.validateInteger(h.lockingScriptLength,`fixedOutputs[${f}].lockingScriptLength`,void 0,0),h.satoshis===i.maxPossibleSatoshis){if(l.hasMaxPossibleOutput!==void 0)throw new e.sdk.WERR_INVALID_PARAMETER(`fixedOutputs[${f}].satoshis`,"valid satoshis amount. Only one 'maxPossibleSatoshis' output allowed.");l.hasMaxPossibleOutput=f}}),u.feeModel=(0,e.validateStorageFeeModel)(u.feeModel),u.feeModel.model!=="sat/kb")throw new e.sdk.WERR_INVALID_PARAMETER("feeModel.model","'sat/kb'");return e.sdk.validateOptionalInteger(u.targetNetCount,"targetNetCount"),e.sdk.validateSatoshis(u.changeFirstSatoshis,"changeFirstSatoshis",1),e.sdk.validateSatoshis(u.changeInitialSatoshis,"changeInitialSatoshis",1),e.sdk.validateInteger(u.changeLockingScriptLength,"changeLockingScriptLength"),e.sdk.validateInteger(u.changeUnlockingScriptLength,"changeUnlockingScriptLength"),l}function c(u){const l=u.map(b=>({...b,spendable:!0}));l.sort((b,g)=>b.satoshis<g.satoshis?-1:b.satoshis>g.satoshis?1:b.outputId<g.outputId?-1:b.outputId>g.outputId?1:0);let h="";for(const b of l)h+=`change ${b.satoshis} ${b.outputId}
`;const f=()=>h,m=b=>(h+=` -> ${b.satoshis} sats, id ${b.outputId}
`,b.spendable=!1,b);return{allocateChangeInput:async(b,g)=>{if(h+=`allocate target ${b} exact ${g}`,g!==void 0){const S=l.find(I=>I.spendable&&I.satoshis===g);if(S)return m(S)}const v=l.find(S=>S.spendable&&S.satoshis>=b);if(v)return m(v);let _;for(let S=l.length-1;S>=0;S--)if(l[S].spendable){_=l[S];break}if(_)return m(_);h+=`
`},releaseChangeInput:async b=>{h+=`release id ${b}
`;const g=l.find(v=>v.outputId===b);if(!g)throw new e.sdk.WERR_INTERNAL(`unknown outputId ${b}`);if(g.spendable)throw new e.sdk.WERR_INTERNAL(`release of spendable outputId ${b}`);g.spendable=!0},getLog:f}}}(Cb)),Cb}var UT;function AD(){if(UT)return cs;UT=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.setDisableDoubleSpendCheckForTest=t,cs.createAction=s,cs.offsetPubKey=v,cs.lockScriptWithKeyOffsetFromPubKey=_,cs.createStorageServiceChargeScript=S;const i=Ye(),e=Ke(),n=yk();let r=!0;function t(I){r=I}async function s(I,A,R,E){if(!R.isNewTx)throw new e.sdk.WERR_INTERNAL;const k=A.userId,{storageBeef:P,beef:T,xinputs:M}=await f(I,k,R),C=h(I,k,R),D="default",F=(0,e.verifyOne)(await I.findOutputBaskets({partial:{userId:k,name:D}}),`Invalid outputGeneration basket "${D}"`),B=await m(I,k,R,F),L=await I.countChangeInputs(k,F.basketId,!R.isDelayed),q=(0,e.validateStorageFeeModel)(I.feeModel),K=await l(I,k,R,P),$={xinputs:M,xoutputs:C,changeBasket:F,noSendChangeIn:B,availableChangeCount:L,feeModel:q,transactionId:K.transactionId},{allocatedChange:U,changeOutputs:z,derivationPrefix:G,maxPossibleSatoshisAdjustment:ne}=await d(I,k,R,$);if(ne){const Re=ne;if($.xoutputs[Re.fixedOutputIndex].satoshis!==n.maxPossibleSatoshis)throw new e.sdk.WERR_INTERNAL;$.xoutputs[Re.fixedOutputIndex].satoshis=Re.satoshis}const ce=z.reduce((Re,Ce)=>Re+Ce.satoshis,0)-U.reduce((Re,Ce)=>Re+Ce.satoshis,0);await I.updateTransaction(K.transactionId,{satoshis:ce});const{outputs:Se,changeVouts:Ie}=await u(I,k,R,$,z),me=await b(I,k,R,U,T),xe=await c(I,k,R,$,U);return{reference:K.reference,version:K.version,lockTime:K.lockTime,inputs:xe,outputs:Se,derivationPrefix:G,inputBeef:me,noSendChangeOutputVouts:R.isNoSend?Ie:void 0}}function a(I,A,R,E){const k=new Date;return{created_at:k,updated_at:k,outputId:0,userId:I,transactionId:A,satoshis:R,vout:E,basketId:void 0,change:!1,customInstructions:void 0,derivationPrefix:void 0,derivationSuffix:void 0,outputDescription:"",lockingScript:void 0,providedBy:"you",purpose:"",senderIdentityKey:void 0,spendable:!0,spendingDescription:void 0,spentBy:void 0,txid:void 0,type:""}}async function c(I,A,R,E,k){const P=[],T=[];for(const C of E.xinputs){const D=C.output;T.push({i:C,o:D}),D&&await I.transaction(async F=>{const B=(0,e.verifyOne)(await I.findOutputs({partial:{outputId:D.outputId},trx:F}));if(B.spendable!=!0||B.spentBy!==void 0)throw new e.sdk.WERR_INVALID_PARAMETER(`inputs[${C.vin}]`,`spendable output. output ${D.txid}:${D.vout} appears to have been spent.`);await I.updateOutput(D.outputId,{spendable:!1,spentBy:E.transactionId,spendingDescription:C.inputDescription},F)})}for(const C of k)T.push({o:C,unlockLen:107});let M=-1;for(const{i:C,o:D,unlockLen:F}of T)if(M++,D){if(!C&&!F)throw new e.sdk.WERR_INTERNAL(`vin ${M} non-fixedInput without unlockLen`);const B=R.includeAllSourceTransactions&&R.isSignAction?await I.getRawTxOfKnownValidTransaction(D.txid):void 0,L={vin:M,sourceTxid:D.txid,sourceVout:D.vout,sourceSatoshis:D.satoshis,sourceLockingScript:(0,e.asString)(D.lockingScript),sourceTransaction:B,unlockingScriptLength:F||C.unlockingScriptLength,providedBy:C&&D.providedBy==="storage"?"you-and-storage":D.providedBy,type:D.type,spendingDescription:D.spendingDescription||void 0,derivationPrefix:D.derivationPrefix||void 0,derivationSuffix:D.derivationSuffix||void 0,senderIdentityKey:D.senderIdentityKey||void 0};P.push(L)}else{if(!C)throw new e.sdk.WERR_INTERNAL(`vin ${M} without output or xinput`);const B={vin:M,sourceTxid:C.outpoint.txid,sourceVout:C.outpoint.vout,sourceSatoshis:C.satoshis,sourceLockingScript:C.lockingScript.toHex(),unlockingScriptLength:C.unlockingScriptLength,providedBy:"you",type:"custom",spendingDescription:void 0,derivationPrefix:void 0,derivationSuffix:void 0,senderIdentityKey:void 0};P.push(B)}return P}async function u(I,A,R,E,k){var P;const T=[],M={};for(const B of E.xoutputs)B.basket!==void 0&&!M[B.basket]&&(M[B.basket]=await I.findOrInsertOutputBasket(A,B.basket));const C={};for(const B of E.xoutputs)for(const L of B.tags)C[L]=await I.findOrInsertOutputTag(A,L);const D=[];for(const B of E.xoutputs){const L=(0,e.asArray)(B.lockingScript);if(B.purpose==="service-charge"){const q=new Date;await I.insertCommission({userId:A,transactionId:E.transactionId,lockingScript:L,satoshis:B.satoshis,isRedeemed:!1,keyOffset:(0,e.verifyTruthy)(B.keyOffset),created_at:q,updated_at:q,commissionId:0});const K=a(A,E.transactionId,B.satoshis,B.vout);K.lockingScript=L,K.providedBy="storage",K.purpose="storage-commission",K.type="custom",K.spendable=!1,D.push({o:K,tags:[]})}else{const q=B.basket?M[B.basket].basketId:void 0,K=a(A,E.transactionId,B.satoshis,B.vout);K.lockingScript=L,K.basketId=q,K.customInstructions=B.customInstructions,K.outputDescription=B.outputDescription,K.providedBy=B.providedBy,K.purpose=B.purpose||"",K.type="custom",D.push({o:K,tags:B.tags})}}for(const B of k)B.spendable=!0,D.push({o:B,tags:[]});if(R.options.randomizeOutputs){const B=[],L=()=>{let U=0;return!B||B.length===0?U=Math.random():(U=B.shift()||0,B.push(U)),U},q=U=>{let z=U.length,G,ne;for(;z!==0;)ne=Math.floor(L()*z),z-=1,G=U[z],U[z]=U[ne],U[ne]=G;return U};let K=-1;const $=Array(D.length);for(let U=0;U<$.length;U++)$[U]=U;q($);for(const U of D){if(K++,U.o.vout!==K)throw new e.sdk.WERR_INTERNAL(`new output ${K} has out of order vout ${U.o.vout}`);U.o.vout=$[K]}}const F=[];for(const{o:B,tags:L}of D){B.outputId=await I.insertOutput(B),B.change&&B.purpose==="change"&&B.providedBy==="storage"&&F.push(B.vout);for(const K of L){const $=C[K];await I.findOrInsertOutputTagMap((0,e.verifyId)(B.outputId),(0,e.verifyId)($.outputTagId))}const q={vout:(0,e.verifyInteger)(B.vout),satoshis:(0,e.verifyTruthy)(B.satoshis),lockingScript:B.lockingScript?(0,e.asString)(B.lockingScript):"",providedBy:(0,e.verifyTruthy)(B.providedBy),purpose:B.purpose||void 0,basket:(P=Object.values(M).find(K=>K.basketId===B.basketId))===null||P===void 0?void 0:P.name,tags:L,outputDescription:B.outputDescription,derivationSuffix:B.derivationSuffix,customInstructions:B.customInstructions};T.push(q)}return{outputs:T,changeVouts:F}}async function l(I,A,R,E){const k=new Date,P={created_at:k,updated_at:k,transactionId:0,version:R.version,lockTime:R.lockTime,status:"unsigned",reference:(0,e.randomBytesBase64)(12),satoshis:0,userId:A,isOutgoing:!0,inputBEEF:E.toBinary(),description:R.description,txid:void 0,rawTx:void 0};P.transactionId=await I.insertTransaction(P);for(const T of R.labels){const M=await I.findOrInsertTxLabel(A,T);await I.findOrInsertTxLabelMap((0,e.verifyId)(P.transactionId),(0,e.verifyId)(M.txLabelId))}return P}function h(I,A,R){const E=[];let k=-1;for(const P of R.outputs){k++;const T={...P,vout:k,providedBy:"you",purpose:void 0,derivationSuffix:void 0,keyOffset:void 0};E.push(T)}if(I.commissionSatoshis>0&&I.commissionPubKeyHex){k++;const{script:P,keyOffset:T}=S(I.commissionPubKeyHex);E.push({lockingScript:P,satoshis:I.commissionSatoshis,outputDescription:"Storage Service Charge",basket:void 0,tags:[],vout:k,providedBy:"storage",purpose:"service-charge",keyOffset:T})}return E}async function f(I,A,R){const E=new i.Beef;if(R.inputs.length===0)return{storageBeef:E,beef:E,xinputs:[]};R.inputBEEF&&E.mergeBeef(R.inputBEEF);const k=R.inputs.map((C,D)=>({...C,vin:D,satoshis:-1,lockingScript:new i.Script,output:void 0})),P=R.options.trustSelf==="known",T={};for(const C of k)T[C.outpoint.txid]=!0;for(const C of E.txs)if(C.isTxidOnly){if(!P)throw new e.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain complete proof data for ${C.txid}`);if(!T[C.txid]&&!await I.verifyKnownValidTransaction(C.txid))throw new e.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain complete proof data for unknown ${C.txid}`)}for(const C of Object.keys(T)){let D=E.findTxid(C);if(!D&&P&&await I.verifyKnownValidTransaction(C)&&(D=E.mergeTxidOnly(C)),!D)throw new e.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain proof data for possibly known ${C}`)}if(!await E.verify(await I.getServices().getChainTracker(),!0))throw console.log(`verifyInputBeef failed, inputBEEF failed to verify.
${E.toLogString()}
`),new e.sdk.WERR_INVALID_PARAMETER("inputBEEF","valid Beef when factoring options.trustSelf");const M=E.clone();for(const C of k){const{txid:D,vout:F}=C.outpoint,B=(0,e.verifyOneOrNone)(await I.findOutputs({partial:{userId:A,txid:D,vout:F}}));if(B){if(B.change)throw new e.sdk.WERR_INVALID_PARAMETER(`inputs[${C.vin}]`,"an unmanaged input. Change outputs are managed by your wallet.");if(C.output=B,!Array.isArray(B.lockingScript)||!Number.isInteger(B.satoshis))throw new e.sdk.WERR_INVALID_PARAMETER(`${D}.${F}`,"output with valid lockingScript and satoshis");if(!r&&!B.spendable&&!R.isNoSend)throw new e.sdk.WERR_INVALID_PARAMETER(`${D}.${F}`,"spendable output unless noSend is true");C.satoshis=(0,e.verifyNumber)(B.satoshis),C.lockingScript=i.Script.fromBinary((0,e.asArray)(B.lockingScript))}else{let L=E.findTxid(D);if(L.isTxidOnly){const{rawTx:K,proven:$}=await I.getProvenOrRawTx(D);if(!K)throw new e.sdk.WERR_INVALID_PARAMETER("inputBEEF",`valid and contain proof data for ${D}`);L=E.mergeRawTx((0,e.asArray)(K)),$&&E.mergeBump(new e.EntityProvenTx($).getMerklePath())}if(F>=L.tx.outputs.length)throw new e.sdk.WERR_INVALID_PARAMETER(`${D}.${F}`,"valid outpoint");const q=L.tx.outputs[F];C.satoshis=(0,e.verifyTruthy)(q.satoshis),C.lockingScript=q.lockingScript}}return{beef:E,storageBeef:M,xinputs:k}}async function m(I,A,R,E){const k=[];if(!R.isNoSend)return[];const P=R.options.noSendChange;if(P&&P.length>0)for(const T of P){const M=(0,e.verifyOneOrNone)(await I.findOutputs({partial:{userId:A,txid:T.txid,vout:T.vout}}));if(!M||M.providedBy!=="storage"||M.purpose!=="change"||M.spendable===!1||Number.isInteger(M.spentBy)||!(0,e.verifyNumber)(M.satoshis)||M.basketId!==E.basketId)throw new e.sdk.WERR_INVALID_PARAMETER("noSendChange outpoint","valid");if(-1<k.findIndex(C=>C.outputId===M.outputId))throw new e.sdk.WERR_INVALID_PARAMETER("noSendChange outpoint","unique. Duplicates are not allowed.");k.push(M)}return k}async function d(I,A,R,E){const k={fixedInputs:E.xinputs.map($=>({satoshis:$.satoshis,unlockingScriptLength:$.unlockingScriptLength})),fixedOutputs:E.xoutputs.map($=>({satoshis:$.satoshis,lockingScriptLength:$.lockingScript.length/2})),feeModel:E.feeModel,changeInitialSatoshis:E.changeBasket.minimumDesiredUTXOValue,changeFirstSatoshis:Math.max(1,Math.round(E.changeBasket.minimumDesiredUTXOValue/4)),changeLockingScriptLength:25,changeUnlockingScriptLength:107,targetNetCount:E.changeBasket.numberOfDesiredUTXOs-E.availableChangeCount,randomVals:R.randomVals},P=[...E.noSendChangeIn],T={},M=async($,U)=>{if(P.length>0){const ce=P.pop();return T[ce.outputId]=ce,await I.updateOutput(ce.outputId,{spendable:!1,spentBy:E.transactionId}),ce.spendable=!1,ce.spentBy=E.transactionId,{outputId:ce.outputId,satoshis:ce.satoshis}}const z=E.changeBasket.basketId,G=await I.allocateChangeInput(A,z,$,U,!R.isDelayed,E.transactionId);return G?(T[G.outputId]=G,{outputId:G.outputId,satoshis:G.satoshis}):void 0},C=async $=>{const U=E.noSendChangeIn.find(z=>z.outputId===$);if(U){P.push(U);return}await I.updateOutput($,{spendable:!0,spentBy:void 0})},D=await(0,n.generateChangeSdk)(k,M,C),F=()=>{let $=0;return!R.randomVals||R.randomVals.length===0?$=Math.random():($=R.randomVals.shift()||0,R.randomVals.push($)),$},B=($,U)=>Math.floor(F()*(U-$+1)+$),L=$=>{let U=[];if(!R.randomVals||R.randomVals.length===0)U=(0,i.Random)($);else for(let z=0;z<$;z++)U.push(B(0,255));return i.Utils.toBase64(U)},q=L(16);return{maxPossibleSatoshisAdjustment:D.maxPossibleSatoshisAdjustment,allocatedChange:D.allocatedChangeInputs.map($=>T[$.outputId]),changeOutputs:D.changeOutputs.map(($,U)=>({created_at:new Date,updated_at:new Date,outputId:0,userId:A,transactionId:E.transactionId,vout:k.fixedOutputs.length+U,satoshis:$.satoshis,basketId:E.changeBasket.basketId,spendable:!1,change:!0,type:"P2PKH",derivationPrefix:q,derivationSuffix:L(16),providedBy:"storage",purpose:"change",customInstructions:void 0,senderIdentityKey:void 0,outputDescription:"",txid:void 0,lockingScript:void 0,spentBy:void 0,spendingDescription:void 0})),derivationPrefix:q}}function y(I,A){if(A.options.returnTXIDOnly)return;const R={};for(const E of A.options.knownTxids)R[E]=!0;for(const E of I.txs.map(k=>k.txid))R[E]&&I.makeTxidOnly(E);return I.toBinary()}async function b(I,A,R,E,k){const P={trustSelf:void 0,knownTxids:R.options.knownTxids,mergeToBeef:k,ignoreStorage:!1,ignoreServices:!0,ignoreNewProven:!1,minProofLevel:void 0};if(!R.options.returnTXIDOnly){for(const T of E)!k.findTxid(T.txid)&&!R.options.knownTxids.find(M=>M===T.txid)&&await I.getBeefForTransaction(T.txid,P);return y(k,R)}}function g(I,A){let R;A!==void 0&&typeof A=="string"?A.length===64?R=i.PrivateKey.fromString(A,"hex"):R=i.PrivateKey.fromWif(A):(R=i.PrivateKey.fromRandom(),A=R.toWif());const E=I.mul(R).encode(!0,void 0),k=(0,e.sha256Hash)(E);return{hashedSecret:new i.BigNumber(k),keyOffset:A}}function v(I,A){const R=i.PublicKey.fromString(I),E=g(R,A),k=new i.Curve().g.mul(E.hashedSecret);return{offsetPubKey:new i.PublicKey(R.add(k)).toString(),keyOffset:E.keyOffset}}function _(I,A){const R=v(I,A),k=i.PublicKey.fromString(R.offsetPubKey).toHash();return{script:new i.P2PKH().lock(k).toHex(),keyOffset:R.keyOffset}}function S(I){return _(I)}return cs}var vp={},HT;function PD(){if(HT)return vp;HT=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.internalizeAction=r;const i=Ye(),e=Ke(),n=hk();async function r(s,a,c){const u=new t(s,a,c);return await u.asyncSetup(),u.isMerge?await u.mergedInternalize():await u.newInternalize(),u.r}class t{constructor(a,c,u){this.storage=a,this.auth=c,this.args=u,this.vargs=e.sdk.validateInternalizeActionArgs(u),this.userId=c.userId,this.r={accepted:!0,isMerge:!1,txid:"",satoshis:0},this.ab=new i.Beef,this.tx=new i.Transaction,this.changeBasket={},this.baskets={},this.basketInsertions=[],this.walletPayments=[],this.eos=[]}get isMerge(){return this.r.isMerge}set isMerge(a){this.r.isMerge=a}get txid(){return this.r.txid}set txid(a){this.r.txid=a}get satoshis(){return this.r.satoshis}set satoshis(a){this.r.satoshis=a}async getBasket(a){let c=this.baskets[a];return c||(c=await this.storage.findOrInsertOutputBasket(this.userId,a),this.baskets[a]=c,c)}async asyncSetup(){({ab:this.ab,tx:this.tx,txid:this.txid}=await this.validateAtomicBeef(this.args.tx));for(const a of this.args.outputs){if(a.outputIndex<0||a.outputIndex>=this.tx.outputs.length)throw new e.sdk.WERR_INVALID_PARAMETER("outputIndex",`a valid output index in range 0 to ${this.tx.outputs.length-1}`);const c=this.tx.outputs[a.outputIndex];switch(a.protocol){case"basket insertion":{if(!a.insertionRemittance||a.paymentRemittance)throw new e.sdk.WERR_INVALID_PARAMETER("basket insertion","valid insertionRemittance and no paymentRemittance");this.basketInsertions.push({...a.insertionRemittance,txo:c,vout:a.outputIndex})}break;case"wallet payment":{if(a.insertionRemittance||!a.paymentRemittance)throw new e.sdk.WERR_INVALID_PARAMETER("wallet payment","valid paymentRemittance and no insertionRemittance");this.walletPayments.push({...a.paymentRemittance,txo:c,vout:a.outputIndex,ignore:!1})}break;default:throw new e.sdk.WERR_INTERNAL(`unexpected protocol ${a.protocol}`)}}if(this.changeBasket=(0,e.verifyOne)(await this.storage.findOutputBaskets({partial:{userId:this.userId,name:"default"}})),this.baskets={},this.etx=(0,e.verifyOneOrNone)(await this.storage.findTransactions({partial:{userId:this.userId,txid:this.txid}})),this.etx&&!(this.etx.status=="completed"||this.etx.status==="unproven"||this.etx.status==="nosend"))throw new e.sdk.WERR_INVALID_PARAMETER("tx",`target transaction of internalizeAction has invalid status ${this.etx.status}.`);if(this.isMerge=!!this.etx,this.isMerge){this.eos=await this.storage.findOutputs({partial:{userId:this.userId,txid:this.txid}});for(const a of this.eos){const c=this.basketInsertions.find(l=>l.vout===a.vout),u=this.walletPayments.find(l=>l.vout===a.vout);if(c&&u)throw new e.sdk.WERR_INVALID_PARAMETER("outputs","unique outputIndex values");c&&(c.eo=a),u&&(u.eo=a)}}for(const a of this.basketInsertions)this.isMerge&&a.eo&&a.eo.basketId===this.changeBasket.basketId&&(this.satoshis-=a.txo.satoshis);for(const a of this.walletPayments)this.isMerge?a.eo?a.eo.basketId===this.changeBasket.basketId?a.ignore=!0:this.satoshis+=a.txo.satoshis:this.satoshis+=a.txo.satoshis:this.satoshis+=a.txo.satoshis}async validateAtomicBeef(a){const c=i.Beef.fromBinary(a);if(!await c.verify(await this.storage.getServices().getChainTracker(),!1)||!c.atomicTxid)throw new e.sdk.WERR_INVALID_PARAMETER("tx","valid AtomicBEEF");const l=c.atomicTxid,h=c.findTxid(l);if(!h)throw new e.sdk.WERR_INVALID_PARAMETER("tx",`valid AtomicBEEF with newest txid of ${l}`);const f=h.tx;return{ab:c,tx:f,txid:l}}async findOrInsertTargetTransaction(a,c){const u=new Date,l={created_at:u,updated_at:u,transactionId:0,status:c,satoshis:a,version:this.tx.version,lockTime:this.tx.lockTime,reference:(0,e.randomBytesBase64)(7),userId:this.userId,isOutgoing:!1,description:this.args.description,inputBEEF:void 0,txid:this.txid,rawTx:void 0},h=await this.storage.findOrInsertTransaction(l);if(!h.isNew){if(!this.isMerge)throw new e.sdk.WERR_INVALID_PARAMETER("tx","target transaction of internalizeAction is undergoing active changes.");await this.storage.updateTransaction(h.tx.transactionId,{satoshis:h.tx.satoshis+a})}return h.tx}async mergedInternalize(){const a=this.etx.transactionId;await this.addLabels(a);for(const c of this.walletPayments)c.eo&&!c.ignore?await this.mergeWalletPaymentForOutput(a,c):c.ignore||await this.storeNewWalletPaymentForOutput(a,c);for(const c of this.basketInsertions)c.eo?await this.mergeBasketInsertionForOutput(a,c):await this.storeNewBasketInsertionForOutput(a,c)}async newInternalize(){this.etx=await this.findOrInsertTargetTransaction(this.satoshis,"unproven");const a=this.etx.transactionId,c=e.EntityProvenTxReq.fromTxid(this.txid,this.tx.toBinary(),this.args.tx);if(c.status="unsent",c.addHistoryNote({what:"internalizeAction",userId:this.userId}),c.addNotifyTransactionId(a),(await this.storage.getProvenOrReq(this.txid,c.toApi())).isNew){const{swr:l,ndr:h}=await(0,n.shareReqsWithWorld)(this.storage,this.userId,[this.txid],!1);if(h[0].status!=="success"){this.r.sendWithResults=l,this.r.notDelayedResults=h;return}}await this.addLabels(a);for(const l of this.walletPayments)await this.storeNewWalletPaymentForOutput(a,l);for(const l of this.basketInsertions)await this.storeNewBasketInsertionForOutput(a,l)}async addLabels(a){for(const c of this.vargs.labels){const u=await this.storage.findOrInsertTxLabel(this.userId,c);await this.storage.findOrInsertTxLabelMap((0,e.verifyId)(a),(0,e.verifyId)(u.txLabelId))}}async addBasketTags(a,c){for(const u of a.tags||[])await this.storage.tagOutput({outputId:c,userId:this.userId},u)}async storeNewWalletPaymentForOutput(a,c){const u=new Date,l={created_at:u,updated_at:u,outputId:0,transactionId:a,userId:this.userId,spendable:!0,lockingScript:c.txo.lockingScript.toBinary(),vout:c.vout,basketId:this.changeBasket.basketId,satoshis:c.txo.satoshis,txid:this.txid,senderIdentityKey:c.senderIdentityKey,type:"P2PKH",providedBy:"storage",purpose:"change",derivationPrefix:c.derivationPrefix,derivationSuffix:c.derivationSuffix,change:!0,spentBy:void 0,customInstructions:void 0,outputDescription:"",spendingDescription:void 0};l.outputId=await this.storage.insertOutput(l),c.eo=l}async mergeWalletPaymentForOutput(a,c){const u=c.eo.outputId,l={basketId:this.changeBasket.basketId,type:"P2PKH",customInstructions:void 0,change:!0,providedBy:"storage",purpose:"change",senderIdentityKey:c.senderIdentityKey,derivationPrefix:c.derivationPrefix,derivationSuffix:c.derivationSuffix};await this.storage.updateOutput(u,l),c.eo={...c.eo,...l}}async mergeBasketInsertionForOutput(a,c){const u=c.eo.outputId,l={basketId:(await this.getBasket(c.basket)).basketId,type:"custom",customInstructions:c.customInstructions,change:!1,providedBy:"you",purpose:"",senderIdentityKey:void 0,derivationPrefix:void 0,derivationSuffix:void 0};await this.storage.updateOutput(u,l),c.eo={...c.eo,...l}}async storeNewBasketInsertionForOutput(a,c){const u=new Date,l={created_at:u,updated_at:u,outputId:0,transactionId:a,userId:this.userId,spendable:!0,lockingScript:c.txo.lockingScript.toBinary(),vout:c.vout,basketId:(await this.getBasket(c.basket)).basketId,satoshis:c.txo.satoshis,txid:this.txid,type:"custom",customInstructions:c.customInstructions,change:!1,spentBy:void 0,outputDescription:"",spendingDescription:void 0,providedBy:"you",purpose:"",senderIdentityKey:void 0,derivationPrefix:void 0,derivationSuffix:void 0};l.outputId=await this.storage.insertOutput(l),await this.addBasketTags(c,l.outputId),c.eo=l}}return vp}var Ql={},ao={},$c={},qT;function RD(){if(qT)return $c;qT=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.EntityBase=void 0,$c.createSyncMap=e;let i=class{constructor(r){this.api=r}toApi(){return this.updateApi(),this.api}};$c.EntityBase=i;function e(){return{provenTx:{entityName:"provenTx",idMap:{},maxUpdated_at:void 0,count:0},outputBasket:{entityName:"outputBasket",idMap:{},maxUpdated_at:void 0,count:0},transaction:{entityName:"transaction",idMap:{},maxUpdated_at:void 0,count:0},provenTxReq:{entityName:"provenTxReq",idMap:{},maxUpdated_at:void 0,count:0},txLabel:{entityName:"txLabel",idMap:{},maxUpdated_at:void 0,count:0},txLabelMap:{entityName:"txLabelMap",idMap:{},maxUpdated_at:void 0,count:0},output:{entityName:"output",idMap:{},maxUpdated_at:void 0,count:0},outputTag:{entityName:"outputTag",idMap:{},maxUpdated_at:void 0,count:0},outputTagMap:{entityName:"outputTagMap",idMap:{},maxUpdated_at:void 0,count:0},certificate:{entityName:"certificate",idMap:{},maxUpdated_at:void 0,count:0},certificateField:{entityName:"certificateField",idMap:{},maxUpdated_at:void 0,count:0},commission:{entityName:"commission",idMap:{},maxUpdated_at:void 0,count:0}}}return $c}var Zl={},jT;function ND(){if(jT)return Zl;jT=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.EntitySyncState=void 0;const i=fn(),e=Ke();let n=class fr extends i.EntityBase{constructor(t){const s=new Date;super(t||{syncStateId:0,created_at:s,updated_at:s,userId:0,storageIdentityKey:"",storageName:"",init:!1,refNum:"",status:"unknown",when:void 0,errorLocal:void 0,errorOther:void 0,satoshis:void 0,syncMap:JSON.stringify((0,i.createSyncMap)())}),this.errorLocal=this.api.errorLocal?JSON.parse(this.api.errorLocal):void 0,this.errorOther=this.api.errorOther?JSON.parse(this.api.errorOther):void 0,this.syncMap=JSON.parse(this.api.syncMap),this.validateSyncMap(this.syncMap)}validateSyncMap(t){for(const s of Object.keys(t)){const a=t[s];typeof a.maxUpdated_at=="string"&&(a.maxUpdated_at=new Date(a.maxUpdated_at))}}static async fromStorage(t,s,a){const{user:c}=(0,e.verifyTruthy)(await t.findOrInsertUser(s));let{syncState:u}=(0,e.verifyTruthy)(await t.findOrInsertSyncStateAuth({userId:c.userId,identityKey:s},a.storageIdentityKey,a.storageName));return(!u.syncMap||u.syncMap==="{}")&&(u.syncMap=JSON.stringify((0,i.createSyncMap)())),new fr(u)}async updateStorage(t,s,a){if(this.updated_at=new Date,this.updateApi(s&&this.id>0),this.id===0)await t.insertSyncState(this.api);else{const c={...this.api};s&&delete c.syncMap,delete c.created_at,await t.updateSyncState((0,e.verifyId)(this.id),c,a)}}updateApi(t){this.api.errorLocal=this.apiErrorLocal,this.api.errorOther=this.apiErrorOther,t||(this.api.syncMap=this.apiSyncMap)}set created_at(t){this.api.created_at=t}get created_at(){return this.api.created_at}set updated_at(t){this.api.updated_at=t}get updated_at(){return this.api.updated_at}set userId(t){this.api.userId=t}get userId(){return this.api.userId}set storageIdentityKey(t){this.api.storageIdentityKey=t}get storageIdentityKey(){return this.api.storageIdentityKey}set storageName(t){this.api.storageName=t}get storageName(){return this.api.storageName}set init(t){this.api.init=t}get init(){return this.api.init}set refNum(t){this.api.refNum=t}get refNum(){return this.api.refNum}set status(t){this.api.status=t}get status(){return this.api.status}set when(t){this.api.when=t}get when(){return this.api.when}set satoshis(t){this.api.satoshis=t}get satoshis(){return this.api.satoshis}get apiErrorLocal(){return this.errorToString(this.errorLocal)}get apiErrorOther(){return this.errorToString(this.errorOther)}get apiSyncMap(){return JSON.stringify(this.syncMap)}get id(){return this.api.syncStateId}set id(t){this.api.syncStateId=t}get entityName(){return"syncState"}get entityTable(){return"sync_states"}static mergeIdMap(t,s){for(const[a,c]of Object.entries(t)){const u=t[a],l=s[a];if(l!==void 0&&l!==u)throw new e.sdk.WERR_INVALID_PARAMETER("syncMap",`an unmapped id or the same mapped id. ${a} maps to ${l} not equal to ${u}`);l===void 0&&(s[a]=c)}}mergeSyncMap(t){fr.mergeIdMap(t.provenTx.idMap,this.syncMap.provenTx.idMap),fr.mergeIdMap(t.outputBasket.idMap,this.syncMap.outputBasket.idMap),fr.mergeIdMap(t.transaction.idMap,this.syncMap.transaction.idMap),fr.mergeIdMap(t.provenTxReq.idMap,this.syncMap.provenTxReq.idMap),fr.mergeIdMap(t.txLabel.idMap,this.syncMap.txLabel.idMap),fr.mergeIdMap(t.output.idMap,this.syncMap.output.idMap),fr.mergeIdMap(t.outputTag.idMap,this.syncMap.outputTag.idMap),fr.mergeIdMap(t.certificate.idMap,this.syncMap.certificate.idMap),fr.mergeIdMap(t.commission.idMap,this.syncMap.commission.idMap)}errorToString(t){if(!t)return;const s={code:t.code,description:t.description,stack:t.stack};return JSON.stringify(s)}equals(t,s){return!1}async mergeNew(t,s,a,c){}async mergeExisting(t,s,a,c,u){return!1}makeRequestSyncChunkArgs(t,s,a,c){const u={identityKey:t,maxRoughSize:a||1e7,maxItems:c||1e3,offsets:[],since:this.when,fromStorageIdentityKey:this.storageIdentityKey,toStorageIdentityKey:s};for(const l of[this.syncMap.provenTx,this.syncMap.outputBasket,this.syncMap.outputTag,this.syncMap.txLabel,this.syncMap.transaction,this.syncMap.output,this.syncMap.txLabelMap,this.syncMap.outputTagMap,this.syncMap.certificate,this.syncMap.certificateField,this.syncMap.commission,this.syncMap.provenTxReq]){if(!l||!l.entityName)debugger;u.offsets.push({name:l.entityName,offset:l.count})}return u}static syncChunkSummary(t){let s="";if(s+=`SYNC CHUNK SUMMARY
  from storage: ${t.fromStorageIdentityKey}
  to storage: ${t.toStorageIdentityKey}
  for user: ${t.userIdentityKey}
`,t.user&&(s+=`  USER activeStorage ${t.user.activeStorage}
`),t.provenTxs){s+=`  PROVEN_TXS
`;for(const a of t.provenTxs)s+=`    ${a.provenTxId} ${a.txid}
`}if(t.provenTxReqs){s+=`  PROVEN_TX_REQS
`;for(const a of t.provenTxReqs)s+=`    ${a.provenTxReqId} ${a.txid} ${a.status} ${a.provenTxId||""}
`}if(t.transactions){s+=`  TRANSACTIONS
`;for(const a of t.transactions)s+=`    ${a.transactionId} ${a.txid} ${a.status} ${a.provenTxId||""} sats:${a.satoshis}
`}if(t.outputs){s+=`  OUTPUTS
`;for(const a of t.outputs)s+=`    ${a.outputId} ${a.txid}.${a.vout} ${a.transactionId} ${a.spendable?"spendable":""} sats:${a.satoshis}
`}return s}async processSyncChunk(t,s,a){var c;const u=[new i.MergeEntity(a.provenTxs,i.EntityProvenTx.mergeFind,this.syncMap.provenTx),new i.MergeEntity(a.outputBaskets,i.EntityOutputBasket.mergeFind,this.syncMap.outputBasket),new i.MergeEntity(a.outputTags,i.EntityOutputTag.mergeFind,this.syncMap.outputTag),new i.MergeEntity(a.txLabels,i.EntityTxLabel.mergeFind,this.syncMap.txLabel),new i.MergeEntity(a.transactions,i.EntityTransaction.mergeFind,this.syncMap.transaction),new i.MergeEntity(a.outputs,i.EntityOutput.mergeFind,this.syncMap.output),new i.MergeEntity(a.txLabelMaps,i.EntityTxLabelMap.mergeFind,this.syncMap.txLabelMap),new i.MergeEntity(a.outputTagMaps,i.EntityOutputTagMap.mergeFind,this.syncMap.outputTagMap),new i.MergeEntity(a.certificates,i.EntityCertificate.mergeFind,this.syncMap.certificate),new i.MergeEntity(a.certificateFields,i.EntityCertificateField.mergeFind,this.syncMap.certificateField),new i.MergeEntity(a.commissions,i.EntityCommission.mergeFind,this.syncMap.commission),new i.MergeEntity(a.provenTxReqs,i.EntityProvenTxReq.mergeFind,this.syncMap.provenTxReq)];let l=0,h=0,f,m=!0;if(a.user){const d=a.user,{found:y,eo:b}=await i.EntityUser.mergeFind(t,this.userId,d);y&&await b.mergeExisting(t,s.since,d)&&(f=(0,e.maxDate)(f,d.updated_at),l++)}for(const d of u){const y=await d.merge(s.since,t,this.userId,this.syncMap);d.esm.count+=((c=d.stateArray)===null||c===void 0?void 0:c.length)||0,l+=y.updates,h+=y.inserts,f=(0,e.maxDate)(f,d.esm.maxUpdated_at),(d.stateArray===void 0||d.stateArray.length>0)&&(m=!1)}if(m){this.when=f;for(const d of u)d.esm.count=0}return await this.updateStorage(t,!1),{done:m,maxUpdated_at:f,updates:l,inserts:h}}};return Zl.EntitySyncState=n,Zl}var Jl={},VT;function CD(){if(VT)return Jl;VT=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.EntityProvenTx=void 0;const i=Ye(),e=Ke(),n=fn();let r=class xo extends n.EntityBase{static async fromTxid(s,a,c){var u;const l={proven:void 0,rawTx:c};if(a.chain,!l.rawTx){const f=await a.getRawTx(s);if(!(f!=null&&f.rawTx))return l;l.rawTx=f.rawTx}const h=await a.getMerklePath(s);if(h.merklePath&&h.header){const f=(u=h.merklePath.path[0].find(m=>m.hash===s))===null||u===void 0?void 0:u.offset;if(f!==void 0){const m={created_at:new Date,updated_at:new Date,provenTxId:0,txid:s,height:h.header.height,index:f,merklePath:h.merklePath.toBinary(),rawTx:l.rawTx,blockHash:h.header.hash,merkleRoot:h.header.merkleRoot};l.proven=new xo(m)}}return l}constructor(s){const a=new Date;super(s||{provenTxId:0,created_at:a,updated_at:a,txid:"",height:0,index:0,merklePath:[],rawTx:[],blockHash:"",merkleRoot:""})}updateApi(){}getMerklePath(){return this._mp||(this._mp=i.MerklePath.fromBinary(this.api.merklePath)),this._mp}get provenTxId(){return this.api.provenTxId}set provenTxId(s){this.api.provenTxId=s}get created_at(){return this.api.created_at}set created_at(s){this.api.created_at=s}get updated_at(){return this.api.updated_at}set updated_at(s){this.api.updated_at=s}get txid(){return this.api.txid}set txid(s){this.api.txid=s}get height(){return this.api.height}set height(s){this.api.height=s}get index(){return this.api.index}set index(s){this.api.index=s}get merklePath(){return this.api.merklePath}set merklePath(s){this.api.merklePath=s}get rawTx(){return this.api.rawTx}set rawTx(s){this.api.rawTx=s}get blockHash(){return this.api.blockHash}set blockHash(s){this.api.blockHash=s}get merkleRoot(){return this.api.merkleRoot}set merkleRoot(s){this.api.merkleRoot=s}get id(){return this.api.provenTxId}set id(s){this.api.provenTxId=s}get entityName(){return"provenTx"}get entityTable(){return"proven_txs"}equals(s,a){const c=this.toApi();if(c.txid!=s.txid||c.height!=s.height||c.index!=s.index||!(0,e.arraysEqual)(c.merklePath,s.merklePath)||!(0,e.arraysEqual)(c.rawTx,s.rawTx)||c.blockHash!==s.blockHash||c.merkleRoot!==s.merkleRoot)return!1;if(a){if(c.provenTxId!==a.provenTx.idMap[s.provenTxId])return!1}else if(c.provenTxId!==s.provenTxId)return!1;return!0}static async mergeFind(s,a,c,u,l){const h=(0,e.verifyOneOrNone)(await s.findProvenTxs({partial:{txid:c.txid},trx:l}));return{found:!!h,eo:new xo(h||{...c}),eiId:(0,e.verifyId)(c.provenTxId)}}async mergeNew(s,a,c,u){this.provenTxId=0,this.provenTxId=await s.insertProvenTx(this.toApi(),u)}async mergeExisting(s,a,c,u,l){return!1}static async fromReq(s,a,c){if(!s.txid)throw new e.sdk.WERR_MISSING_PARAMETER("req.txid");if(!s.rawTx)throw new e.sdk.WERR_MISSING_PARAMETER("req.rawTx");if(!s.rawTx)throw new e.sdk.WERR_INTERNAL("rawTx must be valid");for(const l of a.notes||[])s.addHistoryNote(l,!0);if(!a.name&&!a.merklePath&&!a.error)return;if(!a.merklePath){if(s.created_at){const l=Date.now()-s.created_at.getTime(),h=Math.ceil(l<1?0:l/(1e3*60));if(s.attempts>xo.getProofAttemptsLimit&&h>xo.getProofMinutes){const f=xo.getProofAttemptsLimit,{attempts:m}=s;s.addHistoryNote({what:"getMerklePathGiveUp",attempts:m,limit:f,ageInMinutes:h},!0),s.notified=!1,s.status="invalid"}}return}c&&s.attempts++;const u=Array.isArray(a.merklePath)?a.merklePath:[a.merklePath];for(const l of u)try{const h=new Date,f=l.path[0].find(d=>d.txid===!0&&d.hash===s.txid);if(!f)throw s.addHistoryNote({what:"getMerklePathTxidNotFound"},!0),new e.sdk.WERR_INTERNAL("merkle path does not contain leaf for txid");return new xo({created_at:h,updated_at:h,provenTxId:0,txid:s.txid,height:l.blockHeight,index:f.offset,merklePath:l.toBinary(),rawTx:s.rawTx,merkleRoot:a.header.merkleRoot,blockHash:a.header.hash})}catch(h){const{code:f,description:m}=e.sdk.WalletError.fromUnknown(h),{attempts:d}=s;s.addHistoryNote({what:"getMerklePathProvenError",attempts:d,code:f,description:m},!0)}}};return Jl.EntityProvenTx=r,r.getProofAttemptsLimit=8,r.getProofMinutes=60,Jl}var ed={},KT;function MD(){if(KT)return ed;KT=1,Object.defineProperty(ed,"__esModule",{value:!0}),ed.EntityProvenTxReq=void 0;const i=Ke(),e=fn();let n=class Ia extends e.EntityBase{static async fromStorageTxid(t,s,a){const c=(0,i.verifyOneOrNone)(await t.findProvenTxReqs({partial:{txid:s},trx:a}));if(c)return new Ia(c)}static async fromStorageId(t,s,a){const c=(0,i.verifyOneOrNone)(await t.findProvenTxReqs({partial:{provenTxReqId:s},trx:a}));if(!c)throw new i.sdk.WERR_INTERNAL(`proven_tx_reqs with id ${s} is missing.`);return new Ia(c)}static fromTxid(t,s,a){const c=new Date;return new Ia({provenTxReqId:0,created_at:c,updated_at:c,txid:t,inputBEEF:a,rawTx:s,status:"unknown",history:"{}",notify:"{}",attempts:0,notified:!1})}packApiHistory(){this.api.history=JSON.stringify(this.history)}packApiNotify(){this.api.notify=JSON.stringify(this.notify)}unpackApiHistory(){this.history=JSON.parse(this.api.history)}unpackApiNotify(){this.notify=JSON.parse(this.api.notify)}get apiHistory(){return this.packApiHistory(),this.api.history}get apiNotify(){return this.packApiNotify(),this.api.notify}set apiHistory(t){this.api.history=t,this.unpackApiHistory()}set apiNotify(t){this.api.notify=t,this.unpackApiNotify()}updateApi(){this.packApiHistory(),this.packApiNotify()}unpackApi(){if(this.unpackApiHistory(),this.unpackApiNotify(),this.notify.transactionIds){const t=[];for(const s of this.notify.transactionIds)Number.isInteger(s)&&!t.some(a=>a===s)&&t.push(s);this.notify.transactionIds=t}}async refreshFromStorage(t,s){const a=(0,i.verifyOne)(await t.findProvenTxReqs({partial:{provenTxReqId:this.id},trx:s}));this.api=a,this.unpackApi()}constructor(t){const s=new Date;super(t||{provenTxReqId:0,created_at:s,updated_at:s,txid:"",rawTx:[],history:"",notify:"",attempts:0,status:"unknown",notified:!1}),this.history={},this.notify={},this.unpackApi()}historySince(t){const s={notes:[]},a=t.toISOString(),c=this.history.notes;if(c&&s.notes)for(const u of c)u.when&&u.when>a&&s.notes.push(u);return s}historyPretty(t,s=0){const a=t?this.historySince(t):{...this.history};if(!a.notes)return"";const c=t?t.toISOString():void 0;let u="";for(const l of a.notes)c&&l.when&&l.when<c||(u+=this.prettyNote(l)+`
`);return u}prettyNote(t){let s=`${t.when}: ${t.what}`;for(const[a,c]of Object.entries(t))a!=="when"&&a!=="what"&&(typeof c=="string"?s+=" "+a+":`"+c+"`":s+=" "+a+":"+c);return s}getHistorySummary(){const t={setToCompleted:!1,setToUnmined:!1,setToCallback:!1,setToDoubleSpend:!1,setToSending:!1,setToUnconfirmed:!1},s=this.history;if(s.notes)for(const a of s.notes)this.parseHistoryNote(a,t);return t}parseHistoryNote(t,s){const a=s||{setToCompleted:!1,setToUnmined:!1,setToCallback:!1,setToDoubleSpend:!1,setToSending:!1,setToUnconfirmed:!1};let c=this.prettyNote(t);try{switch(t.what){case"status":switch(t.status_now){case"completed":a.setToCompleted=!0;break;case"unmined":a.setToUnmined=!0;break;case"callback":a.setToCallback=!0;break;case"doubleSpend":a.setToDoubleSpend=!0;break;case"sending":a.setToSending=!0;break;case"unconfirmed":a.setToUnconfirmed=!0;break;default:break}break;default:break}}catch{}return c}addNotifyTransactionId(t){if(!Number.isInteger(t))throw new i.sdk.WERR_INVALID_PARAMETER("id","integer");const s=new Set(this.notify.transactionIds||[]);s.add(t),this.notify.transactionIds=[...s].sort((a,c)=>a>c?1:a<c?-1:0),this.notified=!1}addHistoryNote(t,s){this.history.notes||(this.history.notes=[]),t.when||(t.when=new Date().toISOString()),s&&(this.history.notes=this.history.notes.filter(c=>c.what!==t.what||c.when&&c.when>t.when));let a=!0;for(const c of this.history.notes){let u=!0;for(const[l,h]of Object.entries(c))if(h!==t[l]){u=!1;break}if(u&&(a=!1),!a)break}if(a){this.history.notes.push(t);const c=u=>`${u.when} ${u.what}`;this.history.notes.sort((u,l)=>c(u)<c(l)?-1:c(u)>c(l)?1:0)}}async updateStorage(t,s){this.updated_at=new Date,this.updateApi(),this.id===0&&await t.insertProvenTxReq(this.api);const a={...this.api};await t.updateProvenTxReq(this.id,a,s)}async updateStorageDynamicProperties(t,s){this.updated_at=new Date,this.updateApi();const a={updated_at:this.api.updated_at,provenTxId:this.api.provenTxId,status:this.api.status,history:this.api.history,notify:this.api.notify,notified:this.api.notified,attempts:this.api.attempts,batch:this.api.batch};t.isStorageProvider()?await t.updateProvenTxReqDynamics(this.id,a,s):await t.runAsStorageProvider(async u=>{await u.updateProvenTxReqDynamics(this.id,a,s)})}async insertOrMerge(t,s){return await t.transaction(async c=>{let u=this.toApi();const{req:l,isNew:h}=await t.findOrInsertProvenTxReq(u,c);if(h)return new Ia(l);{const f=new Ia(l);return f.mergeNotifyTransactionIds(u),f.mergeHistory(u,void 0,!0),await f.updateStorage(t,c),f}},s)}get status(){return this.api.status}set status(t){t!==this.api.status&&(this.addHistoryNote({what:"status",status_was:this.api.status,status_now:t}),this.api.status=t)}get provenTxReqId(){return this.api.provenTxReqId}set provenTxReqId(t){this.api.provenTxReqId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get txid(){return this.api.txid}set txid(t){this.api.txid=t}get inputBEEF(){return this.api.inputBEEF}set inputBEEF(t){this.api.inputBEEF=t}get rawTx(){return this.api.rawTx}set rawTx(t){this.api.rawTx=t}get attempts(){return this.api.attempts}set attempts(t){this.api.attempts=t}get provenTxId(){return this.api.provenTxId}set provenTxId(t){this.api.provenTxId=t}get notified(){return this.api.notified}set notified(t){this.api.notified=t}get batch(){return this.api.batch}set batch(t){this.api.batch=t}get id(){return this.api.provenTxReqId}set id(t){this.api.provenTxReqId=t}get entityName(){return"provenTxReq"}get entityTable(){return"proven_tx_reqs"}equals(t,s){const a=this.toApi();if(a.txid!=t.txid||!(0,i.arraysEqual)(a.rawTx,t.rawTx)||!a.inputBEEF&&t.inputBEEF||a.inputBEEF&&!t.inputBEEF||a.inputBEEF&&t.inputBEEF&&!(0,i.arraysEqual)(a.inputBEEF,t.inputBEEF)||a.batch!=t.batch)return!1;if(s){if(a.provenTxReqId!==s.provenTxReq.idMap[(0,i.verifyId)(t.provenTxReqId)]||!a.provenTxId&&t.provenTxId||a.provenTxId&&!t.provenTxId||t.provenTxId&&a.provenTxId!==s.provenTx.idMap[t.provenTxId])return!1}else if(a.attempts!=t.attempts||a.history!=t.history||a.notify!=t.notify||a.provenTxReqId!==t.provenTxReqId||a.provenTxId!==t.provenTxId)return!1;return!0}static async mergeFind(t,s,a,c,u){const l=(0,i.verifyOneOrNone)(await t.findProvenTxReqs({partial:{txid:a.txid},trx:u}));return{found:!!l,eo:new Ia(l||{...a}),eiId:(0,i.verifyId)(a.provenTxReqId)}}mapNotifyTransactionIds(t){const s=this.notify.transactionIds||[];this.notify.transactionIds=[];for(const a of s){const c=t.transaction.idMap[a];c&&this.addNotifyTransactionId(c)}}mergeNotifyTransactionIds(t,s){var a;const c=new Ia(t);if(c.notify.transactionIds){(a=this.notify).transactionIds||(a.transactionIds=[]);for(const u of c.notify.transactionIds){const l=s?s.transaction.idMap[u]:u;l&&this.addNotifyTransactionId(l)}}}mergeHistory(t,s,a){const c=new Ia(t);if(c.history.notes)for(const u of c.history.notes)this.addHistoryNote(u)}static isTerminalStatus(t){return i.sdk.ProvenTxReqTerminalStatus.some(s=>s===t)}async mergeNew(t,s,a,c){this.provenTxId&&(this.provenTxId=a.provenTx.idMap[this.provenTxId]),this.mapNotifyTransactionIds(a),this.provenTxReqId=0,this.provenTxReqId=await t.insertProvenTxReq(this.toApi(),c)}async mergeExisting(t,s,a,c,u){if(!this.batch&&a.batch)this.batch=a.batch;else if(this.batch&&a.batch&&this.batch!==a.batch)throw new i.sdk.WERR_INTERNAL("ProvenTxReq merge batch not equal.");return this.mergeHistory(a,c,!0),this.mergeNotifyTransactionIds(a,c),this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateProvenTxReq(this.id,this.toApi(),u),!1}};return ed.EntityProvenTxReq=n,ed}var td={},WT;function BD(){if(WT)return td;WT=1,Object.defineProperty(td,"__esModule",{value:!0}),td.MergeEntity=void 0;const i=Ke();let e=class{constructor(r,t,s){this.stateArray=r,this.find=t,this.esm=s,this.idMap=s.idMap}updateSyncMap(r,t,s){const a=(0,i.verifyId)(t),c=(0,i.verifyId)(s);if(r[a]===void 0)r[a]=c;else if(r[a]!==c)throw new i.sdk.WERR_INTERNAL(`updateSyncMap map[${t}] can't override ${r[a]} with ${c}`)}async merge(r,t,s,a,c){let u=0,l=0;if(!this.stateArray)return{inserts:u,updates:l};for(const h of this.stateArray){this.esm.maxUpdated_at=(0,i.maxDate)(this.esm.maxUpdated_at,h.updated_at);try{const{found:f,eo:m,eiId:d}=await this.find(t,s,h,a,c);f?await m.mergeExisting(t,r,h,a,c)&&l++:(await m.mergeNew(t,s,a,c),u++),d>-1&&this.updateSyncMap(this.idMap,d,m.id)}catch(f){throw f}}return{inserts:u,updates:l}}};return td.MergeEntity=e,td}var nd={},$T;function DD(){if($T)return nd;$T=1,Object.defineProperty(nd,"__esModule",{value:!0}),nd.EntityOutputBasket=void 0;const i=Ke(),e=fn();let n=class gk extends e.EntityBase{constructor(t){const s=new Date;super(t||{basketId:0,created_at:s,updated_at:s,userId:0,name:"",numberOfDesiredUTXOs:0,minimumDesiredUTXOValue:0,isDeleted:!1})}get basketId(){return this.api.basketId}set basketId(t){this.api.basketId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get name(){return this.api.name}set name(t){this.api.name=t}get numberOfDesiredUTXOs(){return this.api.numberOfDesiredUTXOs}set numberOfDesiredUTXOs(t){this.api.numberOfDesiredUTXOs=t}get minimumDesiredUTXOValue(){return this.api.minimumDesiredUTXOValue}set minimumDesiredUTXOValue(t){this.api.minimumDesiredUTXOValue=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){return this.api.basketId}set id(t){this.api.basketId=t}get entityName(){return"outputBasket"}get entityTable(){return"output_baskets"}updateApi(){}equals(t,s){const a=this.api;if(a.name!=t.name||a.numberOfDesiredUTXOs!=t.numberOfDesiredUTXOs||a.minimumDesiredUTXOValue!=t.minimumDesiredUTXOValue)return!1;if(s){if(a.basketId!==s.outputBasket.idMap[(0,i.verifyId)(t.basketId)])return!1}else if(a.basketId!==t.basketId||a.userId!==t.userId)return!1;return!0}static async mergeFind(t,s,a,c,u){const l=(0,i.verifyOneOrNone)(await t.findOutputBaskets({partial:{name:a.name,userId:s},trx:u}));return{found:!!l,eo:new gk(l||{...a}),eiId:(0,i.verifyId)(a.basketId)}}async mergeNew(t,s,a,c){this.userId=s,this.name||(this.name="default"),this.basketId=0,this.basketId=await t.insertOutputBasket(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.minimumDesiredUTXOValue=a.minimumDesiredUTXOValue,this.numberOfDesiredUTXOs=a.numberOfDesiredUTXOs,this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateOutputBasket(this.id,this.toApi(),u),l=!0),l}};return nd.EntityOutputBasket=n,nd}var id={},zT;function LD(){if(zT)return id;zT=1,Object.defineProperty(id,"__esModule",{value:!0}),id.EntityUser=void 0;const i=Ke(),e=fn();let n=class bk extends e.EntityBase{constructor(t){const s=new Date;super(t||{userId:0,created_at:s,updated_at:s,identityKey:"",activeStorage:""})}updateApi(){}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get identityKey(){return this.api.identityKey}set identityKey(t){this.api.identityKey=t}get activeStorage(){return this.api.activeStorage}set activeStorage(t){this.api.activeStorage=t}get id(){return this.api.userId}set id(t){this.api.userId=t}get entityName(){return"user"}get entityTable(){return"users"}equals(t,s){const a=this.toApi();return!(a.identityKey!=t.identityKey||a.activeStorage!=t.activeStorage)}static async mergeFind(t,s,a,c){const u=(0,i.verifyOneOrNone)(await t.findUsers({partial:{identityKey:a.identityKey},trx:c}));if(u&&u.userId!=s)throw new i.sdk.WERR_INTERNAL("logic error, userIds don not match.");return{found:!!u,eo:new bk(u||{...a}),eiId:(0,i.verifyId)(a.userId)}}async mergeNew(t,s,a,c){throw new i.sdk.WERR_INTERNAL("a sync chunk merge must never create a new user")}async mergeExisting(t,s,a,c,u){let l=!1;return(a.updated_at>this.updated_at||this.activeStorage===void 0&&a.activeStorage!==void 0)&&(this.activeStorage=a.activeStorage,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateUser(this.id,this.toApi(),u),l=!0),l}};return id.EntityUser=n,id}var rd={},GT;function FD(){if(GT)return rd;GT=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.EntityTxLabelMap=void 0;const i=Ke(),e=fn();let n=class mk extends e.EntityBase{constructor(t){const s=new Date;super(t||{created_at:s,updated_at:s,transactionId:0,txLabelId:0,isDeleted:!1})}updateApi(){}get txLabelId(){return this.api.txLabelId}set txLabelId(t){this.api.txLabelId=t}get transactionId(){return this.api.transactionId}set transactionId(t){this.api.transactionId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){throw new i.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"txLabelMap"}get entityTable(){return"tx_labels_map"}equals(t,s){const a=this.toApi();return!(a.transactionId!==(s?s.transaction.idMap[(0,i.verifyId)(t.transactionId)]:t.transactionId)||a.txLabelId!==(s?s.txLabel.idMap[(0,i.verifyId)(t.txLabelId)]:t.txLabelId)||a.isDeleted!==t.isDeleted)}static async mergeFind(t,s,a,c,u){const l=c.transaction.idMap[a.transactionId],h=c.txLabel.idMap[a.txLabelId],f=(0,i.verifyOneOrNone)(await t.findTxLabelMaps({partial:{transactionId:l,txLabelId:h},trx:u}));return{found:!!f,eo:new mk(f||{...a}),eiId:-1}}async mergeNew(t,s,a,c){this.transactionId=a.transaction.idMap[this.transactionId],this.txLabelId=a.txLabel.idMap[this.txLabelId],await t.insertTxLabelMap(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateTxLabelMap(this.transactionId,this.txLabelId,this.toApi(),u),l=!0),l}};return rd.EntityTxLabelMap=n,rd}var ad={},XT;function UD(){if(XT)return ad;XT=1,Object.defineProperty(ad,"__esModule",{value:!0}),ad.EntityTxLabel=void 0;const i=Ke(),e=fn();let n=class wk extends e.EntityBase{constructor(t){const s=new Date;super(t||{txLabelId:0,created_at:s,updated_at:s,label:"",userId:0,isDeleted:!1})}updateApi(){}get txLabelId(){return this.api.txLabelId}set txLabelId(t){this.api.txLabelId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get label(){return this.api.label}set label(t){this.api.label=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){return this.api.txLabelId}set id(t){this.api.txLabelId=t}get entityName(){return"txLabel"}get entityTable(){return"tx_labels"}equals(t,s){const a=this.toApi();return!(a.label!=t.label||a.isDeleted!=t.isDeleted||!s&&a.userId!==t.userId)}static async mergeFind(t,s,a,c,u){const l=(0,i.verifyOneOrNone)(await t.findTxLabels({partial:{label:a.label,userId:s},trx:u}));return{found:!!l,eo:new wk(l||{...a}),eiId:(0,i.verifyId)(a.txLabelId)}}async mergeNew(t,s,a,c){this.userId=s,this.txLabelId=0,this.txLabelId=await t.insertTxLabel(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateTxLabel(this.id,this.toApi(),u),l=!0),l}};return ad.EntityTxLabel=n,ad}var sd={},YT;function HD(){if(YT)return sd;YT=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.EntityOutputTag=void 0;const i=Ke(),e=fn();let n=class vk extends e.EntityBase{constructor(t){const s=new Date;super(t||{outputTagId:0,created_at:s,updated_at:s,tag:"",userId:0,isDeleted:!1})}updateApi(){}get outputTagId(){return this.api.outputTagId}set outputTagId(t){this.api.outputTagId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get tag(){return this.api.tag}set tag(t){this.api.tag=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){return this.api.outputTagId}set id(t){this.api.outputTagId=t}get entityName(){return"outputTag"}get entityTable(){return"output_tags"}equals(t,s){const a=this.toApi();return!(a.tag!=t.tag||a.isDeleted!=t.isDeleted||!s&&a.userId!==t.userId)}static async mergeFind(t,s,a,c,u){const l=(0,i.verifyOneOrNone)(await t.findOutputTags({partial:{tag:a.tag,userId:s},trx:u}));return{found:!!l,eo:new vk(l||{...a}),eiId:(0,i.verifyId)(a.outputTagId)}}async mergeNew(t,s,a,c){this.userId=s,this.outputTagId=0,this.outputTagId=await t.insertOutputTag(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateOutputTag(this.id,this.toApi(),u),l=!0),l}};return sd.EntityOutputTag=n,sd}var od={},QT;function qD(){if(QT)return od;QT=1,Object.defineProperty(od,"__esModule",{value:!0}),od.EntityOutputTagMap=void 0;const i=Ke(),e=fn();let n=class xk extends e.EntityBase{constructor(t){const s=new Date;super(t||{created_at:s,updated_at:s,outputId:0,outputTagId:0,isDeleted:!1})}updateApi(){}get outputTagId(){return this.api.outputTagId}set outputTagId(t){this.api.outputTagId=t}get outputId(){return this.api.outputId}set outputId(t){this.api.outputId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){throw new i.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"outputTagMap"}get entityTable(){return"output_tags_map"}equals(t,s){const a=this.toApi();return!(a.outputId!==(s?s.output.idMap[(0,i.verifyId)(t.outputId)]:t.outputId)||a.outputTagId!==(s?s.outputTag.idMap[(0,i.verifyId)(t.outputTagId)]:t.outputTagId)||a.isDeleted!==t.isDeleted)}static async mergeFind(t,s,a,c,u){const l=c.output.idMap[a.outputId],h=c.outputTag.idMap[a.outputTagId],f=(0,i.verifyOneOrNone)(await t.findOutputTagMaps({partial:{outputId:l,outputTagId:h},trx:u}));return{found:!!f,eo:new xk(f||{...a}),eiId:-1}}async mergeNew(t,s,a,c){this.outputId=a.output.idMap[this.outputId],this.outputTagId=a.outputTag.idMap[this.outputTagId],await t.insertOutputTagMap(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateOutputTagMap(this.outputId,this.outputTagId,this.toApi(),u),l=!0),l}};return od.EntityOutputTagMap=n,od}var cd={},ZT;function jD(){if(ZT)return cd;ZT=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.EntityCommission=void 0;const i=Ke(),e=fn();let n=class _k extends e.EntityBase{constructor(t){const s=new Date;super(t||{commissionId:0,created_at:s,updated_at:s,transactionId:0,userId:0,isRedeemed:!1,keyOffset:"",lockingScript:[],satoshis:0})}updateApi(){}get commissionId(){return this.api.commissionId}set commissionId(t){this.api.commissionId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get transactionId(){return this.api.transactionId}set transactionId(t){this.api.transactionId=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get isRedeemed(){return this.api.isRedeemed}set isRedeemed(t){this.api.isRedeemed=t}get keyOffset(){return this.api.keyOffset}set keyOffset(t){this.api.keyOffset=t}get lockingScript(){return this.api.lockingScript}set lockingScript(t){this.api.lockingScript=t}get satoshis(){return this.api.satoshis}set satoshis(t){this.api.satoshis=t}get id(){return this.api.commissionId}set id(t){this.api.commissionId=t}get entityName(){return"commission"}get entityTable(){return"commissions"}equals(t,s){return!(this.isRedeemed!==t.isRedeemed||this.transactionId!==(s?s.transaction.idMap[t.transactionId]:t.transactionId)||this.keyOffset!==t.keyOffset||!(0,i.arraysEqual)(this.lockingScript,t.lockingScript)||this.satoshis!==t.satoshis)}static async mergeFind(t,s,a,c,u){const l=c.transaction.idMap[a.transactionId],h=(0,i.verifyOneOrNone)(await t.findCommissions({partial:{transactionId:l,userId:s},trx:u}));return{found:!!h,eo:new _k(h||{...a}),eiId:(0,i.verifyId)(a.commissionId)}}async mergeNew(t,s,a,c){this.transactionId&&(this.transactionId=a.transaction.idMap[this.transactionId]),this.userId=s,this.commissionId=0,this.commissionId=await t.insertCommission(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.isRedeemed=a.isRedeemed,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateCommission(this.id,this.toApi(),u),l=!0),l}};return cd.EntityCommission=n,cd}var ud={},JT;function VD(){if(JT)return ud;JT=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.EntityCertificate=void 0;const i=Ke(),e=fn();let n=class Sk extends e.EntityBase{constructor(t){const s=new Date;super(t||{certificateId:0,created_at:s,updated_at:s,userId:0,type:"",subject:"",verifier:void 0,serialNumber:"",certifier:"",revocationOutpoint:"",signature:"",isDeleted:!1})}updateApi(){}get certificateId(){return this.api.certificateId}set certificateId(t){this.api.certificateId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get type(){return this.api.type}set type(t){this.api.type=t}get subject(){return this.api.subject}set subject(t){this.api.subject=t}get verifier(){return this.api.verifier}set verifier(t){this.api.verifier=t}get serialNumber(){return this.api.serialNumber}set serialNumber(t){this.api.serialNumber=t}get certifier(){return this.api.certifier}set certifier(t){this.api.certifier=t}get revocationOutpoint(){return this.api.revocationOutpoint}set revocationOutpoint(t){this.api.revocationOutpoint=t}get signature(){return this.api.signature}set signature(t){this.api.signature=t}get isDeleted(){return this.api.isDeleted}set isDeleted(t){this.api.isDeleted=t}get id(){return this.api.certificateId}set id(t){this.api.certificateId=t}get entityName(){return"certificate"}get entityTable(){return"certificates"}equals(t,s){return!(this.type!==t.type||this.subject!==t.subject||this.serialNumber!==t.serialNumber||this.revocationOutpoint!==t.revocationOutpoint||this.signature!==t.signature||this.verifier!==t.verifier||this.isDeleted!==t.isDeleted)}static async mergeFind(t,s,a,c,u){const l=(0,i.verifyOneOrNone)(await t.findCertificates({partial:{serialNumber:a.serialNumber,certifier:a.certifier,userId:s},trx:u}));return{found:!!l,eo:new Sk(l||{...a}),eiId:(0,i.verifyId)(a.certificateId)}}async mergeNew(t,s,a,c){this.userId=s,this.certificateId=0,this.certificateId=await t.insertCertificate(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.type=a.type,this.subject=a.subject,this.serialNumber=a.serialNumber,this.revocationOutpoint=a.revocationOutpoint,this.signature=a.signature,this.verifier=a.verifier,this.isDeleted=a.isDeleted,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateCertificate(this.id,this.toApi(),u),l=!0),l}};return ud.EntityCertificate=n,ud}var ld={},e3;function KD(){if(e3)return ld;e3=1,Object.defineProperty(ld,"__esModule",{value:!0}),ld.EntityCertificateField=void 0;const i=Ke(),e=fn();let n=class Ik extends e.EntityBase{constructor(t){const s=new Date;super(t||{created_at:s,updated_at:s,userId:0,certificateId:0,fieldName:"",fieldValue:"",masterKey:""})}updateApi(){}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get certificateId(){return this.api.certificateId}set certificateId(t){this.api.certificateId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get fieldName(){return this.api.fieldName}set fieldName(t){this.api.fieldName=t}get fieldValue(){return this.api.fieldValue}set fieldValue(t){this.api.fieldValue=t}get masterKey(){return this.api.masterKey}set masterKey(t){this.api.masterKey=t}get id(){throw new i.sdk.WERR_INVALID_OPERATION('entity has no "id" value')}get entityName(){return"certificateField"}get entityTable(){return"certificate_fields"}equals(t,s){return!(this.certificateId!==(s?s.certificate.idMap[t.certificateId]:t.certificateId)||this.fieldName!==t.fieldName||this.fieldValue!==t.fieldValue||this.masterKey!==t.masterKey)}static async mergeFind(t,s,a,c,u){const l=c.certificate.idMap[a.certificateId],h=(0,i.verifyOneOrNone)(await t.findCertificateFields({partial:{certificateId:l,userId:s,fieldName:a.fieldName},trx:u}));return{found:!!h,eo:new Ik(h||{...a}),eiId:-1}}async mergeNew(t,s,a,c){this.certificateId=a.certificate.idMap[this.certificateId],this.userId=s,await t.insertCertificateField(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.fieldValue=a.fieldValue,this.masterKey=a.masterKey,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateCertificateField(this.certificateId,this.fieldName,this.toApi(),u),l=!0),l}};return ld.EntityCertificateField=n,ld}var dd={},t3;function WD(){if(t3)return dd;t3=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.EntityTransaction=void 0;const i=Ye(),e=Ke(),n=fn();let r=class Tk extends n.EntityBase{getBsvTx(){if(this.rawTx)return i.Transaction.fromBinary(this.rawTx)}getBsvTxIns(){const s=this.getBsvTx();return s?s.inputs:[]}async getInputs(s,a){const c=await s.findOutputs({partial:{userId:this.userId,spentBy:this.id},trx:a});for(const u of this.getBsvTxIns()){const l=(0,e.verifyOneOrNone)(await s.findOutputs({partial:{userId:this.userId,txid:u.sourceTXID,vout:u.sourceOutputIndex},trx:a}));l&&!c.some(h=>h.outputId===l.outputId)&&c.push(l)}return c}constructor(s){const a=new Date;super(s||{transactionId:0,created_at:a,updated_at:a,userId:0,txid:"",status:"unprocessed",reference:"",satoshis:0,description:"",isOutgoing:!1,rawTx:void 0,inputBEEF:void 0})}updateApi(){}get transactionId(){return this.api.transactionId}set transactionId(s){this.api.transactionId=s}get created_at(){return this.api.created_at}set created_at(s){this.api.created_at=s}get updated_at(){return this.api.updated_at}set updated_at(s){this.api.updated_at=s}get version(){return this.api.version}set version(s){this.api.version=s}get lockTime(){return this.api.lockTime}set lockTime(s){this.api.lockTime=s}get isOutgoing(){return this.api.isOutgoing}set isOutgoing(s){this.api.isOutgoing=s}get status(){return this.api.status}set status(s){this.api.status=s}get userId(){return this.api.userId}set userId(s){this.api.userId=s}get provenTxId(){return this.api.provenTxId}set provenTxId(s){this.api.provenTxId=s}get satoshis(){return this.api.satoshis}set satoshis(s){this.api.satoshis=s}get txid(){return this.api.txid}set txid(s){this.api.txid=s}get reference(){return this.api.reference}set reference(s){this.api.reference=s}get inputBEEF(){return this.api.inputBEEF}set inputBEEF(s){this.api.inputBEEF=s}get description(){return this.api.description}set description(s){this.api.description=s}get rawTx(){return this.api.rawTx}set rawTx(s){this.api.rawTx=s}get id(){return this.api.transactionId}set id(s){this.api.transactionId=s}get entityName(){return"transaction"}get entityTable(){return"transactions"}equals(s,a){const c=this.toApi();return!(c.transactionId!==(a?a.transaction.idMap[(0,e.verifyId)(s.transactionId)]:s.transactionId)||c.reference!==s.reference||c.version!==s.version||c.lockTime!==s.lockTime||c.isOutgoing!==s.isOutgoing||c.status!==s.status||c.satoshis!==s.satoshis||c.txid!==s.txid||c.description!==s.description||!(0,e.optionalArraysEqual)(c.rawTx,s.rawTx)||!(0,e.optionalArraysEqual)(c.inputBEEF,s.inputBEEF)||!c.provenTxId!=!s.provenTxId||s.provenTxId&&c.provenTxId!==(a?a.provenTx.idMap[(0,e.verifyId)(s.provenTxId)]:s.provenTxId))}static async mergeFind(s,a,c,u,l){const h=(0,e.verifyOneOrNone)(await s.findTransactions({partial:{reference:c.reference,userId:a},trx:l}));return{found:!!h,eo:new Tk(h||{...c}),eiId:(0,e.verifyId)(c.transactionId)}}async mergeNew(s,a,c,u){this.provenTxId&&(this.provenTxId=c.provenTx.idMap[this.provenTxId]),this.userId=a,this.transactionId=0,this.transactionId=await s.insertTransaction(this.toApi(),u)}async mergeExisting(s,a,c,u,l){let h=!1;return c.updated_at>this.updated_at&&(this.version=c.version,this.lockTime=c.lockTime,this.isOutgoing=c.isOutgoing,this.status=c.status,this.provenTxId=c.provenTxId?u.provenTx.idMap[c.provenTxId]:void 0,this.satoshis=c.satoshis,this.txid=c.txid,this.description=c.description,this.rawTx=c.rawTx,this.inputBEEF=c.inputBEEF,this.updated_at=new Date(Math.max(c.updated_at.getTime(),this.updated_at.getTime())),await s.updateTransaction(this.id,this.toApi(),l),h=!0),h}async getProvenTx(s,a){if(!this.provenTxId)return;const c=(0,e.verifyOneOrNone)(await s.findProvenTxs({partial:{provenTxId:this.provenTxId},trx:a}));if(c)return new n.EntityProvenTx(c)}};return dd.EntityTransaction=r,dd}var fd={},n3;function $D(){if(n3)return fd;n3=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.EntityOutput=void 0;const i=Ke(),e=fn();let n=class kk extends e.EntityBase{constructor(t){const s=new Date;super(t||{outputId:0,created_at:s,updated_at:s,userId:0,transactionId:0,spendable:!1,change:!1,satoshis:0,outputDescription:"",vout:0,type:"",providedBy:"you",purpose:"",txid:void 0,basketId:void 0,spentBy:void 0,derivationPrefix:void 0,derivationSuffix:void 0,senderIdentityKey:void 0,customInstructions:void 0,spendingDescription:void 0,scriptLength:void 0,scriptOffset:void 0,lockingScript:void 0})}updateApi(){}get outputId(){return this.api.outputId}set outputId(t){this.api.outputId=t}get created_at(){return this.api.created_at}set created_at(t){this.api.created_at=t}get updated_at(){return this.api.updated_at}set updated_at(t){this.api.updated_at=t}get userId(){return this.api.userId}set userId(t){this.api.userId=t}get transactionId(){return this.api.transactionId}set transactionId(t){this.api.transactionId=t}get basketId(){return this.api.basketId}set basketId(t){this.api.basketId=t}get spentBy(){return this.api.spentBy}set spentBy(t){this.api.spentBy=t}get vout(){return this.api.vout}set vout(t){this.api.vout=t}get satoshis(){return this.api.satoshis}set satoshis(t){this.api.satoshis=t}get outputDescription(){return this.api.outputDescription}set outputDescription(t){this.api.outputDescription=t}get spendable(){return this.api.spendable}set spendable(t){this.api.spendable=t}get change(){return this.api.change}set change(t){this.api.change=t}get txid(){return this.api.txid}set txid(t){this.api.txid=t}get type(){return this.api.type}set type(t){this.api.type=t}get providedBy(){return this.api.providedBy}set providedBy(t){this.api.providedBy=t}get purpose(){return this.api.purpose}set purpose(t){this.api.purpose=t}get spendingDescription(){return this.api.spendingDescription}set spendingDescription(t){this.api.spendingDescription=t}get derivationPrefix(){return this.api.derivationPrefix}set derivationPrefix(t){this.api.derivationPrefix=t}get derivationSuffix(){return this.api.derivationSuffix}set derivationSuffix(t){this.api.derivationSuffix=t}get senderIdentityKey(){return this.api.senderIdentityKey}set senderIdentityKey(t){this.api.senderIdentityKey=t}get customInstructions(){return this.api.customInstructions}set customInstructions(t){this.api.customInstructions=t}get lockingScript(){return this.api.lockingScript}set lockingScript(t){this.api.lockingScript=t}get scriptLength(){return this.api.scriptLength}set scriptLength(t){this.api.scriptLength=t}get scriptOffset(){return this.api.scriptOffset}set scriptOffset(t){this.api.scriptOffset=t}get id(){return this.api.outputId}set id(t){this.api.outputId=t}get entityName(){return"output"}get entityTable(){return"outputs"}equals(t,s){return!(this.transactionId!==(s?s.transaction.idMap[t.transactionId]:t.transactionId)||this.basketId!==(s&&t.basketId?s.outputBasket.idMap[t.basketId]:t.basketId)||this.spentBy!==(s&&t.spentBy?s.transaction.idMap[t.spentBy]:t.spentBy)||this.vout!==t.vout||this.satoshis!==t.satoshis||this.spendable!==t.spendable||this.change!==t.change||this.txid!==t.txid||this.type!==t.type||this.providedBy!==t.providedBy||this.purpose!==t.purpose||this.outputDescription!==t.outputDescription||this.spendingDescription!==t.spendingDescription||this.derivationPrefix!==t.derivationPrefix||this.derivationSuffix!==t.derivationSuffix||this.senderIdentityKey!==t.senderIdentityKey||this.customInstructions!==t.customInstructions||!(0,i.optionalArraysEqual)(this.lockingScript,t.lockingScript)||this.scriptLength!==t.scriptLength||this.scriptOffset!==t.scriptOffset)}static async mergeFind(t,s,a,c,u){const l=c.transaction.idMap[a.transactionId];a.basketId&&c.outputBasket.idMap[a.basketId];const h=(0,i.verifyOneOrNone)(await t.findOutputs({partial:{userId:s,transactionId:l,vout:a.vout},trx:u}));return{found:!!h,eo:new kk(h||{...a}),eiId:(0,i.verifyId)(a.outputId)}}async mergeNew(t,s,a,c){this.userId=s,this.basketId=this.basketId?a.outputBasket.idMap[this.basketId]:void 0,this.transactionId=a.transaction.idMap[this.transactionId],this.spentBy=this.spentBy?a.transaction.idMap[this.spentBy]:void 0,this.outputId=0,this.outputId=await t.insertOutput(this.toApi(),c)}async mergeExisting(t,s,a,c,u){let l=!1;return a.updated_at>this.updated_at&&(this.spentBy=a.spentBy?c.transaction.idMap[a.spentBy]:void 0,this.spendable=a.spendable,this.change=a.change,this.type=a.type,this.providedBy=a.providedBy,this.purpose=a.purpose,this.outputDescription=a.outputDescription,this.spendingDescription=a.spendingDescription,this.senderIdentityKey=a.senderIdentityKey,this.customInstructions=a.customInstructions,this.scriptLength=a.scriptLength,this.scriptOffset=a.scriptOffset,this.lockingScript=a.lockingScript,this.updated_at=new Date(Math.max(a.updated_at.getTime(),this.updated_at.getTime())),await t.updateOutput(this.id,this.toApi(),u),l=!0),l}};return fd.EntityOutput=n,fd}var i3;function fn(){return i3||(i3=1,function(i){var e=ao&&ao.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=ao&&ao.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(RD(),i),n(ND(),i),n(CD(),i),n(MD(),i),n(BD(),i),n(DD(),i),n(LD(),i),n(FD(),i),n(UD(),i),n(HD(),i),n(qD(),i),n(jD(),i),n(VD(),i),n(KD(),i),n(WD(),i),n($D(),i)}(ao)),ao}var ar={},xp={},r3;function zD(){if(r3)return xp;r3=1,Object.defineProperty(xp,"__esModule",{value:!0}),xp.getSyncChunk=e;const i=Ke();async function e(t,s){const a={fromStorageIdentityKey:s.fromStorageIdentityKey,toStorageIdentityKey:s.toStorageIdentityKey,userIdentityKey:s.identityKey};let c=s.maxItems,u=s.maxRoughSize,l=0,h=!1;const f=(0,i.verifyTruthy)(await t.findUserByIdentityKey(s.identityKey));(!s.since||f.updated_at>new Date(s.since))&&(a.user=f);const m=[{name:"provenTx",maxDivider:100,preAdd:()=>{a.provenTxs=[]},addItem:y=>{a.provenTxs.push(y)},findItems:async(y,b)=>await y.getProvenTxsForUser(b)},{name:"outputBasket",maxDivider:1,preAdd:()=>{a.outputBaskets=[]},addItem:y=>{a.outputBaskets.push(y)},findItems:async(y,b)=>await y.findOutputBaskets({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"outputTag",maxDivider:1,preAdd:()=>{a.outputTags=[]},addItem:y=>{a.outputTags.push(y)},findItems:async(y,b)=>await y.findOutputTags({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"txLabel",maxDivider:1,preAdd:()=>{a.txLabels=[]},addItem:y=>{a.txLabels.push(y)},findItems:async(y,b)=>await y.findTxLabels({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"transaction",maxDivider:25,preAdd:()=>{a.transactions=[]},addItem:y=>{a.transactions.push(y)},findItems:async(y,b)=>await y.findTransactions({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"output",maxDivider:25,preAdd:()=>{a.outputs=[]},addItem:y=>{a.outputs.push(y)},findItems:async(y,b)=>await y.findOutputs({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"txLabelMap",maxDivider:1,preAdd:()=>{a.txLabelMaps=[]},addItem:y=>{a.txLabelMaps.push(y)},findItems:async(y,b)=>await y.getTxLabelMapsForUser(b)},{name:"outputTagMap",maxDivider:1,preAdd:()=>{a.outputTagMaps=[]},addItem:y=>{a.outputTagMaps.push(y)},findItems:async(y,b)=>await y.getOutputTagMapsForUser(b)},{name:"certificate",maxDivider:25,preAdd:()=>{a.certificates=[]},addItem:y=>{a.certificates.push(y)},findItems:async(y,b)=>await y.findCertificates({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"certificateField",maxDivider:25,preAdd:()=>{a.certificateFields=[]},addItem:y=>{a.certificateFields.push(y)},findItems:async(y,b)=>await y.findCertificateFields({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"commission",maxDivider:25,preAdd:()=>{a.commissions=[]},addItem:y=>{a.commissions.push(y)},findItems:async(y,b)=>await y.findCommissions({partial:{userId:b.userId},since:b.since,paged:b.paged})},{name:"provenTxReq",maxDivider:100,preAdd:()=>{a.provenTxReqs=[]},addItem:y=>{a.provenTxReqs.push(y)},findItems:async(y,b)=>await y.getProvenTxReqsForUser(b)}],d=async y=>{if(l>=s.offsets.length){h=!0;return}let{offset:b,name:g}=s.offsets[l++];if(y.name!==g)throw new i.sdk.WERR_INVALID_PARAMETER("offsets",`in dependency order. '${y.name}' expected, found ${g}.`);let v=!1;for(;!h;){const _=Math.min(c,Math.max(10,s.maxItems/y.maxDivider));if(_<=0)break;const S=await y.findItems(t,{userId:f.userId,since:s.since,paged:{limit:_,offset:b}});if(r(S),v||(y.preAdd(),v=!0),S.length===0)break;for(const I of S)if(b++,y.addItem(I),c--,u-=JSON.stringify(I).length,c<=0||u<0){h=!0;break}}};for(;!h;)for(const y of m)await d(y);return a}function n(t){if(!(t instanceof Date))throw new i.sdk.WERR_INVALID_OPERATION("bad date")}function r(t){for(const s of t){n(s.created_at),n(s.updated_at);for(const a of Object.keys(s))if(s[a]===null)throw new i.sdk.WERR_INVALID_OPERATION}}return xp}var a3;function GD(){if(a3)return ar;a3=1;var i=ar&&ar.__createBinding||(Object.create?function(c,u,l,h){h===void 0&&(h=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(c,h,f)}:function(c,u,l,h){h===void 0&&(h=l),c[h]=u[l]}),e=ar&&ar.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),n=ar&&ar.__importStar||function(){var c=function(u){return c=Object.getOwnPropertyNames||function(l){var h=[];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(h[h.length]=f);return h},c(u)};return function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h=c(u),f=0;f<h.length;f++)h[f]!=="default"&&i(l,u,h[f]);return e(l,u),l}}();Object.defineProperty(ar,"__esModule",{value:!0}),ar.StorageReader=void 0;const r=n(Jn()),t=Ma(),s=zD();let a=class{get dbtype(){var u;return(u=this._settings)===null||u===void 0?void 0:u.dbtype}constructor(u){this.chain=u.chain}isAvailable(){return!!this._settings}async makeAvailable(){return this._settings?this._settings:this._settings=await this.readSettings()}getSettings(){if(!this._settings)throw new r.WERR_INVALID_OPERATION('must call "makeAvailable" before accessing "settings"');return this._settings}isStorageProvider(){return!1}async findUserByIdentityKey(u){return(0,t.verifyOneOrNone)(await this.findUsers({partial:{identityKey:u}}))}async getSyncChunk(u){return(0,s.getSyncChunk)(this,u)}validateEntityDate(u){if(!this.dbtype)throw new r.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");let l=this.validateDate(u);switch(this.dbtype){case"IndexedDB":case"MySQL":break;case"SQLite":l=l.toISOString();break;default:throw new r.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return l}validateOptionalEntityDate(u,l){if(!this.dbtype)throw new r.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");let h=this.validateOptionalDate(u);switch(!h&&l&&(h=new Date),this.dbtype){case"IndexedDB":case"MySQL":break;case"SQLite":h&&(h=h.toISOString());break;default:throw new r.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return h}validateDate(u){let l;return u instanceof Date?l=u:l=new Date(u),l}validateOptionalDate(u){if(u!=null)return this.validateDate(u)}validateDateForWhere(u){if(!this.dbtype)throw new r.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");typeof u=="number"&&(u=(0,t.validateSecondsSinceEpoch)(u));const l=(0,t.verifyTruthy)(this.validateDate(u));let h;switch(this.dbtype){case"IndexedDB":case"MySQL":h=l;break;case"SQLite":h=l.toISOString();break;default:throw new r.WERR_INTERNAL(`Invalid dateScheme ${this.dbtype}`)}return h}};return ar.StorageReader=a,ar}var s3;function XD(){if(s3)return Ql;s3=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.StorageReaderWriter=void 0;const i=Ma(),e=fn(),n=GD();let r=class extends n.StorageReader{constructor(s){super(s)}async setActive(s,a){return await this.updateUser((0,i.verifyId)(s.userId),{activeStorage:a})}async findCertificateById(s,a){return(0,i.verifyOneOrNone)(await this.findCertificates({partial:{certificateId:s},trx:a}))}async findCommissionById(s,a){return(0,i.verifyOneOrNone)(await this.findCommissions({partial:{commissionId:s},trx:a}))}async findOutputById(s,a,c){return(0,i.verifyOneOrNone)(await this.findOutputs({partial:{outputId:s},noScript:c,trx:a}))}async findOutputBasketById(s,a){return(0,i.verifyOneOrNone)(await this.findOutputBaskets({partial:{basketId:s},trx:a}))}async findProvenTxById(s,a){return(0,i.verifyOneOrNone)(await this.findProvenTxs({partial:{provenTxId:s},trx:a}))}async findProvenTxReqById(s,a){return(0,i.verifyOneOrNone)(await this.findProvenTxReqs({partial:{provenTxReqId:s},trx:a}))}async findSyncStateById(s,a){return(0,i.verifyOneOrNone)(await this.findSyncStates({partial:{syncStateId:s},trx:a}))}async findTransactionById(s,a,c){return(0,i.verifyOneOrNone)(await this.findTransactions({partial:{transactionId:s},noRawTx:c,trx:a}))}async findTxLabelById(s,a){return(0,i.verifyOneOrNone)(await this.findTxLabels({partial:{txLabelId:s},trx:a}))}async findOutputTagById(s,a){return(0,i.verifyOneOrNone)(await this.findOutputTags({partial:{outputTagId:s},trx:a}))}async findUserById(s,a){return(0,i.verifyOneOrNone)(await this.findUsers({partial:{userId:s},trx:a}))}async findOrInsertUser(s,a){let c,u=!1;for(let l=0;;l++)try{if(c=(0,i.verifyOneOrNone)(await this.findUsers({partial:{identityKey:s},trx:a})),c)break;const h=new Date;c={created_at:h,updated_at:new Date("1971-01-01"),userId:0,identityKey:s,activeStorage:this.getSettings().storageIdentityKey},c.userId=await this.insertUser(c,a),u=!0,await this.insertOutputBasket({created_at:h,updated_at:new Date("1971-01-01"),basketId:0,userId:c.userId,name:"default",numberOfDesiredUTXOs:144,minimumDesiredUTXOValue:32,isDeleted:!1});break}catch(h){if(console.log(`findOrInsertUser catch: ${JSON.stringify(h).slice(0,512)}`),l>0)throw h}return{user:c,isNew:u}}async findOrInsertTransaction(s,a){let c,u=!1;for(let l=0;;l++)try{if(c=(0,i.verifyOneOrNone)(await this.findTransactions({partial:{userId:s.userId,txid:s.txid},trx:a})),c)break;s.transactionId=await this.insertTransaction(s,a),u=!0,c=s;break}catch(h){if(l>0)throw h}return{tx:c,isNew:u}}async findOrInsertOutputBasket(s,a,c){const u={name:a,userId:s};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findOutputBaskets({partial:u,trx:c}));return f||(f={...u,minimumDesiredUTXOValue:0,numberOfDesiredUTXOs:0,basketId:0,created_at:h,updated_at:h,isDeleted:!1},f.basketId=await this.insertOutputBasket(f,c)),f.isDeleted&&await this.updateOutputBasket((0,i.verifyId)(f.basketId),{isDeleted:!1}),f}catch(h){if(l>0)throw h}}async findOrInsertTxLabel(s,a,c){const u={label:a,userId:s};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findTxLabels({partial:u,trx:c}));return f||(f={...u,txLabelId:0,created_at:h,updated_at:h,isDeleted:!1},f.txLabelId=await this.insertTxLabel(f,c)),f.isDeleted&&await this.updateTxLabel((0,i.verifyId)(f.txLabelId),{isDeleted:!1}),f}catch(h){if(l>0)throw h}}async findOrInsertTxLabelMap(s,a,c){const u={transactionId:s,txLabelId:a};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findTxLabelMaps({partial:u,trx:c}));return f||(f={...u,created_at:h,updated_at:h,isDeleted:!1},await this.insertTxLabelMap(f,c)),f.isDeleted&&await this.updateTxLabelMap(s,a,{isDeleted:!1}),f}catch(h){if(l>0)throw h}}async findOrInsertOutputTag(s,a,c){const u={tag:a,userId:s};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findOutputTags({partial:u,trx:c}));return f||(f={...u,outputTagId:0,created_at:h,updated_at:h,isDeleted:!1},f.outputTagId=await this.insertOutputTag(f,c)),f.isDeleted&&await this.updateOutputTag((0,i.verifyId)(f.outputTagId),{isDeleted:!1}),f}catch(h){if(l>0)throw h}}async findOrInsertOutputTagMap(s,a,c){const u={outputId:s,outputTagId:a};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findOutputTagMaps({partial:u,trx:c}));return f||(f={...u,created_at:h,updated_at:h,isDeleted:!1},await this.insertOutputTagMap(f,c)),f.isDeleted&&await this.updateOutputTagMap(s,a,{isDeleted:!1}),f}catch(h){if(l>0)throw h}}async findOrInsertSyncStateAuth(s,a,c){const u={userId:s.userId,storageIdentityKey:a,storageName:c};for(let l=0;;l++)try{const h=new Date;let f=(0,i.verifyOneOrNone)(await this.findSyncStates({partial:u}));return f?{syncState:f,isNew:!1}:(f={...u,created_at:h,updated_at:h,syncStateId:0,status:"unknown",init:!1,refNum:(0,i.randomBytesBase64)(12),syncMap:JSON.stringify((0,e.createSyncMap)())},await this.insertSyncState(f),{syncState:f,isNew:!0})}catch(h){if(l>0)throw h}}async findOrInsertProvenTxReq(s,a){let c,u=!1;for(let l=0;;l++)try{if(c=(0,i.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:s.txid},trx:a})),c)break;s.provenTxReqId=await this.insertProvenTxReq(s,a),u=!0,c=s;break}catch(h){if(l>0)throw h}return{req:c,isNew:u}}async findOrInsertProvenTx(s,a){let c,u=!1;for(let l=0;;l++)try{if(c=(0,i.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:s.txid},trx:a})),c)break;s.provenTxId=await this.insertProvenTx(s,a),u=!0,c=s;break}catch(h){if(l>0)throw h}return{proven:c,isNew:u}}async tagOutput(s,a,c){await this.transaction(async u=>{const l=(0,i.verifyOne)(await this.findOutputs({partial:s,noScript:!0,trx:u})),h=await this.findOrInsertOutputTag(l.userId,a,u);await this.findOrInsertOutputTagMap((0,i.verifyId)(l.outputId),(0,i.verifyId)(h.outputTagId),u)},c)}};return Ql.StorageReaderWriter=r,Ql}var o3;function Nw(){if(o3)return Wc;o3=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.StorageProvider=void 0,Wc.validateStorageFeeModel=f;const i=Ye(),e=Ke(),n=kD(),r=hk(),t=pk(),s=ED(),a=AD(),c=PD(),u=XD(),l=fn();let h=class Ek extends u.StorageReaderWriter{static defaultOptions(){return{feeModel:{model:"sat/kb",value:1},commissionSatoshis:0,commissionPubKeyHex:void 0}}static createStorageBaseOptions(d){return{...Ek.defaultOptions(),chain:d}}constructor(d){super(d),this.isDirty=!1,this.feeModel=d.feeModel,this.commissionPubKeyHex=d.commissionPubKeyHex,this.commissionSatoshis=d.commissionSatoshis}isStorageProvider(){return!0}setServices(d){this._services=d}getServices(){if(!this._services)throw new e.sdk.WERR_INVALID_OPERATION("Must setServices first.");return this._services}async abortAction(d,y){if(!d.userId)throw new e.sdk.WERR_INVALID_PARAMETER("auth.userId","valid");const b=d.userId;let g=y.reference,v;return await this.transaction(async S=>{let I=(0,e.verifyOneOrNone)(await this.findTransactions({partial:{reference:g,userId:b},noRawTx:!0,trx:S}));!I&&y.reference.length===64&&(v=g,g=void 0,I=(0,e.verifyOneOrNone)(await this.findTransactions({partial:{txid:v,userId:b},noRawTx:!0,trx:S})));const A=["completed","failed","sending","unproven"];if(!I||!I.isOutgoing||-1<A.findIndex(E=>E===I.status))throw new e.sdk.WERR_INVALID_PARAMETER("reference","an inprocess, outgoing action that has not been signed and shared to the network.");if(await this.updateTransactionStatus("failed",I.transactionId,b,g,S),I.txid){const E=await l.EntityProvenTxReq.fromStorageTxid(this,I.txid,S);E&&(E.addHistoryNote({what:"abortAction",reference:y.reference}),E.status="invalid",await E.updateStorageDynamicProperties(this,S))}return{aborted:!0}})}async internalizeAction(d,y){return await(0,c.internalizeAction)(this,d,y)}async getReqsAndBeefToShareWithWorld(d,y,b){const g={beef:new i.Beef,details:[]};for(const v of d){const _={txid:v,status:"unknown"};g.details.push(_);try{if(_.proven=(0,e.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:v},trx:b})),_.proven)_.status="alreadySent";else{const S=["unmined","callback","unconfirmed","completed"],I=["sending","unsent","nosend","unprocessed"],A=["unknown","nonfinal","invalid","doubleSpend"];_.req=(0,e.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:v},trx:b})),_.req?A.indexOf(_.req.status)>-1?(_.status="error",_.error=`ERR_INVALID_PARAMETER: ${v} is not ready to send.`):S.indexOf(_.req.status)>-1?_.status="alreadySent":I.indexOf(_.req.status)>-1?!_.req.rawTx||!_.req.inputBEEF?(_.status="error",_.error=`ERR_INTERNAL: ${v} req is missing rawTx or beef.`):_.status="readyToSend":(_.status="error",_.error=`ERR_INTERNAL: ${v} has unexpected req status ${_.req.status}`):(_.status="error",_.error=`ERR_UNKNOWN_TXID: ${v} was not found.`),_.status==="readyToSend"&&await this.mergeReqToBeefToShareExternally(_.req,g.beef,y,b)}}catch(S){const I=e.sdk.WalletError.fromUnknown(S);_.error=`${I.name}: ${I.message}`}}return g}async mergeReqToBeefToShareExternally(d,y,b,g){const{rawTx:v,inputBEEF:_}=d;if(!v||!_)throw new e.sdk.WERR_INTERNAL("req rawTx and beef must be valid.");y.mergeRawTx((0,e.asArray)(v)),y.mergeBeef((0,e.asArray)(_));const S=i.Transaction.fromBinary((0,e.asArray)(v));for(const I of S.inputs){if(!I.sourceTXID)throw new e.sdk.WERR_INTERNAL("req all transaction inputs must have valid sourceTXID");const A=I.sourceTXID;y.findTxid(A)||(b&&b.indexOf(A)>-1?y.mergeTxidOnly(A):await this.getValidBeefForKnownTxid(A,y,void 0,b,g))}}async getProvenOrReq(d,y,b){if(y&&d!==y.txid)throw new e.sdk.WERR_INVALID_PARAMETER("newReq","same txid");const g={proven:void 0,req:void 0};if(g.proven=(0,e.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:d},trx:b})),g.proven)return g;for(let v=0;;v++)try{if(g.req=(0,e.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:d},trx:b})),!g.req&&!y)break;if(!g.req&&y&&await this.insertProvenTxReq(y,b),g.req&&y){const _=new l.EntityProvenTxReq(g.req);_.mergeHistory(y,void 0,!0),_.mergeNotifyTransactionIds(y),await _.updateStorageDynamicProperties(this,b)}break}catch(_){if(v>0)throw _}return g}async updateTransactionsStatus(d,y,b){await this.transaction(async g=>{for(const v of d)await this.updateTransactionStatus(y,v,void 0,void 0,g)},b)}async updateTransactionStatus(d,y,b,g,v){if(!y&&!(b&&g))throw new e.sdk.WERR_MISSING_PARAMETER("either transactionId or userId and reference");await this.transaction(async _=>{const S={};y&&(S.transactionId=y),b&&(S.userId=b),g&&(S.reference=g);const I=(0,e.verifyOne)(await this.findTransactions({partial:S,noRawTx:!0,trx:_}));if(d!=="completed"&&I.status==="completed"||I.provenTxId)throw new e.sdk.WERR_INVALID_OPERATION('The status of a "completed" transaction cannot be changed.');if(d!=="failed"&&I.status==="failed")throw new e.sdk.WERR_INVALID_OPERATION('A "failed" transaction may not be un-failed by this method.');switch(d){case"failed":{const R=await new l.EntityTransaction(I).getInputs(this,_);for(const E of R)await this.updateOutput((0,e.verifyId)(E.outputId),{spendable:!0,spentBy:void 0},_)}break;case"nosend":case"unsigned":case"unprocessed":case"sending":case"unproven":case"completed":break;default:throw new e.sdk.WERR_INVALID_PARAMETER("status",`not be ${d}`)}await this.updateTransaction(I.transactionId,{status:d},_)},v)}async createAction(d,y){if(!d.userId)throw new e.sdk.WERR_UNAUTHORIZED;return await(0,a.createAction)(this,d,y)}async processAction(d,y){if(!d.userId)throw new e.sdk.WERR_UNAUTHORIZED;return await(0,r.processAction)(this,d,y)}async attemptToPostReqsToNetwork(d,y){return await(0,t.attemptToPostReqsToNetwork)(this,d,y)}async listCertificates(d,y){return await(0,s.listCertificates)(this,d,y)}async verifyKnownValidTransaction(d,y){const{proven:b,rawTx:g}=await this.getProvenOrRawTx(d,y);return b!=null||g!=null}async getValidBeefForKnownTxid(d,y,b,g,v,_){const S=await this.getValidBeefForTxid(d,y,b,g,v,_);if(!S)throw new e.sdk.WERR_INVALID_PARAMETER("txid",`known to storage. ${d} is not known.`);return S}async getValidBeefForTxid(d,y,b,g,v,_){const S=y||new i.Beef,I=await this.getProvenOrRawTx(d,v);if(I.proven)if(_)I.rawTx=I.proven.rawTx;else if(b==="known")S.mergeTxidOnly(d);else{S.mergeRawTx(I.proven.rawTx);const A=new l.EntityProvenTx(I.proven).getMerklePath();return S.mergeBump(A),S}if(I.rawTx){if(b==="known")S.mergeTxidOnly(d);else{S.mergeRawTx(I.rawTx),I.inputBEEF&&S.mergeBeef(I.inputBEEF);const A=i.Transaction.fromBinary(I.rawTx);_&&_--;for(const R of A.inputs)S.findTxid(R.sourceTXID)||(!_&&g&&g.indexOf(R.sourceTXID)>-1?S.mergeTxidOnly(R.sourceTXID):await this.getValidBeefForKnownTxid(R.sourceTXID,S,b,g,v,_))}return S}}async getBeefForTransaction(d,y){return await(0,n.getBeefForTransaction)(this,d,y)}async findMonitorEventById(d,y){return(0,e.verifyOneOrNone)(await this.findMonitorEvents({partial:{id:d},trx:y}))}async relinquishCertificate(d,y){const b=e.sdk.validateRelinquishCertificateArgs(y),g=(0,e.verifyOne)(await this.findCertificates({partial:{certifier:b.certifier,serialNumber:b.serialNumber,type:b.type}}));return await this.updateCertificate(g.certificateId,{isDeleted:!0})}async relinquishOutput(d,y){const b=e.sdk.validateRelinquishOutputArgs(y),{txid:g,vout:v}=e.sdk.parseWalletOutpoint(b.output),_=(0,e.verifyOne)(await this.findOutputs({partial:{txid:g,vout:v}}));return await this.updateOutput(_.outputId,{basketId:void 0})}async processSyncChunk(d,y){const b=(0,e.verifyTruthy)(await this.findUserByIdentityKey(d.identityKey));return await new l.EntitySyncState((0,e.verifyOne)(await this.findSyncStates({partial:{storageIdentityKey:d.fromStorageIdentityKey,userId:b.userId}}))).processSyncChunk(this,d,y)}async updateProvenTxReqWithNewProvenTx(d){const y=await l.EntityProvenTxReq.fromStorageId(this,d.provenTxReqId);let b;if(y.provenTxId)b=new l.EntityProvenTx((0,e.verifyOne)(await this.findProvenTxs({partial:{txid:d.txid}})));else{let v;if({proven:b,isNew:v}=await this.transaction(async _=>{const{proven:S,isNew:I}=await this.findOrInsertProvenTx({created_at:new Date,updated_at:new Date,provenTxId:0,txid:d.txid,height:d.height,index:d.index,merklePath:d.merklePath,rawTx:y.rawTx,blockHash:d.blockHash,merkleRoot:d.merkleRoot},_);return b=new l.EntityProvenTx(S),I&&(y.status="completed",y.provenTxId=b.provenTxId,await y.updateStorageDynamicProperties(this,_)),{proven:b,isNew:I}}),v){const _=y.notify.transactionIds||[];if(_.length>0){for(const S of _)try{await this.updateTransaction(S,{provenTxId:b.provenTxId,status:"completed"}),y.addHistoryNote({what:"notifyTxOfProof",transactionId:S})}catch(I){const{code:A,description:R}=e.sdk.WalletError.fromUnknown(I),{provenTxId:E}=b;y.addHistoryNote({what:"notifyTxOfProofError",id:S,provenTxId:E,code:A,description:R})}await y.updateStorageDynamicProperties(this)}}}return{status:y.status,history:y.apiHistory,provenTxId:b.provenTxId}}async confirmSpendableOutputs(){const d=[],y=await this.findUsers({partial:{}});for(const{userId:b}of y){const g=(0,e.verifyOne)(await this.findOutputBaskets({partial:{userId:b,name:"default"}})),v={userId:b,basketId:g.basketId,spendable:!0},_=await this.findOutputs({partial:v}),S=this.getServices();for(let I=_.length-1;I>=0;I--){const A=_[I];if((0,e.verifyId)(A.outputId),A.spendable){let R=!1;if(A.lockingScript&&A.lockingScript.length>0){const E=S.hashOutputScript((0,e.asString)(A.lockingScript));(await S.getUtxoStatus(E,void 0,`${A.txid}.${A.vout}`)).isUtxo===!0&&(R=!0)}R||d.push(A)}}}return{invalidSpendableOutputs:d}}async updateProvenTxReqDynamics(d,y,b){const g={};return y.updated_at&&(g.updated_at=y.updated_at),y.provenTxId&&(g.provenTxId=y.provenTxId),y.status&&(g.status=y.status),Number.isInteger(y.attempts)&&(g.attempts=y.attempts),y.notified!==void 0&&(g.notified=y.notified),y.batch&&(g.batch=y.batch),y.history&&(g.history=y.history),y.notify&&(g.notify=y.notify),await this.updateProvenTxReq(d,g,b)}async extendOutput(d,y=!1,b=!1,g){const v=d;return y&&v.basketId&&(v.basket=await this.findOutputBasketById(d.basketId,g)),b&&(v.tags=await this.getTagsForOutputId(d.outputId)),d}async validateOutputScript(d,y){if(!d.scriptLength||!d.scriptOffset||!d.txid||d.lockingScript&&d.lockingScript.length===d.scriptLength)return;const b=await this.getRawTxOfKnownValidTransaction(d.txid,d.scriptOffset,d.scriptLength,y);b&&(d.lockingScript=b)}};Wc.StorageProvider=h;function f(m){const d={model:"sat/kb",value:1};if(typeof m=="object"){if(m.model!=="sat/kb")throw new e.sdk.WERR_INVALID_PARAMETER("StorageFeeModel.model",'"sat/kb"');typeof m.value=="number"&&(d.value=m.value)}return d}return Wc}var _p={},hd={},c3;function YD(){if(c3)return hd;c3=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.getLabelToSpecOp=void 0;const i=Ke(),e=()=>({[i.sdk.specOpNoSendActions]:{name:"noSendActions",labelsToIntercept:["abort"],setStatusFilter:()=>["nosend"],postProcess:async(n,r,t,s,a)=>{if(s.indexOf("abort")>=0)for(const c of a)c.status==="nosend"&&(await n.abortAction(r,{reference:c.reference}),c.status="failed")}},[i.sdk.specOpFailedActions]:{name:"failedActions",labelsToIntercept:["unfail"],setStatusFilter:()=>["failed"],postProcess:async(n,r,t,s,a)=>{if(s.indexOf("unfail")>=0)for(const c of a)c.status==="failed"&&await n.updateTransaction(c.transactionId,{status:"unfail"})}}});return hd.getLabelToSpecOp=e,hd}var u3;function QD(){if(u3)return _p;u3=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.listActionsIdb=t;const i=Ye(),e=Ke(),n=Jn(),r=YD();async function t(s,a,c){c.limit,c.offset;const u={totalActions:0,actions:[]};let l,h=[],f=[];for(const g of c.labels)(0,n.isListActionsSpecOp)(g)?l=(0,r.getLabelToSpecOp)()[g]:f.push(g);if((l==null?void 0:l.labelsToIntercept)!==void 0){const g=l.labelsToIntercept,v=f;f=[],g.length===0&&(h=v);for(const _ of v)g.indexOf(_)>=0?h.push(_):f.push(_)}let m=[];f.length>0&&await s.filterTxLabels({partial:{userId:a.userId,isDeleted:!1}},g=>{f.includes(g.label)&&m.push(g.txLabelId)});const d=c.labelQueryMode==="all";if(d&&m.length<f.length||!d&&m.length===0&&f.length>0)return u;const y=l!=null&&l.setStatusFilter?l.setStatusFilter():["completed","unprocessed","sending","unproven","unsigned","nosend","nonfinal"];m.length;const b=await s.findTransactions({partial:{userId:a.userId},status:y,paged:{limit:c.limit,offset:c.offset},noRawTx:!0},m,d);b.length===c.limit?u.totalActions=await s.countTransactions({partial:{userId:a.userId},status:y},m,d):u.totalActions=b.length,l!=null&&l.postProcess&&await l.postProcess(s,a,c,h,b);for(const g of b){const v={txid:g.txid||"",satoshis:g.satoshis||0,status:g.status,isOutgoing:!!g.isOutgoing,description:g.description||"",version:g.version||0,lockTime:g.lockTime||0};u.actions.push(v)}return(c.includeLabels||c.includeInputs||c.includeOutputs)&&await Promise.all(b.map(async(g,v)=>{var _,S,I;const A=u.actions[v];if(c.includeLabels&&(A.labels=(await s.getLabelsForTransactionId(g.transactionId)).map(R=>R.label)),c.includeOutputs){const R=await s.findOutputs({partial:{transactionId:g.transactionId},noScript:!c.includeOutputLockingScripts});A.outputs=[];for(const E of R){await s.extendOutput(E,!0,!0);const k={satoshis:E.satoshis||0,spendable:!!E.spendable,tags:((_=E.tags)===null||_===void 0?void 0:_.map(P=>P.tag))||[],outputIndex:Number(E.vout),outputDescription:E.outputDescription||"",basket:((S=E.basket)===null||S===void 0?void 0:S.name)||""};c.includeOutputLockingScripts&&(k.lockingScript=(0,e.asString)(E.lockingScript||[])),A.outputs.push(k)}}if(c.includeInputs){const R=await s.findOutputs({partial:{spentBy:g.transactionId},noScript:!c.includeInputSourceLockingScripts});if(A.inputs=[],R.length>0){const E=await s.getRawTxOfKnownValidTransaction(g.txid);let k;E&&(k=i.Transaction.fromBinary(E));for(const P of R){await s.extendOutput(P,!0,!0);const T=k==null?void 0:k.inputs.find(C=>C.sourceTXID===P.txid&&C.sourceOutputIndex===P.vout),M={sourceOutpoint:`${P.txid}.${P.vout}`,sourceSatoshis:P.satoshis||0,inputDescription:P.outputDescription||"",sequenceNumber:(T==null?void 0:T.sequence)||0};A.inputs.push(M),c.includeInputSourceLockingScripts&&(M.sourceLockingScript=(0,e.asString)(P.lockingScript||[])),c.includeInputUnlockingScripts&&(M.unlockingScript=(I=T==null?void 0:T.unlockingScript)===null||I===void 0?void 0:I.toHex())}}}})),u}return _p}var Sp={},pd={},l3;function ZD(){if(l3)return pd;l3=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.getBasketToSpecOp=void 0;const i=Ke(),e=()=>({[i.sdk.specOpWalletBalance]:{name:"totalOutputsIsWalletBalance",useBasket:"default",ignoreLimit:!0,resultFromOutputs:async(n,r,t,s,a)=>{let c=0;for(const u of a)c+=u.satoshis;return{totalOutputs:c,outputs:[]}}},[i.sdk.specOpInvalidChange]:{name:"invalidChangeOutputs",useBasket:"default",ignoreLimit:!0,includeOutputScripts:!0,includeSpent:!1,tagsToIntercept:["release","all"],filterOutputs:async(n,r,t,s,a)=>{const c=[],u=n.getServices();for(const l of a){await n.validateOutputScript(l);let h=!1;l.lockingScript&&l.lockingScript.length>0?h=await u.isUtxo(l):h=void 0,h===!1&&c.push(l)}if(s.indexOf("release")>=0)for(const l of c)await n.updateOutput(l.outputId,{spendable:!1}),l.spendable=!1;return c}},[i.sdk.specOpSetWalletChangeParams]:{name:"setWalletChangeParams",tagsParamsCount:2,resultFromTags:async(n,r,t,s)=>{if(s.length!==2)throw new i.sdk.WERR_INVALID_PARAMETER("numberOfDesiredUTXOs and minimumDesiredUTXOValue","valid");const a=(0,i.verifyInteger)(Number(s[0])),c=(0,i.verifyInteger)(Number(s[1])),u=(0,i.verifyOne)(await n.findOutputBaskets({partial:{userId:(0,i.verifyId)(r.userId),name:"default"}}));return await n.updateOutputBasket(u.basketId,{numberOfDesiredUTXOs:a,minimumDesiredUTXOValue:c}),{totalOutputs:0,outputs:[]}}}});return pd.getBasketToSpecOp=e,pd}var d3;function JD(){if(d3)return Sp;d3=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.listOutputsIdb=r;const i=Ye(),e=Ke(),n=ZD();async function r(t,s,a,c){const u=(0,e.verifyId)(s.userId),l=a.limit,h=a.offset,f={totalOutputs:0,outputs:[]};let m,d;if(a.basket){let E=a.basket;if(m=(0,n.getBasketToSpecOp)()[E],E=m?m.useBasket?m.useBasket:"":E,E){const k=await t.findOutputBaskets({partial:{userId:u,name:E}});if(k.length!==1)return f;d=k[0].basketId}}let y=[...a.tags];const b=[];if(m&&m.tagsParamsCount&&b.push(...y.splice(0,Math.min(y.length,m.tagsParamsCount))),m&&m.tagsToIntercept){const E=y;y=[];for(const k of E)m.tagsToIntercept.length===0||m.tagsToIntercept.indexOf(k)>=0?(b.push(k),k==="all"&&(d=void 0)):y.push(k)}if(m&&m.resultFromTags)return await m.resultFromTags(t,s,a,b);let g=[];y&&y.length>0&&await t.filterOutputTags({partial:{userId:u,isDeleted:!1}},E=>{y.includes(E.tag)&&g.push(E.outputTagId)});const v=a.tagQueryMode==="all";if(v&&g.length<y.length||!v&&g.length===0&&y.length>0)return f;g.length;const S={partial:{userId:u,basketId:d,spendable:!0},txStatus:["completed","unproven","nosend"],noScript:!0};(!m||!m.ignoreLimit)&&(S.paged={limit:l,offset:h});let I=await t.findOutputs(S,g,v);if(I.length===a.limit?(S.paged=void 0,f.totalOutputs=await t.countOutputs(S,g,v)):f.totalOutputs=I.length,m&&(m.filterOutputs&&(I=await m.filterOutputs(t,s,a,b,I)),m.resultFromOutputs))return await m.resultFromOutputs(t,s,a,b,I);const A={},R=new i.Beef;for(const E of I){const k={satoshis:Number(E.satoshis),spendable:!!E.spendable,outpoint:`${E.txid}.${E.vout}`};f.outputs.push(k),a.includeCustomInstructions&&E.customInstructions&&(k.customInstructions=E.customInstructions),a.includeLabels&&E.txid&&(A[E.txid]===void 0&&(A[E.txid]=(await t.getLabelsForTransactionId(E.transactionId)).map(P=>P.label)),k.labels=A[E.txid]),a.includeTags&&(k.tags=(await t.getTagsForOutputId(E.outputId)).map(P=>P.tag)),a.includeLockingScripts&&(await t.validateOutputScript(E),E.lockingScript&&(k.lockingScript=(0,e.asString)(E.lockingScript))),a.includeTransactions&&!R.findTxid(E.txid)&&await t.getValidBeefForKnownTxid(E.txid,R,void 0,a.knownTxids)}return a.includeTransactions&&(f.BEEF=R.toBinary()),f}return Sp}var Ip={},f3;function eL(){if(f3)return Ip;f3=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.reviewStatusIdb=i;async function i(e,n){const r={log:""},t=[];await e.filterProvenTxReqs({partial:{status:"invalid"}},s=>{t.push(s.txid)});for(const s of t){const a=await e.findTransactions({partial:{txid:s}});for(const c of a)c.status!=="failed"&&(r.log+=`transaction ${c.transactionId} updated to status of 'failed' was ${c.status}
`,await e.updateTransactionStatus("failed",c.transactionId))}return r}return Ip}var Tp={},h3;function tL(){if(h3)return Tp;h3=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.purgeDataIdb=i;async function i(e,n,r){return{count:0,log:""}}return Tp}var p3;function Ok(){if(p3)return rr;p3=1;var i=rr&&rr.__createBinding||(Object.create?function(m,d,y,b){b===void 0&&(b=y);var g=Object.getOwnPropertyDescriptor(d,y);(!g||("get"in g?!d.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return d[y]}}),Object.defineProperty(m,b,g)}:function(m,d,y,b){b===void 0&&(b=y),m[b]=d[y]}),e=rr&&rr.__setModuleDefault||(Object.create?function(m,d){Object.defineProperty(m,"default",{enumerable:!0,value:d})}:function(m,d){m.default=d}),n=rr&&rr.__importStar||function(){var m=function(d){return m=Object.getOwnPropertyNames||function(y){var b=[];for(var g in y)Object.prototype.hasOwnProperty.call(y,g)&&(b[b.length]=g);return b},m(d)};return function(d){if(d&&d.__esModule)return d;var y={};if(d!=null)for(var b=m(d),g=0;g<b.length;g++)b[g]!=="default"&&i(y,d,b[g]);return e(y,d),y}}();Object.defineProperty(rr,"__esModule",{value:!0}),rr.StorageIdb=void 0;const r=TD,t=n(Jn()),s=Ma(),a=Nw(),c=QD(),u=JD(),l=eL(),h=tL();let f=class extends a.StorageProvider{constructor(d){super(d),this.allStores=["certificates","certificate_fields","commissions","monitor_events","outputs","output_baskets","output_tags","output_tags_map","proven_txs","proven_tx_reqs","sync_states","transactions","tx_labels","tx_labels_map","users"],this.dbName=`wallet-toolbox-${this.chain}net`}async migrate(d,y){return(await this.verifyDB(d,y)).version.toString()}async verifyDB(d,y){return this.db?this.db:(this.db=await this.initDB(d,y),this._settings=(await this.db.getAll("settings"))[0],this.whenLastAccess=new Date,this.db)}toDbTrx(d,y,b){if(b)return b;{if(!this.db)throw new Error("not initialized");const v=this.db.transaction(d||this.allStores,y||"readwrite");return this.whenLastAccess=new Date,v}}async readSettings(d){return await this.verifyDB(),this._settings}async initDB(d,y){const b=this.chain,g=1024;return await(0,r.openDB)(this.dbName,1,{upgrade(_,S,I,A){if(_.objectStoreNames.contains("proven_txs")||_.createObjectStore("proven_txs",{keyPath:"provenTxId",autoIncrement:!0}).createIndex("txid","txid",{unique:!0}),!_.objectStoreNames.contains("proven_tx_reqs")){const R=_.createObjectStore("proven_tx_reqs",{keyPath:"provenTxReqId",autoIncrement:!0});R.createIndex("provenTxId","provenTxId"),R.createIndex("txid","txid",{unique:!0}),R.createIndex("status","status"),R.createIndex("batch","batch")}if(_.objectStoreNames.contains("users")||_.createObjectStore("users",{keyPath:"userId",autoIncrement:!0}).createIndex("identityKey","identityKey",{unique:!0}),!_.objectStoreNames.contains("certificates")){const R=_.createObjectStore("certificates",{keyPath:"certificateId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("userId_type_certifier_serialNumber",["userId","type","certifier","serialNumber"],{unique:!0})}if(!_.objectStoreNames.contains("certificate_fields")){const R=_.createObjectStore("certificate_fields",{keyPath:["certificateId","fieldName"]});R.createIndex("userId","userId"),R.createIndex("certificateId","certificateId")}if(!_.objectStoreNames.contains("output_baskets")){const R=_.createObjectStore("output_baskets",{keyPath:"basketId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("name_userId",["name","userId"],{unique:!0})}if(!_.objectStoreNames.contains("transactions")){const R=_.createObjectStore("transactions",{keyPath:"transactionId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("status","status"),R.createIndex("status_userId",["status","userId"]),R.createIndex("provenTxId","provenTxId"),R.createIndex("reference","reference",{unique:!0})}if(!_.objectStoreNames.contains("commissions")){const R=_.createObjectStore("commissions",{keyPath:"commissionId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("transactionId","transactionId",{unique:!0})}if(!_.objectStoreNames.contains("outputs")){const R=_.createObjectStore("outputs",{keyPath:"outputId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("transactionId","transactionId"),R.createIndex("basketId","basketId"),R.createIndex("spentBy","spentBy"),R.createIndex("transactionId_vout_userId",["transactionId","vout","userId"],{unique:!0})}if(!_.objectStoreNames.contains("output_tags")){const R=_.createObjectStore("output_tags",{keyPath:"outputTagId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("tag_userId",["tag","userId"],{unique:!0})}if(!_.objectStoreNames.contains("output_tags_map")){const R=_.createObjectStore("output_tags_map",{keyPath:["outputTagId","outputId"]});R.createIndex("outputTagId","outputTagId"),R.createIndex("outputId","outputId")}if(!_.objectStoreNames.contains("tx_labels")){const R=_.createObjectStore("tx_labels",{keyPath:"txLabelId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("label_userId",["label","userId"],{unique:!0})}if(!_.objectStoreNames.contains("tx_labels_map")){const R=_.createObjectStore("tx_labels_map",{keyPath:["txLabelId","transactionId"]});R.createIndex("txLabelId","txLabelId"),R.createIndex("transactionId","transactionId")}if(_.objectStoreNames.contains("monitor_events")||_.createObjectStore("monitor_events",{keyPath:"id",autoIncrement:!0}),!_.objectStoreNames.contains("sync_states")){const R=_.createObjectStore("sync_states",{keyPath:"syncStateId",autoIncrement:!0});R.createIndex("userId","userId"),R.createIndex("refNum","refNum",{unique:!0}),R.createIndex("status","status")}if(!_.objectStoreNames.contains("settings")){if(!d||!y)throw new t.WERR_INVALID_OPERATION("migrate must be called before first access");const R=_.createObjectStore("settings",{keyPath:"storageIdentityKey"}),E={created_at:new Date,updated_at:new Date,storageIdentityKey:y,storageName:d,chain:b,dbtype:"IndexedDB",maxOutputScript:g};R.put(E)}}})}async reviewStatus(d){return await(0,l.reviewStatusIdb)(this,d)}async purgeData(d,y){return await(0,h.purgeDataIdb)(this,d,y)}async allocateChangeInput(d,y,b,g,v,_){const S=this.toDbTrx(["outputs","transactions"],"readwrite");try{const I=["completed","unproven"];v||I.push("sending");const A={partial:{userId:d,basketId:y,spendable:!0},txStatus:I,trx:S},R=await this.findOutputs(A);let E,k=[];for(const P of R){if(g&&P.satoshis===g){E=P;break}const T=P.satoshis-b;k.push({output:P,score:T})}if(!E){k=k.sort((T,M)=>T.score-M.score);const P=k.find(T=>T.score>=0);P?E=P.output:k.length>0?E=k.slice(-1)[0].output:E=void 0}return E&&await this.updateOutput(E.outputId,{spendable:!1,spentBy:_},S),E}finally{await S.done}}async getProvenOrRawTx(d,y){const b={proven:void 0,rawTx:void 0,inputBEEF:void 0};if(b.proven=(0,s.verifyOneOrNone)(await this.findProvenTxs({partial:{txid:d},trx:y})),!b.proven){const g=(0,s.verifyOneOrNone)(await this.findProvenTxReqs({partial:{txid:d},trx:y}));g&&["unsent","unmined","unconfirmed","sending","nosend","completed"].includes(g.status)&&(b.rawTx=g.rawTx,b.inputBEEF=g.inputBEEF)}return b}async getRawTxOfKnownValidTransaction(d,y,b,g){if(!d)return;this.isAvailable()||await this.makeAvailable();let v;const _=await this.getProvenOrRawTx(d,g);return _.proven?v=_.proven.rawTx:v=_.rawTx,v&&y!==void 0&&b!==void 0&&Number.isInteger(y)&&Number.isInteger(b)&&(v=v.slice(y,y+b)),v}async getLabelsForTransactionId(d,y){const g=(await this.findTxLabelMaps({partial:{transactionId:d,isDeleted:!1},trx:y})).map(_=>_.txLabelId),v=[];for(const _ of g){const S=(0,s.verifyOne)(await this.findTxLabels({partial:{txLabelId:_,isDeleted:!1},trx:y}));v.push(S)}return v}async getTagsForOutputId(d,y){const g=(await this.findOutputTagMaps({partial:{outputId:d,isDeleted:!1},trx:y})).map(_=>_.outputTagId),v=[];for(const _ of g){const S=(0,s.verifyOne)(await this.findOutputTags({partial:{outputTagId:_,isDeleted:!1},trx:y}));v.push(S)}return v}async listActions(d,y){if(!d.userId)throw new t.WERR_UNAUTHORIZED;return await(0,c.listActionsIdb)(this,d,y)}async listOutputs(d,y){if(!d.userId)throw new t.WERR_UNAUTHORIZED;return await(0,u.listOutputsIdb)(this,d,y)}async countChangeInputs(d,y,b){const g=["completed","unproven"];b||g.push("sending");const v={partial:{userId:d,basketId:y},txStatus:g};let _=0;return await this.filterOutputs(v,S=>{_++}),_}async findCertificatesAuth(d,y){if(!d.userId||y.partial.userId&&y.partial.userId!==d.userId)throw new t.WERR_UNAUTHORIZED;return y.partial.userId=d.userId,await this.findCertificates(y)}async findOutputBasketsAuth(d,y){if(!d.userId||y.partial.userId&&y.partial.userId!==d.userId)throw new t.WERR_UNAUTHORIZED;return y.partial.userId=d.userId,await this.findOutputBaskets(y)}async findOutputsAuth(d,y){if(!d.userId||y.partial.userId&&y.partial.userId!==d.userId)throw new t.WERR_UNAUTHORIZED;return y.partial.userId=d.userId,await this.findOutputs(y)}async insertCertificateAuth(d,y){if(!d.userId||y.userId&&y.userId!==d.userId)throw new t.WERR_UNAUTHORIZED;return y.userId=d.userId,await this.insertCertificate(y)}async dropAllData(){await(0,r.deleteDB)(this.dbName)}async filterOutputTagMaps(d,y,b){var g,v,_,S;const I=((g=d.paged)===null||g===void 0?void 0:g.offset)||0;let A=0,R=0;const E=this.toDbTrx(["output_tags_map"],"readonly",d.trx);let k;((v=d.partial)===null||v===void 0?void 0:v.outputTagId)!==void 0?k=await E.objectStore("output_tags_map").index("outputTagId").openCursor(d.partial.outputTagId):((_=d.partial)===null||_===void 0?void 0:_.outputId)!==void 0?k=await E.objectStore("output_tags_map").index("outputId").openCursor(d.partial.outputId):k=await E.objectStore("output_tags_map").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.tagIds&&!d.tagIds.includes(T.outputTagId))&&!(d.partial&&(d.partial.outputTagId&&T.outputTagId!==d.partial.outputTagId||d.partial.outputId&&T.outputId!==d.partial.outputId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.isDeleted!==void 0&&T.isDeleted!==d.partial.isDeleted))&&!(b!==void 0&&T.txid&&await this.countOutputTags({partial:{userId:b,outputTagId:T.outputTagId},trx:d.trx})===0)){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findOutputTagMaps(d){const y=[];return await this.filterOutputTagMaps(d,b=>{y.push(this.validateEntity(b))}),y}async filterProvenTxReqs(d,y,b){var g,v,_,S,I,A,R;if(d.partial.rawTx)throw new t.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. ProvenTxReqs may not be found by rawTx value.");if(d.partial.inputBEEF)throw new t.WERR_INVALID_PARAMETER("args.partial.inputBEEF","undefined. ProvenTxReqs may not be found by inputBEEF value.");const E=((g=d.paged)===null||g===void 0?void 0:g.offset)||0;let k=0,P=0;const T=this.toDbTrx(["proven_tx_reqs"],"readonly",d.trx);let M;!((v=d.partial)===null||v===void 0)&&v.provenTxReqId?M=await T.objectStore("proven_tx_reqs").openCursor(d.partial.provenTxReqId):((_=d.partial)===null||_===void 0?void 0:_.provenTxId)!==void 0?M=await T.objectStore("proven_tx_reqs").index("provenTxId").openCursor(d.partial.provenTxId):((S=d.partial)===null||S===void 0?void 0:S.txid)!==void 0?M=await T.objectStore("proven_tx_reqs").index("txid").openCursor(d.partial.txid):((I=d.partial)===null||I===void 0?void 0:I.status)!==void 0?M=await T.objectStore("proven_tx_reqs").index("status").openCursor(d.partial.status):((A=d.partial)===null||A===void 0?void 0:A.batch)!==void 0?M=await T.objectStore("proven_tx_reqs").index("batch").openCursor(d.partial.batch):M=await T.objectStore("proven_tx_reqs").openCursor();let C=!0;for(;M&&(C||(M=await M.continue()),!!M);){C=!1;const D=M.value;if(!(d.since&&d.since>D.updated_at)&&!(d.partial&&(d.partial.provenTxReqId&&D.provenTxReqId!==d.partial.provenTxReqId||d.partial.provenTxId&&D.provenTxId!==d.partial.provenTxId||d.partial.created_at&&D.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&D.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.status&&D.status!==d.partial.status||d.partial.attempts!==void 0&&D.attempts!==d.partial.attempts||d.partial.notified!==void 0&&D.notified!==d.partial.notified||d.partial.txid&&D.txid!==d.partial.txid||d.partial.batch&&D.batch!==d.partial.batch||d.partial.history&&D.history!==d.partial.history||d.partial.notify&&D.notify!==d.partial.notify))&&!(b!==void 0&&D.txid&&await this.countTransactions({partial:{userId:b,txid:D.txid},trx:d.trx})===0)){if(k<E){k++;continue}if(y(D),P++,!((R=d.paged)===null||R===void 0)&&R.limit&&P>=d.paged.limit)break}}d.trx||await T.done}async findProvenTxReqs(d){const y=[];return await this.filterProvenTxReqs(d,b=>{y.push(this.validateEntity(b))}),y}async filterProvenTxs(d,y,b){var g,v,_,S;if(d.partial.rawTx)throw new t.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. ProvenTxs may not be found by rawTx value.");if(d.partial.merklePath)throw new t.WERR_INVALID_PARAMETER("args.partial.merklePath","undefined. ProvenTxs may not be found by merklePath value.");const I=((g=d.paged)===null||g===void 0?void 0:g.offset)||0;let A=0,R=0;const E=this.toDbTrx(["proven_txs"],"readonly",d.trx);let k;!((v=d.partial)===null||v===void 0)&&v.provenTxId?k=await E.objectStore("proven_txs").openCursor(d.partial.provenTxId):((_=d.partial)===null||_===void 0?void 0:_.txid)!==void 0?k=await E.objectStore("proven_txs").index("txid").openCursor(d.partial.txid):k=await E.objectStore("proven_txs").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.provenTxId&&T.provenTxId!==d.partial.provenTxId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.txid&&T.txid!==d.partial.txid||d.partial.height!==void 0&&T.height!==d.partial.height||d.partial.index!==void 0&&T.index!==d.partial.index||d.partial.blockHash&&T.blockHash!==d.partial.blockHash||d.partial.merkleRoot&&T.merkleRoot!==d.partial.merkleRoot))&&!(b!==void 0&&await this.countTransactions({partial:{userId:b,provenTxId:T.provenTxId},trx:d.trx})===0)){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findProvenTxs(d){const y=[];return await this.filterProvenTxs(d,b=>{y.push(this.validateEntity(b))}),y}async filterTxLabelMaps(d,y,b){var g,v,_,S;const I=((g=d.paged)===null||g===void 0?void 0:g.offset)||0;let A=0,R=0;const E=this.toDbTrx(["tx_labels_map"],"readonly",d.trx);let k;((v=d.partial)===null||v===void 0?void 0:v.transactionId)!==void 0?k=await E.objectStore("tx_labels_map").index("transactionId").openCursor(d.partial.transactionId):((_=d.partial)===null||_===void 0?void 0:_.txLabelId)!==void 0?k=await E.objectStore("tx_labels_map").index("txLabelId").openCursor(d.partial.txLabelId):k=await E.objectStore("tx_labels_map").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.txLabelId&&T.txLabelId!==d.partial.txLabelId||d.partial.transactionId&&T.transactionId!==d.partial.transactionId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.isDeleted!==void 0&&T.isDeleted!==d.partial.isDeleted))&&!(b!==void 0&&await this.countTxLabels({partial:{userId:b,txLabelId:T.txLabelId},trx:d.trx})===0)){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findTxLabelMaps(d){const y=[];return await this.filterTxLabelMaps(d,b=>{y.push(this.validateEntity(b))}),y}async countOutputTagMaps(d){let y=0;return await this.filterOutputTagMaps(d,()=>{y++}),y}async countProvenTxReqs(d){let y=0;return await this.filterProvenTxReqs(d,()=>{y++}),y}async countProvenTxs(d){let y=0;return await this.filterProvenTxs(d,()=>{y++}),y}async countTxLabelMaps(d){let y=0;return await this.filterTxLabelMaps(d,()=>{y++}),y}async insertCertificate(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]),g=b.fields;b.fields&&delete b.fields,b.certificateId===0&&delete b.certificateId;const v=this.toDbTrx(["certificates","certificate_fields"],"readwrite",y),_=v.objectStore("certificates");try{const S=Number(await _.add(b));if(d.certificateId=S,g)for(const I of g)I.certificateId=d.certificateId,I.userId=d.userId,await this.insertCertificateField(I,v)}finally{y||await v.done}return d.certificateId}async insertCertificateField(d,y){const b=await this.validateEntityForInsert(d,y),g=this.toDbTrx(["certificate_fields"],"readwrite",y),v=g.objectStore("certificate_fields");try{await v.add(b)}finally{y||await g.done}}async insertCommission(d,y){const b=await this.validateEntityForInsert(d,y);b.commissionId===0&&delete b.commissionId;const g=this.toDbTrx(["commissions"],"readwrite",y),v=g.objectStore("commissions");try{const _=Number(await v.add(b));d.commissionId=_}finally{y||await g.done}return d.commissionId}async insertMonitorEvent(d,y){const b=await this.validateEntityForInsert(d,y);b.id===0&&delete b.id;const g=this.toDbTrx(["monitor_events"],"readwrite",y),v=g.objectStore("monitor_events");try{const _=Number(await v.add(b));d.id=_}finally{y||await g.done}return d.id}async insertOutput(d,y){const b=await this.validateEntityForInsert(d,y);b.outputId===0&&delete b.outputId;const g=this.toDbTrx(["outputs"],"readwrite",y),v=g.objectStore("outputs");try{const _=Number(await v.add(b));d.outputId=_}finally{y||await g.done}return d.outputId}async insertOutputBasket(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]);b.basketId===0&&delete b.basketId;const g=this.toDbTrx(["output_baskets"],"readwrite",y),v=g.objectStore("output_baskets");try{const _=Number(await v.add(b));d.basketId=_}finally{y||await g.done}return d.basketId}async insertOutputTag(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]);b.outputTagId===0&&delete b.outputTagId;const g=this.toDbTrx(["output_tags"],"readwrite",y),v=g.objectStore("output_tags");try{const _=Number(await v.add(b));d.outputTagId=_}finally{y||await g.done}return d.outputTagId}async insertOutputTagMap(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]),g=this.toDbTrx(["output_tags_map"],"readwrite",y),v=g.objectStore("output_tags_map");try{await v.add(b)}finally{y||await g.done}}async insertProvenTx(d,y){const b=await this.validateEntityForInsert(d,y);b.provenTxId===0&&delete b.provenTxId;const g=this.toDbTrx(["proven_txs"],"readwrite",y),v=g.objectStore("proven_txs");try{const _=Number(await v.add(b));d.provenTxId=_}finally{y||await g.done}return d.provenTxId}async insertProvenTxReq(d,y){const b=await this.validateEntityForInsert(d,y);b.provenTxReqId===0&&delete b.provenTxReqId;const g=this.toDbTrx(["proven_tx_reqs"],"readwrite",y),v=g.objectStore("proven_tx_reqs");try{const _=Number(await v.add(b));d.provenTxReqId=_}finally{y||await g.done}return d.provenTxReqId}async insertSyncState(d,y){const b=await this.validateEntityForInsert(d,y,["when"],["init"]);b.syncStateId===0&&delete b.syncStateId;const g=this.toDbTrx(["sync_states"],"readwrite",y),v=g.objectStore("sync_states");try{const _=Number(await v.add(b));d.syncStateId=_}finally{y||await g.done}return d.syncStateId}async insertTransaction(d,y){const b=await this.validateEntityForInsert(d,y);b.transactionId===0&&delete b.transactionId;const g=this.toDbTrx(["transactions"],"readwrite",y),v=g.objectStore("transactions");try{const _=Number(await v.add(b));d.transactionId=_}finally{y||await g.done}return d.transactionId}async insertTxLabel(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]);b.txLabelId===0&&delete b.txLabelId;const g=this.toDbTrx(["tx_labels"],"readwrite",y),v=g.objectStore("tx_labels");try{const _=Number(await v.add(b));d.txLabelId=_}finally{y||await g.done}return d.txLabelId}async insertTxLabelMap(d,y){const b=await this.validateEntityForInsert(d,y,void 0,["isDeleted"]),g=this.toDbTrx(["tx_labels_map"],"readwrite",y),v=g.objectStore("tx_labels_map");try{await v.add(b)}finally{y||await g.done}}async insertUser(d,y){const b=await this.validateEntityForInsert(d,y);b.userId===0&&delete b.userId;const g=this.toDbTrx(["users"],"readwrite",y),v=g.objectStore("users");try{const _=Number(await v.add(b));d.userId=_}finally{y||await g.done}return d.userId}async updateIdb(d,y,b,g,v){if(y[b]!==void 0&&(Array.isArray(d)||y[b]!==d))throw new t.WERR_INVALID_PARAMETER(`update.${b}`,"undefined");const _=this.validatePartialForUpdate(y),S=this.toDbTrx([g],"readwrite",v),I=S.objectStore(g),A=Array.isArray(d)?d:[d];try{for(const R of A){const E=await I.get(R);if(!E)throw new t.WERR_INVALID_PARAMETER("id",`an existing record to update ${b} ${R} not found`);const k={...E,..._},P=await I.put(k);if(P!==R)throw new t.WERR_INTERNAL(`updated id ${P} does not match original ${d}`)}}finally{v||await S.done}return 1}async updateIdbKey(d,y,b,g,v){if(d.length!==b.length)throw new t.WERR_INTERNAL(`key.length ${d.length} !== keyProps.length ${b.length}`);for(let A=0;A<d.length;A++)if(y[b[A]]!==void 0&&y[b[A]]!==d[A])throw new t.WERR_INVALID_PARAMETER(`update.${b[A]}`,"undefined");const _=this.validatePartialForUpdate(y),S=this.toDbTrx([g],"readwrite",v),I=S.objectStore(g);try{const A=await I.get(d);if(!A)throw new t.WERR_INVALID_PARAMETER("key",`an existing record to update ${b.join(",")} ${d.join(",")} not found`);const R={...A,..._},E=await I.put(R);for(let k=0;k<d.length;k++)if(E[k]!==d[k])throw new t.WERR_INTERNAL(`updated key ${E[k]} does not match original ${d[k]}`)}finally{v||await S.done}return 1}async updateCertificate(d,y,b){return this.updateIdb(d,y,"certificateId","certificates",b)}async updateCertificateField(d,y,b,g){return this.updateIdbKey([d,y],b,["certificateId","fieldName"],"certificate_fields",g)}async updateCommission(d,y,b){return this.updateIdb(d,y,"commissionId","commissions",b)}async updateMonitorEvent(d,y,b){return this.updateIdb(d,y,"id","monitor_events",b)}async updateOutput(d,y,b){return this.updateIdb(d,y,"outputId","outputs",b)}async updateOutputBasket(d,y,b){return this.updateIdb(d,y,"basketId","output_baskets",b)}async updateOutputTag(d,y,b){return this.updateIdb(d,y,"outputTagId","output_tags",b)}async updateProvenTx(d,y,b){return this.updateIdb(d,y,"provenTxId","proven_txs",b)}async updateProvenTxReq(d,y,b){return this.updateIdb(d,y,"provenTxReqId","proven_tx_reqs",b)}async updateSyncState(d,y,b){return this.updateIdb(d,y,"syncStateId","sync_states",b)}async updateTransaction(d,y,b){return this.updateIdb(d,y,"transactionId","transactions",b)}async updateTxLabel(d,y,b){return this.updateIdb(d,y,"txLabelId","tx_labels",b)}async updateUser(d,y,b){return this.updateIdb(d,y,"userId","users",b)}async updateOutputTagMap(d,y,b,g){return this.updateIdbKey([y,d],b,["outputTagId","outputId"],"output_tags_map",g)}async updateTxLabelMap(d,y,b,g){return this.updateIdbKey([y,d],b,["txLabelId","transactionId"],"tx_labels_map",g)}async destroy(){this.db&&this.db.close(),this.db=void 0,this._settings=void 0}async transaction(d,y){if(y)return await d(y);const b=this.allStores,v=(await this.verifyDB()).transaction(b,"readwrite");try{const _=await d(v);return await v.done,_}catch(_){throw v.abort(),await v.done,_}}async filterCertificateFields(d,y){var b,g,v,_;const S=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let I=0,A=0;const R=this.toDbTrx(["certificate_fields"],"readonly",d.trx);let E;((g=d.partial)===null||g===void 0?void 0:g.certificateId)!==void 0?E=await R.objectStore("certificate_fields").index("certificateId").openCursor(d.partial.certificateId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?E=await R.objectStore("certificate_fields").index("userId").openCursor(d.partial.userId):E=await R.objectStore("certificate_fields").openCursor();let k=!0;for(;E&&(k||(E=await E.continue()),!!E);){k=!1;const P=E.value;if(!(d.since&&d.since>P.updated_at)&&!(d.partial&&(d.partial.userId&&P.userId!==d.partial.userId||d.partial.certificateId&&P.certificateId!==d.partial.certificateId||d.partial.created_at&&P.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&P.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.fieldName&&P.fieldName!==d.partial.fieldName||d.partial.fieldValue&&P.fieldValue!==d.partial.fieldValue||d.partial.masterKey&&P.masterKey!==d.partial.masterKey))){if(I<S){I++;continue}if(y(P),A++,!((_=d.paged)===null||_===void 0)&&_.limit&&A>=d.paged.limit)break}}d.trx||await R.done}async findCertificateFields(d){const y=[];return await this.filterCertificateFields(d,b=>{y.push(this.validateEntity(b))}),y}async filterCertificates(d,y){var b,g,v,_,S,I,A;const R=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let E=0,k=0;const P=this.toDbTrx(["certificates"],"readonly",d.trx);let T;!((g=d.partial)===null||g===void 0)&&g.certificateId?T=await P.objectStore("certificates").openCursor(d.partial.certificateId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?!((_=d.partial)===null||_===void 0)&&_.type&&(!((S=d.partial)===null||S===void 0)&&S.certifier)&&(!((I=d.partial)===null||I===void 0)&&I.serialNumber)?T=await P.objectStore("certificates").index("userId_type_certifier_serialNumber").openCursor([d.partial.userId,d.partial.type,d.partial.certifier,d.partial.serialNumber]):T=await P.objectStore("certificates").index("userId").openCursor(d.partial.userId):T=await P.objectStore("certificates").openCursor();let M=!0;for(;T&&(M||(T=await T.continue()),!!T);){M=!1;const C=T.value;if(!(d.since&&d.since>C.updated_at)&&!(d.certifiers&&!d.certifiers.includes(C.certifier))&&!(d.types&&!d.types.includes(C.type))&&!(d.partial&&(d.partial.userId&&C.userId!==d.partial.userId||d.partial.certificateId&&C.certificateId!==d.partial.certificateId||d.partial.created_at&&C.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&C.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.type&&C.type!==d.partial.type||d.partial.serialNumber&&C.serialNumber!==d.partial.serialNumber||d.partial.certifier&&C.certifier!==d.partial.certifier||d.partial.subject&&C.subject!==d.partial.subject||d.partial.verifier&&C.verifier!==d.partial.verifier||d.partial.revocationOutpoint&&C.revocationOutpoint!==d.partial.revocationOutpoint||d.partial.signature&&C.signature!==d.partial.signature||d.partial.isDeleted&&C.isDeleted!==d.partial.isDeleted))){if(E<R){E++;continue}if(y(C),k++,!((A=d.paged)===null||A===void 0)&&A.limit&&k>=d.paged.limit)break}}d.trx||await P.done}async findCertificates(d){const y=[];if(await this.filterCertificates(d,b=>{y.push(this.validateEntity(b))}),d.includeFields)for(const b of y){const g=await this.findCertificateFields({partial:{certificateId:b.certificateId},trx:d.trx});b.fields=g}return y}async filterCommissions(d,y){var b,g,v,_,S;if(d.partial.lockingScript)throw new t.WERR_INVALID_PARAMETER("partial.lockingScript","undefined. Commissions may not be found by lockingScript value.");const I=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let A=0,R=0;const E=this.toDbTrx(["commissions"],"readonly",d.trx);let k;!((g=d.partial)===null||g===void 0)&&g.commissionId?k=await E.objectStore("commissions").openCursor(d.partial.commissionId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?k=await E.objectStore("commissions").index("userId").openCursor(d.partial.userId):((_=d.partial)===null||_===void 0?void 0:_.transactionId)!==void 0?k=await E.objectStore("commissions").index("transactionId").openCursor(d.partial.transactionId):k=await E.objectStore("commissions").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.commissionId&&T.commissionId!==d.partial.commissionId||d.partial.transactionId&&T.transactionId!==d.partial.transactionId||d.partial.userId&&T.userId!==d.partial.userId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.satoshis!==void 0&&T.satoshis!==d.partial.satoshis||d.partial.keyOffset&&T.keyOffset!==d.partial.keyOffset||d.partial.isRedeemed!==void 0&&T.isRedeemed!==d.partial.isRedeemed))){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findCommissions(d){const y=[];return await this.filterCommissions(d,b=>{y.push(this.validateEntity(b))}),y}async filterMonitorEvents(d,y){var b,g,v;const _=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let S=0,I=0;const A=this.toDbTrx(["monitor_events"],"readonly",d.trx);let R;!((g=d.partial)===null||g===void 0)&&g.id?R=await A.objectStore("monitor_events").openCursor(d.partial.id):R=await A.objectStore("monitor_events").openCursor();let E=!0;for(;R&&(E||(R=await R.continue()),!!R);){E=!1;const k=R.value;if(!(d.since&&d.since>k.updated_at)&&!(d.partial&&(d.partial.id&&k.id!==d.partial.id||d.partial.created_at&&k.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&k.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.event&&k.event!==d.partial.event||d.partial.details&&k.details!==d.partial.details))){if(S<_){S++;continue}if(y(k),I++,!((v=d.paged)===null||v===void 0)&&v.limit&&I>=d.paged.limit)break}}d.trx||await A.done}async findMonitorEvents(d){const y=[];return await this.filterMonitorEvents(d,b=>{y.push(this.validateEntity(b))}),y}async filterOutputBaskets(d,y){var b,g,v,_,S;const I=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let A=0,R=0;const E=this.toDbTrx(["output_baskets"],"readonly",d.trx);let k;!((g=d.partial)===null||g===void 0)&&g.basketId?k=await E.objectStore("output_baskets").openCursor(d.partial.basketId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?((_=d.partial)===null||_===void 0?void 0:_.name)!==void 0?k=await E.objectStore("output_baskets").index("name_userId").openCursor([d.partial.name,d.partial.userId]):k=await E.objectStore("output_baskets").index("userId").openCursor(d.partial.userId):k=await E.objectStore("output_baskets").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.basketId&&T.basketId!==d.partial.basketId||d.partial.userId&&T.userId!==d.partial.userId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.name&&T.name!==d.partial.name||d.partial.numberOfDesiredUTXOs!==void 0&&T.numberOfDesiredUTXOs!==d.partial.numberOfDesiredUTXOs||d.partial.minimumDesiredUTXOValue!==void 0&&T.numberOfDesiredSatoshis!==d.partial.minimumDesiredUTXOValue||d.partial.isDeleted!==void 0&&T.isDeleted!==d.partial.isDeleted))){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findOutputBaskets(d){const y=[];return await this.filterOutputBaskets(d,b=>{y.push(this.validateEntity(b))}),y}async filterOutputs(d,y,b,g){var v,_,S,I,A,R,E,k,P;if(d.partial.lockingScript)throw new t.WERR_INVALID_PARAMETER("args.partial.lockingScript","undefined. Outputs may not be found by lockingScript value.");const T=((v=d.paged)===null||v===void 0?void 0:v.offset)||0;let M=0,C=0;const D=["outputs"];b&&b.length>0&&D.push("output_tags_map"),d.txStatus&&D.push("transactions");const F=this.toDbTrx(D,"readonly",d.trx);let B;!((_=d.partial)===null||_===void 0)&&_.outputId?B=await F.objectStore("outputs").openCursor(d.partial.outputId):((S=d.partial)===null||S===void 0?void 0:S.userId)!==void 0?!((I=d.partial)===null||I===void 0)&&I.transactionId&&((A=d.partial)===null||A===void 0?void 0:A.vout)!==void 0?B=await F.objectStore("outputs").index("transactionId_vout_userId").openCursor([d.partial.transactionId,d.partial.vout,d.partial.userId]):B=await F.objectStore("outputs").index("userId").openCursor(d.partial.userId):((R=d.partial)===null||R===void 0?void 0:R.transactionId)!==void 0?B=await F.objectStore("outputs").index("transactionId").openCursor(d.partial.transactionId):((E=d.partial)===null||E===void 0?void 0:E.basketId)!==void 0?B=await F.objectStore("outputs").index("basketId").openCursor(d.partial.basketId):((k=d.partial)===null||k===void 0?void 0:k.spentBy)!==void 0?B=await F.objectStore("outputs").index("spentBy").openCursor(d.partial.spentBy):B=await F.objectStore("outputs").openCursor();let L=!0;for(;B&&(L||(B=await B.continue()),!!B);){L=!1;const q=B.value;if(!(d.since&&d.since>q.updated_at)&&!(d.partial&&(d.partial.outputId&&q.outputId!==d.partial.outputId||d.partial.userId&&q.userId!==d.partial.userId||d.partial.transactionId&&q.transactionId!==d.partial.transactionId||d.partial.basketId&&q.basketId!==d.partial.basketId||d.partial.created_at&&q.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&q.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.spendable!==void 0&&q.spendable!==d.partial.spendable||d.partial.change!==void 0&&q.change!==d.partial.change||d.partial.outputDescription&&q.outputDescription!==d.partial.outputDescription||d.partial.vout!==void 0&&q.vout!==d.partial.vout||d.partial.satoshis!==void 0&&q.satoshis!==d.partial.satoshis||d.partial.providedBy&&q.providedBy!==d.partial.providedBy||d.partial.purpose&&q.purpose!==d.partial.purpose||d.partial.type&&q.type!==d.partial.type||d.partial.txid&&q.txid!==d.partial.txid||d.partial.senderIdentityKey&&q.senderIdentityKey!==d.partial.senderIdentityKey||d.partial.derivationPrefix&&q.derivationPrefix!==d.partial.derivationPrefix||d.partial.derivationSuffix&&q.derivationSuffix!==d.partial.derivationSuffix||d.partial.customInstructions&&q.customInstructions!==d.partial.customInstructions||d.partial.spentBy&&q.spentBy!==d.partial.spentBy||d.partial.sequenceNumber!==void 0&&q.sequenceNumber!==d.partial.sequenceNumber||d.partial.scriptLength!==void 0&&q.scriptLength!==d.partial.scriptLength||d.partial.scriptOffset!==void 0&&q.scriptOffset!==d.partial.scriptOffset))&&!(d.txStatus!==void 0&&await this.countTransactions({partial:{transactionId:q.transactionId},status:d.txStatus,trx:F})===0)){if(b&&b.length>0){let K=[...b];if(await this.filterOutputTagMaps({partial:{outputId:q.outputId},trx:F},$=>{if(K.length>0){const U=K.indexOf($.outputTagId);U>=0&&(g?K.splice(U,1):K=[])}}),K.length>0)continue}if(M<T){M++;continue}if(d.noScript===!0&&(q.script=void 0),y(q),C++,!((P=d.paged)===null||P===void 0)&&P.limit&&C>=d.paged.limit)break}}d.trx||await F.done}async findOutputs(d,y,b){const g=[];await this.filterOutputs(d,v=>{g.push(this.validateEntity(v))},y,b);for(const v of g)d.noScript?v.lockingScript=void 0:await this.validateOutputScript(v);return g}async filterOutputTags(d,y){var b,g,v,_,S;const I=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let A=0,R=0;const E=this.toDbTrx(["output_tags"],"readonly",d.trx);let k;!((g=d.partial)===null||g===void 0)&&g.outputTagId?k=await E.objectStore("output_tags").openCursor(d.partial.outputTagId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?((_=d.partial)===null||_===void 0?void 0:_.tag)!==void 0?k=await E.objectStore("output_tags").index("tag_userId").openCursor([d.partial.tag,d.partial.userId]):k=await E.objectStore("output_tags").index("userId").openCursor(d.partial.userId):k=await E.objectStore("output_tags").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.outputTagId&&T.outputTagId!==d.partial.outputTagId||d.partial.userId&&T.userId!==d.partial.userId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.tag&&T.tag!==d.partial.tag||d.partial.isDeleted!==void 0&&T.isDeleted!==d.partial.isDeleted))){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findOutputTags(d){const y=[];return await this.filterOutputTags(d,b=>{y.push(this.validateEntity(b))}),y}async filterSyncStates(d,y){var b,g,v,_,S,I,A;if(d.partial.syncMap)throw new t.WERR_INVALID_PARAMETER("args.partial.syncMap","undefined. SyncStates may not be found by syncMap value.");const R=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let E=0,k=0;const P=this.toDbTrx(["sync_states"],"readonly",d.trx);let T;!((g=d.partial)===null||g===void 0)&&g.syncStateId?T=await P.objectStore("sync_states").openCursor(d.partial.syncStateId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?T=await P.objectStore("sync_states").index("userId").openCursor(d.partial.userId):((_=d.partial)===null||_===void 0?void 0:_.refNum)!==void 0?T=await P.objectStore("sync_states").index("refNum").openCursor(d.partial.refNum):((S=d.partial)===null||S===void 0?void 0:S.status)!==void 0?T=await P.objectStore("sync_states").index("status").openCursor(d.partial.status):T=await P.objectStore("sync_states").openCursor();let M=!0;for(;T&&(M||(T=await T.continue()),!!T);){M=!1;const C=T.value;if(!(d.since&&d.since>C.updated_at)&&!(d.partial&&(d.partial.syncStateId&&C.syncStateId!==d.partial.syncStateId||d.partial.userId&&C.userId!==d.partial.userId||d.partial.created_at&&C.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&C.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.storageIdentityKey&&C.storageIdentityKey!==d.partial.storageIdentityKey||d.partial.storageName&&C.storageName!==d.partial.storageName||d.partial.status&&C.status!==d.partial.status||d.partial.init!==void 0&&C.init!==d.partial.init||d.partial.refNum!==void 0&&C.refNum!==d.partial.refNum||d.partial.when&&((I=C.when)===null||I===void 0?void 0:I.getTime())!==d.partial.when.getTime()||d.partial.satoshis!==void 0&&C.satoshis!==d.partial.satoshis||d.partial.errorLocal&&C.errorLocale!==d.partial.errorLocal||d.partial.errorOther&&C.errorOther!==d.partial.errorOther))){if(E<R){E++;continue}if(y(C),k++,!((A=d.paged)===null||A===void 0)&&A.limit&&k>=d.paged.limit)break}}d.trx||await P.done}async findSyncStates(d){const y=[];return await this.filterSyncStates(d,b=>{y.push(this.validateEntity(b))}),y}async filterTransactions(d,y,b,g){var v,_,S,I,A,R,E,k;if(d.partial.rawTx)throw new t.WERR_INVALID_PARAMETER("args.partial.rawTx","undefined. Transactions may not be found by rawTx value.");if(d.partial.inputBEEF)throw new t.WERR_INVALID_PARAMETER("args.partial.inputBEEF","undefined. Transactions may not be found by inputBEEF value.");const P=((v=d.paged)===null||v===void 0?void 0:v.offset)||0;let T=0,M=0;const C=["transactions"];b&&b.length>0&&C.push("tx_labels_map");const D=this.toDbTrx(C,"readonly",d.trx);let F;!((_=d.partial)===null||_===void 0)&&_.transactionId?F=await D.objectStore("transactions").openCursor(d.partial.transactionId):((S=d.partial)===null||S===void 0?void 0:S.userId)!==void 0?((I=d.partial)===null||I===void 0?void 0:I.status)!==void 0?F=await D.objectStore("transactions").index("status_userId").openCursor([d.partial.status,d.partial.userId]):F=await D.objectStore("transactions").index("userId").openCursor(d.partial.userId):((A=d.partial)===null||A===void 0?void 0:A.status)!==void 0?F=await D.objectStore("transactions").index("status").openCursor(d.partial.status):((R=d.partial)===null||R===void 0?void 0:R.provenTxId)!==void 0?F=await D.objectStore("transactions").index("provenTxId").openCursor(d.partial.provenTxId):((E=d.partial)===null||E===void 0?void 0:E.reference)!==void 0?F=await D.objectStore("transactions").index("reference").openCursor(d.partial.reference):F=await D.objectStore("transactions").openCursor();let B=!0;for(;F&&(B||(F=await F.continue()),!!F);){B=!1;const L=F.value;if(!(d.since&&d.since>L.updated_at)&&!(d.status&&!d.status.includes(L.status))&&!(d.partial&&(d.partial.transactionId&&L.transactionId!==d.partial.transactionId||d.partial.userId&&L.userId!==d.partial.userId||d.partial.created_at&&L.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&L.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.provenTxId&&L.provenTxId!==d.partial.provenTxId||d.partial.status&&L.status!==d.partial.status||d.partial.reference&&L.reference!==d.partial.reference||d.partial.isOutgoing!==void 0&&L.isOutgoing!==d.partial.isOutgoing||d.partial.satoshis!==void 0&&L.satoshis!==d.partial.satoshis||d.partial.description&&L.description!==d.partial.description||d.partial.version!==void 0&&L.version!==d.partial.version||d.partial.lockTime!==void 0&&L.lockTime!==d.partial.lockTime||d.partial.txid&&L.txid!==d.partial.txid))){if(b&&b.length>0){let q=[...b];if(await this.filterTxLabelMaps({partial:{transactionId:L.transactionId},trx:D},K=>{if(q.length>0){const $=q.indexOf(K.txLabelId);$>=0&&(g?q.splice($,1):q=[])}}),q.length>0)continue}if(T<P){T++;continue}if(y(L),M++,!((k=d.paged)===null||k===void 0)&&k.limit&&M>=d.paged.limit)break}}d.trx||await D.done}async findTransactions(d,y,b){const g=[];await this.filterTransactions(d,v=>{g.push(this.validateEntity(v))},y,b);for(const v of g)d.noRawTx?(v.rawTx=void 0,v.inputBEEF=void 0):await this.validateRawTransaction(v,d.trx);return g}async filterTxLabels(d,y){var b,g,v,_,S;const I=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let A=0,R=0;const E=this.toDbTrx(["tx_labels"],"readonly",d.trx);let k;!((g=d.partial)===null||g===void 0)&&g.txLabelId?k=await E.objectStore("tx_labels").openCursor(d.partial.txLabelId):((v=d.partial)===null||v===void 0?void 0:v.userId)!==void 0?((_=d.partial)===null||_===void 0?void 0:_.label)!==void 0?k=await E.objectStore("tx_labels").index("label_userId").openCursor([d.partial.label,d.partial.userId]):k=await E.objectStore("tx_labels").index("userId").openCursor(d.partial.userId):k=await E.objectStore("tx_labels").openCursor();let P=!0;for(;k&&(P||(k=await k.continue()),!!k);){P=!1;const T=k.value;if(!(d.since&&d.since>T.updated_at)&&!(d.partial&&(d.partial.txLabelId&&T.txLabelId!==d.partial.txLabelId||d.partial.userId&&T.userId!==d.partial.userId||d.partial.created_at&&T.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&T.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.label&&T.label!==d.partial.label||d.partial.isDeleted!==void 0&&T.isDeleted!==d.partial.isDeleted))){if(A<I){A++;continue}if(y(T),R++,!((S=d.paged)===null||S===void 0)&&S.limit&&R>=d.paged.limit)break}}d.trx||await E.done}async findTxLabels(d){const y=[];return await this.filterTxLabels(d,b=>{y.push(this.validateEntity(b))}),y}async filterUsers(d,y){var b,g;const v=((b=d.paged)===null||b===void 0?void 0:b.offset)||0;let _=0,S=0;const I=this.toDbTrx(["users"],"readonly",d.trx);let A=await I.objectStore("users").openCursor(),R=!0;for(;A&&(R||(A=await A.continue()),!!A);){R=!1;const E=A.value;if(!(d.since&&d.since>E.updated_at)&&!(d.partial&&(d.partial.userId&&E.userId!==d.partial.userId||d.partial.created_at&&E.created_at.getTime()!==d.partial.created_at.getTime()||d.partial.updated_at&&E.updated_at.getTime()!==d.partial.updated_at.getTime()||d.partial.identityKey&&E.identityKey!==d.partial.identityKey||d.partial.activeStorage&&E.activeStorage!==d.partial.activeStorage))){if(_<v){_++;continue}if(y(E),S++,!((g=d.paged)===null||g===void 0)&&g.limit&&S>=d.paged.limit)break}}d.trx||await I.done}async findUsers(d){const y=[];return await this.filterUsers(d,b=>{y.push(this.validateEntity(b))}),y}async countCertificateFields(d){let y=0;return await this.filterCertificateFields(d,()=>{y++}),y}async countCertificates(d){let y=0;return await this.filterCertificates(d,()=>{y++}),y}async countCommissions(d){let y=0;return await this.filterCommissions(d,()=>{y++}),y}async countMonitorEvents(d){let y=0;return await this.filterMonitorEvents(d,()=>{y++}),y}async countOutputBaskets(d){let y=0;return await this.filterOutputBaskets(d,()=>{y++}),y}async countOutputs(d,y,b){let g=0;return await this.filterOutputs({...d,noScript:!0},()=>{g++},y,b),g}async countOutputTags(d){let y=0;return await this.filterOutputTags(d,()=>{y++}),y}async countSyncStates(d){let y=0;return await this.filterSyncStates(d,()=>{y++}),y}async countTransactions(d,y,b){let g=0;return await this.filterTransactions({...d,noRawTx:!0},()=>{g++},y,b),g}async countTxLabels(d){let y=0;return await this.filterTxLabels(d,()=>{y++}),y}async countUsers(d){let y=0;return await this.filterUsers(d,()=>{y++}),y}async getProvenTxsForUser(d){const y=[],b={partial:{},since:d.since,paged:d.paged,trx:d.trx};return await this.filterProvenTxs(b,g=>{y.push(this.validateEntity(g))},d.userId),y}async getProvenTxReqsForUser(d){const y=[],b={partial:{},since:d.since,paged:d.paged,trx:d.trx};return await this.filterProvenTxReqs(b,g=>{y.push(this.validateEntity(g))},d.userId),y}async getTxLabelMapsForUser(d){const y=[],b={partial:{},since:d.since,paged:d.paged,trx:d.trx};return await this.filterTxLabelMaps(b,g=>{y.push(this.validateEntity(g))},d.userId),y}async getOutputTagMapsForUser(d){const y=[],b={partial:{},since:d.since,paged:d.paged,trx:d.trx};return await this.filterOutputTagMaps(b,g=>{y.push(this.validateEntity(g))},d.userId),y}async verifyReadyForDatabaseAccess(d){return this._settings||(this._settings=await this.readSettings()),this._settings.dbtype}validateEntity(d,y,b){if(d.created_at=this.validateDate(d.created_at),d.updated_at=this.validateDate(d.updated_at),y)for(const g of y)d[g]&&(d[g]=this.validateDate(d[g]));if(b)for(const g of b)d[g]!==void 0&&(d[g]=!!d[g]);for(const g of Object.keys(d)){const v=d[g];v===null?d[g]=void 0:v instanceof Uint8Array&&(d[g]=Array.from(v))}return d}validateEntities(d,y,b){for(let g=0;g<d.length;g++)d[g]=this.validateEntity(d[g],y,b);return d}validatePartialForUpdate(d,y,b){if(!this.dbtype)throw new t.WERR_INTERNAL("must call verifyReadyForDatabaseAccess first");const g={...d};if(g.created_at&&(g.created_at=this.validateEntityDate(g.created_at)),g.updated_at&&(g.updated_at=this.validateEntityDate(g.updated_at)),g.created_at||delete g.created_at,g.updated_at||(g.updated_at=this.validateEntityDate(new Date)),y)for(const v of y)g[v]&&(g[v]=this.validateOptionalEntityDate(g[v]));if(b)for(const v of b)d[v]!==void 0&&(d[v]=d[v]?1:0);for(const v of Object.keys(g)){const _=g[v];Array.isArray(_)&&(_.length===0||Number.isInteger(_[0]))?g[v]=Uint8Array.from(_):_===null&&(g[v]=void 0)}return this.isDirty=!0,g}async validateEntityForInsert(d,y,b,g){await this.verifyReadyForDatabaseAccess(y);const v={...d};if(v.created_at=this.validateOptionalEntityDate(v.created_at,!0),v.updated_at=this.validateOptionalEntityDate(v.updated_at,!0),v.created_at||delete v.created_at,v.updated_at||delete v.updated_at,b)for(const _ of b)v[_]&&(v[_]=this.validateOptionalEntityDate(v[_]));if(g)for(const _ of g)d[_]!==void 0&&(d[_]=d[_]?1:0);for(const _ of Object.keys(v)){const S=v[_];Array.isArray(S)&&(S.length===0||Number.isInteger(S[0]))?v[_]=Uint8Array.from(S):S===null&&(v[_]=void 0)}return this.isDirty=!0,v}async validateRawTransaction(d,y){if(d.rawTx||!d.txid)return;const b=await this.getRawTxOfKnownValidTransaction(d.txid,void 0,void 0,y);b&&(d.rawTx=b)}async adminStats(d){throw new Error("Method intentionally not implemented for personal storage.")}};return rr.StorageIdb=f,rr}var y3;function nL(){if(y3)return Xl;y3=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.SetupClient=void 0;const i=Ye(),e=Ke(),n=Ok();let r=class us{static async createWallet(s){const a=s.chain,c=i.PrivateKey.fromHex(s.rootKeyHex),u=c.toPublicKey().toString(),l=new i.KeyDeriver(c),h=new e.WalletStorageManager(u,s.active,s.backups);h.canMakeAvailable()&&await h.makeAvailable();const f=e.Services.createDefaultOptions(a);f.taalApiKey=s.taalApiKey;const m=new e.Services(f),d=e.Monitor.createDefaultWalletMonitorOptions(a,h,m),y=new e.Monitor(d);y.addDefaultTasks();const b=s.privilegedKeyGetter?new e.sdk.PrivilegedKeyManager(s.privilegedKeyGetter):void 0,g=new e.Wallet({chain:a,keyDeriver:l,storage:h,services:m,monitor:y,privilegedKeyManager:b});return{rootKey:c,identityKey:u,keyDeriver:l,chain:a,storage:h,services:m,monitor:y,wallet:g}}static async createWalletClientNoEnv(s){const a=s.chain,c=s.storageUrl||`https://${s.chain!=="main"?"staging-":""}storage.babbage.systems`,u=i.PrivateKey.fromHex(s.rootKeyHex),l=new i.KeyDeriver(u),h=new e.WalletStorageManager(l.identityKey),f=new e.Services(a),m=s.privilegedKeyGetter?new e.sdk.PrivilegedKeyManager(s.privilegedKeyGetter):void 0,d=new e.Wallet({chain:a,keyDeriver:l,storage:h,services:f,privilegedKeyManager:m}),y=new e.StorageClient(d,c);return await h.addWalletStorageProvider(y),await h.makeAvailable(),d}static async createWalletClient(s){const a=await us.createWallet(s),c=s.endpointUrl||`https://${s.chain!=="main"?"staging-":""}storage.babbage.systems`,u=new e.StorageClient(a.wallet,c);return await a.storage.addWalletStorageProvider(u),await a.storage.makeAvailable(),{...a,endpointUrl:c}}static getKeyPair(s){s===void 0?s=i.PrivateKey.fromRandom():typeof s=="string"&&(s=new i.PrivateKey(s,"hex"));const a=i.PublicKey.fromPrivateKey(s),c=a.toAddress();return{privateKey:s,publicKey:a,address:c}}static getLockP2PKH(s){return new i.P2PKH().lock(s)}static getUnlockP2PKH(s,a){const c=new i.P2PKH,u=us.getLockP2PKH(us.getKeyPair(s).address);return c.unlock(s,"all",!1,a,u)}static createP2PKHOutputs(s){const a=[],c=s.length;for(let u=0;u<c;u++){const l=s[u];a.push({basket:l.basket,tags:l.tags,satoshis:l.satoshis,lockingScript:us.getLockP2PKH(l.address).toHex(),outputDescription:l.outputDescription||`p2pkh ${u}`})}return a}static async createP2PKHOutputsAction(s,a,c){const u=us.createP2PKHOutputs(a),l={description:"createP2PKHOutputs",outputs:u,options:{...c,randomizeOutputs:!1}},h=await s.createAction(l);let f;return h.txid&&(f=u.map((m,d)=>`${h.txid}.${d}`)),{cr:h,outpoints:f}}static async fundWalletFromP2PKHOutpoints(s,a,c,u){}static async createWalletIdb(s){const a=await us.createWallet(s),c=await us.createStorageIdb(s);await a.storage.addWalletStorageProvider(c);const{user:u,isNew:l}=await c.findOrInsertUser(a.identityKey),h=u.userId;return{...a,activeStorage:c,userId:h}}static async createStorageIdb(s){const a=new n.StorageIdb({chain:s.chain,commissionSatoshis:0,commissionPubKeyHex:void 0,feeModel:{model:"sat/kb",value:1}});return await a.migrate(s.databaseName,(0,e.randomBytesHex)(33)),await a.makeAvailable(),a}};return Xl.SetupClient=r,Xl}var Mb={},g3;function iL(){return g3||(g3=1,Object.defineProperty(Mb,"__esModule",{value:!0})),Mb}var yd={},b3;function rL(){if(b3)return yd;b3=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.WalletSigner=void 0;let i=class{constructor(n,r,t){this.isWalletSigner=!0,this.chain=n,this.keyDeriver=r,this.storage=t}};return yd.WalletSigner=i,yd}var gd={},m3;function aL(){if(m3)return gd;m3=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.WalletPermissionsManager=void 0;const i=Ye(),e=Jn();function n(a,c){if(a==null||c===null||c===void 0)return a===c;const u=Object.keys(a),l=Object.keys(c);if(u.length!==l.length)return!1;for(const h of u){const f=a[h],m=c[h],d=r(f)&&r(m);if(d&&!n(f,m)||!d&&f!==m)return!1}return!0}function r(a){return a!=null&&typeof a=="object"}const t={protocol:"admin protocol-permission",basket:"admin basket-access",certificate:"admin certificate-access",spending:"admin spending-authorization"};let s=class Or{constructor(c,u,l={}){this.callbacks={onProtocolPermissionRequested:[],onBasketAccessRequested:[],onCertificateAccessRequested:[],onSpendingAuthorizationRequested:[],onGroupedPermissionRequested:[]},this.activeRequests=new Map,this.permissionCache=new Map,this.underlying=c,this.adminOriginator=u,this.config={seekProtocolPermissionsForSigning:!0,seekProtocolPermissionsForEncrypting:!0,seekProtocolPermissionsForHMAC:!0,seekPermissionsForKeyLinkageRevelation:!0,seekPermissionsForPublicKeyRevelation:!0,seekPermissionsForIdentityKeyRevelation:!0,seekPermissionsForIdentityResolution:!0,seekBasketInsertionPermissions:!0,seekBasketRemovalPermissions:!0,seekBasketListingPermissions:!0,seekPermissionWhenApplyingActionLabels:!0,seekPermissionWhenListingActionsByLabel:!0,seekCertificateDisclosurePermissions:!0,seekCertificateAcquisitionPermissions:!0,seekCertificateRelinquishmentPermissions:!0,seekCertificateListingPermissions:!0,encryptWalletMetadata:!0,seekSpendingPermissions:!0,seekGroupedPermission:!0,differentiatePrivilegedOperations:!0,...l}}bindCallback(c,u){const l=this.callbacks[c];return l.push(u),l.length-1}unbindCallback(c,u){if(!this.callbacks[c])return!1;const l=this.callbacks[c];if(typeof u=="number")return l[u]?(l[u]=null,!0):!1;{const h=l.indexOf(u);return h!==-1?(l[h]=null,!0):!1}}async callEvent(c,u){const l=this.callbacks[c]||[];for(const h of l)if(typeof h=="function")try{await h(u)}catch{}}async grantPermission(c){const u=this.activeRequests.get(c.requestID);if(!u)throw new Error("Request ID not found.");for(const l of u.pending)l.resolve(!0);if(this.activeRequests.delete(c.requestID),!c.ephemeral){const l=u.request;l.renewal?await this.renewPermissionOnChain(l.previousToken,l,c.expiry||Math.floor(Date.now()/1e3)+3600*24*30,c.amount):await this.createPermissionOnChain(l,c.expiry||Math.floor(Date.now()/1e3)+3600*24*30,c.amount)}if(!c.ephemeral){const l=c.expiry||Math.floor(Date.now()/1e3)+2592e3,h=this.buildRequestKey(u.request);this.cachePermission(h,l)}}async denyPermission(c){const u=this.activeRequests.get(c);if(!u)throw new Error("Request ID not found.");for(const l of u.pending)l.reject(new Error("Permission denied."));this.activeRequests.delete(c)}async grantGroupedPermission(c){var u,l,h;const f=this.activeRequests.get(c.requestID);if(!f)throw new Error("Request ID not found.");const m=f.request,{originator:d,permissions:y}=m;if(c.granted.spendingAuthorization&&!n(c.granted.spendingAuthorization,y.spendingAuthorization))throw new Error("Granted spending authorization does not match the original request.");if(!((u=c.granted.protocolPermissions)===null||u===void 0)&&u.some(g=>{var v;return!(!((v=y.protocolPermissions)===null||v===void 0)&&v.find(_=>n(_,g)))}))throw new Error("Granted protocol permissions are not a subset of the original request.");if(!((l=c.granted.basketAccess)===null||l===void 0)&&l.some(g=>{var v;return!(!((v=y.basketAccess)===null||v===void 0)&&v.find(_=>n(_,g)))}))throw new Error("Granted basket access permissions are not a subset of the original request.");if(!((h=c.granted.certificateAccess)===null||h===void 0)&&h.some(g=>{var v;return!(!((v=y.certificateAccess)===null||v===void 0)&&v.find(_=>n(_,g)))}))throw new Error("Granted certificate access permissions are not a subset of the original request.");const b=c.expiry||Math.floor(Date.now()/1e3)+3600*24*30;c.granted.spendingAuthorization&&await this.createPermissionOnChain({type:"spending",originator:d,spending:{satoshis:c.granted.spendingAuthorization.amount},reason:c.granted.spendingAuthorization.description},0,c.granted.spendingAuthorization.amount);for(const g of c.granted.protocolPermissions||[])await this.createPermissionOnChain({type:"protocol",originator:d,privileged:!1,protocolID:g.protocolID,counterparty:g.counterparty||"self",reason:g.description},b);for(const g of c.granted.basketAccess||[])await this.createPermissionOnChain({type:"basket",originator:d,basket:g.basket,reason:g.description},b);for(const g of c.granted.certificateAccess||[])await this.createPermissionOnChain({type:"certificate",originator:d,privileged:!1,certificate:{verifier:g.verifierPublicKey,certType:g.type,fields:g.fields},reason:g.description},b);for(const g of f.pending)g.resolve(!0);this.activeRequests.delete(c.requestID)}async denyGroupedPermission(c){const u=this.activeRequests.get(c);if(!u)throw new Error("Request ID not found.");const l=new Error("The user has denied the request for permission.");l.code="ERR_PERMISSION_DENIED";for(const h of u.pending)h.reject(l);this.activeRequests.delete(c)}async ensureProtocolPermission({originator:c,privileged:u,protocolID:l,counterparty:h,reason:f,seekPermission:m=!0,usageType:d}){if(this.isAdminOriginator(c))return!0;const[y,b]=l;if(y===0)return!0;if(this.isAdminProtocol(l))throw new Error(`Protocol “${b}” is admin-only.`);if(d==="signing"&&!this.config.seekProtocolPermissionsForSigning||d==="encrypting"&&!this.config.seekProtocolPermissionsForEncrypting||d==="hmac"&&!this.config.seekProtocolPermissionsForHMAC||d==="publicKey"&&!this.config.seekPermissionsForPublicKeyRevelation||d==="identityKey"&&!this.config.seekPermissionsForIdentityKeyRevelation||d==="linkageRevelation"&&!this.config.seekPermissionsForKeyLinkageRevelation)return!0;this.config.differentiatePrivilegedOperations||(u=!1);const g=this.buildRequestKey({type:"protocol",originator:c,privileged:u,protocolID:l,counterparty:h});if(this.isPermissionCached(g))return!0;const v=await this.findProtocolToken(c,u,l,h,!0);if(v)if(this.isTokenExpired(v.expiry)){if(!m)throw new Error("Protocol permission expired and no further user consent allowed (seekPermission=false).");return await this.requestPermissionFlow({type:"protocol",originator:c,privileged:u,protocolID:l,counterparty:h,reason:f,renewal:!0,previousToken:v})}else return this.cachePermission(g,v.expiry),!0;else{if(!m)throw new Error("No protocol permission token found (seekPermission=false).");return await this.requestPermissionFlow({type:"protocol",originator:c,privileged:u,protocolID:l,counterparty:h,reason:f,renewal:!1})}}async ensureBasketAccess({originator:c,basket:u,reason:l,seekPermission:h=!0,usageType:f}){if(this.isAdminOriginator(c))return!0;if(this.isAdminBasket(u))throw new Error(`Basket “${u}” is admin-only.`);if(f==="insertion"&&!this.config.seekBasketInsertionPermissions||f==="removal"&&!this.config.seekBasketRemovalPermissions||f==="listing"&&!this.config.seekBasketListingPermissions)return!0;const m=this.buildRequestKey({type:"basket",originator:c,basket:u});if(this.isPermissionCached(m))return!0;const d=await this.findBasketToken(c,u,!0);if(d)if(this.isTokenExpired(d.expiry)){if(!h)throw new Error("Basket permission expired (seekPermission=false).");return await this.requestPermissionFlow({type:"basket",originator:c,basket:u,reason:l,renewal:!0,previousToken:d})}else return this.cachePermission(m,d.expiry),!0;else{if(!h)throw new Error("No basket permission found, and no user consent allowed (seekPermission=false).");return await this.requestPermissionFlow({type:"basket",originator:c,basket:u,reason:l,renewal:!1})}}async ensureCertificateAccess({originator:c,privileged:u,verifier:l,certType:h,fields:f,reason:m,seekPermission:d=!0,usageType:y}){if(this.isAdminOriginator(c)||y==="disclosure"&&!this.config.seekCertificateDisclosurePermissions)return!0;this.config.differentiatePrivilegedOperations||(u=!1);const b=this.buildRequestKey({type:"certificate",originator:c,privileged:u,certificate:{verifier:l,certType:h,fields:f}});if(this.isPermissionCached(b))return!0;const g=await this.findCertificateToken(c,u,l,h,f,!0);if(g)if(this.isTokenExpired(g.expiry)){if(!d)throw new Error("Certificate permission expired (seekPermission=false).");return await this.requestPermissionFlow({type:"certificate",originator:c,privileged:u,certificate:{verifier:l,certType:h,fields:f},reason:m,renewal:!0,previousToken:g})}else return this.cachePermission(b,g.expiry),!0;else{if(!d)throw new Error("No certificate permission found (seekPermission=false).");return await this.requestPermissionFlow({type:"certificate",originator:c,privileged:u,certificate:{verifier:l,certType:h,fields:f},reason:m,renewal:!1})}}async ensureSpendingAuthorization({originator:c,satoshis:u,lineItems:l,reason:h,seekPermission:f=!0}){if(this.isAdminOriginator(c)||!this.config.seekSpendingPermissions)return!0;const m=this.buildRequestKey({type:"spending",originator:c});if(this.isPermissionCached(m))return!0;const d=await this.findSpendingToken(c);if(d!=null&&d.authorizedAmount){if(await this.querySpentSince(d)+u<=d.authorizedAmount)return this.cachePermission(m,d.expiry),!0;if(!f)throw new Error(`Spending authorization insufficient for ${u}, no user consent (seekPermission=false).`);return await this.requestPermissionFlow({type:"spending",originator:c,spending:{satoshis:u,lineItems:l},reason:h,renewal:!0,previousToken:d})}else{if(!f)throw new Error("No spending authorization found, (seekPermission=false).");return await this.requestPermissionFlow({type:"spending",originator:c,spending:{satoshis:u,lineItems:l},reason:h,renewal:!1})}}async ensureLabelAccess({originator:c,label:u,reason:l,seekPermission:h=!0,usageType:f}){if(this.isAdminOriginator(c))return!0;if(this.isAdminLabel(u))throw new Error(`Label “${u}” is admin-only.`);if(f==="apply"&&!this.config.seekPermissionWhenApplyingActionLabels||f==="list"&&!this.config.seekPermissionWhenListingActionsByLabel)return!0;const m=this.buildRequestKey({type:"protocol",originator:c,privileged:!1,protocolID:[1,`action label ${u}`],counterparty:"self"});return this.isPermissionCached(m)?!0:await this.ensureProtocolPermission({originator:c,privileged:!1,protocolID:[1,`action label ${u}`],counterparty:"self",reason:l,seekPermission:h,usageType:"generic"})}async requestPermissionFlow(c){const u=this.buildRequestKey(c),l=this.activeRequests.get(u);return l&&l.pending.length>0?new Promise((h,f)=>{l.pending.push({resolve:h,reject:f})}):new Promise(async(h,f)=>{switch(this.activeRequests.set(u,{request:c,pending:[{resolve:h,reject:f}]}),c.type){case"protocol":await this.callEvent("onProtocolPermissionRequested",{...c,requestID:u});break;case"basket":await this.callEvent("onBasketAccessRequested",{...c,requestID:u});break;case"certificate":await this.callEvent("onCertificateAccessRequested",{...c,requestID:u});break;case"spending":await this.callEvent("onSpendingAuthorizationRequested",{...c,requestID:u});break}})}async encryptPermissionTokenField(c){const u=typeof c=="string"?i.Utils.toArray(c,"utf8"):c,{ciphertext:l}=await this.underlying.encrypt({plaintext:u,protocolID:Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return l}async decryptPermissionTokenField(c){try{const{plaintext:u}=await this.underlying.decrypt({ciphertext:c,protocolID:Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return u}catch{return c}}async maybeEncryptMetadata(c){if(!this.config.encryptWalletMetadata)return c;const{ciphertext:u}=await this.underlying.encrypt({plaintext:i.Utils.toArray(c,"utf8"),protocolID:Or.METADATA_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return i.Utils.toBase64(u)}async maybeDecryptMetadata(c){try{const{plaintext:u}=await this.underlying.decrypt({ciphertext:i.Utils.toArray(c,"base64"),protocolID:Or.METADATA_ENCRYPTION_PROTOCOL,keyID:"1"},this.adminOriginator);return i.Utils.toUTF8(u)}catch{return c}}isTokenExpired(c){const u=Math.floor(Date.now()/1e3);return c>0&&c<u}async findProtocolToken(c,u,l,h,f){const[m,d]=l,y=await this.underlying.listOutputs({basket:t.protocol,tags:[`originator ${c}`,`privileged ${!!u}`,`protocolName ${d}`,`protocolSecurityLevel ${m}`,`counterparty ${h}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const b of y.outputs){const[g,v]=b.outpoint.split("."),_=i.Transaction.fromBEEF(y.BEEF,g),S=i.PushDrop.decode(_.outputs[Number(v)].lockingScript);if(!S||!S.fields||S.fields.length<6)continue;const I=S.fields[0],A=S.fields[1],R=S.fields[2],E=S.fields[3],k=S.fields[4],P=S.fields[5],T=i.Utils.toUTF8(await this.decryptPermissionTokenField(I)),M=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(A)),10),C=i.Utils.toUTF8(await this.decryptPermissionTokenField(R))==="true",D=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(E)),10),F=i.Utils.toUTF8(await this.decryptPermissionTokenField(k)),B=i.Utils.toUTF8(await this.decryptPermissionTokenField(P));if(!(T!==c||C!==!!u||D!==m||F!==d||B!==h)&&!(!f&&this.isTokenExpired(M)))return{tx:_.toBEEF(),txid:b.outpoint.split(".")[0],outputIndex:parseInt(b.outpoint.split(".")[1],10),outputScript:_.outputs[Number(v)].lockingScript.toHex(),satoshis:b.satoshis,originator:c,privileged:u,protocol:d,securityLevel:m,expiry:M,counterparty:B}}}async findBasketToken(c,u,l){const h=await this.underlying.listOutputs({basket:t.basket,tags:[`originator ${c}`,`basket ${u}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const f of h.outputs){const[m,d]=f.outpoint.split("."),y=i.Transaction.fromBEEF(h.BEEF,m),b=i.PushDrop.decode(y.outputs[Number(d)].lockingScript);if(!(b!=null&&b.fields)||b.fields.length<3)continue;const g=b.fields[0],v=b.fields[1],_=b.fields[2],S=i.Utils.toUTF8(await this.decryptPermissionTokenField(g)),I=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(v)),10),A=i.Utils.toUTF8(await this.decryptPermissionTokenField(_));if(!(S!==c||A!==u)&&!(!l&&this.isTokenExpired(I)))return{tx:y.toBEEF(),txid:f.outpoint.split(".")[0],outputIndex:parseInt(f.outpoint.split(".")[1],10),outputScript:y.outputs[Number(d)].lockingScript.toHex(),satoshis:f.satoshis,originator:c,basketName:A,expiry:I}}}async findCertificateToken(c,u,l,h,f,m){const d=await this.underlying.listOutputs({basket:t.certificate,tags:[`originator ${c}`,`privileged ${!!u}`,`type ${h}`,`verifier ${l}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const y of d.outputs){const[b,g]=y.outpoint.split("."),v=i.Transaction.fromBEEF(d.BEEF,b),_=i.PushDrop.decode(v.outputs[Number(g)].lockingScript);if(!(_!=null&&_.fields)||_.fields.length<6)continue;const[S,I,A,R,E,k]=_.fields,P=i.Utils.toUTF8(await this.decryptPermissionTokenField(S)),T=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(I)),10),M=i.Utils.toUTF8(await this.decryptPermissionTokenField(A))==="true",C=i.Utils.toUTF8(await this.decryptPermissionTokenField(R)),D=i.Utils.toUTF8(await this.decryptPermissionTokenField(k)),F=await this.decryptPermissionTokenField(E),B=JSON.parse(i.Utils.toUTF8(F));if(P!==c||M!==!!u||C!==h||D!==l)continue;const L=new Set(B);if(!f.some(q=>!L.has(q))&&!(!m&&this.isTokenExpired(T)))return{tx:v.toBEEF(),txid:y.outpoint.split(".")[0],outputIndex:parseInt(y.outpoint.split(".")[1],10),outputScript:v.outputs[Number(g)].lockingScript.toHex(),satoshis:y.satoshis,originator:c,privileged:u,verifier:D,certType:C,certFields:B,expiry:T}}}async findSpendingToken(c){const u=await this.underlying.listOutputs({basket:t.spending,tags:[`originator ${c}`],tagQueryMode:"all",include:"entire transactions"},this.adminOriginator);for(const l of u.outputs){const[h,f]=l.outpoint.split("."),m=i.Transaction.fromBEEF(u.BEEF,h),d=i.PushDrop.decode(m.outputs[Number(f)].lockingScript);if(!(d!=null&&d.fields)||d.fields.length<2)continue;const y=d.fields[0],b=d.fields[1];if(i.Utils.toUTF8(await this.decryptPermissionTokenField(y))!==c)continue;const v=i.Utils.toUTF8(await this.decryptPermissionTokenField(b)),_=parseInt(v,10);return{tx:m.toBEEF(),txid:l.outpoint.split(".")[0],outputIndex:parseInt(l.outpoint.split(".")[1],10),outputScript:m.outputs[Number(f)].lockingScript.toHex(),satoshis:l.satoshis,originator:c,authorizedAmount:_,expiry:0}}}getCurrentMonthYearUTC(){const c=new Date,u=c.getUTCFullYear(),l=(c.getUTCMonth()+1).toString().padStart(2,"0");return`${u}-${l}`}async querySpentSince(c){const{actions:u}=await this.underlying.listActions({labels:[`admin originator ${c.originator}`,`admin month ${this.getCurrentMonthYearUTC()}`],labelQueryMode:"all"},this.adminOriginator);return u.reduce((l,h)=>l+h.satoshis,0)}async createPermissionOnChain(c,u,l){const h=t[c.type];if(!h)return;const f=await this.buildPushdropFields(c,u,l),m=await new i.PushDrop(this.underlying).lock(f,Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self",!0,!0),d=this.buildTagsForRequest(c);await this.createAction({description:`Grant ${c.type} permission`,outputs:[{lockingScript:m.toHex(),satoshis:1,outputDescription:`${c.type} permission token`,basket:h,tags:d}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator)}async renewPermissionOnChain(c,u,l,h){const f=await this.buildPushdropFields(u,l,h),m=await new i.PushDrop(this.underlying).lock(f,Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self",!0,!0),d=this.buildTagsForRequest(u),y=`${c.txid}.${c.outputIndex}`,{signableTransaction:b}=await this.createAction({description:`Renew ${u.type} permission`,inputBEEF:c.tx,inputs:[{outpoint:y,unlockingScriptLength:73,inputDescription:`Consume old ${u.type} token`}],outputs:[{lockingScript:m.toHex(),satoshis:1,outputDescription:`Renewed ${u.type} permission token`,basket:t[u.type],tags:d}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator),g=i.Transaction.fromBEEF(b.tx),_=await new i.PushDrop(this.underlying).unlock(Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self","all",!1,1,i.LockingScript.fromHex(c.outputScript)).sign(g,0);await this.underlying.signAction({reference:b.reference,spends:{0:{unlockingScript:_.toHex()}}})}async buildPushdropFields(c,u,l){var h;switch(c.type){case"protocol":{const[f,m]=c.protocolID;return[await this.encryptPermissionTokenField(c.originator),await this.encryptPermissionTokenField(String(u)),await this.encryptPermissionTokenField(c.privileged===!0?"true":"false"),await this.encryptPermissionTokenField(String(f)),await this.encryptPermissionTokenField(m),await this.encryptPermissionTokenField(c.counterparty)]}case"basket":return[await this.encryptPermissionTokenField(c.originator),await this.encryptPermissionTokenField(String(u)),await this.encryptPermissionTokenField(c.basket)];case"certificate":{const{certType:f,fields:m,verifier:d}=c.certificate;return[await this.encryptPermissionTokenField(c.originator),await this.encryptPermissionTokenField(String(u)),await this.encryptPermissionTokenField(c.privileged?"true":"false"),await this.encryptPermissionTokenField(f),await this.encryptPermissionTokenField(JSON.stringify(m)),await this.encryptPermissionTokenField(d)]}case"spending":{const f=l??(((h=c.spending)===null||h===void 0?void 0:h.satoshis)||0);return[await this.encryptPermissionTokenField(c.originator),await this.encryptPermissionTokenField(String(f))]}}}buildTagsForRequest(c){const u=[`originator ${c.originator}`];switch(c.type){case"protocol":{u.push(`privileged ${!!c.privileged}`),u.push(`protocolName ${c.protocolID[1]}`),u.push(`protocolSecurityLevel ${c.protocolID[0]}`),u.push(`counterparty ${c.counterparty}`);break}case"basket":{u.push(`basket ${c.basket}`);break}case"certificate":{u.push(`privileged ${!!c.privileged}`),u.push(`type ${c.certificate.certType}`),u.push(`verifier ${c.certificate.verifier}`);break}}return u}async listProtocolPermissions({originator:c,privileged:u,protocolName:l,protocolSecurityLevel:h,counterparty:f}={}){const m=t.protocol,d=[];c&&d.push(`originator ${c}`),u!==void 0&&d.push(`privileged ${!!u}`),l&&d.push(`protocolName ${l}`),h!==void 0&&d.push(`protocolSecurityLevel ${h}`),f&&d.push(`counterparty ${f}`);const y=await this.underlying.listOutputs({basket:m,tags:d,tagQueryMode:"all",include:"entire transactions",limit:100},this.adminOriginator),b=[];for(const g of y.outputs){const[v,_]=g.outpoint.split("."),S=i.Transaction.fromBEEF(y.BEEF,v),I=i.PushDrop.decode(S.outputs[Number(_)].lockingScript);if(!(I!=null&&I.fields)||I.fields.length<6)continue;const[A,R,E,k,P,T]=I.fields,M=i.Utils.toUTF8(await this.decryptPermissionTokenField(A)),C=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(R)),10),D=i.Utils.toUTF8(await this.decryptPermissionTokenField(E))==="true",F=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(k)),10),B=i.Utils.toUTF8(await this.decryptPermissionTokenField(P)),L=i.Utils.toUTF8(await this.decryptPermissionTokenField(T));b.push({tx:S.toBEEF(),txid:g.outpoint.split(".")[0],outputIndex:parseInt(g.outpoint.split(".")[1],10),outputScript:S.outputs[Number(_)].lockingScript.toHex(),satoshis:g.satoshis,originator:M,expiry:C,privileged:D,securityLevel:F,protocol:B,counterparty:L})}return b}async hasProtocolPermission(c){try{return await this.ensureProtocolPermission({...c,reason:"hasProtocolPermission",seekPermission:!1,usageType:"generic"}),!0}catch{return!1}}async listBasketAccess(c={}){const u=t.basket,l=[];c.originator&&l.push(`originator ${c.originator}`),c.basket&&l.push(`basket ${c.basket}`);const h=await this.underlying.listOutputs({basket:u,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),f=[];for(const m of h.outputs){const[d,y]=m.outpoint.split("."),b=i.Transaction.fromBEEF(h.BEEF,d),g=i.PushDrop.decode(b.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<3)continue;const[v,_,S]=g.fields,I=i.Utils.toUTF8(await this.decryptPermissionTokenField(v)),A=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(_)),10),R=i.Utils.toUTF8(await this.decryptPermissionTokenField(S));f.push({tx:b.toBEEF(),txid:m.outpoint.split(".")[0],outputIndex:parseInt(m.outpoint.split(".")[1],10),satoshis:m.satoshis,outputScript:b.outputs[Number(y)].lockingScript.toHex(),originator:I,basketName:R,expiry:A})}return f}async hasBasketAccess(c){try{return await this.ensureBasketAccess({originator:c.originator,basket:c.basket,seekPermission:!1,usageType:"insertion"}),!0}catch{return!1}}async listSpendingAuthorizations(c){const u=t.spending,l=[];c.originator&&l.push(`originator ${c.originator}`);const h=await this.underlying.listOutputs({basket:u,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),f=[];for(const m of h.outputs){const[d,y]=m.outpoint.split("."),b=i.Transaction.fromBEEF(h.BEEF,d),g=i.PushDrop.decode(b.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<2)continue;const[v,_]=g.fields,S=i.Utils.toUTF8(await this.decryptPermissionTokenField(v)),I=i.Utils.toUTF8(await this.decryptPermissionTokenField(_)),A=parseInt(I,10);f.push({tx:b.toBEEF(),txid:m.outpoint.split(".")[0],outputIndex:parseInt(m.outpoint.split(".")[1],10),satoshis:m.satoshis,outputScript:b.outputs[Number(y)].lockingScript.toHex(),originator:S,authorizedAmount:A,expiry:0})}return f}async hasSpendingAuthorization(c){try{return await this.ensureSpendingAuthorization({originator:c.originator,satoshis:c.satoshis,seekPermission:!1}),!0}catch{return!1}}async listCertificateAccess(c={}){const u=t.certificate,l=[];c.originator&&l.push(`originator ${c.originator}`),c.privileged!==void 0&&l.push(`privileged ${!!c.privileged}`),c.certType&&l.push(`type ${c.certType}`),c.verifier&&l.push(`verifier ${c.verifier}`);const h=await this.underlying.listOutputs({basket:u,tags:l,tagQueryMode:"all",include:"entire transactions",limit:1e4},this.adminOriginator),f=[];for(const m of h.outputs){const[d,y]=m.outpoint.split("."),b=i.Transaction.fromBEEF(h.BEEF,d),g=i.PushDrop.decode(b.outputs[Number(y)].lockingScript);if(!(g!=null&&g.fields)||g.fields.length<6)continue;const[v,_,S,I,A,R]=g.fields,E=i.Utils.toUTF8(await this.decryptPermissionTokenField(v)),k=parseInt(i.Utils.toUTF8(await this.decryptPermissionTokenField(_)),10),P=i.Utils.toUTF8(await this.decryptPermissionTokenField(S))==="true",T=i.Utils.toUTF8(await this.decryptPermissionTokenField(I)),M=i.Utils.toUTF8(await this.decryptPermissionTokenField(R)),C=await this.decryptPermissionTokenField(A),D=JSON.parse(i.Utils.toUTF8(C));f.push({tx:b.toBEEF(),txid:m.outpoint.split(".")[0],outputIndex:parseInt(m.outpoint.split(".")[1],10),satoshis:m.satoshis,outputScript:b.outputs[Number(y)].lockingScript.toHex(),originator:E,privileged:P,certType:T,certFields:D,verifier:M,expiry:k})}return f}async hasCertificateAccess(c){try{return await this.ensureCertificateAccess({originator:c.originator,privileged:c.privileged,verifier:c.verifier,certType:c.certType,fields:c.fields,seekPermission:!1,usageType:"disclosure"}),!0}catch{return!1}}async revokePermission(c){const u=`${c.txid}.${c.outputIndex}`,{signableTransaction:l}=await this.createAction({description:"Revoke permission",inputBEEF:c.tx,inputs:[{outpoint:u,unlockingScriptLength:73,inputDescription:"Consume old permission token"}],options:{acceptDelayedBroadcast:!1}},this.adminOriginator),h=i.Transaction.fromBEEF(l.tx),m=await new i.PushDrop(this.underlying).unlock(Or.PERM_TOKEN_ENCRYPTION_PROTOCOL,"1","self","all",!1,1,i.LockingScript.fromHex(c.outputScript)).sign(h,0);await this.underlying.signAction({reference:l.reference,spends:{0:{unlockingScript:m.toHex()}}})}async createAction(c,u){if(c.outputs)for(const R of c.outputs)R.basket&&await this.ensureBasketAccess({originator:u,basket:R.basket,reason:c.description,usageType:"insertion"});if(c.labels)for(const R of c.labels)await this.ensureLabelAccess({originator:u,label:R,reason:c.description,usageType:"apply"});const l={...c.options||{}};if(l.signAndProcess!==!0)l.signAndProcess=!1;else if(!this.isAdminOriginator(u))throw new Error("Only the admin originator can set signAndProcess=true explicitly.");const h=c.description,f={},m={};c.description=await this.maybeEncryptMetadata(c.description);for(let R=0;R<(c.inputs||[]).length;R++)c.inputs[R].inputDescription&&(f[R]=c.inputs[R].inputDescription,c.inputs[R].inputDescription=await this.maybeEncryptMetadata(c.inputs[R].inputDescription));for(let R=0;R<(c.outputs||[]).length;R++)c.outputs[R].outputDescription&&(m[R]=c.outputs[R].outputDescription,c.outputs[R].outputDescription=await this.maybeEncryptMetadata(c.outputs[R].outputDescription)),c.outputs[R].customInstructions&&(c.outputs[R].customInstructions=await this.maybeEncryptMetadata(c.outputs[R].customInstructions));const d=await this.underlying.createAction({...c,options:l,labels:[...c.labels||[],`admin originator ${u}`,`admin month ${this.getCurrentMonthYearUTC()}`]},u);if(!d.signableTransaction)return d;const y=i.Transaction.fromAtomicBEEF(d.signableTransaction.tx),b=d.signableTransaction.reference;let g=0;const v=[];let _=0;for(const R of y.inputs){const E=`${R.sourceTXID}.${R.sourceOutputIndex}`,k=(c.inputs||[]).findIndex(P=>P.outpoint===E);if(k!==-1){const P=R.sourceTransaction.outputs[R.sourceOutputIndex].satoshis;_+=P,v.push({type:"input",description:f[k]||"No input description provided",satoshis:P})}}const S=(c.outputs||[]).reduce((R,E)=>R+E.satoshis,0);for(const R in c.outputs||[]){const E=c.outputs[R];v.push({type:"output",satoshis:E.satoshis,description:m[R]||"No output description provided"})}if(v.push({type:"fee",satoshis:y.getFee(),description:"Network fee"}),g=S+y.getFee()-_,g>0)try{await this.ensureSpendingAuthorization({originator:u,satoshis:g,lineItems:v,reason:h})}catch(R){throw await this.underlying.abortAction({reference:b}),R}if((0,e.validateCreateActionArgs)(c).isSignAction)return d;const A=await this.underlying.signAction({reference:b,spends:{},options:c.options},u);return{...d,...A,signableTransaction:void 0}}async signAction(...c){return this.underlying.signAction(...c)}async abortAction(...c){return this.underlying.abortAction(...c)}async listActions(...c){const[u,l]=c;if(u.labels)for(const f of u.labels)await this.ensureLabelAccess({originator:l,label:f,reason:"listActions",usageType:"list"});const h=await this.underlying.listActions(...c);if(h.actions)for(let f=0;f<h.actions.length;f++){if(h.actions[f].description&&(h.actions[f].description=await this.maybeDecryptMetadata(h.actions[f].description)),h.actions[f].inputs)for(let m=0;m<h.actions[f].inputs.length;m++)h.actions[f].inputs[m].inputDescription&&(h.actions[f].inputs[m].inputDescription=await this.maybeDecryptMetadata(h.actions[f].inputs[m].inputDescription));if(h.actions[f].outputs)for(let m=0;m<h.actions[f].outputs.length;m++)h.actions[f].outputs[m].outputDescription&&(h.actions[f].outputs[m].outputDescription=await this.maybeDecryptMetadata(h.actions[f].outputs[m].outputDescription)),h.actions[f].outputs[m].customInstructions&&(h.actions[f].outputs[m].customInstructions=await this.maybeDecryptMetadata(h.actions[f].outputs[m].customInstructions))}return h}async internalizeAction(...c){const[u,l]=c;for(const h in u.outputs){const f=u.outputs[h];f.protocol==="basket insertion"&&(await this.ensureBasketAccess({originator:l,basket:f.insertionRemittance.basket,reason:u.description,usageType:"insertion"}),f.insertionRemittance.customInstructions&&(u.outputs[h].insertionRemittance.customInstructions=await this.maybeEncryptMetadata(f.insertionRemittance.customInstructions)))}return this.underlying.internalizeAction(...c)}async listOutputs(...c){const[u,l]=c;await this.ensureBasketAccess({originator:l,basket:u.basket,reason:"listOutputs",usageType:"listing"});const h=await this.underlying.listOutputs(...c);if(h.outputs)for(let f=0;f<h.outputs.length;f++)h.outputs[f].customInstructions&&(h.outputs[f].customInstructions=await this.maybeDecryptMetadata(h.outputs[f].customInstructions));return h}async relinquishOutput(...c){const[u,l]=c;return await this.ensureBasketAccess({originator:l,basket:u.basket,reason:"relinquishOutput",usageType:"removal"}),this.underlying.relinquishOutput(...c)}async getPublicKey(...c){const[u,l]=c;return u.protocolID&&await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"publicKey"}),u.identityKey&&await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:[1,"identity key retrieval"],counterparty:"self",reason:u.privilegedReason,usageType:"identityKey"}),this.underlying.getPublicKey(...c)}async revealCounterpartyKeyLinkage(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:[2,`counterparty key linkage revelation ${u.counterparty}`],counterparty:u.verifier,reason:u.privilegedReason,usageType:"linkageRevelation"}),this.underlying.revealCounterpartyKeyLinkage(...c)}async revealSpecificKeyLinkage(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:[2,`specific key linkage revelation ${u.protocolID[1]} ${u.protocolID[0]===2?u.keyID:"all"}`],counterparty:u.verifier,reason:u.privilegedReason,usageType:"linkageRevelation"}),this.underlying.revealSpecificKeyLinkage(...c)}async encrypt(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,protocolID:u.protocolID,privileged:u.privileged,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"encrypting"}),this.underlying.encrypt(...c)}async decrypt(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"encrypting"}),this.underlying.decrypt(...c)}async createHmac(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"hmac"}),this.underlying.createHmac(...c)}async verifyHmac(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"hmac"}),this.underlying.verifyHmac(...c)}async createSignature(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"signing"}),this.underlying.createSignature(...c)}async verifySignature(...c){const[u,l]=c;return await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:u.protocolID,counterparty:u.counterparty||"self",reason:u.privilegedReason,usageType:"signing"}),this.underlying.verifySignature(...c)}async acquireCertificate(...c){const[u,l]=c;return this.config.seekCertificateAcquisitionPermissions&&await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:[1,`certificate acquisition ${u.type}`],counterparty:"self",reason:u.privilegedReason,usageType:"generic"}),this.underlying.acquireCertificate(...c)}async listCertificates(...c){const[u,l]=c;return this.config.seekCertificateListingPermissions&&await this.ensureProtocolPermission({originator:l,privileged:u.privileged,protocolID:[1,"certificate list"],counterparty:"self",reason:u.privilegedReason,usageType:"generic"}),this.underlying.listCertificates(...c)}async proveCertificate(...c){const[u,l]=c;return await this.ensureCertificateAccess({originator:l,privileged:u.privileged,verifier:u.verifier,certType:u.certificate.type,fields:u.fieldsToReveal,reason:"proveCertificate",usageType:"disclosure"}),this.underlying.proveCertificate(...c)}async relinquishCertificate(...c){const[u,l]=c;return this.config.seekCertificateRelinquishmentPermissions&&await this.ensureProtocolPermission({originator:l,privileged:!!u.privileged,protocolID:[1,`certificate relinquishment ${u.type}`],counterparty:"self",reason:u.privilegedReason||"relinquishCertificate",usageType:"generic"}),this.underlying.relinquishCertificate(...c)}async discoverByIdentityKey(...c){const[u,l]=c;return this.config.seekPermissionsForIdentityResolution&&await this.ensureProtocolPermission({originator:l,privileged:!1,protocolID:[1,"identity resolution"],counterparty:"self",reason:"discoverByIdentityKey",usageType:"generic"}),this.underlying.discoverByIdentityKey(...c)}async discoverByAttributes(...c){const[u,l]=c;return this.config.seekPermissionsForIdentityResolution&&await this.ensureProtocolPermission({originator:l,privileged:!1,protocolID:[1,"identity resolution"],counterparty:"self",reason:"discoverByAttributes",usageType:"generic"}),this.underlying.discoverByAttributes(...c)}async isAuthenticated(...c){return this.underlying.isAuthenticated(...c)}async waitForAuthentication(...c){var u,l,h,f,m,d,y;const[b,g]=c;if(this.config.seekGroupedPermission&&g){let v;try{const _=g.startsWith("localhost:")?"http":"https",S=await fetch(`${_}://${g}/manifest.json`);if(S.ok){const I=await S.json();!((u=I==null?void 0:I.babbage)===null||u===void 0)&&u.groupPermissions&&(v=I.babbage.groupPermissions)}}catch{}if(v){const _={protocolPermissions:[],basketAccess:[],certificateAccess:[]};v.spendingAuthorization&&(await this.hasSpendingAuthorization({originator:g,satoshis:v.spendingAuthorization.amount})||(_.spendingAuthorization=v.spendingAuthorization));for(const I of v.protocolPermissions||[])await this.hasProtocolPermission({originator:g,privileged:!1,protocolID:I.protocolID,counterparty:I.counterparty||"self"})||_.protocolPermissions.push(I);for(const I of v.basketAccess||[])await this.hasBasketAccess({originator:g,basket:I.basket})||_.basketAccess.push(I);for(const I of v.certificateAccess||[])await this.hasCertificateAccess({originator:g,privileged:!1,verifier:I.verifierPublicKey,certType:I.type,fields:I.fields})||_.certificateAccess.push(I);if(_.spendingAuthorization||((h=(l=_.protocolPermissions)===null||l===void 0?void 0:l.length)!==null&&h!==void 0?h:0)>0||((m=(f=_.basketAccess)===null||f===void 0?void 0:f.length)!==null&&m!==void 0?m:0)>0||((y=(d=_.certificateAccess)===null||d===void 0?void 0:d.length)!==null&&y!==void 0?y:0)>0){const I=`group:${g}`;if(this.activeRequests.has(I))await new Promise((A,R)=>{this.activeRequests.get(I).pending.push({resolve:A,reject:R})});else try{await new Promise(async(A,R)=>{this.activeRequests.set(I,{request:{originator:g,permissions:_},pending:[{resolve:A,reject:R}]}),await this.callEvent("onGroupedPermissionRequested",{requestID:I,originator:g,permissions:_})})}catch(A){throw A}}}}return this.underlying.waitForAuthentication(...c)}async getHeight(...c){return this.underlying.getHeight(...c)}async getHeaderForHeight(...c){return this.underlying.getHeaderForHeight(...c)}async getNetwork(...c){return this.underlying.getNetwork(...c)}async getVersion(...c){return this.underlying.getVersion(...c)}isAdminOriginator(c){return c===this.adminOriginator}isAdminProtocol(c){const u=c[1];return!!(u.startsWith("admin")||u.startsWith("p "))}isAdminLabel(c){return!!c.startsWith("admin")}isAdminBasket(c){return!!(c==="default"||c.startsWith("admin")||c.startsWith("p "))}isPermissionCached(c){const u=this.permissionCache.get(c);return u?Date.now()-u.cachedAt>Or.CACHE_TTL_MS?(this.permissionCache.delete(c),!1):this.isTokenExpired(u.expiry)?(this.permissionCache.delete(c),!1):!0:!1}cachePermission(c,u){this.permissionCache.set(c,{expiry:u,cachedAt:Date.now()})}buildRequestKey(c){var u,l,h,f;switch(c.type){case"protocol":return`proto:${c.originator}:${!!c.privileged}:${(u=c.protocolID)===null||u===void 0?void 0:u.join(",")}:${c.counterparty}`;case"basket":return`basket:${c.originator}:${c.basket}`;case"certificate":return`cert:${c.originator}:${!!c.privileged}:${(l=c.certificate)===null||l===void 0?void 0:l.verifier}:${(h=c.certificate)===null||h===void 0?void 0:h.certType}:${(f=c.certificate)===null||f===void 0?void 0:f.fields.join("|")}`;case"spending":return`spend:${c.originator}`}}};return gd.WalletPermissionsManager=s,s.CACHE_TTL_MS=5*60*1e3,s.PERM_TOKEN_ENCRYPTION_PROTOCOL=[2,"admin permission token encryption"],s.METADATA_ENCRYPTION_PROTOCOL=[2,"admin metadata encryption"],gd}var Bb={},w3;function Ak(){return w3||(w3=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.CWIStyleWalletManager=i.OverlayUMPTokenInteractor=i.DEFAULT_PROFILE_ID=i.PBKDF2_NUM_ROUNDS=void 0;const e=Ye(),n=Pw();i.PBKDF2_NUM_ROUNDS=7777;async function r(a,c,u,l,h="sha512"){var f;const m=(f=globalThis==null?void 0:globalThis.crypto)===null||f===void 0?void 0:f.subtle;if(m)try{const d=await m.importKey("raw",new Uint8Array(a),{name:"PBKDF2"},!1,["deriveBits"]),y=await m.deriveBits({name:"PBKDF2",salt:new Uint8Array(c),iterations:u,hash:h.toUpperCase()},d,l*8);return Array.from(new Uint8Array(y))}catch(d){console.warn("[pbkdf2] WebCrypto path failed → falling back to JS implementation",d)}return e.Hash.pbkdf2(a,c,u,l,h)}i.DEFAULT_PROFILE_ID=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class t{constructor(c=new e.LookupResolver,u=new e.SHIPBroadcaster(["tm_users"])){this.resolver=c,this.broadcaster=u}async findByPresentationKeyHash(c){const u={service:"ls_users",query:{presentationHash:e.Utils.toHex(c)}},l=await this.resolver.query(u);return this.parseLookupAnswer(l)}async findByRecoveryKeyHash(c){const u={service:"ls_users",query:{recoveryHash:e.Utils.toHex(c)}},l=await this.resolver.query(u);return this.parseLookupAnswer(l)}async buildAndSend(c,u,l,h){const f=[];f[0]=l.passwordSalt,f[1]=l.passwordPresentationPrimary,f[2]=l.passwordRecoveryPrimary,f[3]=l.presentationRecoveryPrimary,f[4]=l.passwordPrimaryPrivileged,f[5]=l.presentationRecoveryPrivileged,f[6]=l.presentationHash,f[7]=l.recoveryHash,f[8]=l.presentationKeyEncrypted,f[9]=l.passwordKeyEncrypted,f[10]=l.recoveryKeyEncrypted,l.profilesEncrypted&&(f[11]=l.profilesEncrypted);const m=await new e.PushDrop(c,u).lock(f,[2,"admin user management token"],"1","self",!0,!0),d=[];let y;h!=null&&h.currentOutpoint&&(y=await this.findByOutpoint(h.currentOutpoint),y?d.push({outpoint:h.currentOutpoint,unlockingScriptLength:73,inputDescription:"Consume old UMP token"}):h=void 0);const b=[{lockingScript:m.toHex(),satoshis:1,outputDescription:"New UMP token output"}];let g;try{g=await c.createAction({description:h?"Renew UMP token (consume old, create new)":"Create new UMP token",inputs:d,outputs:b,inputBEEF:y==null?void 0:y.beef,options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1}},u)}catch(I){console.error("Error with UMP token update. Attempting a last-ditch effort to get a new one",I),g=await c.createAction({description:"Recover UMP token",outputs:b,options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1}},u)}if(!g.signableTransaction){const I=g.txid||(g.tx?e.Transaction.fromAtomicBEEF(g.tx).id("hex"):void 0);if(!I)throw new Error("No signableTransaction and no final TX found.");const A=e.Transaction.fromAtomicBEEF(g.tx),R=await this.broadcaster.broadcast(A);return console.log("BROADCAST RESULT",R),`${I}.0`}let v="";const _=g.signableTransaction.reference,S=e.Transaction.fromBEEF(g.signableTransaction.tx);if(h!=null&&h.currentOutpoint){const A=await new e.PushDrop(c,u).unlock([2,"admin user management token"],"1","self").sign(S,0),R=await c.signAction({reference:_,spends:{0:{unlockingScript:A.toHex()}}},u);if(v=R.txid||(R.tx?e.Transaction.fromAtomicBEEF(R.tx).id("hex"):""),!v)throw new Error("Could not finalize transaction for renewed UMP token.");const E=R.tx;if(!E)throw new Error("Final transaction data missing after signing renewed UMP token.");const k=e.Transaction.fromAtomicBEEF(E),P=await this.broadcaster.broadcast(k);return console.log("BROADCAST RESULT",P),`${v}.0`}else{const I=await c.signAction({reference:_,spends:{}},u);if(v=I.txid||(I.tx?e.Transaction.fromAtomicBEEF(I.tx).id("hex"):""),!v)throw new Error("Failed to finalize new UMP token transaction.");const A=I.tx;if(!A)throw new Error("Final transaction data missing after signing new UMP token.");const R=e.Transaction.fromAtomicBEEF(A),E=await this.broadcaster.broadcast(R);return console.log("BROADCAST RESULT",E),`${v}.0`}}parseLookupAnswer(c){var u;if(c.type!=="output-list"||!c.outputs||c.outputs.length===0)return;const{beef:l,outputIndex:h}=c.outputs[0];try{const f=e.Transaction.fromBEEF(l),m=`${f.id("hex")}.${h}`,d=e.PushDrop.decode(f.outputs[h].lockingScript);if(!d.fields||d.fields.length<11){console.warn(`Unexpected number of fields in UMP token: ${(u=d.fields)===null||u===void 0?void 0:u.length}`);return}return{passwordSalt:d.fields[0],passwordPresentationPrimary:d.fields[1],passwordRecoveryPrimary:d.fields[2],presentationRecoveryPrimary:d.fields[3],passwordPrimaryPrivileged:d.fields[4],presentationRecoveryPrivileged:d.fields[5],presentationHash:d.fields[6],recoveryHash:d.fields[7],presentationKeyEncrypted:d.fields[8],passwordKeyEncrypted:d.fields[9],recoveryKeyEncrypted:d.fields[10],profilesEncrypted:d.fields[12]?d.fields[11]:void 0,currentOutpoint:m}}catch(f){console.error("Failed to parse or decode UMP token:",f);return}}async findByOutpoint(c){const u=await this.resolver.query({service:"ls_users",query:{outpoint:c}});if(u.type==="output-list"&&!(!u.outputs||!u.outputs.length))return u.outputs[0]}}i.OverlayUMPTokenInteractor=t;class s{constructor(c,u,l=new t,h,f,m,d){this.authenticationMode="presentation-key-and-password",this.authenticationFlow="new-user",this.activeProfileId=i.DEFAULT_PROFILE_ID,this.profiles=[],this.adminOriginator=c,this.walletBuilder=u,this.UMPTokenInteractor=l,this.recoveryKeySaver=h,this.passwordRetriever=f,this.authenticated=!1,this.newWalletFunder=m,d&&this.loadSnapshot(d).catch(y=>{console.error("Failed to load snapshot during construction:",y),this.destroy()})}async providePresentationKey(c){if(this.authenticated)throw new Error("User is already authenticated");if(this.authenticationMode==="recovery-key-and-password")throw new Error("Presentation key is not needed in this mode");const u=e.Hash.sha256(c),l=await this.UMPTokenInteractor.findByPresentationKeyHash(u);l?(this.authenticationFlow="existing-user",this.presentationKey=c,this.currentUMPToken=l):(this.authenticationFlow="new-user",this.presentationKey=c)}async providePassword(c){if(this.authenticated)throw new Error("User is already authenticated");if(this.authenticationMode==="presentation-key-and-recovery-key")throw new Error("Password is not needed in this mode");if(this.authenticationFlow==="existing-user"){if(!this.currentUMPToken)throw new Error("Provide presentation or recovery key first.");const u=await r(e.Utils.toArray(c,"utf8"),this.currentUMPToken.passwordSalt,i.PBKDF2_NUM_ROUNDS,32,"sha512");let l,h;if(this.authenticationMode==="presentation-key-and-password"){if(!this.presentationKey)throw new Error("No presentation key found!");const f=this.XOR(this.presentationKey,u);l=new e.SymmetricKey(f).decrypt(this.currentUMPToken.passwordPresentationPrimary)}else{if(!this.recoveryKey)throw new Error("No recovery key found!");const f=this.XOR(this.recoveryKey,u);l=new e.SymmetricKey(f).decrypt(this.currentUMPToken.passwordRecoveryPrimary);const m=this.XOR(l,u);h=new e.SymmetricKey(m).decrypt(this.currentUMPToken.passwordPrimaryPrivileged)}await this.setupRootInfrastructure(l,h),await this.switchProfile(this.activeProfileId)}else{if(this.authenticationMode!=="presentation-key-and-password")throw new Error("New-user flow requires presentation key and password mode.");if(!this.presentationKey)throw new Error("No presentation key provided for new-user flow.");const u=(0,e.Random)(32);await this.recoveryKeySaver(u);const l=(0,e.Random)(32),h=await r(e.Utils.toArray(c,"utf8"),l,i.PBKDF2_NUM_ROUNDS,32,"sha512"),f=(0,e.Random)(32),m=(0,e.Random)(32),d=new e.SymmetricKey(this.XOR(this.presentationKey,h)),y=new e.SymmetricKey(this.XOR(this.presentationKey,u)),b=new e.SymmetricKey(this.XOR(u,h)),g=new e.SymmetricKey(this.XOR(f,h)),v=new n.PrivilegedKeyManager(async()=>new e.PrivateKey(m)),_={passwordSalt:l,passwordPresentationPrimary:d.encrypt(f),passwordRecoveryPrimary:b.encrypt(f),presentationRecoveryPrimary:y.encrypt(f),passwordPrimaryPrivileged:g.encrypt(m),presentationRecoveryPrivileged:y.encrypt(m),presentationHash:e.Hash.sha256(this.presentationKey),recoveryHash:e.Hash.sha256(u),presentationKeyEncrypted:(await v.encrypt({plaintext:this.presentationKey,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,passwordKeyEncrypted:(await v.encrypt({plaintext:h,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,recoveryKeyEncrypted:(await v.encrypt({plaintext:u,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,profilesEncrypted:void 0};if(this.currentUMPToken=_,await this.setupRootInfrastructure(f),await this.switchProfile(i.DEFAULT_PROFILE_ID),this.newWalletFunder&&this.underlying)try{await this.newWalletFunder(this.presentationKey,this.underlying,this.adminOriginator)}catch(S){console.error("Error funding new wallet:",S)}if(!this.underlying)throw new Error("Default profile wallet not built before attempting to publish UMP token.");this.currentUMPToken.currentOutpoint=await this.UMPTokenInteractor.buildAndSend(this.underlying,this.adminOriginator,_)}}async provideRecoveryKey(c){if(this.authenticated)throw new Error("Already authenticated");if(this.authenticationFlow==="new-user")throw new Error("Do not submit recovery key in new-user flow");if(this.authenticationMode==="presentation-key-and-password")throw new Error("No recovery key required in this mode");if(this.authenticationMode==="recovery-key-and-password"){const u=e.Hash.sha256(c),l=await this.UMPTokenInteractor.findByRecoveryKeyHash(u);if(!l)throw new Error("No user found with this recovery key");this.recoveryKey=c,this.currentUMPToken=l}else{if(!this.presentationKey)throw new Error("Provide the presentation key first");if(!this.currentUMPToken)throw new Error("Current UMP token not found");const u=this.XOR(this.presentationKey,c),l=new e.SymmetricKey(u).decrypt(this.currentUMPToken.presentationRecoveryPrimary),h=new e.SymmetricKey(u).decrypt(this.currentUMPToken.presentationRecoveryPrivileged);await this.setupRootInfrastructure(l,h),await this.switchProfile(this.activeProfileId)}}saveSnapshot(){if(!this.rootPrimaryKey||!this.currentUMPToken)throw new Error("No root primary key or current UMP token set");const c=(0,e.Random)(32),u=new e.Utils.Writer;if(u.write(this.rootPrimaryKey),!this.currentUMPToken.currentOutpoint)throw new Error("UMP token cannot be saved without a current outpoint.");const l=this.serializeUMPToken(this.currentUMPToken);u.writeVarIntNum(l.length),u.write(l);const h=u.toArray(),f=new e.SymmetricKey(c).encrypt(h),m=new e.Utils.Writer;return m.writeUInt8(2),m.write(c),m.write(this.activeProfileId),m.write(f),m.toArray()}async loadSnapshot(c){try{const u=new e.Utils.Reader(c),l=u.readUInt8();let h,f,m=i.DEFAULT_PROFILE_ID;if(l===1)h=u.read(32),f=u.read();else if(l===2)h=u.read(32),m=u.read(16),f=u.read();else throw new Error(`Unsupported snapshot version: ${l}`);const d=new e.SymmetricKey(h).decrypt(f),y=new e.Utils.Reader(d),b=y.read(32),g=y.readVarIntNum(),v=y.read(g),_=this.deserializeUMPToken(v);this.currentUMPToken=_,await this.setupRootInfrastructure(b),await this.switchProfile(m),this.authenticationFlow="existing-user"}catch(u){throw this.destroy(),new Error(`Failed to load snapshot: ${u.message}`)}}destroy(){this.underlying=void 0,this.rootPrivilegedKeyManager=void 0,this.authenticated=!1,this.rootPrimaryKey=void 0,this.currentUMPToken=void 0,this.presentationKey=void 0,this.recoveryKey=void 0,this.profiles=[],this.activeProfileId=i.DEFAULT_PROFILE_ID,this.authenticationMode="presentation-key-and-password",this.authenticationFlow="new-user"}listProfiles(){if(!this.authenticated)throw new Error("Not authenticated.");return[{id:i.DEFAULT_PROFILE_ID,name:"default",createdAt:null,active:this.activeProfileId.every(u=>u===0)},...this.profiles.map(u=>({id:u.id,name:u.name,createdAt:u.createdAt,active:this.activeProfileId.every((l,h)=>l===u.id[h])}))]}async addProfile(c){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Wallet not fully initialized or authenticated.");if(c==="default"||this.profiles.some(l=>l.name.toLowerCase()===c.toLowerCase()))throw new Error(`Profile name "${c}" is already in use.`);const u={name:c,id:(0,e.Random)(16),primaryPad:(0,e.Random)(32),privilegedPad:(0,e.Random)(32),createdAt:Math.floor(Date.now()/1e3)};return this.profiles.push(u),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,await this.getFactor("passwordKey"),await this.getFactor("presentationKey"),await this.getFactor("recoveryKey"),this.rootPrimaryKey,await this.getFactor("privilegedKey"),this.profiles),u.id}async deleteProfile(c){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Wallet not fully initialized or authenticated.");if(c.every(l=>l===0))throw new Error("Cannot delete the default profile.");const u=this.profiles.findIndex(l=>l.id.every((h,f)=>h===c[f]));if(u===-1)throw new Error("Profile not found.");this.profiles.splice(u,1),this.activeProfileId.every((l,h)=>l===c[h])&&await this.switchProfile(i.DEFAULT_PROFILE_ID),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,await this.getFactor("passwordKey"),await this.getFactor("presentationKey"),await this.getFactor("recoveryKey"),this.rootPrimaryKey,await this.getFactor("privilegedKey"),this.profiles)}async switchProfile(c){if(!this.authenticated||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Cannot switch profile: Wallet not authenticated or root keys missing.");let u,l;if(c.every(f=>f===0))u=this.rootPrimaryKey,l=void 0,this.activeProfileId=i.DEFAULT_PROFILE_ID;else{const f=this.profiles.find(m=>m.id.every((d,y)=>d===c[y]));if(!f)throw new Error("Profile not found.");u=this.XOR(this.rootPrimaryKey,f.primaryPad),l=f.privilegedPad,this.activeProfileId=c}const h=new n.PrivilegedKeyManager(async f=>{const d=(await this.rootPrivilegedKeyManager.getPrivilegedKey(f)).toArray(),y=l?this.XOR(d,l):d;return new e.PrivateKey(y)});this.underlying=await this.walletBuilder(u,h,this.activeProfileId)}async changePassword(c){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");const u=(0,e.Random)(32),l=await r(e.Utils.toArray(c,"utf8"),u,i.PBKDF2_NUM_ROUNDS,32,"sha512"),h=await this.getFactor("recoveryKey"),f=await this.getFactor("presentationKey"),m=await this.getFactor("privilegedKey");await this.updateAuthFactors(u,l,f,h,this.rootPrimaryKey,m,this.profiles)}async getRecoveryKey(){if(!this.authenticated||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");return this.getFactor("recoveryKey")}async changeRecoveryKey(){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");const c=await this.getFactor("passwordKey"),u=await this.getFactor("presentationKey"),l=await this.getFactor("privilegedKey"),h=(0,e.Random)(32);await this.recoveryKeySaver(h),await this.updateAuthFactors(this.currentUMPToken.passwordSalt,c,u,h,this.rootPrimaryKey,l,this.profiles)}async changePresentationKey(c){if(!this.authenticated||!this.currentUMPToken||!this.rootPrimaryKey||!this.rootPrivilegedKeyManager)throw new Error("Not authenticated or missing required data.");if(c.length!==32)throw new Error("Presentation key must be 32 bytes.");const u=await this.getFactor("recoveryKey"),l=await this.getFactor("passwordKey"),h=await this.getFactor("privilegedKey");await this.updateAuthFactors(this.currentUMPToken.passwordSalt,l,c,u,this.rootPrimaryKey,h,this.profiles),this.presentationKey&&(this.presentationKey=c)}XOR(c,u){if(c.length!==u.length)throw new Error(`XOR length mismatch: ${c.length} vs ${u.length}`);const l=new Array(c.length);for(let h=0;h<c.length;h++)l[h]=c[h]^u[h];return l}async getFactor(c){if(!this.authenticated||!this.currentUMPToken||!this.rootPrivilegedKeyManager)throw new Error(`Cannot get factor "${c}": Wallet not ready.`);const u=[2,"admin key wrapping"],l="1";try{switch(c){case"passwordKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.passwordKeyEncrypted,protocolID:u,keyID:l})).plaintext;case"presentationKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.presentationKeyEncrypted,protocolID:u,keyID:l})).plaintext;case"recoveryKey":return(await this.rootPrivilegedKeyManager.decrypt({ciphertext:this.currentUMPToken.recoveryKeyEncrypted,protocolID:u,keyID:l})).plaintext;case"privilegedKey":return(await this.rootPrivilegedKeyManager.getPrivilegedKey("UMP token update",!0)).toArray();default:throw new Error(`Unknown factor name: ${c}`)}}catch(h){throw console.error(`Error decrypting factor ${c}:`,h),new Error(`Failed to decrypt factor "${c}": ${h.message}`)}}async updateAuthFactors(c,u,l,h,f,m,d){if(!this.authenticated||!this.rootPrimaryKey||!this.currentUMPToken)throw new Error("Wallet is not properly authenticated or missing data for update.");const y={...this.currentUMPToken};if(!y.currentOutpoint)throw new Error("Cannot update UMP token: Old token has no outpoint.");const b=new e.SymmetricKey(this.XOR(l,u)),g=new e.SymmetricKey(this.XOR(l,h)),v=new e.SymmetricKey(this.XOR(h,u)),_=new e.SymmetricKey(this.XOR(f,u)),S=new n.PrivilegedKeyManager(async()=>new e.PrivateKey(m));let I;if(d&&d.length>0){const k=JSON.stringify(d),P=e.Utils.toArray(k,"utf8");I=new e.SymmetricKey(f).encrypt(P)}const A={passwordSalt:c,passwordPresentationPrimary:b.encrypt(f),passwordRecoveryPrimary:v.encrypt(f),presentationRecoveryPrimary:g.encrypt(f),passwordPrimaryPrivileged:_.encrypt(m),presentationRecoveryPrivileged:g.encrypt(m),presentationHash:e.Hash.sha256(l),recoveryHash:e.Hash.sha256(h),presentationKeyEncrypted:(await S.encrypt({plaintext:l,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,passwordKeyEncrypted:(await S.encrypt({plaintext:u,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,recoveryKeyEncrypted:(await S.encrypt({plaintext:h,protocolID:[2,"admin key wrapping"],keyID:"1"})).ciphertext,profilesEncrypted:I},R=this.activeProfileId;let E=this.underlying;if(R.every(k=>k===0)||(console.log("Temporarily switching to default profile to update UMP token..."),await this.switchProfile(i.DEFAULT_PROFILE_ID),E=this.underlying),!E)throw new Error("Default profile wallet could not be activated for UMP token update.");try{A.currentOutpoint=await this.UMPTokenInteractor.buildAndSend(E,this.adminOriginator,A,y),this.currentUMPToken=A}finally{R.every(k=>k===0)||(console.log("Switching back to original profile..."),await this.switchProfile(R))}}serializeUMPToken(c){if(!c.currentOutpoint)throw new Error("Token must have outpoint for serialization");const u=new e.Utils.Writer;u.writeUInt8(2);const l=f=>{u.writeVarIntNum(f.length),u.write(f)};l(c.passwordSalt),l(c.passwordPresentationPrimary),l(c.passwordRecoveryPrimary),l(c.presentationRecoveryPrimary),l(c.passwordPrimaryPrivileged),l(c.presentationRecoveryPrivileged),l(c.presentationHash),l(c.recoveryHash),l(c.presentationKeyEncrypted),l(c.passwordKeyEncrypted),l(c.recoveryKeyEncrypted),c.profilesEncrypted&&c.profilesEncrypted.length>0?(u.writeUInt8(1),l(c.profilesEncrypted)):u.writeUInt8(0);const h=e.Utils.toArray(c.currentOutpoint,"utf8");return u.writeVarIntNum(h.length),u.write(h),u.toArray()}deserializeUMPToken(c){const u=new e.Utils.Reader(c),l=u.readUInt8();if(l!==1&&l!==2)throw new Error(`Unsupported UMP token serialization version: ${l}`);const h=()=>{const M=u.readVarIntNum();return u.read(M)},f=h(),m=h(),d=h(),y=h(),b=h(),g=h(),v=h(),_=h(),S=h(),I=h(),A=h();let R;l===2&&u.readUInt8()===1&&(R=h());const E=u.readVarIntNum(),k=u.read(E),P=e.Utils.toUTF8(k);return{passwordSalt:f,passwordPresentationPrimary:m,passwordRecoveryPrimary:d,presentationRecoveryPrimary:y,passwordPrimaryPrivileged:b,presentationRecoveryPrivileged:g,presentationHash:v,recoveryHash:_,presentationKeyEncrypted:S,passwordKeyEncrypted:I,recoveryKeyEncrypted:A,profilesEncrypted:R,currentOutpoint:P}}async setupRootInfrastructure(c,u){if(!this.currentUMPToken)throw new Error("A UMP token must exist before setting up root infrastructure!");this.rootPrimaryKey=c;let l=u?new e.PrivateKey(u):void 0;if(this.rootPrivilegedKeyManager=new n.PrivilegedKeyManager(async h=>{if(l){const b=l;return l=void 0,b}const f=await this.passwordRetriever(h,b=>{try{const g=e.Hash.pbkdf2(e.Utils.toArray(b,"utf8"),this.currentUMPToken.passwordSalt,i.PBKDF2_NUM_ROUNDS,32,"sha512"),v=this.XOR(this.rootPrimaryKey,g);return!!new e.SymmetricKey(v).decrypt(this.currentUMPToken.passwordPrimaryPrivileged)}catch{return!1}}),m=await r(e.Utils.toArray(f,"utf8"),this.currentUMPToken.passwordSalt,i.PBKDF2_NUM_ROUNDS,32,"sha512"),d=this.XOR(this.rootPrimaryKey,m),y=new e.SymmetricKey(d).decrypt(this.currentUMPToken.passwordPrimaryPrivileged);return new e.PrivateKey(y)}),this.profiles=[],this.currentUMPToken.profilesEncrypted&&this.currentUMPToken.profilesEncrypted.length>0)try{const h=new e.SymmetricKey(c).decrypt(this.currentUMPToken.profilesEncrypted),f=e.Utils.toUTF8(h);this.profiles=JSON.parse(f)}catch(h){throw console.error("Failed to decrypt or parse profiles:",h),this.profiles=[],new Error(`Failed to load profiles: ${h.message}`)}this.authenticated=!0}checkAuthAndUnderlying(c){if(!this.authenticated)throw new Error("User is not authenticated.");if(!this.underlying)throw new Error("Underlying wallet for the active profile is not initialized.");if(c===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.")}async getPublicKey(c,u){return this.checkAuthAndUnderlying(u),this.underlying.getPublicKey(c,u)}async revealCounterpartyKeyLinkage(c,u){return this.checkAuthAndUnderlying(u),this.underlying.revealCounterpartyKeyLinkage(c,u)}async revealSpecificKeyLinkage(c,u){return this.checkAuthAndUnderlying(u),this.underlying.revealSpecificKeyLinkage(c,u)}async encrypt(c,u){return this.checkAuthAndUnderlying(u),this.underlying.encrypt(c,u)}async decrypt(c,u){return this.checkAuthAndUnderlying(u),this.underlying.decrypt(c,u)}async createHmac(c,u){return this.checkAuthAndUnderlying(u),this.underlying.createHmac(c,u)}async verifyHmac(c,u){return this.checkAuthAndUnderlying(u),this.underlying.verifyHmac(c,u)}async createSignature(c,u){return this.checkAuthAndUnderlying(u),this.underlying.createSignature(c,u)}async verifySignature(c,u){return this.checkAuthAndUnderlying(u),this.underlying.verifySignature(c,u)}async createAction(c,u){return this.checkAuthAndUnderlying(u),this.underlying.createAction(c,u)}async signAction(c,u){return this.checkAuthAndUnderlying(u),this.underlying.signAction(c,u)}async abortAction(c,u){return this.checkAuthAndUnderlying(u),this.underlying.abortAction(c,u)}async listActions(c,u){return this.checkAuthAndUnderlying(u),this.underlying.listActions(c,u)}async internalizeAction(c,u){return this.checkAuthAndUnderlying(u),this.underlying.internalizeAction(c,u)}async listOutputs(c,u){return this.checkAuthAndUnderlying(u),this.underlying.listOutputs(c,u)}async relinquishOutput(c,u){return this.checkAuthAndUnderlying(u),this.underlying.relinquishOutput(c,u)}async acquireCertificate(c,u){return this.checkAuthAndUnderlying(u),this.underlying.acquireCertificate(c,u)}async listCertificates(c,u){return this.checkAuthAndUnderlying(u),this.underlying.listCertificates(c,u)}async proveCertificate(c,u){return this.checkAuthAndUnderlying(u),this.underlying.proveCertificate(c,u)}async relinquishCertificate(c,u){return this.checkAuthAndUnderlying(u),this.underlying.relinquishCertificate(c,u)}async discoverByIdentityKey(c,u){return this.checkAuthAndUnderlying(u),this.underlying.discoverByIdentityKey(c,u)}async discoverByAttributes(c,u){return this.checkAuthAndUnderlying(u),this.underlying.discoverByAttributes(c,u)}async isAuthenticated(c,u){if(!this.authenticated)throw new Error("User is not authenticated.");if(u===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.");return{authenticated:!0}}async waitForAuthentication(c,u){if(u===this.adminOriginator)throw new Error("External applications are not allowed to use the admin originator.");for(;!this.authenticated||!this.underlying;)await new Promise(l=>setTimeout(l,100));return await this.underlying.waitForAuthentication({},u)}async getHeight(c,u){return this.checkAuthAndUnderlying(u),this.underlying.getHeight({},u)}async getHeaderForHeight(c,u){return this.checkAuthAndUnderlying(u),this.underlying.getHeaderForHeight(c,u)}async getNetwork(c,u){return this.checkAuthAndUnderlying(u),this.underlying.getNetwork({},u)}async getVersion(c,u){return this.checkAuthAndUnderlying(u),this.underlying.getVersion({},u)}}i.CWIStyleWalletManager=s}(Bb)),Bb}var bd={},v3;function sL(){if(v3)return bd;v3=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.WalletAuthenticationManager=void 0;const i=Ak(),e=Ye();let n=class extends i.CWIStyleWalletManager{constructor(t,s,a=new i.OverlayUMPTokenInteractor,c,u,l,h,f){super(t,s,a,c,u,async(m,d,y)=>{debugger;const{paymentData:b}=await this.wabClient.requestFaucet(e.Utils.toHex(m));if(!b.k||!b.tx)throw new Error("Invalid");const g=e.Transaction.fromAtomicBEEF(b.tx);console.log(b);const v=await d.createAction({inputBEEF:g.toBEEF(),inputs:[{outpoint:`${b.txid}.0`,unlockingScriptLength:108,inputDescription:"Fund from faucet"}],description:"Fund wallet",options:{acceptDelayedBroadcast:!1}},y),_=e.Transaction.fromAtomicBEEF(v.signableTransaction.tx),S=new e.RPuzzle,I=e.PrivateKey.fromRandom(),R=await S.unlock(new e.BigNumber(b.k,16),I).sign(_,0),E=await d.signAction({reference:v.signableTransaction.reference,spends:{0:{unlockingScript:R.toHex()}}});console.log("Sign action result:",E)},f),this.wabClient=l,this.authMethod=h}setAuthMethod(t){this.authMethod=t}async startAuth(t){if(!this.authMethod)throw new Error("No AuthMethod selected in WalletAuthenticationManager");this.tempPresentationKey=this.generateTemporaryPresentationKey();const s=await this.wabClient.startAuthMethod(this.authMethod,this.tempPresentationKey,t);if(!s.success)throw new Error(s.message||"Failed to start WAB auth method")}async completeAuth(t){if(!this.authMethod||!this.tempPresentationKey)throw new Error("No AuthMethod selected in WalletAuthenticationManager or startAuth has yet to be called.");const s=this.tempPresentationKey;this.tempPresentationKey=void 0;const a=await this.wabClient.completeAuthMethod(this.authMethod,s,t);if(!a.success||!a.presentationKey)throw new Error(a.message||"Failed to complete WAB auth");const c=a.presentationKey,u=e.Utils.toArray(c,"hex");await this.providePresentationKey(u)}generateTemporaryPresentationKey(){const t=(0,e.Random)(32);return e.Utils.toHex(t)}};return bd.WalletAuthenticationManager=n,bd}var md={},x3;function oL(){if(x3)return md;x3=1,Object.defineProperty(md,"__esModule",{value:!0}),md.WABClient=void 0;const i=Ye();let e=class{constructor(r){this.serverUrl=r}async getInfo(){return(await fetch(`${this.serverUrl}/info`)).json()}generateRandomPresentationKey(){return i.PrivateKey.fromRandom().toHex()}async startAuthMethod(r,t,s){return r.startAuth(this.serverUrl,t,s)}async completeAuthMethod(r,t,s){return r.completeAuth(this.serverUrl,t,s)}async listLinkedMethods(r){return(await fetch(`${this.serverUrl}/user/linkedMethods`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:r})})).json()}async unlinkMethod(r,t){return(await fetch(`${this.serverUrl}/user/unlinkMethod`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:r,authMethodId:t})})).json()}async requestFaucet(r){return(await fetch(`${this.serverUrl}/faucet/request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:r})})).json()}async deleteUser(r){return(await fetch(`${this.serverUrl}/user/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationKey:r})})).json()}};return md.WABClient=e,md}var wd={},vd={},_3;function Cw(){if(_3)return vd;_3=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.AuthMethodInteractor=void 0;let i=class{};return vd.AuthMethodInteractor=i,vd}var S3;function cL(){if(S3)return wd;S3=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.TwilioPhoneInteractor=void 0;const i=Cw();let e=class extends i.AuthMethodInteractor{constructor(){super(...arguments),this.methodType="TwilioPhone"}async startAuth(r,t,s){const a=await fetch(`${r}/auth/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:t,payload:s})});return a.ok?a.json():{success:!1,message:`HTTP error ${a.status}`}}async completeAuth(r,t,s){const a=await fetch(`${r}/auth/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:t,payload:s})});return a.ok?a.json():{success:!1,message:`HTTP error ${a.status}`}}};return wd.TwilioPhoneInteractor=e,wd}var xd={},I3;function uL(){if(I3)return xd;I3=1,Object.defineProperty(xd,"__esModule",{value:!0}),xd.PersonaIDInteractor=void 0;const i=Cw();let e=class extends i.AuthMethodInteractor{constructor(){super(...arguments),this.methodType="PersonaID"}async startAuth(r,t,s){return(await fetch(`${r}/auth/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:t,payload:s})})).json()}async completeAuth(r,t,s){return(await fetch(`${r}/auth/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({methodType:this.methodType,presentationKey:t,payload:s})})).json()}};return xd.PersonaIDInteractor=e,xd}var so={},_d={},T3;function lL(){if(T3)return _d;T3=1,Object.defineProperty(_d,"__esModule",{value:!0}),_d.ServiceCollection=void 0;const i=32;let e=class Pk{constructor(r,t){this.serviceName=r,this._historyByProvider={},this.services=t||[],this._index=0,this.since=new Date}add(r){return this.services.push(r),this}remove(r){this.services=this.services.filter(t=>t.name!==r)}get name(){return this.services[this._index].name}get service(){return this.services[this._index].service}getServiceToCall(r){const t=this.services[r].name,s=this.services[r].service,a={name:t,when:new Date,msecs:0,success:!1,result:void 0,error:void 0};return{serviceName:this.serviceName,providerName:t,service:s,call:a}}get serviceToCall(){return this.getServiceToCall(this._index)}get allServicesToCall(){const r=[];for(let t=0;t<this.services.length;t++)r.push(this.getServiceToCall(t));return r}moveServiceToLast(r){const t=this.services.findIndex(s=>s.name===r.providerName);if(t!==-1){const[s]=this.services.splice(t,1);this.services.push(s)}}get allServices(){return this.services.map(r=>r.service)}get count(){return this.services.length}get index(){return this._index}reset(){this._index=0}next(){return this._index=(this._index+1)%this.count,this._index}clone(){return new Pk(this.serviceName,[...this.services])}_addServiceCall(r,t){const s=new Date;let a=this._historyByProvider[r];return a||(a={serviceName:this.serviceName,providerName:r,calls:[],totalCounts:{success:0,failure:0,error:0,since:this.since,until:s},resetCounts:[{success:0,failure:0,error:0,since:this.since,until:s}]},this._historyByProvider[r]=a),a.calls.unshift(t),a.calls=a.calls.slice(0,i),a.totalCounts.until=s,a.resetCounts[0].until=s,a}getDuration(r){const t=new Date;return typeof r=="string"&&(r=new Date(r)),t.getTime()-r.getTime()}addServiceCallSuccess(r,t){const s=r.call;s.success=!0,s.result=t,s.error=void 0,s.msecs=this.getDuration(s.when);const a=this._addServiceCall(r.providerName,s);a.totalCounts.success++,a.resetCounts[0].success++}addServiceCallFailure(r,t){const s=r.call;s.success=!1,s.result=t,s.error=void 0,s.msecs=this.getDuration(s.when);const a=this._addServiceCall(this.name,s);a.totalCounts.failure++,a.resetCounts[0].failure++}addServiceCallError(r,t){const s=r.call;s.success=!1,s.result=void 0,s.error=t,s.msecs=this.getDuration(s.when);const a=this._addServiceCall(this.name,s);a.totalCounts.failure++,a.totalCounts.error++,a.resetCounts[0].failure++,a.resetCounts[0].error++}getServiceCallHistory(r){const t=new Date,s={serviceName:this.serviceName,historyByProvider:{}};for(const c of Object.keys(this._historyByProvider)){const u=this._historyByProvider[c],l={serviceName:u.serviceName,providerName:u.providerName,calls:u.calls.map(h=>({when:a(h.when),msecs:h.msecs,success:h.success,result:h.result,error:h.error?{message:h.error.message,code:h.error.code}:void 0})),totalCounts:{success:u.totalCounts.success,failure:u.totalCounts.failure,error:u.totalCounts.error,since:a(u.totalCounts.since),until:a(u.totalCounts.until)},resetCounts:[]};for(let h=0;h<u.resetCounts.length;h++){const f=u.resetCounts[h];l.resetCounts.push({success:f.success,failure:f.failure,error:f.error,since:a(f.since),until:a(f.until)})}s.historyByProvider[c]=l,r&&(u.resetCounts[0].until=t,u.resetCounts.unshift({success:0,failure:0,error:0,since:t,until:t}),u.resetCounts=u.resetCounts.slice(0,i))}return s;function a(c){return typeof c=="string"?c:c.toISOString()}}};return _d.ServiceCollection=e,_d}var zc={},oo={},co={},Sd={},k3;function Mw(){if(k3)return Sd;k3=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.ChaintracksServiceClient=void 0;const i=Ke();let e=class Rk{static createChaintracksServiceClientOptions(){return{useAuthrite:!1}}constructor(r,t,s){this.chain=r,this.serviceUrl=t,this.options=s||Rk.createChaintracksServiceClientOptions()}async currentHeight(){return await this.getPresentHeight()}async isValidRootForHeight(r,t){const s=await this.findHeaderForHeight(t);return s?r===(0,i.asString)(s.merkleRoot):!1}async getJsonOrUndefined(r){let t;for(let s=0;s<3;s++){try{const c=await(await fetch(`${this.serviceUrl}${r}`)).json();if(c.status==="success")return c.value;t=new Error(JSON.stringify(c))}catch(a){t=a}if(t&&t.name!=="ECONNRESET")break}if(t)throw t}async getJson(r){const t=await this.getJsonOrUndefined(r);if(t===void 0)throw new Error("Value was undefined. Requested object may not exist.");return t}async postJsonVoid(r,t){const s={};s["Content-Type"]="application/json";const a=await fetch(`${this.serviceUrl}${r}`,{body:JSON.stringify(t),method:"POST",headers:s});try{const c=await a.json();if(c.status==="success")return;throw new Error(JSON.stringify(c))}catch(c){throw console.log(`Exception: ${JSON.stringify(c)}`),new Error(JSON.stringify(c))}}async addHeader(r){const t=await this.postJsonVoid("/addHeaderHex",r);if(typeof t=="string")throw new Error(t)}async startListening(){return await this.getJsonOrUndefined("/startListening")}async listening(){return await this.getJsonOrUndefined("/listening")}async getChain(){return this.chain}async isListening(){return await this.getJson("/isListening")}async isSynchronized(){return await this.getJson("/isSynchronized")}async getPresentHeight(){return await this.getJson("/getPresentHeight")}async findChainTipHeader(){return await this.getJson("/findChainTipHeaderHex")}async findChainTipHashHex(){return await this.getJson("/findChainTipHashHex")}async getHeaders(r,t){return await this.getJson(`/getHeaders?height=${r}&count=${t}`)}async findHeaderForHeight(r){return await this.getJsonOrUndefined(`/findHeaderHexForHeight?height=${r}`)}async findChainWorkForBlockHash(r){return await this.getJsonOrUndefined(`/findChainWorkHexForBlockHash?hash=${(0,i.asString)(r)}`)}async findHeaderForBlockHash(r){return await this.getJsonOrUndefined(`/findHeaderHexForBlockHash?hash=${(0,i.asString)(r)}`)}async findHeaderForMerkleRoot(r,t){return await this.getJsonOrUndefined(`/findHeaderHexForMerkleRoot?root=${(0,i.asString)(r)}&height=${t}`)}};return Sd.ChaintracksServiceClient=e,Sd}var uo={},E3;function dL(){if(E3)return uo;E3=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.isLive=i,uo.isBaseBlockHeader=e,uo.isBlockHeader=n,uo.isLiveBlockHeader=r;function i(t){return t.headerId!==void 0}function e(t){return typeof t.previousHash=="string"}function n(t){return"height"in t&&typeof t.previousHash=="string"}function r(t){return"chainwork"in t&&typeof t.previousHash=="string"}return uo}var O3;function fL(){return O3||(O3=1,function(i){var e=co&&co.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=co&&co.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(Mw(),i),n(dL(),i)}(co)),co}var Id={},A3;function hL(){if(A3)return Id;A3=1,Object.defineProperty(Id,"__esModule",{value:!0}),Id.ChaintracksChainTracker=void 0;const i=Ke(),e=Mw();let n=class{constructor(t,s,a){t||(t="main"),this.chaintracks=s??new e.ChaintracksServiceClient(t,`https://npm-registry.babbage.systems:808${t==="main"?"4":"3"}`),this.cache={},this.options=a||{}}async currentHeight(){return await this.chaintracks.getPresentHeight()}async isValidRootForHeight(t,s){const a=this.cache[s];if(a)return a===t;let c;const u=this.options.maxRetries||3;let l;for(let h=1;h<=u;h++)try{if(c=await this.chaintracks.findHeaderForHeight(s),!c)return!1;break}catch(f){if(l=i.sdk.WalletError.fromUnknown(f),h>u)throw l;await(0,i.wait)(1e3)}if(!c)throw new i.sdk.WERR_INTERNAL("no header should have returned false or thrown an error.");return this.cache[s]=c.merkleRoot,c.merkleRoot===t}};return Id.ChaintracksChainTracker=n,Id}var Td={},Ct={},Db={},P3;function pL(){return P3||(P3=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.dirtyHashes=void 0,i.validateAgainstDirtyHashes=e,i.dirtyHashes={"00000000000000000019f112ec0a9982926f1258cdcc558dd7c3b7e5dc7fa148":"This is the first header of the invalid SegWit chain.","0000000000000000004626ff6e3b936941d341c5932ece4357eeccac44e6d56c":"This is the first header of the invalid ABC chain."};function e(n){if(i.dirtyHashes[n])throw new Error(`Not adding a header with a dirty hash: ${i.dirtyHashes[n]}`)}}(Db)),Db}var Gc={},R3;function yL(){if(R3)return Gc;R3=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.asBuffer=i,Gc.asString=e,Gc.asArray=n;function i(r,t){let s;return Buffer.isBuffer(r)?s=r:typeof r=="string"?s=Buffer.from(r,t??"hex"):s=Buffer.from(r),s}function e(r,t){return Array.isArray(r)&&(r=Buffer.from(r)),Buffer.isBuffer(r)?r.toString(t??"hex"):r}function n(r,t){let s;return Array.isArray(r)?s=r:Buffer.isBuffer(r)?s=Array.from(r):s=Array.from(Buffer.from(r,t||"hex")),s}return Gc}var N3;function gL(){if(N3)return Ct;N3=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.validateBufferOfHeaders=t,Ct.workBNtoBuffer=s,Ct.isMoreWork=a,Ct.addWork=c,Ct.subWork=u,Ct.convertBitsToTarget=l,Ct.convertBitsToWork=h,Ct.deserializeBaseBlockHeaders=f,Ct.deserializeBlockHeaders=m,Ct.extractHashesAndRoots=d,Ct.validateHeaderFormat=y,Ct.validateHeaderDifficulty=b,Ct.blockHash=g,Ct.serializeBlockHeader=v,Ct.deserializeBlockHeader=_,Ct.genesisHeader=S,Ct.genesisBuffer=I,Ct.swapByteOrder=A,Ct.convertUint32ToBuffer=R,Ct.writeUInt32LE=E,Ct.writeUInt32BE=k,Ct.readUInt32LE=P,Ct.readUInt32BE=T,Ct.convertBufferToUint32=M;const i=pL(),e=Ye(),n=yL(),r=Ma();function t(C,D,F=0,B=-1){B<0&&(B=Math.floor((C.length-F)/80)),B=Math.max(0,B);let L=D;for(let q=0;q<B;q++){const K=F+q*80,$=K+80;if($>C.length)throw{message:`header ${q} missing bytes for header at offset ${K} in buffer of length ${C.length}`};const U=C.slice(K,$),z=(0,n.asString)(U.slice(4,36).reverse());if(L!==z)throw{message:`header ${q} invalid previousHash ${L} vs ${z}`};L=(0,n.asString)((0,r.doubleSha256BE)(U)),(0,i.validateAgainstDirtyHashes)(L)}return L}function s(C){return C.toString(16).padStart(64,"0")}function a(C,D){return new e.BigNumber((0,n.asArray)(C),16).gt(new e.BigNumber((0,n.asArray)(D),16))}function c(C,D){const F=new e.BigNumber((0,n.asArray)(C),16).add(new e.BigNumber((0,n.asArray)(D),16));return s(F)}function u(C,D){const F=new e.BigNumber((0,n.asArray)(C),16).sub(new e.BigNumber((0,n.asArray)(D),16));return s(F)}function l(C){Array.isArray(C)&&(C=P(C,0));const D=C>>24&255,F=C&8388607,B=new e.BigNumber(F);return D<=3?B.iushrn(8*(3-D)):B.iushln(8*(D-3)),B}function h(C){const D=l(C);return D.notn(256).div(D.addn(1)).addn(1).toString(16).padStart(64,"0")}function f(C,D=0,F){const B=[];for(;(!F||B.length<F)&&D+80<=C.length&&D>=0;)B.push(_(C,D)),D+=80;return B}function m(C,D,F=0,B){const L=[];let q=C;for(;(!B||L.length<B)&&F+80<=D.length&&F>=0;){const K=D.slice(F,F+80),U={..._(K),height:q++,hash:(0,n.asString)(g(K))};L.push(U),F+=80}return L}function d(C){const D=[],F=[];for(let B=0;B<C.length/80;B++){const L=B*80,q=(0,n.asBuffer)((0,r.doubleSha256LE)((0,n.asArray)(C.subarray(L,80+L))).reverse()),K=C.subarray(36+L,68+L).reverse();D.push(q),F.push(K)}return{hashes:D,merkleRoots:F}}function y(C){const D={version:!0,previousHash:!0,merkleRoot:!0,time:!0,bits:!0,nonce:!0,height:!0,hash:!0},F=4294967295;if(typeof C>"u")throw new Error("Missing header.");if(typeof C!="object")throw new Error("Header must be an object.");if(!Object.keys(C).every(B=>D[B]))throw new Error("Header contains extra properties.");if(typeof C.version!="number")throw new Error("Header version must be a number.");if(!Number.isInteger(C.version))throw new Error("Header version must be an integer.");if(C.version<0||C.version>F)throw new Error(`Header version must be between 0 and ${F}.`);if(typeof C.height!="number")throw new Error("Header height must be a number.");if(!Number.isInteger(C.height))throw new Error("Header height must be an integer.");if(C.height<0||C.height>F/2)throw new Error(`Header version must be between 0 and ${F/2}.`);if(C.previousHash.length!==64)throw new Error("Header previousHash must be 32 hex bytes.");if(C.merkleRoot.length!==64)throw new Error("Header merkleRoot must be 32 hex bytes.");if(typeof C.time!="number")throw new Error("Header time must be a number.");if(!Number.isInteger(C.time))throw new Error("Header time must be an integer.");if(C.time<0||C.time>F)throw new Error(`Header time must be between 0 and ${F}.`);if(typeof C.bits!="number")throw new Error("Header bits must be a number.");if(!Number.isInteger(C.bits))throw new Error("Header bits must be an integer.");if(C.bits<0||C.bits>F)throw new Error(`Header bits must be between 0 and ${F}.`);if(typeof C.nonce!="number")throw new Error("Header nonce must be a number.");if(!Number.isInteger(C.nonce))throw new Error("Header nonce must be an integer.");if(C.nonce<0||C.nonce>F)throw new Error(`Header nonce must be between 0 and ${F}.`);if(C.hash.length!==64)throw new Error("Header hash must be 32 hex bytes.");if(C.hash!==(0,n.asString)(g(C)))throw new Error("Header hash is invalid.")}function b(C,D){const F=new e.BigNumber((0,n.asArray)(C)),B=l(D);if(F.lte(B))return!0;throw new Error("Block hash is not less than specified target.")}function g(C){const D=Array.isArray(C)?C:v(C);if(D.length!==80)throw new Error("Block header must be 80 bytes long.");return(0,n.asString)((0,r.doubleSha256BE)(D))}function v(C,D,F){const B=new e.Utils.Writer;B.writeUInt32LE(C.version),B.write((0,n.asArray)(C.previousHash).reverse()),B.write((0,n.asArray)(C.merkleRoot).reverse()),B.writeUInt32LE(C.time),B.writeUInt32LE(C.bits),B.writeUInt32LE(C.nonce);const L=B.toArray();return D&&(F||(F=0),D.splice(F,D.length,...L)),L}function _(C,D=0){const F=new e.Utils.Reader(C,D);return{version:F.readUInt32LE(),previousHash:(0,n.asString)(F.read(32).reverse()),merkleRoot:(0,n.asString)(F.read(32).reverse()),time:F.readUInt32LE(),bits:F.readUInt32LE(),nonce:F.readUInt32LE()}}function S(C){return C==="main"?{version:1,previousHash:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",time:1231006505,bits:486604799,nonce:2083236893,height:0,hash:"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f"}:{version:1,previousHash:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b",time:1296688602,bits:486604799,nonce:414098458,height:0,hash:"000000000933ea01ad0ee984209779baaec3ced90fa3f408719526f8d77f4943"}}function I(C){return v(S(C))}function A(C){return C.slice().reverse()}function R(C,D=!0){const F=[C&255,C>>8&255,C>>16&255,C>>24&255];return D?F:F.reverse()}function E(C,D,F){return D[F++]=C&255,D[F++]=C>>8&255,D[F++]=C>>16&255,D[F++]=C>>24&255,F}function k(C,D,F){return D[F++]=C>>24&255,D[F++]=C>>16&255,D[F++]=C>>8&255,D[F++]=C&255,F}function P(C,D){return C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24}function T(C,D){return C[D++]<<24|C[D++]<<16|C[D++]<<8|C[D++]}function M(C,D=!0){const F=D?C:C.slice().reverse();return F[0]|F[1]<<8|F[2]<<16|F[3]<<24}return Ct}var C3;function bL(){if(C3)return Td;C3=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.BHServiceClient=void 0;const i=Ye(),e=Mw(),n=gL();let r=class{constructor(s,a,c){this.bhs=new i.BlockHeadersService(a,{apiKey:c}),this.cache={},this.chain=s,this.serviceUrl=a,this.options=e.ChaintracksServiceClient.createChaintracksServiceClientOptions(),this.options.useAuthrite=!0,this.apiKey=c}async currentHeight(){return await this.bhs.currentHeight()}async isValidRootForHeight(s,a){const c=this.cache[a];if(c)return c===s;const u=await this.bhs.isValidRootForHeight(s,a);return this.cache[a]=s,u}async getPresentHeight(){return await this.bhs.currentHeight()}async findHeaderForHeight(s){const a=await this.getJsonOrUndefined(`/api/v1/chain/header/byHeight?height=${s}`),c=a==null?void 0:a[0];return c?{version:c.version,previousHash:c.prevBlockHash,merkleRoot:c.merkleRoot,time:c.creationTimestamp,bits:c.difficultyTarget,nonce:c.nonce,height:s,hash:c.hash}:void 0}async findHeaderForBlockHash(s){const a=await this.getJsonOrUndefined(`/api/v1/chain/header/state/${s}`);return a!=null&&a.header?{version:a.header.version,previousHash:a.header.prevBlockHash,merkleRoot:a.header.merkleRoot,time:a.header.creationTimestamp,bits:a.header.difficultyTarget,nonce:a.header.nonce,height:a.height,hash:a.header.hash}:void 0}async getHeaders(s,a){const c=await this.getJsonOrUndefined(`/api/v1/chain/header/byHeight?height=${s}&count=${a}`);if(!c)return"";if(c.length<a)throw new Error("Cannot retrieve enough headers");return c.map(l=>{const h={version:l.version,previousHash:l.prevBlockHash,merkleRoot:l.merkleRoot,time:l.creationTimestamp,bits:l.difficultyTarget,nonce:l.nonce};return(0,n.serializeBlockHeader)(h)}).reduce((l,h)=>l+i.Utils.toHex(h),"")}async findChainWorkForBlockHash(s){throw new Error("Not implemented")}async findChainTipHeader(){const s=await this.getJson("/api/v1/chain/tip/longest");return{version:s.header.version,previousHash:s.header.prevBlockHash,merkleRoot:s.header.merkleRoot,time:s.header.creationTimestamp,bits:s.header.difficultyTarget,nonce:s.header.nonce,height:s.height,hash:s.header.hash}}async getJsonOrUndefined(s){let a;for(let c=0;c<3;c++){try{const u=await fetch(`${this.serviceUrl}${s}`,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(u.status!==200)throw new Error(JSON.stringify(u));const l=await u.json();return l||void 0}catch(u){a=u}if(a&&a.name!=="ECONNRESET")break}if(a)throw a}async getJson(s){const a=await this.getJsonOrUndefined(s);if(a===void 0)throw new Error("Value was undefined. Requested object may not exist.");return a}async postJsonVoid(s,a){throw new Error("Not implemented")}async addHeader(s){throw new Error("Not implemented")}async findHeaderForMerkleRoot(s,a){throw new Error("Not implemented")}async startListening(){throw new Error("Not implemented")}async listening(){throw new Error("Not implemented")}async isSynchronized(){throw new Error("Not implemented")}async getChain(){return this.chain}async isListening(){throw new Error("Not implemented")}async getChainTipHeader(){throw new Error("Not implemented")}async findChainTipHashHex(){throw new Error("Not implemented")}};return Td.BHServiceClient=r,Td}var M3;function Nk(){return M3||(M3=1,function(i){var e=oo&&oo.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=oo&&oo.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(fL(),i),n(hL(),i),n(bL(),i)}(oo)),oo}var B3;function mL(){if(B3)return zc;B3=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.createDefaultWalletServicesOptions=n,zc.arcDefaultUrl=r,zc.arcGorillaPoolUrl=t;const i=Ke(),e=Nk();function n(s,a,c,u){const l=`wallet-toolbox-${(0,i.randomBytesHex)(16)}`;return{chain:s,taalApiKey:u||s==="main"?"mainnet_9596de07e92300c6287e4393594ae39c":"testnet_0e6cf72133b43ea2d7861da2a38684e3",bsvExchangeRate:{timestamp:new Date("2023-12-13"),base:"USD",rate:47.52},bsvUpdateMsecs:1e3*60*15,fiatExchangeRates:{timestamp:new Date("2023-12-13"),base:"USD",rates:{USD:1,GBP:.8,EUR:.93}},fiatUpdateMsecs:1e3*60*60*24,disableMapiCallback:!0,exchangeratesapiKey:"bd539d2ff492bcb5619d5f27726a766f",chaintracksFiatExchangeRatesUrl:`https://npm-registry.babbage.systems:${s==="main"?8084:8083}/getFiatExchangeRates`,chaintracks:new e.ChaintracksServiceClient(s,`https://npm-registry.babbage.systems:${s==="main"?8084:8083}`),arcUrl:r(s),arcConfig:{apiKey:u??void 0,deploymentId:l,callbackUrl:a??void 0,callbackToken:c??void 0},arcGorillaPoolUrl:t(s),arcGorillaPoolConfig:{apiKey:u??void 0,deploymentId:l,callbackUrl:a??void 0,callbackToken:c??void 0}}}function r(s){return s==="main"?"https://arc.taal.com":"https://arc-test.taal.com"}function t(s){return s==="main"?"https://arc.gorillapool.io":void 0}return zc}var lo={},kp={},D3;function wL(){if(D3)return kp;D3=1,Object.defineProperty(kp,"__esModule",{value:!0});const i=Ye();let e=class{constructor(r="main",t={}){const{apiKey:s,httpClient:a}=t;this.network=r,this.URL=`https://api.whatsonchain.com/v1/bsv/${r}`,this.httpClient=a??(0,i.defaultHttpClient)(),this.apiKey=s??""}async isValidRootForHeight(r,t){const s={method:"GET",headers:this.getHttpHeaders()},a=await this.httpClient.request(`${this.URL}/block/${t}/header`,s);if(a.ok){const{merkleroot:c}=a.data;return c===r}else{if(a.status===404)return!1;throw new Error(`Failed to verify merkleroot for height ${t} because of an error: ${JSON.stringify(a.data)} `)}}async currentHeight(){try{const r={method:"GET",headers:this.getHttpHeaders()},t=await this.httpClient.request(`${this.URL}/block/headers`,r);if(t.ok)return t.data[0].height;throw new Error(`Failed to get current height because of an error: ${JSON.stringify(t.data)} `)}catch(r){throw new Error(`Failed to get current height because of an error: ${r instanceof Error?r.message:String(r)}`)}}getHttpHeaders(){const r={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(r.Authorization=this.apiKey),r}};return kp.default=e,kp}var L3;function vL(){if(L3)return lo;L3=1;var i=lo&&lo.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(lo,"__esModule",{value:!0}),lo.WhatsOnChain=void 0;const e=Ye(),n=Ke(),r=uk(),t=i(wL()),s=Jn();let a=class extends t.default{constructor(u="main",l={},h){super(u,l),this.services=h||new n.Services(u)}async getStatusForTxids(u){const l={name:"WoC",status:"error",error:void 0,results:[]},h={method:"POST",headers:this.getHttpHeaders(),data:{txids:u}},f=`${this.URL}/txs/status`;try{const m=await this.httpClient.request(f,h);if(!m.data||!m.ok||m.status!==200)throw new n.sdk.WERR_INVALID_OPERATION("Unable to get status for txids at this timei.");const d=m.data;for(const y of u){const b=d.find(g=>g.txid===y);!b||b.error==="unknown"?l.results.push({txid:y,status:"unknown",depth:void 0}):b.error!==void 0?(console.log(`WhatsOnChain getStatusForTxids unexpected error ${b.error} ${y}`),l.results.push({txid:y,status:"unknown",depth:void 0})):b.confirmations===void 0?l.results.push({txid:y,status:"known",depth:0}):l.results.push({txid:y,status:"mined",depth:b.confirmations})}l.status="success"}catch(m){const d=n.sdk.WalletError.fromUnknown(m);l.error=d}return l}async getTxPropagation(u){const l={method:"GET",headers:this.getHttpHeaders()},h=await this.httpClient.request(`${this.URL}/tx/hash/${u}/propagation`,l);if(!h.data||!h.ok||h.status!==200)throw new n.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${u}' response ${h.statusText}`);return 0}async getRawTx(u){const l=this.getHttpHeaders();l["Cache-Control"]="no-cache";const h={method:"GET",headers:l},f=`${this.URL}/tx/${u}/hex`;for(let m=0;m<2;m++){const d=await this.httpClient.request(f,h);if(d.statusText==="Too Many Requests"&&m<2){await(0,n.wait)(2e3);continue}if(d.status===404&&d.statusText==="Not Found")return;if(!d.data||!d.ok||d.status!==200)throw new n.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${u}' response ${d.statusText}`);return d.data}throw new n.sdk.WERR_INTERNAL}async getRawTxResult(u){const l={name:"WoC",txid:(0,n.asString)(u)};try{const h=await this.getRawTx(u);h&&(l.rawTx=(0,n.asArray)(h))}catch(h){l.error=n.sdk.WalletError.fromUnknown(h)}return l}async postBeef(u,l){const h={name:"WoC",status:"success",txidResults:[],notes:[]};let f=!1;const m=()=>({name:"WoCpostBeef",when:new Date().toISOString()}),d=()=>({...m(),beef:u.toHex(),txids:l.join(",")});for(const y of l){const b=e.Utils.toHex(u.findTxid(y).rawTx);f&&await(0,n.wait)(3e3),f=!0;const g=await this.postRawTx(b);y!==g.txid&&g.notes.push({...d(),what:"postRawTxTxidChanged",txid:y,trTxid:g.txid}),h.txidResults.push(g),h.status==="success"&&g.status!=="success"&&(h.status="error")}return h.status==="success"?h.notes.push({...m(),what:"postBeefSuccess"}):h.notes.push({...d(),what:"postBeefError"}),h}async postRawTx(u){let l=e.Utils.toHex((0,n.doubleSha256BE)(e.Utils.toArray(u,"hex")));const h={txid:l,status:"success",notes:[]},f=this.getHttpHeaders();f["Content-Type"]="application/json",f.Accept="text/plain";const m={method:"POST",headers:f,data:{txhex:u}},d=`${this.URL}/tx/raw`,y=()=>({name:"WoCpostRawTx",when:new Date().toISOString()}),b=()=>({...y(),rawTx:u,txid:l,url:d}),g=5;for(let v=0;v<g;v++){try{const _=await this.httpClient.request(d,m);if(_.statusText==="Too Many Requests"&&v<2){h.notes.push({...y(),what:"postRawTxRateLimit"}),await(0,n.wait)(2e3);continue}if(_.ok){const S=_.data;h.notes.push({...y(),what:"postRawTxSuccess"})}else if(_.data==="unexpected response code 500: Transaction already in the mempool")h.notes.push({...b(),what:"postRawTxSuccessAlreadyInMempool"});else if(h.status="error",_.data==="unexpected response code 500: 258: txn-mempool-conflict")h.doubleSpend=!0,h.competingTxs=void 0,h.notes.push({...b(),what:"postRawTxErrorMempoolConflict"});else if(_.data==="unexpected response code 500: Missing inputs")h.doubleSpend=!0,h.competingTxs=void 0,h.notes.push({...b(),what:"postRawTxErrorMissingInputs"});else{const S={...b(),what:"postRawTxError"};typeof _.data=="string"?(S.data=_.data.slice(0,128),h.data=_.data):h.data="",typeof _.statusText=="string"&&(S.statusText=_.statusText.slice(0,128),h.data+=`,${_.statusText}`),typeof _.status=="string"&&(S.status=_.status.slice(0,128),h.data+=`,${_.status}`),typeof _.status=="number"&&(S.status=_.status,h.data+=`,${_.status}`),h.notes.push(S)}}catch(_){h.status="error";const S=n.sdk.WalletError.fromUnknown(_);h.notes.push({...b(),what:"postRawTxCatch",code:S.code,description:S.description}),h.serviceError=!0,h.data=`${S.code} ${S.description}`}return h}return h.status="error",h.serviceError=!0,h.notes.push({...b(),what:"postRawTxRetryLimit",retryLimit:g}),h}async getMerklePath(u,l){const h={name:"WoCTsc",notes:[]},m={method:"GET",headers:this.getHttpHeaders()};for(let d=0;d<2;d++){try{const y=await this.httpClient.request(`${this.URL}/tx/${u}/proof/tsc`,m);if(y.statusText==="Too Many Requests"&&d<2){h.notes.push({what:"getMerklePathRetry",name:h.name,status:y.status,statusText:y.statusText}),await(0,n.wait)(2e3);continue}if(y.status===404&&y.statusText==="Not Found")return h.notes.push({what:"getMerklePathNotFound",name:h.name,status:y.status,statusText:y.statusText}),h;if(!y.ok||y.status!==200)throw h.notes.push({what:"getMerklePathBadStatus",name:h.name,status:y.status,statusText:y.statusText}),new n.sdk.WERR_INVALID_PARAMETER("txid",`valid transaction. '${u}' response ${y.statusText}`);if(!y.data)return h.notes.push({what:"getMerklePathNoData",name:h.name,status:y.status,statusText:y.statusText}),h;if(Array.isArray(y.data)||(y.data=[y.data]),y.data.length!=1)return h;const b=y.data[0],g=await l.hashToHeader(b.target);if(g){const v={index:b.index,nodes:b.nodes,height:g.height};h.merklePath=(0,r.convertProofToMerklePath)(u,v),h.header=g,h.notes.push({what:"getMerklePathSuccess",name:h.name,status:y.status,statusText:y.statusText})}else throw h.notes.push({what:"getMerklePathNoHeader",target:b.target,name:h.name,status:y.status,statusText:y.statusText}),new n.sdk.WERR_INVALID_PARAMETER("blockhash","a valid on-chain block hash")}catch(y){const b=n.sdk.WalletError.fromUnknown(y);h.notes.push({what:"getMerklePathError",name:h.name,code:b.code,description:b.description}),h.error=b}return h}throw h.notes.push({what:"getMerklePathInternal",name:h.name}),new n.sdk.WERR_INTERNAL}async updateBsvExchangeRate(u,l){if(u&&(l||(l=1e3*60*15),new Date(Date.now()-l)<u.timestamp))return u;const h={method:"GET",headers:this.getHttpHeaders()};for(let f=0;f<2;f++){const m=await this.httpClient.request(`${this.URL}/exchangerate`,h);if(m.statusText==="Too Many Requests"&&f<2){await(0,n.wait)(2e3);continue}if(!m.data||!m.ok||m.status!==200)throw new n.sdk.WERR_INVALID_OPERATION(`WoC exchangerate response ${m.statusText}`);const d=m.data;return d.currency!=="USD"&&(d.rate=NaN),{timestamp:new Date,base:"USD",rate:d.rate}}throw new n.sdk.WERR_INTERNAL}async getUtxoStatus(u,l,h){const f={name:"WoC",status:"error",error:new n.sdk.WERR_INTERNAL,details:[]};for(let m=0;;m++){let d="";try{const y=(0,n.validateScriptHash)(u,l),b={method:"GET",headers:this.getHttpHeaders()},g=await this.httpClient.request(`${this.URL}/script/${y}/unspent/all`,b);if(g.statusText==="Too Many Requests"&&m<2){await(0,n.wait)(2e3);continue}if(!g.data||!g.ok||g.status!==200)throw new n.sdk.WERR_INVALID_OPERATION(`WoC getUtxoStatus response ${g.statusText}`);const v=g.data;if(v.script!==y||!Array.isArray(v.result))throw new n.sdk.WERR_INTERNAL("data. is not an array");if(v.result.length===0)f.status="success",f.error=void 0,f.isUtxo=!1;else{f.status="success",f.error=void 0;for(const _ of v.result)f.details.push({txid:_.tx_hash,satoshis:_.value,height:_.height,index:_.tx_pos});if(h){const{txid:_,vout:S}=(0,s.parseWalletOutpoint)(h);f.isUtxo=f.details.find(I=>I.txid===_&&I.index===S)!==void 0}else f.isUtxo=f.details.length>0}return f}catch(y){if(n.sdk.WalletError.fromUnknown(y).code!=="ECONNRESET"||m>2)return f.error=new n.sdk.WERR_INTERNAL(`service failure: ${d}, error: ${JSON.stringify(n.sdk.WalletError.fromUnknown(y))}`),f}}}async getScriptHashConfirmedHistory(u){const l={name:"WoC",status:"error",error:void 0,history:[]};u=e.Utils.toHex(e.Utils.toArray(u,"hex").reverse());const h=`${this.URL}/script/${u}/confirmed/history`;for(let f=0;;f++)try{const m={method:"GET",headers:this.getHttpHeaders()},d=await this.httpClient.request(h,m);if(d.statusText==="Too Many Requests"&&f<2){await(0,n.wait)(2e3);continue}return!d.ok&&d.status===404?(l.status="success",l):!d.data||!d.ok||d.status!==200?(l.error=new n.sdk.WERR_BAD_REQUEST(`WoC getScriptHashConfirmedHistory response ${d.ok} ${d.status} ${d.statusText}`),l):d.data.error?(l.error=new n.sdk.WERR_BAD_REQUEST(`WoC getScriptHashConfirmedHistory error ${d.data.error}`),l):(l.history=d.data.result.map(y=>({txid:y.tx_hash,height:y.height})),l.status="success",l)}catch(m){if(n.sdk.WalletError.fromUnknown(m).code!=="ECONNRESET"||f>2)return l.error=new n.sdk.WERR_INTERNAL(`WoC getScriptHashConfirmedHistory service failure: ${h}, error: ${JSON.stringify(n.sdk.WalletError.fromUnknown(m))}`),l}return l}async getScriptHashUnconfirmedHistory(u){const l={name:"WoC",status:"error",error:void 0,history:[]};u=e.Utils.toHex(e.Utils.toArray(u,"hex").reverse());const h=`${this.URL}/script/${u}/unconfirmed/history`;for(let f=0;;f++)try{const m={method:"GET",headers:this.getHttpHeaders()},d=await this.httpClient.request(h,m);if(d.statusText==="Too Many Requests"&&f<2){await(0,n.wait)(2e3);continue}return!d.ok&&d.status===404?(l.status="success",l):!d.data||!d.ok||d.status!==200?(l.error=new n.sdk.WERR_BAD_REQUEST(`WoC getScriptHashUnconfirmedHistory response ${d.ok} ${d.status} ${d.statusText}`),l):d.data.error?(l.error=new n.sdk.WERR_BAD_REQUEST(`WoC getScriptHashUnconfirmedHistory error ${d.data.error}`),l):(l.history=d.data.result.map(y=>({txid:y.tx_hash,height:y.height})),l.status="success",l)}catch(m){if(n.sdk.WalletError.fromUnknown(m).code!=="ECONNRESET"||f>2)return l.error=new n.sdk.WERR_INTERNAL(`WoC getScriptHashUnconfirmedHistory service failure: ${h}, error: ${JSON.stringify(n.sdk.WalletError.fromUnknown(m))}`),l}return l}async getScriptHashHistory(u){const l=await this.getScriptHashConfirmedHistory(u);if(l.error||l.status!=="success")return l;const h=await this.getScriptHashUnconfirmedHistory(u);return h.error||h.status!=="success"?h:(l.history=l.history.concat(h.history),l)}};return lo.WhatsOnChain=a,lo}var Xc={},F3;function xL(){if(F3)return Xc;F3=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.updateChaintracksFiatExchangeRates=e,Xc.updateExchangeratesapi=n,Xc.getExchangeRatesIo=r;const i=Ke();async function e(t,s){const a=s.chaintracksFiatExchangeRatesUrl;if(!a)throw new i.sdk.WERR_MISSING_PARAMETER("options.chaintracksFiatExchangeRatesUrl");const c=await fetch(a),u=await c.json(),l={status:c.status,data:u};if(l.status!==200||!l.data||l.data.status!="success")throw new i.sdk.WERR_BAD_REQUEST(`${a} returned status ${l.status}`);const h=l.data.value;return h.timestamp=new Date(h.timestamp),h}async function n(t,s){if(!s.exchangeratesapiKey)throw new i.sdk.WERR_MISSING_PARAMETER("options.exchangeratesapiKey");const a=await r(s.exchangeratesapiKey);if(!a.success)throw new i.sdk.WERR_BAD_REQUEST(`getExchangeRatesIo returned success ${a.success}`);if(!a.rates.USD||!a.rates[a.base])throw new i.sdk.WERR_BAD_REQUEST("getExchangeRatesIo missing rates for 'USD' or base");const c={timestamp:new Date(a.timestamp*1e3),base:"USD",rates:{}},u=a.rates[a.base]/a.rates.USD;let l=0;for(const[h,f]of Object.entries(a.rates))t.indexOf(h)>-1&&(c.rates[h]=f*u,l++);if(l!==t.length)throw new i.sdk.WERR_BAD_REQUEST("getExchangeRatesIo failed to update all target currencies");return c}async function r(t){const s=`http://api.exchangeratesapi.io/v1/latest?access_key=${t}`,a=await fetch(s),c=await a.json(),u={status:a.status,data:c};if(u.status!==200||!u.data)throw new i.sdk.WERR_BAD_REQUEST(`getExchangeRatesIo returned status ${u.status}`);return u.data}return Xc}var kd={},U3;function _L(){if(U3)return kd;U3=1,Object.defineProperty(kd,"__esModule",{value:!0}),kd.ARC=void 0;const i=Ye(),e=Ke();function n(){return`ts-sdk-${i.Utils.toHex((0,i.Random)(16))}`}let r=class{constructor(s,a,c){if(this.name=c??"ARC",this.URL=s,typeof a=="string")this.apiKey=a,this.httpClient=(0,i.defaultHttpClient)(),this.deploymentId=n(),this.callbackToken=void 0,this.callbackUrl=void 0;else{const u=a??{},{apiKey:l,deploymentId:h,httpClient:f,callbackToken:m,callbackUrl:d,headers:y}=u;this.apiKey=l,this.httpClient=f??(0,i.defaultHttpClient)(),this.deploymentId=h??n(),this.callbackToken=m,this.callbackUrl=d,this.headers=y}}requestHeaders(){const s={"Content-Type":"application/json","XDeployment-ID":this.deploymentId};if(this.apiKey!=null&&this.apiKey!==""&&(s.Authorization=`Bearer ${this.apiKey}`),this.callbackUrl!=null&&this.callbackUrl!==""&&(s["X-CallbackUrl"]=this.callbackUrl),this.callbackToken!=null&&this.callbackToken!==""&&(s["X-CallbackToken"]=this.callbackToken),this.headers!=null)for(const a in this.headers)s[a]=this.headers[a];return s}async postRawTx(s,a){let c=i.Utils.toHex((0,e.doubleSha256BE)(i.Utils.toArray(s,"hex")));a?c=a.slice(-1)[0]:a=[c];const u={method:"POST",headers:this.requestHeaders(),data:{rawTx:s}},l={txid:c,status:"success",notes:[]};u.signal=AbortSignal.timeout(1e3*30);const h=`${this.URL}/v1/tx`,f=()=>({name:this.name,when:new Date().toISOString()}),m=()=>({...f(),rawTx:s,txids:a.join(","),url:h});try{const d=await this.httpClient.request(h,u),{txid:y,extraInfo:b,txStatus:g,competingTxs:v}=d.data,_=()=>({txid:y,extraInfo:b,txStatus:g,competingTxs:v==null?void 0:v.join(",")});if(d.ok)l.data=`${g} ${b}`,l.txid!==y&&(l.data+=` txid altered from ${l.txid} to ${y}`),l.txid=y,g==="DOUBLE_SPEND_ATTEMPTED"||g==="SEEN_IN_ORPHAN_MEMPOOL"?(l.status="error",l.doubleSpend=!0,l.competingTxs=v,l.notes.push({...m(),..._(),what:"postRawTxDoubleSpend"})):l.notes.push({...f(),..._(),what:"postRawTxSuccess"});else if(typeof d=="string")l.notes.push({...m(),what:"postRawTxString",response:d}),l.status="error",l.serviceError=!0;else{l.status="error",l.serviceError=!0;const S={...f(),...m(),..._(),what:"postRawTxError"},I={};l.data=I;const A=typeof d.status;A==="number"||A==="string"?(S.status=d.status,I.status=d.status.toString()):(S.status=A,I.status="ERR_UNKNOWN");let R=d.data;if(R&&typeof R=="string"){S.data=d.data.slice(0,128);try{R=JSON.parse(R)}catch{}}else R&&typeof R=="object"&&(I.more=R,I.detail=R.detail,typeof I.detail!="string"&&(I.detail=void 0),I.detail&&(S.detail=I.detail));l.notes.push(S)}}catch(d){const y=e.sdk.WalletError.fromUnknown(d);l.status="error",l.serviceError=!0,l.data=`${y.code} ${y.message}`,l.notes.push({...m(),what:"postRawTxCatch",code:y.code,description:y.description})}return l}async postBeef(s,a){const c={name:this.name,status:"success",txidResults:[],notes:[]},u=()=>({name:this.name,when:new Date().toISOString()});s.version===i.BEEF_V2&&s.txs.every(f=>!f.isTxidOnly)&&(s.version=i.BEEF_V1,c.notes.push({...u(),what:"postBeefV2ToV1"}));const l=s.toHex(),h=await this.postRawTx(l,a);c.status=h.status,c.txidResults=[h];for(const f of a){if(h.txid===f)continue;const m={txid:f,status:"success",notes:[]},d=await this.getTxData(f);d.txid!==f?(m.status="error",m.data="internal error",m.notes.push({...u(),what:"postBeefGetTxDataInternal",txid:f,returnedTxid:d.txid})):d.txStatus==="SEEN_ON_NETWORK"||d.txStatus==="STORED"?(m.data=d.txStatus,m.notes.push({...u(),what:"postBeefGetTxDataSuccess",txid:f,txStatus:d.txStatus})):(m.status="error",m.data=d,m.notes.push({...u(),what:"postBeefGetTxDataError",txid:f,txStatus:d.txStatus})),c.txidResults.push(m),c.status==="success"&&m.status==="error"&&(c.status="error")}return c}async getTxData(s){const a={method:"GET",headers:this.requestHeaders()};return(await this.httpClient.request(`${this.URL}/v1/tx/${s}`,a)).data}};return kd.ARC=r,kd}var Ed={},H3;function SL(){if(H3)return Ed;H3=1,Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.Bitails=void 0;const i=Ye(),e=Ke();let n=class{constructor(t="main",s={}){const{apiKey:a,httpClient:c}=s;this.chain=t,this.URL=t==="main"?"https://api.bitails.io/":"https://test-api.bitails.io/",this.httpClient=c??(0,i.defaultHttpClient)(),this.apiKey=a??""}getHttpHeaders(){const t={Accept:"application/json"};return typeof this.apiKey=="string"&&this.apiKey.trim()!==""&&(t.Authorization=this.apiKey),t}async postBeef(t,s){const a=()=>({name:"BitailsPostBeef",when:new Date().toISOString()}),c=()=>({...a(),beef:t.toHex(),txids:s.join(",")}),u={...a(),what:"postBeef"},l=[];for(const f of s){const m=i.Utils.toHex(t.findTxid(f).rawTx);l.push(m)}const h=await this.postRaws(l,s);return h.notes.unshift(u),h.status!=="success"?h.notes.push({...c(),what:"postBeefError"}):h.notes.push({...a(),what:"postBeefSuccess"}),h}async postRaws(t,s){const a={name:"BitailsPostRaws",status:"success",txidResults:[],notes:[]},c=[];for(const y of t){const b=i.Utils.toHex((0,e.doubleSha256BE)(i.Utils.toArray(y,"hex")));c.push(b),(!s||s.indexOf(b)>=0)&&a.txidResults.push({txid:b,status:"success",notes:[]})}const u=this.getHttpHeaders();u["Content-Type"]="application/json";const h={method:"POST",headers:u,data:{raws:t}},f=`${this.URL}tx/broadcast/multi`,m=()=>({name:"BitailsPostRawTx",when:new Date().toISOString()}),d=()=>({...m(),raws:t.join(","),txids:a.txidResults.map(y=>y.txid).join(","),url:f});try{const y=await this.httpClient.request(f,h);if(y.ok){const b=y.data;if(b.length!==t.length)a.status="error",a.notes.push({...d(),what:"postRawsErrorResultsCount"});else{let g=-1;for(const v of b)g++,v.txid?v.txid!==c[g]&&(a.status="error",a.notes.push({...m(),what:"postRawsResultTxids",i:g,txid:v.txid,rawsTxid:c[g]})):(v.txid=c[g],a.notes.push({...m(),what:"postRawsResultMissingTxids",i:g,rawsTxid:c[g]}));if(a.status==="success")for(const v of a.txidResults){const _=b.find(I=>I.txid===v.txid),S=v.txid;if(_.error){const{code:I,message:A}=_.error;I===-27?v.notes.push({...d(),what:"postRawsSuccessAlreadyInMempool"}):(v.status="error",I===-25?(v.doubleSpend=!0,v.competingTxs=void 0,v.notes.push({...d(),what:"postRawsErrorMissingInputs"})):_.code==="ECONNRESET"?v.notes.push({...d(),what:"postRawsErrorECONNRESET",txid:S,message:A}):v.notes.push({...d(),what:"postRawsError",txid:S,code:I,message:A}))}else v.notes.push({...m(),what:"postRawsSuccess"});v.status!=="success"&&a.status==="success"&&(a.status="error")}}}else{a.status="error";const b={...d(),what:"postRawsError"};a.notes.push(b)}}catch(y){a.status="error";const b=e.sdk.WalletError.fromUnknown(y),{code:g,description:v}=b;a.notes.push({...d(),what:"postRawsCatch",code:g,description:v})}return a}async getMerklePath(t,s){const a={name:"BitailsTsc",notes:[]},c=`${this.URL}tx/${t}/proof/tsc`,u=()=>({name:"BitailsProofTsc",when:new Date().toISOString(),txid:t,url:c}),h={method:"GET",headers:this.getHttpHeaders()};try{const f=await this.httpClient.request(c,h),m=()=>({...u(),txid:t,url:c,status:f.status,statusText:f.statusText});if(f.status===404&&f.statusText==="Not Found")a.notes.push({...u(),what:"getMerklePathNotFound"});else if(!f.ok||f.status!==200||f.statusText!=="OK")a.notes.push({...m(),what:"getMerklePathBadStatus"});else if(!f.data)a.notes.push({...m(),what:"getMerklePathNoData"});else{const d=f.data,y=await s.hashToHeader(d.target);if(y){const b={index:d.index,nodes:d.nodes,height:y.height};a.merklePath=(0,e.convertProofToMerklePath)(t,b),a.header=y,a.notes.push({...m(),what:"getMerklePathSuccess"})}else a.notes.push({...m(),what:"getMerklePathNoHeader",target:d.target})}}catch(f){const m=e.sdk.WalletError.fromUnknown(f),{code:d,description:y}=m;a.notes.push({...u(),what:"getMerklePathCatch",code:d,description:y}),a.error=m}return a}};return Ed.Bitails=n,Ed}var Ep={},q3;function IL(){if(q3)return Ep;q3=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.getBeefForTxid=e;const i=Nw();async function e(r,t){return await new n(r).getBeefForTxid(t)}class n extends i.StorageProvider{constructor(t){const s=i.StorageProvider.createStorageBaseOptions(t.chain);super(s),this.nip=new Error("Method not implemented."),this.setServices(t),this.gbo={ignoreServices:!1,ignoreStorage:!0,ignoreNewProven:!0}}async getBeefForTxid(t){return await this.getBeefForTransaction(t,this.gbo)}reviewStatus(t){throw this.nip}purgeData(t,s){throw this.nip}allocateChangeInput(t,s,a,c,u,l){throw this.nip}getProvenOrRawTx(t,s){throw this.nip}getRawTxOfKnownValidTransaction(t,s,a,c){throw this.nip}getLabelsForTransactionId(t,s){throw this.nip}getTagsForOutputId(t,s){throw this.nip}listActions(t,s){throw this.nip}listOutputs(t,s){throw this.nip}countChangeInputs(t,s,a){throw this.nip}findCertificatesAuth(t,s){throw this.nip}findOutputBasketsAuth(t,s){throw this.nip}findOutputsAuth(t,s){throw this.nip}insertCertificateAuth(t,s){throw this.nip}dropAllData(){throw this.nip}migrate(t,s){throw this.nip}findOutputTagMaps(t){throw this.nip}findProvenTxReqs(t){throw this.nip}findProvenTxs(t){throw this.nip}findTxLabelMaps(t){throw this.nip}countOutputTagMaps(t){throw this.nip}countProvenTxReqs(t){throw this.nip}countProvenTxs(t){throw this.nip}countTxLabelMaps(t){throw this.nip}insertCertificate(t,s){throw this.nip}insertCertificateField(t,s){throw this.nip}insertCommission(t,s){throw this.nip}insertMonitorEvent(t,s){throw this.nip}insertOutput(t,s){throw this.nip}insertOutputBasket(t,s){throw this.nip}insertOutputTag(t,s){throw this.nip}insertOutputTagMap(t,s){throw this.nip}insertProvenTx(t,s){throw this.nip}insertProvenTxReq(t,s){throw this.nip}insertSyncState(t,s){throw this.nip}insertTransaction(t,s){throw this.nip}insertTxLabel(t,s){throw this.nip}insertTxLabelMap(t,s){throw this.nip}insertUser(t,s){throw this.nip}updateCertificate(t,s,a){throw this.nip}updateCertificateField(t,s,a,c){throw this.nip}updateCommission(t,s,a){throw this.nip}updateMonitorEvent(t,s,a){throw this.nip}updateOutput(t,s,a){throw this.nip}updateOutputBasket(t,s,a){throw this.nip}updateOutputTag(t,s,a){throw this.nip}updateOutputTagMap(t,s,a,c){throw this.nip}updateProvenTx(t,s,a){throw this.nip}updateProvenTxReq(t,s,a){throw this.nip}updateSyncState(t,s,a){throw this.nip}updateTransaction(t,s,a){throw this.nip}updateTxLabel(t,s,a){throw this.nip}updateTxLabelMap(t,s,a,c){throw this.nip}updateUser(t,s,a){throw this.nip}destroy(){throw this.nip}transaction(t,s){throw this.nip}readSettings(t){throw this.nip}findCertificateFields(t){throw this.nip}findCertificates(t){throw this.nip}findCommissions(t){throw this.nip}findMonitorEvents(t){throw this.nip}findOutputBaskets(t){throw this.nip}findOutputs(t){throw this.nip}findOutputTags(t){throw this.nip}findSyncStates(t){throw this.nip}findTransactions(t){throw this.nip}findTxLabels(t){throw this.nip}findUsers(t){throw this.nip}countCertificateFields(t){throw this.nip}countCertificates(t){throw this.nip}countCommissions(t){throw this.nip}countMonitorEvents(t){throw this.nip}countOutputBaskets(t){throw this.nip}countOutputs(t){throw this.nip}countOutputTags(t){throw this.nip}countSyncStates(t){throw this.nip}countTransactions(t){throw this.nip}countTxLabels(t){throw this.nip}countUsers(t){throw this.nip}getProvenTxsForUser(t){throw this.nip}getProvenTxReqsForUser(t){throw this.nip}getTxLabelMapsForUser(t){throw this.nip}getOutputTagMapsForUser(t){throw this.nip}adminStats(t){throw this.nip}}return Ep}var j3;function Mk(){if(j3)return so;j3=1,Object.defineProperty(so,"__esModule",{value:!0}),so.Services=void 0,so.validateScriptHash=f,so.toBinaryBaseBlockHeader=m;const i=Ye(),e=Ke(),n=lL(),r=mL(),t=Nk(),s=vL(),a=xL(),c=_L(),u=SL(),l=IL();let h=class Ck{static createDefaultOptions(y){return(0,r.createDefaultWalletServicesOptions)(y)}constructor(y){this.postBeefMode="UntilSuccess",this.targetCurrencies=["USD","GBP","EUR"],this.chain=typeof y=="string"?y:y.chain,this.options=typeof y=="string"?Ck.createDefaultOptions(this.chain):y,this.whatsonchain=new s.WhatsOnChain(this.chain,{apiKey:this.options.whatsOnChainApiKey},this),this.arcTaal=new c.ARC(this.options.arcUrl,this.options.arcConfig,"arcTaal"),this.options.arcGorillaPoolUrl&&(this.arcGorillaPool=new c.ARC(this.options.arcGorillaPoolUrl,this.options.arcGorillaPoolConfig,"arcGorillaPool")),this.bitails=new u.Bitails(this.chain),this.getMerklePathServices=new n.ServiceCollection("getMerklePath").add({name:"WhatsOnChain",service:this.whatsonchain.getMerklePath.bind(this.whatsonchain)}).add({name:"Bitails",service:this.bitails.getMerklePath.bind(this.bitails)}),this.getRawTxServices=new n.ServiceCollection("getRawTx").add({name:"WhatsOnChain",service:this.whatsonchain.getRawTxResult.bind(this.whatsonchain)}),this.postBeefServices=new n.ServiceCollection("postBeef"),this.arcGorillaPool&&this.postBeefServices.add({name:"GorillaPoolArcBeef",service:this.arcGorillaPool.postBeef.bind(this.arcGorillaPool)}),this.postBeefServices.add({name:"TaalArcBeef",service:this.arcTaal.postBeef.bind(this.arcTaal)}).add({name:"Bitails",service:this.bitails.postBeef.bind(this.bitails)}).add({name:"WhatsOnChain",service:this.whatsonchain.postBeef.bind(this.whatsonchain)}),this.getUtxoStatusServices=new n.ServiceCollection("getUtxoStatus").add({name:"WhatsOnChain",service:this.whatsonchain.getUtxoStatus.bind(this.whatsonchain)}),this.getStatusForTxidsServices=new n.ServiceCollection("getStatusForTxids").add({name:"WhatsOnChain",service:this.whatsonchain.getStatusForTxids.bind(this.whatsonchain)}),this.getScriptHashHistoryServices=new n.ServiceCollection("getScriptHashHistory").add({name:"WhatsOnChain",service:this.whatsonchain.getScriptHashHistory.bind(this.whatsonchain)}),this.updateFiatExchangeRateServices=new n.ServiceCollection("updateFiatExchangeRate").add({name:"ChaintracksService",service:a.updateChaintracksFiatExchangeRates}).add({name:"exchangeratesapi",service:a.updateExchangeratesapi})}getServicesCallHistory(y){return{version:2,getMerklePath:this.getMerklePathServices.getServiceCallHistory(y),getRawTx:this.getRawTxServices.getServiceCallHistory(y),postBeef:this.postBeefServices.getServiceCallHistory(y),getUtxoStatus:this.getUtxoStatusServices.getServiceCallHistory(y),getStatusForTxids:this.getStatusForTxidsServices.getServiceCallHistory(y),getScriptHashHistory:this.getScriptHashHistoryServices.getServiceCallHistory(y),updateFiatExchangeRates:this.updateFiatExchangeRateServices.getServiceCallHistory(y)}}async getChainTracker(){if(!this.options.chaintracks)throw new e.sdk.WERR_INVALID_PARAMETER("options.chaintracks","valid to enable 'getChainTracker' service.");return new t.ChaintracksChainTracker(this.chain,this.options.chaintracks)}async getBsvExchangeRate(){return this.options.bsvExchangeRate=await this.whatsonchain.updateBsvExchangeRate(this.options.bsvExchangeRate,this.options.bsvUpdateMsecs),this.options.bsvExchangeRate.rate}async getFiatExchangeRate(y,b){const g=await this.updateFiatExchangeRates(this.options.fiatExchangeRates,this.options.fiatUpdateMsecs);return this.options.fiatExchangeRates=g,b||(b="USD"),g.rates[y]/g.rates[b]}get getProofsCount(){return this.getMerklePathServices.count}get getRawTxsCount(){return this.getRawTxServices.count}get postBeefServicesCount(){return this.postBeefServices.count}get getUtxoStatsCount(){return this.getUtxoStatusServices.count}async getStatusForTxids(y,b){const g=this.getStatusForTxidsServices;b&&g.next();let v={name:"<noservices>",status:"error",error:new e.sdk.WERR_INTERNAL("No services available."),results:[]};for(let _=0;_<g.count;_++){const S=g.serviceToCall;try{const I=await S.service(y);if(I.status==="success"){g.addServiceCallSuccess(S),v=I;break}else I.error?g.addServiceCallError(S,I.error):g.addServiceCallFailure(S)}catch(I){const A=e.sdk.WalletError.fromUnknown(I);g.addServiceCallError(S,A)}g.next()}return v}hashOutputScript(y){return i.Utils.toHex((0,e.sha256Hash)(i.Utils.toArray(y,"hex")))}async isUtxo(y){if(!y.lockingScript)throw new e.sdk.WERR_INVALID_PARAMETER("output.lockingScript","validated by storage provider validateOutputScript.");const b=this.hashOutputScript(i.Utils.toHex(y.lockingScript));return(await this.getUtxoStatus(b,void 0,`${y.txid}.${y.vout}`)).isUtxo===!0}async getUtxoStatus(y,b,g,v){const _=this.getUtxoStatusServices;v&&_.next();let S={name:"<noservices>",status:"error",error:new e.sdk.WERR_INTERNAL("No services available."),details:[]};for(let I=0;I<2;I++){for(let A=0;A<_.count;A++){const R=_.serviceToCall;try{const E=await R.service(y,b,g);if(E.status==="success"){_.addServiceCallSuccess(R),S=E;break}else E.error?_.addServiceCallError(R,E.error):_.addServiceCallFailure(R)}catch(E){const k=e.sdk.WalletError.fromUnknown(E);_.addServiceCallError(R,k)}_.next()}if(S.status==="success")break;await(0,e.wait)(2e3)}return S}async getScriptHashHistory(y,b){const g=this.getScriptHashHistoryServices;b&&g.next();let v={name:"<noservices>",status:"error",error:new e.sdk.WERR_INTERNAL("No services available."),history:[]};for(let _=0;_<g.count;_++){const S=g.serviceToCall;try{const I=await S.service(y);if(I.status==="success"){v=I;break}else I.error?g.addServiceCallError(S,I.error):g.addServiceCallFailure(S)}catch(I){const A=e.sdk.WalletError.fromUnknown(I);g.addServiceCallError(S,A)}g.next()}return v}async postBeef(y,b){let g=[];const v=this.postBeefServices,_=v.allServicesToCall;switch(this.postBeefMode){case"UntilSuccess":for(const I of _){const A=await S(I);if(g.push(A),A.status==="success")break;A.txidResults&&A.txidResults.every(R=>R.serviceError)&&this.postBeefServices.moveServiceToLast(I)}break;case"PromiseAll":g=await Promise.all(_.map(async I=>await S(I)));break}return g;async function S(I){const A=await I.service(y,b);return A.status==="success"?v.addServiceCallSuccess(I):A.error?v.addServiceCallError(I,A.error):v.addServiceCallFailure(I),A}}async getRawTx(y,b){const g=this.getRawTxServices;b&&g.next();const v={txid:y};for(let _=0;_<g.count;_++){const S=g.serviceToCall;try{const I=await S.service(y,this.chain);if(I.rawTx){const A=(0,e.asString)((0,e.doubleSha256BE)(I.rawTx));if(A===(0,e.asString)(y)){v.rawTx=I.rawTx,v.name=I.name,v.error=void 0,g.addServiceCallSuccess(S);break}I.error=new e.sdk.WERR_INTERNAL(`computed txid ${A} doesn't match requested value ${y}`),I.rawTx=void 0}I.error?g.addServiceCallError(S,I.error):I.rawTx?g.addServiceCallFailure(S):g.addServiceCallSuccess(S,"not found"),I.error&&!v.error&&!v.rawTx&&(v.error=I.error)}catch(I){const A=e.sdk.WalletError.fromUnknown(I);g.addServiceCallError(S,A)}g.next()}return v}async invokeChaintracksWithRetry(y){if(!this.options.chaintracks)throw new e.sdk.WERR_INVALID_PARAMETER("options.chaintracks","valid for this service operation.");for(let b=0;b<3;b++)try{return await y()}catch(g){if(e.sdk.WalletError.fromUnknown(g).code!="ECONNRESET")throw g}throw new e.sdk.WERR_INVALID_OPERATION("hashToHeader service unavailable")}async getHeaderForHeight(y){const b=async()=>{const g=await this.options.chaintracks.findHeaderForHeight(y);if(!g)throw new e.sdk.WERR_INVALID_PARAMETER("hash",`valid height '${y}' on mined chain ${this.chain}`);return m(g)};return this.invokeChaintracksWithRetry(b)}async getHeight(){const y=async()=>await this.options.chaintracks.currentHeight();return this.invokeChaintracksWithRetry(y)}async hashToHeader(y){const b=async()=>{const g=await this.options.chaintracks.findHeaderForBlockHash(y);if(!g)throw new e.sdk.WERR_INVALID_PARAMETER("hash",`valid blockhash '${y}' on mined chain ${this.chain}`);return g};return this.invokeChaintracksWithRetry(b)}async getMerklePath(y,b){const g=this.getMerklePathServices;b&&g.next();const v={notes:[]};for(let _=0;_<g.count;_++){const S=g.serviceToCall;try{const I=await S.service(y,this);if(I.notes&&v.notes.push(...I.notes),v.name||(v.name=I.name),I.merklePath){v.merklePath=I.merklePath,v.header=I.header,v.name=I.name,v.error=void 0,g.addServiceCallSuccess(S);break}I.error?g.addServiceCallError(S,I.error):g.addServiceCallFailure(S),I.error&&!v.error&&(v.error=I.error)}catch(I){const A=e.sdk.WalletError.fromUnknown(I);g.addServiceCallError(S,A)}g.next()}return v}async updateFiatExchangeRates(y,b){b||(b=1e3*60*15);const g=new Date(Date.now()-b);if(y&&(b||(b=1e3*60*15),y.timestamp>g))return y;const v=this.updateFiatExchangeRateServices.clone();let _;for(let S=0;S<v.count;S++){const I=v.serviceToCall;try{const A=await I.service(this.targetCurrencies,this.options);if(this.targetCurrencies.every(R=>typeof A.rates[R]=="number")){v.addServiceCallSuccess(I),_=A;break}else v.addServiceCallFailure(I)}catch(A){const R=e.sdk.WalletError.fromUnknown(A);v.addServiceCallError(I,R)}v.next()}if(!_){if(console.error("Failed to update fiat exchange rates."),!y)throw new e.sdk.WERR_INTERNAL;return y}return _}async nLockTimeIsFinal(y){let v;if(typeof y=="number")v=y;else if(typeof y=="string"?y=i.Transaction.fromHex(y):Array.isArray(y)&&(y=i.Transaction.fromBinary(y)),y instanceof i.Transaction){if(y.inputs.every(S=>S.sequence===4294967295))return!0;v=y.lockTime}else throw new e.sdk.WERR_INTERNAL("Should be either @bsv/sdk Transaction or babbage-bsv Transaction");if(v>=5e8){const S=Math.floor(Date.now()/1e3);return v<S}const _=await this.getHeight();return v<_}async getBeefForTxid(y){return await(0,l.getBeefForTxid)(this,y)}};so.Services=h;function f(d,y){let b=(0,e.asArray)(d);switch(y||(b.length===32?y="hashLE":y="script"),y){case"hashBE":break;case"hashLE":b=b.reverse();break;case"script":b=(0,e.sha256Hash)(b).reverse();break;default:throw new e.sdk.WERR_INVALID_PARAMETER("outputFormat",`not be ${y}`)}return(0,e.asString)(b)}function m(d){const y=new i.Utils.Writer;return y.writeUInt32BE(d.version),y.writeReverse((0,e.asArray)(d.previousHash)),y.writeReverse((0,e.asArray)(d.merkleRoot)),y.writeUInt32BE(d.time),y.writeUInt32BE(d.bits),y.writeUInt32BE(d.nonce),y.toArray()}return so}var Od={},V3;function TL(){if(V3)return Od;V3=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.SimpleWalletManager=void 0;const i=Ye();let e=class{constructor(r,t,s){this.authenticated=!1,this.adminOriginator=r,this.walletBuilder=t,s&&this.loadSnapshot(s)}async providePrimaryKey(r){this.primaryKey=r,await this.tryBuildUnderlying()}async providePrivilegedKeyManager(r){this.underlyingPrivilegedKeyManager=r,await this.tryBuildUnderlying()}async tryBuildUnderlying(){if(this.authenticated)throw new Error("The user is already authenticated.");!this.primaryKey||!this.underlyingPrivilegedKeyManager||(this.underlying=await this.walletBuilder(this.primaryKey,this.underlyingPrivilegedKeyManager),this.authenticated=!0)}destroy(){this.underlying=void 0,this.underlyingPrivilegedKeyManager=void 0,this.authenticated=!1,this.primaryKey=void 0}saveSnapshot(){if(!this.primaryKey)throw new Error("No primary key is set; cannot save snapshot.");const r=(0,i.Random)(32),t=new i.Utils.Writer;t.writeUInt8(1),t.writeVarIntNum(this.primaryKey.length),t.write(this.primaryKey);const s=t.toArray(),a=new i.SymmetricKey(r).encrypt(s),c=new i.Utils.Writer;return c.write(r),c.write(a),c.toArray()}async loadSnapshot(r){try{const t=new i.Utils.Reader(r),s=t.read(32),a=t.read(),c=new i.SymmetricKey(s).decrypt(a),u=new i.Utils.Reader(c),l=u.readUInt8();if(l!==1)throw new Error(`Unsupported snapshot version: ${l}`);const h=u.readVarIntNum(),f=u.read(h);this.primaryKey=f,await this.tryBuildUnderlying()}catch(t){throw new Error(`Failed to load snapshot: ${t.message}`)}}async isAuthenticated(r,t){return this.ensureCanCall(t),{authenticated:!0}}async waitForAuthentication(r,t){if(t===this.adminOriginator)throw new Error("External applications cannot use the admin originator.");for(;!this.authenticated;)await new Promise(s=>setTimeout(s,100));return{authenticated:!0}}async getPublicKey(r,t){return this.ensureCanCall(t),this.underlying.getPublicKey(r,t)}async revealCounterpartyKeyLinkage(r,t){return this.ensureCanCall(t),this.underlying.revealCounterpartyKeyLinkage(r,t)}async revealSpecificKeyLinkage(r,t){return this.ensureCanCall(t),this.underlying.revealSpecificKeyLinkage(r,t)}async encrypt(r,t){return this.ensureCanCall(t),this.underlying.encrypt(r,t)}async decrypt(r,t){return this.ensureCanCall(t),this.underlying.decrypt(r,t)}async createHmac(r,t){return this.ensureCanCall(t),this.underlying.createHmac(r,t)}async verifyHmac(r,t){return this.ensureCanCall(t),this.underlying.verifyHmac(r,t)}async createSignature(r,t){return this.ensureCanCall(t),this.underlying.createSignature(r,t)}async verifySignature(r,t){return this.ensureCanCall(t),this.underlying.verifySignature(r,t)}async createAction(r,t){return this.ensureCanCall(t),this.underlying.createAction(r,t)}async signAction(r,t){return this.ensureCanCall(t),this.underlying.signAction(r,t)}async abortAction(r,t){return this.ensureCanCall(t),this.underlying.abortAction(r,t)}async listActions(r,t){return this.ensureCanCall(t),this.underlying.listActions(r,t)}async internalizeAction(r,t){return this.ensureCanCall(t),this.underlying.internalizeAction(r,t)}async listOutputs(r,t){return this.ensureCanCall(t),this.underlying.listOutputs(r,t)}async relinquishOutput(r,t){return this.ensureCanCall(t),this.underlying.relinquishOutput(r,t)}async acquireCertificate(r,t){return this.ensureCanCall(t),this.underlying.acquireCertificate(r,t)}async listCertificates(r,t){return this.ensureCanCall(t),this.underlying.listCertificates(r,t)}async proveCertificate(r,t){return this.ensureCanCall(t),this.underlying.proveCertificate(r,t)}async relinquishCertificate(r,t){return this.ensureCanCall(t),this.underlying.relinquishCertificate(r,t)}async discoverByIdentityKey(r,t){return this.ensureCanCall(t),this.underlying.discoverByIdentityKey(r,t)}async discoverByAttributes(r,t){return this.ensureCanCall(t),this.underlying.discoverByAttributes(r,t)}async getHeight(r,t){return this.ensureCanCall(t),this.underlying.getHeight({},t)}async getHeaderForHeight(r,t){return this.ensureCanCall(t),this.underlying.getHeaderForHeight(r,t)}async getNetwork(r,t){return this.ensureCanCall(t),this.underlying.getNetwork({},t)}async getVersion(r,t){return this.ensureCanCall(t),this.underlying.getVersion({},t)}ensureCanCall(r){if(r===this.adminOriginator)throw new Error("External applications cannot use the admin originator.");if(!this.authenticated)throw new Error("User is not authenticated.")}};return Od.SimpleWalletManager=e,Od}var fo={},sr={},K3;function kL(){if(K3)return sr;K3=1;var i=sr&&sr.__createBinding||(Object.create?function(c,u,l,h){h===void 0&&(h=l);var f=Object.getOwnPropertyDescriptor(u,l);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(c,h,f)}:function(c,u,l,h){h===void 0&&(h=l),c[h]=u[l]}),e=sr&&sr.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),n=sr&&sr.__importStar||function(){var c=function(u){return c=Object.getOwnPropertyNames||function(l){var h=[];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(h[h.length]=f);return h},c(u)};return function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var h=c(u),f=0;f<h.length;f++)h[f]!=="default"&&i(l,u,h[f]);return e(l,u),l}}();Object.defineProperty(sr,"__esModule",{value:!0}),sr.WalletStorageManager=void 0;const r=fn(),t=n(Jn());class s{constructor(u){this.storage=u,this.isStorageProvider=u.isStorageProvider(),this.isAvailable=!1}}let a=class{constructor(u,l,h){this._stores=[],this._isAvailable=!1,this.readerLocks=[],this.writerLocks=[],this.syncLocks=[],this.spLocks=[];const f=[...h||[]];l&&f.unshift(l),this._stores=f.map(m=>new s(m)),this._authId={identityKey:u}}isStorageProvider(){return!1}isAvailable(){return this._isAvailable}get isActiveEnabled(){return this._active!==void 0&&this._active.settings.storageIdentityKey===this._active.user.activeStorage&&this._conflictingActives!==void 0&&this._conflictingActives.length===0}canMakeAvailable(){return this._stores.length>0}async makeAvailable(){var u;if(this._isAvailable)return this._active.settings;if(this._active=void 0,this._backups=[],this._conflictingActives=[],this._stores.length<1)throw new t.WERR_INVALID_PARAMETER("active","valid. Must add active storage provider to wallet.");const l=[];for(const f of this._stores){if(!f.isAvailable||!f.settings||!f.user){f.settings=await f.storage.makeAvailable();const m=await f.storage.findOrInsertUser(this._authId.identityKey);f.user=m.user,f.isAvailable=!0}if(!this._active)this._active=f;else{const m=f.user.activeStorage,d=f.settings.storageIdentityKey;m===d&&!this.isActiveEnabled?(l.push(this._active),this._active=f):l.push(f)}}const h=(u=this._active.settings)===null||u===void 0?void 0:u.storageIdentityKey;for(const f of l)f.user.activeStorage!==h?this._conflictingActives.push(f):this._backups.push(f);return this._isAvailable=!0,this._authId.userId=this._active.user.userId,this._authId.isActive=this.isActiveEnabled,this._active.settings}verifyActive(){if(!this._active||!this._isAvailable)throw new t.WERR_INVALID_OPERATION("An active WalletStorageProvider must be added to this WalletStorageManager and makeAvailable must be called.");return this._active}async getAuth(u){if(this.isAvailable()||await this.makeAvailable(),u&&!this._authId.isActive)throw new t.WERR_NOT_ACTIVE;return this._authId}async getUserId(){return(await this.getAuth()).userId}getActive(){return this.verifyActive().storage}getActiveSettings(){return this.verifyActive().settings}getActiveUser(){return this.verifyActive().user}getActiveStore(){return this.verifyActive().settings.storageIdentityKey}getActiveStoreName(){return this.verifyActive().settings.storageName}getBackupStores(){return this.verifyActive(),this._backups.map(u=>u.settings.storageIdentityKey)}getConflictingStores(){return this.verifyActive(),this._conflictingActives.map(u=>u.settings.storageIdentityKey)}getAllStores(){return this.verifyActive(),this._stores.map(u=>u.settings.storageIdentityKey)}async getActiveLock(u){this.isAvailable()||await this.makeAvailable();let l=()=>{};const h=new Promise(f=>{l=f,u.push(f)});u.length===1&&l(),await h}releaseActiveLock(u){u.shift(),u.length>0&&u[0]()}async getActiveForReader(){return await this.getActiveLock(this.readerLocks),this.getActive()}releaseActiveForReader(){this.releaseActiveLock(this.readerLocks)}async getActiveForWriter(){return await this.getActiveLock(this.readerLocks),await this.getActiveLock(this.writerLocks),this.getActive()}releaseActiveForWriter(){this.releaseActiveLock(this.writerLocks),this.releaseActiveLock(this.readerLocks)}async getActiveForSync(){return await this.getActiveLock(this.readerLocks),await this.getActiveLock(this.writerLocks),await this.getActiveLock(this.syncLocks),this.getActive()}releaseActiveForSync(){this.releaseActiveLock(this.syncLocks),this.releaseActiveLock(this.writerLocks),this.releaseActiveLock(this.readerLocks)}async getActiveForStorageProvider(){await this.getActiveLock(this.readerLocks),await this.getActiveLock(this.writerLocks),await this.getActiveLock(this.syncLocks),await this.getActiveLock(this.spLocks);const u=this.getActive();if(!u.isStorageProvider())throw new t.WERR_INVALID_OPERATION('Active "WalletStorageProvider" does not support "StorageProvider" interface.');return u}releaseActiveForStorageProvider(){this.releaseActiveLock(this.spLocks),this.releaseActiveLock(this.syncLocks),this.releaseActiveLock(this.writerLocks),this.releaseActiveLock(this.readerLocks)}async runAsWriter(u){try{const l=await this.getActiveForWriter();return await u(l)}finally{this.releaseActiveForWriter()}}async runAsReader(u){try{const l=await this.getActiveForReader();return await u(l)}finally{this.releaseActiveForReader()}}async runAsSync(u,l){try{const h=l||await this.getActiveForSync();return await u(h)}finally{l||this.releaseActiveForSync()}}async runAsStorageProvider(u){try{const l=await this.getActiveForStorageProvider();return await u(l)}finally{this.releaseActiveForStorageProvider()}}isActiveStorageProvider(){return this.getActive().isStorageProvider()}async addWalletStorageProvider(u){await u.makeAvailable(),this._services&&u.setServices(this._services),this._stores.push(new s(u)),this._isAvailable=!1,await this.makeAvailable()}setServices(u){this._services=u;for(const l of this._stores)l.storage.setServices(u)}getServices(){if(!this._services)throw new t.WERR_INVALID_OPERATION("Must setServices first.");return this._services}getSettings(){return this.getActive().getSettings()}async migrate(u,l){return await this.runAsWriter(async h=>h.migrate(u,l))}async destroy(){if(!(this._stores.length<1))return await this.runAsWriter(async u=>{for(const l of this._stores)await l.storage.destroy()})}async findOrInsertUser(u){const l=await this.getAuth();if(u!=l.identityKey)throw new t.WERR_UNAUTHORIZED;return await this.runAsWriter(async h=>{const f=await h.findOrInsertUser(u);if(l.userId&&l.userId!==f.user.userId)throw new t.WERR_INTERNAL("userId may not change for given identityKey");return this._authId.userId=f.user.userId,f})}async abortAction(u){return t.validateAbortActionArgs(u),await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.abortAction(h,u)})}async createAction(u){return await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.createAction(h,u)})}async internalizeAction(u){return t.validateInternalizeActionArgs(u),await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.internalizeAction(h,u)})}async relinquishCertificate(u){return t.validateRelinquishCertificateArgs(u),await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.relinquishCertificate(h,u)})}async relinquishOutput(u){return t.validateRelinquishOutputArgs(u),await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.relinquishOutput(h,u)})}async processAction(u){return await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.processAction(h,u)})}async insertCertificate(u){return await this.runAsWriter(async l=>{const h=await this.getAuth(!0);return await l.insertCertificateAuth(h,u)})}async listActions(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.listActions(l,u))}async listCertificates(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.listCertificates(l,u))}async listOutputs(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.listOutputs(l,u))}async findCertificates(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.findCertificatesAuth(l,u))}async findOutputBaskets(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.findOutputBasketsAuth(l,u))}async findOutputs(u){const l=await this.getAuth();return await this.runAsReader(async h=>await h.findOutputsAuth(l,u))}async findProvenTxReqs(u){return await this.runAsReader(async l=>await l.findProvenTxReqs(u))}async syncFromReader(u,l,h,f=""){const m=await this.getAuth();if(u!==m.identityKey)throw new t.WERR_UNAUTHORIZED;const d=await l.makeAvailable();let y=0,b=0;return f=await this.runAsSync(async g=>{const v=g,_=this.getSettings();f+=`syncFromReader from ${d.storageName} to ${_.storageName}
`;let S=-1;for(;;){S++;const A=(await r.EntitySyncState.fromStorage(v,u,d)).makeRequestSyncChunkArgs(u,_.storageIdentityKey),R=await l.getSyncChunk(A);R.user&&(R.user.activeStorage=this._active.user.activeStorage);const E=await v.processSyncChunk(A,R);if(y+=E.inserts,b+=E.updates,f+=`chunk ${S} inserted ${E.inserts} updated ${E.updates} ${E.maxUpdated_at}
`,E.done)break}return f+=`syncFromReader complete: ${y} inserts, ${b} updates
`,f},h),{inserts:y,updates:b,log:f}}async syncToWriter(u,l,h,f="",m){m||(m=v=>v);const d=u.identityKey,y=await l.makeAvailable();let b=0,g=0;return f=await this.runAsSync(async v=>{const _=v,S=_.getSettings();f+=m(`syncToWriter from ${S.storageName} to ${y.storageName}
`);let I=-1;for(;;){I++;const R=(await r.EntitySyncState.fromStorage(l,d,S)).makeRequestSyncChunkArgs(d,y.storageIdentityKey),E=await _.getSyncChunk(R);f+=r.EntitySyncState.syncChunkSummary(E);const k=await l.processSyncChunk(R,E);if(b+=k.inserts,g+=k.updates,f+=m(`chunk ${I} inserted ${k.inserts} updated ${k.updates} ${k.maxUpdated_at}
`),k.done)break}return f+=m(`syncToWriter complete: ${b} inserts, ${g} updates
`),f},h),{inserts:b,updates:g,log:f}}async updateBackups(u,l){l||(l=f=>f);const h=await this.getAuth(!0);return await this.runAsSync(async f=>{let m=l(`BACKUP CURRENT ACTIVE TO ${this._backups.length} STORES
`);for(const d of this._backups){const y=await this.syncToWriter(h,d.storage,f,void 0,l);m+=y.log}return m},u)}async setActive(u,l){l||(l=y=>y),this.isAvailable()||await this.makeAvailable();const h=this._stores.findIndex(y=>y.settings.storageIdentityKey===u);if(h<0)throw new t.WERR_INVALID_PARAMETER("storageIdentityKey",`registered with this "WalletStorageManager". ${u} does not match any managed store.`);const f=(await this.getAuth()).identityKey,m=this._stores[h];let d=l(`setActive to ${m.settings.storageName}`);return u===this.getActiveStore()&&this.isActiveEnabled?d+l(` unchanged
`):(d+=l(`
`),d+=await this.runAsSync(async y=>{let b="";if(this._conflictingActives.length>0){this._conflictingActives.push(this._active),this._conflictingActives=this._conflictingActives.filter(v=>!(v.settings.storageIdentityKey===u));for(const v of this._conflictingActives){b+=l(`MERGING STATE FROM CONFLICTING ACTIVES:
`);const _=await this.syncToWriter({identityKey:f,userId:m.user.userId,isActive:!1},m.storage,v.storage,void 0,l);b+=_.log}b+=l(`PROPAGATE MERGED ACTIVE STATE TO NON-ACTIVES
`)}else b+=l(`BACKUP CURRENT ACTIVE STATE THEN SET NEW ACTIVE
`);const g=this._conflictingActives.length>0?m:this._active;await g.storage.setActive({identityKey:f,userId:g.user.userId},u);for(const v of this._stores)if(v.user.activeStorage=u,v.settings.storageIdentityKey!==g.settings.storageIdentityKey){const _=await this.syncToWriter({identityKey:f,userId:v.user.userId,isActive:!1},v.storage,g.storage,void 0,l);b+=_.log}return this._isAvailable=!1,await this.makeAvailable(),b}),d)}getStoreEndpointURL(u){if(u.storage.constructor.name==="StorageClient")return u.storage.endpointUrl}getStores(){const u=[];this._active&&u.push({isActive:!0,isEnabled:this.isActiveEnabled,isBackup:!1,isConflicting:!1,userId:this._active.user.userId,storageIdentityKey:this._active.settings.storageIdentityKey,storageName:this._active.settings.storageName,storageClass:this._active.storage.constructor.name,endpointURL:this.getStoreEndpointURL(this._active)});for(const l of this._conflictingActives||[])u.push({isActive:!0,isEnabled:!1,isBackup:!1,isConflicting:!0,userId:l.user.userId,storageIdentityKey:l.settings.storageIdentityKey,storageName:l.settings.storageName,storageClass:l.storage.constructor.name,endpointURL:this.getStoreEndpointURL(l)});for(const l of this._backups||[])u.push({isActive:!1,isEnabled:!1,isBackup:!0,isConflicting:!1,userId:l.user.userId,storageIdentityKey:l.settings.storageIdentityKey,storageName:l.settings.storageName,storageClass:l.storage.constructor.name,endpointURL:this.getStoreEndpointURL(l)});return u}};return sr.WalletStorageManager=a,sr}var or={},W3;function EL(){if(W3)return or;W3=1;var i=or&&or.__createBinding||(Object.create?function(s,a,c,u){u===void 0&&(u=c);var l=Object.getOwnPropertyDescriptor(a,c);(!l||("get"in l?!a.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,u,l)}:function(s,a,c,u){u===void 0&&(u=c),s[u]=a[c]}),e=or&&or.__setModuleDefault||(Object.create?function(s,a){Object.defineProperty(s,"default",{enumerable:!0,value:a})}:function(s,a){s.default=a}),n=or&&or.__importStar||function(){var s=function(a){return s=Object.getOwnPropertyNames||function(c){var u=[];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(u[u.length]=l);return u},s(a)};return function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var u=s(a),l=0;l<u.length;l++)u[l]!=="default"&&i(c,a,u[l]);return e(c,a),c}}();Object.defineProperty(or,"__esModule",{value:!0}),or.StorageSyncReader=void 0;const r=n(Jn());let t=class{constructor(a,c){this.auth=a,this.storage=c}async makeAvailable(){if(await this.storage.makeAvailable(),this.auth.userId===void 0){const a=await this.storage.findUserByIdentityKey(this.auth.identityKey);if(!a)throw new r.WERR_UNAUTHORIZED;this.auth.userId=a.userId}return this.storage.getSettings()}destroy(){return this.storage.destroy()}async getSyncChunk(a){if(this.auth.userId||await this.makeAvailable(),a.identityKey!==this.auth.identityKey)throw new r.WERR_UNAUTHORIZED;return await this.storage.getSyncChunk(a)}};return or.StorageSyncReader=t,or}var ho={},Lb={},$3;function OL(){return $3||($3=1,Object.defineProperty(Lb,"__esModule",{value:!0})),Lb}var Fb={},z3;function AL(){return z3||(z3=1,Object.defineProperty(Fb,"__esModule",{value:!0})),Fb}var Ub={},G3;function PL(){return G3||(G3=1,Object.defineProperty(Ub,"__esModule",{value:!0})),Ub}var Hb={},X3;function RL(){return X3||(X3=1,Object.defineProperty(Hb,"__esModule",{value:!0})),Hb}var qb={},Y3;function NL(){return Y3||(Y3=1,Object.defineProperty(qb,"__esModule",{value:!0})),qb}var jb={},Q3;function CL(){return Q3||(Q3=1,Object.defineProperty(jb,"__esModule",{value:!0})),jb}var Vb={},Z3;function ML(){return Z3||(Z3=1,Object.defineProperty(Vb,"__esModule",{value:!0})),Vb}var Ad={},J3;function BL(){return J3||(J3=1,Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.transactionColumnsWithoutRawTx=void 0,Ad.transactionColumnsWithoutRawTx=["created_at","updated_at","transactionId","userId","provenTxId","status","reference","isOutgoing","satoshis","version","lockTime","description","txid"]),Ad}var Kb={},e8;function DL(){return e8||(e8=1,Object.defineProperty(Kb,"__esModule",{value:!0})),Kb}var Pd={},t8;function LL(){return t8||(t8=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.outputColumnsWithoutLockingScript=void 0,Pd.outputColumnsWithoutLockingScript=["created_at","updated_at","outputId","userId","transactionId","basketId","spendable","change","vout","satoshis","providedBy","purpose","type","outputDescription","txid","senderIdentityKey","derivationPrefix","derivationSuffix","customInstructions","spentBy","sequenceNumber","spendingDescription","scriptLength","scriptOffset"]),Pd}var Wb={},n8;function FL(){return n8||(n8=1,Object.defineProperty(Wb,"__esModule",{value:!0})),Wb}var $b={},i8;function UL(){return i8||(i8=1,Object.defineProperty($b,"__esModule",{value:!0})),$b}var zb={},r8;function HL(){return r8||(r8=1,Object.defineProperty(zb,"__esModule",{value:!0})),zb}var Gb={},a8;function qL(){return a8||(a8=1,Object.defineProperty(Gb,"__esModule",{value:!0})),Gb}var Xb={},s8;function jL(){return s8||(s8=1,Object.defineProperty(Xb,"__esModule",{value:!0})),Xb}var Yb={},o8;function VL(){return o8||(o8=1,Object.defineProperty(Yb,"__esModule",{value:!0})),Yb}var c8;function KL(){return c8||(c8=1,function(i){var e=ho&&ho.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=ho&&ho.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(OL(),i),n(AL(),i),n(PL(),i),n(RL(),i),n(NL(),i),n(CL(),i),n(ML(),i),n(BL(),i),n(DL(),i),n(LL(),i),n(FL(),i),n(UL(),i),n(HL(),i),n(qL(),i),n(jL(),i),n(VL(),i)}(ho)),ho}var Rd={},u8;function WL(){if(u8)return Rd;u8=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.StorageClient=void 0;const i=Ye(),e=Ke();let n=class{constructor(t,s){this.nextId=1,this.authClient=new i.AuthFetch(t),this.endpointUrl=s}isStorageProvider(){return!1}async rpcCall(t,s){try{const a=this.nextId++,c={jsonrpc:"2.0",method:t,params:s,id:a};let u;try{u=await this.authClient.fetch(this.endpointUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})}catch(h){throw h}if(!u.ok)throw new Error(`WalletStorageClient rpcCall: network error ${u.status} ${u.statusText}`);const l=await u.json();if(l.error){const{code:h,message:f,data:m}=l.error,d=new Error(`RPC Error: ${f}`);throw d.code=h,d.data=m,d}return l.result}catch(a){throw a}}isAvailable(){return!!this.settings}getSettings(){if(!this.settings)throw new e.sdk.WERR_INVALID_OPERATION("call makeAvailable at least once before getSettings");return this.settings}async makeAvailable(){return this.settings||(this.settings=await this.rpcCall("makeAvailable",[])),this.settings}async destroy(){return this.rpcCall("destroy",[])}async migrate(t,s){return this.rpcCall("migrate",[t])}getServices(){throw new e.sdk.WERR_INVALID_OPERATION("getServices() not implemented in remote client. This method typically is not used remotely.")}setServices(t){}async internalizeAction(t,s){return this.rpcCall("internalizeAction",[t,s])}async createAction(t,s){return this.rpcCall("createAction",[t,s])}async processAction(t,s){return this.rpcCall("processAction",[t,s])}async abortAction(t,s){return this.rpcCall("abortAction",[t,s])}async findOrInsertUser(t){return this.rpcCall("findOrInsertUser",[t])}async findOrInsertSyncStateAuth(t,s,a){const c=await this.rpcCall("findOrInsertSyncStateAuth",[t,s,a]);return c.syncState=this.validateEntity(c.syncState,["when"]),c}async insertCertificateAuth(t,s){return await this.rpcCall("insertCertificateAuth",[t,s])}async listActions(t,s){return await this.rpcCall("listActions",[t,s])}async listOutputs(t,s){return await this.rpcCall("listOutputs",[t,s])}async listCertificates(t,s){return await this.rpcCall("listCertificates",[t,s])}async findCertificatesAuth(t,s){const a=await this.rpcCall("findCertificatesAuth",[t,s]);if(this.validateEntities(a),s.includeFields)for(const c of a)c.fields&&this.validateEntities(c.fields);return a}async findOutputBasketsAuth(t,s){const a=await this.rpcCall("findOutputBaskets",[t,s]);return this.validateEntities(a),a}async findOutputsAuth(t,s){const a=await this.rpcCall("findOutputsAuth",[t,s]);return this.validateEntities(a),a}async findProvenTxReqs(t){const s=await this.rpcCall("findProvenTxReqs",[t]);return this.validateEntities(s),s}async relinquishCertificate(t,s){return this.rpcCall("relinquishCertificate",[t,s])}async relinquishOutput(t,s){return this.rpcCall("relinquishOutput",[t,s])}async processSyncChunk(t,s){return await this.rpcCall("processSyncChunk",[t,s])}async getSyncChunk(t){const s=await this.rpcCall("getSyncChunk",[t]);return s.certificateFields&&(s.certificateFields=this.validateEntities(s.certificateFields)),s.certificates&&(s.certificates=this.validateEntities(s.certificates)),s.commissions&&(s.commissions=this.validateEntities(s.commissions)),s.outputBaskets&&(s.outputBaskets=this.validateEntities(s.outputBaskets)),s.outputTagMaps&&(s.outputTagMaps=this.validateEntities(s.outputTagMaps)),s.outputTags&&(s.outputTags=this.validateEntities(s.outputTags)),s.outputs&&(s.outputs=this.validateEntities(s.outputs)),s.provenTxReqs&&(s.provenTxReqs=this.validateEntities(s.provenTxReqs)),s.provenTxs&&(s.provenTxs=this.validateEntities(s.provenTxs)),s.transactions&&(s.transactions=this.validateEntities(s.transactions)),s.txLabelMaps&&(s.txLabelMaps=this.validateEntities(s.txLabelMaps)),s.txLabels&&(s.txLabels=this.validateEntities(s.txLabels)),s.user&&(s.user=this.validateEntity(s.user)),s}async updateProvenTxReqWithNewProvenTx(t){return await this.rpcCall("updateProvenTxReqWithNewProvenTx",[t])}async setActive(t,s){return this.rpcCall("setActive",[t,s])}validateDate(t){let s;return t instanceof Date?s=t:s=new Date(t),s}validateEntity(t,s){if(t.created_at=this.validateDate(t.created_at),t.updated_at=this.validateDate(t.updated_at),s)for(const a of s)t[a]&&(t[a]=this.validateDate(t[a]));for(const a of Object.keys(t)){const c=t[a];c===null?t[a]=void 0:c instanceof Uint8Array&&(t[a]=Array.from(c))}return t}validateEntities(t,s){for(let a=0;a<t.length;a++)t[a]=this.validateEntity(t[a],s);return t}};return Rd.StorageClient=n,Rd}var l8;function Bk(){return l8||(l8=1,function(i){var e=fo&&fo.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=fo&&fo.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(kL(),i),n(Ok(),i),n(Nw(),i),n(EL(),i),n(KL(),i),n(fn(),i),n(WL(),i)}(fo)),fo}var cr={},Op={},d8;function $L(){if(d8)return Op;d8=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.acquireDirectCertificate=i;async function i(e,n,r){var t;const s=new Date,a={certificateId:0,created_at:s,updated_at:s,userId:n.userId,type:r.type,subject:r.subject,verifier:r.keyringRevealer==="certifier"?r.certifier:r.keyringRevealer,serialNumber:r.serialNumber,certifier:r.certifier,revocationOutpoint:r.revocationOutpoint,signature:r.signature,fields:[],isDeleted:!1};for(const[u,l]of Object.entries(r.fields))(t=a.fields)===null||t===void 0||t.push({certificateId:0,created_at:s,updated_at:s,userId:n.userId,fieldName:u,fieldValue:l,masterKey:r.keyringForSubject[u]||""});return await e.storage.insertCertificate(a),{type:r.type,subject:r.subject,serialNumber:r.serialNumber,certifier:r.certifier,revocationOutpoint:r.revocationOutpoint,signature:r.signature,fields:r.fields}}return Op}var Ap={},f8;function zL(){if(f8)return Ap;f8=1,Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.proveCertificate=n;const i=Ye(),e=Ke();async function n(r,t,s){const a={partial:{type:s.type,serialNumber:s.serialNumber,certifier:s.certifier,subject:s.subject,revocationOutpoint:s.revocationOutpoint,signature:s.signature},certifiers:[],types:[],limit:2,offset:0,privileged:!1},c=await r.storage.listCertificates(a);if(c.certificates.length!=1)throw new e.sdk.WERR_INVALID_PARAMETER("args","a unique certificate match");const u=c.certificates[0];return{keyringForVerifier:await i.MasterCertificate.createKeyringForVerifier(r,u.certifier,s.verifier,u.fields,s.fieldsToReveal,u.keyring,u.serialNumber,s.privileged,s.privilegedReason)}}return Ap}var Yc={},Pp={},h8;function GL(){if(h8)return Pp;h8=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.buildSignableTransaction=r;const i=Ye(),e=Ke(),n=Bw();function r(t,s,a){var c;const u=a.getClientChangeKeyPair(),l=s.inputBEEF?i.Beef.fromBinary(s.inputBEEF):void 0,{inputs:h,outputs:f}=t,m=new i.Transaction(s.version,[],[],s.lockTime),d=Array(f.length);for(let S=0;S<f.length;S++){const I=f.findIndex(A=>A.vout===S);if(I<0)throw new e.sdk.WERR_INVALID_PARAMETER("output.vout",`sequential. ${S} is missing`);d[S]=I}for(let S=0;S<f.length;S++){const I=d[S],A=f[I];if(S!==A.vout)throw new e.sdk.WERR_INVALID_PARAMETER("output.vout",`equal to array index. ${A.vout} !== ${S}`);const R=A.providedBy==="storage"&&A.purpose==="change",E=R?(0,n.makeChangeLock)(A,t,s,u,a):(0,e.asBsvSdkScript)(A.lockingScript),k={satoshis:A.satoshis,lockingScript:E,change:R};m.addOutput(k)}if(f.length===0){const S={satoshis:0,lockingScript:i.Script.fromASM("OP_FALSE OP_RETURN 42"),change:!1};m.addOutput(S)}const y=[];for(const S of h){const I=S.vin!==void 0&&S.vin<s.inputs.length?s.inputs[S.vin]:void 0;y.push({argsInput:I,storageInput:S})}y.sort((S,I)=>S.storageInput.vin<I.storageInput.vin?-1:S.storageInput.vin===I.storageInput.vin?0:1);const b=[];let g=0;for(const{storageInput:S,argsInput:I}of y)if(I){const R=typeof I.unlockingScript=="string"?(0,e.asBsvSdkScript)(I.unlockingScript):new i.Script,E=s.isSignAction?(c=l==null?void 0:l.findTxid(I.outpoint.txid))===null||c===void 0?void 0:c.tx:void 0,k={sourceTXID:I.outpoint.txid,sourceOutputIndex:I.outpoint.vout,sourceTransaction:E,unlockingScript:R,sequence:I.sequenceNumber};m.addInput(k)}else{if(S.type!=="P2PKH")throw new e.sdk.WERR_INVALID_PARAMETER("type",`vin ${S.vin}, "${S.type}" is not a supported unlocking script type.`);b.push({vin:m.inputs.length,derivationPrefix:(0,e.verifyTruthy)(S.derivationPrefix),derivationSuffix:(0,e.verifyTruthy)(S.derivationSuffix),unlockerPubKey:S.senderIdentityKey,sourceSatoshis:S.sourceSatoshis,lockingScript:S.sourceLockingScript});const A={sourceTXID:S.sourceTxid,sourceOutputIndex:S.sourceVout,sourceTransaction:S.sourceTransaction?i.Transaction.fromBinary(S.sourceTransaction):void 0,unlockingScript:new i.Script,sequence:4294967295};m.addInput(A),g+=(0,e.verifyTruthy)(S.sourceSatoshis)}const v=f.filter(S=>S.purpose==="change").reduce((S,I)=>S+I.satoshis,0),_=g-v;return{tx:m,amount:_,pdi:b,log:""}}return Pp}var Nd={},p8;function Dk(){if(p8)return Nd;p8=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.completeSignedTransaction=r,Nd.verifyUnlockScripts=t;const i=Ye(),e=Ke(),n=Jn();async function r(s,a,c){for(const[u,l]of Object.entries(a)){const h=Number(u),f=s.args.inputs[h],m=s.tx.inputs[h];if(!f||!m||f.unlockingScript||!Number.isInteger(f.unlockingScriptLength))throw new e.sdk.WERR_INVALID_PARAMETER("args","spend does not correspond to prior input with valid unlockingScriptLength.");if(l.unlockingScript.length/2>f.unlockingScriptLength)throw new e.sdk.WERR_INVALID_PARAMETER("args",`spend unlockingScript length ${l.unlockingScript.length} exceeds expected length ${f.unlockingScriptLength}`);m.unlockingScript=(0,e.asBsvSdkScript)(l.unlockingScript),l.sequenceNumber!==void 0&&(m.sequence=l.sequenceNumber)}for(const u of s.pdi){const l=new e.ScriptTemplateBRC29({derivationPrefix:u.derivationPrefix,derivationSuffix:u.derivationSuffix,keyDeriver:c.keyDeriver}),h=c.getClientChangeKeyPair(),f=h.privateKey,m=u.unlockerPubKey||h.publicKey,d=u.sourceSatoshis,y=(0,e.asBsvSdkScript)(u.lockingScript),b=l.unlock(f,m,d,y),g=s.tx.inputs[u.vin];g.unlockingScriptTemplate=b}return await s.tx.sign(),s.tx}function t(s,a){var c,u,l,h;const f=(c=a.findTxid(s))===null||c===void 0?void 0:c.tx;if(!f)throw new n.WERR_INVALID_PARAMETER("txid",`contained in beef, txid ${s}`);for(let m=0;m<f.inputs.length;m++){const d=f.inputs[m];if(!d.sourceTXID)throw new n.WERR_INVALID_PARAMETER(`inputs[${m}].sourceTXID`,"valid");if(!d.unlockingScript)throw new n.WERR_INVALID_PARAMETER(`inputs[${m}].unlockingScript`,"valid");if(d.sourceTransaction=(u=a.findTxid(d.sourceTXID))===null||u===void 0?void 0:u.tx,!d.sourceTransaction)return}for(let m=0;m<f.inputs.length;m++){const d=f.inputs[m],y=d.sourceTransaction.outputs[d.sourceOutputIndex],b=f.inputs.filter((v,_)=>_!==m),g=new i.Spend({sourceTXID:d.sourceTXID,sourceOutputIndex:d.sourceOutputIndex,lockingScript:y.lockingScript,sourceSatoshis:(l=y.satoshis)!==null&&l!==void 0?l:0,transactionVersion:f.version,otherInputs:b,unlockingScript:d.unlockingScript,inputSequence:(h=d.sequence)!==null&&h!==void 0?h:0,inputIndex:m,outputs:f.outputs,lockTime:f.lockTime});try{if(!g.validate())throw new n.WERR_INVALID_PARAMETER(`inputs[${m}].unlockScript`,"valid")}catch(v){const _=n.WalletError.fromUnknown(v);throw new n.WERR_INVALID_PARAMETER(`inputs[${m}].unlockScript`,`valid. ${_.message}`)}}}return Nd}var y8;function Bw(){if(y8)return Yc;y8=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.createAction=t,Yc.makeChangeLock=u,Yc.processAction=h;const i=Ye();Ye();const e=Ke(),n=GL(),r=Dk();async function t(f,m,d){var y;const b={};let g;if(d.isNewTx){if(g=await s(f,d),d.isSignAction)return a(g,f,d);g.tx=await(0,r.completeSignedTransaction)(g,{},f),b.txid=g.tx.id("hex");const S=new i.Beef;g.dcr.inputBeef&&S.mergeBeef(g.dcr.inputBeef),S.mergeTransaction(g.tx),(0,r.verifyUnlockScripts)(b.txid,S),b.noSendChange=(y=g.dcr.noSendChangeOutputVouts)===null||y===void 0?void 0:y.map(I=>`${b.txid}.${I}`),d.options.returnTXIDOnly||(b.tx=S.toBinaryAtomic(b.txid))}const{sendWithResults:v,notDelayedResults:_}=await h(g,f,m,d);return b.sendWithResults=v,b.notDelayedResults=_,b}async function s(f,m){const d=l(m),y=await f.storage.createAction(d),b=y.reference,{tx:g,amount:v,pdi:_}=(0,n.buildSignableTransaction)(y,m,f);return{reference:b,dcr:y,args:m,amount:v,tx:g,pdi:_}}function a(f,m,d){var y;if(!f.dcr.inputBeef)throw new e.sdk.WERR_INTERNAL("prior.dcr.inputBeef must be valid");const b=f.tx.id("hex"),g={noSendChange:d.isNoSend?(y=f.dcr.noSendChangeOutputVouts)===null||y===void 0?void 0:y.map(v=>`${b}.${v}`):void 0,signableTransaction:{reference:f.dcr.reference,tx:c(f.tx,f.dcr.inputBeef)}};return m.pendingSignActions[g.signableTransaction.reference]=f,g}function c(f,m){const d=new i.Beef;for(const y of f.inputs){if(!y.sourceTransaction)throw new e.sdk.WERR_INTERNAL("Every signableTransaction input must have a sourceTransaction");d.mergeRawTx(y.sourceTransaction.toBinary())}return d.mergeRawTx(f.toBinary()),d.toBinaryAtomic(f.id("hex"))}function u(f,m,d,y,b){const g=m.derivationPrefix,v=(0,e.verifyTruthy)(f.derivationSuffix);return new e.ScriptTemplateBRC29({derivationPrefix:g,derivationSuffix:v,keyDeriver:b.keyDeriver}).lock(y.privateKey,y.publicKey)}function l(f){let m=f;if(!m.inputs.every(d=>d.unlockingScript===void 0)){m={...f,inputs:[]};for(const d of f.inputs){const y={...d,unlockingScriptLength:d.unlockingScript!==void 0?d.unlockingScript.length:d.unlockingScriptLength};delete y.unlockingScript,m.inputs.push(y)}}return m}async function h(f,m,d,y){const b={isNewTx:y.isNewTx,isSendWith:y.isSendWith,isNoSend:y.isNoSend,isDelayed:y.isDelayed,reference:f?f.reference:void 0,txid:f?f.tx.id("hex"):void 0,rawTx:f?f.tx.toBinary():void 0,sendWith:y.isSendWith?y.options.sendWith:[]};return await m.storage.processAction(b)}return Yc}var Rp={},g8;function XL(){if(g8)return Rp;g8=1,Object.defineProperty(Rp,"__esModule",{value:!0}),Rp.signAction=s;const i=Ye(),e=Ke(),n=Bw(),r=Jn(),t=Dk();async function s(c,u,l){const h=c.pendingSignActions[l.reference];if(!h)throw new e.sdk.WERR_NOT_IMPLEMENTED("recovery of out-of-session signAction reference data is not yet implemented.");if(!h.dcr.inputBeef)throw new e.sdk.WERR_INTERNAL("prior.dcr.inputBeef must be valid");const f=a(h.args,l);h.tx=await(0,t.completeSignedTransaction)(h,f.spends,c);const{sendWithResults:m,notDelayedResults:d}=await(0,n.processAction)(h,c,u,f),y=h.tx.id("hex"),b=i.Beef.fromBinary(h.dcr.inputBeef);return b.mergeTransaction(h.tx),(0,t.verifyUnlockScripts)(y,b),{txid:h.tx.id("hex"),tx:f.options.returnTXIDOnly?void 0:b.toBinaryAtomic(y),sendWithResults:m,notDelayedResults:d}}function a(c,u){const l=u.options||(u.options={});return l.acceptDelayedBroadcast===void 0&&(l.acceptDelayedBroadcast=c.options.acceptDelayedBroadcast),l.returnTXIDOnly===void 0&&(l.returnTXIDOnly=c.options.returnTXIDOnly),l.noSend===void 0&&(l.noSend=c.options.noSend),l.sendWith===void 0&&(l.sendWith=c.options.sendWith),(0,r.validateSignActionArgs)(u)}return Rp}var Np={},b8;function YL(){if(b8)return Np;b8=1,Object.defineProperty(Np,"__esModule",{value:!0}),Np.internalizeAction=n;const i=Ye(),e=Ke();async function n(r,t,s){const a=e.sdk.validateInternalizeActionArgs(s),{ab:c,tx:u,txid:l}=await d(),h=[2,"3241645161d8"];for(const y of a.outputs){if(y.outputIndex<0||y.outputIndex>=u.outputs.length)throw new e.sdk.WERR_INVALID_PARAMETER("outputIndex",`a valid output index in range 0 to ${u.outputs.length-1}`);switch(y.protocol){case"basket insertion":break;case"wallet payment":m(y);break;default:throw new e.sdk.WERR_INTERNAL(`unexpected protocol ${y.protocol}`)}}return await r.storage.internalizeAction(s);function m(y,b){const g=y.paymentRemittance,v=u.outputs[y.outputIndex];if(!g)throw new e.sdk.WERR_INVALID_PARAMETER("paymentRemitance",`valid for protocol ${y.protocol}`);const _=`${g.derivationPrefix} ${g.derivationSuffix}`,S=r.keyDeriver.derivePrivateKey(h,_,g.senderIdentityKey),I=new i.P2PKH().lock(S.toAddress());if(v.lockingScript.toHex()!==I.toHex())throw new e.sdk.WERR_INVALID_PARAMETER("paymentRemitance","locked by script conforming to BRC-29")}async function d(){const y=i.Beef.fromBinary(a.tx);if(!await y.verify(await r.getServices().getChainTracker(),!1)||!y.atomicTxid)throw console.log(`internalizeAction beef is invalid: ${y.toLogString()}`),new e.sdk.WERR_INVALID_PARAMETER("tx","valid AtomicBEEF");const g=y.atomicTxid,v=y.findTxid(g);if(!v)throw new e.sdk.WERR_INVALID_PARAMETER("tx",`valid AtomicBEEF with newest txid of ${g}`);const _=v.tx;return{ab:y,tx:_,txid:g}}}return Np}var Qb={},m8;function QL(){return m8||(m8=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.WalletSettingsManager=i.TESTNET_DEFAULT_SETTINGS=i.DEFAULT_SETTINGS=void 0;const e=Ye(),n="wallet settings";i.DEFAULT_SETTINGS={trustSettings:{trustLevel:2,trustedCertifiers:[{name:"Metanet Trust Services",description:"Registry for protocols, baskets, and certificates types",iconUrl:"https://bsvblockchain.org/favicon.ico",identityKey:"03daf815fe38f83da0ad83b5bedc520aa488aef5cbc93a93c67a7fe60406cbffe8",trust:4},{name:"SocialCert",description:"Certifies social media handles, phone numbers and emails",iconUrl:"https://socialcert.net/favicon.ico",trust:3,identityKey:"02cf6cdf466951d8dfc9e7c9367511d0007ed6fba35ed42d425cc412fd6cfd4a17"}]},theme:{mode:"dark"}};const r={"Babbage Trust Services":"03d0b36b5c98b000ec9ffed9a2cf005e279244edf6a19cf90545cdebe873162761",IdentiCert:"036dc48522aba1705afbb43df3c04dbd1da373b6154341a875bceaa2a3e7f21528",SocialCert:"02cf6cdf466951d8dfc9e7c9367511d0007ed6fba35ed42d425cc412fd6cfd4a17"};i.TESTNET_DEFAULT_SETTINGS={...i.DEFAULT_SETTINGS,trustSettings:{...i.DEFAULT_SETTINGS.trustSettings,trustedCertifiers:i.DEFAULT_SETTINGS.trustSettings.trustedCertifiers.map(s=>({...s,identityKey:r[s.name]||s.identityKey}))}};class t{constructor(a,c={defaultSettings:i.DEFAULT_SETTINGS}){this.wallet=a,this.config=c,this.kv=new e.LocalKVStore(a,n,!0)}async get(){return JSON.parse(await this.kv.get("settings",JSON.stringify(this.config.defaultSettings)))}async set(a){await this.kv.set("settings",JSON.stringify(a))}async delete(){await this.kv.remove("settings")}}i.WalletSettingsManager=t}(Qb)),Qb}var Zb={},w8;function ZL(){return w8||(w8=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.parseResults=i.queryOverlay=i.transformVerifiableCertificatesWithTrust=void 0;const e=Ye(),n=(s,a)=>{const c={},u={};a.forEach(h=>{const{subject:f,certifier:m}=h;if(!f||!m)return;if(!u[m]){const b=s.trustedCertifiers.find(g=>g.identityKey===m);if(!b)return;u[m]=b}const d={name:u[m].name,iconUrl:u[m].iconUrl||"",description:u[m].description,trust:u[m].trust},y={...h,signature:h.signature,decryptedFields:h.decryptedFields,publiclyRevealedKeyring:h.keyring,certifierInfo:d};c[f]||(c[f]={totalTrust:0,members:[]}),c[f].totalTrust+=d.trust,c[f].members.push(y)});const l=[];return Object.values(c).forEach(h=>{h.totalTrust>=s.trustLevel&&l.push(...h.members)}),l.sort((h,f)=>f.certifierInfo.trust-h.certifierInfo.trust),{totalCertificates:l.length,certificates:l}};i.transformVerifiableCertificatesWithTrust=n;const r=async(s,a)=>{const c=await a.query({service:"ls_identity",query:s});return await(0,i.parseResults)(c)};i.queryOverlay=r;const t=async s=>{if(s.type==="output-list"){const a=[];for(const c of s.outputs)try{const u=e.Transaction.fromBEEF(c.beef),l=e.PushDrop.decode(u.outputs[c.outputIndex].lockingScript),h=JSON.parse(e.Utils.toUTF8(l.fields[0])),f=new e.VerifiableCertificate(h.type,h.serialNumber,h.subject,h.certifier,h.revocationOutpoint,h.fields,h.keyring,h.signature),m=await f.decryptFields(new e.ProtoWallet("anyone"));await f.verify(),f.decryptedFields=m,a.push(f)}catch(u){console.error(u)}return a}return[]};i.parseResults=t}(Zb)),Zb}var v8;function JL(){if(v8)return cr;v8=1;var i=cr&&cr.__createBinding||(Object.create?function(R,E,k,P){P===void 0&&(P=k);var T=Object.getOwnPropertyDescriptor(E,k);(!T||("get"in T?!E.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return E[k]}}),Object.defineProperty(R,P,T)}:function(R,E,k,P){P===void 0&&(P=k),R[P]=E[k]}),e=cr&&cr.__setModuleDefault||(Object.create?function(R,E){Object.defineProperty(R,"default",{enumerable:!0,value:E})}:function(R,E){R.default=E}),n=cr&&cr.__importStar||function(){var R=function(E){return R=Object.getOwnPropertyNames||function(k){var P=[];for(var T in k)Object.prototype.hasOwnProperty.call(k,T)&&(P[P.length]=T);return P},R(E)};return function(E){if(E&&E.__esModule)return E;var k={};if(E!=null)for(var P=R(E),T=0;T<P.length;T++)P[T]!=="default"&&i(k,E,P[T]);return e(k,E),k}}();Object.defineProperty(cr,"__esModule",{value:!0}),cr.Wallet=void 0;const r=Ye(),t=n(Jn()),s=$L(),a=zL(),c=Bw(),u=XL(),l=YL(),h=QL(),f=ZL(),m=yk(),d=Jn(),y=Ma(),b=ck();function g(R){return R.isWalletSigner}let v=class{constructor(E,k,P,T){this.includeAllSourceTransactions=!0,this.autoKnownTxids=!1,this.returnTxidOnly=!1,this.randomVals=void 0;const M=g(E)?{chain:E.chain,keyDeriver:E.keyDeriver,storage:E.storage,services:k,monitor:P,privilegedKeyManager:T}:E;if(M.storage._authId.identityKey!=M.keyDeriver.identityKey)throw new t.WERR_INVALID_PARAMETER("storage",`authenticated as the same identityKey (${M.storage._authId.identityKey}) as the keyDeriver (${M.keyDeriver.identityKey}).`);this.settingsManager=M.settingsManager||new h.WalletSettingsManager(this),this.chain=M.chain,this.lookupResolver=M.lookupResolver||new r.LookupResolver({networkPreset:(0,y.toWalletNetwork)(this.chain)}),this.keyDeriver=M.keyDeriver,this.storage=M.storage,this.proto=new r.ProtoWallet(M.keyDeriver),this.services=M.services,this.monitor=M.monitor,this.privilegedKeyManager=M.privilegedKeyManager,this.identityKey=this.keyDeriver.identityKey,this.pendingSignActions={},this.userParty=`user ${this.getClientChangeKeyPair().publicKey}`,this.beef=new r.BeefParty([this.userParty]),this.trustSelf="known",this.services&&this.storage.setServices(this.services)}async destroy(){await this.storage.destroy(),this.privilegedKeyManager&&await this.privilegedKeyManager.destroyKey()}getClientChangeKeyPair(){return{privateKey:this.keyDeriver.rootKey.toString(),publicKey:this.keyDeriver.rootKey.toPublicKey().toString()}}async getIdentityKey(){return(await this.getPublicKey({identityKey:!0})).publicKey}getPublicKey(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.getPublicKey(E)}return this.proto.getPublicKey(E)}revealCounterpartyKeyLinkage(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.revealCounterpartyKeyLinkage(E)}return this.proto.revealCounterpartyKeyLinkage(E)}revealSpecificKeyLinkage(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.revealSpecificKeyLinkage(E)}return this.proto.revealSpecificKeyLinkage(E)}encrypt(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.encrypt(E)}return this.proto.encrypt(E)}decrypt(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.decrypt(E)}return this.proto.decrypt(E)}createHmac(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.createHmac(E)}return this.proto.createHmac(E)}verifyHmac(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.verifyHmac(E)}return this.proto.verifyHmac(E)}createSignature(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.createSignature(E)}return this.proto.createSignature(E)}verifySignature(E,k){if(E.privileged){if(!this.privilegedKeyManager)throw new Error("Privileged operations require the Wallet to be configured with a privileged key manager.");return this.privilegedKeyManager.verifySignature(E)}return this.proto.verifySignature(E)}getServices(){if(!this.services)throw new t.WERR_INVALID_PARAMETER("services","valid in constructor arguments to be retreived here.");return this.services}getKnownTxids(E){if(E)for(const T of E)this.beef.mergeTxidOnly(T);return this.beef.sortTxs().valid}getStorageIdentity(){const E=this.storage.getSettings();return{storageIdentityKey:E.storageIdentityKey,storageName:E.storageName}}validateAuthAndArgs(E,k){const P=k(E),T={identityKey:this.identityKey};return{vargs:P,auth:T}}async listActions(E,k){t.validateOriginator(k);const{vargs:P}=this.validateAuthAndArgs(E,t.validateListActionsArgs);return await this.storage.listActions(P)}get storageParty(){return`storage ${this.getStorageIdentity().storageIdentityKey}`}async listOutputs(E,k){t.validateOriginator(k);const{vargs:P}=this.validateAuthAndArgs(E,t.validateListOutputsArgs);this.autoKnownTxids&&!P.knownTxids&&(P.knownTxids=this.getKnownTxids());const T=await this.storage.listOutputs(P);return T.BEEF&&(this.beef.mergeBeefFromParty(this.storageParty,T.BEEF),T.BEEF=this.verifyReturnedTxidOnlyBEEF(T.BEEF)),T}async listCertificates(E,k){t.validateOriginator(k);const{vargs:P}=this.validateAuthAndArgs(E,t.validateListCertificatesArgs);return await this.storage.listCertificates(P)}async acquireCertificate(E,k){if(t.validateOriginator(k),E.acquisitionProtocol==="direct"){const{auth:P,vargs:T}=this.validateAuthAndArgs(E,t.validateAcquireDirectCertificateArgs);T.subject=(await this.getPublicKey({identityKey:!0,privileged:E.privileged,privilegedReason:E.privilegedReason})).publicKey;try{await new r.MasterCertificate(T.type,T.serialNumber,T.subject,T.certifier,T.revocationOutpoint,T.fields,T.keyringForSubject,T.signature).verify(),await r.MasterCertificate.decryptFields(this,T.keyringForSubject,T.fields,T.certifier,T.privileged,T.privilegedReason)}catch(C){const D=t.WalletError.fromUnknown(C);throw new t.WERR_INVALID_PARAMETER("args",`valid encrypted and signed certificate and keyring from revealer. ${D.name}: ${D.message}`)}return await(0,s.acquireDirectCertificate)(this,P,T)}if(E.acquisitionProtocol==="issuance"){const{auth:P,vargs:T}=this.validateAuthAndArgs(E,t.validateAcquireIssuanceCertificateArgs),M=await(0,r.createNonce)(this,T.certifier),C=new r.AuthFetch(this),{certificateFields:D,masterKeyring:F}=await r.MasterCertificate.createCertificateFields(this,T.certifier,T.fields),B=await C.fetch(`${T.certifierUrl}/signCertificate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientNonce:M,type:T.type,fields:D,masterKeyring:F})});if(B.headers.get("x-bsv-auth-identity-key")!==T.certifier)throw new Error(`Invalid certifier! Expected: ${T.certifier}, Received: ${B.headers.get("x-bsv-auth-identity-key")}`);const{certificate:L,serverNonce:q}=await B.json();if(!L)throw new Error("No certificate received from certifier!");if(!q)throw new Error("No serverNonce received from certifier!");const K=new r.Certificate(L.type,L.serialNumber,L.subject,L.certifier,L.revocationOutpoint,L.fields,L.signature);await(0,r.verifyNonce)(q,this,T.certifier);const{valid:$}=await this.verifyHmac({hmac:r.Utils.toArray(K.serialNumber,"base64"),data:r.Utils.toArray(M+q,"base64"),protocolID:[2,"certificate issuance"],keyID:q+M,counterparty:T.certifier});if(!$)throw new Error("Invalid serialNumber");if(K.type!==T.type)throw new Error(`Invalid certificate type! Expected: ${T.type}, Received: ${K.type}`);if(K.subject!==this.identityKey)throw new Error(`Invalid certificate subject! Expected: ${this.identityKey}, Received: ${K.subject}`);if(K.certifier!==T.certifier)throw new Error(`Invalid certifier! Expected: ${T.certifier}, Received: ${K.certifier}`);if(!K.revocationOutpoint)throw new Error("Invalid revocationOutpoint!");if(Object.keys(K.fields).length!==Object.keys(D).length)throw new Error("Fields mismatch! Objects have different numbers of keys.");for(const U of Object.keys(D)){if(!(U in K.fields))throw new Error(`Missing field: ${U} in certificate.fields`);if(K.fields[U]!==D[U])throw new Error(`Invalid field! Expected: ${D[U]}, Received: ${K.fields[U]}`)}return await K.verify(),await r.MasterCertificate.decryptFields(this,F,L.fields,T.certifier),await(0,s.acquireDirectCertificate)(this,P,{...L,keyringRevealer:"certifier",keyringForSubject:F,privileged:T.privileged})}throw new t.WERR_INVALID_PARAMETER("acquisitionProtocol",`valid.${E.acquisitionProtocol} is unrecognized.`)}async relinquishCertificate(E,k){return t.validateOriginator(k),this.validateAuthAndArgs(E,t.validateRelinquishCertificateArgs),await this.storage.relinquishCertificate(E),{relinquished:!0}}async proveCertificate(E,k){k=t.validateOriginator(k);const{auth:P,vargs:T}=this.validateAuthAndArgs(E,t.validateProveCertificateArgs);return await(0,a.proveCertificate)(this,P,T)}async discoverByIdentityKey(E,k){t.validateOriginator(k),this.validateAuthAndArgs(E,t.validateDiscoverByIdentityKeyArgs);const P=(await this.settingsManager.get()).trustSettings,T=await(0,f.queryOverlay)({identityKey:E.identityKey,certifiers:P.trustedCertifiers.map(M=>M.identityKey)},this.lookupResolver);return T?(0,f.transformVerifiableCertificatesWithTrust)(P,T):{totalCertificates:0,certificates:[]}}async discoverByAttributes(E,k){t.validateOriginator(k),this.validateAuthAndArgs(E,t.validateDiscoverByAttributesArgs);const P=(await this.settingsManager.get()).trustSettings,T=await(0,f.queryOverlay)({attributes:E.attributes,certifiers:P.trustedCertifiers.map(M=>M.identityKey)},this.lookupResolver);return T?(0,f.transformVerifiableCertificatesWithTrust)(P,T):{totalCertificates:0,certificates:[]}}verifyReturnedTxidOnly(E,k){if(this.returnTxidOnly)return E;const P=E.txs.filter(T=>T.isTxidOnly).map(T=>T.txid);for(const T of P){if(k&&k.indexOf(T)>=0)continue;E.findTxid(T);const M=this.beef.findAtomicTransaction(T);if(!M)throw new t.WERR_INTERNAL(`unable to merge txid ${T} into beef`);E.mergeTransaction(M)}for(const T of E.txs)if(!(k&&k.indexOf(T.txid)>=0)&&T.isTxidOnly)throw new t.WERR_INTERNAL(`remaining txidOnly ${T.txid} is not known`);return E}verifyReturnedTxidOnlyAtomicBEEF(E,k){if(this.returnTxidOnly)return E;const P=r.Beef.fromBinary(E);if(!P.atomicTxid)throw new t.WERR_INTERNAL;return this.verifyReturnedTxidOnly(P,k).toBinaryAtomic(P.atomicTxid)}verifyReturnedTxidOnlyBEEF(E){if(this.returnTxidOnly)return E;const k=r.Beef.fromBinary(E);return this.verifyReturnedTxidOnly(k).toBinary()}async createAction(E,k){var P,T;t.validateOriginator(k),E.options||(E.options={}),(T=E.options).trustSelf||(T.trustSelf=this.trustSelf),this.autoKnownTxids&&!E.options.knownTxids&&(E.options.knownTxids=this.getKnownTxids(E.options.knownTxids));const{auth:M,vargs:C}=this.validateAuthAndArgs(E,t.validateCreateActionArgs);C.labels.indexOf(d.specOpThrowReviewActions)>=0&&A(),C.includeAllSourceTransactions=this.includeAllSourceTransactions,this.randomVals&&this.randomVals.length>1&&(C.randomVals=[...this.randomVals]);const D=await(0,c.createAction)(this,M,C);return D.tx&&this.beef.mergeBeefFromParty(this.storageParty,D.tx),D.tx&&(D.tx=this.verifyReturnedTxidOnlyAtomicBEEF(D.tx,(P=E.options)===null||P===void 0?void 0:P.knownTxids)),C.isDelayed||_(D),D}async signAction(E,k){var P;t.validateOriginator(k);const{auth:T,vargs:M}=this.validateAuthAndArgs(E,t.validateSignActionArgs),C=await(0,u.signAction)(this,T,E);M.isDelayed||S(C);const D=this.pendingSignActions[E.reference];return C.tx&&(C.tx=this.verifyReturnedTxidOnlyAtomicBEEF(C.tx,(P=D.args.options)===null||P===void 0?void 0:P.knownTxids)),C}async internalizeAction(E,k){t.validateOriginator(k);const{auth:P,vargs:T}=this.validateAuthAndArgs(E,t.validateInternalizeActionArgs);T.labels.indexOf(d.specOpThrowReviewActions)>=0&&A();const M=await(0,l.internalizeAction)(this,P,E);return I(M),M}async abortAction(E,k){t.validateOriginator(k);const{auth:P}=this.validateAuthAndArgs(E,t.validateAbortActionArgs);return await this.storage.abortAction(E)}async relinquishOutput(E,k){t.validateOriginator(k);const{vargs:P}=this.validateAuthAndArgs(E,t.validateRelinquishOutputArgs);return await this.storage.relinquishOutput(E),{relinquished:!0}}async isAuthenticated(E,k){return t.validateOriginator(k),{authenticated:!0}}async waitForAuthentication(E,k){return t.validateOriginator(k),{authenticated:!0}}async getHeight(E,k){return t.validateOriginator(k),{height:await this.getServices().getHeight()}}async getHeaderForHeight(E,k){t.validateOriginator(k);const P=await this.getServices().getHeaderForHeight(E.height);return{header:r.Utils.toHex(P)}}async getNetwork(E,k){return t.validateOriginator(k),{network:(0,y.toWalletNetwork)(this.chain)}}async getVersion(E,k){return t.validateOriginator(k),{version:"wallet-brc100-1.0.0"}}async sweepTo(E){const k=(0,y.randomBytesBase64)(8),P=(0,y.randomBytesBase64)(8),T=this.keyDeriver,M=new b.ScriptTemplateBRC29({derivationPrefix:k,derivationSuffix:P,keyDeriver:T}),C="sweep",D=m.maxPossibleSatoshis,F=await this.createAction({outputs:[{lockingScript:M.lock(T.rootKey.toString(),E.identityKey).toHex(),satoshis:D,outputDescription:C,tags:["relinquish"],customInstructions:JSON.stringify({derivationPrefix:k,derivationSuffix:P,type:"BRC29"})}],options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1},labels:[C],description:C});await E.internalizeAction({tx:F.tx,outputs:[{outputIndex:0,protocol:"wallet payment",paymentRemittance:{derivationPrefix:k,derivationSuffix:P,senderIdentityKey:this.identityKey}}],description:C,labels:[C]})}async balanceAndUtxos(E="default"){const k={total:0,utxos:[]};let P=0;for(;;){const T=await this.listOutputs({basket:E,limit:1e3,offset:P});if(T.totalOutputs===0)break;for(const M of T.outputs)k.total+=M.satoshis,k.utxos.push({satoshis:M.satoshis,outpoint:M.outpoint});P+=T.outputs.length}return k}async balance(){const E={basket:d.specOpWalletBalance};return(await this.listOutputs(E)).totalOutputs}async reviewSpendableOutputs(E=!1,k=!1,P){const T={...P||{},basket:d.specOpInvalidChange};return T.tags||(T.tags=[]),E&&T.tags.push("all"),k&&T.tags.push("release"),await this.listOutputs(T)}async setWalletChangeParams(E,k){const P={basket:d.specOpSetWalletChangeParams,tags:[E.toString(),k.toString()]};await this.listOutputs(P)}async listNoSendActions(E,k=!1){const{vargs:P}=this.validateAuthAndArgs(E,t.validateListActionsArgs);return P.labels.push(d.specOpNoSendActions),k&&P.labels.push("abort"),await this.storage.listActions(P)}async listFailedActions(E,k=!1){const{vargs:P}=this.validateAuthAndArgs(E,t.validateListActionsArgs);return P.labels.push(d.specOpFailedActions),k&&P.labels.push("unfail"),await this.storage.listActions(P)}};cr.Wallet=v;function _(R){const E=R.notDelayedResults,k=R.sendWithResults;if(!(!E||!k||k.every(P=>P.status==="unproven")))throw new t.WERR_REVIEW_ACTIONS(E,k,R.txid,R.tx,R.noSendChange)}function S(R){const E=R.notDelayedResults,k=R.sendWithResults;if(!(!E||!k||k.every(P=>P.status==="unproven")))throw new t.WERR_REVIEW_ACTIONS(E,k,R.txid,R.tx)}function I(R){const E=R.notDelayedResults,k=R.sendWithResults;if(!(!E||!k||k.every(P=>P.status==="unproven")))throw new t.WERR_REVIEW_ACTIONS(E,k,R.txid)}function A(){const E=r.Beef.fromBinary(r.Utils.fromBase58("gno9MC7VXii1KoCkc2nsVyYJpqzN3dhBzYATETJcys62emMKfpBof4R7GozwYEaSapUtnNvqQ57aaYYjm3U2dv9eUJ1sV46boHkQgppYmAz9YH8FdZduV8aJayPViaKcyPmbDhEw6UW8TM5iFZLXNs7HBnJHUKCeTdNK4FUEL7vAugxAV9WUUZ43BZjJk2SmSeps9TCXjt1Ci9fKWp3d9QSoYvTpxwzyUFHjRKtbUgwq55ZfkBp5bV2Bpz9qSuKywKewW7Hh4S1nCUScwwzpKDozb3zic1V9p2k8rQxoPsRxjUJ8bjhNDdsN8d7KukFuc3n47fXzdWttvnxwsujLJRGnQbgJuknQqx3KLf5kJXHzwjG6TzigZk2t24qeB6d3hbYiaDr2fFkUJBL3tukTHhfNkQYRXuz3kucVDzvejHyqJaF51mXG8BjMN5aQj91ZJXCaPVqkMWCzmvyaqmXMdRiJdSAynhXbQK91xf6RwdNhz1tg5f9B6oJJMhsi9UYSVymmax8VLKD9AKzBCBDcfyD83m3jyS1VgKGZn3SkQmr6bsoWq88L3GsMnnmYUGogvdAYarTqg3pzkjCMxHzmJBMN6ofnUk8c1sRTXQue7BbyUaN5uZu3KW6CmFsEfpuqVvnqFW93TU1jrPP2S8yz8AexAnARPCKE8Yz7RfVaT6RCavwQKL3u5iookwRWEZXW1QWmM37yJWHD87SjVynyg327a1CLwcBxmE2CB48QeNVGyQki4CTQMqw2o8TMhDPJej1g68oniAjBcxBLSCs7KGvK3k7AfrHbCMULX9CTibYhCjdFjbsbBoocqJpxxcvkMo1fEEiAzZuiBVZQDYktDdTVbhKHvYkW25HcYX75NJrpNAhm7AjFeKLzEVxqAQkMfvTufpESNRZF4kQqg2Rg8h2ajcKTd5cpEPwXCrZLHm4EaZEmZVbg3QNfGhn7BJu1bHMtLqPD4y8eJxm2uGrW6saf6qKYmmu64F8A667NbD4yskPRQ1S863VzwGpxxmgLc1Ta3R46jEqsAoRDoZVUaCgBBZG3Yg1CTgi1EVBMXU7qvY4n3h8o2FLCEMWY4KadnV3iD4FbcdCmg4yxBosNAZgbPjhgGjCimjh4YsLd9zymGLmivmz2ZBg5m3xaiXT9NN81X9C1JUujd")),P=E.txs.slice(-1)[0].txid;debugger;throw new t.WERR_REVIEW_ACTIONS([{txid:P,status:"doubleSpend",competingTxs:[P],competingBeef:E.toBinary()}],[{txid:P,status:"failed"}],P,E.toBinaryAtomic(P),[`${P}.0`])}return cr}var ur={},po={},x8;function eF(){return x8||(x8=1,function(i){var e=po&&po.__createBinding||(Object.create?function(r,t,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(t,s);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(r,a,c)}:function(r,t,s,a){a===void 0&&(a=s),r[a]=t[s]}),n=po&&po.__exportStar||function(r,t){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&e(t,r,s)};Object.defineProperty(i,"__esModule",{value:!0}),n(Mk(),i)}(po)),po}var Cd={},Md={},_8;function yr(){if(_8)return Md;_8=1,Object.defineProperty(Md,"__esModule",{value:!0}),Md.WalletMonitorTask=void 0;let i=class{constructor(n,r){this.monitor=n,this.name=r,this.lastRunMsecsSinceEpoch=0,this.storage=n.storage}async asyncSetup(){}};return Md.WalletMonitorTask=i,Md}var S8;function tF(){if(S8)return Cd;S8=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.TaskPurge=void 0;const i=yr();let e=class jp extends i.WalletMonitorTask{constructor(r,t,s=0){super(r,jp.taskName),this.params=t,this.triggerMsecs=s}trigger(r){return{run:jp.checkNow||this.triggerMsecs>0&&r-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let r="";jp.checkNow=!1;const t=await this.storage.runAsStorageProvider(async s=>await s.purgeData(this.params));return t.count>0&&(r=`${t.count} records updated or deleted.
${t.log}`),r}};return Cd.TaskPurge=e,e.taskName="Purge",e.checkNow=!1,Cd}var Bd={},I8;function nF(){if(I8)return Bd;I8=1,Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.TaskReviewStatus=void 0;const i=yr();let e=class Lk extends i.WalletMonitorTask{constructor(r,t=1e3*60*15,s=1e3*60*5){super(r,Lk.taskName),this.triggerMsecs=t,this.agedMsecs=s}trigger(r){return{run:this.triggerMsecs>0&&r-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let r="";const t=new Date(Date.now()-this.agedMsecs),s=await this.storage.runAsStorageProvider(async a=>await a.reviewStatus({agedLimit:t}));return s.log.length>0&&(r+=`${s.log}`),r}};return Bd.TaskReviewStatus=e,e.taskName="ReviewStatus",e.checkNow=!1,Bd}var Dd={},T8;function iF(){if(T8)return Dd;T8=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.TaskSyncWhenIdle=void 0;const i=yr();let e=class Fk extends i.WalletMonitorTask{constructor(r,t=1e3*60*1){super(r,Fk.taskName),this.triggerMsecs=t}trigger(r){return this.storage,{run:!1}}async runTask(){return""}};return Dd.TaskSyncWhenIdle=e,e.taskName="SyncWhenIdle",Dd}var Ld={},k8;function rF(){if(k8)return Ld;k8=1,Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.TaskFailAbandoned=void 0;const i=yr();let e=class Uk extends i.WalletMonitorTask{constructor(r,t=1e3*60*5){super(r,Uk.taskName),this.triggerMsecs=t}trigger(r){return{run:r>this.lastRunMsecsSinceEpoch+this.triggerMsecs}}async runTask(){let r="",s=0;for(;;){const a=new Date,c=new Date(a.getTime()-this.monitor.options.abandonedMsecs);if(await this.storage.runAsStorageProvider(async l=>{const f=(await l.findTransactions({partial:{},status:["unprocessed","unsigned"],paged:{limit:100,offset:s}})).filter(m=>m.updated_at&&m.updated_at<c);for(const m of f)await l.updateTransactionStatus("failed",m.transactionId),r+=`updated tx ${m.transactionId} status to 'failed'
`;return f.length<100}))break;s+=100}return r}};return Ld.TaskFailAbandoned=e,e.taskName="FailAbandoned",Ld}var Qc={},E8;function Hk(){if(E8)return Qc;E8=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.TaskCheckForProofs=void 0,Qc.getProofs=s;const i=fn(),e=Ma(),n=lk(),r=yr();let t=class ef extends r.WalletMonitorTask{constructor(c,u=0){super(c,ef.taskName),this.triggerMsecs=u}trigger(c){return{run:ef.checkNow||this.triggerMsecs>0&&c-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){var c;let u="";const l=ef.checkNow;ef.checkNow=!1;const h=(c=this.monitor.lastNewHeader)===null||c===void 0?void 0:c.height;if(h===void 0)return u;const f=100;let m=0;for(;;){const d=await this.storage.findProvenTxReqs({partial:{},status:["callback","unmined","sending","unknown","unconfirmed"],paged:{limit:f,offset:m}});if(d.length===0)break;u+=`${d.length} reqs with status 'callback', 'unmined', 'sending', 'unknown', or 'unconfirmed'
`;const y=await s(this,d,2,l,!1,h);if(u+=`${y.log}
`,d.length<f)break;m+=f}return u}};Qc.TaskCheckForProofs=t,t.taskName="CheckForProofs",t.checkNow=!1;async function s(a,c,u=0,l=!1,h=!1,f){const m=[],d=[];let y="";for(const b of c){if(y+=" ".repeat(u),y+=`reqId ${b.provenTxReqId} txid ${b.txid}: `,!h&&b.status!=="callback"&&b.status!=="unmined"&&b.status!=="unknown"&&b.status!=="unconfirmed"&&b.status!=="nosend"&&b.status!=="sending"){y+=`status of '${b.status}' is not ready to be proven.
`;continue}const g=new i.EntityProvenTxReq(b);if(Number.isInteger(g.provenTxId)){y+=`Already linked to provenTxId ${g.provenTxId}.
`,g.notified=!1,g.status="completed",await g.updateStorageDynamicProperties(a.storage),m.push(b);continue}y+=`
`;let v=!1;if(g.rawTx&&(0,n.asString)((0,e.doubleSha256BE)(g.rawTx))===g.txid&&(v=!0),!v){y+=` rawTx doesn't hash to txid. status => invalid.
`,g.notified=!1,g.status="invalid",await g.updateStorageDynamicProperties(a.storage),d.push(b);continue}const _=a.monitor.chain==="main"?a.monitor.options.unprovenAttemptsLimitMain:a.monitor.options.unprovenAttemptsLimitTest;if(!h&&g.attempts>_){y+=` too many failed attempts ${g.attempts}
`,g.notified=!1,g.status="invalid",await g.updateStorageDynamicProperties(a.storage),d.push(b);continue}const S=new Date;let I,A;if(I=await a.monitor.services.getMerklePath(g.txid),I.header&&I.header.height>f){y+=` ignoring possible proof from very new block at height ${I.header.height} ${I.header.hash}
`;continue}if(A=await i.EntityProvenTx.fromReq(g,I,l&&g.status!=="nosend"),A){await g.updateStorageDynamicProperties(a.storage),await g.refreshFromStorage(a.storage);const{provenTxReqId:R,status:E,txid:k,attempts:P,history:T}=g.toApi(),{index:M,height:C,blockHash:D,merklePath:F,merkleRoot:B}=A.toApi(),L=await a.storage.runAsStorageProvider(async q=>await q.updateProvenTxReqWithNewProvenTx({provenTxReqId:R,status:E,txid:k,attempts:P,history:T,index:M,height:C,blockHash:D,merklePath:F,merkleRoot:B}));g.status=L.status,g.apiHistory=L.history,g.provenTxId=L.provenTxId,g.notified=!0}else l&&g.status!=="nosend"&&g.attempts++;await g.updateStorageDynamicProperties(a.storage),await g.refreshFromStorage(a.storage),y+=g.historyPretty(S,u+2)+`
`,g.status==="completed"&&m.push(g.api),g.status==="invalid"&&d.push(g.api)}return{proven:m,invalid:d,log:y}}return Qc}var Fd={},O8;function aF(){if(O8)return Fd;O8=1,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.TaskClock=void 0;const i=yr();let e=class qk extends i.WalletMonitorTask{constructor(r,t=1*r.oneSecond){super(r,qk.taskName),this.triggerMsecs=t,this.nextMinute=this.getNextMinute()}trigger(r){return this.storage,{run:Date.now()>this.nextMinute}}async runTask(){const r=`${new Date(this.nextMinute).toISOString()}`;return this.nextMinute=this.getNextMinute(),r}getNextMinute(){return Math.ceil(Date.now()/this.monitor.oneMinute)*this.monitor.oneMinute}};return Fd.TaskClock=e,e.taskName="Clock",Fd}var Ud={},A8;function sF(){if(A8)return Ud;A8=1,Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.TaskNewHeader=void 0;const i=yr();let e=class jk extends i.WalletMonitorTask{constructor(r,t=1*r.oneMinute){super(r,jk.taskName),this.triggerMsecs=t}async getHeader(){return await this.monitor.chaintracks.findChainTipHeader()}trigger(r){return{run:!0}}async runTask(){let r="";const t=this.header;this.header=await this.getHeader();let s=!0;if(!t)r=`first header: ${this.header.height} ${this.header.hash}`;else if(t.height<this.header.height){const a=this.header.height-t.height-1,c=a>0?` SKIPPED ${a}`:"";r=`new header: ${this.header.height} ${this.header.hash}${c}`}else t.height===this.header.height&&t.hash!=this.header.hash?r=`reorg header: ${this.header.height} ${this.header.hash}`:s=!1;return s?this.queuedHeader=this.header:this.queuedHeader&&(r=`process header: ${this.header.height} ${this.header.hash}`,this.monitor.processNewBlockHeader(this.queuedHeader),this.queuedHeader=void 0),r}};return Ud.TaskNewHeader=e,e.taskName="NewHeader",Ud}var Hd={},P8;function oF(){if(P8)return Hd;P8=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.TaskMonitorCallHistory=void 0;const i=yr();let e=class Vk extends i.WalletMonitorTask{constructor(r,t=r.oneMinute*12){super(r,Vk.taskName),this.triggerMsecs=t}trigger(r){return{run:r>this.lastRunMsecsSinceEpoch+this.triggerMsecs}}async runTask(){const r=await this.monitor.services.getServicesCallHistory(!0);return JSON.stringify(r)}};return Hd.TaskMonitorCallHistory=e,e.taskName="MonitorCallHistory",Hd}var qd={},R8;function cF(){if(R8)return qd;R8=1,Object.defineProperty(qd,"__esModule",{value:!0}),qd.TaskSendWaiting=void 0;const i=Bk(),e=Rw(),n=yr(),r=pk();let t=class Kk extends n.WalletMonitorTask{constructor(a,c=a.oneSecond*8,u=a.oneSecond*7,l=a.oneMinute*5){super(a,Kk.taskName),this.triggerMsecs=c,this.agedMsecs=u,this.sendingMsecs=l,this.includeSending=!0}trigger(a){return this.includeSending=!this.lastSendingRunMsecsSinceEpoch||a>this.lastSendingRunMsecsSinceEpoch+this.sendingMsecs,this.includeSending&&(this.lastSendingRunMsecsSinceEpoch=a),{run:a>this.lastRunMsecsSinceEpoch+this.triggerMsecs}}async runTask(){let a="",u=0;const l=new Date(Date.now()-this.agedMsecs),h=this.includeSending?["unsent","sending"]:["unsent"];for(;;){let f=await this.storage.findProvenTxReqs({partial:{},status:h,paged:{limit:100,offset:u}});const m=f.length;if(f.length===0)break;a+=`${f.length} reqs with status ${h.join(" or ")}
`;const d=f.filter(y=>(0,e.verifyTruthy)(y.updated_at)<l);if(a+=`  Of those reqs, ${d.length} where last updated before ${l.toISOString()}.
`,a+=await this.processUnsent(d,2),m<100)break;u+=100}return a}async processUnsent(a,c=0){let u="";for(let l=0;l<a.length;l++){const h=a[l];if(u+=" ".repeat(c),u+=`${l} reqId=${h.provenTxReqId} attempts=${h.attempts} txid=${h.txid}: 
`,h.status!=="unsent"&&h.status!=="sending"){u+=`  status now ${h.status}
`;continue}const f=new i.EntityProvenTxReq(h),m=[];if(f.batch){const y=await this.storage.findProvenTxReqs({partial:{batch:f.batch,status:"unsent"}});for(const b of y){const g=a.findIndex(v=>v.provenTxReqId===b.provenTxReqId);g>-1&&a.slice(g,g+1),m.push(new i.EntityProvenTxReq(b))}}else m.push(f);const d=await this.storage.runAsStorageProvider(async y=>(0,r.attemptToPostReqsToNetwork)(y,m));u+=d.log}return u}};return qd.TaskSendWaiting=t,t.taskName="SendWaiting",qd}var jd={},N8;function uF(){if(N8)return jd;N8=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.TaskCheckNoSends=void 0;const i=Hk(),e=yr();let n=class tf extends e.WalletMonitorTask{constructor(t,s=t.oneDay*1){super(t,tf.taskName),this.triggerMsecs=s}trigger(t){return{run:tf.checkNow||this.triggerMsecs>0&&t-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){var t;let s="";const a=tf.checkNow;tf.checkNow=!1;const c=(t=this.monitor.lastNewHeader)===null||t===void 0?void 0:t.height;if(c===void 0)return s;const u=100;let l=0;for(;;){const h=await this.storage.findProvenTxReqs({partial:{},status:["nosend"],paged:{limit:u,offset:l}});if(h.length===0)break;s+=`${h.length} reqs with status 'nosend'
`;const f=await(0,i.getProofs)(this,h,2,a,!1,c);if(s+=`${f.log}
`,h.length<u)break;l+=u}return s}};return jd.TaskCheckNoSends=n,n.taskName="CheckNoSends",n.checkNow=!1,jd}var Vd={},C8;function lF(){if(C8)return Vd;C8=1,Object.defineProperty(Vd,"__esModule",{value:!0}),Vd.TaskUnFail=void 0;const i=Ye(),e=yr(),n=fn();let r=class Vp extends e.WalletMonitorTask{constructor(s,a=s.oneMinute*10){super(s,Vp.taskName),this.triggerMsecs=a}trigger(s){return{run:Vp.checkNow||this.triggerMsecs>0&&s-this.lastRunMsecsSinceEpoch>this.triggerMsecs}}async runTask(){let s="";Vp.checkNow=!1;const a=100;let c=0;for(;;){const u=await this.storage.findProvenTxReqs({partial:{},status:["unfail"],paged:{limit:a,offset:c}});if(u.length===0)break;s+=`${u.length} reqs with status 'unfail'
`;const l=await this.unfail(u,2);if(s+=`${l.log}
`,u.length<a)break;c+=a}return s}async unfail(s,a=0){let c="";for(const u of s){const l=new n.EntityProvenTxReq(u);c+=" ".repeat(a),c+=`reqId ${u.provenTxReqId} txid ${u.txid}: `,(await this.monitor.services.getMerklePath(l.txid)).merklePath?(l.status="unmined",l.attempts=0,c+=`unfailed. status is now 'unmined'
`,c+=await this.unfailReq(l,a+2)):(l.status="invalid",c+=`returned to status 'invalid'
`),await l.updateStorageDynamicProperties(this.storage)}return{log:c}}async unfailReq(s,a){let c="";this.storage;const u=this.monitor.services,l=s.notify.transactionIds||[];for(const h of l){const f=i.Transaction.fromBinary(s.rawTx);await this.storage.runAsStorageProvider(async m=>{const d=m,y=await m.findTransactionById(h,void 0,!0);if(!y){c+=" ".repeat(a)+`transaction ${h} was not found
`;return}await m.updateTransaction(y.transactionId,{status:"unproven"}),y.status="unproven",c+=" ".repeat(a)+`transaction ${h} status is now 'unproven'
`;let b=-1;for(const v of f.inputs){b++;const _=await m.findOutputs({partial:{userId:y.userId,txid:v.sourceTXID,vout:v.sourceOutputIndex}});if(_.length!==1)c+=" ".repeat(a+2)+`input ${b} not matched to user's outputs
`;else{const S=_[0];c+=" ".repeat(a+2)+`input ${b} matched to output ${S.outputId} updated spentBy ${y.transactionId}
`,await m.updateOutput(S.outputId,{spendable:!1,spentBy:y.transactionId})}}const g=await m.findOutputs({partial:{userId:y.userId,transactionId:y.transactionId}});for(const v of g)if(await d.validateOutputScript(v),!v.lockingScript)c+=" ".repeat(a+2)+`output ${v.outputId} does not have a valid locking script
`;else{const _=await u.isUtxo(v);_!==v.spendable?(c+=" ".repeat(a+2)+`output ${v.outputId} set to ${_?"spendable":"spent"}
`,await m.updateOutput(v.outputId,{spendable:_})):c+=" ".repeat(a+2)+`output ${v.outputId} unchanged
`}})}return c}};return Vd.TaskUnFail=r,r.taskName="UnFail",r.checkNow=!1,Vd}var M8;function dF(){if(M8)return ur;M8=1;var i=ur&&ur.__createBinding||(Object.create?function(_,S,I,A){A===void 0&&(A=I);var R=Object.getOwnPropertyDescriptor(S,I);(!R||("get"in R?!S.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return S[I]}}),Object.defineProperty(_,A,R)}:function(_,S,I,A){A===void 0&&(A=I),_[A]=S[I]}),e=ur&&ur.__setModuleDefault||(Object.create?function(_,S){Object.defineProperty(_,"default",{enumerable:!0,value:S})}:function(_,S){_.default=S}),n=ur&&ur.__importStar||function(){var _=function(S){return _=Object.getOwnPropertyNames||function(I){var A=[];for(var R in I)Object.prototype.hasOwnProperty.call(I,R)&&(A[A.length]=R);return A},_(S)};return function(S){if(S&&S.__esModule)return S;var I={};if(S!=null)for(var A=_(S),R=0;R<A.length;R++)A[R]!=="default"&&i(I,S,A[R]);return e(I,S),I}}();Object.defineProperty(ur,"__esModule",{value:!0}),ur.Monitor=void 0;const r=n(Jn()),t=eF(),s=Ma(),a=tF(),c=nF(),u=iF(),l=rF(),h=Hk(),f=aF(),m=sF(),d=oF(),y=cF(),b=uF(),g=lF();let v=class{static createDefaultWalletMonitorOptions(S,I,A){if(A||(A=new t.Services(S)),!A.options.chaintracks)throw new r.WERR_INVALID_PARAMETER("services.options.chaintracks","valid");return{chain:S,services:A,storage:I,msecsWaitPerMerkleProofServiceReq:500,taskRunWaitMsecs:5e3,abandonedMsecs:1e3*60*5,unprovenAttemptsLimitTest:10,unprovenAttemptsLimitMain:144,chaintracks:A.options.chaintracks}}constructor(S){this.oneSecond=1e3,this.oneMinute=60*this.oneSecond,this.oneHour=60*this.oneMinute,this.oneDay=24*this.oneHour,this.oneWeek=7*this.oneDay,this._tasks=[],this._otherTasks=[],this._tasksRunning=!1,this.defaultPurgeParams={purgeSpent:!1,purgeCompleted:!1,purgeFailed:!0,purgeSpentAge:2*this.oneWeek,purgeCompletedAge:2*this.oneWeek,purgeFailedAge:5*this.oneDay},this._runAsyncSetup=!0,this.options={...S},this.services=S.services,this.chain=this.services.chain,this.storage=S.storage,this.chaintracks=S.chaintracks}addAllTasksToOther(){this._otherTasks.push(new f.TaskClock(this)),this._otherTasks.push(new m.TaskNewHeader(this)),this._otherTasks.push(new d.TaskMonitorCallHistory(this)),this._otherTasks.push(new a.TaskPurge(this,this.defaultPurgeParams)),this._otherTasks.push(new c.TaskReviewStatus(this)),this._otherTasks.push(new y.TaskSendWaiting(this)),this._otherTasks.push(new h.TaskCheckForProofs(this)),this._otherTasks.push(new b.TaskCheckNoSends(this)),this._otherTasks.push(new g.TaskUnFail(this)),this._otherTasks.push(new l.TaskFailAbandoned(this)),this._otherTasks.push(new u.TaskSyncWhenIdle(this))}addDefaultTasks(){this._tasks.push(new f.TaskClock(this)),this._tasks.push(new m.TaskNewHeader(this)),this._tasks.push(new d.TaskMonitorCallHistory(this)),this._tasks.push(new y.TaskSendWaiting(this,8*this.oneSecond,7*this.oneSecond)),this._tasks.push(new h.TaskCheckForProofs(this,2*this.oneHour)),this._tasks.push(new b.TaskCheckNoSends(this)),this._tasks.push(new l.TaskFailAbandoned(this,8*this.oneMinute)),this._tasks.push(new g.TaskUnFail(this)),this._tasks.push(new c.TaskReviewStatus(this))}addMultiUserTasks(){this._tasks.push(new f.TaskClock(this)),this._tasks.push(new m.TaskNewHeader(this)),this._tasks.push(new d.TaskMonitorCallHistory(this)),this._tasks.push(new y.TaskSendWaiting(this,8*this.oneSecond,7*this.oneSecond)),this._tasks.push(new h.TaskCheckForProofs(this,2*this.oneHour)),this._tasks.push(new b.TaskCheckNoSends(this)),this._tasks.push(new l.TaskFailAbandoned(this,8*this.oneMinute)),this._tasks.push(new g.TaskUnFail(this)),this._tasks.push(new c.TaskReviewStatus(this))}addTask(S){if(this._tasks.some(I=>I.name===S.name))throw new r.WERR_BAD_REQUEST(`task ${S.name} has already been added.`);this._tasks.push(S)}removeTask(S){this._tasks=this._tasks.filter(I=>I.name!==S)}async setupChaintracksListeners(){}async runTask(S){let I=this._tasks.find(R=>R.name===S),A="";return I||(I=this._otherTasks.find(R=>R.name===S)),I&&(await I.asyncSetup(),A=await I.runTask()),A}async runOnce(){if(this._runAsyncSetup){for(const S of this._tasks){try{await S.asyncSetup()}catch(I){const A=r.WalletError.fromUnknown(I),R=`monitor task ${S.name} asyncSetup error ${A.code} ${A.description}`;console.log(R),await this.logEvent("error0",R)}if(!this._tasksRunning)break}this._runAsyncSetup=!1}if(this.storage.getActive().isStorageProvider()){const S=[],I=new Date().getTime();for(const A of this._tasks)try{A.trigger(I).run&&S.push(A)}catch(R){const E=r.WalletError.fromUnknown(R),k=`monitor task ${A.name} trigger error ${E.code} ${E.description}`;console.log(k),await this.logEvent("error0",k)}for(const A of S)try{if(this.storage.getActive().isStorageProvider()){const R=await A.runTask();R&&R.length>0&&(console.log(`Task${A.name} ${R.slice(0,256)}`),await this.logEvent(A.name,R))}}catch(R){const E=r.WalletError.fromUnknown(R),k=`monitor task ${A.name} runTask error ${E.code} ${E.description}
${E.stack}`;console.log(k),await this.logEvent("error1",k)}finally{A.lastRunMsecsSinceEpoch=new Date().getTime()}}}async startTasks(){if(this._tasksRunning)throw new r.WERR_BAD_REQUEST("monitor tasks are already runnining.");for(this._tasksRunning=!0;this._tasksRunning;)await this.runOnce(),await(0,s.wait)(this.options.taskRunWaitMsecs)}async logEvent(S,I){await this.storage.runAsStorageProvider(async A=>{await A.insertMonitorEvent({created_at:new Date,updated_at:new Date,id:0,event:S,details:I})})}stopTasks(){this._tasksRunning=!1}processNewBlockHeader(S){const I=S;this.lastNewHeader=I,this.lastNewHeaderWhen=new Date,console.log(`WalletMonitor notified of new block header ${I.height}`),h.TaskCheckForProofs.checkNow=!0}processReorg(S,I,A){}};return ur.Monitor=v,ur}var B8;function Ke(){return B8||(B8=1,function(i){var e=Qi&&Qi.__createBinding||(Object.create?function(s,a,c,u){u===void 0&&(u=c);var l=Object.getOwnPropertyDescriptor(a,c);(!l||("get"in l?!a.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,u,l)}:function(s,a,c,u){u===void 0&&(u=c),s[u]=a[c]}),n=Qi&&Qi.__setModuleDefault||(Object.create?function(s,a){Object.defineProperty(s,"default",{enumerable:!0,value:a})}:function(s,a){s.default=a}),r=Qi&&Qi.__importStar||function(){var s=function(a){return s=Object.getOwnPropertyNames||function(c){var u=[];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(u[u.length]=l);return u},s(a)};return function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var u=s(a),l=0;l<u.length;l++)u[l]!=="default"&&e(c,a,u[l]);return n(c,a),c}}(),t=Qi&&Qi.__exportStar||function(s,a){for(var c in s)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,s,c)};Object.defineProperty(i,"__esModule",{value:!0}),i.sdk=void 0,i.sdk=r(Jn()),t(Rw(),i),t(nL(),i),t(iL(),i),t(rL(),i),t(aL(),i),t(Ak(),i),t(sL(),i),t(oL(),i),t(cL(),i),t(uL(),i),t(Cw(),i),t(Mk(),i),t(Pw(),i),t(TL(),i),t(Bk(),i),t(JL(),i),t(dF(),i)}(Qi)),Qi}var Cp=Ke();const Wk="8e89c83f7d7a4a3c4405c8f28d37e97823fcff024f289faf2941cb9bf448b7bd",$k="28476d98e1e742828967e4f51a3bb5050bdbf1df94c61613e74f9bd6e0e50cc7",zk="9b4cefabf5b8f918dd8bdb77f6748b65de9e6da1941fdcf9441fcec6dadf6e38",fF="https://storage.babbage.systems",hF=Lr.fromHex(Wk).toPublicKey().toString(),Dm=Lr.fromHex($k).toPublicKey().toString(),Gk=Lr.fromHex(zk).toPublicKey().toString(),pF=async()=>{const i=Lr.fromHex(Wk),e=new y6(i),n=new Cp.WalletStorageManager(e.identityKey),r="main",t=new Cp.Services(r),s=new Cp.Wallet({chain:r,keyDeriver:e,storage:n,services:t}),a=new Cp.StorageClient(s,fF);return await n.addWalletStorageProvider(a),await n.makeAvailable(),new iB(s)},Xk=i=>{let e;if(i==="patient")e=Lr.fromHex($k);else if(i==="pharmacy")e=Lr.fromHex(zk);else throw new Error("Unknown wallet owner");return new g6(e)},Yk=pF(),Qk=Xk("patient"),yF=Xk("pharmacy"),gF="gas-chain-db",bF=1,Hr="submissions",j0=()=>new Promise((i,e)=>{const n=indexedDB.open(gF,bF);n.onupgradeneeded=r=>{const t=r.target.result;if(!t.objectStoreNames.contains(Hr)){const s=t.createObjectStore(Hr,{keyPath:"txid"});s.createIndex("step","step",{unique:!1}),s.createIndex("timestamp","data.timestamp",{unique:!1})}},n.onsuccess=r=>{const t=r.target.result;i(t)},n.onerror=r=>{var t;console.error("IndexedDB error:",r.target.error),e(new Error(`IndexedDB error: ${((t=r.target.error)==null?void 0:t.message)??"Unknown error"}`))}}),V0=async i=>{try{const e=await j0(),n=e.transaction([Hr],"readwrite"),r=n.objectStore(Hr);return new Promise((t,s)=>{const a=r.put(i);a.onsuccess=()=>{t()},a.onerror=c=>{var u;console.error("Error saving submission:",c.target.error),s(new Error(`Error saving submission: ${((u=c.target.error)==null?void 0:u.message)??"Unknown error"}`))},n.oncomplete=()=>{e.close()}})}catch(e){throw console.error("Failed to save submission:",e),e}},D8=async()=>{try{const i=await j0(),e=i.transaction([Hr],"readonly"),n=e.objectStore(Hr);return new Promise((r,t)=>{const s=n.getAll();s.onsuccess=a=>{r(a.target.result)},s.onerror=a=>{var c;console.error("Error getting submissions:",a.target.error),t(new Error(`Error getting submissions: ${((c=a.target.error)==null?void 0:c.message)??"Unknown error"}`))},e.oncomplete=()=>{i.close()}})}catch(i){return console.error("Failed to get submissions:",i),[]}},Dw=async i=>{try{const e=await j0(),n=e.transaction([Hr],"readwrite"),r=n.objectStore(Hr),t=r.get(i);return new Promise((s,a)=>{t.onsuccess=c=>{const u=c.target.result;if(u){u.spent=!0;const l=r.put(u);l.onsuccess=()=>{s()},l.onerror=h=>{var f;console.error("Error updating submission:",h.target.error),a(new Error(`Error updating submission: ${((f=h.target.error)==null?void 0:f.message)??"Unknown error"}`))}}else a(new Error(`Submission with txid ${i} not found`))},t.onerror=c=>{var u;console.error("Error getting submission:",c.target.error),a(new Error(`Error getting submission: ${((u=c.target.error)==null?void 0:u.message)??"Unknown error"}`))},n.oncomplete=()=>{e.close()},n.onerror=c=>{var u;console.error("Transaction error:",c.target.error),a(new Error(`Transaction error: ${((u=c.target.error)==null?void 0:u.message)??"Unknown error"}`))}})}catch(e){throw console.error("Error in setSpent:",e),e}},mF=async()=>{try{const i=await j0(),e=i.transaction([Hr],"readwrite"),n=e.objectStore(Hr);return new Promise((r,t)=>{const s=n.clear();s.onsuccess=()=>{r()},s.onerror=a=>{var c;console.error("Error clearing submissions:",a.target.error),t(new Error(`Error clearing submissions: ${((c=a.target.error)==null?void 0:c.message)??"Unknown error"}`))},e.oncomplete=()=>{i.close()}})}catch(i){throw console.error("Failed to clear submissions:",i),i}},L8=[{paciente:{idPaciente:"P12345678",nombre:"Juan Pérez",fechaNacimiento:"1985-06-12"},prescriptor:{npiPrescriptor:"1234567890",nombre:"Dra. Sofía Rodríguez",clinica:"Centro Médico Buenos Aires"},medicamento:{nombreMedicamento:"Lisinopril",ndc:"12345-6789-01",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido por vía oral diariamente",fechaVencimiento:"2024-12-31"}},{paciente:{idPaciente:"P87654321",nombre:"Emilia Martínez",fechaNacimiento:"1992-03-25"},prescriptor:{npiPrescriptor:"0987654321",nombre:"Dr. Miguel Fernández",clinica:"Consultorios Médicos Palermo"},medicamento:{nombreMedicamento:"Atorvastatina",ndc:"98765-4321-02",dosis:"20mg",cantidad:90,recargas:3,instrucciones:"Tomar un comprimido por vía oral antes de acostarse",fechaVencimiento:"2025-01-15"}},{paciente:{idPaciente:"P24681357",nombre:"Roberto González",fechaNacimiento:"1978-11-30"},prescriptor:{npiPrescriptor:"2468135790",nombre:"Dra. Lucía Gómez",clinica:"Instituto Médico Recoleta"},medicamento:{nombreMedicamento:"Metformina",ndc:"24680-1357-03",dosis:"500mg",cantidad:60,recargas:5,instrucciones:"Tomar un comprimido dos veces al día con las comidas",fechaVencimiento:"2024-10-15"}},{paciente:{idPaciente:"P13579246",nombre:"Sara Torres",fechaNacimiento:"1985-07-12"},prescriptor:{npiPrescriptor:"1357924680",nombre:"Dr. Javier Sánchez",clinica:"Centro Médico San Telmo"},medicamento:{nombreMedicamento:"Lisinopril",ndc:"13579-2468-01",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido diariamente por la mañana",fechaVencimiento:"2024-12-20"}},{paciente:{idPaciente:"P97531086",nombre:"Diego López",fechaNacimiento:"1973-04-18"},prescriptor:{npiPrescriptor:"9753108642",nombre:"Dra. Jimena Castro",clinica:"Grupo Médico Belgrano"},medicamento:{nombreMedicamento:"Sertralina",ndc:"97531-0864-04",dosis:"50mg",cantidad:30,recargas:5,instrucciones:"Tomar un comprimido diariamente con o sin alimentos",fechaVencimiento:"2025-03-10"}},{paciente:{idPaciente:"P36925814",nombre:"Jessica Moreno",fechaNacimiento:"1990-09-05"},prescriptor:{npiPrescriptor:"3692581470",nombre:"Dr. Roberto Acosta",clinica:"Asociación Médica Caballito"},medicamento:{nombreMedicamento:"Levotiroxina",ndc:"36925-8147-02",dosis:"75mcg",cantidad:90,recargas:3,instrucciones:"Tomar un comprimido diariamente con el estómago vacío",fechaVencimiento:"2025-02-28"}},{paciente:{idPaciente:"P80246913",nombre:"Miguel Romero",fechaNacimiento:"1968-12-03"},prescriptor:{npiPrescriptor:"8024691357",nombre:"Dra. Sofía Rodríguez",clinica:"Clínica Valle Norte"},medicamento:{nombreMedicamento:"Amlodipina",ndc:"80246-9135-01",dosis:"5mg",cantidad:30,recargas:6,instrucciones:"Tomar un comprimido diariamente por la tarde",fechaVencimiento:"2024-11-15"}},{paciente:{idPaciente:"P15948732",nombre:"Ana Díaz",fechaNacimiento:"1982-05-20"},prescriptor:{npiPrescriptor:"1594873260",nombre:"Dr. Tomás Varela",clinica:"Centro Médico Puerto Madero"},medicamento:{nombreMedicamento:"Escitalopram",ndc:"15948-7326-03",dosis:"10mg",cantidad:30,recargas:2,instrucciones:"Tomar un comprimido diariamente a la misma hora cada día",fechaVencimiento:"2025-04-10"}}],Zk=Z.createContext({queue:[],addToQueue:()=>{},removeFromQueue:()=>{},clearQueue:()=>{},prescription:null,setPrescription:()=>{},presentation:null,setPresentation:()=>{},dispensation:null,setDispensation:()=>{},acknowledgement:null,setAcknowledgement:()=>{},isSubmitting:!1,setIsSubmitting:()=>{},isProcessing:""}),ku=()=>Z.useContext(Zk),wF=async i=>{try{const e=i.toBEEF(),n=await fetch("https://arc.gorillapool.io/v1/tx",{method:"POST",headers:{"Content-Type":"application/octet-stream",Accept:"application/json"},body:new Blob([new Uint8Array(e)])});if(!n.ok)throw new Error("Failed to broadcast transaction");return await n.json()}catch(e){throw console.error("Error broadcasting transaction:",e),e}},vF=({children:i})=>{const[e,n]=Z.useState([]),[r,t]=Z.useState(""),[s,a]=Z.useState(null),[c,u]=Z.useState(null),[l,h]=Z.useState(null),[f,m]=Z.useState(null),[d,y]=Z.useState(!1),b=S=>{n(I=>[...I,S])},g=Z.useCallback(async()=>{if(!(e.length===0||r))try{const S=e[0];t(S.txid);const I=Fr.fromBEEF(S.tx),A=await wF(I);if(console.log({response:A}),A.status===200&&S.data.estado==="creado"){const R=await Yk;await Promise.allSettled(I.inputs.map(async E=>{await R.relinquishOutput({basket:"default",output:S.txid+"."+E.sourceOutputIndex})}))}n(R=>R.slice(1))}catch(S){console.error("Error processing queue item:",S),n(I=>I.slice(1))}finally{t("")}},[e,r]);Z.useEffect(()=>{e.length>0&&!r&&g()},[e,r,g]);const v=S=>{n(I=>I.filter(A=>A.txid!==S))},_=()=>{n([])};return J.jsx(Zk.Provider,{value:{queue:e,addToQueue:b,removeFromQueue:v,clearQueue:_,prescription:s,setPrescription:a,presentation:c,setPresentation:u,dispensation:l,setDispensation:h,acknowledgement:f,setAcknowledgement:m,isSubmitting:d,setIsSubmitting:y,isProcessing:r},children:i})},xF=()=>{const{prescription:i,presentation:e,dispensation:n,acknowledgement:r,setPrescription:t,setIsSubmitting:s,addToQueue:a,isSubmitting:c}=ku(),u=i??e??n??r;function l(){const m=L8[Math.floor(Math.random()*L8.length)];return m.timestamp=new Date().toISOString(),m.id=Pa(Ra(8)),m}async function h(){try{if(c)return;const m=await Yk;s(!0);const d=new N0(m,"https://prescription-tokens.vercel.app"),y=l(),b=_e(JSON.stringify(y),"utf8"),g=Wi(b),v=await d.lock([g],[0,"medical prescription"],y.id,Dm,!1,!0,"after"),_=await m.createAction({outputs:[{lockingScript:v.toHex(),satoshis:3,outputDescription:"medical prescription issuance"}],description:"Create prescription",options:{randomizeOutputs:!1,acceptDelayedBroadcast:!1,noSend:!0}});console.log({action:_});const S={data:{...y,estado:"creado"},txid:_.txid,tx:_.tx,status:"created",spent:!1};t(S),a(S),await V0(S)}catch(m){console.error("Error creating prescription:",m)}finally{s(!1)}}const f=u?A0:O0;return J.jsx(S0,{sx:f,children:J.jsxs(I0,{disabled:!!u,onClick:h,children:[J.jsx(k0,{component:"img",image:"/prescription.png",alt:"Create Prescription",sx:E0}),J.jsxs(T0,{children:[J.jsx(Qt,{gutterBottom:!0,variant:"h5",component:"div",sx:{...P0,color:"#2c6e8e"},children:"Emisión de Receta Médica"}),J.jsx(Qt,{variant:"body1",color:"text.secondary",sx:R0,children:"El médico crea y firma la receta digital."})]})]})})},_F=()=>{const{addToQueue:i,prescription:e,setPrescription:n,setPresentation:r,setIsSubmitting:t,isSubmitting:s}=ku();async function a(){try{if(s)return;const u=Fr.fromBEEF(e.tx);t(!0);const l=new N0(Qk,"https://prescription-tokens.vercel.app"),h=e==null?void 0:e.data,f=_e(JSON.stringify(h),"utf8"),m=Wi(f),d=new Fr,y=l.unlock([0,"medical prescription"],h.id,hF,"all",!1);d.addInput({sourceTransaction:u,sourceOutputIndex:0,unlockingScriptTemplate:y});const b=new Date().toISOString(),g=await l.lock([_e("presentar "+b,"utf8"),m],[0,"medical prescription"],h.id,Gk,!1,!0,"after");d.addOutput({lockingScript:g,satoshis:2}),await d.sign();const v={data:{id:h.id,timestamp:b,status:"presentada"},txid:d.id("hex"),tx:d.toBEEF(),status:"presented",spent:!1};n(null),r(v),i(v),await V0(v),await Dw(e.txid)}catch(u){console.error("Error creating prescription:",u)}finally{t(!1)}}const c=e?O0:A0;return J.jsx(S0,{sx:c,children:J.jsxs(I0,{disabled:!e,onClick:a,children:[J.jsx(k0,{component:"img",image:"/present.png",alt:"Present Prescription",sx:E0}),J.jsxs(T0,{children:[J.jsx(Qt,{gutterBottom:!0,variant:"h5",component:"div",sx:{...P0,color:"#2c6e8e"},children:"Presentación de la Receta"}),J.jsx(Qt,{variant:"body1",color:"text.secondary",sx:R0,children:"El paciente presenta la receta al farmacéutico."})]})]})})},SF=()=>{const{addToQueue:i,presentation:e,setPresentation:n,setDispensation:r,setIsSubmitting:t,isSubmitting:s}=ku();async function a(){try{if(s)return;const u=Fr.fromBEEF(e.tx);t(!0);const l=new N0(yF,"https://prescription-tokens.vercel.app"),h=e.data.id,f=_e(h,"base64"),m=new Fr,d=l.unlock([0,"medical prescription"],h,Dm,"all",!1);m.addInput({sourceTransaction:u,sourceOutputIndex:0,unlockingScriptTemplate:d});const y=new Date().toISOString(),b=await l.lock([_e("dispensar "+y,"utf8"),f],[0,"medical prescription"],h,Dm,!1,!0,"after");m.addOutput({lockingScript:b,satoshis:1}),await m.sign();const g={data:{id:h,timestamp:y,status:"dispensar"},txid:m.id("hex"),tx:m.toBEEF(),status:"dispensed",spent:!1};n(null),r(g),i(g),await V0(g),await Dw(e.txid)}catch(u){console.error("Error creating prescription:",u)}finally{t(!1)}}const c=e?O0:A0;return J.jsx(S0,{sx:c,children:J.jsxs(I0,{onClick:a,disabled:!e,children:[J.jsx(k0,{component:"img",image:"/dispense.png",alt:"Dispense Prescription",sx:E0}),J.jsxs(T0,{children:[J.jsx(Qt,{gutterBottom:!0,variant:"h5",component:"div",sx:{...P0,color:"#2c6e8e"},children:"Dispensación del Medicamento"}),J.jsx(Qt,{variant:"body1",color:"text.secondary",sx:R0,children:"El farmacéutico certifica que el medicamento fue entregado."})]})]})})},IF=()=>{const{addToQueue:i,dispensation:e,setDispensation:n,setAcknowledgement:r,setIsSubmitting:t,isSubmitting:s}=ku();async function a(){try{if(s)return;const u=Fr.fromBEEF(e.tx);t(!0);const l=new N0(Qk,"https://prescription-tokens.vercel.app"),h=e.data.id,f=_e(h,"base64"),m=new Fr,d=l.unlock([0,"medical prescription"],h,Gk,"all",!1);m.addInput({sourceTransaction:u,sourceOutputIndex:0,unlockingScriptTemplate:d});const y=new Date().toISOString(),b=new To;b.writeOpCode(W.OP_FALSE),b.writeOpCode(W.OP_RETURN),b.writeBin(_e("recibido","utf8")),b.writeBin(f),m.addOutput({lockingScript:b,satoshis:0}),await m.sign();const g={data:{id:h,timestamp:y,status:"recibido"},txid:m.id("hex"),tx:m.toBEEF(),status:"acknowledged",spent:!0};n(null),r(g),i(g),await Dw(e.txid),await V0(g),console.log({tx:m.toHexBEEF()})}catch(u){console.error("Error creating prescription:",u)}finally{t(!1)}}const c=e?O0:A0;return J.jsx(S0,{sx:c,children:J.jsxs(I0,{disabled:!e,onClick:a,children:[J.jsx(k0,{component:"img",image:"/acknowledge.png",alt:"Acknowledge Receipt",sx:E0}),J.jsxs(T0,{children:[J.jsx(Qt,{gutterBottom:!0,variant:"h5",component:"div",sx:{...P0,color:"#2c6e8e"},children:"Confirmación de Recepción"}),J.jsx(Qt,{variant:"body1",color:"text.secondary",sx:R0,children:"El paciente confirma que recibió el medicamento."})]})]})})},Jk=Na(J.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),TF=Na(J.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),eE=Na(J.jsx("path",{d:"M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4z"})),tE=Na(J.jsx("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"})),kF=Na(J.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Mp=({entry:i})=>{const[e,n]=Z.useState(null),[r,t]=Z.useState(null),s=bs(),a=async()=>{if(!(i!=null&&i.txid))return;const h=await(await fetch("https://arc.gorillapool.io/v1/tx/"+i.txid)).json();n(h)},c=(h,f)=>{navigator.clipboard.writeText(h),t(f),setTimeout(()=>t(null),2e3)},u=(h,f="")=>{const m={};for(const d in h)typeof h[d]=="object"&&h[d]!==null?Object.assign(m,u(h[d],f+(f?".":"")+d)):m[f+(f?".":"")+d]=h[d];return m},l=i?u(i.data):null;return i?J.jsxs(Sf,{elevation:3,onClick:a,sx:{flex:1,overflow:"hidden",position:"relative",borderRadius:3,p:3,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",borderLeft:`4px solid ${i!=null&&i.txid?s.palette.primary.main:s.palette.grey[400]}`,transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(0,0,0,0.08)"}},children:[J.jsxs(ht,{sx:{display:"flex",alignItems:"center",mb:2},children:[J.jsx(eE,{sx:{mr:1.5,color:s.palette.primary.main}}),J.jsx(Qt,{variant:"h6",sx:{color:s.palette.primary.main,fontWeight:600},children:"Registro de Receta"}),J.jsx(ht,{sx:{flexGrow:1}}),J.jsx(So,{title:"Actualizar estado",children:J.jsx(ou,{size:"small",onClick:h=>{h.stopPropagation(),a()},"aria-label":"refresh",sx:{color:s.palette.primary.light,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:J.jsx(TF,{fontSize:"small"})})})]}),J.jsx(Jp,{sx:{mb:2}}),l&&J.jsxs(ht,{sx:{display:"flex",flexDirection:"column"},children:[Object.keys(l).map(h=>J.jsxs(ht,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:1,"&:hover":{backgroundColor:"rgba(248, 251, 253, 0.8)"}},children:[J.jsx(Qt,{variant:"subtitle2",sx:{color:s.palette.primary.main,fontWeight:600,mr:2,fontSize:"0.85rem"},children:h}),J.jsx(ht,{sx:{display:"flex",alignItems:"center"},children:J.jsx(Qt,{variant:"body2",sx:{color:s.palette.text.primary,fontSize:"0.85rem"},children:l[h]})})]},h)),i.txid&&J.jsxs(ht,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,mt:1,borderRadius:1,backgroundColor:"rgba(44, 110, 142, 0.05)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.1)"}},children:[J.jsx(Qt,{variant:"subtitle2",sx:{color:s.palette.primary.main,fontWeight:600,fontSize:"0.85rem"},children:"txid"}),J.jsxs(ht,{sx:{display:"flex",alignItems:"center",maxWidth:"70%"},children:[J.jsx(Qt,{variant:"body2",sx:{color:s.palette.text.primary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:i.txid}),J.jsx(So,{title:r==="txid"?"¡Copiado!":"Copiar al portapapeles",children:J.jsx(ou,{size:"small",onClick:h=>{h.stopPropagation(),c(i.txid||"","txid")},sx:{ml:1,color:r==="txid"?s.palette.success.main:s.palette.grey[400],padding:"2px"},children:r==="txid"?J.jsx(tE,{fontSize:"small"}):J.jsx(kF,{fontSize:"small"})})})]})]})]}),e&&J.jsxs(ht,{sx:{mt:3},children:[J.jsx(Jp,{sx:{mb:2}}),J.jsxs(ht,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[J.jsx(Qt,{variant:"subtitle2",sx:{color:s.palette.primary.main,fontWeight:600},children:"Verificación en Blockchain"}),J.jsx(gm,{label:e!=null&&e.txStatus?e==null?void 0:e.txStatus:"Pendiente",size:"small",color:e!=null&&e.txStatus?"success":"warning",variant:"outlined",sx:{fontWeight:500}})]})]}),(i==null?void 0:i.txid)&&J.jsx(ht,{sx:{display:"flex",justifyContent:"flex-end",mt:2,pt:2,borderTop:`1px dashed ${s.palette.divider}`},children:J.jsx(So,{title:"Ver en Whatsonchain",children:J.jsx(ou,{onClick:h=>{h.stopPropagation(),window.open(`https://whatsonchain.com/tx/${i.txid}`,"_blank")},sx:{color:s.palette.primary.light,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:J.jsx(Jk,{})})})})]}):J.jsx(ht,{sx:{flex:1,height:200,border:"1px dashed rgba(44, 110, 142, 0.25)",borderRadius:3,p:3,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(248, 251, 253, 0.6)",backdropFilter:"blur(4px)",transition:"all 0.3s ease"},children:J.jsx(Qt,{variant:"body1",color:"text.secondary",sx:{fontStyle:"italic"},children:"Aún no hay datos para mostrar"})})},EF=Na(J.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),OF=Na(J.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),AF=Na(J.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),PF=()=>{const{isSubmitting:i,setPrescription:e,setPresentation:n,setDispensation:r,setAcknowledgement:t}=ku(),[s,a]=Z.useState([]),[c,u]=Z.useState(!1),l=bs();Z.useEffect(()=>{i||D8().then(d=>{a(d),d.forEach(y=>{if(!y.spent)switch(y.status){case"created":e(y);break;case"presented":n(y);break;case"dispensed":r(y);break;case"acknowledged":t(y);break;default:console.log({unknownToken:y})}})})},[i,D8]);const h=async()=>{await mF(),window.location.reload()};if(!s||s.length===0)return null;const f=d=>{switch(d){case"created":return l.palette.info.main;case"presented":return l.palette.warning.main;case"dispensed":return l.palette.success.main;case"acknowledged":return l.palette.primary.dark;default:return l.palette.grey[500]}},m=d=>{switch(d){case"created":return"Creada";case"presented":return"Presentada";case"dispensed":return"Dispensada";case"acknowledged":return"Confirmada";default:return d.charAt(0).toUpperCase()+d.slice(1)}};return J.jsxs(UC,{anchor:"bottom",open:!0,variant:"persistent",sx:{"& .MuiDrawer-paper":{height:c?"64px":"auto",maxHeight:c?"64px":"35vh",overflowY:"auto",backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderTop:`3px solid ${l.palette.primary.main}`,boxShadow:"0px -4px 20px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease"}},children:[J.jsx(ht,{sx:{position:"sticky",top:0,backgroundColor:"rgba(255, 255, 255, 0.97)",backdropFilter:"blur(10px)",zIndex:1,borderBottom:c?"none":`1px solid ${l.palette.divider}`},children:J.jsxs(ht,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2},children:[J.jsxs(ht,{sx:{display:"flex",alignItems:"center"},children:[J.jsx(eE,{sx:{mr:1.5,color:l.palette.primary.main}}),J.jsx(Qt,{variant:"h6",sx:{color:l.palette.primary.main,fontWeight:600},children:"Registros de Recetas en Blockchain"})]}),J.jsxs(ht,{sx:{display:"flex",gap:3},children:[!c&&J.jsx(So,{title:"Borrar todos los registros",children:J.jsx(ou,{onClick:h,sx:{color:"white",backgroundColor:l.palette.secondary.main,borderRadius:"50%","&:hover":{backgroundColor:l.palette.secondary.dark,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},transition:"all 0.2s ease"},children:J.jsx(AF,{})})}),J.jsx(So,{title:c?"Expandir":"Minimizar",children:J.jsx(ou,{onClick:()=>u(!c),sx:{color:l.palette.primary.main,backgroundColor:"rgba(44, 110, 142, 0.08)","&:hover":{backgroundColor:"rgba(44, 110, 142, 0.15)"}},children:c?J.jsx(EF,{}):J.jsx(OF,{})})})]})]})}),!c&&J.jsxs(Sf,{sx:{p:{xs:2,md:3},mx:{xs:1,md:2},my:2,maxHeight:"calc(35vh - 70px)",overflowY:"auto",boxShadow:"none",backgroundColor:"transparent","::-webkit-scrollbar":{width:"8px"},"::-webkit-scrollbar-track":{background:"rgba(0, 0, 0, 0.05)",borderRadius:"8px"},"::-webkit-scrollbar-thumb":{background:"rgba(44, 110, 142, 0.2)",borderRadius:"8px"},"::-webkit-scrollbar-thumb:hover":{background:"rgba(44, 110, 142, 0.4)"}},children:[J.jsx(ht,{sx:{mb:2},children:J.jsx(Qt,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic",mb:2},children:"Historial completo de transacciones registradas en el blockchain"})}),s.slice().sort((d,y)=>new Date(y.data.timestamp||0).getTime()-new Date(d.data.timestamp||0).getTime()).map(d=>{var b,g;const y=(d==null?void 0:d.status)??((b=d==null?void 0:d.data)==null?void 0:b.status);return J.jsxs(zC,{sx:{py:1.5,px:2,mb:1.5,borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.7)",border:"1px solid rgba(0, 0, 0, 0.05)",transition:"all 0.2s ease","&:hover":{backgroundColor:"rgba(248, 251, 253, 1)",transform:"translateY(-1px)",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"}},direction:"row",spacing:2,alignItems:"center",className:"log-entry",children:[((g=d.data)==null?void 0:g.timestamp)&&J.jsx(ht,{sx:{minWidth:"110px"},children:J.jsx(Qt,{variant:"caption",sx:{color:l.palette.text.secondary,fontSize:"0.75rem",whiteSpace:"nowrap"},children:new Date(d.data.timestamp).toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})})}),J.jsxs(ht,{sx:{display:"flex",gap:1,minWidth:"100px"},children:[J.jsx(gm,{label:m(y),size:"small",sx:{backgroundColor:`${f(y)}20`,color:f(y),fontWeight:600,borderRadius:"4px"}}),(d==null?void 0:d.spent)&&J.jsx(gm,{label:"Gastada",size:"small",sx:{backgroundColor:`${l.palette.info.main}20`,color:l.palette.info.main,fontWeight:600,borderRadius:"4px"}})]}),J.jsx(ht,{sx:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},children:J.jsx(Qt,{variant:"body2",sx:{fontSize:"0.8rem"},noWrap:!0,children:d.data.id})}),d.txid&&J.jsxs(ht,{sx:{display:"flex",alignItems:"center"},children:[J.jsx(ht,{sx:{maxWidth:{xs:"80px",sm:"120px",md:"200px"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:J.jsx(Qt,{variant:"caption",sx:{color:l.palette.text.secondary,fontSize:"0.7rem"},children:d.txid})}),J.jsx(So,{title:"Ver en whatsonchain",children:J.jsx(ou,{href:`https://whatsonchain.com/tx/${d.txid}`,target:"_blank",rel:"noopener noreferrer","aria-label":"open in whatsonchain",size:"small",sx:{ml:1,color:l.palette.primary.light,"&:hover":{color:l.palette.primary.main}},children:J.jsx(Jk,{fontSize:"small"})})}),d.status==="acknowledged"&&!d.spent&&J.jsx(So,{title:"Verificado",children:J.jsx(tE,{fontSize:"small",sx:{ml:1,color:l.palette.success.main}})})]})]},d.txid)})]})]})},RF=()=>{const{prescription:i,presentation:e,dispensation:n,acknowledgement:r}=ku(),t={display:"flex",gap:{xs:3,md:4},alignItems:{xs:"flex-start",md:"center"},flexDirection:{xs:"column",md:"row"},mb:4},s={width:{xs:"100%",md:"50%",lg:"40%"},minWidth:{md:"350px"},flexShrink:0,transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(0,0,0,0.1)"}};return J.jsxs(ht,{sx:{minHeight:"100vh",pt:10,pb:40,backgroundImage:`url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%232c6e8e' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E")`,backgroundAttachment:"fixed",display:"flex",flexDirection:"column"},children:[J.jsxs(JN,{maxWidth:"lg",sx:{display:"flex",flexDirection:"column",position:"relative",zIndex:1},children:[J.jsxs(Sf,{elevation:0,sx:{textAlign:"center",p:{xs:3,md:4},my:4,background:"linear-gradient(135deg, rgba(44, 110, 142, 0.08) 0%, rgba(255, 255, 255, 0.9) 100%)",borderRadius:3,border:"1px solid rgba(44, 110, 142, 0.1)",backdropFilter:"blur(4px)"},children:[J.jsx(Qt,{variant:"h4",color:"primary.main",gutterBottom:!0,sx:{fontWeight:700,textShadow:"0 1px 2px rgba(0,0,0,0.05)",fontSize:{xs:"1.7rem",sm:"2rem",md:"2.125rem"}},children:"Demostración de Recetas Médicas en Blockchain"}),J.jsx(Qt,{variant:"subtitle1",color:"text.secondary",sx:{maxWidth:"800px",mx:"auto",mt:1},children:"Sistema seguro de gestión de recetas médicas utilizando tecnología blockchain"})]}),J.jsxs(ht,{sx:{display:"flex",flexDirection:"column",gap:4},children:[J.jsxs(ht,{sx:t,children:[J.jsx(ht,{sx:s,children:J.jsx(xF,{})}),J.jsx(Mp,{entry:i})]}),J.jsxs(ht,{sx:t,children:[J.jsx(ht,{sx:s,children:J.jsx(_F,{})}),J.jsx(Mp,{entry:e})]}),J.jsxs(ht,{sx:t,children:[J.jsx(ht,{sx:s,children:J.jsx(SF,{})}),J.jsx(Mp,{entry:n})]}),J.jsxs(ht,{sx:t,children:[J.jsx(ht,{sx:s,children:J.jsx(IF,{})}),J.jsx(Mp,{entry:r})]})]}),J.jsx(ht,{sx:{mb:50}})]}),J.jsx(PF,{})]})},NF={primary:{main:"#2c6e8e",light:"#4b9aaa",dark:"#1c4d64",contrastText:"#ffffff"},secondary:{main:"#8e0e2c",light:"#b23d54",dark:"#6a0921",contrastText:"#ffffff"},background:{default:"#f8fbfd",paper:"#ffffff"},text:{primary:"#2c353d",secondary:"#607d8b"},divider:"rgba(0, 0, 0, 0.08)",success:{main:"#4caf50",light:"#81c784",dark:"#388e3c"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f"},warning:{main:"#ff9800",light:"#ffb74d",dark:"#f57c00"},info:{main:"#2196f3",light:"#64b5f6",dark:"#1976d2"}};let Lm=x0({palette:NF,typography:{fontFamily:"var(--font-geist-sans)",h1:{fontWeight:700},h2:{fontWeight:700},h3:{fontWeight:600},h4:{fontWeight:600},h5:{fontWeight:600},h6:{fontWeight:600},subtitle1:{fontWeight:500},subtitle2:{fontWeight:500}},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",fontWeight:600,borderRadius:8,boxShadow:"none","&:hover":{boxShadow:"0px 3px 6px rgba(0, 0, 0, 0.1)"}},contained:{padding:"8px 24px"},outlined:{padding:"8px 24px"}}},MuiCard:{styleOverrides:{root:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)",borderRadius:12}}},MuiCardContent:{styleOverrides:{root:{padding:24,"&:last-child":{paddingBottom:24}}}},MuiPaper:{styleOverrides:{root:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)",borderRadius:12},elevation1:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.06)"}}},MuiDrawer:{styleOverrides:{paper:{borderTopLeftRadius:16,borderTopRightRadius:16}}},MuiBackdrop:{styleOverrides:{root:{backgroundColor:"rgba(0, 0, 0, 0.6)"}}},MuiIconButton:{styleOverrides:{root:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}}},MuiDivider:{styleOverrides:{root:{margin:"16px 0"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8}}}}}});Lm=u7(Lm);const CF=Lm;x5.createRoot(document.getElementById("root")).render(J.jsx(Z.StrictMode,{children:J.jsx(h7,{theme:CF,children:J.jsxs(vF,{children:[J.jsx(rC,{}),J.jsx(RF,{})]})})}));
